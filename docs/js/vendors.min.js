/*! AgoraRTC|BUILD v3.5.2-0-g0d49ed1 */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("AgoraRTC",[],t):"object"==typeof exports?exports.AgoraRTC=t():e.AgoraRTC=t()}(window,(function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=92)}([function(e,t,n){"use strict";n.r(t);var r,i=n(11),o=n.n(i),a=function(){var e=new Date;return e.toTimeString().split(" ")[0]+":"+e.getMilliseconds()},s=n(14),c=n(3),u=n(1),l=n(45),d=n.n(l),h=n(46),f=n.n(h),p=new Array(32).fill(void 0);function A(e){return p[e]}p.push(void 0,null,!0,!1);var g=p.length;function v(e){var t=A(e);return function(e){e<36||(p[e]=g,g=e)}(e),t}var m=new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0});m.decode();var y=null;function b(){return null!==y&&y.buffer===r.memory.buffer||(y=new Uint8Array(r.memory.buffer)),y}function E(e,t){return m.decode(b().subarray(e,e+t))}function _(e){g===p.length&&p.push(p.length+1);var t=g;return g=p[t],p[t]=e,t}var w=0,S=new TextEncoder("utf-8"),T="function"==typeof S.encodeInto?function(e,t){return S.encodeInto(e,t)}:function(e,t){var n=S.encode(e);return t.set(n),{read:e.length,written:n.length}},R=null;function C(){return null!==R&&R.buffer===r.memory.buffer||(R=new Int32Array(r.memory.buffer)),R}var I,x=function(){function e(){d()(this,e)}return f()(e,[{key:"free",value:function(){var e=this.ptr;this.ptr=0,r.__wbg_signmanager_free(e)}},{key:"get_digest",value:function(e){return v(r.signmanager_get_digest(this.ptr,_(e)))}}],[{key:"__wrap",value:function(t){var n=Object.create(e.prototype);return n.ptr=t,n}},{key:"new",value:function(){var t=r.signmanager_new();return e.__wrap(t)}}]),e}(),O=!1,N=null,B=0,M="free",L=[],k=[],U=0;(N?Promise.resolve(N):new Promise((function(e){O||r||function e(){var t={wbg:{}};t.wbg.__wbindgen_object_drop_ref=function(e){v(e)},t.wbg.__wbindgen_string_new=function(e,t){return _(E(e,t))},t.wbg.__wbindgen_string_get=function(e,t){var n=A(t),i="string"==typeof n?n:void 0,o=null==i?0:function(e,t,n){if(void 0===n){var r=S.encode(e),i=t(r.length);return b().subarray(i,i+r.length).set(r),w=r.length,i}for(var o=e.length,a=(i=t(o),b()),s=0;s<o;s++){var c=e.charCodeAt(s);if(c>127)break;a[i+s]=c}if(s!==o){0!==s&&(e=e.slice(s)),i=n(i,o,o=s+3*e.length);var u=b().subarray(i+s,i+o);s+=T(e,u).written}return w=s,i}(i,r.__wbindgen_malloc,r.__wbindgen_realloc),a=w;C()[e/4+1]=a,C()[e/4+0]=o},t.wbg.__wbindgen_throw=function(e,t){throw new Error(E(e,t))};for(var n=Uint8Array.from(atob("55ZBgM/2Bzm2JGhNn//ljJsSorhWUYE66a1Hf8O7pfQGR2zfol8qRP6CDhsi3iG7nFZu9stSyPq/qu2Rr2w8QkTGP6Gm2cg3J5qsQgq5bcHA9mDpGv/b24uEwsixZVl1eGkdV4SB/6ayw2v48hLmNA+w5UlnTCiWwerzESQPidpSUMbamXL3pU815EQm12GhhZ9aWzo568gdZvXevBc/WHfFKQSuTgWva4e4eSmW7UxpH8sY4HlDsCTMu0WwEB8B95XsZwOp3GLgfOQmJBw036DgIKU+XGn4KpIEq77WE/h6R7sZKsFUp+u+2cDnW7IPNe7xfd9areFo0EUh0/9K9CqxUkLqMB5hlgS1fwQHRzKPhQ7gALyc6HwMCPooS0M1NrzjdfH3vUn0PeQ1GBlnrnXgiu8TunfHg5TcbBfPEbxbyiiow1Np+VEBlHNh00PiAWyu024NHaPbDGfMtzu4WF02fgkh8Pxb7bCSpCZndjTytQgAzfZxk2bbe6NoHHFnsviqYzHVpxoPEk7icHRWcZC28d2muthq673KCMQay1fJcPqSTuYhWUZS5eylIguT33lP+TBbOWQI8KtCzBN5FzqILfKzRkzrJ3L192BUF8SILdwmriv10HU9ZlQAyQA1VdegnzOl/dYk2GGsB3724y7w/7aJLHJzEfwrfIzFd5CoAft7ct+zQW2G4Wm2kpoz6uJfgrNyykQgwCO6pkPy1ADrBUuJon9ySjhgcFru6AKa99wTlIhzBw3FKFt9Aa1/1KWWy7W1wAIGzRTs/7rLXRkKFjNqGVXBdoVNTpHFtfEFsuX0X98ISr0Bennlx0h2Yl/CGNb5Kc7i3bio1XJHX24avcMsEAwfdfskCki4/dkStn7QC97YJC3z+7gD84IiEEeGcnn7gHJyeALr0ssbqDUcKqxEyheyFs9FToJziLB+eYw6nMQLmYTrQyrg3b+3YBdgx7pzNEDSyz3tmaPaikwcLSyB/Igo6U/oP/fS2TZLtmN03m4iS76YrDJAgI+2W1GboabuixVcLdxm6SQ4CzUnHSPl1knhcGhW/+OcKa53tB5j5C4wEpiENv6T9PUu4K0YwtEAqFbd/eN2wVAYCKn/nlVA8uiESxCfgs0411mRFk4i1pixJLPP5AFPG9QFZnj6X19TqmhmIhl8D6Q1rOvPCqPZV/z04HjayX4qPzPzP/5NVilN/sHhQe7ulriGmU/3rj5QEuiOymsL7EdCQMc/4mXDPdVrDBfbt6dnv11oLYGmqOP1oSBj02FtsmYrMn9pRg7HJoCh86jAnzuOYn4tGnQ4gw/89sb64NAXcoIbTIjyiHBAQCCK2Yn4I/fNF10rkQlvSvkpqLG2eYpJmpWrcouNDEUtJFR607oNraLdmUKyLc1g7SNpS+ofp1FL6rua/HFSrb5kTF2Vcy2gl+6MACbFRChKoP/un7IbYJuOima/JWFZcs/MXokIx+ijuqjMtVKaYRTzNI5ncPa2y/EXTNdUUFpMhbE7sa39Uoh6Hci/viXy2KFTNbiw+BkWOPnyOr04LjIYKlJ8ud/KvjuvNUGQOHJvj6tpZJxj97tr0OrgZCAxSHGU5JQfqEd/U0QfzGM8Wh3zdsnd9LhoIIRJAtyA2PmjwJk4zTxeYlgwPqAVTU3+9bA1QD+jLZZ3Ffk3MRq+Ar2RT8YN6ASR4bItt3omBj0LJe0zeGY3OzfhljL6LA1m4+IUp+CzeWo0aEjnvRk3iCJeajgdC+NUGB5qh8PWKtBeC58woavnRjvRNphXS4b9M7Aymcfq26B2YY2lS+wLf763OnGJlVdV/srgyAUJJZjarxom4zrYy23kLFB8zFzWuwSMue5Xm1YWape91JGDuRLIctrJWU47/XfLm6Zgei4xOwq1RcjikGuaZtDwcFg9aKtO+JOGJsCjy9AiPnmt+rmdX83GsT3KtTETnLv6ZQcnGtmt4H8AjFgGYePdQc40cj8VAOV8NCLspyW5w63b3g37GXJrzjm9Fym3fh27psjo5RuTs7XCSrNENxKm9jCcXPqWxyuXJSn6dhdWnw5SAnUjixXviWS4HsnYjw4Xt4cSwkqCB9naLstVXt5D2HgG4fzHFNHvnETft0mrhU81IBDTSyNFdDvFEX8cifoc6FcNq7pzXlotl2ZS1FIzNXddZrdXpBNYZPV52gtCok6ePpUR/Y8jyJpE9P3q8dmFVivVGgmKTcBKMDDbzeOfl4MpOGBtBX/Lab/kzqG42sTyOyGUyOoFXYGMUWJ33GPI2KNa/mW8zVl+imshfbj7PiK1qRUn74KjAkH4wjKnu50AONYUaiveSdwnEc1zCjZSJ3dmBKSxhWAcO2PdHBg5m9+JCiPGCVfK9dzoM8Bm7xx9noJiqt4hNiVa5di1Fd1JRN4rnd1DbKglKpAVSoqvJPxmuyH56TFE4BQjhfKbDMZezQJqx+KXDiW1JWGeDYaPVBWPYeZX6STIzC/DjS7UFlqoKgGGAGP17x8wmMRE6O/axG5jDzloCGxCmrymT0ZGCh4g54O1iDYUtmJr7Bo1d+H9RQj2Y10BxcMkLFTIZVjm9e3vtIbeRx0OdXE1Ou37J/WeJZyPXn1fszvp/KonCqVnt862LrxfoB/0sF5gk4Y/f6LVneU5hun9/V1OVre9XrnDBhcVaQa9Ye6gs8sHW9HCNchaFbkUpxSiyxVEFZIlbejbjSPFlkYOLhtQHduwZWRHWA9akqykJNG3PKvOZAaJG5nWQq8+e4K0JF/AXTKIIr4J7zDt8ZR4xb9T2gxjl1nfqzidMRIY5B4rkw0oetta+j8rqkFpTEGA+hU/tw7bDtpkPYvCguwncnCjwULNFT9I9jXx3H4Ws3WWMCit29F7kGq2Ka+rU/MjnuP0lsXkoB1rr8LawHH5gaf8rajq/BhKrGTIfjDiZG5qz+L7SZBZsMSZZ9pM1QhKju+GTD9iC+9HlhfXMtj94gz8U4h7eGXziEO7lo7LwLL6/DVMrGbkv68JYUYhGz2yBm/8cbQEh5vhakbhmpv1K6XYM9rzdsd9bwYcYt3cfKE3m+/NrUa42+RpJBdFg7cAmxsZ7/0TMyVw6Aqu2gzldb2ag4iLrPNEyW1ywaJ2DXMgPi/sjnDzhuo+vIUrc86j4ZLhT4GAN6uqwbnXq5UDzX7TfuB48oMvvE1sK5q6owkdWfklgnC6pSBpK7wl+e3kuvaYnGRGJJMBQuVgWL1awHrVtfOTsSE1vc0ZdG+a/Jbza6pHbyfi5L7FXJAGdQTk0EP3VT54+F7RZ/MJ9fj56aMxzhJRwQJ6df3cM26qSc5bW/zP3PFXypTOBwzCvVtwGQzkGvDW7XGwgLbTNHDpQXOd2BQ5Zd9bjQqGg+S+kIqWZVZCqVLfyFPF9bEOHfPepL6nRDJUD2l5uRnXqeTvidaSIoqS1Fbc6mLPtYnbp6uuts6Qo8TbMzFuI7NuaPuKnQIyVu7vUGJ8jg1uVOjlMNKdVtLPr9/ZEKVZVj7lsFA+nm3zRjjr1DRKhr/wY1CI1iXKVTeQZ0i2PSnN99j4iVTSwNAYQLWWD+KyZ/xRLVxmZQPuSkLeKBRAkavxjWnIFQb1dn72wMSUdcB9cNCNJNdyTkrl44MRR+pUuiVrTAnTlzL33X32eEYwT+vn564yxFJLUDyIMNjJ0nx+GreKSOglI2et0kAwRHKYFclH9GVTiVlB0TWeUJGD+7JYogF7BizjTGyPOUEWQCguIEmtC4fHD5461T80Z3Mp7rhNTI+Cswuknr9hrIZmpRyFSrSrP8R4S1Cf34Tu4RNrDxpofVK9nGTklZPsYM6eiP29Lx264fsX9oLdYhq7vCwcrRMJ1a5d0QHXUYRV5IqTFBoUSpxkQ6IHHL8ckM4NCzwk8K0CA3pj5Jp2a9wZjfKq7R/eukzQFuhMxV2qgHf2E3t7/SA8N7sMvsmF0p3J96QRE3rA85ekH1q8nrBVujlIqahmL0Qto3+JxdqAfnKMCblQGSKVWZgWLMm82MG/9pjhdkMzG7C2GRLGMty2y8NhX1pZWHNbLOmvaC424LNz/Nl5tkPv7fVbCT2ItB+/dx3ZhVhmgSLd1zL+2PsNFmj7VGBruTttezlo1mDKErjY27nTswjf2fY/Uq8lPcVAgRpJM+m7jS/8dk8cdl7fkY7Tuj4TfiSe0tiNSoJgZwom4+9haoBQ65AifaB7pUiTc0MAXCvG+nDydkRIbKx5fL6gAlyMAnBbQf+Qh1naLfzzwLVTP0EEyoenW2W1zKqfMql5rwGlyCB9mSa2s25yHf4SDSBlgEVMJtplpRgegZvDakpWDKgx3UR4W7yKW+RD7bd7rEa/GQmA/q0RYAOIaXfO/2CgEUPtNhPS2uqy29lBYFPPv5SHQ0t/jRxQLBpe09ateAWKypt9TWS7Z5gynOePS5M2NC16AhF0Xz6s7DUjtI0xNho9Y6GK16J5V8HqHypV/OAz7+VBzTaiR57XGH4r62GoAiJqfWOM7okzKCeeSBnOIKPHtwgM0SQbvCvv7rmS6ZAacu4BbXZ5R9gOhdR9H3bi7lWLBNnqqLPIy0k6m4XBhtl40B6z/5AcJxjtKfwvIExl7VsQRqbW8gpPMsmJZfSp3uC35g1AkP+BJlju3RVoFZNo3JR18A5uc60NGD4zvzIdGTAOth4ZAZx0ZGQItHuNcLz/0CiavJdkjD65h4avf1vf7LFZ1uogJz6vLK3uDisXIBIGkXOlIpxTdjjjTQt6Khy50bYbXsG9JBrSUGhsBWpeRUnq2cZWOifhfueY95gFIDAu37oKR3FQ1YxGMg3UMq+L2VN2rtqodelSHof8SyYZVQWs7L0bjtgolId1tAAjHI7J1/+JIRXeUBjjaGGQAU+az9XFfiqn+VRAGG8JDdP/WmEqjhYpcy00LIBIBzCF9I9mbXCv8IX9fhPlI5NqWGO/v0ikpfn+hb5U16FcPYsx+xLb4la6nSbvrTDP5MthPyeLIIY7ZE/rNU4ajgPmI0/3RvD7WtEbo8UGPjnev55N2ELuFpEPzkNu9MzXqq8K0cWxk4lT2DQPi3rDO8x8i5jX7wWQi8e0neCMb0SUO67zRfaekZONGfaFl47LByciUuy5dhqxMPokhTE2WbzxqCyt/s2TqG66R0ocYHmzv9f7tJ+TES8NFyzL3fhNoZoW5IxWNE+stYWutd3LPwa7HKhhRAbl5uCEbEGjrUzTXwbzG0qvpmNtpnYnmKjzTaSAFNCxfw9edcjaxCiRKKIDd6GS/eDsGBgTvJexDfwGmVWm9jadZhee9jRFiZFtL6m7sY1oQa8F9ycxSuPANXCqWkApcaEfQLkt1yyfeRs5yC5O/6XGJ4TEtJmCTPJFRr95au20STIPgkoEF1mzZ+5ZRtWKUYuWJVZDwcA/lTy6oYp0/d0LGPRUXnXRm0qtIXQVdnoVhKZPeWACt9rujRL57MEDi2kHtfV/ucu+k03bN0fQlbalUJ0faY99GC6L8MO8MXTSmqDAxNSpqpIFPhgHgAg0YK/GZhlQjbQXE4tMDEDO9obNfp4W6m8fdznMesSSRINBG5FDf//DkT9pSRQsIdSg4VK7W7j2d2jsQUIyjJmbd/2zCTaqh0Yq0cH6mS/5g/cq3eGOiJbaCNo6oVwGURzXVAeVaGIfJFhd2A59sVp+rVfe1f8B6bVbCLIKgGUgpUokO0vTg6ouAxXGQKtveMhhBT83ukPIRZ02+qF1kvM+nNCVy8uzrB0+W9QIKbMio2m/7zW78xd5Tf9itocpLbRuNC5cuS/GyRGXw6fzFzjM1UITlQ5dlvoyYxuvb7ol4S1MyhkfMNZbif6/xic0wB3uSScez3oFTRbCHBd0cbJL3cLwfQjCBpGBrRVC7174qW4XWnw0eYGSSzTVSEDOlMaTUIGJO+s7/z8JxaZprcEsoB4+vt9/+uwtM/iyqLVPidu8ZTh+F1rsEWKwZhDAg/giVc6VzRq+DJCrhn81b/LYlLJOdgoAjID2VnwgU+mQhCL6KhgIqqiVraD25UIYEqxMcZ1aRcZvHa8x5gh5onPtsVcl53Xek9BOYqkyj64acX921zwqoY0lmNA81NE7BzVts3cwWDZ4Dk6uuzwtfJuJc7vVS+fdVDEg3ATwC9oG5/Vb1swTyzTsl2V4m+93bSQo5STFG5AruTDWTym6Lxtt4OrAeIVgdoyTJL+keHiHTNiL0/nO5oYwftSQK1aYBuA0e12t/FVN+LsCk0L/hfCCcke89LuP4d46qnFo3NLpHb+NFrvekXVT4GiZgMW2H0orIY0TpS15wlxVUaGCUo7YSN0yWDRU5+p41dCOs5/vXq1do7K+Byjj35/mPlQ+VEDqqF7OIBQrXfHgCXYPy8ye3Ih3io+tYA6nK0/2clIERrpA0AMHKLTGEO7q/IzIcOCwYN9W/ISH4v4uk9MhzNu7Fg2IPCq5CQF1GLuzQu+wNv2h94NIA2UJydawv5X2bHkZjv+kB/WQCYjxUNEU8ssUdxDZstpv2qNAHmI6BMD84olxMiwFdK5J80zc9x7de/cz3ZNIkkGIpMCZJqKKkaLVo1MLnR/h/hQeUvfqJmvkPeIre3EjnliNkKJKL0KNaupHzY7Eoztaj0cNOhJ5dxIRB2is3kLcSK1FZswRJR0B5OXX+Q4UlFIrhR10lIge3Fg5DnaGoZoOyFaaHztrdF251JubDsCZRDSWA0y6ysykO+h4jhXtuWF7D5Wp7B4Hx3EQvKsmPPZYcLevowjlWghHbRBEhwPI3bzjhNWXlqtym5ObYAeYxuHyvyYue2X4651f7Om3+m8KT7Y/JqLWXwgayCdzxHuJidti1ITuf/oXzeCfTRbG5ytXlDk/epX061W6BO074jI7nV518OkYtRJDnPqdDFAf0uWcATfk0h17+gP7GHjy0Rc0Ive9XmvA6gCkoMjNjMEA7GQ3xy7e12DzfNpIfND7GKKojMifTrvkDXrfa3o4wNYktY6/VlBdHtrcH9F7uMWICej/BjZXVX83WFGcVHx3nOXxSL59kE9bSmHc3Xp8iDbPuSG5GIRp3fTFHnmTzzGedl6al2gUbGFKtkC0jFNtKTk2rr8LEObiGgfCoSpTWknvAYDQBoj93s0KiRNPOqgY++Xka2cQiDwqUsLl8/i57YC/V6sy5/NvhViRRZgCzcyjNHGzZsYA5YMtUntyfC1gNFP7cL3AwVA+326NJI7MQJoxTqcHL/YhntsnYTR5R6GVVvFYIlW8Nv9qn3daoGXMz0MoAsXpCzbiHZ0XWkfw2qlJkmZjgQtMAEhHXNgokGRPfOprmtlvNZaNlGB1EjQTVX1Y4tCyJFZhdhID4CowB23uQF16NifyxH+DGnQrnxeklnG7UQV2BRVdr6ZEKZYv7Gj+PbpojzAskvbdtaFsataqPrLDoejjc6ZfPA5zA0iYcCvcNjzuy9SuT0uG8NWMTLv2OsImL++PQV1sifUENAwi4O3yBvzTy4J77B7mMBpjCYGXAyjFGFZL4eAazSmvZ8thJ0FFW+keLHL+ft1dQBKmXY6JatelGebcIC/PyLBHdfX9bRcauGg4xEO7mMl8AjlcPMczkPniNQpiQFqcDJYrFGoxMV2hskxMn0bRQT8Ajc6w6sQYkGl0CQUImPrGfie9dsk4mrCLMIFOqcm0WT8O8AiREEGmooBTO7WI0qk506NsV7ffvc0rVJERJKcyRyCmFZdTSn/SrBfjV7SXT3pQlgluoY4FBUCDDkzwBgjkrE1oFUA3ls+xVP10w5jjBIMwKBSQqRVAEDXw+Dyj+jH3ila8czULWsCKhWd4qGsMFN7++OGBAz9eXHjAO9m++mTXF6qiyG35Q+61yjYQKsBrjR4NNexrwVGqBwAZA6cr5mp8AhoyzPomJ6TLfWEJjEeRI3QsX5oQkNuyF7u650QFka+VjFeNRY6ALklleTW9I0v4ABKDCXTGkjv80vqVNk+FTL0bJK7ndSjjMJD7OBFIEywBPJFrxTdyzocmxEgG0zu1VDgsQuXITYCx1RRty89A/F+CdSAlbMlIkptCC0GrF/jFS8PAU+6TNV1eBqJrCr9BgH1mth8FtdfE7druR+xyZKn5idfUKzGW6ACGF4M61IRoSs9o6xmaj3dnAVQvFWUsMcR6MI3xTKJNyMxkhXhhvT0IxialnG7i/BBzXfMXYh5jl4BXzCSNlxU4+aboEgIDr48/+pfj8J3WcNccFfzV6eiX05qkNktmafoBcxrEsrM8WQV0VVSRybQyXPOqJ1yndwBI6BOGO9oGxGDAd+HcKaZlptCMJsR1Cp3m7F9HpBFSu/NYVj+WSDY7jWSFBlTBSCFyyPEUn8S9NmBVa+mwGVsz0Q+fxe23w1w6wVO7sVnZqRpmXJeXg72QFkl7Qda1lBzn/FW+rRwLvFxCsuad67Wmzab1RJdzPGsuq8AzW6tL+JiwW/VPUSBbBmV1+EjqQ28x1u9W5Eoy7zhsU8NT87CtNbZ0lPEpsoWMewxC80kPanfWPrQXmixWDXXz7uf1kBTr1J/iYuls7fUsyAChXjKcKOaCF4ySqkhMTGmjNqYiG5joBUi/SZpWvgxk28pyIPhf28YULINiqmbWPBKuTCLFruV7JfRgGM87XfNEFc7tgnYx503k/0UXJfpmjx6wKbKcvV5fqrctx+OrIn++TxRxSKlTScEIwd2vG5mg/p5wsQDpiD+X91XbkReKLB25Jvp/IJaJh715RXqBzwCwlY3URonyy+oZoTD8Ym8XMMv/dMllh0LCFZkZFn2gYcLG9iO+I5S/GyxwjajQLQtwH7o+n50vimC+ES8ePOpPDwlu4oG8KhS7NL/OTdIWPIHbSa6/9DfjOq9W66EpaK57R78PpEzVNLkTP2L6lllqDT6SDhIDIvQS3SQbxG96khXgvW/rME+tiXFXi+BC0udi9keyGlc3sLBN3CP3QXzswhBGTxvz2LmRMkU3rLuSkYR1Gzr7vj1VxTN1y1iciA0DswsPZ38eB6X10Uzk6HZqjzBK+EJ5osJJJ/s3b0MFRIWYlM15TPm1uzeOk1zQ96quClQLEZbpxmV/eAduIotXUYQZjWAkTulBJt7kw9uEnLo7OpZrf8k+0ZQP0agcOTLbfrekHji86Mxr7rTwve82mePKoAkkEthE45VI+f1VqpyWNW1kbBbVVfuatKt6MEKqyTUyxSFGHk81kY7CxkgMNexiikN0+IeiUNsfuktjfOAiMfDhbTe4rtxSEPvO4CCUGaktA58TGnSO8rHdCicmGkNrwWsnXgUWjhp8bllNcnQN10TbwxYPAwQKW/JJiYQadr4THXO+vWudiq3I47vqmEM/Ab3Dlq11Q7RmRWntYOEyESbTI8PZYwbtsmjcSwBtTAIHQ5h3I633h3FpOkT2c0PlMjzj0Q/OuqaTVt639fowVppqvSlNcK5KupBnrxfKHQK+SoKSuaO8PNMkYkbcEAc9F0I4uzPfRVP/q5QkvJVsVoJ8BEWW/q1+kivHEMQfb+J2NfJjSTG+WhjHjL8eqi7FgfVewxwmqG9IOnTkwDjAHUaJMIyhVkadW/+GQjLyNP4zyHcLAdWcB5zQ2kc/blAx2RKfG+ON3RfC+iQ5Th7V2i5abkoy0pjfyOwTjIvaq9slSCtoNGBZggBDOiWwau0CX4NAIThFyqu9VWCLr8TsqhQZvQP+xrywovGs6A079U7YBjhEXyQw4Q3rbQY1EQnxTPXNlHfn9vQnuhsJnzx6PZrCqry8fidPz2U1scmAMVPHxa/injIf+hDziEU02xWm9ou67OgebktON9V6wwVotoNOzVNJhiDBlHbktBwOjX1BlJHybLox5y/7NhR7uc8f85O6xdxueabhwtJjYcBzac56v6RbuI9IRvPzOnNbltj8Hh0ftwwhWyHAyiEat0oDSEVZ925jmxJKAqTo4/uHnkozgMDsnkzXPXBDJ1sDTawXy23mXuTJOYV6ZVWrervMaGGGQpgQjAnfP7KPZro+OKt/MpnoM0NeGQgIFAiH7dU7Nl1QbcMiwO6/5nIosJtrFB8w1kpqb6OjI9BgZHG1nzTMGA++HNrl4WQNcq3SajD4C9utQYAu/fETPFMMJeCDwHRCnPuRAlqJ5t0E5h3Wlh1Nw57LQ36kDjC3lS9w0a89eI8ym6BzEA25Cdz3LQAyz94Fvjqp7MyHrpm3PzmsV/tbSLF9NJBjFmzWPQ8Tfgvj3fi8dg78tXvEatqtUhLxsNp2VCU6IzSqafxWw93+Wk47skJv5qxM+tv7CrpYKvWLEylJNEXlh7GHm9UenNf2/szZOl+54P4ZWksh1r6+rphL68QYhmqW7DqKVrc2rjzPYcvFDmKtCGL/F62i3riMV9z+LoLnuVaMn4dtpNNFmQEQ4uEhDfLYU4x8G2OHCz7gnxLCa4zE4CFo9m/+ECmdzziVumHM/P00/BESH2rxUYMBL8/9NRG5fiskFJr4AO0qNUKUCgTRgEiFsTbGXtP4DTTzc8ZAmfNJuJQE5Kp7W7U7QZnBXKepfSHkYTEqgOhqo95Jw9i56kYGt4BWwX50mC27CCW92SVMl4tbUEhBDSB36zgztz5Zts0563Kjc34B+6ZUnMIk+BiQNvqSkZHnk3rHNSaYthO72IWLIxij0hcv7n228yc82FsQLK9jmptjY6estDfH3OSMaAj+poCLKwRFXvXWb6jwM9mG4nu1yug0Cc4L89w4EYek6dnV17VBfIxB2dmFFQdp0kqx3BM9gdMAr0KS7WLOSf3cn5eDItDLP2UW7MWaIR+GJ0EGcEL3ejBdu0to6vDh04JcRMNU55usmSn3jp74myzWE3azMIT96wr39F62c3G/ldGskbqTIMTk3gMg61vNBQ0cJSIxVdcgNb3xFDowwVyIqYz54F8Rqg0uQE4FIiUGZxJhND/AWhkukqIqLLZEpxj07kPBN6Zb2pWht/X5JrC8yJzPlvFhfJndQ4jcgjFyhvymr/a17uxTKHpKNWDEoL4nNa9/Prf7TYRw6Gyo6vcwYcUHk17SMb9aEdVnx24msNCDEKbj0OVzRaA3gFJeXZPObqJKvWqFlavGpxXnP+4ZYTl0Dmcri6vMdwX687ApG+ygiGHZDwNzU68F4JMPQ9JB45vLkCsE2w50QNP1kJZlI56dVGzfK1MyRqP4J6VshesfOT4hzR6MYq373IoONlLvENdYXN6pTxo5eRzQkwk2tZ1zmZqczCytqTEhpweKcBCCZ/FhizgLm8/x5ScBlO0wEXHZm90mpmL1gR/J2CUnz3wDU99YFFKqm01AZ8q2S5Fnh81CbD687c7K2OjWlZgdvEJA9M0JT3eKdIRd9GCx6g1TO5PWTE8OOphUDKdazyYnmMqFhFxfJ//cWJTsgYbol2a7Ob/Q69Fy3kb9K7aZLzH+Kl/uCzWnqTOrQonVL7LTFPr7wbTaepfAl5zSgMInjrGXY+Gspw+fCNgEU1zyC0Suum6VFyHBjdKWft7strrOXqOSQwxsYXp4F013mN9gZyu4Hc84A4dzIHN5UNXmxNn+vPjS82JM6klySWB9pLCzLBUgXiMDllaG6fT2PSBv/b+yaruyWBVcpsOKuEaQ37W3A3t9YFRcgB5rFMDjwOn3c0lfsg+5V+dBX2EmWLTSelNZkeq67CFnxaKtnlsAJRPBqYvoWVZcJKn0zSelrO2TwnailO7zgAHaMRmQYbXo9beBs16JWf7V8LjYGS/DYUKTTE1zKECC/pK1EKf6mxIgmV+mJ+Mc8h04qep+okIIEXaN351J3N0VUk7cEEaOLE1rFF3W4vqRcodPfbLqINF6QtTsfny1+O46J5ahlamZEyxglZtpjEkKd9yKDsgwnzqoAPN5o76IsI+FRaBc8u1qLBWxpKU615chTVegNFR5V4o1T2JGwVkueD6CjAhOplPnRyv8sauMnMy2wEMARR6AmCQ8S5ebL0nCEqjSztMoUyAEjQ6FDYqkGweu48DkBR5HjwlBloKVawYcDezxKBH8WWnMpJKZj1Ol+OHMmg5iq9xDswLx0iTNkujgatOkeRU0c/GmSSH+7GTTMLQJdj51l3EkojjEwWOjw8XBOm88GqC4bWPEE+U/5XYtZNJG/X4FYjgIvVd69RYVbMEMfPSKJ825e3XQ6RBesp/G+lkMk4VIxRakyUBPLO1u0UYnNG9ExAnPdOO0OfFvcPOL9rBJO8bR+q9Lp9/i+fH32KkaNR2WgoxQY3FY+rS2NUvtCOgZAaF9vny16WG/3zeUtRP9V28PcGivAHAwwCcRk0D0iohjAfgL/EKXJkr8gIFqbNq7lXUFRKqMbpBa182ol77SqJq1M5setGUJuSBKqYBYKdDZv3XdT/u6J5aKKkLvA5ez6PuWX0RT7kELSKDKfg9w9nwSmMmJHjbnr0blM2WvpiirR/nLid6SRN9+5KoLUb+pLw3QzD8JlS3X2q0m4BNRxfltr5KWqryOuuGDt6IOHSE8/zqGXMiTqgrUOfDH58NoWe0te4mFc1GxswvhZXWJZmaWaMJo2SBnuXa7+jIfFbnhNH74Z6jygwcqXsldYfI/Zh8BZbqTh2I7Hu44dilfbX8Uh18NVB3phRnTwpUonKquUs/iZXRnDFjtEmKg2YRQm2CP1FWRb/B92HqJlHT7Hs/Tpl3RrlxvkoskpNlW53/6Ujse0fkHLNeUm97TlDsaRXpfZkR1uWMTwhPv4oYM2Bv941R+c7nQ0yBdFNVQpZRkpejmIfjFrdQUA7DPwR69aq6Pzmk3IXarIMKG6R4MBdkB3j3HWxohnZLWpaNy/BMxS+84e4vPPfO/7+nLWVZsdpUY/nGDkQts0NGnRpZK/lW60tmncMoTepY5fMbow1GyKhqSXLbOZkz59l8DG9v9ZHPwA1roKz3MW/j2tN/U+lPQVYXTa6h1ePQkSWR2bp9OHmCCvT6s8v9PVG2ufK7dkbpY500gNx7fdArzH3yCjY33Fa5TbOuybLNdW8juJyJtikDn+5jMnMzIWP/+v12XkaXj195xk6eOKuvA5zeKk1i1PrSnmWA46Ca2ldgNqJ0rvLqM9X2EPn/QuMjLnLg0iVJ4H4r5S2PgpGdSdfVoiX/rBAq6yVDc30v8DOUae4oquSM0YDCIafLQ+hvEmB5b/f+QsTFtAR0zIVWeLyYbmrx3g9gHhVRfelCz9/exh19AGsyXcwuSaBiCzQIoctYvyhhkdCsC/cdZDce/1Fav35JQt+RJFAjiMRQhCdE4eS3SmfsREHe9LZa0ElOLhxxvs5uS/SnMYssyK9FxiucRjjOqfaIp2N8CmuNJqg3WvtMk+MlbAYeji9K94rx6U7nj9L1TGhVcAyz+Gb4sib21AW94HRzWbTrRKEkx5+KLE69Vc+8Cj1Vu2GkZ1AA2E4kaJ2aTjsEL2C0srAINXRAjnxwI3p5ED0NRYn9sT1iY9GPBJwhhd6WXEJ/Z44D0rufaDOA8dUj1SIqywRs2b7SjYcCYS8eefkwdWlpN0DvnecdwHVc3TqyCcUy7K2PMS2l2KZHzZfLCTCPaPq/NVc/Nlc5hVJoFvnNUpKWZcTsxVeHfH1mnELREECq9YES9v6FcvONCxXLQmf0k3S2dyNmsxbvlXM0u7lSqkx81md0rad3E33PPuPpDGM9UiBhSeJn3Sejmx+LdLCiZYcVxow59nCqrUmXGAbsR4O7wVQzyHdL6DX5s8k5BjHXlONz0PaIqS89xMhkYetMw6w7JZ5c/oJBH2jdZPbS6KbR0RpEe16BATLzU4QiHybxArrjBM8MKKP8Zz6MVbg/d8yb76U8nQzCK4Eqa5ombBm7/6xo2dR9O/ByfcU6qDu+efdLFAP4LiCr6C3aihDPjigUYuy0voLuX3Flevl7xXRtRZ4Vc48j2tgA7tK0wqv4OjLwCzZJn9lYIQuScQBEFMBjA6Vj8FTp4h3OphB6g0uA13nTnVLmKQ+zfELl+6znWX5nCWvbwak0t3q4qwWK3MAPKE2vqDEeCsFKvmJ2Ws+VOqnrA+ekCk9jaszBsZd71InADWijT4SHnyVmc55dv5ivXl1fED4vwNrxbiZHWeGinS3ImcoDAT1vGiLpP/D3NaiIPq9A2h5DT5SgaCVCh0JKu7DKsHjW9ZAACRxHgTSo5jrVWUJfGKweg2auQuittVidB+JaCdwYd0x9oJ4jyI5UygrB9Nzi2gbLVcCnpu+1ytsiWCbJb1Xxas8FhG/EX86taG6flZZauhaGnpRyfBB5ojGdsdPBVHEtb8R951oaNTvKXK7CddSeWaeOi2FIDPEhWhAk19RzuR9wSKEwvvi8nQFz649+fUlBMuDL7VmUBSsC1ExWwqY+uSdNKowEkpsBb+/KpWl6oGxymyR/e4uKjipBJrVPXg0nE2j6HL2JbCHNh01lV+/+6FUglhV8GTypzdvdfhYc7t0ZYtkyH/17wDakU7r1GAdUIXXmtxamhK2FdelBa4BPryblCC9gJG9htJue9LMrNS7mM6gbRA1xSFnWNsziDuGZeS3Dcu4bjsWaIebrgNnxpl/pLGxV5EtkFwDeh8fPyfPU8CZAM/Ljk3+Vi7jUtNZmZM8+f7d4wlUIkTHiAULRUKu0ODFIeyk20BiqLB7vvAT342SIDP+z5FPaa6Tjyqh/AsX2jFhbeIXKxDMb8fid0jHAWk6JKhswbtvtP6bDz+lYjvXIPwV1Y+nyft2uM8c1aUxmDHAUmZnJBvZXT43mxjXDHP05R1/dKfoExcgcYzv3wO5mazi7ugS01z6oUmByKtfQ6fA2+MQynPCoDHcp1eDtag/E3HQpHMWAgGkNh9wWR5Y48YG0W4CgvOrngI111j/x+MIuH5xFlVkxqptSjW+hnVbt9qxtXndEH5RtnxWfd9eP+kli/x3LU1WGsZVAkVElXD274LBGK0bMveEUbj/6EpnocEnvRSlglpE4GiAO5S4JdYb4uYd6oeK8vuZvTQaWMS3dEIJ2ssCxWz8DqYmc/b38ynz0DWCCeF1gCyipaLG2Kq9wqfHz3S6m7CS+H42nmDYAz2dYcx77M8purGOS5tQ4aykJXIDQBwHjIGSU+52M+1OV53rp4B3JbIXecQWEjfk9gkVoz8T6HJbIhFgm3quNMk+cIyRHlj/BdURXY8o7H7dBQfsdpLJhAsxS/1JtMkY8JoP4YdyOxzJY5x/+A9scOTXvPVoQAMqgmP899s6GvRtzNFGXLX7VHSnUj7VPO8K1qxaS/a/6v/YhRlUtNgnqnth3Jo/DKbdhdPn6HgB9YjU5GuN1uPyUXZJDZYfFwMfdqNPVoI8d1csoHMK5tquGoK060mIwBHMk3pFGqBosajr9g/5kBPrrtuIIEPFZnaAKSCQqLdeQq2B6Bs8WxD8+DfzGJ2nu0Xeb58spPoiHZAVV+I5lRUseUE0IA4E844UzFYADNYcLBW3zsP7aWzLnUZoQPuIDR3FX3bkM5mCunvXaPSi4PRkKnItEv8/OYiq8RSKQcaTwxX9YgdNbgPuXLwb5ARofv0Zj3WpHhNnlTq2Qu/lwvM3PUaqv8L7kpFqQR9aRaXfFanbLgbyxJ2kAx9oA1kRMyH3JXI06oQhRiZQ1LtWz+QKKxme0zAgI2q6/dmYApsA7WGeBae5+Y3eqkqDjXyS7Q+LzYgrM3EiqGHsibaKZKgFecxpGiMLXY5+kkuDKBdMkj2Bd8uTKI+aTWpu97gNp78fm891zYuT68sIEzE5JggpWjlWFSpzYayxvnOxJ3JYK/q8WbCy14KhtCFhdLOxCEAvyqXN3K+oP52ZzdxHiCAac5LX2TO5CTmkxp6zCT5JZDIBgnnmQU8GBowEvogfPni17fE1sljd55P2C4mWCNDr8l3hMH+4zpyZqp3iFbJx20nGtU+9LJozl0OxNrk/c0C9chEe+k4vUECnUaXbS8JqdnymqbZ1SCI+4+1BYMW4nzYKDLaqL3Nm08C/Ug7zNg2BuwhWepXrkqaRX58LCWLPDQyUzn369E1drtekeuNcI4SgdmyQZ/7xhXZ6sOKg9G/HEiJQsriRQThvHz4BhaFaXic4nlrz4LhUthGBLbnnB6tufJizYx4c6b2rY1E63pLDA8QdZsTOD7euNMku1a0T2nNQ9rOPBYPDyksaP+EmKTvqcgRycKMtzhHh37mAqVERuzIIMs/zXE9jGBpJBBWb8KCPZne6Sxw0+UFlY6/VeXJUHunHXY1csfc40Tw95XrkpLzxqX/LrsaYM7Y0UQ/Qe6PTjMQUXDseSMhYwHTXCohySQ+1fIjz/yjZWRFI1/a4d9eQzWLoGjz8O8ldPhzhpWFwwlaR0T1gpMP3VeHvDOx4RJocHJOSRQ+H4/nHJsiuXWDKowYZZW8Jk9vUiw2jExedn7glAsC/bgN1NrgIp1y+y3tmLd2V9x7yKVC+QK6MOFq19dlQflj350qUavBULMCTn0BvCRQY4q6VjniU6XHISUsaApCVoQeevAOuCUFcnwWfK+44XDo1qSpPF1wcnbH7N9aO+AzD212PgFlGkXlaQ3Gbfz9XIUMjulgGUREelr6IX+tR2K9H/yep959z5WLXlZ81Z8HCIV8CyU0JKYzkIeFqf6o2ywb2O73oRi7i8F6Vcn2zU1VWZpLfSXgTNkRtqM7r5s13UimLWtAVZs97rLcMRlwXzYp98ZnKvQLj/dpKn8nfNnU9V2Bp90frlQedeKt6zd4mPR53FKQ1J4r95n1G8ph0XG37DC9b185sWbnoyC4Q1iUvyy5IOxBrIqbqn/JSUWzdrlOiZGDJrU5IGuzUl5TaupUTIgFeLfT6uh0gIEJ5nZQ/8XjB0mmEZxTvocrU/BFoOaUvV/N48W3W/aQu5nR3KwsSByfSDAEq6qBqTVTkZtkaAd/1Rie2jkdRlZvxFMu0MGnLc0SHPII8eOz/bjfIhSQhAb38dSRcFmfRb+fpDrDHeazED6EHNayy0kESoRG+XFbJa6xWB6OlbwHVDwdO9Ka7bIOqLRHpZjwXmv/2DR9nu+2xwxE39cBHq/7Vv99HcvH8ZJeGmgHr8mBKQmOCTkvLkxf5k4FrqZuNpaRNhCB3puFuF5d2nnQbhgAaANLMCYAiGsJhX2bFM/r3BGhR/dkGPXeBQUJ4tTARQnVqA07mW/42Dv2k7Wa7hWU/wv7FTIWLwWyHX0Vqdg4BHrlJ7zh+b+T6fH+W3d53LS5rkXK5GIctMIttK+osfGYIvOD0BkkXBJR0EYUmteToIxpoaMVKZmCRC2BbmBLdUTIZiI1kVYKYnq9Q5xMGODu+6vCT2ofvYE0pmGbQ9Ln6wnBDYZUD/BL9rmiPn3n28Zs33OsHUQcLp2vjUEV5sOBLO2ScyescGu0N58y1q1NSNJuXCzI4fu4RWJtSIn3P3+9eAsMo/2NupFeaf70/usLGd2Z0F27EjLoIj+nmJ4/Q5edPFhVNpPURQrUzPALNNzEvx3e82rDtPpbZjugv7Abm2q2vMGwz5W+hGH0hkCzXdZhPFbLk0sR5vVhScLgAPdZIVZIjTuzwIKVuWmvpMr7Gwxgiglpy8ecfOAZcCpXRzG6lNuRB64D4G9AWD9vQi/crWV4Xq5VjJnRjQc3g4bJe+MmksjEctghn27n5i5PHZvW/gM0BsXzo8Pou6yOLnp49dGXpK/oLAbOdOel9h+kDqEtZunvsXa9EFomdl0QbDvk+H58SjszCVqVOXSgDpOdZjXWfZpFL6S/fd1Lq8FQS3LklgiNhdvE5GzgSO8uq3gtj8I2o+JzucnrUSrtoxa6IejmVQLGzF3rSCy3fdhBPhZnDdgctC89dRJ+PTfW4ga5WWAyaWspzFg5251FoByB8LUbD3AxhvV6M1ARNXRJ4NhPe2j9WOlu5I2KmCMGvGP5CbHAyZk3YhiuIdtDgOvre9Cz0yOWvHH5FpZQzqzyHE5XkTTFMU2JhG1nvne9SCi9zNvPnGj9h/bQXgpue78rpogXJl8oDSfMwz9fp4ocyOxEV1JCEslSsRvodEzPbUsMUYWDERNzR6f45Ku6EmW3qdD48dcFQtc9rr2wF3o85edZ/2SY0BSkOdQX1ahwPVBP554Q1Z4lbd0d/vrRCO5k3QBWOb3iML0vI4MRkiKwqt735Q2fkq0Xl1pI3nk4ll51cSEHOrFTctkxwLOiQl6HJh2q3iqHFmtOCSo0A4YLl+mllolm7FLpe/79gMoe7A5cbFPCbX9Z3GhI43FgBbWoq8pwaIoDlklRimVauOx355pv7v26P0MLrgiqWTOxJaIGO/UhHf7GSOm0r1O5m1sPYYn1bathmEkYfrQLiEWQ2/3IjunsIxgAmi6t4JsxalYxE4YyvD59EpzvswOjZUvSgkHwPZonVtaiMTLXnV3p0dKpCSSz38Kv8QbNFzqLbwbBBRUHw/nHSxNipNm5vtjfkuf06jWRwkctgu8wZqKwS/7IcGnFtmwnbJFPhpGcyV9GVFzCCG+TOeNgAWxOUPgmtLdD8JawVVDV+e3iR8kHuaZXIknncI/3uFnblTd2P/OdWvxl+9CXbqJb1CS8osg2fg/qaA9KvM3FQoZQ79JRZC/Upm90ABPCGzksTWJ7Xy9VHpnPZCgGzAVbJhmurq8tm24BjBvnm1GOKfotvCqXyIXFE1bYTRS1WtzgZrGWgR/oOUDnNgDPXqUfTmyFPfNCD9MX22hvuBans/Kl1DustiTunl9Kravj0NG1Ds5nkTqlQSYOfhgvRIowimmWAYWma55eqvaQL9GvHmuH/hIVB/tiN6s7yOW2iahReL8dNddIbMJ6BLVguJ4n1dnquV3ZNqi6V0H/Vn00j0cE80ERsZTgsHPJ0eUjxYik+eDtaEHnyAsYeR2AjRcGw=="),(function(e){return e.charCodeAt(0)})),i=new Uint8Array([177,156,215,89,13,111,230,1]),o=new Uint8Array(n.length),a=new Uint8Array(256),s=0;s<256;s++)a[s]=s;var c,u=0;for(s=0;s<256;s++){var l=[a[u=(u+a[s]+i[s%i.length])%256],a[s]];a[s]=l[0],a[u]=l[1]}s=0,u=0;for(var d=0;d<0+n.length;d++){var h=[a[u=(u+a[s=(s+1)%256])%256],a[s]];a[s]=h[0],a[u]=h[1],c=a[(a[s]+a[u])%256],d>=0&&(o[d-0]=n[d-0]^c)}return O=!0,new Promise((function(n){(function(e,t){return WebAssembly.instantiate(e,t)})(o.buffer,t).then((function(t){O=!1,r=t.instance.exports,e.__wbindgen_wasm_module=t.module,n()}))}))}().then((function(){N=x.new(),e(N)}))}))).then((function(e){I=e})),setInterval((function(){Object(c.getParameter)("UPLOAD_LOG")&&D.info("console log upload")}),9e5);var D=function(){var e,t,n,r,i,l,d=null,h=["DEBUG","INFO","WARNING","ERROR","NONE"],f=0,p=function(e,t){if(Object(c.getParameter)("UPLOAD_LOG"))try{t=Array.prototype.slice.call(t);var n="";t.forEach((function(e){"object"===o()(e)&&(e=JSON.stringify(e)),n=n+e+" "})),L.push({payload:n,log_level:e}),"free"===M&&function e(t){M="uploading",setTimeout((function(){!function(e,t,n){var r={};Array.isArray(e)||(e=[e]),e=e.map((function(e){return{log_item_id:B++,log_level:e.log_level,payload_str:e.payload}})),r={timestamp:Date.now(),sdk_version:c.VERSION,process_id:Object(u.getProcessId)(),payload:JSON.stringify(e)},I?r.hash=I.get_digest("".concat(r.payload).concat(r.process_id).concat(r.timestamp)):n&&n();try{var i=d,o=d||"https://".concat(Object(c.getParameter)("LOG_UPLOAD_SERVER"),"/upload/v2");Object(s.post)(o,r,(function(e){"OK"===e?t&&t(e):n&&n(e)}),(function(e){n&&n(e)}),i?{withCredentials:!0}:{withCredentials:!0,"Cache-Control":"no-cache, no-store",Pragma:"no-cache",Expires:"0"})}catch(e){n&&n(e)}}(t,(function(){U=0,0!==L.length?(k=L.length<10?L.splice(0,L.length):L.splice(0,10),e(k)):M="free"}),(function(){setTimeout((function(){e(k)}),U++<2?200:1e4)}))}),3e3)}(k=L.length<10?L.splice(0,L.length):L.splice(0,10))}catch(e){}};t=function(){for(var t=[0],n=0;n<arguments.length;n++)t.push(arguments[n]);e.apply(this,t)},n=function(){for(var t=[1],n=0;n<arguments.length;n++)t.push(arguments[n]);e.apply(this,t)},r=function(){for(var t=[2],n=0;n<arguments.length;n++)t.push(arguments[n]);e.apply(this,t)},i=function(){for(var t=[3],n=0;n<arguments.length;n++)t.push(arguments[n]);e.apply(this,t)};var A={};return l=function(e){A[e]||(r.apply(void 0,arguments),A[e]=!0)},{DEBUG:0,INFO:1,WARNING:2,ERROR:3,NONE:4,enableLogUpload:function(){Object(c.setParameter)("UPLOAD_LOG",!0)},disableLogUpload:function(){Object(c.setParameter)("UPLOAD_LOG",!1)},setProxyServer:function(e){d=e?"https://".concat(e,"/ls/?h=").concat(Object(c.getParameter)("LOG_UPLOAD_SERVER"),"&p=443&d=upload/v2"):"https://".concat(Object(c.getParameter)("LOG_UPLOAD_SERVER"),"/upload/v2")},setLogLevel:function(e){e>4?e=4:e<0&&(e=0),f=e},log:e=function(){var e=arguments[0],t=arguments;if(t[0]=a()+" Agora-SDK ["+(h[e]||"DEFAULT")+"]:",p(e,t),!(e<f))switch(e){case 0:case 1:console.log.apply(console,t);break;case 2:console.warn.apply(console,t);break;case 3:console.log.apply(console,t);break;default:return void console.log.apply(console,t)}},debug:t,info:n,warning:r,deprecate:l,error:i}}();t.default=D},function(e,t,n){"use strict";n.r(t),n.d(t,"report",(function(){return R})),n.d(t,"SESSION_INIT",(function(){return v})),n.d(t,"JOIN_CHOOSE_SERVER",(function(){return m})),n.d(t,"JOIN_GATEWAY",(function(){return y})),n.d(t,"PUBLISH",(function(){return b})),n.d(t,"SUBSCRIBE",(function(){return E})),n.d(t,"getProcessId",(function(){return T}));var r=n(43),i=n.n(r),o=n(7),a=n.n(o),s=n(3),c=n(0),u=n(14),l=n(28),d=n.n(l),h=n(44);function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var A,g,v="session_init",m="join_choose_server",y="join_gateway",b="publish",E="subscribe",_=new(n.n(h).a),w={eventType:null,sid:null,lts:null,success:null,cname:null,uid:null,peer:null,cid:null,elapse:null,extend:null,vid:0},S=null,T=function(){return S||(S="process-"+d()(),c.default.info("processId: "+S)),S},R=(g=0,(A={list:{},setProxyServer:function(e){_.setProxy(e),A.proxyServerURL=e},getUrl:function(){return A.proxyServerURL?"https://".concat(A.proxyServerURL,"/rs/?h=").concat(Object(s.getParameter)("EVENT_REPORT_DOMAIN"),"&p=6443&d=events/message"):"https://".concat(Object(s.getParameter)("EVENT_REPORT_DOMAIN"),":6443/events/message")},getBackUrl:function(){return A.proxyServerURL?"https://".concat(A.proxyServerURL,"/rs/?h=").concat(Object(s.getParameter)("EVENT_REPORT_BACKUP_DOMAIN"),"&p=6443&d=events/message"):"https://".concat(Object(s.getParameter)("EVENT_REPORT_BACKUP_DOMAIN"),":6443/events/message")},getSessionStartTime:function(e){return A.list[e]?A.list[e].startTime:(c.default.DEBUG("[getSessionStartTime]: session ".concat(e," no exit")),0)},sessionInit:function(e,t){var n=a()({},w);n.startTime=+new Date,n.sid=e,n.cname=t.cname,A.list[e]=n;var r=a()({},{willUploadConsoleLog:Object(s.getParameter)("UPLOAD_LOG"),areaVersion:"global"},t.extend),i=a()({},n);i.eventType=v,i.appid=t.appid,i.browser=navigator.userAgent,i.build=s.BUILD,i.lts=+new Date,i.elapse=i.lts-i.startTime,i.extend=JSON.stringify(r),i.mode=t.mode,i.process=T(),i.success=t.succ,i.version=s.VERSION,delete i.startTime,A.send({type:"Session",data:i}),A._flushInvokeReport(e)},joinChooseServer:function(e,t,n){if(A.list[e]){t.uid&&(A.list[e].uid=parseInt(t.uid)),t.cid&&(A.list[e].cid=parseInt(t.cid)),t.vid&&(A.list[e].vid=parseInt(t.vid));var r=a()({},A.list[e]);r.eventType=m;var i=t.lts;r.lts=Date.now(),r.eventElapse=r.lts-i,r.chooseServerAddr=t.csAddr,r.errorCode=t.ec,r.elapse=r.lts-r.startTime,r.success=t.succ,r.chooseServerAddrList=JSON.stringify(t.serverList),delete r.startTime,A.send({type:"JoinChooseServer",data:r})}},reqUserAccount:function(e,t){t.vid&&(A.list[e].vid=parseInt(t.vid));var n=a()({},A.list[e]),r=t.lts;n.eventType="req_user_account",n.lts=Date.now(),n.success=t.success,n.serverAddress=t.serverAddress,n.stringUid=t.stringUid,n.uid=t.uid,n.errorCode=t.errorCode,n.elapse=n.lts-n.startTime,n.eventElapse=n.lts-r,n.extend="string"==typeof t.extend?t.extend:JSON.stringify(t.extend),delete n.startTime,A.send({type:"ReqUserAccount",data:n})},joinGateway:function(e,t){t.vid&&(A.list[e].vid=parseInt(t.vid));var n=a()({},A.list[e]),r=t.lts;n.eventType=y,n.firstSuccess=t.firstSuccess,n.lts=Date.now(),n.gatewayAddr=t.addr,n.success=t.succ,n.errorCode=t.ec,n.elapse=n.lts-n.startTime,n.eventElapse=n.lts-r,delete n.startTime,A.send({type:"JoinGateway",data:n})},publish:function(e,t){var n=a()({},A.list[e]);n.eventType=b;var r=t.lts;n.lts=Date.now(),n.eventElapse=n.lts-r,n.elapse=n.lts-n.startTime,n.success=t.succ,n.errorCode=t.ec,n.audio=t.audio,n.video=t.video,n.screenshare=t.screenshare,n.publishRequestid=t.publishRequestid,n.p2pid=t.p2pid,t.videoName&&(n.videoName=t.videoName),t.audioName&&(n.audioName=t.audioName),t.screenName&&(n.screenName=t.screenName),delete n.startTime,A.send({type:"Publish",data:n}),A._flushInvokeReport(e)},subscribe:function(e,t){var n=a()({},A.list[e]);n.eventType=E;var r=t.lts;n.lts=Date.now(),n.eventElapse=n.lts-r,n.elapse=n.lts-n.startTime,n.errorCode=t.ec,n.success=t.succ,n.subscribeRequestid=t.subscribeRequestid,n.p2pid=t.p2pid,isFinite(t.peerid)?n.peer=t.peerid:n.peerSuid=""+t.peerid,"boolean"==typeof t.video&&(n.video=t.video),"boolean"==typeof t.audio&&(n.audio=t.audio),delete n.startTime,A.send({type:"Subscribe",data:n}),A._flushInvokeReport(e)},firstRemoteFrame:function(e,t){var n=a()({},A.list[e]);n.eventType="first_remote_frame";var r=t.lts;n.lts=Date.now(),n.eventElapse=n.lts-r,n.elapse=n.lts-n.startTime,n.width=t.width,n.height=t.height,n.success=t.succ,n.errorCode=t.ec,isFinite(t.peerid)?n.peer=t.peerid:n.peerSuid=""+t.peerid,delete n.startTime,A.send({type:"FirstFrame",data:n})},firstVideoReceived:function(e,t){var n=a()({},A.list[e]);n.eventType="first_video_received",n.lts=Date.now(),n.peer=t.peerid,n.uid=t.uid,n.elapse=t.elapse,n.subscribeElapse=t.subscribeElapse,n.subscribeRequestid=t.subscribeRequestid,n.p2pid=t.p2pid,A.send({type:"FirstVideoReceived",data:n})},firstAudioReceived:function(e,t){var n=a()({},A.list[e]);n.eventType="first_audio_received",n.lts=Date.now(),n.peer=t.peerid,n.uid=t.uid,n.elapse=t.elapse,n.subscribeElapse=t.subscribeElapse,n.subscribeRequestid=t.subscribeRequestid,n.p2pid=t.p2pid,A.send({type:"FirstAudioReceived",data:n})},firstVideoDecode:function(e,t){var n=a()({},A.list[e]);n.eventType="first_video_decode",n.lts=Date.now(),n.peer=t.peerid,n.uid=t.uid,n.elapse=t.elapse,n.videowidth=t.width,n.videoheight=t.height,n.subscribeElapse=t.subscribeElapse,n.subscribeRequestid=t.subscribeRequestid,n.p2pid=t.p2pid,A.send({type:"FirstVideoDecode",data:n})},firstAudioDecode:function(e,t){var n=a()({},A.list[e]);n.eventType="first_audio_decode",n.lts=Date.now(),n.uid=t.uid,n.peer=t.peerid,n.elapse=t.elapse,n.subscribeElapse=t.subscribeElapse,n.subscribeRequestid=t.subscribeRequestid,n.p2pid=t.p2pid,A.send({type:"FirstAudioDecode",data:n})},onAddAudioStream:function(e,t){var n=a()({},A.list[e]);n.eventType="on_add_audio_stream",n.lts=Date.now(),n.uid=t.uid,n.peer=t.peerid,A.send({type:"OnAddAudioStream",data:n})},onAddVideoStream:function(e,t){var n=a()({},A.list[e]);n.eventType="on_add_video_stream",n.lts=Date.now(),n.uid=t.uid,n.peer=t.peerid,A.send({type:"OnAddVideoStream",data:n})},onUpdateStream:function(e,t){var n=a()({},A.list[e]);n.eventType="on_update_stream",n.lts=Date.now(),n.uid=t.uid,n.peer=t.peerid,n.audio=t.audio,n.video=t.video,A.send({type:"OnUpdateStream",data:n})},onRemoveStream:function(e,t){var n=a()({},A.list[e]);n.eventType="on_remove_stream",n.lts=Date.now(),n.uid=t.uid,n.peer=t.peerid,A.send({type:"OnRemoveStream",data:n})},streamSwitch:function(e,t){var n=a()({},A.list[e]);n.eventType="stream_switch",n.lts=Date.now(),n.isDual=t.isdual,n.elapse=n.lts-n.startTime,n.success=n.succ,delete n.startTime,A.send({type:"StreamSwitch",data:n})},audioSendingStopped:function(e,t){var n=a()({},A.list[e]);n.eventType="audio_sending_stopped",n.lts=Date.now(),n.elapse=n.lts-n.startTime,n.reason=t.reason,n.success=t.succ,delete n.startTime,A.send({type:"AudioSendingStopped",data:n})},videoSendingStopped:function(e,t){var n=a()({},A.list[e]);n.eventType="video_sending_stopped",n.lts=Date.now(),n.elapse=n.lts-n.startTime,n.reson=t.reason,n.success=t.succ,delete n.startTime,A.send({type:"VideoSendingStopped",data:n})},requestProxyAppCenter:function(e,t){var n=a()({},A.list[e]),r=t.lts;n.eventType="request_proxy_appcenter",n.lts=Date.now(),n.eventElapse=n.lts-r,n.elapse=n.lts-n.startTime,n.extend=t.extend+"",n.APAddr=t.APAddr,n.workerManagerList=t.workerManagerList,n.response=t.response,n.errorCode=t.ec,n.success=t.succ,delete n.startTime,A.send({type:"RequestProxyAppCenter",data:n})},requestProxyWorkerManager:function(e,t){var n=a()({},A.list[e]),r=t.lts;n.eventType="request_proxy_worker_manager",n.lts=Date.now(),n.eventElapse=n.lts-r,n.elapse=n.lts-n.startTime,n.extend=t.extend,n.workerManagerAddr=t.workerManagerAddr,n.response=t.response,n.errorCode=t.ec,n.success=t.succ,delete n.startTime,A.send({type:"RequestProxyWorkerManager",data:n})},requestWorkerEvent:function(e,t){var n=a()({},A.list[e]),r=n.startTime,i=Date.now();delete(n=p({},n,{},t,{elapse:i-r,lts:i,productType:"WebRTC"})).startTime,A.send({type:"WorkerEvent",data:n})},requestApWorkerEvent:function(e,t){var n=a()({},A.list[e]),r=n.startTime,i=Date.now();n=p({},n,{},t,{elapse:i-r,lts:i}),A.send({type:"APWorkerEvent",data:n})},sendCustomReportMessage:function(e,t,n){var r={type:"UserAnalytics",data:p({sid:e},t)},i=A.getUrl(),o=!!A.proxyServerURL;Object(u.post)(i,r,(function(e){n&&n()}),(function(e){var t=A.getBackUrl();Object(u.post)(t,r,(function(e){n&&n()}),(function(e){n&&n("Failed")}),o?{timeout:Object(s.getParameter)("CUSTOMER_REPORT_TIMEOUT")}:{timeout:Object(s.getParameter)("CUSTOMER_REPORT_TIMEOUT"),"Cache-Control":"no-cache, no-store",Pragma:"no-cache",Expires:"0"})}),o?{timeout:Object(s.getParameter)("CUSTOMER_REPORT_TIMEOUT")}:{timeout:Object(s.getParameter)("CUSTOMER_REPORT_TIMEOUT"),"Cache-Control":"no-cache, no-store",Pragma:"no-cache",Expires:"0"})},joinChannelTimeOut:function(e){A.send({type:"JoinChannelTimeout",data:p({},e)})},peerPublishStatus:function(e){A.send({type:"PeerPublishStatus",data:p({},e)})},joinWebProxyAP:function(e){A.send({type:"JoinWebProxyAP",data:p({},e)})},webSocketQuit:function(e){A.send({type:"WebSocketQuit",data:p({},e)})}}).reportApiInvoke=function(e,t){var n=t.tag,r=t.name,i=t.getStates,o=t.options,a=t.timeout,u=void 0===a?6e4:a,l=t.callback,d=t.reportResult,h=void 0===d||d,f=Date.now(),A=0,v=g++,m=function(){return p({tag:n,invokeId:v,sid:e,name:r,apiInvokeTime:f,options:o},i&&{states:(t=i(),Object.keys(t).reduce((function(e,n){var r=e;return null!=t[n]&&(r[n]=t[n]),r}),{}))});var t},y=!!Object(s.getParameter)("SHOW_REPORT_INVOKER_LOG");y&&c.default.info("".concat(r," start"));var b=setTimeout((function(){R._sendApiInvoke(p({},m(),{error:"API_INVOKE_TIMEOUT",success:!1}))}),u);return function(e,t){if(clearTimeout(b),++A>1&&(e="EXECUTOR_INVOKE_".concat(A)),e)return R._sendApiInvoke(p({},m(),{success:!1,error:e},i&&{states:i()})),y&&c.default.info("".concat(r," onFailure"),e),l&&l(e);R._sendApiInvoke(p({},m(),{success:!0},h&&{result:t},{},i&&{states:i()})),y&&c.default.info("".concat(r," onSuccess")),l&&l(null,t)}},A._cachedItems=[],A._cacheInvokeReport=function(e){e.lts||(e.lts=Date.now()),A._cachedItems.push(e),A._cachedItems.length>50&&A._cachedItems.shift()},A._flushInvokeReport=function(e){if(A._cachedItems.length){var t=A._cachedItems;A._cachedItems=[],c.default.debug("Flush cached event reporting:",t.length),t.forEach((function(t,n){t.sid=e,setTimeout((function(){A._sendApiInvoke(t)}),5e3+500*n)}))}},A._sendApiInvoke=function(e){var t=e.tag,n=e.invokeId,r=e.sid,i=e.name,o=e.result,a=e.states,c=e.options,u=e.error,l=e.success,d=e.apiInvokeTime,h=e.lts,f=Object(s.getParameter)("NOT_REPORT_EVENT");if(!(t&&f instanceof Array&&-1!==f.indexOf(t)))if(A.list[r]){var g=A.list[r],v=g.startTime,m=g.cname,y=g.uid,b=g.cid,E=(h=h||Date.now())-v,_=h-d,w="";if(c)try{w=JSON.stringify(c)}catch(e){w=c.toString()}var S=p({invokeId:n,sid:r,cname:m,cid:b,lts:h,uid:y,success:l,elapse:E,apiName:i,execElapse:_},void 0!==c&&{options:w},{},void 0!==a&&{execStates:JSON.stringify(a)},{},void 0!==u&&{errorCode:JSON.stringify(u)},{},void 0!==o&&{execResult:JSON.stringify(o)});A.send({type:"ApiInvoke",data:S})}else A._cacheInvokeReport(arguments[0])},A.sendCache=[],A.sendTimer=null,A.send=function(e){if(e.data){var t=e.data;A._lastLts&&A._lastLts>=t.lts&&(t.lts=A._lastLts+1),A._lastLts=t.lts}if(A.sendCache.push(e),null===A.sendTimer)return function e(){A.sendTimer=setTimeout((function(){if(0!==A.sendCache.length){var t=A.sendCache.length<10?A.sendCache.splice(0,A.sendCache.length):A.sendCache.splice(0,10),n=A.list[t[0].data.sid].vid;return _.sendReportList(t,n),e()}A.sendTimer=null}),Object(s.getParameter)("EVENT_REPORT_SEND_INTERVAL"))}()},A)},function(e,t,n){"use strict";n.r(t),n.d(t,"checkValidObject",(function(){return s})),n.d(t,"checkValidString",(function(){return c})),n.d(t,"checkValidNumber",(function(){return u})),n.d(t,"checkValidArray",(function(){return l})),n.d(t,"checkValidFloatNumber",(function(){return d})),n.d(t,"checkValidBoolean",(function(){return h})),n.d(t,"checkValidEnum",(function(){return a})),n.d(t,"checkValidUID",(function(){return f})),n.d(t,"isValidString",(function(){return p})),n.d(t,"isValidNumber",(function(){return A})),n.d(t,"isValidBoolean",(function(){return v})),n.d(t,"isASCII",(function(){return b})),n.d(t,"isInteger",(function(){return E})),n.d(t,"isNumber",(function(){return _})),n.d(t,"isString",(function(){return w})),n.d(t,"isArray",(function(){return S})),n.d(t,"isEmpty",(function(){return T})),n.d(t,"isValidToken",(function(){return m})),n.d(t,"isValidChannelName",(function(){return y}));var r=n(11),i=n.n(r),o=n(10),a=function(e,t,n){for(var r=0;r<n.length;r++)if(e===n[r])return!0;throw new Error("".concat(t," can only be set as ").concat(JSON.stringify(n)))},s=function(e,t){if(!e)throw new Error("Invalid param: ".concat(t||"param"," cannot be empty"));if("object"!==i()(e))throw new Error("".concat(t||"This paramter"," is of the object type"));return!0},c=function(e,t,n,r,i){if(T(n)&&(n=1),r=r||255,T(i)&&(i=!0),T(e))throw new Error("".concat(t||"param"," cannot be empty"));if(!p(e,n,r,i))throw new Error("Invalid ".concat(t||"string param",": Length of the string: [").concat(n,",").concat(r,"].").concat(i?" ASCII characters only.":""))},u=function(e,t,n,r){if(T(n)&&(n=1),r=r||1e4,T(e))throw new Error("".concat(t||"param"," cannot be empty"));if(!A(e,n,r))throw new Error("Invalid ".concat(t||"number param",": The value range is [").concat(n,",").concat(r,"]. integer only"))},l=function(e,t){if(!Array.isArray(e))throw new Error("".concat(t," should be an array"))},d=function(e,t,n,r){if(null==e)throw new Error("".concat(t||"param"," cannot be null"));if(T(n)&&(n=0),r=r||1e4,T(e))throw new Error("".concat(t||"param"," cannot be empty"));if(!g(e,n,r))throw new Error("Invalid ".concat(t||"number param",": The value range is [").concat(n,",").concat(r,"]."))},h=function(e,t){if(T(e))throw new Error("".concat(t||"param"," cannot be empty"));if(!v(e))throw new Error("Invalid ".concat(t||"boolean param",": The value is of the boolean type."))},f=function(e){if(!Object(o.is32Uint)(e)&&!p(e,1,255))throw logger.error("Invalid UID ".concat(e," ").concat(i()(e))),new Error("[String uid] Length of the string: [1,255]. ASCII characters only. [Number uid] The value range is [0,10000]")},p=function(e,t,n,r){return t||(t=0),n||(n=Number.MAX_SAFE_INTEGER),T(r)&&(r=!0),w(e)&&(!r||b(e))&&e.length>=t&&e.length<=n},A=function(e,t,n){return E(e)&&e>=t&&e<=n},g=function(e,t,n){return _(e)&&e>=t&&e<=n},v=function(e){return"boolean"==typeof e},m=function(e){return p(e,1,2047)},y=function(e){return w(e)&&/^[a-zA-Z0-9 \!\#\$\%\&\(\)\+\-\:\;\<\=\.\>\?\@\[\]\^\_\{\}\|\~\,]{1,64}$/.test(e)},b=function(e){if("string"==typeof e){for(var t=0;t<e.length;t++){var n=e.charCodeAt(t);if(n<0||n>255)return!1}return!0}},E=function(e){return"number"==typeof e&&e%1==0},_=function(e){return"number"==typeof e},w=function(e){return"string"==typeof e},S=function(e){return e instanceof Array},T=function(e){return null==e}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BUILD="v3.5.2-0-g0d49ed1",t.VERSION="3.5.2";var r=0*Date.now()+11499+86604+5615+6547+846;t.SUPPORT_RESOLUTION_LIST={"90p_1":[160,90,null,null,null,null],"120p_1":[160,120,15,15,30,65],"120p_3":[120,120,15,15,30,50],"120p_4":[212,120,null,null,null,null],"180p_1":[320,180,15,15,30,140],"180p_3":[180,180,15,15,30,100],"180p_4":[240,180,15,15,30,120],"240p_1":[320,240,15,15,40,200],"240p_3":[240,240,15,15,40,140],"240p_4":[424,240,15,15,40,220],"360p_1":[640,360,15,15,80,400],"360p_3":[360,360,15,15,80,260],"360p_4":[640,360,30,30,80,600],"360p_6":[360,360,30,30,80,400],"360p_7":[480,360,15,15,80,320],"360p_8":[480,360,30,30,80,490],"360p_9":[640,360,15,15,80,800],"360p_10":[640,360,24,24,80,800],"360p_11":[640,360,24,24,80,1e3],"480p_1":[640,480,15,15,100,500,1,5],"480p_2":[640,480,30,30,100,1e3,25,30],"480p_3":[480,480,15,15,100,400],"480p_4":[640,480,30,30,100,750],"480p_6":[480,480,30,30,100,600],"480p_8":[848,480,15,15,100,610],"480p_9":[848,480,30,30,100,930],"480p_10":[640,480,10,10,100,400],"720p_1":[1280,720,15,15,120,1130,1,5],"720p_2":[1280,720,30,30,120,2e3,25,30],"720p_3":[1280,720,30,30,120,1710],"720p_5":[960,720,15,15,120,910],"720p_6":[960,720,30,30,120,1380],"1080p_1":[1920,1080,15,15,120,2080,1,5],"1080p_2":[1920,1080,30,30,120,3e3,25,30],"1080p_3":[1920,1080,30,30,120,3150],"1080p_5":[1920,1080,60,60,120,4780],"1440p_1":[2560,1440,30,30,120,4850],"1440p_2":[2560,1440,60,60,120,7350],"4k_1":[3840,2160,30,30,120,8910],"4k_3":[3840,2160,60,60,120,13500]},t.AUDIO_PROFILE_SETTINGS={speech_low_quality:[!1,!1,!0,!0],speech_standard:[!1,!1,!0,!1],music_standard:[!1,!1,!1,!1],standard_stereo:[!1,!0,!1,!1],high_quality:[!0,!1,!1,!1],high_quality_stereo:[!0,!0,!1,!1],default:[!1,!1,!1,!1]};var i={AREA_SETTING:["NORTH_AMERICA","OVERSEA"],WEBCS_DOMAIN:["ap-web-1-oversea.agora.io","ap-web-1-north-america.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-oversea.agora.io","ap-web-2-north-america.agora.io"],PROXY_CS:["proxy-ap-web-oversea.agora.io","proxy-ap-web-america.agora.io"],CDS_AP:["cds-ap-web-oversea.agora.io","cds-ap-web-america.agora.io","cds-ap-web-america2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-oversea.agora.io","sua-ap-web-america.agora.io","sua-ap-web-america2.agora.io"],UAP_AP:["uap-ap-web-oversea.agora.io","uap-ap-web-america.agora.io","uap-ap-web-america2.agora.io"],LOG_UPLOAD_SERVER:"logservice-oversea.agora.io",EVENT_REPORT_DOMAIN:"statscollector-1-oversea.agora.io",EVENT_REPORT_BACKUP_DOMAIN:"statscollector-2-oversea.agora.io",ENABLE_LIVE_SERVER_LIST:!1,LIVE_SERVER_LIST:[],ACCOUNT_REGISTER_RETRY_TIMEOUT:1,ACCOUNT_REGISTER_RETRY_RATIO:2,ACCOUNT_REGISTER_RETRY_TIMEOUT_MAX:6e4,ACCOUNT_REGISTER_RETRY_COUNT_MAX:1e5,AUDIO_CONTEXT:null,GATEWAY_DOMAINS:["edge.agora.io"],WEBCS_BACKUP_CONNECT_TIMEOUT:6e3,LIVESTREAMING_ALIGN:!0,HTTP_CONNECT_TIMEOUT:5e3,PLAYER_STATE_DEFER:2e3,SIGNAL_REQUEST_TIMEOUT:1e7,SIGNAL_REQUEST_WATCH_INTERVAL:1e3,REPORT_STATS:!0,REPORT_STATS_TIMEOUT:3e3,UPLOAD_LOG:!1,NOT_REPORT_EVENT:[],FILEPATH_LENMAX:255,SUBSCRIBE_TCC:!1,PING_PONG_TIME_OUT:10,DUALSTREAM_OPERATION_CHECK:!0,WEBSOCKET_TIMEOUT_MIN:1e4,EVENT_REPORT_SEND_INTERVAL:1e3,MEDIA_ELEMENT_EXISTS_DEPTH:3,CANDIDATE_TIMEOUT:2e3,SHIM_CANDIDATE:!1,LEAVE_MSG_TIMEOUT:2e3,TICKET_RENEW_TIMEOUT:828e5,LIVE_STREAMING_TIMEOUT:12e4,SHOW_REPORT_INVOKER_LOG:!1,STATS_FILTER:{transportId:!0,googTrackId:!0},FORCE_TURN:!1,TURN_ENABLE_TCP:!0,TURN_ENABLE_UDP:!0,FORCE_CHANGED_GATEWAY_FLAG:!1,JOIN_EXTEND:"",PUB_EXTEND:"",SUB_EXTEND:"",CHROME_NEW_STATS:!1,AP_BACKOFF_MAX_TIME:8,SET_DEFAULT_TURNSERVER:!0,TURN_SERVER_PASSWORD:r.toString(),PROXY_SERVER_TYPE2:"webnginx-proxy.agora.io",NGINX:"webrtc-cloud-proxy.agora.io",CR:!0,CRL:10,CRI:6,CUSTOMER_REPORT_TIMEOUT:5e3,LIVE_STREAMING_ADDRESS:""};i.AREA_SETTING=["CHINA","GLOBAL"],i.WEBCS_DOMAIN=["webrtc2-ap-web-1.agora.io","webrtc2-2.ap.sd-rtn.com"],i.WEBCS_DOMAIN_BACKUP_LIST=["webrtc2-ap-web-3.agora.io","webrtc2-4.ap.sd-rtn.com"],i.PROXY_CS=["ap-proxy-1.agora.io","ap-proxy-2.agora.io"],i.CDS_AP=["cds-ap-web-1.agora.io","cds-web-2.ap.sd-rtn.com","cds-ap-web-3.agora.io","cds-web-4.ap.sd-rtn.com"],i.ACCOUNT_REGISTER=["sua-ap-web-1.agora.io","sua-web-2.ap.sd-rtn.com","sua-ap-web-3.agora.io","sua-web-4.ap.sd-rtn.com"],i.UAP_AP=["uap-ap-web-1.agora.io","uap-web-2.ap.sd-rtn.com","uap-ap-web-3.agora.io","uap-web-4.ap.sd-rtn.com"],i.LOG_UPLOAD_SERVER="logservice.agora.io",i.EVENT_REPORT_DOMAIN="web-2.statscollector.sd-rtn.com",i.EVENT_REPORT_BACKUP_DOMAIN="web-3.statscollector.sd-rtn.com",i.GATEWAY_DOMAINS=["edge.agora.io","edge.sd-rtn.com"],i.NGINX="webrtc-cloud-proxy.sd-rtn.com",t.setParameter=function(e,t){return void 0!==i[e]&&(i[e]=t,!0)},t.getParameter=function(e){return void 0!==i[e]?i[e]:null}},function(e,t,n){"use strict";n.r(t),n.d(t,"getBrowserInfo",(function(){return m})),n.d(t,"getBrowserVersion",(function(){return h})),n.d(t,"getBrowserOS",(function(){return f})),n.d(t,"isChrome",(function(){return r})),n.d(t,"isSafari",(function(){return i})),n.d(t,"isFireFox",(function(){return a})),n.d(t,"isOpera",(function(){return s})),n.d(t,"isEdge",(function(){return o})),n.d(t,"isQQBrowser",(function(){return c})),n.d(t,"isWeChatBrowser",(function(){return u})),n.d(t,"isLegacyChrome",(function(){return A})),n.d(t,"isSupportedPC",(function(){return l})),n.d(t,"isSupportedMobile",(function(){return d})),n.d(t,"getChromeKernelVersion",(function(){return v})),n.d(t,"isChromeKernel",(function(){return p}));var r=function(){var e=m();return e.name&&"Chrome"===e.name},i=function(){var e=m();return e.name&&"Safari"===e.name},o=function(){var e=m();return e.name&&"Edge"===e.name},a=function(){var e=m();return e.name&&"Firefox"===e.name},s=function(){var e=m();return e.name&&"OPR"===e.name},c=function(){var e=m();return e.name&&"QQBrowser"===e.name},u=function(){var e=m();return e.name&&"MicroMessenger"===e.name},l=function(){var e=f();return"Linux"===e||"Mac OS X"===e||"Mac OS"===e||-1!==e.indexOf("Windows")},d=function(){var e=f();return"Android"===e||"iOS"===e},h=function(){return m().version},f=function(){return m().os},p=function(){return!!navigator.userAgent.match(/chrome\/[\d]./i)};function A(){return window.navigator.appVersion&&null!==window.navigator.appVersion.match(/Chrome\/([\w\W]*?)\./)&&window.navigator.appVersion.match(/Chrome\/([\w\W]*?)\./)[1]<=35}var g,v=function(){var e=navigator.userAgent.match(/chrome\/[\d]./i);return e&&e[0]&&e[0].split("/")[1]},m=(g=function(){var e,t=navigator.userAgent,n=t.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];"Chrome"===n[1]&&null!=(e=t.match(/(OPR(?=\/))\/?(\d+)/i))&&(n=e),"Safari"===n[1]&&null!=(e=t.match(/version\/(\d+)/i))&&(n[2]=e[1]),~t.toLowerCase().indexOf("qqbrowser")&&null!=(e=t.match(/(qqbrowser(?=\/))\/?(\d+)/i))&&(n=e),~t.toLowerCase().indexOf("micromessenger")&&null!=(e=t.match(/(micromessenger(?=\/))\/?(\d+)/i))&&(n=e),~t.toLowerCase().indexOf("edge")&&null!=(e=t.match(/(edge(?=\/))\/?(\d+)/i))&&(n=e),~t.toLowerCase().indexOf("trident")&&null!=(e=/\brv[ :]+(\d+)/g.exec(t)||[])&&(n=[null,"IE",e[1]]);var r=void 0,i=[{s:"Windows 10",r:/(Windows 10.0|Windows NT 10.0)/},{s:"Windows 8.1",r:/(Windows 8.1|Windows NT 6.3)/},{s:"Windows 8",r:/(Windows 8|Windows NT 6.2)/},{s:"Windows 7",r:/(Windows 7|Windows NT 6.1)/},{s:"Windows Vista",r:/Windows NT 6.0/},{s:"Windows Server 2003",r:/Windows NT 5.2/},{s:"Windows XP",r:/(Windows NT 5.1|Windows XP)/},{s:"Windows 2000",r:/(Windows NT 5.0|Windows 2000)/},{s:"Windows ME",r:/(Win 9x 4.90|Windows ME)/},{s:"Windows 98",r:/(Windows 98|Win98)/},{s:"Windows 95",r:/(Windows 95|Win95|Windows_95)/},{s:"Windows NT 4.0",r:/(Windows NT 4.0|WinNT4.0|WinNT|Windows NT)/},{s:"Windows CE",r:/Windows CE/},{s:"Windows 3.11",r:/Win16/},{s:"Android",r:/Android/},{s:"Open BSD",r:/OpenBSD/},{s:"Sun OS",r:/SunOS/},{s:"Linux",r:/(Linux|X11)/},{s:"iOS",r:/(iPhone|iPad|iPod)/},{s:"Mac OS X",r:/Mac OS X/},{s:"Mac OS",r:/(MacPPC|MacIntel|Mac_PowerPC|Macintosh)/},{s:"QNX",r:/QNX/},{s:"UNIX",r:/UNIX/},{s:"BeOS",r:/BeOS/},{s:"OS/2",r:/OS\/2/},{s:"Search Bot",r:/(nuhk|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask Jeeves\/Teoma|ia_archiver)/}];for(var o in i){var a=i[o];if(a.r.test(navigator.userAgent)){r=a.s;break}}return{name:n[1],version:n[2],os:r}}(),function(){return g})},function(e,t,n){"use strict";n.r(t),n.d(t,"APErrorCode",(function(){return r})),n.d(t,"GatewayErrorCode",(function(){return i})),n.d(t,"StringUidErrorCode",(function(){return o})),n.d(t,"JOIN_GS_TRYNEXT_LIST",(function(){return a})),n.d(t,"JOIN_CS_RETRY_LIST",(function(){return s})),n.d(t,"JOIN_PROXY_RETRY_LIST",(function(){return c})),n.d(t,"INJECT_STREAM_STATUS",(function(){return u})),n.d(t,"WEBSOCKET_CLOSE_REASON",(function(){return l}));var r={1010100:"NO_FLAG_SET",1010101:"FLAG_SET_BUT_EMPTY",1010102:"INVALID_FALG_SET",2010005:"INVALID_VENDOR_KEY",2010007:"INVALID_CHANNEL_NAME",2010008:"INTERNAL_ERROR",2010009:"NO_AUTHORIZED",2010010:"DYNAMIC_KEY_TIMEOUT",2010011:"NO_ACTIVE_STATUS",2010013:"DYNAMIC_KEY_EXPIRED",2010014:"STATIC_USE_DYANMIC_KEY",2010015:"DYNAMIC_USE_STATIC_KEY",2010016:"USER_OVERLOAD",2010018:"FORBIDDEN_REGION",2010019:"CANNOT_MEET_AREA_DEMAND"},i={2e3:"ERR_NO_VOCS_AVAILABLE",2001:"ERR_NO_VOS_AVAILABLE",2002:"ERR_JOIN_CHANNEL_TIMEOUT",2003:"WARN_REPEAT_JOIN",2004:"ERR_JOIN_BY_MULTI_IP",2011:"ERR_NOT_JOINED",2012:"WARN_REPEAT_JOIN",2013:"ERR_INVALID_VENDOR_KEY",2014:"ERR_INVALID_CHANNEL_NAME",2015:"ERR_INVALID_STRINGUID",2016:"ERR_TOO_MANY_USERS",2017:"ERR_SET_CLIENT_ROLE_TIMEOUT",2018:"ERR_SET_CLIENT_ROLE_NO_PERMISSION",2019:"ERR_SET_CLIENT_ROLE_ALREADY_IN_USE",2020:"ERR_PUBLISH_REQUEST_INVALID",2021:"ERR_SUBSCRIBE_REQUEST_INVALID",2022:"ERR_NOT_SUPPORTED_MESSAGE",2023:"ERR_ILLEAGAL_PLUGIN",2028:"ILLEGAL_AES_PASSWORD",101:"ERR_INVALID_VENDOR_KEY",102:"ERR_INVALID_CHANNEL_NAME",103:"WARN_NO_AVAILABLE_CHANNEL",104:"WARN_LOOKUP_CHANNEL_TIMEOUT",105:"WARN_LOOKUP_CHANNEL_REJECTED",106:"WARN_OPEN_CHANNEL_TIMEOUT",107:"WARN_OPEN_CHANNEL_REJECTED",108:"WARN_REQUEST_DEFERRED",109:"ERR_DYNAMIC_KEY_TIMEOUT",110:"ERR_NO_AUTHORIZED",111:"ERR_VOM_SERVICE_UNAVAILABLE",112:"ERR_NO_CHANNEL_AVAILABLE_CODE",113:"ERR_TOO_MANY_USERS",114:"ERR_MASTER_VOCS_UNAVAILABLE",115:"ERR_INTERNAL_ERROR",116:"ERR_NO_ACTIVE_STATUS",117:"ERR_INVALID_UID",118:"ERR_DYNAMIC_KEY_EXPIRED",119:"ERR_STATIC_USE_DYANMIC_KE",120:"ERR_DYNAMIC_USE_STATIC_KE",2:"K_TIMESTAMP_EXPIRED",3:"K_CHANNEL_PERMISSION_INVALID",4:"K_CERTIFICATE_INVALID",5:"K_CHANNEL_NAME_EMPTY",6:"K_CHANNEL_NOT_FOUND",7:"K_TICKET_INVALID",8:"K_CHANNEL_CONFLICTED",9:"K_SERVICE_NOT_READY",10:"K_SERVICE_TOO_HEAVY",14:"K_UID_BANNED",15:"K_IP_BANNED",16:"K_CHANNEL_BANNED"},o={1:"ERROR_ILLEAGAL_APPID",2:"ERROR_ILLEAGAL_UID",3:"INTERNAL_SERVER_ERROR"},a=["ERR_NO_VOCS_AVAILABLE","ERR_NO_VOS_AVAILABLE","ERR_JOIN_CHANNEL_TIMEOUT","WARN_LOOKUP_CHANNEL_TIMEOUT","WARN_OPEN_CHANNEL_TIMEOUT","ERR_VOM_SERVICE_UNAVAILABLE","ERR_TOO_MANY_USERS","ERR_MASTER_VOCS_UNAVAILABLE","ERR_INTERNAL_ERROR"],s=["NO_SERVICE_AVAILABLE"],c=["NO_SERVICE_AVAILABLE","REQUEST_PROXY_SERVER_FAILED","REQUEST_PROXY_SERVER_TIME_OUT"],u={INJECT_STREAM_STATUS_START_SUCCESS:0,INJECT_STREAM_STATUS_START_ALREADY_EXISTS:1,INJECT_STREAM_STATUS_START_UNAUTHORIZED:2,INJECT_STREAM_STATUS_START_TIMEDOUT:3,INJECT_STREAM_STATUS_START_FAILED:4,INJECT_STREAM_STATUS_STOP_SUCCESS:5,INJECT_STREAM_STATUS_STOP_NOT_FOUND:6,INJECT_STREAM_STATUS_STOP_UNAUTHORIZED:7,INJECT_STREAM_STATUS_STOP_TIMEDOUT:8,INJECT_STREAM_STATUS_STOP_FAILED:9,INJECT_STREAM_STATUS_BROKEN:10},l={WS_DISCONNECT:"WS_DISCONNECT"};t.default={FAILED:"FAILED",INVALID_KEY:"INVALID_KEY",INVALID_CLIENT_MODE:"INVALID_CLIENT_MODE",INVALID_CLIENT_CODEC:"INVALID_CLIENT_CODEC",CLIENT_MODE_CODEC_MISMATCH:"CLIENT_MODE_CODEC_MISMATCH",WEB_API_NOT_SUPPORTED:"WEB_API_NOT_SUPPORTED",INVALID_PARAMETER:"INVALID_PARAMETER",NO_TRACK_IN_STREAM:"NO_TRACK_IN_STREAM",INVALID_OPERATION:"INVALID_OPERATION",INVALID_LOCAL_STREAM:"INVALID_LOCAL_STREAM",INVALID_REMOTE_STREAM:"INVALID_REMOTE_STREAM",INVALID_DYNAMIC_KEY:"INVALID_DYNAMIC_KEY",DYNAMIC_KEY_TIMEOUT:"DYNAMIC_KEY_TIMEOUT",NO_VOCS_AVAILABLE:"NO_VOCS_AVAILABLE",NO_VOS_AVAILABLE:"ERR_NO_VOS_AVAILABLE",JOIN_CHANNEL_TIMEOUT:"ERR_JOIN_CHANNEL_TIMEOUT",NO_AVAILABLE_CHANNEL:"NO_AVAILABLE_CHANNEL",LOOKUP_CHANNEL_TIMEOUT:"LOOKUP_CHANNEL_TIMEOUT",LOOKUP_CHANNEL_REJECTED:"LOOKUP_CHANNEL_REJECTED",OPEN_CHANNEL_TIMEOUT:"OPEN_CHANNEL_TIMEOUT",OPEN_CHANNEL_REJECTED:"OPEN_CHANNEL_REJECTED",REQUEST_DEFERRED:"REQUEST_DEFERRED",STREAM_ALREADY_PUBLISHED:"STREAM_ALREADY_PUBLISHED",STREAM_NOT_YET_PUBLISHED:"STREAM_NOT_YET_PUBLISHED",JOIN_TOO_FREQUENT:"JOIN_TOO_FREQUENT",SOCKET_ERROR:"SOCKET_ERROR",SOCKET_DISCONNECTED:"SOCKET_DISCONNECTED",PEERCONNECTION_FAILED:"PEERCONNECTION_FAILED",CONNECT_GATEWAY_ERROR:"CONNECT_GATEWAY_ERROR",SERVICE_NOT_AVAILABLE:"SERVICE_NOT_AVAILABLE",JOIN_CHANNEL_FAILED:"JOIN_CHANNEL_FAILED",PUBLISH_STREAM_FAILED:"PUBLISH_STREAM_FAILED",UNPUBLISH_STREAM_FAILED:"UNPUBLISH_STREAM_FAILED",SUBSCRIBE_STREAM_FAILED:"SUBSCRIBE_STREAM_FAILED",UNSUBSCRIBE_STREAM_FAILED:"UNSUBSCRIBE_STREAM_FAILED",NO_SUCH_REMOTE_STREAM:"NO_SUCH_REMOTE_STREAM",ERR_FAILED:"1",ERR_INVALID_VENDOR_KEY:"101",ERR_INVALID_CHANNEL_NAME:"102",WARN_NO_AVAILABLE_CHANNEL:"103",WARN_LOOKUP_CHANNEL_TIMEOUT:"104",WARN_LOOKUP_CHANNEL_REJECTED:"105",WARN_OPEN_CHANNEL_TIMEOUT:"106",WARN_OPEN_CHANNEL_REJECTED:"107",WARN_REQUEST_DEFERRED:"108",ERR_DYNAMIC_KEY_TIMEOUT:"109",ERR_INVALID_DYNAMIC_KEY:"110",ERR_NO_VOCS_AVAILABLE:"2000",ERR_NO_VOS_AVAILABLE:"2001",ERR_JOIN_CHANNEL_TIMEOUT:"2002",IOS_NOT_SUPPORT:"IOS_NOT_SUPPORT",WECHAT_NOT_SUPPORT:"WECHAT_NOT_SUPPORT",SHARING_SCREEN_NOT_SUPPORT:"SHARING_SCREEN_NOT_SUPPORT",STILL_ON_PUBLISHING:"STILL_ON_PUBLISHING",LOW_STREAM_ALREADY_PUBLISHED:"LOW_STREAM_ALREADY_PUBLISHED",LOW_STREAM_NOT_YET_PUBLISHED:"LOW_STREAM_ALREADY_PUBLISHED",HIGH_STREAM_NOT_VIDEO_TRACE:"HIGH_STREAM_NOT_VIDEO_TRACE",NOT_FIND_DEVICE_BY_LABEL:"NOT_FIND_DEVICE_BY_LABEL",ENABLE_DUALSTREAM_FAILED:"ENABLE_DUALSTREAM_FAILED",DISABLE_DUALSTREAM_FAILED:"DISABLE_DUALSTREAM_FAILED",PLAYER_NOT_FOUND:"PLAYER_NOT_FOUND",ELECTRON_NOT_SUPPORT_SHARING_SCREEN:"ELECTRON_NOT_SUPPORT_SHARING_SCREEN",BAD_ENVIRONMENT:"BAD_ENVIRONMENT",LOAD_AUDIO_FAILED:"LOAD_AUDIO_FAILED"}},function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return o})),n(0);var r=function(e,t,n){if(["End2EndDelay","TransportDelay","PacketLossRate","RecvLevel","RecvBitrate","CodecType","MuteState","TotalFreezeTime","TotalPlayDuration","RecordingLevel","SendLevel","SamplingRate","SendBitrate","CodecType","MuteState","End2EndDelay","TransportDelay","PacketLossRate","RecvBitrate","RecvResolutionWidth","RecvResolutionHeight","RenderResolutionHeight","RenderResolutionWidth","RenderFrameRate","TotalFreezeTime","TotalPlayDuration","TargetSendBitrate","SendFrameRate","SendFrameRate","SendBitrate","SendResolutionWidth","SendResolutionHeight","CaptureResolutionHeight","CaptureResolutionWidth","EncodeDelay","MuteState","TotalFreezeTime","TotalDuration","CaptureFrameRate","RTT","OutgoingAvailableBandwidth","Duration","UserCount","SendBytes","RecvBytes","SendBitrate","RecvBitrate","accessDelay","audioSendBytes","audioSendPackets","videoSendBytes","videoSendPackets","videoSendPacketsLost","videoSendFrameRate","audioSendPacketsLost","videoSendResolutionWidth","videoSendResolutionHeight","accessDelay","audioReceiveBytes","audioReceivePackets","audioReceivePacketsLost","videoReceiveBytes","videoReceivePackets","videoReceivePacketsLost","videoReceiveFrameRate","videoReceiveDecodeFrameRate","videoReceiveResolutionWidth","videoReceiveResolutionHeight","endToEndDelay","videoReceiveDelay","audioReceiveDelay","FirstFrameTime","VideoFreezeRate","AudioFreezeRate","RenderResolutionWidth","RenderResolutionHeight","VideoPublishDuration","AudioPublishDuration"].indexOf(t)>-1&&("string"==typeof n||isFinite(n)))return e[t]=""+n},i=function(e){var t={};return e.forEach((function(e){e.id&&e.type&&(-1===e.id.indexOf("send")&&-1===e.type.toLowerCase().indexOf("outbound")&&-1===e.id.indexOf("outbound_rtp")&&-1===e.id.indexOf("OutboundRTP")||("audio"===e.mediaType?(r(t,"audioSendBytes",e.bytesSent),r(t,"audioSendPackets",e.packetsSent),r(t,"audioSendPacketsLost",e.packetsLost)):(r(t,"videoSendBytes",e.bytesSent),r(t,"videoSendPackets",e.packetsSent),r(t,"videoSendPacketsLost",e.packetsLost),r(t,"videoSendFrameRate",e.googFrameRateSent),r(t,"videoSendResolutionWidth",e.googFrameWidthSent),r(t,"videoSendResolutionHeight",e.googFrameHeightSent))))})),t},o=function(e){var t={};return e.forEach((function(e){e.id&&e.type&&(-1===e.id.indexOf("recv")&&-1===e.type.toLowerCase().indexOf("inbound")&&-1===e.id.indexOf("inbound_rtp")&&-1===e.id.indexOf("inbound-rtp")&&-1===e.id.indexOf("InboundRTP")||("audio"===e.mediaType?(r(t,"audioReceiveBytes",e.bytesReceived),r(t,"audioReceivePackets",e.packetsReceived),r(t,"audioReceivePacketsLost",e.packetsLost)):(r(t,"videoReceiveBytes",e.bytesReceived),r(t,"videoReceivePacketsLost",e.packetsLost),r(t,"videoReceivePackets",e.packetsReceived),r(t,"videoReceiveFrameRate",e.googFrameRateReceived),r(t,"videoReceiveDecodeFrameRate",e.googFrameRateDecoded),r(t,"videoReceiveResolutionWidth",e.googFrameWidthReceived),r(t,"videoReceiveResolutionHeight",e.googFrameHeightReceived))))})),t}},function(e,t){function n(){return e.exports=n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},n.apply(this,arguments)}e.exports=n},function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"e",(function(){return a})),n.d(t,"a",(function(){return s})),n.d(t,"d",(function(){return c})),n.d(t,"c",(function(){return u}));var r=n(0),i=function(){var e={dispatcher:{}};return e.dispatcher.eventListeners={},e.addEventListener=function(t,n){void 0===e.dispatcher.eventListeners[t]&&(e.dispatcher.eventListeners[t]=[]),e.dispatcher.eventListeners[t].push(n)},e.hasListeners=function(t){return!(!e.dispatcher.eventListeners[t]||!e.dispatcher.eventListeners[t].length)},e.on=e.addEventListener,e.removeEventListener=function(t,n){var r;e.dispatcher.eventListeners[t]&&-1!==(r=e.dispatcher.eventListeners[t].indexOf(n))&&e.dispatcher.eventListeners[t].splice(r,1)},e.dispatchEvent=function(t){var n;for(n in e.dispatcher.eventListeners[t.type])if(e.dispatcher.eventListeners[t.type]&&e.dispatcher.eventListeners[t.type].hasOwnProperty(n)&&"function"==typeof e.dispatcher.eventListeners[t.type][n])try{e.dispatcher.eventListeners[t.type][n](t)}catch(n){r.default.debug("[".concat(e.clientId,"] Error in ").concat(t.type," event"),n)}},e.dispatchSocketEvent=function(t){var n;for(n in e.dispatcher.eventListeners[t.type])e.dispatcher.eventListeners[t.type]&&e.dispatcher.eventListeners[t.type].hasOwnProperty(n)&&"function"==typeof e.dispatcher.eventListeners[t.type][n]&&e.dispatcher.eventListeners[t.type][n](t.msg)},e},o=function(e){var t={};return t.type=e.type,t},a=function(e){var t=o(e);return t.stream=e.stream,t.reason=e.reason,t.msg=e.msg,t},s=function(e){var t=o(e);return t.uid=e.uid,t.attr=e.attr,t.stream=e.stream,t},c=function(e){var t=o(e);return t.msg=e.msg,t},u=function(e){var t=o(e);return t.url=e.url,t.uid=e.uid,t.status=e.status,t.reason=e.reason,t}},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},a=this&&this.__generator||function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var c=s(n(67)),u=n(3),l=s(n(0)),d=n(2),h=n(14),f=n(10),p=function(e){function t(t,n){var r=e.call(this)||this;return r._state=y.RELAY_STATE_IDLE,r._onStatus=function(e){l.default.debug("["+r.clientId+"] ChannelMediaStatus: "+JSON.stringify(e)),e&&e.command&&("onAudioPacketReceived"===e.command&&r.emit("event",m.PACKET_RECEIVED_AUDIO_FROM_SRC),"onVideoPacketReceived"===e.command&&r.emit("event",m.PACKET_RECEIVED_VIDEO_FROM_SRC),"onSrcTokenPrivilegeDidExpire"===e.command&&(r._state=y.RELAY_STATE_FAILURE,r.emit("state",y.RELAY_STATE_FAILURE,b.SRC_TOKEN_EXPIRED)),"onDestTokenPrivilegeDidExpire"===e.command&&(r._state=y.RELAY_STATE_FAILURE,r.emit("state",y.RELAY_STATE_FAILURE,b.DEST_TOKEN_EXPIRED,e.channelName?{came:e.channelName}:null)))},r._onClose=function(){return o(r,void 0,void 0,(function(){var e;return a(this,(function(t){switch(t.label){case 0:if(l.default.debug("["+this.clientId+"] ChannelMediaSocket onClose"),this.emit("event",m.NETWORK_DISCONNECTED),this.state=y.RELAY_STATE_IDLE,!this._prevChannelMediaConfig)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.startChannelMediaRelay(this._prevChannelMediaConfig)];case 2:return t.sent(),[3,4];case 3:return(e=t.sent())instanceof _&&(e.message===g.WS_ABORT||e.message===g.AP_REQUEST_ABORT)?[2]:(this.emit("state",y.RELAY_STATE_FAILURE,b.SERVER_CONNECTION_LOST),[3,4]);case 4:return[2]}}))}))},r.token=t.appId,r.appId=t.appId,r.cname=t.cname,r.uid=t.uid,r.sid=t.sid,r.clientId=n,r}return i(t,e),Object.defineProperty(t.prototype,"state",{get:function(){return this._state},set:function(e){var t=this._state;this._state=e,t!==e&&this.emit("state",e)},enumerable:!0,configurable:!0}),t.prototype.startChannelMediaRelay=function(e){return o(this,void 0,void 0,(function(){return a(this,(function(t){switch(t.label){case 0:if(this.state!==y.RELAY_STATE_IDLE)throw new _(g.BAD_STATE);return this.state=y.RELAY_STATE_CONNECTING,[4,this._connect()];case 1:return t.sent(),l.default.debug("["+this.clientId+"] startChannelMediaRelay: connect success"),[4,this._sendStartRelayMessage(e)];case 2:return t.sent(),this._prevChannelMediaConfig=e,[2]}}))}))},t.prototype.updateChannelMediaRelay=function(e){return o(this,void 0,void 0,(function(){return a(this,(function(t){switch(t.label){case 0:if(this.state!==y.RELAY_STATE_RUNNING)throw new _(g.BAD_STATE);return[4,this._sendUpdateMessage(e)];case 1:return t.sent(),this._prevChannelMediaConfig=e,[2]}}))}))},t.prototype.stopChannelMediaRelay=function(){return o(this,void 0,void 0,(function(){return a(this,(function(e){switch(e.label){case 0:return[4,this._sendStopRelayMessage()];case 1:return e.sent(),l.default.debug("["+this.clientId+"] stopChannelMediaRelay: send stop message success"),this.state=y.RELAY_STATE_IDLE,this.dispose(),[2]}}))}))},t.prototype.dispose=function(){l.default.debug("["+this.clientId+"] disposeChannelMediaRelay"),this.state=y.RELAY_STATE_IDLE,this.emit("dispose"),this._signal&&this._signal.dispose(),this._prevChannelMediaConfig=null,this.removeEvent()},t.prototype._requestOneAP=function(e){var t=this;return new Promise((function(n,r){var i={command:"convergeAllocateEdge",sid:t.sid,appId:t.appId,token:"",ts:+new Date,version:u.VERSION,cname:t.cname,uid:t.uid+"",seq:1,requestId:1},o={service_name:"tele_channel",json_body:JSON.stringify(i)},a="https://"+e;h.post(a,o,(function(e){var t=null,i=null;try{t=JSON.parse(e)}catch(e){r(new _(g.AP_JSON_PARSE_ERROR,e))}0!==t.code&&r(new _(g.AP_REQUEST_ERROR,t));try{i=JSON.parse(t.json_body)}catch(e){r(new _(g.AP_JSON_PARSE_ERROR,e))}200!==i.code&&r(new _(g.AP_REQUEST_ERROR,i)),i.servers?n(i.servers):r(new _(g.AP_JSON_PARSE_ERROR,i))}),(function(e){return r(e)}),{"X-Packet-Service-Type":0,"X-Packet-URI":61})}))},t.prototype._requestAP=function(){var e=this,t=u.getParameter("UAP_AP");return new Promise((function(n,r){setTimeout((function(){r(new _(g.AP_REQUEST_TIMEOUT))}),5e3),e.on("dispose",(function(){r(new _(g.AP_REQUEST_ABORT))})),t.forEach((function(t){t+="/api/v1",e._requestOneAP(t).then((function(r){l.default.debug("["+e.clientId+"] startChannelMediaRelay request AP "+t+" success: "+JSON.stringify(r));var i=r[0],o="wss://"+i.address.replace(/\./g,"-")+".edge.agora.io:"+i.wss;n(o)})).catch((function(n){l.default.debug("["+e.clientId+"] startChannelMediaRelay request AP "+t+" failed: "+JSON.stringify(n))}))}))}))},t.prototype._connectWebsocket=function(e){return this._signal=new E(this.appId,this.cname,this.uid,this.sid),this._signal.connect(e)},t.prototype._connect=function(){return o(this,void 0,void 0,(function(){var e;return a(this,(function(t){switch(t.label){case 0:return[4,this._requestAP()];case 1:return e=t.sent(),[4,this._connectWebsocket(e)];case 2:return t.sent(),this._signal.on("close",this._onClose.bind(this)),this._signal.on("status",this._onStatus.bind(this)),this.emit("event",m.NETWORK_CONNECTED),[2]}}))}))},t.prototype._sendStartRelayMessage=function(e){return o(this,void 0,void 0,(function(){var t,n,r,i,o,s;return a(this,(function(a){switch(a.label){case 0:return this._checkSignal(),t=this._genMessage(v.StopPacketTransfer),[4,this._signal.request(t)];case 1:return a.sent(),[4,this._signal.waitStatus("Normal Quit")];case 2:return a.sent(),l.default.debug("["+this.clientId+"] startChannelMediaRelay: StopPacketTransfer success"),n=this._genMessage(v.SetSdkProfile,e),[4,this._signal.request(n)];case 3:return a.sent(),l.default.debug("["+this.clientId+"] startChannelMediaRelay: SetSdkProfile success"),r=this._genMessage(v.SetSourceChannel,e),[4,this._signal.request(r)];case 4:return a.sent(),[4,this._signal.waitStatus("SetSourceChannelStatus")];case 5:return a.sent(),this.emit("event",m.PACKET_JOINED_SRC_CHANNEL),l.default.debug("["+this.clientId+"] startChannelMediaRelay: SetSourceChannel success"),i=this._genMessage(v.SetSourceUserId,e),[4,this._signal.request(i)];case 6:return a.sent(),l.default.debug("["+this.clientId+"] startChannelMediaRelay: SetSourceUserId success"),o=this._genMessage(v.SetDestChannel,e),[4,this._signal.request(o)];case 7:return a.sent(),[4,this._signal.waitStatus("SetDestChannelStatus")];case 8:return a.sent(),this.emit("event",m.PACKET_JOINED_DEST_CHANNEL),l.default.debug("["+this.clientId+"] startChannelMediaRelay: SetDestChannel success"),s=this._genMessage(v.StartPacketTransfer,e),[4,this._signal.request(s)];case 9:return a.sent(),this.emit("event",m.PACKET_SENT_TO_DEST_CHANNEL),this.state=y.RELAY_STATE_RUNNING,l.default.debug("["+this.clientId+"] startChannelMediaRelay: StartPacketTransfer success"),[2]}}))}))},t.prototype._sendReconnectMessage=function(e){return o(this,void 0,void 0,(function(){var t;return a(this,(function(n){switch(n.label){case 0:return this._checkSignal(),t=this._genMessage(v.Reconnect,e),[4,this._signal.request(t)];case 1:return n.sent(),[2]}}))}))},t.prototype._sendUpdateMessage=function(e){return o(this,void 0,void 0,(function(){var t;return a(this,(function(n){switch(n.label){case 0:return this._checkSignal(),t=this._genMessage(v.UpdateDestChannel,e),[4,this._signal.request(t)];case 1:return n.sent(),this.emit("event",m.PACKET_UPDATE_DEST_CHANNEL),l.default.debug("["+this.clientId+"] sendUpdateMessage: UpdateDestChannel success"),[2]}}))}))},t.prototype._sendStopRelayMessage=function(){return o(this,void 0,void 0,(function(){var e;return a(this,(function(t){switch(t.label){case 0:return this._checkSignal(),e=this._genMessage(v.StopPacketTransfer),[4,this._signal.request(e)];case 1:return t.sent(),l.default.debug("["+this.clientId+"] sendStopRelayMessage: StopPacketTransfer success"),[2]}}))}))},t.prototype._genMessage=function(e,t){var n=this,r=[],i=[],o=[],a={appId:this.appId,cname:this.cname,uid:this.uid+"",sdkVersion:u.VERSION,sid:this.sid,ts:+new Date,requestId:0,seq:0,allocate:!0,clientRequest:{}},s=null;switch(e){case v.SetSdkProfile:return a.clientRequest={command:"SetSdkProfile",type:"multi_channel"},a;case v.SetSourceChannel:return s=t.getSrcChannelMediaInfo(),a.clientRequest={command:"SetSourceChannel",uid:s.uid+"",channelName:s.channelName,token:s.token||this.appId},a;case v.SetSourceUserId:return s=t.getSrcChannelMediaInfo(),a.clientRequest={command:"SetSourceUserId",uid:this.uid+""},a;case v.SetDestChannel:return t.getDestChannelMediaInfos().forEach((function(e){r.push(e.channelName),i.push(e.uid+""),o.push(e.token||n.appId)})),a.clientRequest={command:"SetDestChannel",channelName:r,uid:i,token:o},a;case v.StartPacketTransfer:return a.clientRequest={command:"StartPacketTransfer"},a;case v.Reconnect:return a.clientRequest={command:"Reconnect"},a;case v.StopPacketTransfer:return a.clientRequest={command:"StopPacketTransfer"},a;case v.UpdateDestChannel:return t.getDestChannelMediaInfos().forEach((function(e){r.push(e.channelName),i.push(e.uid+""),o.push(e.token||n.appId)})),a.clientRequest={command:"UpdateDestChannel",channelName:r,uid:i,token:o},a}},t.prototype._checkSignal=function(){if(!this._signal||!this._signal.isConnect())throw new _(g.WS_DISCONNECTED)},t}(c.default);t.default=p;var A=function(){function e(){this.destChannelMediaInfos=new Map}return e.prototype.setSrcChannelInfo=function(e){d.checkValidObject(e,"srcInfo");var t=e.uid,n=e.channelName,r=e.token;if(r&&!d.isValidToken(r))throw new Error("Invalid token in SrcChannelInfo");if(!d.isValidChannelName(n))throw new Error("Invalid channelName in SrcChannelInfo");if(!f.is32Uint(t))throw new Error("Invalid uid in SrcChannelInfo");this.srcChannelMediaInfo=e},e.prototype.setDestChannelInfo=function(e,t){if(!d.isValidChannelName(e))throw new Error("Invalid channelName in DestChannelInfo");d.checkValidObject(t,"destInfo");var n=t.uid,r=t.token,i=t.channelName;if(r&&!d.isValidToken(r))throw new Error("Invalid token in DestChannelInfo");if(!d.isValidChannelName(i))throw new Error("Invalid channelName in DestChannelInfo");if(!f.is32Uint(n))throw new Error("Invalid uid in DestChannelInfo");this.destChannelMediaInfos.set(e,t)},e.prototype.removeDestChannelInfo=function(e){if(!d.isValidChannelName(e))throw new Error("Invalid channelName when invoke removeDestChannelInfo");this.destChannelMediaInfos.delete(e)},e.prototype.getSrcChannelMediaInfo=function(){return this.srcChannelMediaInfo},e.prototype.getDestChannelMediaInfos=function(){return this.destChannelMediaInfos},e}();t.ChannelMediaRelayConfiguration=A;var g,v,m,y,b,E=function(e){function t(t,n,r,i){var o=e.call(this)||this;return o._onOpen=function(){o.emit("open")},o._onClose=function(e){o.emit("close"),o.dispose()},o._onMessage=function(e){var t=JSON.parse(e.data);if(!t||"serverResponse"!==t.command||!t.requestId)return t&&"serverStatus"===t.command&&t.serverStatus&&t.serverStatus.command?(o.emit("status",t.serverStatus),void o.emit(t.serverStatus.command,t.serverStatus)):void 0;o.emit("req_"+t.requestId,t)},o._requestId=1,o.appId=t,o.cname=n,o.uid=r,o.sid=i,o}return i(t,e),t.prototype.isConnect=function(){return this._ws&&this._ws.readyState===WebSocket.OPEN},t.prototype.sendMessage=function(e){if(!this._ws||this._ws.readyState!==WebSocket.OPEN)throw new _(g.WS_DISCONNECTED);var t=this._requestId++;return e.requestId=t,e.seq=t,this._ws.send(JSON.stringify(e)),t},t.prototype.waitStatus=function(e){var t=this;return new Promise((function(n,r){var i=window.setTimeout((function(){r(new _(g.WAIT_STATUS_TIMEOUT,e))}),5e3);t.once(e,(function(t){clearTimeout(i),t.state&&0!==t.state?r(new _(g.WAIT_STATUS_ERROR,e)):n()})),t.once("dispose",(function(){clearTimeout(i),r(new _(g.WS_ABORT))}))}))},t.prototype.request=function(e){var t=this;return new Promise((function(n,r){var i=t.sendMessage(e),o=window.setTimeout((function(){t.removeAllListeners("req_"+i),r(new _(g.REQUEST_TIMEOUT))}),3e3);t.once("req_"+i,(function(e){clearTimeout(o),e&&200===e.code?n(e):r(new _(g.REQUEST_FAILED,e))})),t.once("dispose",(function(){clearTimeout(o),r(new _(g.WS_ABORT))}))}))},t.prototype.connect=function(e){var t=this;return new Promise((function(n,r){t._ws=new WebSocket(e),t._ws.onopen=function(){t._onOpen(),t._prvUrl=e,t._ws.onmessage=t._onMessage,t._ws.onclose=t._onClose,t._startHeartBeatCheck(),n()},t._ws.onclose=function(e){t._ws=null,r(new _(g.CONNECT_FAILED,"websocket error code: "+e.code))},setTimeout((function(){t._ws&&t._ws.readyState!==WebSocket.OPEN&&(t._ws.onopen=null,t._ws.onclose=null,t._ws.close(),t._ws=null,r(new _(g.CONNECT_TIMEOUT)))}),5e3),t.once("dispose",(function(){r(new _(g.WS_ABORT))}))}))},t.prototype.dispose=function(){this._clearHeartBeatCheck(),this.emit("dispose"),this.removeEvent(),this._ws&&(this._ws.onopen=null,this._ws.onclose=null,this._ws.onmessage=null,this._ws.close()),this._ws=null},t.prototype._sendPing=function(e){if(!this._ws||this._ws.readyState!==WebSocket.OPEN)throw new _(g.WS_DISCONNECTED);var t=this._requestId++;return e.requestId=t,this._ws.send(JSON.stringify(e)),t},t.prototype._startHeartBeatCheck=function(){var e=this;this._heartBeatTimer=window.setInterval((function(){e._sendPing({command:"ping",appId:e.appId,cname:e.cname,uid:e.uid+"",sid:e.sid,ts:+new Date,requestId:0})}),3e3)},t.prototype._clearHeartBeatCheck=function(){window.clearInterval(this._heartBeatTimer)},t}(c.default),_=function(e,t,n){void 0===e&&(e=""),this.code=n,this.data=t,this.message=e};t.ChannelMediaError=_,function(e){e.CONNECT_FAILED="connect failed",e.CONNECT_TIMEOUT="connect timeout",e.WS_DISCONNECTED="websocket disconnected",e.REQUEST_TIMEOUT="request timeout",e.REQUEST_FAILED="request failed",e.WAIT_STATUS_TIMEOUT="wait status timeout",e.WAIT_STATUS_ERROR="wait status error",e.BAD_STATE="bad state",e.WS_ABORT="ws abort",e.AP_REQUEST_TIMEOUT="AP request timeout",e.AP_JSON_PARSE_ERROR="AP json parse error",e.AP_REQUEST_ERROR="AP request error",e.AP_REQUEST_ABORT="AP request abort"}(g=t.CHANNEL_MEDIA_ERROR||(t.CHANNEL_MEDIA_ERROR={})),function(e){e[e.SetSdkProfile=0]="SetSdkProfile",e[e.SetSourceChannel=1]="SetSourceChannel",e[e.SetSourceUserId=2]="SetSourceUserId",e[e.SetDestChannel=3]="SetDestChannel",e[e.StartPacketTransfer=4]="StartPacketTransfer",e[e.StopPacketTransfer=5]="StopPacketTransfer",e[e.UpdateDestChannel=6]="UpdateDestChannel",e[e.Reconnect=7]="Reconnect",e[e.SetVideoProfile=8]="SetVideoProfile"}(v||(v={})),function(e){e[e.NETWORK_DISCONNECTED=0]="NETWORK_DISCONNECTED",e[e.NETWORK_CONNECTED=1]="NETWORK_CONNECTED",e[e.PACKET_JOINED_SRC_CHANNEL=2]="PACKET_JOINED_SRC_CHANNEL",e[e.PACKET_JOINED_DEST_CHANNEL=3]="PACKET_JOINED_DEST_CHANNEL",e[e.PACKET_SENT_TO_DEST_CHANNEL=4]="PACKET_SENT_TO_DEST_CHANNEL",e[e.PACKET_RECEIVED_VIDEO_FROM_SRC=5]="PACKET_RECEIVED_VIDEO_FROM_SRC",e[e.PACKET_RECEIVED_AUDIO_FROM_SRC=6]="PACKET_RECEIVED_AUDIO_FROM_SRC",e[e.PACKET_UPDATE_DEST_CHANNEL=7]="PACKET_UPDATE_DEST_CHANNEL",e[e.PACKET_UPDATE_DEST_CHANNEL_REFUSED=8]="PACKET_UPDATE_DEST_CHANNEL_REFUSED",e[e.PACKET_UPDATE_DEST_CHANNEL_NOT_CHANGE=9]="PACKET_UPDATE_DEST_CHANNEL_NOT_CHANGE"}(m=t.CHANNEL_MEDIA_RELAY_EVENT||(t.CHANNEL_MEDIA_RELAY_EVENT={})),function(e){e[e.RELAY_STATE_IDLE=0]="RELAY_STATE_IDLE",e[e.RELAY_STATE_CONNECTING=1]="RELAY_STATE_CONNECTING",e[e.RELAY_STATE_RUNNING=2]="RELAY_STATE_RUNNING",e[e.RELAY_STATE_FAILURE=3]="RELAY_STATE_FAILURE"}(y=t.CHANNEL_MEDIA_RELAY_STATE||(t.CHANNEL_MEDIA_RELAY_STATE={})),function(e){e[e.RELAY_OK=0]="RELAY_OK",e[e.SERVER_ERROR_RESPONSE=1]="SERVER_ERROR_RESPONSE",e[e.SERVER_NO_RESPONSE=2]="SERVER_NO_RESPONSE",e[e.NO_RESOURCE_AVAILABLE=3]="NO_RESOURCE_AVAILABLE",e[e.FAILED_JOIN_SRC=4]="FAILED_JOIN_SRC",e[e.FAILED_JOIN_DEST=5]="FAILED_JOIN_DEST",e[e.FAILED_PACKET_RECEIVED_FROM_SRC=6]="FAILED_PACKET_RECEIVED_FROM_SRC",e[e.FAILED_PACKET_SENT_TO_DEST=7]="FAILED_PACKET_SENT_TO_DEST",e[e.SERVER_CONNECTION_LOST=8]="SERVER_CONNECTION_LOST",e[e.INTERNAL_ERROR=9]="INTERNAL_ERROR",e[e.SRC_TOKEN_EXPIRED=10]="SRC_TOKEN_EXPIRED",e[e.DEST_TOKEN_EXPIRED=11]="DEST_TOKEN_EXPIRED",e[e.RELAY_ALREADY_START=12]="RELAY_ALREADY_START",e[e.RELAY_NOT_START=13]="RELAY_NOT_START",e[e.OPERATION_ABORT=14]="OPERATION_ABORT"}(b=t.CHANNEL_MEDIA_RELAY_ERROR||(t.CHANNEL_MEDIA_RELAY_ERROR={}))},function(e,t,n){"use strict";n.r(t),n.d(t,"isLiveTranscodingValid",(function(){return m})),n.d(t,"generateSessionId",(function(){return A})),n.d(t,"audioLevelHelper",(function(){return h})),n.d(t,"vsResHack",(function(){return g})),n.d(t,"is32Uint",(function(){return v})),n.d(t,"safeCall",(function(){return d})),n.d(t,"random",(function(){return b})),n.d(t,"popBanTip",(function(){return w})),n.d(t,"lengthInUtf8Bytes",(function(){return E})),n.d(t,"audioTimerLoop",(function(){return _})),n.d(t,"generateId",(function(){return p}));var r=n(11),i=n.n(r),o=n(4),a=n(0),s=n(28),c=n.n(s),u=n(25),l=n(15),d=function(){var e=arguments[0];if("function"==typeof e){var t=Array.prototype.slice.call(arguments,1);e.apply(null,t)}},h=function(e){return this.audioContext=Object(u.a)(),this.sourceNode=e.otWebkitAudioSource||this.audioContext.createMediaStreamSource(e),this.analyser=this.audioContext.createAnalyser(),this.timeDomainData=new Uint8Array(this.analyser.frequencyBinCount),this.sourceNode.connect(this.analyser),this.getAudioLevel=function(){if(this.analyser){this.analyser.getByteTimeDomainData(this.timeDomainData);for(var e=0,t=0;t<this.timeDomainData.length;t++)e=Math.max(e,Math.abs(this.timeDomainData[t]-128));return e/128}return a.default.warning("can't find analyser in audioLevelHelper"),0},this},f=1e4;function p(){return++f}function A(){return c()().replace(/-/g,"").toUpperCase()}var g=function(e,t,n){try{a.default.debug("start vsResHack",e);var r=document.createElement("video");r.setAttribute("autoplay",""),r.setAttribute("muted",""),r.muted=!0,r.setAttribute("playsinline",""),r.setAttribute("style","position: absolute; top: 0; left: 0; width:1px; high:1px;"),document.body.appendChild(r),r.addEventListener("playing",(function(n){o.isFireFox()?r.videoWidth&&(a.default.debug("[vsResHack] get stream resolution: ","".concat(r.videoWidth," x ").concat(r.videoHeight),e),t(r.videoWidth,r.videoHeight),document.body.removeChild(r)):(a.default.debug("[vsResHack] get stream resolution: ","".concat(r.videoWidth," x ").concat(r.videoHeight),e),t(r.videoWidth,r.videoHeight),document.body.removeChild(r))})),Object(l.setSrcObject)(r,e)}catch(e){n(e)}},v=function(e){return"number"==typeof e&&0<=e&&e<=4294967295},m=function(e){var t=["lowLatency","userConfigExtraInfo","transcodingUsers"];for(var n in e)if("lowLatency"===n&&"boolean"!=typeof e[n]||"userConfigExtraInfo"===n&&"object"!==i()(e[n])||"transcodingUsers"===n&&!y(e[n])||!~t.indexOf(n)&&"number"!=typeof e[n])throw new Error("Param ["+n+"] is inValid");return!0},y=function(e){for(var t=0;t<e.length;t++)for(var n in e[t])if("number"!=typeof e[t][n])throw new Error("Param user["+t+"] - ["+n+"] is inValid");return!0},b=function(e){isNaN(e)&&(e=1e3);var t=+new Date,n=(t=(9301*t+49297)%233280)/233280;return Math.ceil(n*e)},E=function(e){var t=encodeURIComponent(e).match(/%[89ABab]/g);return e.length+(t?t.length:0)},_=function(e,t){var n=1/t,r=Object(u.a)(),i=r.createGain();i.gain.value=0,i.connect(r.destination);var o=!1;return function t(){var a=r.createOscillator();a.onended=t,a.connect(i),a.start(0),a.stop(r.currentTime+n),e(r.currentTime),o&&(a.onended=function(){})}(),function(){o=!0}},w=function(){if(!document.getElementById("agora-ban-tip")){var e=document.createElement("div");e.id="agora-ban-tip",e.style="position: absolute; width: 100%; height: 100%; display: flex; justify-content: center; align-items: center; color: #fff;",document.querySelector("body").prepend(e);var t=document.createElement("div");t.style="background: #000; width: 346px; height: 116px; z-index: 100000; opacity: 0.6; border-radius: 10px; box-shadow: 0 2px 4px #000;",e.append(t);var n=document.createElement("div");n.style="height: 76px; display: flex; justify-content: center; align-items: center;";var r=document.createElement("span");r.style="height: 28px; width: 28px; color: #000; text-align: center; line-height: 30px; background: #fff; border-radius: 50%; font-weight: 600; font-size: 20px;margin-right: 5px;",r.innerText="!";var i=document.createElement("span");i.innerText="This browser does not support webRTC",n.append(r),n.append(i);var o=document.createElement("div");o.style="height: 38px; display: flex; border-top: #fff 1px solid; justify-content: center; align-items: center;",o.innerText="OK",t.append(n),t.append(o),o.onclick=function(){var e=document.getElementById("agora-ban-tip");e.parentNode.removeChild(e)}}}},function(e,t){function n(t){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?e.exports=n=function(e){return typeof e}:e.exports=n=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(t)}e.exports=n},function(t,n,r){"use strict";var i=r(13),o=r.n(i),a=r(17),s=r.n(a),c=r(11),u=r.n(c),l=r(30),d=r.n(l),h=r(7),f=r.n(h),p=r(22),A=r(8),g=function(e){e&&e.apply(this,[].slice.call(arguments,1))},v=r(0),m=r(1),y=r(10),b=r(14),E=r(3),_=function(e){var t=Object(A.b)(e);t.needReconnect=!0,t.isTimeout=!1,t.isInit=!0,t.sendbytes=0,t.recvbytes=0,t.startTime=Date.now(),t.lastMsgTime=null,t.clientId=e.clientId,t.hostIndex=0,t.requestID=0,e.host instanceof Array?t.host=e.host:t.host=[e.host],t.getSendBytes=function(){return t.sendbytes},t.getRecvBytes=function(){return t.recvbytes},t.getDuration=function(){return Math.ceil((Date.now()-t.startTime)/1e3)},t.getURL=function(){return t.connection.url},t.reconnect=function(){t.isInit=!0,t.creatConnection()},t.connectNext=function(){t.isInit=!0,++t.hostIndex,v.default.debug("["+t.clientId+"] Gateway length:"+t.host.length+" current index:"+t.hostIndex),t.hostIndex>=t.host.length?t.dispatchEvent(Object(A.d)({type:"recover"})):t.creatConnection()},t.replaceHost=function(e){t.host=e||t.host,t.hostIndex=0,t.creatConnection()},t.creatConnection=function(){t.needReconnect=!0,t.lts=(new Date).getTime(),t.connection=new WebSocket("wss://"+t.host[t.hostIndex]),t.connection.binaryType="arraybuffer",t.turnConfig={};var n=e.proxyServerType;if(t.connection.url&&3!==n){var r=t.connection.url.match(/wss\:\/\/([^:]+):(\d+)/),i=t.host[t.hostIndex].split(":"),o=t.connection.url.match(/h=([^:]+)&p=(\d+)/);r?(t.turnConfig.url=r[1],Object(E.getParameter)("TURN_ENABLE_TCP")&&(t.turnConfig.tcpport=parseInt(r[2])+30),Object(E.getParameter)("TURN_ENABLE_UDP")&&(t.turnConfig.udpport=parseInt(r[2])+30)):o?(t.turnConfig.url=o[1],Object(E.getParameter)("TURN_ENABLE_TCP")&&(t.turnConfig.tcpport=parseInt(o[2])+30),Object(E.getParameter)("TURN_ENABLE_UDP")&&(t.turnConfig.udpport=parseInt(o[2])+30)):i&&(t.turnConfig.url=i[0],Object(E.getParameter)("TURN_ENABLE_TCP")&&(t.turnConfig.tcpport=parseInt(i[1])+30),Object(E.getParameter)("TURN_ENABLE_UDP")&&(t.turnConfig.udpport=parseInt(i[1])+30))}t.connection.onopen=function(e){t.needReconnect=!0,t.isTimeout=!1,t.isInit=!1,t.sendbytes=0,t.recvbytes=0,t.startTime=Date.now(),Object(b.resetHTTPByetsCount)(),clearTimeout(t.timeoutCheck),t.dispatchEvent(Object(A.d)({type:"onopen",event:e,socket:t}))},t.connection.onmessage=function(e){if(e.data instanceof ArrayBuffer)t.dispatchEvent({type:"onBinaryData",data:e.data});else{t.recvbytes+=Object(y.lengthInUtf8Bytes)(e.data);var n=JSON.parse(e.data);t.lastMsgTime=Date.now(),n.hasOwnProperty("_id")?t.dispatchEvent(Object(A.d)({type:n._id,msg:n})):n.hasOwnProperty("_type")&&t.dispatchSocketEvent(Object(A.d)({type:n._type,msg:n._message}))}},t.connection.onclose=function(n){t.needReconnect?t.isTimeout||t.isInit?(v.default.debug("["+t.clientId+"] websockect connect timeout"),m.report.joinGateway(e.sid,{lts:t.lts,succ:!1,ec:"timeout",addr:t.connection.url}),t.connectNext()):(t.dispatchEvent(Object(A.d)({type:"disconnect",event:n})),t.requests&&t.requests instanceof Array&&(t.requests.map((function(e){e.callback("REQUEST_ABORT")})),t.requests=[])):(v.default.debug("["+t.clientId+"] websockect closeed"),g(e.onFailure,n),clearTimeout(t.timeoutCheck),t.dispatchEvent(Object(A.d)({type:"close",event:n})),t.connection.onopen=void 0,t.connection.onclose=void 0,t.connection.onerror=void 0,t.connection.onmessage=void 0,t.connection=void 0)},t.connection.onerror=function(e){},setTimeout((function(){t.connection&&t.connection.readyState!=WebSocket.OPEN&&(t.isTimeout=!0,t.connection.close())}),5e3)},t.creatConnection(),t.sendMessage=function(e,n){if(t.connection&&t.connection.readyState==WebSocket.OPEN){var r=JSON.stringify(e);t.sendbytes+=Object(y.lengthInUtf8Bytes)(r),t.connection.send(r)}else n({error:"Gateway not connected"})},t.disconnect=function(){t.needReconnect=!0,t.connection.close()},t.close=function(){t.needReconnect=!1,t.connection.onclose=void 0,t.connection.close(),clearInterval(t.requestTimer),t.requests&&t.requests instanceof Array&&(t.requests.map((function(e){e.callback("REQUEST_ABORT")})),t.requests=[])},t.sendSignalCommand=function(e,n){e._id="_request_"+t.requestID,t.requestID+=1,"publish_stats"!==e._type&&"subscribe_stats"!==e._type&&"publish_stats_low"!==e._type&&t.on(e._id,(function(r){r.msg&&n&&n(r.msg._result,r.msg.message),delete t.dispatcher.eventListeners[e._id]})),t.sendMessage(e,(function(e){e.reason="NOT_CONNECTED",n&&n(e.reason,e)}))},t.requests=[];var n=function(e){var n=t.requests.findIndex((function(t){return t.id===e.type}));if(n>=0)var r=t.requests.splice(n,1)[0];r&&t.dispatcher.eventListeners[e.type]?(delete t.dispatcher.eventListeners[e.type],e.msg&&r.callback&&r.callback(e.msg._result,e.msg._message)):v.default.warning("Detached Response",e.type,e.msg)},r=function(e){var n=this,r=t.requests.findIndex((function(e){return e.id===n.id}));r>=0&&(n=t.requests.splice(r,1)[0]),n&&t.dispatcher.eventListeners[e.type]?(delete t.dispatcher.eventListeners[e.type],e.reason="NOT_CONNECTED",n.callback&&n.callback(e.reason,e)):v.default.warning("handleSendError",n)};return t.sendRequest=function(e,i){e=f()({_id:"_request_"+t.requestID},e),t.requestID+=1;var o={id:e._id,timeoutCounter:0,stalledAt:Date.now(),message:e,callback:i};t.requests.push(o),t.addEventListener(e._id,n),t.sendMessage(e,r.bind(o))},t.checkRequestTimeout=function(){for(var e=Math.ceil(Object(E.getParameter)("SIGNAL_REQUEST_TIMEOUT")/Object(E.getParameter)("SIGNAL_REQUEST_WATCH_INTERVAL")),n=t.requests.length-1;n>=0;n--){var r=t.requests[n];r.timeoutCounter>=e?(t.requests.splice(n,1),v.default.error("Request Timeout",r.timeoutCounter,r.message),r.callback&&r.callback("TIMEOUT")):r.timeoutCounter++}},clearInterval(t.requestTimer),t.requestTimer=setInterval(t.checkRequestTimeout,Object(E.getParameter)("SIGNAL_REQUEST_WATCH_INTERVAL")),t.sendReport=function(e){t.sendMessage(e,(function(){}))},t},w=function(e,t){var n={connect:function(){t.host=e,n.signal=_(t),n.on=n.signal.on,n.dispatchEvent=n.signal.dispatchEvent,n.signal.on("onopen",(function(e){n.signal.onEvent=function(e){n.dispatchEvent(Object(A.d)({type:e.event,msg:e}))},n.dispatchEvent(Object(A.d)({type:"connect",msg:e}))})),n.signal.on("onError",(function(e){var t=e.msg;onError(t.code,"error")}))},getLastMsgTime:function(){return n.signal&&n.signal.lastMsgTime},getSendBytes:function(){return n.signal.getSendBytes()},getRecvBytes:function(){return n.signal.getRecvBytes()},getDuration:function(){return n.signal.getDuration()},disconnect:function(){n.signal.disconnect()},close:function(){n.signal.close()},getURL:function(){return n.signal.getURL()},reconnect:function(){n.signal.reconnect()},connectNext:function(){n.signal.connectNext()},replaceHost:function(e){n.signal.replaceHost(e)},emitSimpleMessage:function(e,t){n.signal.sendSignalCommand(e,t)},emitRequest:function(e,t){n.signal.sendRequest(e,t)},emitReport:function(e){n.signal.sendReport(e)}};return n.connect(),n},S=r(23),T=r(5),R=r(20),C=r(4),I={ERR_NO_VOCS_AVAILABLE:"tryNext",ERR_NO_VOS_AVAILABLE:"tryNext",ERR_JOIN_CHANNEL_TIMEOUT:"tryNext",WARN_REPEAT_JOIN:"quit",ERR_JOIN_BY_MULTI_IP:"recover",WARN_LOOKUP_CHANNEL_TIMEOUT:"tryNext",WARN_OPEN_CHANNEL_TIMEOUT:"tryNext",ERR_VOM_SERVICE_UNAVAILABLE:"tryNext",ERR_TOO_MANY_USERS:"tryNext",ERR_MASTER_VOCS_UNAVAILABLE:"tryNext",ERR_INTERNAL_ERROR:"tryNext",K_SERVICE_NOT_READY:"tryNext",K_SERVICE_TOO_HEAVY:"tryNext",notification_test_recover:"recover",notification_test_tryNext:"tryNext",notification_test_retry:"retry"},x={googActualEncBitrate:"A_aeb",googAvailableSendBandwidth:"A_asb",googRetransmitBitrate:"A_rb",googAvailableReceiveBandwidth:"A_arb",googTargetEncBitrate:"A_teb",googBucketDelay:"A_bd",googTransmitBitrate:"A_tb",googCodecName:"A_cn",bytesSent:"bytesSent",packetsLost:"packetsLost",packetsSent:"packetsSent",googAdaptationChanges:"A_ac",googAvgEncodeMs:"A_aem",googEncodeUsagePercent:"A_eup",googFirsReceived:"A_fr",googFrameHeightInput:"A_fhi",googFrameHeightSent:"A_fhs",googFrameRateInput:"A_fri",googFrameRateSent:"A_frs",googFrameWidthInput:"A_fwi",googFrameWidthSent:"A_fws",googNacksReceived:"A_nr",googPlisReceived:"A_pr",googRtt:"A_rtt",aecDivergentFilterFraction:"A_adff",audioInputLevel:"A_ail",googEchoCancellationReturnLoss:"A_ecrl",googEchoCancellationReturnLossEnhancement:"A_ecrle",googResidualEchoLikelihood:"A_rel",googResidualEchoLikelihoodRecentMax:"A_relrm",googTargetDelayMs:"A_tdm",bytesReceived:"bytesReceived",packetsReceived:"packetsReceived",googDecodeMs:"A_dm",googMaxDecodeMs:"A_mdm",googRenderDelayMs:"A_rdm",googFrameWidthReceived:"A_fwr",googFrameHeightReceived:"A_fhr",googFrameRateReceived:"A_frr",googFrameRateDecoded:"A_frd",googFrameRateOutput:"A_fro",googJitterBufferMs:"A_jbm",googCurrentDelayMs:"A_cdm",googMinPlayoutDelayMs:"A_mpdm",googNacksSent:"A_ns",googPlisSent:"A_ps",googFirsSent:"A_fs",audioOutputLevel:"A_aol",googAccelerateRate:"A_ar",googDecodingCNG:"A_dcng",googDecodingCTN:"A_dctn",googDecodingCTSG:"A_dctsg",googDecodingNormal:"A_dn",googDecodingPLC:"A_dplc",googDecodingPLCCNG:"A_dplccng",googExpandRate:"A_er",googJitterReceived:"A_jr",googPreemptiveExpandRate:"A_per",googPreferredJitterBufferMs:"A_pjbm",googSecondaryDecodedRate:"A_sdr",googSpeechExpandRate:"A_ser",uplink_fraction_lost:"B_ufl",uplink_cumulative_lost:"B_ucl",uplink_available_bandwidth:"B_uab",period_fir:"B_fir",access_delay:"B_acd",uplink_network_quality:"B_unq",downlink_network_quality:"B_dnq",pub_audio_lost_ratio_400ms:"B_palr4",pub_video_lost_ratio_400ms:"B_pvlr4",e2e_delay:"B_ed",audio_delay:"B_ad",video_delay:"B_vd",stream_type:"B_st",e2e_audio_lost_ratio_400ms:"B_ealr4",e2e_video_lost_ratio_400ms:"B_evlr4",downlink_estimate_bandwidth:"B_deb",peer_publish_audio_duration:"B_ppad",peer_publish_video_duration:"B_ppvd"},O={};for(var N in x){var B=x[N];O[B]&&v.default.error("Key Conflict: ".concat(B,": ").concat(x[B],"| ").concat(N)),O[B]=N}var M=function(e){return x[e]||e},L=function(e){return O[e]||e},k=r(9),U=r.n(k),D=r(51),P=function t(n){var r=!1,i=function(e){return{_type:"control",_message:e}},a=function(e,t){var n={};return Object.keys(t).forEach((function(e){Object(E.getParameter)("STATS_FILTER")[e]||(n[M(e)]=t[e])})),{_type:"subscribe_related_stats",_message:{stream_type:"high",stream_id:e,stats:n}}},c=function(e){return{_type:"publish",_message:e}},l=function(e,t){var n={};return Object.keys(t).forEach((function(e){Object(E.getParameter)("STATS_FILTER")[e]||(n[M(e)]=t[e])})),{_type:"subscribe_stats",_message:{stream_id:e,stats:n}}},h=t.DISCONNECTED,b=t.CONNECTING,_=t.CONNECTED,x=t.DISCONNECTING,O=h,N=Object(A.b)(n);Object.defineProperty(N,"state",{set:function(e){var n=O;O=e,Object(R._setClientConnectionStateRecord)(N.clientId,e),e!==t.CONNECTED&&e!==t.DISCONNECTING&&(N.hasJoined=!1),n!==e&&N.dispatchEvent({type:"connection-state-change",prevState:t.connetionStateMap[n],curState:t.connetionStateMap[e]})},get:function(){return O}}),N.socket=void 0,N.state=h,N.mode=n.mode,N.role=n.role,N.codec=n.codec,N.config={},N.timers={},N.timer_counter={},N.localStreams={},N.remoteStreams={},N.remoteMuteState={},N.attemps=1,N.p2p_attemps=1,N.audioLevel={},N.activeSpeaker=void 0,N.reconnectMode="tryNext",N.rejoinAttempt=0,N.hasChangeBGPAddress=!1,N.traffic_stats={},N.clientId=n.clientId,N.pingpongCounter=0,N.hasInvokeLeave=!1,N.p2ps=new Map,N.liveStreams=new Map,N.injectLiveStreams=new Map,N.remoteStreamsInChannel=new Set,N.subscribeRequestId=new Map,N.publishRequestId=0,N.hasJoined=!1,N.isFirstSuccess=!0,N.peerPublishDurationMap=new Map,function(e){var t=g;e.makeRequest=function(n,r,i){if(void 0===e.socket)return v.default.debug("[".concat(e.clientId,"] No socket available")),void t(i,T.default.INVALID_OPERATION);try{e.socket.emitRequest(n,(function(e,t){var n;"success"===e?"function"==typeof r&&r(t):"function"==typeof i&&(n=t&&t.error_code&&T.GatewayErrorCode[t.error_code]?T.GatewayErrorCode[t.error_code]:t&&t.error_str?t.error_str:t&&t.error_code?"UNKNOW_ERROR_".concat(t.error_code):e,i(n,t))}))}catch(r){v.default.debug("[".concat(e.clientId,"] Socket emit message failed ").concat(JSON.stringify(n))),v.default.debug("[".concat(e.clientId,"] "),r),t(i,T.default.SOCKET_ERROR)}},e.makeReport=function(t){void 0===e.socket&&v.default.debug("[".concat(e.clientId,"] No socket available"));try{e.socket.emitReport(t)}catch(n){v.default.debug("[".concat(e.clientId,"] Socket emit report failed ").concat(JSON.stringify(t)))}}}(N),N.inChannelInfo={joinAt:null,duration:0},N._sendMessage=function(e,t){switch(e){case"SubscribeStats":N.makeReport(l.apply(void 0,d()(t)));break;case"SubscribeRelatedStats":N.makeReport(a.apply(void 0,d()(t)))}};var B=g;N.p2pCounter=Object(y.random)(1e5),N.generateP2PId=function(){return++N.p2pCounter},N.audioVolumeIndication={enabled:!1,sortedAudioVolumes:[],smooth:3,interval:2e3},N.remoteVideoStreamTypes={REMOTE_VIDEO_STREAM_HIGH:0,REMOTE_VIDEO_STREAM_LOW:1,REMOTE_VIDEO_STREAM_MEDIUM:2},N.streamFallbackTypes={STREAM_FALLBACK_OPTION_DISABLED:0,STREAM_FALLBACK_OPTION_VIDEO_STREAM_LOW:1,STREAM_FALLBACK_OPTION_AUDIO_ONLY:2},N.configPublisher=function(e){N.config=e},N.getGatewayInfo=function(e,t){N.makeRequest({_type:"gateway_info"},e,t)},N.setClientRole=function(e,t){v.default.debug("[".concat(N.clientId,"] setClientRole to ").concat(e));var n=m.report.reportApiInvoke(N.joinInfo.sid,{name:"_setClientRole",callback:t});N.makeRequest({_type:"set_client_role",_message:{role:e}},(function(){N.role=e,N.dispatchEvent({type:"client-role-changed",role:e}),n&&n(null,{role:e})}),(function(t,r){if(r&&r.code&&(t=T.GatewayErrorCode[r.code]||"UNKNOW_ERROR_"+r.code),"ERR_SET_CLIENT_ROLE_ALREADY_IN_USE"===t)return n&&n(null);v.default.error("set Client role error to "+e+": "+t),n&&n(t)}))},N.join=function(e,t,r,i){N.hasInvokeLeave=!1,e.useProxyServer&&(N.hasChangeBGPAddress=!0);var o=(new Date).getTime(),a=e.uid;if(N.inChannelInfo.joinAt&&(N.inChannelInfo.duration+=o-N.inChannelInfo.joinAt),N.inChannelInfo.joinAt=o,N.state!==b)return v.default.error("[".concat(N.clientId,"] GatewayClient.join Failed: state "),N.state),i&&i(T.default.INVALID_OPERATION),void m.report.joinGateway(e.sid,{lts:o,succ:!1,ec:T.default.INVALID_OPERATION,addr:null});if(null!=a&&parseInt(a)!==a)return v.default.error("[".concat(N.clientId,"] Input uid is invalid")),N.state=h,i&&i(T.default.INVALID_PARAMETER),void m.report.joinGateway(e.sid,{lts:o,succ:!1,ec:T.default.INVALID_PARAMETER,addr:null});var s=F.register(N,{uid:a,cname:e&&e.cname});if(s)return N.state=h,i&&i(s),void m.report.joinGateway(e.sid,{lts:o,succ:!1,ec:s,addr:null});N.joinInfo=f()({},e),N.uid=a,N.key=t,N.pingpongCounter=0,V(e,(function(t){if(e.useLocalAccessPoint)try{var s=N.socket.signal.connection.url.match(/wss\:\/\/([^:]+):(\d+)/)[1];Object(E.setParameter)("EVENT_REPORT_DOMAIN",s),Object(E.setParameter)("EVENT_REPORT_BACKUP_DOMAIN",s),Object(E.setParameter)("LOG_UPLOAD_SERVER","".concat(s,":6444"))}catch(e){v.default.debug("[".concat(N.clientId,"] LocalAccessPoint error: ").concat(e))}if(N.state===x||N.state===h)return i&&i("LEAVE_BEFORE_JOIN_SUCCESS");N.state=_,v.default.debug("[".concat(N.clientId,"] Connected to gateway server")),clearInterval(N.pingTimer),N.pingTimer=setInterval((function(){var e=Object(E.getParameter)("PING_PONG_TIME_OUT");if(++N.pingpongCounter>=e){var t=Date.now();N.socket&&v.default.warning("PINGPONG Timeout. Last Socket Message: ".concat(t-N.socket.getLastMsgTime(),"ms")),N.socket&&N.socket.getLastMsgTime()&&t-N.socket.getLastMsgTime()>Object(E.getParameter)("WEBSOCKET_TIMEOUT_MIN")&&(N.pingpongCounter=0,N.socket.close(),N.socket.dispatchEvent(Object(A.d)({type:"disconnect",event:{msg:"PING_PONG_TIME_OUT"}})))}var n=Date.now();N.makeRequest({_type:"ping"},(function(){N.pingpongCounter=0;var e=Date.now()-n;setTimeout((function(){Object(E.getParameter)("REPORT_STATS")&&N.makeRequest({_type:"ping_back",_message:{pingpongElapse:e}})}),1e3)}),(function(e,t){"TIMEOUT"!==e&&(v.default.error("Ping Error ".concat(e," ").concat(JSON.stringify(t))),t&&t.error_code&&N.socket&&N.socket.signal&&N.socket.signal.connection&&N.socket.signal.connection.readyState===WebSocket.OPEN&&(v.default.info("Disconnecting websocket connection"),N.socket.signal.connection.close()))}))}),3e3),N.makeRequest(function(e){var t=e.role,r=f()({},N.joinInfo.apResponse),i={session_id:N.joinInfo.sid,app_id:n.appId,channel_key:N.key,channel_name:N.joinInfo.cname,sdk_version:E.VERSION,browser:navigator.userAgent,process_id:Object(m.getProcessId)(),mode:N.mode,codec:N.codec,role:t,has_changed_gateway:Object(E.getParameter)("FORCE_CHANGED_GATEWAY_FLAG")||N.hasChangeBGPAddress,ap_response:r,optionalInfo:N.joinInfo.optionalInfo,extend:Object(E.getParameter)("JOIN_EXTEND"),details:{}};if(N.joinInfo.hasOwnProperty("stringUid")&&(i.string_uid=N.joinInfo.stringUid),N.joinInfo.aesmode&&N.joinInfo.aespassword&&(i.aes_mode=N.joinInfo.aesmode,i.aes_secret=Object(D.encryptAES)(N.joinInfo.aespassword,N.joinInfo.uid),i.aes_encrypt=!0),N.socket&&N.socket.signal&&N.socket.signal&&(r.addresses[N.socket.signal.hostIndex]&&(i.ap_response.ticket=r.addresses[N.socket.signal.hostIndex].ticket,delete r.addresses),Object(E.getParameter)("SET_DEFAULT_TURNSERVER")&&N.socket.signal.turnConfig)){var o={username:"test",credential:Object(E.getParameter)("TURN_SERVER_PASSWORD"),forceturn:Object(E.getParameter)("FORCE_TURN")};o.url=N.socket.signal.turnConfig.url,N.socket.signal.turnConfig.tcpport&&(o.tcpport=""+N.socket.signal.turnConfig.tcpport),N.socket.signal.turnConfig.udpport&&(o.udpport=""+N.socket.signal.turnConfig.udpport),N.joinInfo.turnServers.find((function(e){if(e.url===o.url)return!0}))||N.joinInfo.turnServers.push(o)}return 3===N.joinInfo.proxyServerType&&(i.plugin="web_cloud_proxy"),N.dispatchEvent({type:"join-message-hook",joinMessage:i}),{_type:"join",_message:i}}({role:N.role}),(function(t){if(m.report.joinGateway(e.sid,{lts:o,succ:!0,ec:null,vid:e.vid,addr:N.socket.getURL(),firstSuccess:N.isFirstSuccess}),N.joinSuccessLts=Date.now(),N.isFirstSuccess=!1,N.rejoinAttempt=0,N.hasJoined=!0,r&&r(t.uid),!0===t.return_vosip||!0===Object(E.getParameter)("ENABLE_LIVE_SERVER_LIST")){var n=null;try{n=N.socket.signal.connection.url}catch(e){v.default.debug("[".concat(N.clientId,"] Can not get gateway ip: ").concat(e))}n?Object(E.setParameter)("LIVE_SERVER_LIST",[n]):Object(E.setParameter)("LIVE_SERVER_LIST",[])}N.dispatchEvent({type:"join"}),clearInterval(N.timers.trafficStats),N.timers.trafficStats=setInterval((function(){N.makeRequest({_type:"traffic_stats"},(function(e){var t={};for(var n in e)t[L(n)]=e[n];if(t.peer_delay&&t.peer_delay.length){var r=[];t.peer_delay.forEach((function(e){var t={};for(var n in e)t[L(n)]=e[n];r.push(t)})),t.peer_delay=r}N.traffic_stats=t,N.traffic_stats.timestamp=Date.now();var i=N.joinInfo.stringUid,o=N.localStreams[a]||N.localStreams[i];o&&(o.traffic_stats={access_delay:t.access_delay}),t.peer_delay&&t.peer_delay.forEach((function(e){var n=N.remoteStreams[e.peer_uid];n&&(n.traffic_stats={access_delay:t.access_delay,e2e_delay:e.e2e_delay,audio_delay:e.audio_delay,video_delay:e.video_delay})})),N.dispatchEvent({type:"after-getTrafficStats",trafficStats:t})}))}),3e3)}),(function(t,n){if(v.default.error("[".concat(N.clientId,"] User join failed [").concat(t,"]")),"ERR_JOIN_BY_MULTI_IP"===t){try{m.report.joinGateway(e.sid,{lts:o,succ:!1,ec:"ERR_JOIN_BY_MULTI_IP",addr:N.socket.getURL()})}catch(e){}return N.dispatchEvent({type:"onMultiIP",option:n.option})}I[t]&&N.rejoinAttempt<4?N._doWithAction(I[t],r,i):i&&i(t),m.report.joinGateway(e.sid,{lts:o,succ:!1,ec:t,addr:N.socket&&N.socket.getURL()})}))}),(function(t){v.default.error("[".concat(N.clientId,"] User join failed [").concat(t,"]")),i&&i(t),m.report.joinGateway(e.sid,{lts:o,succ:!1,ec:t,addr:N.socket.getURL()})})),this.remoteMuteState={},N.resetAudioVolumeIndication()},N.leave=function(e,t){var n=F.unregister(N);switch(n&&v.default.debug("[".concat(N.clientId,"] "),n),N.p2ps.clear(),N.state){case h:return v.default.debug("[".concat(N.clientId,"] Client Already in DISCONNECTED status")),void B(e);case x:return v.default.debug("[".concat(N.clientId,"] Client Already in DISCONNECTING status")),void B(t,T.default.INVALID_OPERATION);case b:return N.socket&&N.socket.close(),N.socket=void 0,v.default.info("[".concat(N.clientId,"] Client connecting, Leave channel success")),N.state=h,e&&e()}for(var r in N.state=x,N.channelMediaConfig&&(N.channelMediaRelayController&&N.channelMediaRelayController.dispose(),N.channelMediaConfig,N.channelMediaRelayController=null),clearInterval(N.pingTimer),N.timers)N.timers.hasOwnProperty(r)&&clearInterval(N.timers[r]);for(var r in N.inChannelInfo.joinAt&&(N.inChannelInfo.duration+=Date.now()-N.inChannelInfo.joinAt,N.inChannelInfo.joinAt=null),N.hasJoined?N.makeRequest({_type:"leave"},(function(t){N.socket.close(),N.socket=void 0,v.default.info("[".concat(N.clientId,"] Leave channel success")),N.state=h,e&&e(t)}),(function(e){"TIMEOUT"!==e&&"REQUEST_ABORT"!==e&&(v.default.error("[".concat(N.clientId,"] Leave Channel Failed"),e),N.state=_,t&&t(e))})):(N.socket&&(N.socket.close(),N.socket=void 0),v.default.info("[".concat(N.clientId,"] Leave channel before joined")),N.state=h,e&&e()),N.localStreams)if(N.localStreams.hasOwnProperty(r)){var i=N.localStreams[r];delete N.localStreams[r],void 0!==i.pc&&(i.pc.close(),i.pc=void 0)}z()},N.publish=function(e,t,n,r){var o=(new Date).getTime(),a=!1;if(e.publishLTS=o,"object"!==u()(e)||null===e)return v.default.error("[".concat(N.clientId,"] Invalid local stream")),r&&r(T.default.INVALID_LOCAL_STREAM),void m.report.publish(N.joinInfo.sid,{lts:o,succ:!1,audio:!1,video:!1,screenshare:!1,audioName:"",videoName:"",screenName:"",ec:T.default.INVALID_LOCAL_STREAM});if(!e.stream&&void 0===e.url)return v.default.error("[".concat(N.clientId,"] Invalid local media stream")),r&&r(T.default.INVALID_LOCAL_STREAM),void m.report.publish(N.joinInfo.sid,{lts:o,succ:!1,audio:!1,video:!1,screenshare:!1,audioName:"",videoName:"",screenName:"",ec:T.default.INVALID_LOCAL_STREAM});if(N.state!==_)return v.default.error("[".concat(N.clientId,"] User is not in the session")),r&&r(T.default.INVALID_OPERATION),void m.report.publish(N.joinInfo.sid,{lts:o,succ:!1,audio:e.hasAudio(),video:e.hasVideo(),screenshare:e.hasScreen(),audioName:e.hasAudio()&&e.audioName,videoName:e.hasVideo()&&e.videoName,screenName:e.hasScreen()&&e.screenName,ec:T.default.INVALID_OPERATION});var s=e.getAttributes()||{};if(e.local&&void 0===N.localStreams[e.getId()]&&(e.hasAudio()||e.hasVideo()||e.hasScreen())){var l=N.generateP2PId();if(N.p2ps.set(l,e),e.p2pId=l,void 0!==e.url)Q(c({state:"url",audio:e.hasAudio(),video:e.hasVideo(),attributes:e.getAttributes()},e.url),(function(t,n){"success"===t?(e.getUserId()!==n&&e.setUserId(n),N.localStreams[n]=e,e.onClose=function(){N.unpublish(e)}):v.default.error("[".concat(N.clientId,"] Publish local stream failed"),t)}));else{N.localStreams[e.getId()]=e,e.connectionSpec={callback:function(s){s||r&&r("CANNOT_GET_OFFER"),"motion"===e.optimizationMode&&e.pc.setRtpSenderParameters("maintain-framerate"),"detail"===e.optimizationMode&&e.pc.setRtpSenderParameters("maintain-resolution"),N.makeRequest(c({state:"offer",stream_type:1==t.streamType?"low":"high",p2p_id:l,sdp:s,audio:e.audio||e.screenAudio,video:e.screen||e.video,screen:e.screen,attributes:e.getAttributes(),dtx:e.DTX,hq:e.highQuality,lq:e.lowQuality,stereo:e.stereo,speech:e.speech,codec:N.codec,extend:Object(E.getParameter)("PUB_EXTEND")}),(function(t){e.getUserId()!==t.uid&&e.setUserId(t.uid),v.default.info("[".concat(N.clientId,"] Local stream published with uid"),t.uid),e.onClose=function(){N.unpublish(e)},e._onAudioUnmute=function(){N.makeReport(i({action:"unmute_local_audio",stream_id:e.getId()}))},e._onVideoUnmute=function(){N.makeReport(i({action:"unmute_local_video",stream_id:e.getId()}))},e._onAudioMute=function(){N.makeReport(i({action:"mute_local_audio",stream_id:e.getId()}))},e._onVideoMute=function(){N.makeReport(i({action:"mute_local_video",stream_id:e.getId()}))},e.getId()===e.getUserId()&&(e.isAudioOn()||e.hasAudio()&&(v.default.debug("[".concat(N.clientId,"] local stream audio mute")),e._onAudioMute()),e.isVideoOn()||(e.hasVideo()||e.hasScreen())&&(v.default.debug("[".concat(N.clientId,"] local stream video mute")),e._onVideoMute())),e.pc.oniceconnectionstatechange=function(t){if("failed"===t){if(null!=N.timers[e.getId()]&&(clearInterval(N.timers[e.getId()]),clearInterval(N.timers[e.getId()]+"_RelatedStats")),v.default.error("[".concat(N.clientId,"] Publisher connection is lost -- streamId: ").concat(e.getId(),", p2pId: ").concat(l)),N.p2ps.delete(l),v.default.debug("[".concat(N.clientId,"] publish p2p failed: "),N.p2ps),!a)return a=!0,m.report.publish(N.joinInfo.sid,{lts:o,succ:!1,audio:e.hasAudio(),video:e.hasVideo(),screenshare:e.hasScreen(),audioName:e.hasAudio()&&e.audioName,videoName:e.hasVideo()&&e.videoName,screenName:e.hasScreen()&&e.screenName,ec:T.default.PEERCONNECTION_FAILED,publishRequestid:N.publishRequestId||0,p2pid:l}),N.dispatchEvent(Object(A.a)({type:"pubP2PLost",stream:e})),r&&r(T.default.PEERCONNECTION_FAILED);N.dispatchEvent(Object(A.a)({type:"pubP2PLost",stream:e}))}else if("connected"===t&&(v.default.debug("[".concat(N.clientId,"] publish p2p connected: "),N.p2ps),e.getId()===e.getUserId()&&(e._isAudioMuted()?N.makeReport(i({action:"mute_local_audio",stream_id:e.getId()})):N.makeReport(i({action:"unmute_local_audio",stream_id:e.getId()})),e._isVideoMuted()?N.makeReport(i({action:"mute_local_video",stream_id:e.getId()})):N.makeReport(i({action:"unmute_local_video",stream_id:e.getId()}))),!a))return a=!0,m.report.publish(N.joinInfo.sid,{lts:o,succ:!0,audio:e.hasAudio(),video:e.hasVideo(),screenshare:e.hasScreen(),audioName:e.hasAudio()&&e.audioName,videoName:e.hasVideo()&&e.videoName,screenName:e.hasScreen()&&e.screenName,ec:null,publishRequestid:N.publishRequestId||0,p2pid:l}),n&&n()},e.pc.processSignalingMessage(t.sdp)}),(function(t,n){v.default.error("Publish Failed: ".concat(t)),m.report.publish(N.joinInfo.sid,{lts:o,succ:!1,audio:e.hasAudio(),video:e.hasVideo(),screenshare:e.hasScreen(),audioName:e.hasAudio()&&e.audioName,videoName:e.hasVideo()&&e.videoName,screenName:e.hasScreen()&&e.screenName,ec:t,publishRequestid:N.publishRequestId||0,p2pid:l}),"TIMEOUT"!=t&&(N.processPublishFailure(e),r&&r(t))}))},audio:e.hasAudio(),video:e.hasVideo(),screen:e.hasScreen(),optimizationMode:e.optimizationMode,isSubscriber:!1,stunServerUrl:N.stunServerUrl,turnServers:N.joinInfo.turnServers,maxAudioBW:s.maxAudioBW,minVideoBW:s.minVideoBW,maxVideoBW:s.maxVideoBW,mode:N.mode,codec:N.codec,isVideoMute:e.userMuteVideo||e.peerMuteVideo,isAudioMute:e.userMuteAudio||e.peerMuteAudio,maxFrameRate:e.attributes.maxFrameRate,agoraStream:e,clientId:N.clientId},e.pc=Object(S.a)(e.connectionSpec),e.pc.addStream(e.stream),v.default.debug("[".concat(N.clientId,"] PeerConnection add stream :"),e.stream),e.pc.onnegotiationneeded=function(n){"motion"===e.optimizationMode&&e.pc.setRtpSenderParameters("maintain-framerate"),"detail"===e.optimizationMode&&e.pc.setRtpSenderParameters("maintain-resolution");var r={state:"negotiation",stream_type:1===t.streamType?"low":"high",p2p_id:l,sdp:n};N.makeRequest(c(r),(function(t){v.default.debug("Negotating Stream ".concat(e.getId())),e.pc.processSignalingMessage(t.sdp)}),(function(e,t){v.default.error("Negotiation failed ".concat(e),t,r)}))},clearInterval(N.timers[e.getId()]),N.timers[e.getId()]=setInterval((function(){if(Object(E.getParameter)("REPORT_STATS")){var t=0;e&&e.pc&&e.pc.getStats&&e.pc.getStatsRate((function(n){n.forEach((function(n){if(n&&n.id&&!(/_recv$/.test(n.id)||/^time$/.test(n.id)||~n.type.toLowerCase().indexOf("inbound"))&&e.getUserId()){if(-1===n.id.indexOf("outbound_rtp")&&-1===n.id.indexOf("OutboundRTP")&&-1===n.type.toLowerCase().indexOf("outbound")||"video"!==n.mediaType||(n.googFrameWidthSent=e.videoWidth+"",n.googFrameHeightSent=e.videoHeight+""),"video"===n.mediaType)try{var r=e.stream.getVideoTracks()[0];n.A_vstd=r.enabled?"0":"1"}catch(e){}if("audio"===n.mediaType)try{var i=e.stream.getAudioTracks()[0];n.A_astd=i.enabled?"0":"1"}catch(e){}if(e.getId()==e.getUserId()){var o=200*t;t++,setTimeout((function(){var e=N.socket&&N.socket.getLastMsgTime()&&Date.now()-N.socket.getLastMsgTime();e>Object(E.getParameter)("REPORT_STATS_TIMEOUT")?v.default.debug("PublishStats report blocked by REPORT_STATS_TIMEOUT ".concat(e)):N.makeReport(function(e){var t={};return Object.keys(e).forEach((function(n){Object(E.getParameter)("STATS_FILTER")[n]||(t[M(n)]=e[n])})),{_type:"publish_stats",_message:{stream_type:"high",stats:t}}}(n))}),o)}else o=200*t,t++,setTimeout((function(){var e=N.socket&&N.socket.getLastMsgTime()&&Date.now()-N.socket.getLastMsgTime();e>Object(E.getParameter)("REPORT_STATS_TIMEOUT")?v.default.debug("PublishStatsLow report blocked by REPORT_STATS_TIMEOUT ".concat(e)):N.makeReport(function(e){var t={};return Object.keys(e).forEach((function(n){Object(E.getParameter)("STATS_FILTER")[n]||(t[M(n)]=e[n])})),{_type:"publish_stats",_message:{stream_type:"low",stats:t}}}(n))}),o)}}))}))}}),3e3);var d=function(){Object(E.getParameter)("REPORT_STATS")&&e&&e.pc&&e.pc.getVideoRelatedStats&&e.pc.getVideoRelatedStats((function(t){var n,r,i=N.socket&&N.socket.getLastMsgTime()&&Date.now()-N.socket.getLastMsgTime();i>Object(E.getParameter)("REPORT_STATS_TIMEOUT")?v.default.debug("PublishRelatedStats report blocked by REPORT_STATS_TIMEOUT ".concat(i)):e.getId()===e.getUserId()?N.makeReport((n=t,r={},Object.keys(n).forEach((function(e){Object(E.getParameter)("STATS_FILTER")[e]||(r[M(e)]=n[e])})),{_type:"publish_related_stats",_message:{stream_type:"high",stats:r}})):N.makeReport(function(e){var t={};return Object.keys(e).forEach((function(n){Object(E.getParameter)("STATS_FILTER")[n]||(t[M(n)]=e[n])})),{_type:"publish_related_stats",_message:{stream_type:"low",stats:t}}}(t))}))};d(),clearInterval(N.timers[e.getId()+"_RelatedStats"]),N.timers[e.getId()+"_RelatedStats"]=setInterval(d,1e3)}}},N.unpublish=function(e,t,n,r){if("object"!==u()(e)||null===e)return v.default.error("[".concat(N.clientId,"] Invalid local stream")),void B(r,T.default.INVALID_LOCAL_STREAM);if(N.state!==_)return v.default.error("[".concat(N.clientId,"] User not in the session")),void B(r,T.default.INVALID_OPERATION);if(null!=N.timers[e.getId()]&&(clearInterval(N.timers[e.getId()]),clearInterval(N.timers[e.getId()+"_RelatedStats"])),void 0!==N.socket)if(e.local&&void 0!==N.localStreams[e.getId()]){delete N.localStreams[e.getId()];var i={stream_id:e.getUserId(),stream_type:1===t.streamType?"low":"high"};N.makeRequest({_type:"unpublish",_message:i}),(e.hasAudio()||e.hasVideo()||e.hasScreen())&&void 0===e.url&&void 0!==e.pc&&(e.pc.close(),e.pc=void 0),e.onClose=void 0,e._onAudioMute=void 0,e._onAudioUnute=void 0,e._onVideoMute=void 0,e._onVideoUnmute=void 0,N.p2ps.delete(e.p2pId),n&&n()}else v.default.error("[".concat(N.clientId,"] Invalid local stream")),B(r,T.default.INVALID_LOCAL_STREAM);else v.default.error("[".concat(N.clientId,"] User not in the session")),B(r,T.default.INVALID_OPERATION)},N.subscribe=function(e,t,n){var r=(new Date).getTime();e.subscribeLTS=r;var o=!1;if(v.default.info("[".concat(N.clientId,"] Gatewayclient ").concat(N.uid," Subscribe ").concat(e.getId(),": ").concat(JSON.stringify(e.subscribeOptions))),"object"!==u()(e)||null===e)return v.default.error("[".concat(N.clientId,"] Invalid remote stream")),n&&n(T.default.INVALID_REMOTE_STREAM),void m.report.subscribe(N.joinInfo.sid,{lts:r,succ:!1,video:e.subscribeOptions&&e.subscribeOptions.video,audio:e.subscribeOptions&&e.subscribeOptions.audio,peerid:e.getId(),ec:T.default.INVALID_REMOTE_STREAM});if(N.state!==_&&(v.default.error("[".concat(N.clientId,"] User is not in the session")),!o))return o=!0,m.report.subscribe(N.joinInfo.sid,{lts:r,succ:!1,video:e.subscribeOptions&&e.subscribeOptions.video,audio:e.subscribeOptions&&e.subscribeOptions.audio,peerid:e.getId(),ec:T.default.INVALID_OPERATION}),n&&n(T.default.INVALID_OPERATION);if(!e.local&&N.remoteStreams.hasOwnProperty(e.getId()))if(e.hasAudio()||e.hasVideo()||e.hasScreen()){var s=N.generateP2PId();N.p2ps.set(s,e),e.p2pId=s,e.pc=Object(S.a)({callback:function(t){t||n&&n("CANNOT_GET_OFFER");var i={stream_id:e.getId(),audio:!e.subscribeOptions||e.subscribeOptions.audio,video:!e.subscribeOptions||e.subscribeOptions.video,codec:N.codec,p2p_id:s,sdp:t,tcc:Object(E.getParameter)("SUBSCRIBE_TCC"),extend:Object(E.getParameter)("SUB_EXTEND")};N.makeRequest({_type:"subscribe",_message:i},(function(t){e.pc.processSignalingMessage(t.sdp)}),(function(t,i){v.default.error("[".concat(N.clientId,"] Subscribe remote stream Failed: ").concat(t,", closing stream "),e.getId(),i),m.report.subscribe(N.joinInfo.sid,{lts:r,succ:!1,video:e.subscribeOptions&&e.subscribeOptions.video,audio:e.subscribeOptions&&e.subscribeOptions.audio,peerid:e.getId(),ec:t}),"TIMEOUT"!=t&&(N.processSubscribeFailure(e),n&&n(t))}))},nop2p:!0,audio:!0,video:!0,screen:e.hasScreen(),isSubscriber:!0,stunServerUrl:N.stunServerUrl,turnServers:N.joinInfo.turnServers,isVideoMute:e.userMuteVideo,isAudioMute:e.userMuteAudio,uid:e.getId(),agoraStream:e,clientId:N.clientId}),e.pc.onaddstream=function(t,n){if(e._onAudioUnmute=function(){N.makeReport(i({action:"unmute_remote_audio",stream_id:e.getId()}),(function(){}),(function(){}))},e._onAudioMute=function(){N.makeReport(i({action:"mute_remote_audio",stream_id:e.getId()}),(function(){}),(function(){}))},e._onVideoUnmute=function(){N.makeReport(i({action:"unmute_remote_video",stream_id:e.getId()}),(function(){}),(function(){}))},e._onVideoMute=function(){N.makeReport(i({action:"mute_remote_video",stream_id:e.getId()}),(function(){}),(function(){}))},"ontrack"===n&&"video"===t.track.kind||"onaddstream"===n){v.default.info("[".concat(N.clientId,"] Remote stream subscribed with uid "),e.getId());var r=N.remoteStreams[e.getId()];if(N.remoteStreams[e.getId()].stream="onaddstream"===n?t.stream:t.streams[0],N.remoteStreams[e.getId()].hasVideo()){if(Object(C.isFireFox)()||Object(C.isSafari)()){var o=N.remoteStreams[e.getId()].stream;Object(y.vsResHack)(o,(function(t,n){e.videoWidth=t,e.videoHeight=n}),(function(e){return v.default.warning("[".concat(N.clientId,"] vsResHack failed: ")+e)}))}}else{var a=N.remoteStreams[e.getId()];a.peerMuteVideo=!0,N._adjustPCMuteStatus(a)}r&&r.isPlaying()&&r.elementID&&(v.default.debug("[".concat(N.clientId,"] Reload Player ").concat(r.elementID," StreamId ").concat(r.getId())),e.audioOutput=r.audioOutput,r.stop(),e.play(r.elementID,r.playOptions)),delete e.audioLevelHelper;var s=Object(A.e)({type:"stream-subscribed",stream:N.remoteStreams[e.getId()]});N.dispatchEvent(s)}},clearInterval(N.timers[e.getId()]),N.timers[e.getId()]=setInterval((function(){if(Object(E.getParameter)("REPORT_STATS")){var t=0;e&&e.pc&&e.pc.getStats&&e.pc.getStatsRate((function(n){n.forEach((function(n){if(n&&n.id){if(/_send$/.test(n.id)||/^time$/.test(n.id)||/^bweforvideo$/.test(n.id))return;-1===n.id.indexOf("inbound_rtp")&&-1===n.id.indexOf("inbound-rtp")&&-1===n.type.toLowerCase().indexOf("inbound")||"video"!==n.mediaType||(n.googFrameWidthReceived=e.videoWidth+"",n.googFrameHeightReceived=e.videoHeight+"");var r=200*t;t++;var i=e.getId();setTimeout((function(){var t=N.socket&&N.socket.getLastMsgTime()&&Date.now()-N.socket.getLastMsgTime();if(t>Object(E.getParameter)("REPORT_STATS_TIMEOUT"))v.default.debug("SubscribeStats report blocked by REPORT_STATS_TIMEOUT ".concat(t));else{if("video"===n.mediaType)try{var r=e.stream.getVideoTracks()[0];n.A_vrtd=r.enabled?"0":"1",e.player&&e.player.freezeTimeCounterList.length>0&&(n.A_vrft=e.player.freezeTimeCounterList.splice(0,1)[0].toString())}catch(e){}if("audio"===n.mediaType)try{var o=e.stream.getAudioTracks()[0];n.A_artd=o.enabled?"0":"1"}catch(e){}N.makeReport(l(i,n))}}),r)}}))}))}}),3e3),clearInterval(N.timers[e.getId()+"_RelatedStats"]),N.timers[e.getId()+"_RelatedStats"]=setInterval((function(){if(Object(E.getParameter)("REPORT_STATS")&&e&&e.pc){var t=N.socket&&N.socket.getLastMsgTime()&&Date.now()-N.socket.getLastMsgTime();if(t>Object(E.getParameter)("REPORT_STATS_TIMEOUT"))return void v.default.debug("SubscribeRelatedStats report blocked by REPORT_STATS_TIMEOUT ".concat(t));e.pc.getVideoRelatedStats&&e.pc.getVideoRelatedStats((function(t){e.player&&(e.hasVideo()&&!e.peerMuteVideo&&(t.isFreeze=e.player.freezeCount>e.player.lastFreezeCount),e.player.lastFreezeCount=e.player.freezeCount),N.makeReport(a(e.getId(),t))})),e.pc.getAudioRelatedStats&&e.pc.getAudioRelatedStats((function(t){N.makeReport(a(e.getId(),t))}))}}),1e3),N.audioLevel[e.getId()]=0,clearInterval(N.timers[e.getId()+"audio"]),N.timers[e.getId()+"audio"]=setInterval((function(){N.hasListeners("active-speaker")&&e&&e.pc&&"established"===e.pc.state&&e.pc.getStats&&e.pc.getStats((function(t){t.forEach((function(t){if("audio"===t.mediaType){if(t.audioOutputLevel>5e3)for(var n in N.audioLevel[e.getId()]<20&&(N.audioLevel[e.getId()]+=1),N.audioLevel)n!==""+e.getId()&&N.audioLevel[n]>0&&(N.audioLevel[n]-=1);var r=Object.keys(N.audioLevel).sort((function(e,t){return N.audioLevel[t]-N.audioLevel[e]}));if(N.activeSpeaker!==r[0]){var i=Object(A.a)({type:"active-speaker",uid:r[0]});N.dispatchEvent(i),N.activeSpeaker=r[0],v.default.debug("[".concat(N.clientId,"] Update active speaker: ").concat(N.activeSpeaker))}}}))}),50)}),50),e.pc.oniceconnectionstatechange=function(i){if("failed"===i)null!=N.timers[e.getId()]&&(clearInterval(N.timers[e.getId()]),clearInterval(N.timers[e.getId()]+"audio")),v.default.error("[".concat(N.clientId,"] Subscriber connection is lost -- streamId: ").concat(e.getId(),", p2pId: ").concat(s)),v.default.debug("[".concat(N.clientId,"] subscribe p2p failed: "),N.p2ps),o||(o=!0,n&&n(T.default.PEERCONNECTION_FAILED),m.report.subscribe(N.joinInfo.sid,{lts:r,succ:!1,video:e.subscribeOptions&&e.subscribeOptions.video,audio:e.subscribeOptions&&e.subscribeOptions.audio,peerid:e.getId(),ec:T.default.PEERCONNECTION_FAILED,subscribeRequestid:N.subscribeRequestId.get(e.getId())||0,p2pid:s})),N.remoteStreams[e.getId()]&&N.p2ps.has(s)&&(N.p2ps.delete(s),N.dispatchEvent(Object(A.a)({type:"subP2PLost",stream:e})));else if("connected"===i&&(v.default.debug("[".concat(N.clientId,"] subscribe p2p connected: "),N.p2ps),!o)){o=!0,m.report.subscribe(N.joinInfo.sid,{lts:r,succ:!0,video:e.subscribeOptions&&e.subscribeOptions.video,audio:e.subscribeOptions&&e.subscribeOptions.audio,peerid:e.getId(),ec:null,subscribeRequestid:N.subscribeRequestId.get(e.getId())||0,p2pid:s}),N._adjustPCMuteStatus(e);var a=!1,c=!1,u=!1,l=setInterval((function(){a&&c||(e.pc?e.pc.getStats((function(t){t.forEach((function(t){if((-1!==t.id.indexOf("recv")||t.type&&-1!==t.type.toLowerCase().indexOf("inbound")||-1!==t.id.indexOf("inbound_rtp")||-1!==t.id.indexOf("inbound-rtp")||-1!==t.id.indexOf("InboundRTP"))&&"audio"===t.mediaType){if((t.googDecodingNormal>0||t.audioOutputLevel>0)&&!a){a=!0,N.dispatchEvent({type:"first-audio-frame-decode",stream:e}),a&&c&&clearInterval(l);var n=Date.now(),r=m.report.getSessionStartTime(N.joinInfo.sid);m.report.firstAudioDecode(N.joinInfo.sid,{peerid:e.uintId,uid:N.uid,elapse:n-r,subscribeElapse:n-e.subscribeLTS,subscribeRequestid:N.subscribeRequestId.get(e.getId())||0,p2pid:s})}parseInt(t.packetsReceived)>0&&!c&&(c=!0,N.dispatchEvent({type:"first-audio-packet-received",stream:e}),a&&c&&clearInterval(l),n=Date.now(),r=m.report.getSessionStartTime(N.joinInfo.sid),m.report.firstAudioReceived(N.joinInfo.sid,{peerid:e.uintId,uid:N.uid,elapse:n-r,subscribeElapse:n-e.subscribeLTS,subscribeRequestid:N.subscribeRequestId.get(e.getId())||0,p2pid:s}))}}))}),100):clearInterval(l))}),100),d=!1,h=!1,f=setInterval((function(){d&&h||(e.pc?e.pc.getStats((function(t){t.forEach((function(t){if((-1!==t.id.indexOf("recv")||t.type&&-1!==t.type.toLowerCase().indexOf("inbound")||-1!==t.id.indexOf("inbound_rtp")||-1!==t.id.indexOf("inbound-rtp")||-1!==t.id.indexOf("InboundRTP"))&&"video"===t.mediaType){if((t.framesDecoded>0||t.googFramesDecoded>0)&&!d){d=!0,N.dispatchEvent({type:"first-video-frame-decode",stream:e}),d&&h&&clearInterval(f);var n=Date.now(),r=m.report.getSessionStartTime(N.joinInfo.sid);e.firstFrameTime=(new Date).getTime()-e.subscribeLTS,m.report.firstVideoDecode(N.joinInfo.sid,{peerid:e.uintId,width:parseInt(t.googFrameWidthReceived)||0,height:parseInt(t.googFrameHeightReceived)||0,uid:N.uid,elapse:n-r,subscribeElapse:n-e.subscribeLTS,subscribeRequestid:N.subscribeRequestId.get(e.getId())||0,p2pid:s})}t.packetsReceived>0&&!h&&(h=!0,N.dispatchEvent({type:"first-video-packet-received",stream:e}),d&&h&&clearInterval(f),n=Date.now(),r=m.report.getSessionStartTime(N.joinInfo.sid),m.report.firstVideoReceived(N.joinInfo.sid,{peerid:e.uintId,uid:N.uid,elapse:n-r,subscribeElapse:n-e.subscribeLTS,subscribeRequestid:N.subscribeRequestId.get(e.getId())||0,p2pid:s}))}}))}),100):clearInterval(f))}),100),p=setInterval((function(){if(!u){var t=e.getId(),n=N.traffic_stats;if(n&&n.peer_delay){var r=n.peer_delay.find((function(e){return e.peer_uid==t}));if(r){if(u=!0,N.peerPublishDurationMap.get(e.getId()))return void clearInterval(p);var i=r.peer_publish_audio_duration,o=r.peer_publish_video_duration;if(void 0===i||void 0===o)return;N.peerPublishDurationMap.set(e.getId(),!0);var a=m.report.getSessionStartTime(N.joinInfo.sid),s=(i||o)+(Date.now()-n.timestamp),c=Date.now();m.report.peerPublishStatus({audiotag:i?1:-1,videotag:o?1:-1,lts:c,sid:N.joinInfo.sid,cname:N.joinInfo.cname,cid:N.joinInfo.cid,uid:N.joinInfo.uid,elapse:c-a,peer:e.uintId,peerPublishDuration:s,joinChannelSuccessElapse:c-N.joinSuccessLts,subscribeElapse:c-e.subscribeLTS}),clearInterval(p)}}}}),1e3);return e.sid=N.joinInfo.sid,t&&t()}}}else v.default.error("[".concat(N.clientId,"] Invalid remote stream")),o||(o=!0,n&&n(T.default.INVALID_REMOTE_STREAM),m.report.subscribe(N.joinInfo.sid,{lts:r,succ:!1,video:e.subscribeOptions&&e.subscribeOptions.video,audio:e.subscribeOptions&&e.subscribeOptions.audio,peerid:e.getId(),ec:T.default.INVALID_REMOTE_STREAM}));else v.default.error("[".concat(N.clientId,"] No such remote stream")),o||(o=!0,n&&n(T.default.NO_SUCH_REMOTE_STREAM),m.report.subscribe(N.joinInfo.sid,{lts:r,succ:!1,video:e.subscribeOptions&&e.subscribeOptions.video,audio:e.subscribeOptions&&e.subscribeOptions.audio,peerid:e.getId(),ec:T.default.NO_SUCH_REMOTE_STREAM}))},N.subscribeChange=function(e,t,n){var r=Date.now();v.default.info("[".concat(N.clientId,"] Gatewayclient ").concat(N.uid," SubscribeChange ").concat(e.getId(),": ").concat(JSON.stringify(e.subscribeOptions))),N._adjustPCMuteStatus(e);var i={stream_id:e.getId(),audio:e.subscribeOptions.audio,video:e.subscribeOptions.video};N.makeRequest({_type:"subscribe_change",_message:i},(function(n){var i=Object(A.e)({type:"stream-subscribe-changed",stream:N.remoteStreams[e.getId()]});m.report.subscribe(N.joinInfo.sid,{lts:r,succ:!0,video:e.subscribeOptions&&e.subscribeOptions.video,audio:e.subscribeOptions&&e.subscribeOptions.audio,peerid:e.getId(),ec:null,subscribeRequestid:N.subscribeRequestId.get(e.getId())||0,p2pid:N.p2ps.get(e.getId())}),N.dispatchEvent(i),t&&t()}),(function(t,r){v.default.error("[".concat(N.clientId,"] Subscribe Change Failed ").concat(e.getId()),t,r),n&&n(t,r)}))},N.processPublishFailure=function(e){e.publishLTS=null,e.p2pId&&N.p2ps.get(e.p2pId)===e&&N.p2ps.delete(e.p2pId),N.localStreams[e.getUserId()]===e&&delete N.localStreams[e.getUserId()],N.localStreams[e.getId()]===e&&delete N.localStreams[e.getId()],e.pc&&(e.pc.processSignalingMessage=function(){},e.pc.oniceconnectionstatechange=function(){},e.pc.close(),delete e.pc),delete e.onClose,delete e._onAudioUnmute,delete e._onVideoUnmute,delete e._onAudioMute,delete e._onVideoMute,delete e._onAudioUnmute},N.processSubscribeFailure=function(e){e.p2pId&&N.p2ps.get(e.p2pId)===e&&N.p2ps.delete(e.p2pId),e.pc&&(e.pc.onaddstream=function(){},e.pc.processSignalingMessage=function(){},e.pc.oniceconnectionstatechange=function(){},e.pc.close(),delete e.pc),delete e.onClose,delete e._onAudioUnmute,delete e._onVideoUnmute,delete e._onAudioMute,delete e._onVideoMute,delete e._onAudioUnmute},N._adjustPCMuteStatus=function(e){v.default.debug("[".concat(N.clientId,"]: use _adjustPCMuteStatus: ").concat(e.getId())),v.default.debug("[".concat(N.clientId,"]: video: ").concat(e.video,", audio: ").concat(e.audio,", suboption: ").concat(JSON.stringify(e.subscribeOptions),",userMuteVideo: ").concat(e.userMuteVideo,", peerMuteVideo: ").concat(e.peerMuteVideo,", userMuteAudio: ").concat(e.userMuteAudio,", peerMuteAudio: ").concat(e.peerMuteAudio)),!e.local&&e.pc&&e.pc.peerConnection.getReceivers&&e.pc.peerConnection.getReceivers().forEach((function(t){if(t&&t.track&&"audio"===t.track.kind){var n=!e.userMuteAudio&&!e.peerMuteAudio;e.subscribeOptions&&!e.subscribeOptions.audio&&(n=!1),v.default.debug("[".concat(N.clientId,"]: set receiver audio track: ").concat(n)),t.track.enabled=!!n}else if(t&&t.track&&"video"===t.track.kind){var r=!e.userMuteVideo&&!e.peerMuteVideo;e.subscribeOptions&&!e.subscribeOptions.video&&(r=!1),v.default.debug("[".concat(N.clientId,"]: set receiver video track: ").concat(r)),t.track.enabled=!!r}}))},N.unsubscribe=function(e,t,n){if("object"!==u()(e)||null===e)return v.default.error("[".concat(N.clientId,"] Invalid remote stream")),void B(n,T.default.INVALID_REMOTE_STREAM);if(N.state!==_)return v.default.error("[".concat(N.clientId,"] User is not in the session")),void B(n,T.default.INVALID_OPERATION);if(null!=N.timers[e.getId()]&&(clearInterval(N.timers[e.getId()]),clearInterval(N.timers[e.getId()]+"audio")),null!=N.audioLevel[e.getId()]&&delete N.audioLevel[e.getId()],null!=N.timer_counter[e.getId()]&&delete N.timer_counter[e.getId()],N.remoteStreams.hasOwnProperty(e.getId())){if(!N.socket)return v.default.error("[".concat(N.clientId,"] User is not in the session")),void B(n,T.default.INVALID_OPERATION);if(e.local)return v.default.error("[".concat(N.clientId,"] Invalid remote stream")),void B(n,T.default.INVALID_REMOTE_STREAM);e.close(),e.stop();var r={stream_id:e.getId()};N.makeRequest({_type:"unsubscribe",_message:r}),void 0!==e.pc&&(e.pc.close(),e.pc=void 0),e.onClose=void 0,e._onAudioMute=void 0,e._onAudioUnute=void 0,e._onVideoMute=void 0,e._onVideoUnmute=void 0,delete e.subscribeOptions,N.p2ps.delete(e.p2pId),v.default.info("[".concat(N.clientId,"] Unsubscribe stream success")),t&&t()}else B(n,T.default.NO_SUCH_REMOTE_STREAM)},N.setRemoteVideoStreamType=function(e,t){if(v.default.debug("[".concat(N.clientId,"] Switching remote video stream ").concat(e.getId()," to ").concat(t)),"object"===u()(e)&&null!==e)if(N.state===_){if(!e.local){switch(t){case N.remoteVideoStreamTypes.REMOTE_VIDEO_STREAM_HIGH:case N.remoteVideoStreamTypes.REMOTE_VIDEO_STREAM_LOW:case N.remoteVideoStreamTypes.REMOTE_VIDEO_STREAM_MEDIUM:break;default:return}var n={stream_id:e.getId(),stream_type:t};N.makeRequest({_type:"switch_video_stream",_message:n},(function(){v.default.debug("SwitchVideoStream Success ".concat(n.stream_id," ").concat(n.stream_type))}),(function(e,t){v.default.error("SwitchVideoStream Error ".concat(e," ").concat(n.stream_id," ").concat(n.stream_type),t)}))}}else v.default.error("[".concat(N.clientId,"] User is not in the session"));else v.default.error("[".concat(N.clientId,"] Invalid remote stream"))},N.renewToken=function(e,t,n){e?N.key?N.state!==_?(v.default.debug("[".concat(N.clientId,"] Client is not connected. Trying to rejoin")),N.key=e,N.rejoin(),t&&t()):(v.default.debug("[".concat(N.clientId,"] renewToken from ").concat(N.key," to ").concat(e)),N.key=e,N.makeRequest({_type:"renew_token",_message:{token:e}},t,n)):(v.default.error("[".concat(N.clientId,"] Client is previously joined without token")),n&&n(T.default.INVALID_PARAMETER)):(v.default.error("[".concat(N.clientId,"] Invalid Token ").concat(e)),n&&n(T.default.INVALID_PARAMETER))},N.setStreamFallbackOption=function(e,t){if(v.default.debug("[".concat(N.clientId,"] Set stream fallback option ").concat(e.getId()," to ").concat(t)),"object"===u()(e)&&null!==e)if(N.state===_){if(!e.local){switch(t){case N.streamFallbackTypes.STREAM_FALLBACK_OPTION_DISABLED:case N.streamFallbackTypes.STREAM_FALLBACK_OPTION_VIDEO_STREAM_LOW:case N.streamFallbackTypes.STREAM_FALLBACK_OPTION_AUDIO_ONLY:break;default:return}var n={stream_id:e.getId(),fallback_type:t};N.makeRequest({_type:"set_fallback_option",_message:n},(function(){v.default.debug("SetStreamFallbackOption success ".concat(n.stream_id," ").concat(t))}),(function(e,r){v.default.error("Failed to SetStreamFallbackOption ".concat(n.stream_id," ").concat(t," ").concat(e),r)}))}}else v.default.error("[".concat(N.clientId,"] User is not in the session"));else v.default.error("[".concat(N.clientId,"] Invalid remote stream"))},N.enableAudioVolumeIndicator=function(e,t){N.audioVolumeIndication.enabled=!0,N.audioVolumeIndication.interval=e,N.audioVolumeIndication.smooth=t,N.resetAudioVolumeIndication()},N.resetAudioVolumeIndication=function(){if(clearInterval(N.timers.audioVolumeIndication),clearInterval(N.timers.audioVolumeSampling),N.audioVolumeIndication.enabled&&N.audioVolumeIndication.interval){var e=Math.floor(1e3*N.audioVolumeIndication.smooth/100);clearInterval(N.timers.audioVolumeSampling),N.timers.audioVolumeSampling=setInterval((function(){N.audioVolumeSampling||(N.audioVolumeSampling={});var t={};for(var n in N.remoteStreams){var r=N.remoteStreams[n];if(r.stream&&r.hasAudio()){var i=r.getAudioLevel();i>0&&i<1&&(i*=100);var o=N.audioVolumeSampling[n]||[];for(o.push(i);o.length>e;)o.shift();t[n]=o}}N.audioVolumeSampling=t}),100),clearInterval(N.timers.audioVolumeIndication),N.timers.audioVolumeIndication=setInterval((function(){if(N.socket&&N.socket.signal&&N.socket.signal.connection&&N.socket.signal.connection.readyState===WebSocket.OPEN){var e=[];for(var t in N.remoteStreams)if(N.audioVolumeSampling&&N.audioVolumeSampling[t]){var n=N.audioVolumeSampling[t],r=0;n.forEach((function(e){r+=e}));var i={uid:t,level:Math.floor(r/n.length)};i.level&&e.push(i)}var o=e.sort((function(e,t){return e.level-t.level}));v.default.debug("[".concat(N.clientId,"] volume-indicator "),JSON.stringify(o)),N.audioVolumeIndication.sortedAudioVolumes=o;var a=Object(A.a)({type:"volume-indicator",attr:o});N.dispatchEvent(a)}}),N.audioVolumeIndication.interval)}},N.closeGateway=function(){v.default.debug("[".concat(N.clientId,"] close gateway")),N.state=h,N.socket.close(),H()},N.startChannelMediaRelay=function(){var e=s()(o.a.mark((function e(t){var n,r,i,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!N.channelMediaRelayController){e.next=2;break}throw new k.ChannelMediaError("RELAY_ALREADY_START","",k.CHANNEL_MEDIA_RELAY_ERROR.RELAY_ALREADY_START);case 2:return n=function(e){N.dispatchEvent({type:"channel-media-relay-event",code:e})},r=function(e,t,n){e===k.CHANNEL_MEDIA_RELAY_STATE.RELAY_STATE_FAILURE&&t===k.CHANNEL_MEDIA_RELAY_ERROR.SERVER_CONNECTION_LOST&&(N.channelMediaRelayController.dispose(),N.channelMediaRelayController=null),N.dispatchEvent({type:"channel-media-relay-state",state:e,code:t,data:n})},N.channelMediaRelayController=new U.a(N.joinInfo,N.clientId),N.channelMediaRelayController.on("event",n),N.channelMediaRelayController.on("state",r),e.prev=7,e.next=10,N.channelMediaRelayController.startChannelMediaRelay(t);case 10:e.next=22;break;case 12:throw e.prev=12,e.t0=e.catch(7),v.default.debug("[".concat(N.clientId,"] startChannelMediaRelay exception: ").concat(JSON.stringify(e.t0))),i=k.CHANNEL_MEDIA_RELAY_STATE.RELAY_STATE_FAILURE,"",a=e.t0 instanceof k.ChannelMediaError?"SetSourceChannelStatus"===e.t0.data||e.t0.data&&e.t0.data.serverResponse&&"SetSourceChannel"===e.t0.data.serverResponse.command?"FAILED_JOIN_SRC":"SetDestChannelStatus"===e.t0.data||e.t0.data&&e.t0.data.serverResponse&&"SetDestChannel"===e.t0.data.serverResponse.command?"FAILED_JOIN_DEST":e.t0.data&&e.t0.data.serverResponse&&"StartPacketTransfer"===e.t0.data.serverResponse.command?"FAILED_PACKET_SENT_TO_DEST":e.t0.message===k.CHANNEL_MEDIA_ERROR.REQUEST_TIMEOUT||e.t0.message===k.CHANNEL_MEDIA_ERROR.WAIT_STATUS_TIMEOUT?"SERVER_NO_RESPONSE":e.t0.message===k.CHANNEL_MEDIA_ERROR.REQUEST_FAILED||e.t0.message===k.CHANNEL_MEDIA_ERROR.WAIT_STATUS_ERROR?"SERVER_ERROR_RESPONSE":e.t0.message===k.CHANNEL_MEDIA_ERROR.AP_REQUEST_TIMEOUT?"NO_RESOURCE_AVAILABLE":e.t0.message===k.CHANNEL_MEDIA_ERROR.WS_ABORT||e.t0.message===k.CHANNEL_MEDIA_ERROR.AP_REQUEST_ABORT?"OPERATION_ABORT":"INTERNAL_ERROR":"INTERNAL_ERROR",N.dispatchEvent({type:"channel-media-relay-state",state:i,code:k.CHANNEL_MEDIA_RELAY_ERROR[a]}),N.channelMediaRelayController&&(N.channelMediaRelayController.dispose(),N.channelMediaConfig=null,N.channelMediaRelayController=null),N.dispatchEvent({type:"channel-media-relay-state",state:k.CHANNEL_MEDIA_RELAY_STATE.RELAY_STATE_IDLE}),new k.ChannelMediaError(a,null,k.CHANNEL_MEDIA_RELAY_ERROR[a]);case 22:N.dispatchEvent({type:"channel-media-relay-state",state:k.CHANNEL_MEDIA_RELAY_STATE.RELAY_STATE_RUNNING,code:k.CHANNEL_MEDIA_RELAY_ERROR.RELAY_OK}),N.channelMediaConfig=t;case 24:case"end":return e.stop()}}),e,null,[[7,12]])})));return function(t){return e.apply(this,arguments)}}(),N.updateChannelMediaRelay=function(){var t=s()(o.a.mark((function t(n){var r,i;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(N.channelMediaRelayController){t.next=2;break}throw new k.ChannelMediaError("RELAY_NOT_START",null,k.CHANNEL_MEDIA_RELAY_ERROR.RELAY_NOT_START);case 2:return t.prev=2,t.next=5,N.channelMediaRelayController.updateChannelMediaRelay(n);case 5:t.next=18;break;case 7:throw t.prev=7,t.t0=t.catch(2),v.default.debug("[".concat(N.clientId,"] updateChannelMediaRelay exception: ").concat(JSON.stringify(e))),r=k.CHANNEL_MEDIA_RELAY_STATE.RELAY_STATE_FAILURE,"",i=e instanceof k.ChannelMediaError?e.message===k.CHANNEL_MEDIA_ERROR.REQUEST_TIMEOUT||e.message===k.CHANNEL_MEDIA_ERROR.WAIT_STATUS_TIMEOUT?"SERVER_NO_RESPONSE":e.message===k.CHANNEL_MEDIA_ERROR.REQUEST_FAILED||e.message===k.CHANNEL_MEDIA_ERROR.WAIT_STATUS_ERROR?"SERVER_ERROR_RESPONSE":e.message===k.CHANNEL_MEDIA_ERROR.WS_ABORT||e.message===k.CHANNEL_MEDIA_ERROR.AP_REQUEST_ABORT?"OPERATION_ABORT":"INTERNAL_ERROR":"INTERNAL_ERROR",N.dispatchEvent({type:"channel-media-relay-event",code:k.CHANNEL_MEDIA_RELAY_EVENT.PACKET_UPDATE_DEST_CHANNEL_REFUSED}),N.dispatchEvent({type:"channel-media-relay-state",state:r,code:k.CHANNEL_MEDIA_RELAY_ERROR[i]}),N.channelMediaRelayController&&(N.channelMediaRelayController.dispose(),N.channelMediaConfig=null,N.channelMediaRelayController=null),N.dispatchEvent({type:"channel-media-relay-state",state:k.CHANNEL_MEDIA_RELAY_STATE.RELAY_STATE_IDLE}),new k.ChannelMediaError(i,null,k.CHANNEL_MEDIA_RELAY_ERROR[i]);case 18:N.channelMediaConfig=n;case 19:case"end":return t.stop()}}),t,null,[[2,7]])})));return function(e){return t.apply(this,arguments)}}(),N.stopChannelMediaRelay=s()(o.a.mark((function t(){var n,r;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(N.channelMediaRelayController){t.next=2;break}throw new k.ChannelMediaError("RELAY_NOT_START",null,k.CHANNEL_MEDIA_RELAY_ERROR.RELAY_NOT_START);case 2:return t.prev=2,t.next=5,N.channelMediaRelayController.stopChannelMediaRelay();case 5:t.next=17;break;case 7:throw t.prev=7,t.t0=t.catch(2),v.default.debug("[".concat(N.clientId,"] stopChannelMediaRelay exception: ").concat(JSON.stringify(e))),n=k.CHANNEL_MEDIA_RELAY_STATE.RELAY_STATE_FAILURE,"",r=e instanceof k.ChannelMediaError?e.message===k.CHANNEL_MEDIA_ERROR.REQUEST_TIMEOUT||e.message===k.CHANNEL_MEDIA_ERROR.WAIT_STATUS_TIMEOUT?"SERVER_NO_RESPONSE":e.message===k.CHANNEL_MEDIA_ERROR.REQUEST_FAILED||e.message===k.CHANNEL_MEDIA_ERROR.WAIT_STATUS_ERROR?"SERVER_ERROR_RESPONSE":"INTERNAL_ERROR":"INTERNAL_ERROR",N.dispatchEvent({type:"channel-media-relay-state",state:n,code:k.CHANNEL_MEDIA_RELAY_ERROR[r]}),N.channelMediaRelayController&&(N.channelMediaRelayController.dispose(),N.channelMediaConfig=null,N.channelMediaRelayController=null),N.dispatchEvent({type:"channel-media-relay-state",state:k.CHANNEL_MEDIA_RELAY_STATE.RELAY_STATE_IDLE}),new k.ChannelMediaError(r,null,k.CHANNEL_MEDIA_RELAY_ERROR[r]);case 17:N.channelMediaConfig=null,N.channelMediaRelayController=null;case 19:case"end":return t.stop()}}),t,null,[[2,7]])}))),N.sendMetadata=function(e,t){N.makeRequest(function(e){return{_type:"send_metadata",_message:{session_id:N.joinInfo.sid,metadata:window.btoa(unescape(encodeURIComponent(e)))}}}(e),(function(){v.default.debug("[".concat(N.clientId,'] send metadata "').concat(e,'" success')),t&&t(null)}),(function(n){v.default.error("[".concat(N.clientId,'] send metadata "').concat(e,'" failed'),n),t&&t(n)}))},N._reportWebsocketCloseEvent=function(e,t){try{var n=m.report.getSessionStartTime(N.joinInfo.sid),r=Date.now();m.report.webSocketQuit({lts:r,sid:N.joinInfo.sid,cname:N.joinInfo.cname,cid:N.joinInfo.cid,uid:N.joinInfo.uid,elapse:r-n,succ:e,errorCode:t,ip:null})}catch(e){v.default.debug("[".concat(N.clientId,"]: _reportWebsocketCloseEvent exception, ").concat(e))}};var P=function(){v.default.debug("[".concat(N.clientId,"] Reconnect gateway")),N.state=h,N.socket.close(),H(),N.reconnectMode="recover",N.state=b,j()};N.recover=P;var H=function(){for(var e in N.dispatchEvent({type:"before-clear-connection"}),N.timers)N.timers.hasOwnProperty(e)&&clearInterval(N.timers[e]);for(var e in N.remoteStreams)if(N.remoteStreams.hasOwnProperty(e)){var t=N.remoteStreams[e],n=Object(A.a)({type:"stream-removed",uid:t.getId(),stream:t});N.dispatchEvent(n)}N.p2ps.clear(),z(),G(),clearInterval(N.pingTimer)};N.rejoin=function(){N.socket&&(clearInterval(N.pingTimer),N.socket.close(),N.socket=void 0),N.state=b,j()};var j=function(e,t){N.dispatchEvent(Object(A.a)({type:"rejoin-start"})),e=e||function(e){v.default.info("[".concat(N.clientId,"] User ").concat(e," is re-joined to ").concat(N.joinInfo.cname)),N.dispatchEvent(Object(A.a)({type:"rejoin"})),N.channelMediaConfig&&N.startChannelMediaRelay(N.channelMediaConfig).then((function(){v.default.debug("[".concat(N.clientId,"] restartChannelMediaRelay success"))})).catch((function(e){v.default.debug("[".concat(N.clientId,"] restartChannelMediaRelay failed: ").concat(JSON.stringify(e)))})),N.liveStreams&&N.liveStreams.size&&N.liveStreams.forEach((function(e,t){e&&N.setLiveTranscoding(N.transcoding),N.startLiveStreaming(t,e)})),N.injectLiveStreams&&N.injectLiveStreams.size&&N.injectLiveStreams.forEach((function(e,t){N.addInjectStreamUrl(t,e)}))},t=t||function(e){v.default.error("[".concat(N.clientId,"] Re-join to channel failed "),e),N.dispatchEvent(Object(A.e)({type:"error",reason:e}))},N.key?(++N.rejoinAttempt,N.join(N.joinInfo,N.key,e,t)):v.default.error("[".concat(N.clientId,"] Connection recover failed [Invalid channel key]"))},V=function(e,t,n){if(N.onConnect=t,N.socket){if(N.dispatchEvent({type:"reconnect"}),"retry"===N.reconnectMode)v.default.debug("[".concat(N.clientId,"] Retry current gateway")),N.socket.reconnect();else if("tryNext"===N.reconnectMode)v.default.debug("[".concat(N.clientId,"] Try next gateway")),N.socket.connectNext();else if("recover"===N.reconnectMode){v.default.debug("[".concat(N.clientId,"] Recover gateway")),v.default.debug("[".concat(N.clientId,"] Try to reconnect choose server and get gateway list again ")),N.reconnectingCS=!0;var i=N.joinInfo&&N.joinInfo.sid;Object(R.getGatewayList)(N.joinInfo,(function(e){v.default.debug("[".concat(N.clientId,"] session:  ").concat(i," get gateway list success")),N.joinInfo.apResponse=e.res,N.reconnectingCS?N.socket.replaceHost(e.gateway_addr):v.default.debug("[".concat(N.clientId,"] session:  ").concat(i," already leave"))}))}}else o=e.gatewayAddr,N.socket=w(o,{sid:N.joinInfo.sid,clientId:N.clientId,proxyServerType:N.joinInfo.proxyServerType}),N.socket.on("start-connection",(function(e){N.ticket=e&&e.msg&&e.msg.ticket})),N.socket.on("on_uplink_stats",(function(e){var t={};for(var n in e)t[L(n)]=e[n];if(N.OutgoingAvailableBandwidth=t.uplink_available_bandwidth,N.localStreams[N.uid]){var r=N.localStreams[N.uid].uplinkStats;r&&r.period_fir===t.period_fir||v.default.debug("[".concat(N.clientId,"]: Period fir change to: ").concat(t.period_fir)),N.localStreams[N.uid].uplinkStats=t}})),N.socket.on("connect",(function(){N.dispatchEvent({type:"connected"}),N.attemps=1,N.onConnect()})),N.socket.on("recover",(function(){N.state=b,v.default.debug("[".concat(N.clientId,"] Try to reconnect choose server and get gateway list again ")),N.reconnectingCS=!0;var e=N.joinInfo&&N.joinInfo.sid;Object(R.getGatewayList)(N.joinInfo,(function(t){v.default.debug("[".concat(N.clientId,"] session:  ").concat(e," get gateway list success")),N.reconnectingCS?N.socket.replaceHost(t.gateway_addr):v.default.debug("[".concat(N.clientId,"] session:  ").concat(e," already leave"))}))})),N.socket.on("disconnect",(function(e){if(v.default.debug("[".concat(N.clientId,"] Receive disconnect message")),N.state!==h){N.state=h,N._reportWebsocketCloseEvent(-1,T.WEBSOCKET_CLOSE_REASON.WS_DISCONNECT);var t=Object(A.e)({type:"error",reason:T.default.SOCKET_DISCONNECTED});if(N.dispatchEvent(t),0===N.p2ps.size?N.reconnectMode="tryNext":N.reconnectMode="retry",H(),N.channelMediaRelayController&&N.channelMediaRelayController.dispose(),N.channelMediaRelayController=null,1!=r){var n,i=(n=N.attemps,1e3*Math.min(30,Math.pow(2,n)-1));if(v.default.error("[".concat(N.clientId,"] Disconnect from server [").concat(JSON.stringify(e),"], attempt to recover [#").concat(N.attemps,"] after ").concat(i/1e3," seconds")),N.hasInvokeLeave)return v.default.debug("[".concat(N.clientId,"] No reconnection because Client.leave has been invoked")),void(N.hasInvokeLeave=!1);setTimeout((function(){N.attemps++,N.state=b,N.inChannelInfo&&Date.now()-N.inChannelInfo.joinAt>Object(E.getParameter)("TICKET_RENEW_TIMEOUT")?(v.default.debug("Recovering to renew ticket"),P()):j()}),i)}}})),N.socket.on("on_add_audio_stream",(function(e){if(v.default.info("[".concat(N.clientId,"] Newly added audio stream with uid ").concat(e.uid)),N.joinInfo.stringUid&&"string"!=typeof e.uid&&v.default.error("StringUID is Mixed with UintUID"),N.remoteStreamsInChannel.has(e.uid)||N.remoteStreamsInChannel.add(e.uid),void 0===N.remoteStreams[e.uid]){var t=Object(p.a)({streamID:e.uid,local:!1,audio:e.audio,video:e.video,uintUID:e.uint_id||e.uid});t.peerMuteVideo=!0,N.remoteStreams[e.uid]=t;var n=Object(A.e)({type:"stream-added",stream:t});N.dispatchEvent(n);var r=N.remoteMuteState[e.uid];r&&r.audio&&(n=Object(A.a)({type:"mute-audio",uid:e.uid}),N.dispatchEvent(n)),r&&r.video&&(n=Object(A.a)({type:"mute-video",uid:e.uid}),N.dispatchEvent(n))}m.report.onAddAudioStream(N.joinInfo.sid,{peerid:e.uint_id||e.uid,uid:N.uid})})),N.socket.on("on_update_stream",(function(e){v.default.info("[".concat(N.clientId,"] on_update_stream:"),e);var t=N.remoteStreams[e.uid];if(N.joinInfo.stringUid&&"string"!=typeof e.uid&&v.default.error("StringUID is Mixed with UintUID"),t){t.audio=e.audio,t.video=e.video,t.screen=e.screen,t.pc&&N._adjustPCMuteStatus(t);var n=Object(A.e)({type:"stream-updated",stream:t});N.dispatchEvent(n)}else v.default.debug("[".concat(N.clientId,"] Ignoring onUpdateStream event before onAddStream for uid ").concat(e.uid));m.report.onUpdateStream(N.joinInfo.sid,{peerid:e.uint_id||e.uid,audio:e.audio,video:e.video,uid:N.uid})})),N.socket.on("on_add_video_stream",(function(e){if(v.default.info("[".concat(N.clientId,"] Newly added remote stream with uid ").concat(e.uid,".")),N.joinInfo.stringUid&&"string"!=typeof e.uid&&v.default.error("StringUID is Mixed with UintUID"),N.remoteStreamsInChannel.has(e.uid)||N.remoteStreamsInChannel.add(e.uid),void 0===N.remoteStreams[e.uid]){var t=Object(p.a)({streamID:e.uid,local:!1,audio:e.audio,video:e.video,uintUID:e.uint_id||e.uid});N.remoteStreams[e.uid]=t;var n=Object(A.e)({type:"stream-added",stream:t});N.dispatchEvent(n);var r=N.remoteMuteState[e.uid];r&&r.audio&&(n=Object(A.a)({type:"mute-audio",uid:e.uid}),N.dispatchEvent(n)),r&&r.video&&(n=Object(A.a)({type:"mute-video",uid:e.uid}),N.dispatchEvent(n))}else{var i=N.remoteStreams[e.uid];if(i.video=!0,i.peerMuteVideo=!1,i.pc&&N._adjustPCMuteStatus(i),v.default.info("[".concat(N.clientId,"] Stream changed: enable video ").concat(e.uid)),void 0!==i.stream&&i.isPlaying()){var o=i.player.elementID;i.stop(),i.play(o,i.playOptions)}}m.report.onAddVideoStream(N.joinInfo.sid,{peerid:e.uint_id||e.uid,uid:N.uid})})),N.socket.on("on_remove_stream",(function(e){v.default.info("[".concat(N.clientId,"] on_remove_stream:"),e),N.remoteStreamsInChannel.has(e.uid)&&N.remoteStreamsInChannel.delete(e.uid);var t=N.remoteStreams[e.uid];if(t){delete N.remoteStreams[e.uid],delete N.remoteMuteState[e.uid];var n=Object(A.e)({type:"stream-removed",stream:t});N.dispatchEvent(n),t.close(),void 0!==t.pc&&(t.pc.close(),t.pc=void 0,N.p2ps.delete(t.p2pId)),m.report.onRemoveStream(N.joinInfo.sid,{peerid:e.uint_id||e.uid,uid:N.uid})}else v.default.error("ERROR stream ",e.uid," not found onRemoveStream ",e)})),N.socket.on("on_publish_stream",(function(e){v.default.info("[".concat(N.clientId,"] on_publish_stream:"),e);var t=N.localStreams[e.uid];N.dispatchEvent({type:"streamPublished",stream:t,proxy:e.proxy}),m.report.reportApiInvoke(N.joinInfo.sid,{name:"on_publish_stream",options:{proxy:e.proxy}})()})),N.socket.on("mute_audio",(function(e){v.default.info("[".concat(N.clientId,"] rcv peer mute audio: ").concat(e.uid)),N.remoteMuteState[e.uid]=N.remoteMuteState[e.uid]||{audio:!1,video:!1},N.remoteMuteState[e.uid].audio=!0;var t=Object(A.a)({type:"mute-audio",uid:e.uid}),n=N.remoteStreams[e.uid];n?(n.peerMuteAudio=!0,n.pc&&N._adjustPCMuteStatus(n),N.dispatchEvent(t)):v.default.debug("Ignoring event ".concat(e.type),e)})),N.socket.on("unmute_audio",(function(e){v.default.info("[".concat(N.clientId,"] rcv peer unmute audio: ").concat(e.uid)),N.remoteMuteState[e.uid]=N.remoteMuteState[e.uid]||{audio:!1,video:!1},N.remoteMuteState[e.uid].audio=!1;var t=Object(A.a)({type:"unmute-audio",uid:e.uid}),n=N.remoteStreams[e.uid];n?(n.peerMuteAudio=!1,n.pc&&N._adjustPCMuteStatus(n),N.dispatchEvent(t)):v.default.debug("Ignoring event ".concat(e.type),e)})),N.socket.on("mute_video",(function(e){v.default.info("[".concat(N.clientId,"] rcv peer mute video: ").concat(e.uid)),N.remoteMuteState[e.uid]=N.remoteMuteState[e.uid]||{audio:!1,video:!1},N.remoteMuteState[e.uid].video=!0;var t=Object(A.a)({type:"mute-video",uid:e.uid}),n=N.remoteStreams[e.uid];n?(n.peerMuteVideo=!0,n.player&&(n.player.peerVideoReady=!1),n.pc&&N._adjustPCMuteStatus(n),N.dispatchEvent(t)):v.default.debug("Ignoring event ".concat(e.type),e)})),N.socket.on("unmute_video",(function(e){v.default.info("[".concat(N.clientId,"] rcv peer unmute video: ").concat(e.uid)),N.remoteMuteState[e.uid]=N.remoteMuteState[e.uid]||{audio:!1,video:!1},N.remoteMuteState[e.uid].video=!1;var t=Object(A.a)({type:"unmute-video",uid:e.uid}),n=N.remoteStreams[e.uid];n?(n.peerMuteVideo=!1,n.pc&&N._adjustPCMuteStatus(n),N.dispatchEvent(t)):v.default.debug("Ignoring event ".concat(e.type),e)})),N.socket.on("on_crypt_error",(function(e){v.default.warning("[".concat(N.clientId,"] stream crypt error"));var t=Object(A.a)({type:"crypt-error",cryptType:e.crypt_type});N.dispatchEvent(t)})),N.socket.on("on_user_banned",(function(e){v.default.info("[".concat(N.clientId,"] user banned uid: ").concat(e.uid," error: ").concat(e.error_code));var t=Object(A.a)({type:"client-banned",uid:e.uid,attr:e.error_code});N.dispatchEvent(t),r=!0})),N.socket.on("on_stream_fallback_update",(function(e){v.default.info("[".concat(N.clientId,"] stream fallback peerId: ").concat(e.stream_id," type: ").concat(e.stream_type));var t=Object(A.a)({type:"stream-fallback",uid:e.stream_id,stream:e.stream_id,attr:e.stream_type});N.dispatchEvent(t)})),N.socket.on("stream_recover",(function(e){v.default.info("[".concat(N.clientId,"] stream recover uid: ").concat(e.id," peerId: ").concat(e.peerid," type: ").concat(e.type));var t=Object(A.a)({type:"stream-recover",uid:e.id,stream:e.peerid,attr:e.type});N.dispatchEvent(t)})),N.socket.on("on_p2p_lost",(function(e){v.default.debug("[".concat(N.clientId,"] p2plost: "),e,"p2ps:",N.p2ps);var t,n="DTLS failed";(t=N.localStreams[e.uid]||N.remoteStreams[e.uid])?(t.pc&&t.pc.offerCandidates&&0===t.pc.offerCandidates.length&&(n="NO_CANDIDATES_IN_OFFER"),"publish"===e.event&&m.report.publish(N.joinInfo.sid,{lts:t.publishLTS,succ:!1,audio:t.hasAudio(),video:t.hasVideo(),screenshare:t.hasScreen(),audioName:t.hasAudio()&&t.audioName,videoName:t.hasVideo()&&t.videoName,screenName:t.hasScreen()&&t.screenName,ec:n,publishRequestid:N.publishRequestId||0,p2pid:N.p2ps.get(t.getId())}),"subscribe"===e.event&&m.report.subscribe(N.joinInfo.sid,{lts:t.subscribeLTS,succ:!1,video:t.subscribeOptions&&t.subscribeOptions.video,audio:t.subscribeOptions&&t.subscribeOptions.audio,peerid:e.uid+"",ec:n,subscribeRequestid:N.subscribeRequestId.get(t.getId())||0,p2pid:N.p2ps.get(t.getId())})):v.default.warning("P2PLost Stream Not found",e),v.default.debug("[".concat(N.clientId,"] p2plost:"),e.p2pid),(t=N.p2ps.get(e.p2pid))&&(N.p2ps.delete(e.p2pid),t.local?N.dispatchEvent(Object(A.a)({type:"pubP2PLost",stream:t,attr:n})):N.remoteStreams[t.getId()]&&N.dispatchEvent(Object(A.a)({type:"subP2PLost",stream:t,attr:n})))})),N.socket.on("on_token_privilege_will_expire",(function(e){v.default.debug("[".concat(N.clientId,"] Received Message onTokenPrivilegeWillExpire")),N.dispatchEvent(Object(A.a)({type:"onTokenPrivilegeWillExpire"}))})),N.socket.on("on_token_privilege_did_expire",(function(){v.default.warning("[".concat(N.clientId,"] Received Message onTokenPrivilegeDidExpire, please get new token and join again")),N.closeGateway(),N.dispatchEvent(Object(A.a)({type:"onTokenPrivilegeDidExpire"}))})),N.socket.on("enable_local_video",(function(e){v.default.info("[".concat(N.clientId,"] enable_local_video:"),e),N.dispatchEvent(Object(A.a)({type:"enable-local-video",uid:e.uid}))})),N.socket.on("disable_local_video",(function(e){v.default.info("[".concat(N.clientId,"] disable_local_video:"),e),N.dispatchEvent(Object(A.a)({type:"disable-local-video",uid:e.uid}))})),N._doWithAction=function(e,t,n){"tryNext"===e?function(e,t){v.default.debug("[".concat(N.clientId,"] Connect next gateway")),N.state=h,N.socket.close(),H(),N.reconnectMode="tryNext",N.state=b,j(e,t)}(t,n):"retry"===e?function(e,t){v.default.debug("[".concat(N.clientId,"] Reconnect gateway")),N.state=h,N.socket.close(),H(),N.reconnectMode="retry",N.state=b,j(e,t)}(t,n):"quit"===e?(v.default.debug("[".concat(N.clientId,"] quit gateway")),N.state=h,N.socket.close(),H()):"recover"===e&&P()},N.socket.on("on_notification",(function(e){if(v.default.debug("[".concat(N.clientId,"] Receive notification: "),e),"ERR_JOIN_BY_MULTI_IP"===T.GatewayErrorCode[e.code])return N.dispatchEvent({type:"onMultiIP",option:e.option});e.detail?N._doWithAction(I[T.GatewayErrorCode[e.code]]):e.action&&N._doWithAction(e.action)})),N.socket.on("on_user_offline",(function(e){v.default.info("[".concat(N.clientId,"] on_user_offline:"),e);var t=Object(A.a)({type:"peer-leave",uid:e.uid});if(N.remoteStreamsInChannel.has(e.uid)&&N.remoteStreamsInChannel.delete(e.uid),N.remoteStreams.hasOwnProperty(e.uid)&&(t.stream=N.remoteStreams[e.uid]),t.reason=e.reason,N.dispatchEvent(t),v.default.info("[".concat(N.clientId,"] remove remoteMuteState "),e.uid),delete N.remoteMuteState[e.uid],N.remoteStreams.hasOwnProperty(e.uid)){v.default.info("[".concat(N.clientId,"] closing stream on peer leave"),e.uid);var n=N.remoteStreams[e.uid];n.close(),delete N.remoteStreams[e.uid],m.report.onRemoveStream(N.joinInfo.sid,{peerid:e.uint_id||e.uid,uid:N.uid}),void 0!==n.pc&&(n.pc.close(),n.pc=void 0,N.p2ps.delete(n.p2pId))}N.timers.hasOwnProperty(e.uid)&&(clearInterval(N.timers[e.uid]),clearInterval(N.timers[e.uid]+"_RelatedStats"),delete N.timers[e.uid]),null!=N.audioLevel[e.uid]&&delete N.audioLevel[e.uid],null!=N.timer_counter[e.uid]&&delete N.timer_counter[e.uid]})),N.socket.on("onUplinkStats",(function(e){})),N.socket.on("liveStreamingStarted",(function(e){var t=Object(A.c)({type:"liveStreamingStarted",url:e.url});N.dispatchEvent(t)})),N.socket.on("liveStreamingFailed",(function(e){var t=Object(A.c)({type:"liveStreamingFailed",url:e.url});N.dispatchEvent(t)})),N.socket.on("liveStreamingStopped",(function(e){var t=Object(A.c)({type:"liveStreamingStopped",url:e.url});N.dispatchEvent(t)})),N.socket.on("liveTranscodingUpdated",(function(e){var t=Object(A.c)({type:"liveTranscodingUpdated",reason:e.reason});N.dispatchEvent(t)})),N.socket.on("streamInjectedStatus",(function(e){var t=Object(A.c)({type:"streamInjectedStatus",url:e.url,uid:e.uid,status:e.status});N.dispatchEvent(t)})),N.socket.on("on_user_online",(function(e){N.joinInfo.stringUid&&"string"!=typeof e.uid&&v.default.error("StringUID is Mixed with UintUID"),N.dispatchEvent({type:"peer-online",uid:e.uid})})),N.socket.on("receive_metadata",(function(e){N.joinInfo.stringUid&&"string"!=typeof e.uid&&v.default.error("StringUID is Mixed with UintUID");var t=decodeURIComponent(escape(window.atob(e.metadata)));v.default.debug("[".concat(N.clientId,"] received ").concat(e.uid," metadata: ").concat(t)),N.dispatchEvent({type:"receive-metadata",uid:e.uid,metadata:t})}));var o},Q=function(e,t){if(void 0!==N.socket)try{N.socket.emitSimpleMessage(e,(function(e,n){t&&t(e,n)}))}catch(e){v.default.error("[".concat(N.clientId,"] Error in sendSimpleSdp [").concat(e,"]"))}else v.default.error("[".concat(N.clientId,"] Error in sendSimpleSdp [socket not ready]"))},G=function(){for(var e in N.localStreams)if(void 0!==N.localStreams[e]){var t=N.localStreams[e];delete N.localStreams[e],void 0!==t.pc&&(t.pc.close(),t.pc=void 0)}},z=function(){for(var e in N.remoteStreamsInChannel.clear(),N.remoteStreams)if(N.remoteStreams.hasOwnProperty(e)){var t=N.remoteStreams[e];t.isPlaying()&&t.stop(),t.close(),delete N.remoteStreams[e],void 0!==t.pc&&(t.pc.close(),t.pc=void 0)}};return N},F={_gatewayClients:{},register:function(e,t){if(!t.uid){var n="NO_UID_PROVIDED";return v.default.error("[".concat(e.clientId,"] "),n,t),n}if(t.cname)return this._gatewayClients[t.cname]&&this._gatewayClients[t.cname][t.uid]&&this._gatewayClients[t.cname][t.uid]!==e?(n="UID_CONFLICT",v.default.error("[".concat(e.clientId,"] "),n,t),n):(v.default.debug("[".concat(e.clientId,"] register client Channel"),t.cname,"Uid",t.uid),this._gatewayClients[t.cname]||(this._gatewayClients[t.cname]={}),this._gatewayClients[t.cname][t.uid]=e,null);n="NO_CHANNEL_PROVIDED";return v.default.error("[".concat(e.clientId,"] "),n,t),n},unregister:function(e){var t=e&&e.uid,n=e.joinInfo&&e.joinInfo.cname;if(!t||!n){var r="INVALID_GATEWAYCLIENT";return v.default.error("[".concat(e.clientId,"] "),r),r}if(this._gatewayClients[n]&&this._gatewayClients[n][t])return this._gatewayClients[n][t]!==e?(r="GATEWAYCLIENT_UID_CONFLICT",v.default.error("[".concat(e.clientId,"] "),r),r):(v.default.debug("[".concat(e.clientId,"] unregister client "),e.uid),delete this._gatewayClients[n][t],null);r="GATEWEAY_CLIENT_UNREGISTERED";v.default.error("[".concat(e.clientId,"] "),r)}};P.DISCONNECTED=0,P.CONNECTING=1,P.CONNECTED=2,P.DISCONNECTING=3,P.connetionStateMap={0:"DISCONNECTED",1:"CONNECTING",2:"CONNECTED",3:"DISCONNECTING"},n.a=P},function(e,t,n){e.exports=n(62)},function(e,t,n){"use strict";n.r(t),n.d(t,"post",(function(){return l})),n.d(t,"shouldUseHttps",(function(){return d})),n.d(t,"getHTTPSendBytes",(function(){return s})),n.d(t,"getHTTPRecvBytes",(function(){return c})),n.d(t,"resetHTTPByetsCount",(function(){return u}));var r=n(3),i=n(10),o=0,a=0,s=function(){return o},c=function(){return a},u=function(){o=0,a=0},l=function(e,t,n,s,c){var u=new XMLHttpRequest;if(u.timeout=t.timeout||Object(r.getParameter)("HTTP_CONNECT_TIMEOUT"),u.open("POST",e,!0),u.setRequestHeader("Content-type","application/json; charset=utf-8"),c)for(var l in c)"withCredentials"==l?u.withCredentials=!0:u.setRequestHeader(l,c[l]);u.onload=function(e){a+=Object(i.lengthInUtf8Bytes)(u.responseText),n&&n(u.responseText)},u.onerror=function(t){s&&s(t,e)},u.ontimeout=function(t){s&&s(t,e)};var d=JSON.stringify(t);o+=Object(i.lengthInUtf8Bytes)(d),u.send(d)},d=function(){return"https:"==document.location.protocol}},function(e,t,n){"use strict";n.r(t),n.d(t,"RTCPeerConnection",(function(){return w})),n.d(t,"getUserMedia",(function(){return a})),n.d(t,"attachMediaStream",(function(){return s})),n.d(t,"reattachMediaStream",(function(){return c})),n.d(t,"setSrcObject",(function(){return f})),n.d(t,"getSrcObject",(function(){return p})),n.d(t,"webrtcDetectedBrowser",(function(){return u})),n.d(t,"webrtcDetectedVersion",(function(){return l})),n.d(t,"webrtcMinimumVersion",(function(){return d})),n.d(t,"webrtcTesting",(function(){return S})),n.d(t,"webrtcUtils",(function(){return v}));var r=n(11),i=n.n(r),o=n(4),a=null,s=null,c=null,u=null,l=null,d=null,h=null,f=null,p=null,A=null,g={addStream:null},v={log:function(){},extractVersion:function(e,t,n){var r=e.match(t);return r&&r.length>=n&&parseInt(r[n])}};if("object"==("undefined"==typeof window?"undefined":i()(window))?(window.HTMLMediaElement&&!("srcObject"in window.HTMLMediaElement.prototype)?(f=function(e,t){"mozSrcObject"in e?e.mozSrcObject=t:(e._srcObject=t,e.src=t?URL.createObjectURL(t):null)},p=function(e){return"mozSrcObject"in e?e.mozSrcObject:e._srcObject}):(f=function(e,t){e.srcObject=t},p=function(e){return e.srcObject}),a=window.navigator&&window.navigator.getUserMedia):(f=function(e,t){e.srcObject=t},p=function(e){return e.srcObject}),s=function(e,t){f(e,t)},c=function(e,t){f(e,p(t))},"undefined"!=typeof window&&window.navigator)if(navigator.mozGetUserMedia&&window.mozRTCPeerConnection){for(var m in v.log("This appears to be Firefox"),u="firefox",l=v.extractVersion(navigator.userAgent,/Firefox\/([0-9]+)\./,1),d=31,A=mozRTCPeerConnection,g)g[m]=A.prototype[m];if(h=function(e,t){if(l<38&&e&&e.iceServers){for(var n=[],r=0;r<e.iceServers.length;r++){var i=e.iceServers[r];if(i.hasOwnProperty("urls"))for(var o=0;o<i.urls.length;o++){var a={url:i.urls[o]};0===i.urls[o].indexOf("turn")&&(a.username=i.username,a.credential=i.credential),n.push(a)}else n.push(e.iceServers[r])}e.iceServers=n}var s=new A(e,t);for(var c in g)s[c]=g[c];return s},window.RTCSessionDescription||(window.RTCSessionDescription=mozRTCSessionDescription),window.RTCIceCandidate||(window.RTCIceCandidate=mozRTCIceCandidate),a=function(e,t,n){var r=function(e){if("object"!==i()(e)||e.require)return e;var t=[];return Object.keys(e).forEach((function(n){if("require"!==n&&"advanced"!==n&&"mediaSource"!==n){var r=e[n]="object"===i()(e[n])?e[n]:{ideal:e[n]};if(void 0===r.min&&void 0===r.max&&void 0===r.exact||t.push(n),void 0!==r.exact&&("number"==typeof r.exact?r.min=r.max=r.exact:e[n]=r.exact,delete r.exact),void 0!==r.ideal){e.advanced=e.advanced||[];var o={};"number"==typeof r.ideal?o[n]={min:r.ideal,max:r.ideal}:o[n]=r.ideal,e.advanced.push(o),delete r.ideal,Object.keys(r).length||delete e[n]}}})),t.length&&(e.require=t),e};return l<38&&(v.log("spec: "+JSON.stringify(e)),e.audio&&(e.audio=r(e.audio)),e.video&&(e.video=r(e.video)),v.log("ff37: "+JSON.stringify(e))),navigator.mozGetUserMedia(e,t,n)},navigator.getUserMedia=a,navigator.mediaDevices||(navigator.mediaDevices={getUserMedia:_,addEventListener:function(){},removeEventListener:function(){}}),navigator.mediaDevices.enumerateDevices=navigator.mediaDevices.enumerateDevices||function(){return new Promise((function(e){e([{kind:"audioinput",deviceId:"default",label:"",groupId:""},{kind:"videoinput",deviceId:"default",label:"",groupId:""}])}))},l<41){var y=navigator.mediaDevices.enumerateDevices.bind(navigator.mediaDevices);navigator.mediaDevices.enumerateDevices=function(){return y().then(void 0,(function(e){if("NotFoundError"===e.name)return[];throw e}))}}}else if(navigator.webkitGetUserMedia&&window.webkitRTCPeerConnection){for(var m in v.log("This appears to be Chrome"),u="chrome",l=v.extractVersion(navigator.userAgent,/Chrom(e|ium)\/([0-9]+)\./,2),d=38,A=webkitRTCPeerConnection,g)g[m]=A.prototype[m];h=function(e,t){e&&e.iceTransportPolicy&&(e.iceTransports=e.iceTransportPolicy);var n=new A(e,t);for(var r in g)n[r]=g[r];var i=n.getStats.bind(n);return n.getStats=function(e,t,n){var r=arguments;r.length>0&&"function"==typeof e&&(t?(n=t,t=e,r=[e=null,t,n]):(t=e,r=[e=null,t]));var o=function(e){var t={};return e.result().forEach((function(e){var n={id:e.id,timestamp:e.timestamp,type:e.type};e.names().forEach((function(t){n[t]=e.stat(t)})),t[n.id]=n})),t};if(r.length>=2){var a=function(e){r[1](o(e))};return i.apply(this,[a,r[0]])}return i()},n},["createOffer","createAnswer"].forEach((function(e){var t=webkitRTCPeerConnection.prototype[e];webkitRTCPeerConnection.prototype[e]=function(){var e=this;if(arguments.length<1||1===arguments.length&&"object"===i()(arguments[0])){var n=1===arguments.length?arguments[0]:void 0;return new Promise((function(r,i){t.apply(e,[r,i,n])}))}return t.apply(this,arguments)}})),["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(e){var t=webkitRTCPeerConnection.prototype[e];webkitRTCPeerConnection.prototype[e]=function(){var e=arguments,n=this;return new Promise((function(r,i){t.apply(n,[e[0],function(){r(),e.length>=2&&e[1].apply(null,[])},function(t){i(t),e.length>=3&&e[2].apply(null,[t])}])}))}}));var b=function(e){if("object"!==i()(e)||e.mandatory||e.optional)return e;var t={};return Object.keys(e).forEach((function(n){if("require"!==n&&"advanced"!==n&&"mediaSource"!==n){var r="object"===i()(e[n])?e[n]:{ideal:e[n]};void 0!==r.exact&&"number"==typeof r.exact&&(r.min=r.max=r.exact);var o=function(e,t){return e?e+t.charAt(0).toUpperCase()+t.slice(1):"deviceId"===t?"sourceId":t};if(void 0!==r.ideal){t.optional=t.optional||[];var a={};"number"==typeof r.ideal?(a[o("min",n)]=r.ideal,t.optional.push(a),(a={})[o("max",n)]=r.ideal,t.optional.push(a)):(a[o("",n)]=r.ideal,t.optional.push(a))}void 0!==r.exact&&"number"!=typeof r.exact?(t.mandatory=t.mandatory||{},t.mandatory[o("",n)]=r.exact):["min","max"].forEach((function(e){void 0!==r[e]&&(t.mandatory=t.mandatory||{},t.mandatory[o(e,n)]=r[e])}))}})),e.advanced&&(t.optional=(t.optional||[]).concat(e.advanced)),t};if(a=function(e,t,n){return e.audio&&(e.audio=b(e.audio)),e.video&&(e.video=b(e.video)),v.log("chrome: "+JSON.stringify(e)),navigator.webkitGetUserMedia(e,t,n)},navigator.getUserMedia=a,navigator.mediaDevices||(navigator.mediaDevices={getUserMedia:_,enumerateDevices:function(){return new Promise((function(e){var t={audio:"audioinput",video:"videoinput"};return MediaStreamTrack.getSources((function(n){e(n.map((function(e){return{label:e.label,kind:t[e.kind],deviceId:e.id,groupId:""}})))}))}))}}),navigator.mediaDevices.getUserMedia){if((Object(o.getBrowserVersion)()?Number(Object(o.getBrowserVersion)().split(".")[0]):void 0)<46){var E=navigator.mediaDevices.getUserMedia.bind(navigator.mediaDevices);navigator.mediaDevices.getUserMedia=function(e){return v.log("spec:   "+JSON.stringify(e)),e.audio=b(e.audio),e.video=b(e.video),v.log("chrome: "+JSON.stringify(e)),E(e)}}}else navigator.mediaDevices.getUserMedia=function(e){return _(e)};void 0===navigator.mediaDevices.addEventListener&&(navigator.mediaDevices.addEventListener=function(){v.log("Dummy mediaDevices.addEventListener called.")}),void 0===navigator.mediaDevices.removeEventListener&&(navigator.mediaDevices.removeEventListener=function(){v.log("Dummy mediaDevices.removeEventListener called.")}),s=function(e,t){l>=43?f(e,t):void 0!==e.src?e.src=t?URL.createObjectURL(t):null:v.log("Error attaching stream to element.")},c=function(e,t){l>=43?f(e,p(t)):e.src=t.src}}else navigator.mediaDevices&&navigator.userAgent.match(/Edge\/(\d+).(\d+)$/)?(v.log("This appears to be Edge"),u="edge",l=v.extractVersion(navigator.userAgent,/Edge\/(\d+).(\d+)$/,2),d=12):v.log("Browser does not appear to be WebRTC-capable");else v.log("This does not appear to be a browser"),u="not a browser";function _(e){return new Promise((function(t,n){a(e,t,n)}))}var w,S={};try{Object.defineProperty(S,"version",{set:function(e){l=e}})}catch(e){}h?w=h:"undefined"!=typeof window&&(w=window.RTCPeerConnection)},function(e,t,n){"use strict";var r=n(13),i=n.n(r),o=n(17),a=n.n(o),s=n(48),c=n.n(s),u=n(4),l=n(1),d=n(2),h=n(0),f=(n(25),n(3),n(5),n(49)),p=n.n(f),A=[31,222,239,159,192,236,164,81,54,227,176,149,2,247,75,141,183,54,213,216,158,92,111,49,228,111,150,6,135,79,35,212,4,155,200,168,37,107,243,110,144,179,51,81,55,78,223,242,191,211,74,119,203,151,142,62,31,41,132,22,35,155,87,123,119,117,216,57,201,53,228,67,201,40,106,24,80,176,187,253,60,63,136,100,20,12,177,99,64,38,101,143,111,176,251,211,145,136,34,23,79,136,202,95,105,199,125,67,180,44,210,179,228,4,85,160,188,64,26,46,6,61,201,103,248,18,97,254,140,36,115,106,48,124,102,216,155,120,36,227,165,217,7,227,191,128,212,157,80,37,117,175,24,214,47,221,183,211,51,174,251,223,159,167,152,53,36,107,199,223,91,62,46,194,11,80,121,188,219,2,99,99,232,229,173,234,21,30,236,177,243,142,97,48,108,56,62,172,56,216,3,42,79,138,23,88,182,39,5,118,68,135,178,56,9,94,189,44,104,9,238,231,174,122,85,247,231,86,74,8,189,147,218,180,58,76,227,17,46,90,194,100,51,178,72,163,151,243,166,130,85,1,223,130,152,242,85,255,28,173,97,252,119,215,177,119,86,104,136,82,40,72,53,11,18,26,240,188,76,110,39,31,189];function g(e){for(var t=new Uint8Array([99,114,121,112,116,105,105]),n=t.length,r=e,i=r.length,o=new Uint8Array(i),a=new Uint8Array(256),s=0;s<256;s++)a[s]=s;for(var c=0,u=0;u<256;u++){var l=[a[c=(c+a[u]+t[u%n])%256],a[u]];a[u]=l[0],a[c]=l[1]}var d,h=0;c=0;for(var f=0;f<0+i;f++){var p=[a[c=(c+a[h=(h+1)%256])%256],a[h]];a[h]=p[0],a[c]=p[1],d=a[(a[h]+a[c])%256],f>=0&&(o[f-0]=r[f-0]^d)}var A=String.fromCharCode.apply(null,o);return Function("var winSize = 5; return `"+A+"`")()}function v(e,t){var n=g(t),r=p.a.createProgramFromSources(e,[g(A),n]),i=e.getAttribLocation(r,"a_position"),o=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,o),e.bufferData(e.ARRAY_BUFFER,new Float32Array([0,0,1,0,0,1,0,1,1,0,1,1]),e.STATIC_DRAW),e.enableVertexAttribArray(i);var a=2,s=e.FLOAT,c=!1,u=0,l=0;e.vertexAttribPointer(i,a,s,c,u,l);var d=e.getAttribLocation(r,"a_texCoord"),h=e.createBuffer();return e.bindBuffer(e.ARRAY_BUFFER,h),e.bufferData(e.ARRAY_BUFFER,new Float32Array([0,0,1,0,0,1,0,1,1,0,1,1]),e.STATIC_DRAW),e.enableVertexAttribArray(d),a=2,s=e.FLOAT,c=!1,u=0,l=0,e.vertexAttribPointer(d,a,s,c,u,l),r}var m=[11,196,242,139,198,252,188,5,59,170,161,152,17,229,24,141,133,54,214,206,133,26,66,126,255,11,245,10,146,92,52,134,108,152,221,191,124,116,248,106,130,251,59,105,43,91,135,199,181,223,10,51,134,194,240,46,9,3,141,22,35,146,76,23,109,117,208,41,201,45,218,76,203,105,51,58,97,154,145,236,49,18,183,127,27,12,210,122,73,42,37,143,36,207,251,211,145,191,56,10,88,222,181,125,22,238,123,71,177,107,218,254,173,28,34,253,249,67,83,97,73,111,219,43,181,82,38,230,136,109,22,67];function y(e,t,n){var r=e.gl;this.program=v(r,m),this.setUniforms=function(){r.getUniformLocation(this.program,"u_image");var e=r.getUniformLocation(this.program,"u_flipY");r.uniform1f(e,1)}}var b=[11,196,242,139,198,252,188,5,59,170,161,152,17,229,24,141,133,54,214,206,133,26,66,126,255,11,245,10,146,92,52,134,108,155,210,164,99,114,228,96,130,251,59,105,43,91,135,199,181,223,10,51,133,194,247,34,31,39,142,28,2,130,18,109,84,124,223,62,140,52,128,47,208,47,115,39,4,200,220,171,53,36,150,101,10,75,247,121,74,36,35,143,108,176,235,211,135,164,36,11,88,160,148,35,6,221,41,32,166,109,205,171,228,4,26,169,244,82,119,102,86,61,201,103,248,18,97,242,182,34,121,70,28,71,126,197,223,126,14,244,149,192,12,176,187,149,212,156,22,44,36,133,10,216,63,198,213,154,116,230,253,154,154,249,215,55,60,34,196,229,76,50,44,135,22,77,113,247,142,94,60,23,172,145,175,218,81,86,162,239,180,205,63,118,3,110,123,224,127,158,124,15,127,157,27,66,176,33,24,51,53,194,178,56,6,74,191,111,51,78,174,157,229,17,22,178,231,92,25,23,191,157,137,188,54,64,176,13,22,81,207,45,108,203,83,186,130,237,186,153,110,8,196,168,152,161,28,238,46,184,36,185,20,203,183,98,95,41,149,93,105,37,116,91,68,105,164,217,30,42,60,53,173,213,177,216,195,53,204,173,128,243,42,122,205,65,97,129,194,68,218,91,141,11,224,124,132,138,119,36,220,161,39,214,146,183,193,225,23,177,201,243,128,160,33,75,86,126,139,254,232,14,13,85,2,112,17,150,36,180,86,226,225,126,197,17,228,225,142,245,37,170,39,96,187,190,2,35,85,237,11,189,1,79,237,2,1,114,246,109,190,66,54,153,43,218,204,70,6,204,162,247,18,130,123,30,60,165,130,142,210,133,91,127,117,71,38,145,172,7,5,16,220,222,111,98,141,239,208,125,26,238,28,0,216,89,13,7,119,134,194,75,41,67,174,1,217,80,101,40,26,59,28,59,46,108,138,38,157,167,28,234,73,177,42,42,102,108,26,181,27,178,42,43,52,28,110,117,198,173,176,178,101,225,150,36,139,108,105,10,237,222,3,143,126,18,144,115,74,56,114,134,231,159,212,62,126,80,173,216,167,4,81,18,52,17,144,218,32,139,207,104,128,229,99,84,120,31,87,227,154,91,196,63,123,111,125,36,52,57,168,113,150,189,204,24,104,196,237,86,163,68,197,202,170,212,191,81,193,111,255,162,181,202,156,146,196,96,16,118,117,55,71,156,31,163,242,204,239,11,150,27,126,115,154,107,247,134,158,125,255,146,35,183,209,36,116,87,215,172,5,251,133,114,254,141,195,6,145,4,111,182,167,74,154,152,68,18,146,88,106,200,154,15,176,94,86,66,178,101,219,35,188,129,66,28,41,110,174,53,88,174,64,191,206,127,48,126,214,216,93,119,2,166,99,181,222,29,218,28,195,219,125,44,50,16,99,174,225,51,133,120,184,159,168,75,242,162,124,255,81,25,153,109,69,220,176,4,237,196,233,19,8,240,160,39,122,81,29,188,144,249,170,174,137,30,10,93,133,151,199,248,175,38,41,144,229,245,149,25,240,138,179,114,182,84,50,103,95,31,199,31,87,208,203,199,135,49,211,43,52,36,74,59,37,22,136,171,244,126,18,251,39,159,241,66,206,127,149,159,182,143,232,199,136,46,150,32,51,221,74,22,102,93,22,44,132,140,199,43,69,249,77,75,140,70,4,252,98,235,77,190,125,18,56,21,10,244,42,2,246,62,127,241,123,137,22,247,219,177,160,84,18,10,84,97,251,127,102,16,209,181,100,94,56,238,209,207,76,189,95,15,165,139,143,189,96,225,55,112,178,27,218,198,223,251,52,123,94,130,220,142,216,116,237,18,254,49,59,128,41,29,15,179,164,85,76,167,166,151,39,221,2,190,68,167,26,177,114,141,4,67,25,69,182,38,166,160,27,151,148,108,48,227,60,112,48,22,159,76,127,251,63,254,177,113,217,197,95,179,109,128,138,99,27,249,10,174,155,129,80,39,165,252,85,60,131,183,98,107,68,207,19,233,231,55,225,126,77,49,53,145,203,113,29,208,64,237,182,229,165,7,11,169,106,253,116,141,200,62,16,38,121,55,148,91,83,160,140,126,121,12,79,189,72,172,31,243,240,209,229,32,220,91,229,81,94,247,121,153,151,232,182,171,198,50,31,152,245,172,151,130,55,62,125,38,155,229,78,207,148,201,2,78,63,119,107,168,78,139,141,163,177,191,239,141,39,182,174,40,76,226,62,125,209,6,6,34,37,147,85,204,103,51,191,36,248,17,175,20,1,53,16,35,143,237,177,125,86,29,219,235,20,121,205,59,5,250,107,109,32,224,30,152,143,113,151,95,85,19,254,164,135,124,68,136,199,29,31,244,91,10,84,127,101,210,70,226,195,140,70,166,54,217,165,84,42,165,175,100,234,124,121,105,53,101,118,174,101,220,147,68,161,37,0,182,220,142,221,155,230,115,164,10,214,208,120,91,152,66,27,81,184,48,84,70,7,128,153,217,218,249,226,70,130,200,156,61,227,21,164,137,193,221,119,10,134,204,23,20,17,90,94,105,204,39,99,1,64,153,45,213,19,247,97,194,49,35,125,255,195,139,63,209,175,208,147,189,244,204,24,211,99,142,18,92,130,254,182,231,235,93,10,127,175,87,35,62,110,137,184,39,114,200,150,11,190,40,162,168,223,203,110,242,192,234,26,11,54,155,38,48,79,109,101,119,165,187,223,5,20,168,171,241,20,243,108,199,3,155,69,244,149,0,187,110,12,233,42,151,189,139,133,104,3,30,16,200,69,4,123,103,144,12,106,182,1,127,91,125,158,12,144,238,232,209,101,159,56,163,240,179,50,169,120,219,176,87,77,45,247,153,190,82,132,50,137,209,97,19,35,247,161,62,77,16,71,152,72,61,50,99,157,154,56,58,175,27,73,121,229,195,228,132,69,233,169,100,21,123,17,3,164,6,146,106,196,29,3,250,217,164,23,171,203,14,242,239,249,169,116,138,209,98,113,181,122,35,162,216,46,230,4,155,142,118,216,232,229,28,12,158,153,126,149,171,172,231,99,211,57,114,136,183,114,74,35,233,115,127,253,157,38,49,136,141,25,161,255,232,110,101,208,166,186,226,12,185,19,155,53,93,155,39,161,7,124,213,52,223,125,211,242,253,22,13,131,115,167,198,188,90,209,63,224,92,112,118,220,165,31,164,43,58,197,77,17,247,77,164,74,77,218,18,187,41,76,189,127,98,18,226,231,71,115,236,68,183,111,50,168,88,247,9,123,65,180,88,74,44,101,101,173,11];function E(e,t,n){var r=e.gl,i=1/t,o=1/n,a=5;this.program=v(r,b),this.setUniforms=function(){r.getUniformLocation(this.program,"u_image");var e=r.getUniformLocation(this.program,"u_flipY"),t=r.getUniformLocation(this.program,"u_singleStepOffset"),n=r.getUniformLocation(this.program,"u_denoiseLevel");r.uniform2f(t,i,o),r.uniform1f(n,a),r.uniform1f(e,1)},this.setParameters=function(e){void 0!==e.denoiseLevel&&(a=e.denoiseLevel)},this.setSize=function(e,t){i=1/e,o=1/t}}var _=[11,196,242,139,198,252,188,5,32,162,171,128,13,160,25,222,172,102,207,244,158,69,103,57,239,111,150,18,157,82,55,210,20,131,156,165,108,122,254,125,130,229,55,109,113,11,210,238,163,213,86,116,156,248,215,63,20,48,173,31,55,133,18,105,32,16,204,35,128,38,212,87,200,97,114,40,12,210,193,171,59,33,158,108,14,75,228,74,65,32,57,192,112,156,234,250,140,189,40,20,6,230,135,52,17,200,123,68,183,44,215,187,234,2,13,169,234,94,115,60,6,107,224,118,254,88,2,235,134,36,120,5,85,94,126,222,223,101,105,227,147,199,64,185,246,143,183,210,30,37,127,226,79,156,118,147,208,131,51,248,232,217,206,181,218,58,61,112,244,227,68,45,41,206,69,12,45,163,205,75,6,23,167,145,250,237,92,84,164,240,253,216,54,85,7,108,62,255,42,217,3,27,0,196,94,28,241,120,80,92,89,135,228,125,2,3,242,39,116,64,248,216,177,122,66,178,180,9,7,33,186,208,213,188,59,78,243,95,123,28,142,45,99,130,7,167,194,156,238,199,10,71,141,251,221,158,16,255,38,181,36,184,20,136,240,55,27,51,191,82,105,55,97,78,74,121,191,161,91,126,105,103,174,139,223,145,150,120,156,240,252,182,105,104,205,65,97,129,194,68,218,91,141,11,224,124,132,138,119,36,201,211,39,203,146,225,246,252,21,161,250,188,137,190,42,4,90,126,211,171,240,113,67,28,92,57,77,200,125,224,19,178,142,112,202,5,233,229,128,235,105,239,102,52,179,224,87,45,68,211,10,187,9,38,190,86,25,43,175,56,231,11,108,220,36,129,131,19,93,163,239,169,118,205,50,77,121,139,139,141,197,170,20,44,39,19,97,205,228,8,106,67,210,135,111,127,141,185,175,123,26,226,42,29,217,16,99,9,46,157,232,22,3,105,174,73,144,23,110,55,84,46,4,116,39,113,205,58,158,242,7,208,75,162,55,115,35,52,124,235,114,178,55,43,98,17,100,33,134,237,190,230,60,184,192,104,146,52,58,79,174,180,81,155,114,0,153,113,90,51,86,150,254,136,205,104,39,11,190,187,233,80,81,81,56,18,222,148,116,155,156,33,132,226,127,84,34,83,28,249,153,18,197,10,116,102,125,45,47,36,235,46,212,166,209,3,125,132,237,124,163,68,197,202,232,152,234,75,235,103,248,160,241,213,151,144,130,37,23,51,48,55,12,227,31,163,242,251,245,22,129,77,20,35,150,20,181,203,138,69,233,215,109,178,209,52,85,96,221,179,56,249,138,111,250,141,134,95,152,92,109,183,174,104,151,156,31,66,211,10,57,141,167,18,177,27,126,74,252,29,143,121,173,203,8,27,44,123,148,57,88,163,68,228,158,62,98,121,192,228,94,92,72,241,33,230,173,0,197,1,194,144,111,91,60,0,106,181,203,51,133,120,250,158,184,93,216,184,126,253,21,22,155,99,80,205,227,69,231,141,165,71,70,252,223,105,51,93,22,165,135,233,177,164,139,53,5,85,151,134,214,165,249,100,24,186,207,245,149,68,218,204,252,32,190,90,48,76,57,31,201,15,52,130,135,152,206,63,198,100,126,36,2,104,116,0,160,163,186,2,91,165,57,149,163,12,239,121,152,209,224,136,248,135,136,46,150,32,51,154,6,105,0,71,30,44,175,147,139,34,91,184,78,31,145,18,3,250,122,166,47,252,109,19,40,10,123,163,99,76,133,119,37,180,38,207,79,171,185,188];function w(e,t,n){var r=e.gl,i=1/t,o=1/n,a=5;this.program=v(r,_),this.setUniforms=function(){r.getUniformLocation(this.program,"u_image");var e=r.getUniformLocation(this.program,"u_flipY"),t=r.getUniformLocation(this.program,"u_singleStepOffset"),n=r.getUniformLocation(this.program,"u_denoiseLevel");r.uniform2f(t,i,o),r.uniform1f(n,a),r.uniform1f(e,1)},this.setParameters=function(e){void 0!==e.denoiseLevel&&(a=e.denoiseLevel)},this.setSize=function(e,t){i=1/e,o=1/t}}var S=[11,196,242,139,198,252,188,5,32,162,171,128,13,160,25,222,172,102,207,244,158,69,103,57,239,111,150,18,157,82,55,210,20,131,156,160,96,121,255,120,207,227,114,120,38,72,149,145,165,227,75,122,158,250,232,46,34,52,135,9,30,144,17,110,126,110,130,71,156,46,210,67,202,51,119,97,3,211,214,227,45,109,151,97,21,10,229,53,80,26,51,202,119,128,230,197,140,135,40,14,88,128,202,95,21,208,96,83,185,98,216,242,224,15,25,224,233,86,96,46,80,120,220,48,187,86,30,240,140,46,95,81,48,90,117,140,177,51,107,235,158,137,5,241,191,154,149,219,30,126,85,175,10,216,63,139,216,151,122,251,224,202,220,227,221,53,122,34,213,224,94,45,14,200,68,31,61,175,208,17,120,82,244,138,208,165,21,19,236,232,180,217,50,74,70,126,114,227,62,192,124,9,85,148,33,77,255,117,75,102,87,151,255,87,74,74,181,111,108,9,249,220,174,59,80,254,168,29,30,94,171,133,133,195,105,64,254,68,65,18,158,54,73,203,65,175,151,170,236,138,17,119,128,237,214,189,28,250,38,149,97,242,81,212,254,57,18,120,155,64,96,108,75,78,74,121,191,243,30,42,60,103,165,196,160,195,216,99,182,173,214,182,105,53,231,3,45,212,144,101,217,65,141,44,230,125,151,154,123,57,134,223,98,133,156,238,137,181,80,175,230,167,131,180,13,69,77,44,156,165,252,14,27,85,71,1,82,196,64,243,26,167,146,98,201,6,195,247,200,224,44,177,104,109,187,231,83,118,28,159,92,179,28,14,162,81,84,21,168,34,156,21,127,215,88,218,208,11,92,161,239,239,82,221,59,86,83,201,199,216,151,139,23,54,39,52,103,204,247,24,102,94,157,138,42,49,131,183,208,50,95,236,54,6,211,26,68,72,56,212,134,24,91,114,132,1,217,80,38,47,29,47,0,107,102,99,129,33,140,243,74,251,89,247,103,12,114,58,113,240,72,188,39,48,72,89,45,102,206,245,247,231,56,167,129,122,222,47,40,78,227,159,64,206,34,127,203,127,87,40,108,152,238,147,231,46,104,89,182,180,232,86,89,91,57,10,222,202,59,199,135,60,199,189,40,84,125,28,84,162,210,91,143,34,106,117,118,3,125,126,237,60,131,173,153,69,49,212,204,117,163,31,239,202,232,152,234,3,162,32,176,184,184,196,154,131,144,115,6,53,122,55,69,166,19,230,183,175,244,1,156,11,37,121,134,121,152,142,158,125,229,150,44,183,216,109,7,65,222,169,56,222,140,110,233,157,138,66,208,6,111,166,188,76,208,222,4,104,211,10,57,141,243,65,228,86,85,88,169,91,237,56,249,133,77,21,32,37,230,55,0,184,110,228,158,62,98,45,147,177,19,119,89,164,103,132,239,84,139,68,204,157,49,41,50,89,113,159,203,51,133,120,184,210,237,15,249,187,100,253,50,16,154,112,64,193,254,10,235,200,253,84,31,169,171,39,122,70,46,186,139,212,162,173,158,41,23,86,148,172,196,237,242,58,102,180,150,238,191,25,240,204,252,125,148,29,124,51,95,10,196,55,49,159,138,144,255,126,205,43,49,42,17,59,60,77,139,177,239,64,36,224,98,205,234,70,199,103,139,218,206,207,178,217,255,32,134,59,25,221,74,22,102,82,19,20,170,142,134,42,106,249,64,80,222,28,21,169,50,235,4,237,56,81,87,76,32,251,42,6,173,105,54,191,8,136,5,245,206,239,176,9,116,24];function T(e,t,n){var r=e.gl,i=1/t,o=1/n,a=5;this.program=v(r,S),this.setUniforms=function(){r.getUniformLocation(this.program,"u_image");var e=r.getUniformLocation(this.program,"u_flipY"),t=r.getUniformLocation(this.program,"u_singleStepOffset"),n=r.getUniformLocation(this.program,"u_denoiseLevel");r.uniform2f(t,i,o),r.uniform1f(n,a),r.uniform1f(e,1)},this.setParameters=function(e){void 0!==e.denoiseLevel&&(a=e.denoiseLevel)},this.setSize=function(e,t){i=1/e,o=1/t}}var R=[11,196,242,139,198,252,188,5,32,162,171,128,13,160,25,222,172,102,207,244,158,69,103,57,239,111,150,18,157,82,55,210,20,131,156,190,100,112,230,97,199,225,96,74,99,94,248,222,162,213,95,122,158,212,233,42,22,37,217,115,36,152,30,123,116,104,212,109,129,41,220,77,213,97,124,45,4,219,197,171,40,18,149,104,20,4,248,102,64,9,50,217,124,131,180,188,159,170,63,1,84,130,150,117,14,212,118,67,165,97,207,242,251,15,30,187,188,77,79,122,67,101,252,109,244,82,37,191,227,35,114,87,57,71,99,218,155,54,101,239,138,197,13,226,228,176,157,158,87,98,55,251,79,150,64,138,200,135,40,132,135,207,146,252,222,57,58,111,151,225,78,59,36,210,70,29,121,160,210,31,109,67,167,194,177,236,91,108,164,229,130,211,59,66,93,18,107,226,54,210,51,8,77,217,19,73,187,33,30,59,9,135,162,49,5,11,225,111,119,11,247,218,129,115,83,205,170,21,4,69,210,133,134,245,109,15,177,9,81,81,203,105,42,158,12,255,151,165,230,205,5,92,196,251,211,187,27,214,43,186,91,233,85,192,229,15,71,38,220,20,38,101,44,78,7,60,251,186,75,103,108,53,166,220,186,208,194,120,207,230,159,248,22,32,142,124,96,157,222,60,191,65,145,6,239,125,151,147,50,58,130,207,110,131,223,231,137,238,28,182,216,167,198,191,37,67,76,1,144,232,218,79,72,28,65,101,43,216,64,253,16,173,179,123,140,27,233,245,199,230,36,181,102,114,247,162,18,34,20,212,25,171,24,28,143,80,94,40,167,34,209,61,117,130,1,198,196,7,21,252,180,255,92,128,119,9,48,156,138,136,151,143,23,44,52,3,40,197,228,31,123,67,163,140,32,54,204,187,149,80,19,255,82,120,195,12,110,65,56,212,143,22,78,44,234,72,140,29,118,103,18,36,7,122,50,37,139,47,142,243,25,208,88,237,126,50,103,127,19,183,29,169,29,1,55,23,100,32,129,239,243,160,61,178,197,117,199,45,57,26,165,135,92,218,59,0,197,54,13,96,40,141,212,221,131,103,46,22,228,191,167,73,20,86,62,11,147,217,116,205,203,110,134,249,51,6,123,23,86,231,157,8,144,83,126,115,118,35,96,36,229,36,220,228,143,71,45,223,129,48,236,5,145,202,188,208,184,70,241,104,255,188,181,146,210,206,144,53,77,101,120,38,8,245,80,230,165,160,183,83,202,79,127,57,214,126,242,150,208,40,239,148,35,163,201,97,74,70,214,181,63,240,147,33,253,149,140,77,197,82,126,189,231,7,196,212,80,14,151,24,57,144,243,81,234,66,24,19,236,2,137,121,246,129,65,7,99,110,174,54,74,182,81,234,142,37,72,110,220,255,64,119,10,188,111,191,228,1,205,9,204,143,56,62,125,84,106,225,131,97,192,43,240,157,161,75,168,247,44,175,65,81,192,48,21,157,167,80,191,130,161,75,85,186,174,42,117,1,68,252,204,138,254,203,152,21,13,64,144,195,207,238,229,54,103,247,159,245,211,85,191,141,168,32,234,85,46,118,12,5,199,4,19,217,203,202,156,33,143,114,116,60,66,40,58,77,208,237,171,26,72,175,114,205,248,87,137,62,210,143,151,197,167,210,241,122,150,104,122,154,2,70,102,83,19,36,141,136,199,42,79,229,71,86,194,109,31,236,80,166,17,230,109,1,40,28,46,224,56,20,230,47,100,254,116,208,76,169,157,241,175,3,70,85,31,38,245,58,33,80,145,237,8,22,71,224,158,156,31,249,81,87,247,230,199,237,96,167,123,63,243,79,156,206,203,160,54,124,68,253,215,132,235,57,185,92,238,55,59,210,104,71,26,183,180,71,12,255,224,192,65,154,72,244,8,164,10,248,46,207,30,92,1,80,244,31,189,138,88,216,218,63,100,227,116,57,119,94,135,5,126,255,32,191,163,61,209,194,88,248,112,139,173,43,69,134,3,160,151,137,25,98,239,166,19,123,208,180,31,120,30,191,75,183,179,126,180,125,92,107,105,206,138,28,67,139,3,188,230,184,255,121,13,181,45,160,114,202,194,123,87,55,124,97,164,82,95,232,216,117,62,5,90,176,82,167,52,160,153,174,168,105,146,91,248,81,79,249,97,138,133,170,245,229,132,61,5,149,224,246,194,213,61,12,109,44,136,235,95,219,133,220,27,93,36,93,124,180,81,141,152,220,170,163,229,197,124,171,232,48,70,251,106,119,150,20,16,49,119,247,42,132,36,76,254,124,177,66,175,9,1,39,92,127,195,171,198,34,2,64,144,179,72,40,151,110,89,229,42,125,33,238,16,220,228,51,203,8,1,68,145,253,133,118,93,163,129,22,13,248,65,12,4,63,101,210,70,170,138,203,14,246,54,194,195,27,107,241,175,35,171,49,52,106,121,45,36,152,85,215,132,78,167,34,18,167,245,152,133,134,170,120,182,10,146,191,37,2,205,47,125,20,203,44,88,81,32,150,223,220,218,238,254,30,212,167,221,115,156,82,226,137,220,221,97,3,139,202,33,9,27,26,126,40,215,25,126,9,82,208,49,217,14,161,81,196,61,60,87,254,213,194,81,216,161,151,209,166,222,230,24,128,117,140,92,4,203,254,170,253,249,88,90,112,226,18,44,122,39,158,158,56,69,204,159,5,179,51,197,233,139,216,102,226,206,248,15,78,112,214,126,67,28,40,38,98,190,178,206,67,94,245,254,160,101,176,32,157,26,132,83,252,228,87,242,32,127,160,112,210,224,133,149,115,41,30,16,200,69,89,81,77,144,12,106,182,73,54,28,53,195,28,216,179,179,136,35,141,102,234,177,240,34,186,106,145,245,3,84,48,251,157,245,11,217,111,227,138,42,67,114,211,177,37,103,16,71,152,72,117,123,36,213,202,56,124,227,84,8,45,229,149,165,214,69,244,169,55,68,62,94,104,228,74,205,123,222,17,7,172,158,227,74,206,149,67,175,171,251,185,121,151,223,63,35,229,32,49,190,209,120,137,69,213,214,19,150,187,177,28,12,158,153,126,149,171,167,234,120,129,109,32,157,180,75,66,56,233,115,127,230,157,32,34,143,156,31,230,168,174,125,118,195,249,243,165,81,246,10,144,15,103,139,55,173,7,59,136,69,172,54,132,165,140,78,77,230,33,169,129,188,71,209,109,161,8,57,57,199,143,31,164,43,58,130,1,110,145,31,229,13,46,149,94,244,106,76,238,105,107,1,183,177,10,61,225,94,185,116,58,183,95,225,22,119,19,248,28,13,123,125,108,158,64,184,77,245,153,162,217,227,208,41,185,211,235,41,153,181,54,166,165,11,154,55,21,184,209,192,249,44,164,160,29,229,159,82,156,198,241,183,114,83,137,186,151,148,31,21,197,216,145,32,13,50,22,241,137,39,71,28,142,160,215,107,221,45,202,104,227,110,186,12,150,145,240,51,49,44,196,115,224,238,149,189,134,99,67,241,62,157,240,114,247,195,26,200,141,97,147,249,23,150,174,10,13,219,81,73,58,242,96,250,243,15,49,218,58,230,104,252,175,150,123,86,185,84,90,198,6,36,0,99,72,28,166,238,115,231,171,249,179,71,174,68,156,227,17,198,79,73,142,99,144,20,80,62,80,191,142,46,71,9,243,6,8,214,116,72,190,106,161,19,185,100,9,187,64,94,86,203,174,156,245,222,95,54,30,148,19,11,50,112,96,61,237,159,173,7,154,127,175,79,48,97,89,78,126,66,171,204,158,195,27,226,205,222,157,89,251,90,125,37,212,27,97,3,141,247,175,50,121,7,187,68,196,181,202,167,189,57,84,81,222,23,27,84,130,176,98,66,240,207,18,23,28,163,163,194,45,37,129,202,170,97,189,0,81,238,0,39,199,163,35,211,206,247,65,29,116,242,67,102,235,13,136,232,230,114,146,187,7,254,142,26,121,16,237,5,160,201,114,94,178,199,95,212,241,45,112,180,188,72,86,114,189,155,149,149,163,210,112,101,12,69,225,75,202,223,28,242,90,215,156,169,224,245,135,128,92,148,217,131,208,255,25,135,117,136,5,104,185,249,161,228,214,16,105,204,9,182,135,153,220,101,244,160,207,58,182,118,185,240,57,245,123,13,112,182,106,229,220,90,29,86,215,96,147,232,2,55,131,225,137,68,245,89,141,252,97,3,129,155,216,223,98,116,45,78,85,141,161,74,215,7,150,171,225,59,78,221,152,236,14,117,100,208,158,86,13,185,124,87,157,111,40,187,182,124,173,71,173,23,199,52,155,190,134,11,23,64,25,215,39,115,231,173,77,72,114,54,252,116,178,59,221,106,241,119,254,30,226,241,204,233,113,197,96,146,0,41,67,3,231,126,12,218,202,22,171,114,249,176,134,160,19,216,31,229,118,226,62,242,126,126,42,127,130,68,218,218,81,202,106,217,191,25,177,82,97,81,36,232,137,58,90,216,190,117,235,20,194,144,76,178,27,213,13,208,18,29,118,126,49,98,203,179,128,237,100,32,242,189,212,6,210,210,188,161,205,13,124,119,13,215,112,41,183,176,215,168,210,182,111,1,115,2,239,141,8,177,124,112,48,197,2,239,11,99,4,36,77,69,47,244,19,153,61,19,2,96,176,7,112,122,131,169,25,189,116,171,49,12,121,162,79,154,74,251,50,233,182,63,180,224,118,49,253,21,20,16,31,144,184,93,174,231,244,183,13,49,225,189,211,73,185,49,110,142,25,226,45,176,233,204,74,33,16,205,88,131,92,157,170,175,68,170,61,53,116,165,16,27,182,160,181,87,241,15,151,85,107,76,167,129,25,172,127,184,138,153,222,228,125,64,44,45,32,12,227,148,106,152,83,240,166,54,235,32,190,12,242,164,123,189,53,194,141,104,43,202,110,4,168,119,245,232,179,178,198,1,224,87,86,160,31,19,140,233,102,191,204,4,98,138,163,191,106,24,213,47,208,82,137,132,131,16,253,84,25,144,90,159,148,16,196,84,166,61,160,101,229,227,93,118,59,87,66,16,128,59,96,131,250,20,184,150,205,91,227,201,62,35,79,180,172,173,85,197,106,153,238,229,60,204,65,193,230,94,101,177,134,6,165,53,171,142,208,155,2,11,4,202,127,54,17,142,117,227,121,128,204,192,147,147,92,189,5,224,148,72,18,83,101,126,124,228,153,242,123,229,247,92,221,6,73,227,250,87,167,194,129,187,73,38,185,109,217,240,193,88,50,178,180,151,54,197,187,137,190,166,233,1,103,204,88,31,127,185,29,65,1,29,254,223,14,83,167,215,114,248,30,173,89,173,187,69,5,105,117,15,106,94,173,63,227,25,230,190,136,168,177,175,107,91,126,254,34,188,25,118,48,12,226,130,153,162,57,47,181,212,79,160,97,64,157,246,90,53,43,149,76,102,15,195,107,58,242,84,172,29,81,198,113,81,251,138,182,154,111,30,171,129,56,17,45,214,153,112,117,203,174,40,38,234,236,32,4,112,225,26,187,195,246,252,9,218,69,160,223,178,54,148,81,8,134,151,75,248,63,224,240,48,75,250,221,85,46,100,50,3,70,64,102,111,160,155,233,59,147,184,57,61,6,126,79,176,16,185,94,166,33,135,78,42,75,140,208,140,44,153,187,64,103,119,160,236,16,239,74,218,219,212,207,110,53,30,76,248,40,111,98,44,20,113,204,233,109,135,96,107,39,163,203,125,45,157,152,71,239,175,174,159,147,80,111,93,38,253,228,154,225,181,101,12,241,127,65,49,189,5,85,151,237,213,143,14,104,138,54,52,27,4,132,67,35,156,86,157,73,16,229,222,245,110,79,165,179,56,179,53,218,229,100,58,87,149,48,231,64,63,115,67,3,172,6,186,115,154,60,53,214,152,149,89,234,37,143,82,255,64,28,183,93,112,39,70,185,57,0,199,9,61,175,219,41,76,37,176,82,125,65,53,160,214,105,62,153,244,222,96,205,6,178,85,41,240,113,0,96,149,38,3,195,18,152,41,246,3,103,29,110,134,30,101,75,46,103,199,184,20,230,8,55,120,4,229,168,35,43,7,28,161,143,87,27,87,79,255,186,44,195,158,155,181,119,81,172,217,107,95,98,55,243,186,66,105,48,224,123,232,84,156,20,10,156,208,204,52,34,228,136,97,242,200,246,211,67,202,40,241,91,92,253,9,54,72,131,221,106,178,32,44,182,4,225,193,37,20,249,249,231,10,206,18,71,254,221,187,172,88,204,6,127,138,102,7,208,75,147,219,199,177,79,36,170,101,207,177,109,95,143,217,41,199,80,183,201,2,254,12,55,23,198,14,255,69,245,138,155,129,227,167,168,130,156,135,14,96,93,48,99,143,107,126,92,117,143,112,108,193,228,84,13,41,186,27,172,92,201,149,116,19,112,197,116,209,128,102,1,55,152,177,28,37,34,50,83,41,199,74,178,59,111,67,118,35,252,36,33,87,28,170,17,215,47,90,154,124,137,15,14,211,59,75,59,30,77,0,49,37,225,191,87,101,127,214,227,160,99,174,234,82,148,235,16,241,219,147,170,127,221,250,116,39,218,156,72,227,172,55,0,79,188,76,51,222,232,24,36,62,94,154,3,61,230,146,114,253,0,128,58,253,90,72,211,242,38,39,133,153,161,119,105,195,152,225,208,105,140,80,217,186,196,157,21,116,230,116,139,25,159,143,118,128,77,201,238,247,228,15,168,4,133,148,21,148,12,44,241,7,115,17,129,176,202,46,130,122,129,235,141,223,85,21,199,65,181,169,52,174,161,153,62,25,164,115,213,89,138,199,103,79,200,165,135,249,244,27,209,178,240,129,211,61,9,111,157,147,119,36,119,255,110,130,84,49,210,225,247,100,26,121,127,163,160,26,79,99,24,77,65,32,178,109,36,27,253,173,110,183,11,14,211,57,130,254,124,104,165,219,31,70,97,14,194,39,61,26,141,125,228,126,194,184,101,160,204,106,128,144,106,103,171,18,246,129,220,85,172,151,123,5,73,155,192,175,91,157,239,61,237,116,170,65,233,56,19,49,114,168,190,3,214,53,250,90,213,244,88,101,30,229,248,124,15,71,141,27,172,235,21,129,211,72,61,172,112,170,128,135,96,196,221,255,27,176,105,188,183,121,33,37,149,53,131,226,233,29,167,234,218,109,53,185,152,36,248,53,61,235,78,21,201,214,210,163,12,251,187,45,188,137,126,127,237,92,234,91,240,225,38,194,57,213,251,237,171,30,99,52,14,49,84,101,252,237,7,166,122,114,32,107,32,207,239,136,168,178,12,11,241,233,230,146,132,18,83,233,41,172,17,6,161,42,113,87,40,255,185,1,146,128,5,240,126,131,71,42,54,124,205,2,122,71,30,222,229,40,134,142,102,97,239,151,177,1,230,231,49,123,219,28,129,91,152,112,13,154,81,197,226,255,112,158,178,177,55,181,108,138,185,245,29,186,21,73,188,209,154,200,89,116,235,198,144,36,87,248,22,7,200,122,7,148,44,42,87,140,238,204,95,231,252,0,136,0,22,39,70,123,125,165,113,227,172,146,163,128,158,36,52,91,19,36,245,27,150,138,141,11,67,239,224,65,24,116,101,7,39,46,142,172,164,243,148,0,33,226,59,47,203,137,156,241,66,250,157,30,204,101,143,134,98,238,155,226,25,184,136,219,89,100,193,11,143,71,139,243,230,151,0,249,1,78,26,32,93,104,157,67,97,164,248,86,124,146,93,74,222,228,167,55,53,100,135,216,109,13,64,37,106,177,200,200,182,92,251,69,31,243,89,80,198,14,132,203,72,103,28,104,217,24,97,223,113,11,29,178,191,210,46,162,255,68,99,8,237,213,162,152,193,183,121,203,19,108,182,29,86,26,192,103,220,103,205,154,179,197,9,22,73,127,175,146,38,119,210,0,24,180,21,245,215,204,91,186,119,138,183,239,15,155,231,248,133,39,24,101,144,236,10,230,54,174,227,73,21,110,10,160,241,232,131,14,212,127,232,59,122,65,146,54,163,9,189,190,121,88,170,62,194,14,204,152,245,38,131,37,91,81,72,114,29,115,239,182,56,44,156,159,177,180,82,160,93,97,86,183,236,50,95,85,39,71,181,225,152,143,63,123,117,34,44,109,160,166,229,240,91,138,102,54,180,173,44,50,80,42,124,7,50,124,211,239,21,94,197,185,239,213,107,142,64,95,124,125,17,180,97,189,101,52,48,19,112,12,70,9,212,177,54,118,66,84,147,236,248,26,124,95,103,135,254,124,49,112,186,99,120,90,8,194,191,88,57,242,65,61,10,104,246,197,252,19,159,58,194,75,173,242,103,8,115,84,69,238,149,26,15,159,182,141,132,119,70,29,53,20,143,46,163,204,6,236,59,45,185,172,89,119,83,38,144,36,222,96,151,26,99,195,163,170,133,92,159,214,53,150,116,90,176,69,145,130,15,172,140,217,215,101,163,115,161,65,101,8,7,183,113,213,134,58,175,130,251,143,173,248,168,135,60,159,30,194,68,208,119,120,2,40,178,227,247,161,77,47,136,46,244,163,72,65,158,25,225,195,61,132,182,204,177,186,200,81,2,65,105,212,72,94,203,232,217,182,123,251,228,160,1,161,204,123,20,37,1,77,208,179,45,149,181,122,102,190,123,213,164,231,41,216,130,234,248,208,251,252,220,84,209,67,47,61,220,5,142,162,26,236,121,142,248,132,255,65,122,203,196,102,191,187,2,195,127,255,193,92,49,91,186,154,39,156,29,211,172,49,104,245,114,153,223,211,199,249,35,130,160,128,0,152,176,183,20,236,113,193,108,26,255,11,237,102,133,245,94,115,114,10,89,229,214,221,99,149,30,99,37,246,10,26,26,39,92,123,170,73,211,127,227,54,30,86,133,159,112,225,91,148,100,174,149,75,143,14,140,20,44,64,212,5,243,8,116,63,30,97,42,123,20,73,212,85,207,83,122,27,251,233,84,10,17,236,232,83,200,127,119,143,163,204,220,167,59,231,20,106,186,222,191,8,40,234,21,25,180,13,116,250,152,224,174,75,3,205,38,173,215,236,151,185,121,254,244,154,239,17,53,106,164,61,49,116,216,118,94,150,35,181,26,238,66,49,211,221,132,146,166,115,39,136,36,205,230,179,31,197,51,148,165,109,38,70,37,148,52,44,209,250,98,58,246,225,103,198,101,26,25,196,207,8,166,21,88,252,175,253,10,88,107,157,19,225,61,12,246,221,37,239,186,167,137,142,135,222,128,174,62,95,216,38,141,157,45,232,97,217,173,203,234,116,129,69,206,189,94,221,12,54,139,186,247,184,16,200,121,244,104,8,7,35,111,47,188,10,140,92,73,143,206,203,72,122,184,20,102,197,130,64,150,63,96,239,8,132,111,217,84,91,198,32,43,100,138,241,15,160,42,190,253,193,184,164,124,29,210,96,67,224,221,182,29,218,129,149,29,128,174,98,88,88,125,56,40,255,120,5,0,87,174,42,150,90,112,201,183,169,19,57,195,191,12,58,244,235,132,25,145,72,146,214,8,125,100,135,12,5,102,97,248,174,24,159,90,33,43,187,6,61,212,241,225,190,219,252,197,123,129,164,108,123,55,230,4,153,166,105,234,15,85,216,23,56,32,3,41,110,68,146,172,133,202,98,41,7,47,152,35,255,168,106,241,226,222,77,244,52,185,65,252,227,32,66,38,11,172,60,28,28,103,84,1,1,205,182,190,28,189,102,253,43,1,191,148,116,10,227,18,81,93,80,239,157,232,215,180,163,165,161,109,177,71,150,244,144,208,160,110,22,174,60,206,43,103,121,55,103,114,115,173,238,13,10,227,251,41,176,216,158,229,216,55,234,128,128,20,167,106,181,86,163,130,215,110,149,191,10,227,215,8,214,154,178,181,15,19,0,247,250,97,74,43,157,55,94,174,41,41,9,199,97,20,91,32,18,10,43,98,240,247,203,20,250,117,160,44,229,202,187,64,54,124,15,184,169,129,27,160,240,26,61,255,60,166,60,144,209,84,55,187,186,168,13,124,125,29,17,100,249,227,62,205,78,179,163,168,139,168,21,38,83,239,151,74,43,66,2,92,72,71,94,216,134,238,20,45,158,213,164,73,57,80,47,198,184,130,223,227,71,132,133,235,177,85,174,142,124,172,200,54,229,40,126,60,76,92,216,153,56,241,174,66,141,90,226,3,30,68,234,71,187,163,112,146,255,22,143,170,204,3,127,179,81,139,160,37,77,246,128,220,196,158,153,73,177,65,199,119,29,197,144,130,248,206,155,253,108,213,124,7,223,221,162,146,134,242,65,99,162,107,120,247,214,207,96,150,169,131,208,218,221,28,24,112,208,23,1,130,142,232,56,104,45,33,158,95,255,123,31,74,76,120,178,155,213,6,195,164,8,8,69,241,197,127,83,169,21,167,19,94,143,252,33,159,248,241,170,153,147,1,149,199,201,131,170,79,236,212,209,143,107,98,24,123,56,33,193,85,247,64,225,135,210,78,145,57,16,145,71,170,20,133,87,235,4,166,239,100,82,235,81,50,223,9,193,52,49,86,129,190,196,82,165,107,63,115,161,98,33,20,193,29,42,151,205,252,124,72,245,48,181,67,7,13,21,127,59,226,188,144,129,112,244,192,121,213,80,42,196,1,13,107,108,78,0,40,121,225,148,237,234,209,216,238,9,147,226,254,96,89,212,72,193,106,75,135,74,227,67,255,92,191,81,188,124,226,149,152,142,15,159,195,238,114,55,255,166,157,230,59,148,170,166,151,65,213,104,253,253,112,150,82,147,137,27,214,100,247,65,81,92,47,86,217,7,45,120,81,130,31,236,243,76,78,3,45,105,172,220,71,48,220,94,196,249,163,193,133,50,236,205,20,55,2,63,14,127,69,113,212,204,12,58,79,89,86,29,61,199,201,64,149,6,144,182,150,129,31,18,167,120,248,82,107,25,143,128,27,161,28,25,153,183,217,238,78,186,106,92,27,202,219,165,96,0,216,234,169,73,101,39,182,113,217,240,170,116,172,221,250,233,48,49,242,83,227,92,181,184,72,230,180,21,15,108,135,25,38,153,25,124,227,26,149,73,236,39,211,244,149,58,183,132,26,223,219,174,144,117,233,219,165,205,157,159,222,184,52,47,241,201,123,65,24,44,55,215,177,168,250,179,115,190,227,123,158,163,179,224,69,196,66,207,254,243,101,221,193,140,250,4,28,222,52,96,138,160,33,218,64,118,214,234,201,152,148,91,178,111,107,144,142,6,182,102,72,188,34,213,181,26,223,58,255,103,81,17,47,169,11,245,224,123,148,215,237,186,107,75,152,90,202,166,22,149,197,5,246,238,78,76,229,106,199,94,127,195,0,45,82,6,159,103,96,138,231,71,46,107,59,216,39,43,12,221,27,214,56,155,145,66,187,169,250,235,78,211,179,239,183,198,163,93,5,196,24,174,143,225,106,139,89,98,13,127,207,184,194,30,1,165,198,169,8,197,118,86,163,221,138,23,209,61,116,79,99,233,43,130,60,244,85,229,243,172,123,148,200,120,192,127,211,52,11,159,41,95,212,230,188,169,156,137,29,212,12,148,168,148,133,243,44,241,139,127,24,246,220,227,125,209,97,60,52,162,192,146,49,161,92,138,112,189,128,59,126,125,46,207,60,79,231,174,152,209,68,223,205,2,38,14,91,116,159,255,28,27,178,248,164,104,158,79,69,214,234,157,12,75,163,83,253,245,202,61,213,176,6,197,230,29,208,166,253,194,254,235,29,141,241,70,249,15,62,0,148,163,135,52,122,40,96,87,31,179,152,51,216,133,184,122,198,203,60,115,218,191,193,16,178,25,148,252,112,104,103,252,36,92,221,28,179,43,199,198,151,128,100,252,217,161,249,34,201,172,118,52,180,252,104,7,223,44,116,102,212,21,40,224,184,55,163,210,21,207,161,239,51,54,155,41,133,18,67,48,3,165,130,251,4,79,214,57,72,130,157,212,144];function C(e,t,n){var r=e.gl,i=5,o=.1,a=.5,s=175/180*3.141593,c=115/180*3.141593,u=173/180*3.141593,l=116/180*3.141593,d=2.04203545,h=0,f=0,p=0,A=[],g=[0,1,3,4,6,7,9,10,12,13,15,16,18,19,21,22,24,26,29,31,34,36,39,41,44,46,49,51,54,56,59,61,64,65,66,67,68,69,70,72,73,74,75,76,77,79,80,81,82,83,84,85,87,88,89,90,91,92,94,95,96,97,98,99,101,102,103,104,105,106,107,109,110,111,112,113,114,116,117,118,119,120,121,123,124,125,126,127,128,129,131,132,133,134,135,136,138,139,140,141,142,143,145,146,147,148,149,150,151,153,154,155,156,157,158,160,161,162,163,164,165,166,168,169,170,171,172,173,175,176,177,178,179,180,182,183,184,185,186,187,188,190,191,192,193,194,195,197,198,199,200,201,202,204,205,206,207,208,209,210,212,213,214,215,216,217,219,220,221,222,223,224,226,226,226,227,227,227,228,228,228,229,229,229,230,230,231,231,231,232,232,232,233,233,233,234,234,235,235,235,236,236,236,237,237,237,238,238,239,239,239,240,240,240,241,241,241,242,242,243,243,243,244,244,244,245,245,245,246,246,246,247,247,247,248,248,248,249,249,249,250,250,250,251,251,251,252,252,252,253,253,253,254,254,254,255],m=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,32,33,35,36,37,39,40,42,43,44,46,47,49,50,51,53,54,56,57,58,59,61,62,63,64,66,67,68,69,71,72,73,74,76,77,78,79,81,82,83,84,86,87,88,90,91,92,93,95,96,97,98,100,101,102,103,105,106,107,108,110,111,112,113,115,116,117,118,120,121,122,124,125,126,127,129,130,131,132,134,135,136,137,139,140,141,142,144,145,146,147,149,150,151,152,154,155,156,158,159,160,161,163,164,165,166,168,169,170,171,173,174,175,176,178,179,180,181,183,184,185,186,188,189,190,192,193,194,195,197,198,199,200,202,203,204,205,207,208,209,210,212,213,214,215,217,218,219,220,222,223,224,226,226,226,227,227,228,228,229,229,230,230,231,231,232,232,233,233,234,234,234,235,235,236,236,237,237,238,238,239,239,240,240,241,241,242,242,243,243,243,244,244,244,245,245,245,246,246,246,247,247,247,248,248,248,249,249,249,250,250,250,251,251,251,252,252,252,253,253,253,254,254,254,255],y=[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,35,36,37,38,39,40,41,43,44,45,46,47,48,50,51,52,53,54,55,56,58,59,60,61,62,63,65,66,67,68,69,70,72,73,74,76,77,78,80,81,83,84,85,87,88,89,91,92,94,95,96,98,99,100,102,103,105,106,107,109,110,111,113,114,116,117,118,120,121,122,124,125,127,128,129,131,132,133,135,136,138,139,140,142,143,144,146,147,149,150,151,153,154,155,157,158,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,192,193,193,194,195,195,196,197,197,198,199,199,200,201,201,202,203,203,204,205,205,206,207,207,208,209,209,210,211,211,212,213,213,214,215,215,216,217,217,218,219,219,220,221,221,222,223,223,224,225,225,226,227,227,228,229,229,230,231,231,232,233,233,234,235,235,236,237,237,238,239,239,240,241,241,242,243,243,244,245,245,246,247,247,248,249,249,250,251,251,252,253,253,254,255];this.program=v(r,R),this.setUniforms=function(){var t=r.getUniformLocation(this.program,"u_flipY"),n=r.getUniformLocation(this.program,"u_denoiseLevel");r.uniform1f(n,i),r.uniform1f(t,1);var g=r.getUniformLocation(this.program,"light");r.uniform1f(g,o);var v=r.getUniformLocation(this.program,"redness");r.uniform1f(v,a);var m=r.getUniformLocation(this.program,"skin_he_max"),y=r.getUniformLocation(this.program,"skin_he_min"),b=r.getUniformLocation(this.program,"skin_hc_max"),E=r.getUniformLocation(this.program,"skin_hc_min"),_=r.getUniformLocation(this.program,"skin_hc_axis"),w=r.getUniformLocation(this.program,"facts_rotate_c"),S=r.getUniformLocation(this.program,"facts_rotate_le"),T=r.getUniformLocation(this.program,"facts_rotate_ge");r.uniform1f(m,s),r.uniform1f(y,c),r.uniform1f(b,u),r.uniform1f(E,l),r.uniform1f(_,d),r.uniform1f(w,h),r.uniform1f(S,f),r.uniform1f(T,p);var R=r.getUniformLocation(this.program,"u_originImage");r.activeTexture(r.TEXTURE2),r.bindTexture(r.TEXTURE_2D,e.inputTexture),r.uniform1i(R,2);for(var C=["lighten_lut"],I=[r.TEXTURE3],x=0;x<C.length;x++){var O=r.getUniformLocation(this.program,C[x]);r.activeTexture(I[x]),r.bindTexture(r.TEXTURE_2D,A[x]),r.uniform1i(O,x+3)}},this.setParameters=function(e){void 0!==e.denoiseLevel&&(i=e.denoiseLevel),void 0!==e.lightLevel&&(o=e.lightLevel),void 0!==e.rednessLevel&&(a=e.rednessLevel,this._updateRedness(a)),void 0!==e.lighteningContrastLevel&&this._updateLut(e.lighteningContrastLevel)},this._updateRedness=function(e){var t,n,r=3.141593,i=e,o=i;i>1&&(i=1),i<0&&(i=0),o>1&&(o=1),o<0&&(o=0),h=.8*i,o<.8&&(o=0),(d=(117-4*o)/180*r)<(l=(116-4*o)/180*r)&&(d=l),l<r/2&&(l=r/2),d<r/2&&(d=r/2),(c=(115-4*o)/180*r)<r/2&&(c=r/2),(u=173/180*r)>r&&(u=r),d>r&&(d=r),(s=175/180*r)>r&&(s=r),n=u-d,p=(t=s-u)>.01?h*n/t:h,n=d-l,f=(t=l-c)>.01?h*n/t:h},this._updateLut=function(e){var t=null;0==e&&(t=m),1==e&&(t=y),2==e&&(t=g);for(var n=[new Uint8Array(t)],i=[256],o=[1],a=0;a<n.length;a++)r.bindTexture(r.TEXTURE_2D,A[a]),r.texImage2D(r.TEXTURE_2D,0,r.LUMINANCE,i[a],o[a],0,r.LUMINANCE,r.UNSIGNED_BYTE,n[a])},this._init=function(){for(var e=[new Uint8Array(m)],t=[256],n=[1],i=0;i<e.length;i++){var o=r.createTexture();r.bindTexture(r.TEXTURE_2D,o),r.texImage2D(r.TEXTURE_2D,0,r.LUMINANCE,t[i],n[i],0,r.LUMINANCE,r.UNSIGNED_BYTE,e[i]),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.LINEAR),A.push(o)}},this._init()}var I=!1;function x(){this.programs=[];var e=this,t=null,n=null;e.gl=null,e.inputTexture=null;var r=[],i=[],o=0,a=0;e._initGl=function(n,s){e.inputTexture=t.createTexture(),t.bindTexture(t.TEXTURE_2D,e.inputTexture),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR);for(var c=0;c<4;c++){var u=t.createTexture();t.bindTexture(t.TEXTURE_2D,u),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),c<2?t.texImage2D(t.TEXTURE_2D,0,t.RGBA,n,s,0,t.RGBA,t.UNSIGNED_BYTE,null):t.texImage2D(t.TEXTURE_2D,0,t.RGBA,s,n,0,t.RGBA,t.UNSIGNED_BYTE,null);var l=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,l),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,u,0),r.push(u),i.push(l)}t.viewport(0,0,n,s),o=n,a=s},e.render=function(s){if(t){var c=0;a==s.videoWidth&&o===s.videoHeight&&(c=2),t.viewport(0,0,s.videoWidth,s.videoHeight),t.bindTexture(t.TEXTURE_2D,e.inputTexture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,s);for(var u=I?e.programs.length-1:0,l=0;l<=u;l++){var d=e.programs[l].program;t.useProgram(d);var h=t.getUniformLocation(d,"u_image");e.programs[l].setUniforms(),t.bindFramebuffer(t.FRAMEBUFFER,i[c+l%2]),t.clearColor(0,0,0,1),t.clear(t.COLOR_BUFFER_BIT),t.drawArrays(t.TRIANGLES,0,6),t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,r[c+l%2]),t.uniform1i(h,0)}t.useProgram(n);var f=t.getUniformLocation(n,"u_flipY");t.uniform1f(f,-1),t.bindFramebuffer(t.FRAMEBUFFER,null),t.clearColor(0,0,0,1),t.clear(t.COLOR_BUFFER_BIT),t.drawArrays(t.TRIANGLES,0,6)}},e.setEnableBeauty=function(e){I=e},e.init=function(r,i,o){if("undefined"==typeof WebGLRenderingContext)throw new Error("NOT_SUPPORT");t=o.getContext("webgl"),e.gl=t,e._initGl(r,i),e.programs.push(new y(this,r,i)),e.programs.push(new E(this,r,i)),e.programs.push(new w(this,r,i)),e.programs.push(new T(this,r,i)),e.programs.push(new C(this,r,i)),n=e.programs[0].program},e.release=function(){e.gl=null,t=null,n=null,e.inputTexture=null,e.programs=[],r=[],i=[]},e.setDenoiseLevel=function(t){e.programs.forEach((function(e){e.setParameters&&e.setParameters({denoiseLevel:t})}))},e.setLightLevel=function(t){e.programs.forEach((function(e){e.setParameters&&e.setParameters({lightLevel:t})}))},e.setRednessLevel=function(t){e.programs.forEach((function(e){e.setParameters&&e.setParameters({rednessLevel:t})}))},e.setContrastLevel=function(t){e.programs.forEach((function(e){e.setParameters&&e.setParameters({lighteningContrastLevel:t})}))},e.setSize=function(t,n){e.programs.forEach((function(e){e.setSize&&e.setSize(t,n)}))}}x._instance=null,x.getInstance=function(){return x._instance||(x._instance=new x),x._instance},t.a={addVideoEffectCapability:function(e){e.videoEffect={canvas:null,video:null,fps:30,stopChromeBackgroundLoop:null,enableBeauty:!1,denoiseLevel:5,lightLevel:.35,rednessLevel:.5,lighteningContrastLevel:1,videoContextInited:!1,originVideoTrack:null,canvasVideoTrack:null,ctx:null},e._initVideoContext=function(){if(e.videoEffect.videoContextInited)throw new Error("Failed to init video context. Already inited");if(!e.stream)throw new Error("Failed to init video context. Local Stream not initialized");e.videoEffect.originVideoTrack=e.stream.getVideoTracks()[0],e.attributes&&e.attributes.maxFrameRate&&(e.videoEffect.fps=e.attributes.maxFrameRate),e.videoEffect.videoContextInited=!0},e._renderWithWebGL=function(t){return new Promise((function(n){e.videoEffect.canvas||(e.videoEffect.canvas=document.createElement("canvas")),e.videoEffect.video||(e.videoEffect.video=document.createElement("video")),e.videoEffect.video.setAttribute("autoplay",""),e.videoEffect.video.setAttribute("muted",""),e.videoEffect.video.muted=!0,e.videoEffect.video.setAttribute("playsinline",""),e.videoEffect.video.setAttribute("style","display:none"),e.videoEffect.video.srcObject=t;var r=t.getVideoTracks()[0].getSettings(),i=r.width,o=r.height;console.log("Width: ".concat(i,", Height: ").concat(o)),e.videoEffect.canvas.setAttribute("width",i),e.videoEffect.canvas.setAttribute("height",o),e.videoEffect.video.setAttribute("width",i),e.videoEffect.video.setAttribute("height",o);var a=x.getInstance();a.init(e.videoEffect.video.width,e.videoEffect.video.height,e.videoEffect.canvas),a.setDenoiseLevel(e.videoEffect.denoiseLevel),a.setLightLevel(e.videoEffect.lightLevel),a.setRednessLevel(e.videoEffect.rednessLevel),a.setContrastLevel(e.videoEffect.lighteningContrastLevel),e.videoEffect.video.addEventListener("playing",(function t(){var r=e.videoEffect.canvas.captureStream(e.videoEffect.fps);e.videoEffect.video.removeEventListener("playing",t,!0),n([r.getVideoTracks()[0],e.videoEffect.video])}),!0),e.videoEffect.video.play()}))},e._disableEffect=function(){e.videoEffect.videoContextInited||e._initVideoContext();var t=e.videoEffect.originVideoTrack;if(!t)return h.default.warning("Video track is null, fail to disable video effect!"),Promise.resolve();if(e.pc&&e.pc.peerConnection&&e.pc.peerConnection){var n=(e.pc.peerConnection&&e.pc.peerConnection.getSenders()).find((function(e){return e&&e.track&&"video"==e.track.kind}));if(n&&n.replaceTrack&&t)return n.replaceTrack(t)}return Promise.resolve()},e._releaseEffect=function(){var t;return t=e.videoEffect.enableBeauty?e._disableEffect():Promise.resolve(),x.getInstance().release(),e.videoEffect.videoContextInited=!1,e.videoEffect.canvasVideoTrack=null,t},e._enableEffect=function(){return e.videoEffect.videoContextInited||e._initVideoContext(),e.videoEffect.originVideoTrack?e.videoEffect.canvasVideoTrack?(e._showEffectInLocalPlayer(),e._replaceWithCanvasTrack()):e._renderWithWebGL(e.stream).then((function(t){var n=c()(t,2),r=n[0],i=n[1];e.videoEffect.canvasVideoTrack=r;var o=x.getInstance();return requestAnimationFrame((function t(){e.videoEffect.enableBeauty&&o.render(i),e.videoEffect.videoContextInited&&requestAnimationFrame(t)})),u.isChrome()&&document.addEventListener("visibilitychange",(function(){document.hidden,document.hidden?e.videoEffect.stopChromeBackgroundLoop=function(e,t){var n=1/t,r=new AudioContext,i=r.createGain();i.gain.value=0,i.connect(r.destination),function t(){var a=r.createOscillator();a.onended=t,a.connect(i),a.start(0),a.stop(r.currentTime+n),e(r.currentTime),o&&(a.onended=function(){r.close()})}();var o=!1;return function(){o=!0}}((function(){e.videoEffect.enableBeauty&&o.render(i)}),e.videoEffect.fps):e.videoEffect.stopChromeBackgroundLoop&&(e.videoEffect.stopChromeBackgroundLoop(),e.videoEffect.stopChromeBackgroundLoop=null)}),!1),e._showEffectInLocalPlayer(),e._replaceWithCanvasTrack()})):(h.default.warning("Video track is null, fail to enable video effect!"),Promise.resolve())},e._showEffectInLocalPlayer=function(){if(e.player){var t=e.player.div.children[0];if("none"!==t.style.display&&(e.player.div.appendChild(e.videoEffect.canvas),"video"===t.tagName.toLowerCase())){var n=t.getAttribute("style");e.videoEffect.canvas.setAttribute("style",n),"none"!==t.style.display&&(t.style.display="none")}}},e._removeEffectFromLocalPlayer=function(){if(e.player&&e.player.div&&e.videoEffect.enableBeauty&&e.videoEffect.canvas){e.player.div.removeChild(e.videoEffect.canvas);var t=e.player.div.children[0];"video"===t.tagName.toLowerCase()&&(e.videoEffect.canvas.style.display="none",t.style.display="block")}},e._replaceWithCanvasTrack=function(){var t=null;return e.pc&&e.pc.peerConnection&&e.pc.peerConnection&&(t=(e.pc.peerConnection&&e.pc.peerConnection.getSenders()).find((function(e){return e&&e.track&&"video"==e.track.kind}))),t&&t.replaceTrack&&e.videoEffect.canvasVideoTrack?t.replaceTrack(e.videoEffect.canvasVideoTrack):Promise.resolve()},e.setBeautyEffectOptions=function(){var t=a()(i.a.mark((function t(n,r){var o,a=arguments;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(Object(d.checkValidBoolean)(n,"enabled"),o=x.getInstance(),e.videoEffect.enableBeauty==n){t.next=14;break}if(o.setEnableBeauty(n),!n){t.next=9;break}return t.next=7,e._enableEffect();case 7:t.next=12;break;case 9:return e._removeEffectFromLocalPlayer(),t.next=12,e._releaseEffect();case 12:e.videoEffect.enableBeauty=n,l.report.reportApiInvoke(e.sid,{callback:null,options:a,name:"Stream.setBeautyEffectOptions",tag:"tracer"});case 14:if(n){t.next=16;break}return t.abrupt("return");case 16:if(!r){t.next=20;break}Object(d.checkValidObject)(r,"options"),t.next=21;break;case 20:return t.abrupt("return");case 21:if(void 0!==r.smoothnessLevel&&(Object(d.checkValidFloatNumber)(r.smoothnessLevel,"smoothnessLevel",0,1),e.videoEffect.denoiseLevel=10*r.smoothnessLevel,e.videoEffect.denoiseLevel<.1&&(e.videoEffect.denoiseLevel=.1),o.setDenoiseLevel(e.videoEffect.denoiseLevel)),void 0!==r.lighteningLevel&&(Object(d.checkValidFloatNumber)(r.lighteningLevel,"lighteningLevel",0,1),e.videoEffect.lightLevel=r.lighteningLevel/2,e.videoEffect.lightLevel<.01&&(e.videoEffect.lightLevel=.01),o.setLightLevel(e.videoEffect.lightLevel)),void 0!==r.rednessLevel&&(Object(d.checkValidFloatNumber)(r.rednessLevel,"rednessLevel",0,1),e.videoEffect.rednessLevel=r.rednessLevel,e.videoEffect.rednessLevel<.01&&(e.videoEffect.rednessLevel=.01),o.setRednessLevel(e.videoEffect.rednessLevel)),void 0===r.lighteningContrastLevel){t.next=29;break}if(0===r.lighteningContrastLevel||1===r.lighteningContrastLevel||2===r.lighteningContrastLevel){t.next=27;break}throw new Error("Invalid lighteningContrastLevel: The value should be 0, 1 or 2.");case 27:e.videoEffect.lighteningContrastLevel=parseFloat(r.lighteningContrastLevel),o.setContrastLevel(e.videoEffect.lighteningContrastLevel);case 29:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()},restoreVideoEffect:function(e){return e.videoEffect.enableBeauty?e._enableEffect():Promise.resolve()},disableVideoEffect:function(e){return e._releaseEffect?e._releaseEffect():Promise.resolve()},applyEffectInPlayer:function(e){e.videoEffect.enableBeauty&&e.videoEffect.canvas&&e._showEffectInLocalPlayer()},removeEffectFromLocalPlayer:function(e){e._removeEffectFromLocalPlayer()},replaceWithCanvasTrack:function(e){return e.videoEffect.enableBeauty?e._replaceWithCanvasTrack():Promise.resolve()},checkVideoEffectEnabled:function(e){return!!(e.videoEffect.enableBeauty&&e.videoEffect&&e.videoEffect.videoContextInited)&&(h.default.error("Operation not permitted: ".concat("VIDEO_EFFECT_ENABLED")),"VIDEO_EFFECT_ENABLED")}}},function(e,t){function n(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,i)}e.exports=function(e){return function(){var t=this,r=arguments;return new Promise((function(i,o){var a=e.apply(t,r);function s(e){n(a,i,o,s,c,"next",e)}function c(e){n(a,i,o,s,c,"throw",e)}s(void 0)}))}}},function(e,t,n){"use strict";var r=n(35),i=Object.prototype.toString;function o(e){return"[object Array]"===i.call(e)}function a(e){return void 0===e}function s(e){return null!==e&&"object"==typeof e}function c(e){return"[object Function]"===i.call(e)}function u(e,t){if(null!=e)if("object"!=typeof e&&(e=[e]),o(e))for(var n=0,r=e.length;n<r;n++)t.call(null,e[n],n,e);else for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.call(null,e[i],i,e)}e.exports={isArray:o,isArrayBuffer:function(e){return"[object ArrayBuffer]"===i.call(e)},isBuffer:function(e){return null!==e&&!a(e)&&null!==e.constructor&&!a(e.constructor)&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)},isFormData:function(e){return"undefined"!=typeof FormData&&e instanceof FormData},isArrayBufferView:function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&e.buffer instanceof ArrayBuffer},isString:function(e){return"string"==typeof e},isNumber:function(e){return"number"==typeof e},isObject:s,isUndefined:a,isDate:function(e){return"[object Date]"===i.call(e)},isFile:function(e){return"[object File]"===i.call(e)},isBlob:function(e){return"[object Blob]"===i.call(e)},isFunction:c,isStream:function(e){return s(e)&&c(e.pipe)},isURLSearchParams:function(e){return"undefined"!=typeof URLSearchParams&&e instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&"undefined"!=typeof window&&"undefined"!=typeof document},forEach:u,merge:function e(){var t={};function n(n,r){"object"==typeof t[r]&&"object"==typeof n?t[r]=e(t[r],n):t[r]=n}for(var r=0,i=arguments.length;r<i;r++)u(arguments[r],n);return t},deepMerge:function e(){var t={};function n(n,r){"object"==typeof t[r]&&"object"==typeof n?t[r]=e(t[r],n):t[r]="object"==typeof n?e({},n):n}for(var r=0,i=arguments.length;r<i;r++)u(arguments[r],n);return t},extend:function(e,t,n){return u(t,(function(t,i){e[i]=n&&"function"==typeof t?r(t,n):t})),e},trim:function(e){return e.replace(/^\s*/,"").replace(/\s*$/,"")}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(7),i=n.n(r),o=n(8),a=n(0),s=n(5);function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var u=new function(){var e=Object(o.b)();return e.devicesHistory={},e.states={UNINIT:"UNINIT",INITING:"INITING",INITED:"INITED"},e.state=e.states.UNINIT,e.deviceStates={ACTIVE:"ACTIVE",INACTIVE:"INACTIVE"},e.deviceReloadTimer=null,e._init=function(t,n){e.state=e.states.INITING,e.devicesHistory={},e._reloadDevicesInfo((function(){e.state=e.states.INITED,e.dispatchEvent({type:"inited"}),t&&t()}),(function(t){a.default.warning("Device Detection functionality cannot start properly."),e.state=e.states.UNINIT,n&&n(t)}))},e._enumerateDevices=function(e,t){if(!navigator.mediaDevices||!navigator.mediaDevices.enumerateDevices)return a.default.warning("enumerateDevices() not supported."),t&&t("enumerateDevices() not supported");navigator.mediaDevices.enumerateDevices().then((function(t){e&&setTimeout((function(){e(t)}),0)})).catch((function(e){t&&t(e)}))},e._reloadDevicesInfo=function(t,n){var r=[];e._enumerateDevices((function(n){var o=Date.now();for(var s in n.forEach((function(t){var n=e.devicesHistory[t.deviceId];if((n?n.state:e.deviceStates.INACTIVE)!=e.deviceStates.ACTIVE){var i=n||{initAt:o};i.device=t,i.state=e.deviceStates.ACTIVE,r.push(i),e.devicesHistory[t.deviceId]=i}e.devicesHistory[t.deviceId].lastReloadAt=o})),e.devicesHistory){var c=e.devicesHistory[s];c&&c.state==e.deviceStates.ACTIVE&&c.lastReloadAt!==o&&(c.state=e.deviceStates.INACTIVE,r.push(c)),c.lastReloadAt=o}e.state==e.states.INITED&&r.forEach((function(t){var n=i()({},t);switch(t.device.kind){case"audioinput":n.type="recordingDeviceChanged";break;case"audiooutput":n.type="playoutDeviceChanged";break;case"videoinput":n.type="cameraChanged";break;default:a.default.warning("Unknown device change",n),n.type="unknownDeviceChanged"}e.dispatchEvent(n)})),t&&t()}),n)},e.getDeviceById=function(t,n,r){e.getDevices((function(e){for(var i=0;i<e.length;i++){var o=e[i];if(o&&o.deviceId===t)return n&&n(o)}return r&&r()}))},e.searchDeviceNameById=function(t){var n=e.devicesHistory[t];return n?n.device.label||n.device.deviceId:null},e.getDevices=function(t,n){e._enumerateDevices(t,(function(e){n&&n(e.name+": "+e.message)}))},e.getVideoCameraIdByLabel=function(t,n,r){e.getCameras((function(e){var i,o=function(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=function(e,t){if(e){if("string"==typeof e)return c(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?c(e,t):void 0}}(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i,o=!0,a=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return o=e.done,e},e:function(e){a=!0,i=e},f:function(){try{o||null==r.return||r.return()}finally{if(a)throw i}}}}(e);try{for(o.s();!(i=o.n()).done;){var a=i.value;if(a.label===t)return n&&n(a.deviceId)}}catch(e){o.e(e)}finally{o.f()}return r&&r(s.default.NOT_FIND_DEVICE_BY_LABEL)}),r)},e.getRecordingDevices=function(t,n){return e._enumerateDevices((function(e){var n=e.filter((function(e){return"audioinput"==e.kind}));t&&t(n)}),(function(e){n&&n(e)}))},e.getPlayoutDevices=function(t,n){return e._enumerateDevices((function(e){var n=e.filter((function(e){return"audiooutput"==e.kind}));t&&t(n)}),(function(e){n&&n(e)}))},e.getCameras=function(t,n){return e._enumerateDevices((function(e){var n=e.filter((function(e){return"videoinput"==e.kind}));t&&t(n)}),(function(e){n&&n(e)}))},e._init((function(){navigator.mediaDevices&&navigator.mediaDevices.addEventListener&&navigator.mediaDevices.addEventListener("devicechange",(function(){e._reloadDevicesInfo()})),e.deviceReloadTimer=setInterval(e._reloadDevicesInfo,5e3)})),e}},function(e,t,n){"use strict";n.r(t),n.d(t,"_getReconnectCSTimer",(function(){return w})),n.d(t,"_setClientConnectionStateRecord",(function(){return S})),n.d(t,"getGatewayList",(function(){return R})),n.d(t,"getUserAccount",(function(){return I}));var r=n(11),i=n.n(r),o=n(13),a=n.n(o),s=n(17),c=n.n(s),u=n(3),l=(n(4),n(0)),d=n(14),h=n(1),f=n(5),p=function(e,t){var n=!1,r=0,i={command:"convergeAllocateEdge",sid:e.sid,appId:e.appId,token:e.token,uid:e.uid,cname:e.cname,ts:Math.floor(Date.now()/1e3),version:u.VERSION,seq:0,requestId:1};Object(u.getParameter)("PROXY_CS").map((function(o){var a=(new Date).getTime();A("https://"+o+"/api/v1",i,(function(i,s){if(i)return l.default.debug("["+e.clientId+"] Request proxy server failed: ",i),r++,h.report.requestProxyAppCenter(e.sid,{lts:a,succ:!1,APAddr:o,workerManagerList:null,ec:JSON.stringify(i),response:JSON.stringify({err:i,res:s})}),void(r>=Object(u.getParameter)("PROXY_CS").length&&t&&t("Get proxy server failed: request all failed"));if(!n)if((s=JSON.parse(s)).json_body){var c=JSON.parse(s.json_body);if(l.default.debug("["+e.clientId+"] App return:",c.servers),200!==c.code)i="Get proxy server failed: response code ["+c.code+"], reason [ "+c.reason+"]",r++,l.default.debug("["+e.clientId+"] "+i),h.report.requestProxyAppCenter(e.sid,{lts:a,succ:!1,APAddr:o,workerManagerList:null,ec:i,response:JSON.stringify({err:i,res:s})}),r>=Object(u.getParameter)("PROXY_CS").length&&t&&t(i);else{n=!0;var d=v(c.servers);h.report.requestProxyAppCenter(e.sid,{lts:a,succ:!0,APAddr:o,workerManagerList:JSON.stringify(d),ec:null,response:JSON.stringify({res:s})}),t&&t(null,d)}}else l.default.debug("["+e.clientId+"] Get proxy server failed: no json_body"),h.report.requestProxyAppCenter(e.sid,{lts:a,succ:!1,APAddr:o,workerManagerList:null,ec:"Get proxy server failed: no json_body",response:JSON.stringify({res:s})})}))}))},A=function(e,t,n){var r={service_name:"webrtc_proxy",json_body:JSON.stringify(t)};Object(d.post)(e,r,(function(e){n&&n(null,e)}),(function(e){n&&n(e)}),{"X-Packet-Service-Type":0,"X-Packet-URI":61})},g=function(e,t,n){var r=!1,i=0,o={command:"request",gatewayType:"http",appId:e.appId,cname:e.cname,uid:e.uid+"",sdkVersion:"2.3.1",sid:e.sid,seq:1,ts:+new Date,requestId:3,clientRequest:{appId:e.appId,cname:e.cname,uid:e.uid+"",sid:e.sid}};t.map((function(a){var s=(new Date).getTime();!function(e,t,n){Object(d.post)(e,t,(function(e){n&&n(null,e)}),(function(e){n&&n(e)}))}("https://"+a+":4000/v2/machine",o,(function(o,c){if(o)return l.default.debug("["+e.clientId+"] Request worker manager failed: ",o),i++,h.report.requestProxyWorkerManager(e.sid,{lts:s,succ:!1,workerManagerAddr:a,ec:JSON.stringify(o),response:JSON.stringify({res:c})}),void(i>=t.length&&n&&n("requeet worker manager server failed: request failed"));if(!r){if(!(c=JSON.parse(c)).serverResponse)return n&&n("requeet worker manager server failed: serverResponse is undefined");r=!0,h.report.requestProxyWorkerManager(e.sid,{lts:s,succ:!0,workerManagerAddr:a,ec:JSON.stringify(o),response:JSON.stringify({res:c})}),n&&n(null,{address:a,serverResponse:c.serverResponse})}}))}))},v=function(e){if(!e||[]instanceof Array==0)return[];var t=[];return e.forEach((function(e){var n;e.address&&e.tcp?(e.address.match(/^[\.\:\d]+$/)?n="".concat(e.address.replace(/[^\d]/g,"-"),".edge.agora.io"):(l.default.info("["+joinInfo.clientId+"] "+"Cannot recognized as IP address ".concat(e.address,". Used As Host instead")),n="".concat(e.address,":").concat(e.tcp)),t.push(n)):l.default.error("["+joinInfo.clientId+"] Invalid address format ",e)})),t},m=n(21),y=function(e,t,n,r){var i,o=Object(u.getParameter)("PROXY_CS"),a=0,s=!0;o.map((function(c){var p=Date.now();!function(e,t,n,r){var i=Object(u.getParameter)("AREA_SETTING").reduce((function(e,t,n){var r=Object(m.getAreaCodeByArea)(t);return r?0===n?r:"".concat(e,",").concat(r):e}),""),o={opid:133,flag:1048576,ts:+new Date,key:t.token,cname:t.cname,sid:t.sid,detail:{11:i,6:t.stringUid},uid:t.uid||0};e="https://".concat(e,"/api/v1"),Object(d.post)(e,o,(function(i){try{var o=JSON.parse(i);o.res&&(o=o.res);var a=o.code}catch(e){return l.default.error("[".concat(t.clientId,"] requestProxyServer failed with unexpected body ")),n("UNEXPECTED_ERROR")}var s;if(a)return s=new RegExp(/10102\d{2}$/).test(a)?"NO_SERVICE_AVAILABLE":f.APErrorCode[o.code]||a,l.default.error("[".concat(t.clientId,"] requestProxyServer failed: ").concat(s)),n(s);(!o.addresses||!o.addresses instanceof Array)&&n("UNEXPECTED_ERROR");var c=Object(u.getParameter)("GATEWAY_DOMAINS"),d=0;if(e.indexOf(c[1])>-1&&(d=1),0===o.addresses.length)return n("EMPTY_PROXY_LIST");var h=o.addresses.map((function(e){if(e.ip)return e.ip=r?"".concat(e.ip.replace(/[^\d]/g,"-"),".").concat(c[d++%c.length]):"".concat(e.ip),e}));return n(null,h)}),(function(e,t){"timeout"===e.type?n("REQUEST_PROXY_SERVER_TIME_OUT"):n("REQUEST_PROXY_SERVER_FAILED")}),{"X-Packet-Service-Type":0,"X-Packet-URI":69})}(c,t,(function(r,u){var d=Date.now();try{h.report.joinWebProxyAP({lts:d,sid:t.sid,cname:t.cname,cid:t.cid,uid:t.uid,sucess:r?-1:1,elapse:d-p,eventType:e,apServerAddr:c,turnServerAddrList:JSON.stringify(u),errorCode:r||"0"})}catch(e){}r?(a++,l.default.error("[".concat(t.clientId,"] request ").concat(c," failed: ").concat(r)),r&&-1===f.JOIN_PROXY_RETRY_LIST.indexOf(r)&&(i=r),a===o.length&&(i||(i="RETRYABLE_ERROR"),n(i))):s&&(s=!1,n(null,u))}),r)}))},b=n(12),E={},_={},w=function(e){return E[e]},S=function(e,t){_[e]=t},T=function(e,t,n,r,i){var o=(new Date).getTime(),a=t,s="";t.multiIP&&t.multiIP.gateway_ip&&(s={vocs_ip:[t.multiIP.uni_lbs_ip],vos_ip:[t.multiIP.gateway_ip]});var c=Object(u.getParameter)("AREA_SETTING").reduce((function(e,t,n){var r=Object(m.getAreaCodeByArea)(t);return r?0===n?r:"".concat(e,",").concat(r):e}),""),p={opid:133,flag:4096,ts:+new Date,key:t.token,cname:t.cname,sid:t.sid,detail:{6:t.stringUid,11:c},uid:t.uid||0};s&&(p.detail[5]=JSON.stringify(s)),Object(d.post)(e+"".concat(-1===e.indexOf("?")?"?":"&","action=wrtc_gateway"),p,(function(i){try{var s=JSON.parse(i);s.res&&(s=s.res);var c=s.code}catch(e){var d="requestChooseServer failed with unexpected body "+i;return l.default.error("["+a.clientId+"]",d),r(d)}if(c)return v=new RegExp(/10102\d{2}$/).test(c)?"NO_SERVICE_AVAILABLE":f.APErrorCode[s.code]||c,h.report.joinChooseServer(t.sid,{lts:o,succ:!1,csAddr:e,serverList:null,ec:v}),r("Get server node failed ["+v+"]",e,v);var p=[],A=Object(u.getParameter)("GATEWAY_DOMAINS"),g=0;if(e.indexOf(A[1])>-1&&(g=1),s.addresses.forEach((function(e){var t;e.ip&&e.port?(e.ip.match(/^[\.\:\d]+$/)?t="".concat(e.ip.replace(/[^\d]/g,"-"),".").concat(A[g++%A.length],":").concat(e.port):(l.default.info("["+a.clientId+"] "+"Cannot recognized as IP address ".concat(e.ip,". Used As Host instead")),t="".concat(e.ip,":").concat(e.port)),p.push(t)):l.default.error("["+a.clientId+"] Invalid address format ",e)})),!p.length){l.default.error("["+a.clientId+"] Empty Address response",s);var v="EMPTY_ADDRESS_RESPONSE";return h.report.joinChooseServer(t.sid,{lts:o,succ:!1,csAddr:e,serverList:null,ec:v}),r("Get server node failed ["+v+"]",e,v)}var m={gateway_addr:p,uid:s.uid,cid:s.cid,vid:s.detail&&s.detail[8],res:s,uni_lbs_ip:s.detail};return n(m,e)}),(function(e,n){"timeout"===e.type?(h.report.joinChooseServer(t.sid,{lts:o,succ:!1,csAddr:n,serverList:null,ec:"timeout"}),r("Connect choose server timeout",n)):(h.report.joinChooseServer(t.sid,{lts:o,succ:!1,csAddr:n,serverList:null,ec:"server_wrong"}),r("Connect choose server error",n))}),{"X-Packet-Service-Type":0,"X-Packet-URI":69})},R=function(e,t,n){var r=!1,i=null,o=1,a=1,s=e.clientId,c=function t(a,c){if(!r){var d=[];!function(e,t,n){for(var r,i=(new Date).getTime(),o=!1,a=0,s=Object(u.getParameter)("WEBCS_DOMAIN"),c=Object(u.getParameter)("WEBCS_DOMAIN_BACKUP_LIST"),d=function(n,r){var a;try{a=n.res.detail[8]}catch(t){l.default.debug("["+e.clientId+"] get vid failed",t)}if(o)h.report.joinChooseServer(e.sid,{lts:i,succ:!0,csAddr:r,serverList:n.gateway_addr,cid:n.cid+"",uid:n.uid+"",ec:null,vid:a},!1);else{if(clearTimeout(b),o=!0,e.proxyServer)for(var s=n.gateway_addr,c=0;c<s.length;c++){var u=s[c].split(":");n.gateway_addr[c]=e.proxyServer+"/ws/?h="+u[0]+"&p="+u[1]}t(n),h.report.joinChooseServer(e.sid,{lts:i,succ:!0,csAddr:r,serverList:n.gateway_addr,cid:n.cid+"",uid:n.uid+"",ec:null,vid:a},!0)}},p=function(t,i,o){a++,l.default.error("["+e.clientId+"]",t,i,o),o&&-1===f.JOIN_CS_RETRY_LIST.indexOf(o)&&(r=o),a===s.length+c.length&&n(r)},A=0;A<s.length;++A){var g;if("string"==typeof s[A]){var v=s[A];g=e.proxyServer?"https://".concat(e.proxyServer,"/ap/?url=").concat(v+"/api/v1"):"https://".concat(v,"/api/v1");var y=Object(m.getAreaCodeByWebCS)(v);l.default.debug("["+e.clientId+"] "+"Connect to choose_server: ".concat(g,", ").concat(y)),T(g,e,d,p)}else l.default.error("["+e.clientId+"] Invalid Host",s[A])}var b=setTimeout((function(){if(!o)for(var t=0;t<c.length;++t)if("string"==typeof c[t]){var n=c[t];g=e.proxyServer?"https://".concat(e.proxyServer,"/ap/?url=").concat(n+"/api/v1"):"https://".concat(n,"/api/v1");var r=Object(m.getAreaCodeByWebCS)(n);l.default.debug("["+e.clientId+"] "+"Connect to backup_choose_server: ".concat(g,", ").concat(r)),T(g,e,d,p)}else l.default.error("["+e.clientId+"] Invalid Host",c[t])}),1e3)}(e,(function(t){r=!0,d=t,clearTimeout(i),_[s]!==b.a.DISCONNECTED&&_[s]!==b.a.DISCONNECTING?c&&c(d,null):l.default.debug("[".concat(e.clientId,"] Request gateway list success when connection state is ").concat(_[s]))}),(function(r){if(r)return l.default.info("["+e.clientId+"] Join failed: "+r),void(n&&n(r));if(_[s]===b.a.DISCONNECTED||_[s]===b.a.DISCONNECTING)return l.default.debug("[".concat(e.clientId,"] Request gateway list falied when connection state is ").concat(_[s])),void(n&&n("OPERATION_ABORT"));l.default.debug("["+e.clientId+"] Request gateway list will be restart in "+o+"s"),i=setTimeout((function(){t(a,c)}),1e3*o),E[s]=i;var d=Object(u.getParameter)("AP_BACKOFF_MAX_TIME");o=o>=d?d:2*o}))}},d=function n(){!function(e,t){p(e,(function(n,r){if(n)return t&&t(n);l.default.debug("["+e.clientId+"] getProxyServerList: ",r),g(e,r,t)}))}(e,(function(r,o){if(r){l.default.debug("["+e.clientId+"]",r),l.default.debug("["+e.clientId+"] Request proxy will be restart in "+a+"s"),i=setTimeout((function(){n()}),1e3*a),E[s]=i;var d=Object(u.getParameter)("AP_BACKOFF_MAX_TIME");a=a>=d?d:2*a}else{clearTimeout(i);var f=o.address;e.proxyServer=f;var p={mode:"manual",url:o.address,tcpport:o.serverResponse.tcpport||"3433",udpport:o.serverResponse.udpport||"3478",username:o.serverResponse.username||"test",credential:o.serverResponse.password||Object(u.getParameter)("TURN_SERVER_PASSWORD"),forceturn:!0};p.tcpport+="",p.udpport+="",e.turnServers=[],e.turnServers.push(p),h.report.setProxyServer(f),l.default.setProxyServer(f),c(f,t)}}))},A=function r(){y("proxy3",e,(function(o,d){if(o)return"RETRYABLE_ERROR"!==o?n&&n(o):(l.default.debug("["+e.clientId+"]",o),l.default.debug("["+e.clientId+"] Request proxy will be restart in "+a+"s"),i=setTimeout((function(){r()}),1e3*a),E[s]=i,void(a=a>=3600?3600:2*a));clearTimeout(i);var f=Object(u.getParameter)("NGINX");e.proxyServer=f,e.turnServers=[],d.map((function(t){var n={mode:"manual",url:t.ip,tcpport:"",udpport:t.port||"3478",username:t.username||"test",credential:t.password||Object(u.getParameter)("TURN_SERVER_PASSWORD"),forceturn:!0};n.tcpport+="",n.udpport+="",e.turnServers.push(n)})),h.report.setProxyServer(f),l.default.setProxyServer(f),c(f,t)}))};e.useProxyServer?1==e.proxyServerType?d():2==e.proxyServerType?function n(){!function(e,t){p(e,(function(n,r){return n?t&&t(n):(l.default.debug("["+e.clientId+"] getProxyServerList: ",r),t&&t(null,{address:r[0],serverResponse:{tcpport:"443",udpport:"3478",username:"test",password:"111111"}}))}))}(e,(function(r,o){if(r)return l.default.debug("["+e.clientId+"]",r),l.default.debug("["+e.clientId+"] Request proxy will be restart in "+a+"s"),i=setTimeout((function(){n()}),1e3*a),E[s]=i,void(a=a>=3600?3600:2*a);clearTimeout(i);var d=Object(u.getParameter)("PROXY_SERVER_TYPE2");e.proxyServer=d;var f={mode:"manual",url:o.address,tcpport:o.serverResponse.tcpport||"3433",udpport:o.serverResponse.udpport||"3478",username:o.serverResponse.username||"test",credential:o.serverResponse.password||"111111",forceturn:!0};f.tcpport+="",f.udpport+="",e.turnServers=[],e.turnServers.push(f),h.report.setProxyServer(d),l.default.setProxyServer(d),c(d,t)}))}():3==e.proxyServerType?A():4==e.proxyServerType?y("proxy4",e,(function(r,o){if(r)return"RETRYABLE_ERROR"!==r?n&&n(r):(l.default.debug("["+e.clientId+"]",r),l.default.debug("["+e.clientId+"] Request proxy will be restart in "+a+"s"),i=setTimeout((function(){A()}),1e3*a),E[s]=i,void(a=a>=3600?3600:2*a));clearTimeout(i);var d=Object(u.getParameter)("NGINX");e.proxyServer=d,e.turnServers=[],o.map((function(t){var n={mode:"manual",url:t.ip,tcpport:t.port||"443",udpport:"",username:t.username||"test",credential:t.password||Object(u.getParameter)("TURN_SERVER_PASSWORD"),forceturn:!1};n.tcpport+="",n.udpport+="",e.turnServers.push(n)})),h.report.setProxyServer(d),l.default.setProxyServer(d),c(d,t)})):5==e.proxyServerType?y("proxy5",e,(function(r,o){if(r)return"RETRYABLE_ERROR"!==r?n&&n(r):(l.default.debug("["+e.clientId+"]",r),l.default.debug("["+e.clientId+"] Request proxy will be restart in "+a+"s"),i=setTimeout((function(){A()}),1e3*a),E[s]=i,void(a=a>=3600?3600:2*a));clearTimeout(i);var d=Object(u.getParameter)("NGINX");e.proxyServer=d,e.turnServers=[],o.map((function(t){var n={mode:"manual",url:t.ip,tcpport:t.port||"443",udpport:"",username:t.username||"test",credential:t.password||Object(u.getParameter)("TURN_SERVER_PASSWORD"),forceturn:!1,useTurns:!0};n.tcpport+="",n.udpport+="",e.turnServers.push(n)})),h.report.setProxyServer(d),l.default.setProxyServer(d),c(d,t)}),!0):d():c(null,t)},C=function(e,t,n,r,i){var o=Date.now();r=r||t.stringUid;var a={sid:t.sid,opid:10,appid:t.appId,string_uid:r};return new Promise((function(i,s){Object(d.post)(e+"".concat(-1===e.indexOf("?")?"?":"&","action=stringuid"),a,(function(c){try{var u=JSON.parse(c),d=u.code}catch(i){var p="requestUserAccount failed with unexpected body "+c;return l.default.error("["+t.clientId+"]",p),s({retryable:!0,info:p,url:e,error:"UNEXPECTED_ERROR"}),n&&n.dispatchEvent({type:"error",reason:"USER_ACCOUNT_BODY_NOT_JSON"}),void h.report.reqUserAccount(a.sid,{lts:o,success:!1,serverAddress:e,stringUid:r,uid:null,extend:c,errorCode:"USER_ACCOUNT_BODY_NOT_JSON"})}if(d){var A=!1;return"INTERNAL_SERVER_ERROR"===(v=f.StringUidErrorCode[u.code%1e4]||"REQ_ACCOUNT_ERR_".concat(d))&&(A=!0),n&&n.dispatchEvent({type:"error",reason:v}),h.report.reqUserAccount(a.sid,{lts:o,success:!1,serverAddress:e,stringUid:r,uid:null,errorCode:v,extend:a}),s({retryable:A,info:p="Get String Uid Failed ["+v+"]",url:e,error:v})}var g=u.uid;if(!(g>0&&g<Math.pow(2,32))){l.default.error("["+t.clientId+"] "+"Invalid Uint Uid ".concat(r," => ").concat(g),u);var v="INVALID_UINT_UID_".concat(g);return n&&n.dispatchEvent({type:"error",reason:v}),h.report.reqUserAccount(a.sid,{lts:o,success:!1,serverAddress:e,stringUid:r,uid:null,errorCode:v,extend:a}),s({retryable:!0,error:v,info:"Get String Uid failed ["+v+"]",url:e})}i({uid:g,url:e}),h.report.reqUserAccount(a.sid,{lts:o,success:!0,serverAddress:e,stringUid:r,uid:g,errorCode:null,extend:a})}),(function(e,t){if("timeout"===e.type){var i="USER_ACCOUNT_TIMEOUT";n&&n.dispatchEvent({type:"error",reason:i}),h.report.reqUserAccount(a.sid,{lts:o,success:!1,serverAddress:t,stringUid:r,uid:null,errorCode:i,extend:a}),s({retryable:!0,info:i,url:t,error:i})}else{var c="USER_ACCOUNT_SERVER_WRONG_".concat(e.type);n&&n.dispatchEvent({type:"error",reason:c}),h.report.reqUserAccount(a.sid,{lts:o,success:!1,serverAddress:t,stringUid:r,uid:null,errorCode:c,extend:a}),s({retryable:!0,info:c,url:t,error:c})}}),{"X-Packet-Service-Type":0,"X-Packet-URI":72})}))},I=function(e,t,n){Date.now();var r,o=Object(u.getParameter)("ACCOUNT_REGISTER"),s=!1,d=Object(u.getParameter)("ACCOUNT_REGISTER_RETRY_TIMEOUT"),h=null,f=null,p=new Promise(function(){var p=c()(a.a.mark((function c(p,A){var g,v,m;return a.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:h=p,f=A,r=0;case 3:if(!(r<Object(u.getParameter)("ACCOUNT_REGISTER_RETRY_COUNT_MAX"))){c.next=33;break}if(!s){c.next=6;break}return c.abrupt("return");case 6:return g=o[r%o.length],v=e.proxyServer?"https://".concat(e.proxyServer,"/ap/?url=").concat(g+"/api/v1"):"https://".concat(g,"/api/v1"),c.prev=8,c.delegateYield(a.a.mark((function r(){var i;return a.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return e.proxyServer,r.next=3,C(v,e,t,n);case 3:if(i=r.sent,!s){r.next=6;break}return r.abrupt("return",{v:void 0});case 6:s=!0,setTimeout((function(){l.default.debug("Get UserAccount Successfully",i),h(i)}),0);case 8:case"end":return r.stop()}}),r)}))(),"t0",10);case 10:if(m=c.t0,"object"!==i()(m)){c.next=13;break}return c.abrupt("return",m.v);case 13:c.next=30;break;case 15:if(c.prev=15,c.t1=c.catch(8),!s){c.next=19;break}return c.abrupt("return");case 19:if(!c.t1.retryable){c.next=27;break}return(d=Math.ceil(d*Object(u.getParameter)("ACCOUNT_REGISTER_RETRY_RATIO")))>Object(u.getParameter)("ACCOUNT_REGISTER_RETRY_TIMEOUT_MAX")&&(d=Object(u.getParameter)("ACCOUNT_REGISTER_RETRY_TIMEOUT_MAX")),l.default.error("".concat(c.t1.info," ").concat(c.t1.url," Will Fetch User Account in ").concat(d/1e3," seconds")),c.next=25,new Promise((function(e){setTimeout(e,d)}));case 25:c.next=30;break;case 27:l.default.error("Get UserAccount Error: ".concat(c.t1.info," ").concat(c.t1.url),c.t1.error),s=!0,f(c.t1.error);case 30:r++,c.next=3;break;case 33:case"end":return c.stop()}}),c,null,[[8,15]])})));return function(e,t){return p.apply(this,arguments)}}());return p.cancel=function(){s||(s=!0,f({info:"Request Cancelled",retryable:!1}))},p.isFinished=function(){return s},p}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i,o,a=r(n(0));!function(e){e.CHINA="CHINA",e.ASIA="ASIA",e.NORTH_AMERICA="NORTH_AMERICA",e.EUROPE="EUROPE",e.JAPAN="JAPAN",e.INDIA="INDIA",e.OCEANIA="OCEANIA",e.SOUTH_AMERICA="SOUTH_AMERICA",e.AFRICA="AFRICA",e.OVERSEA="OVERSEA",e.GLOBAL="GLOBAL"}(i||(i={})),t.AREAS=i,function(e){e.CHINA="CN",e.ASIA="AS",e.NORTH_AMERICA="NA",e.EUROPE="EU",e.JAPAN="JP",e.INDIA="IN",e.OCEANIA="OC",e.SOUTH_AMERICA="SA",e.AFRICA="AF",e.OVERSEA="OVERSEA",e.GLOBAL="GLOBAL"}(o||(o={}));var s={ASIA:{CODE:o.ASIA,WEBCS_DOMAIN:["ap-web-1-asia.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-asia.agora.io"],PROXY_CS:["proxy-ap-web-asia.agora.io"],CDS_AP:["cds-ap-web-asia.agora.io","cds-ap-web-asia2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-asia.agora.io","sua-ap-web-asia2.agora.io"],UAP_AP:["uap-ap-web-asia.agora.io","uap-ap-web-asia2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-asia.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-asia.agora.io"],LOG_UPLOAD_SERVER:["logservice-asia.agora.io"],NGINX:["southeast-asia.webrtc-cloud-proxy.sd-rtn.com"]},NORTH_AMERICA:{CODE:o.NORTH_AMERICA,WEBCS_DOMAIN:["ap-web-1-north-america.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-north-america.agora.io"],PROXY_CS:["proxy-ap-web-america.agora.io"],CDS_AP:["cds-ap-web-america.agora.io","cds-ap-web-america2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-america.agora.io","sua-ap-web-america2.agora.io"],UAP_AP:["uap-ap-web-america.agora.io","uap-ap-web-america2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-north-america.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-north-america.agora.io"],LOG_UPLOAD_SERVER:["logservice-north-america.agora.io"],NGINX:["east-usa.webrtc-cloud-proxy.sd-rtn.com"]},EUROPE:{CODE:o.EUROPE,WEBCS_DOMAIN:["ap-web-1-europe.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-europe.agora.io"],PROXY_CS:["proxy-ap-web-europe.agora.io"],CDS_AP:["cds-ap-web-europe.agora.io","cds-ap-web-europe2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-europe.agora.io","sua-ap-web-europe.agora.io"],UAP_AP:["uap-ap-web-europe.agora.io","uap-ap-web-europe2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-europe.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-europe.agora.io"],LOG_UPLOAD_SERVER:["logservice-europe.agora.io"],NGINX:["europe.webrtc-cloud-proxy.sd-rtn.com"]},JAPAN:{CODE:o.JAPAN,WEBCS_DOMAIN:["ap-web-1-japan.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-japan.agora.io"],PROXY_CS:["proxy-ap-web-japan.agora.io"],CDS_AP:["cds-ap-web-japan.agora.io","cds-ap-web-japan2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-japan.agora.io","sua-ap-web-japan2.agora.io"],UAP_AP:["uap-ap-web-japan.agora.io","\tuap-ap-web-japan2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-japan.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-japan.agora.io"],LOG_UPLOAD_SERVER:["logservice-japan.agora.io"],NGINX:["japan.webrtc-cloud-proxy.sd-rtn.com"]},INDIA:{CODE:o.INDIA,WEBCS_DOMAIN:["ap-web-1-india.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-india.agora.io"],PROXY_CS:["proxy-ap-web-india.agora.io"],CDS_AP:["cds-ap-web-india.agora.io","cds-ap-web-india2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-india.agora.io","sua-ap-web-india2.agora.io"],UAP_AP:["uap-ap-web-india.agora.io","uap-ap-web-india2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-india.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-india.agora.io"],LOG_UPLOAD_SERVER:["logservice-india.agora.io"],NGINX:["india.webrtc-cloud-proxy.sd-rtn.com"]},OVERSEA:{CODE:o.OVERSEA,WEBCS_DOMAIN:["ap-web-1-oversea.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-oversea.agora.io"],PROXY_CS:["proxy-ap-web-oversea.agora.io"],CDS_AP:["cds-ap-web-oversea.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-oversea.agora.io"],UAP_AP:["uap-ap-web-oversea.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-oversea.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-oversea.agora.io"],LOG_UPLOAD_SERVER:["logservice-oversea.agora.io"],NGINX:["webrtc-cloud-proxy.agora.io"]},GLOBAL:{CODE:o.GLOBAL,WEBCS_DOMAIN:["webrtc2-ap-web-1.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["webrtc2-ap-web-3.agora.io"],PROXY_CS:["ap-proxy-1.agora.io","ap-proxy-2.agora.io"],CDS_AP:["cds-ap-web-1.agora.io","cds-ap-web-3.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-1.agora.io","sua-ap-web-3.agora.io"],UAP_AP:["uap-ap-web-1.agora.io","uap-ap-web-3.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2.agora.io"],LOG_UPLOAD_SERVER:["logservice.agora.io"],NGINX:["webrtc-cloud-proxy.sd-rtn.com"]},OCEANIA:{CODE:o.OCEANIA,WEBCS_DOMAIN:["ap-web-1-oceania.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-oceania.agora.io"],PROXY_CS:["proxy-ap-web-oceania.agora.io"],CDS_AP:["cds-ap-web-oceania.agora.io","cds-ap-web-oceania2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-oceania.agora.io","sua-ap-web-oceania2.agora.io"],UAP_AP:["uap-ap-web-oceania.agora.io","uap-ap-web-oceania2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-oceania.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-oceania.agora.io"],LOG_UPLOAD_SERVER:["logservice-oceania.agora.io"],NGINX:["oceania.webrtc-cloud-proxy.sd-rtn.com"]},SOUTH_AMERICA:{CODE:o.SOUTH_AMERICA,WEBCS_DOMAIN:["ap-web-1-south-america.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-south-america.agora.io"],PROXY_CS:["proxy-ap-web-south-america.agora.io"],CDS_AP:["cds-ap-web-south-america.agora.io","cds-ap-web-south-america2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-south-america.agora.io","sua-ap-web-south-america2.agora.io"],UAP_AP:["uap-ap-web-south-america.agora.io","uap-ap-web-south-america2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-south-america.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-south-america.agora.io"],LOG_UPLOAD_SERVER:["logservice-south-america.agora.io"],NGINX:["south-america.webrtc-cloud-proxy.sd-rtn.com"]},AFRICA:{CODE:o.AFRICA,WEBCS_DOMAIN:["ap-web-1-africa.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-africa.agora.io"],PROXY_CS:["proxy-ap-web-africa.agora.io"],CDS_AP:["cds-ap-web-africa.agora.io","cds-ap-web-africa2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-africa.agora.io","sua-ap-web-africa2.agora.io"],UAP_AP:["uap-ap-web-africa.agora.io","uap-ap-web-africa2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-africa.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-africa.agora.io"],LOG_UPLOAD_SERVER:["logservice-south-africa.agora.io"],NGINX:["africa.webrtc-cloud-proxy.sd-rtn.com"]}};t.AREA_DOMAIN_MAP=s,s.CHINA={CODE:o.CHINA,WEBCS_DOMAIN:["webrtc2-2.ap.sd-rtn.com"],WEBCS_DOMAIN_BACKUP_LIST:["webrtc2-4.ap.sd-rtn.com"],PROXY_CS:["proxy-web.ap.sd-rtn.com"],CDS_AP:["cds-web-2.ap.sd-rtn.com","cds-web-4.ap.sd-rtn.com"],ACCOUNT_REGISTER:["sua-web-2.ap.sd-rtn.com","sua-web-4.ap.sd-rtn.com"],UAP_AP:["uap-web-2.ap.sd-rtn.com","uap-web-4.ap.sd-rtn.com"],EVENT_REPORT_DOMAIN:["web-3.statscollector.sd-rtn.com"],EVENT_REPORT_BACKUP_DOMAIN:["web-4.statscollector.sd-rtn.com"],LOG_UPLOAD_SERVER:["logservice-china.agora.io"],NGINX:["east-cn.webrtc-cloud-proxy.sd-rtn.com"]},t.getAreaCodeByWebCS=function(e){for(var t=Object.keys(s),n=0;n<t.length;n++){var r=t[n],i=s[r];if(i.WEBCS_DOMAIN.includes(e)||i.WEBCS_DOMAIN_BACKUP_LIST.includes(e))return i.CODE===o.OVERSEA?o.ASIA+","+o.EUROPE+","+o.AFRICA+","+o.NORTH_AMERICA+","+o.SOUTH_AMERICA+","+o.OCEANIA:i.CODE}},t.getAreaCodeByArea=function(e){return e===i.OVERSEA?o.ASIA+","+o.EUROPE+","+o.AFRICA+","+o.NORTH_AMERICA+","+o.SOUTH_AMERICA+","+o.OCEANIA:o[e]},t.getAreaDomainConfig=function(e){var t={WEBCS_DOMAIN:[],WEBCS_DOMAIN_BACKUP_LIST:[],PROXY_CS:[],CDS_AP:[],ACCOUNT_REGISTER:[],UAP_AP:[],EVENT_REPORT_DOMAIN:[],EVENT_REPORT_BACKUP_DOMAIN:[],LOG_UPLOAD_SERVER:[],NGINX:[]};return e.map((function(e){var n=s[e];if(n){var r=Object.keys(n);r?r.map((function(e){"CODE"!==e&&(t[e]=t[e].concat(n[e]))})):a.default.info(e+" is not exist")}else a.default.info(e+" is not exist")})),t}},function(e,t,n){"use strict";n.d(t,"a",(function(){return C})),n.d(t,"b",(function(){return I}));var r=n(7),i=n.n(r),o=n(4),a=n(8),s=function(e){var t=Object(a.b)(e);return t.url=".",t},c=n(0),u=n(15),l=n(5),d=n(3),h=n(1),f=0,p=function(e){var t=s({});t.id=e.id,t.playerId=f++,t.destroyed=!1,t.fit=e.options&&e.options.fit,"contain"!==t.fit&&"cover"!==t.fit&&(t.fit=null),t.url=e.url,t.stream=e.stream.stream,t.peerVideoReady=!1,t.isFreeze=!1,t.freezeTimeCounterList=[],t.freezeCount=0,t.lastFreezeCount=0,t.lastTimeupdateTime=0,t.elementID=e.elementID,t.setAudioOutput=function(e,n,r){var i=t.video||t.audio;return i?i.setSinkId?void i.setSinkId(e).then((function(){return c.default.debug("["+t.id+"] "+"video ".concat(t.id," setAudioOutput ").concat(e," SUCCESS")),i==t.video&&t.audio?t.audio.setSinkId(e):Promise.resolve()})).then((function(){return c.default.debug("["+t.id+"] "+"audio ".concat(t.id," setAudioOutput ").concat(e," SUCCESS")),n&&n()})).catch((function(e){return c.default.error("["+t.id+"] VideoPlayer.setAudioOutput",e),r&&r(e)})):(c.default.error("["+t.id+"] ",l.default.WEB_API_NOT_SUPPORTED),r&&r(l.default.WEB_API_NOT_SUPPORTED)):(c.default.error("["+t.id+"] ",l.default.PLAYER_NOT_FOUND),r&&r(l.default.PLAYER_NOT_FOUND))},t.destroy=function(){c.default.debug("[".concat(t.id,"] destroy ").concat(e.stream.local?"local":"remote"," Player ").concat(t.id)),Object(u.setSrcObject)(t.video,null),Object(u.setSrcObject)(t.audio,null),t.video.load(),t.audio.load(),t.video.pause(),t.freezeCheckInterval&&clearInterval(t.freezeCheckInterval),t.destroyed=!0,delete t.resizer,document.getElementById(t.div.id)&&t.parentNode.contains(t.div)&&t.parentNode.removeChild(t.div),["video","audio"].forEach((function(n){t[n];var r=a[n];clearTimeout(r.playDeferTimeout),r.formerMediaState=null;var i={playerId:t.playerId,stateId:r.stateId+1,playDeferTimeout:null,error:!1,status:"aborted",reason:"stop",updatedAt:Date.now()};a[n]=i;var o={type:"player-status-change",playerId:t.playerId,mediaType:n,status:i.status,reason:i.reason,isErrorState:!1,streamId:t.id};c.default.debug("[".concat(t.id,"] Media Player Status Change Triggered by destroy()"),o),e.stream.dispatchEvent(o),h.report.reportApiInvoke(e.stream.sid,{name:"Stream.playerStatusChange",options:o,tag:"tracer"})()}))},t.div=document.createElement("div"),t.div.setAttribute("id","player_"+t.id),e.stream.video?t.div.setAttribute("style","width: 100%; height: 100%; position: relative; background-color: black; overflow: hidden;"):t.div.setAttribute("style","width: 100%; height: 100%; position: relative; overflow: hidden;"),t.video=document.createElement("video"),t.video.setAttribute("id","video"+t.id),e.stream.local&&!e.stream.screen?e.stream.mirror?t.video.setAttribute("style","width: 100%; height: 100%; position: absolute; transform: rotateY(180deg); object-fit: ".concat(t.fit||"cover",";")):t.video.setAttribute("style","width: 100%; height: 100%; position: absolute; object-fit: ".concat(t.fit||"cover",";")):e.stream.video?t.video.setAttribute("style","width: 100%; height: 100%; position: absolute; object-fit: ".concat(t.fit||"cover",";")):e.stream.screen?t.video.setAttribute("style","width: 100%; height: 100%; position: absolute; object-fit: ".concat(t.fit||"contain")):t.video.setAttribute("style","width: 100%; height: 100%; position: absolute; display: none; object-fit: ".concat(t.fit||"cover"));var n={autoplay:!0,muted:!!e.stream.local||!(!o.isSafari()&&"iOS"!==o.getBrowserOS())&&"video_element_muted",playsinline:!0,controls:!1,volume:null},r=i()({},n,e.options);!0!==r.muted||r.volume||(r.volume=0),t.video.setAttribute("autoplay",""),t.video.setAttribute("muted",""),t.video.muted=!0,t.video.autoplay=!0,r.playsinline&&t.video.setAttribute("playsinline",""),r.controls&&t.video.setAttribute("controls",""),r.contains&&(t.video.controls=!0),Number.isFinite(r.volume)&&(t.video.volume=r.volume),t.audio=document.createElement("audio"),t.audio.setAttribute("id","audio"+t.id),!0===r.muted&&t.audio.setAttribute("muted",""),!0===r.muted&&(t.audio.muted=!0),r.playsinline&&t.audio.setAttribute("playsinline",""),Number.isFinite(r.volume)&&(t.audio.volume=r.volume),void 0!==t.elementID?(document.getElementById(t.elementID).appendChild(t.div),t.container=document.getElementById(t.elementID)):(document.body.appendChild(t.div),t.container=document.body),t.parentNode=t.div.parentNode;var a={video:{playerId:t.playerId,stateId:0,playDeferTimeout:null,error:!1,status:"init",reason:null,updatedAt:Date.now()},audio:{playerId:t.playerId,stateId:0,playDeferTimeout:null,error:!1,status:"init",reason:null,updatedAt:Date.now()}};t.mediaElemExists=function(e){for(var t=e,n=0;n<Object(d.getParameter)("MEDIA_ELEMENT_EXISTS_DEPTH")&&t;n++)t=t.parentNode;return!!t};var p=function(e){return t.mediaElemExists(e)?e.paused?"paused":"play":"aborted"},A=function(e,t,n){var r=p(e),i=!0;return"paused"===r?("audio"===t&&!0===n.muted&&(i=!1),n.autoplay||(i=!1)):"play"===r?"video"===t?i=!1:!0===n.muted?e.muted&&(i=!1):e.muted||(i=!1):"aborted"===r&&(i=!1),i},g=function(n){var i,o=this;if(o===t.video?i="video":o===t.audio&&(i="audio"),i){if(n.type||c.default.error("[".concat(t.id,"] Unexpected evt"),n),"video"===i&&o.muted&&o.paused)return c.default.debug("[".concat(t.id,"] auto resume video element")),void o.play();var s=p(o);clearTimeout(a[i].playDeferTimeout),a[i].playDeferTimeout=setTimeout((function(){a[i].playDeferTimeout=null;var u=a[i],l=p(o);if(s===l){var d={playerId:t.playerId,stateId:u.stateId+1,playDeferTimeout:null,error:A(o,i,r),status:p(o),reason:n.type,updatedAt:Date.now()};if(u.status!==d.status){a[i]=d;var f={type:"player-status-change",playerId:t.playerId,mediaType:i,status:d.status,reason:d.reason,isErrorState:d.error,streamId:t.id};c.default.debug("[".concat(t.id,"] Media Player Status Change"),f),e.stream.dispatchEvent(f),h.report.reportApiInvoke(e.stream.sid,{name:"Stream.playerStatusChange",options:f,tag:"tracer"})()}}else c.default.debug("[".concat(t.id,"] Status Change after event Triggered.")+"Stream ".concat(t.id," PlayerId ").concat(t.playerId," mediaType ").concat(i," Status ").concat(s,"=>").concat(l))}),Object(d.getParameter)("PLAYER_STATE_DEFER"))}else c.default.error("[".concat(t.id,"] Unknown media element"),o)};t.video.addEventListener("playing",(function(e){!function e(){t.video.videoWidth*t.video.videoHeight>4?c.default.debug("["+t.id+"] video dimensions:",t.video.videoWidth,t.video.videoHeight):setTimeout(e,50)}()}));var v=0,m=0,y=0;t.freezeCheckInterval=setInterval((function(){Date.now()-t.lastTimeupdateTime>500&&t.peerVideoReady?(t.isFreeze=!0,t.freezeCount+=1):t.isFreeze=!1}),500),t.video.addEventListener("playing",g),t.video.addEventListener("canplay",g),t.video.addEventListener("abort",g),t.video.addEventListener("onerror",g),t.video.addEventListener("suspend",g),t.video.addEventListener("stalled",g),t.video.addEventListener("pause",g),t.audio.addEventListener("playing",g),t.audio.addEventListener("canplay",g),t.audio.addEventListener("abort",g),t.audio.addEventListener("onerror",g),t.audio.addEventListener("suspend",g),t.audio.addEventListener("stalled",g),t.audio.addEventListener("pause",g);var b=t.audio,E="audio";if(e.stream.hasVideo()||e.stream.hasScreen())t.div.appendChild(t.video),t.div.appendChild(t.audio),o.isEdge()?t.video.srcObject=e.stream.stream:(Object(u.attachMediaStream)(t.video,e.stream.stream),Object(u.attachMediaStream)(t.audio,e.stream.stream)),t.video.addEventListener("timeupdate",(function(){var e=Date.now();if((v+=1)<10)t.lastTimeupdateTime=e;else for(e-t.lastTimeupdateTime>500&&(t.peerVideoReady?m+=e-t.lastTimeupdateTime:t.peerVideoReady=!0),y+=e-t.lastTimeupdateTime,t.lastTimeupdateTime=e;y>=6e3;)y-=6e3,t.freezeTimeCounterList.push(Math.min(6e3,m)),m-=6e3,m=Math.max(m,0)}));else{!1!==r.muted&&"video_element_muted"!==r.muted||(t.video.removeAttribute("muted"),t.video.muted=!1),t.video.removeAttribute("autoplay"),t.video.autoplay=!1,t.div.appendChild(t.video),b=t.video,E="video";var _=a.audio,w={playerId:t.playerId,stateId:_.stateId+1,playDeferTimeout:null,error:!1,status:"aborted",reason:"audioonly",updatedAt:Date.now()};a.audio=w;var S={type:"player-status-change",playerId:t.playerId,mediaType:"audio",status:w.status,reason:w.reason,isErrorState:w.error,streamId:t.id};if(c.default.debug("[".concat(t.id,"] Media Player Status Change"),S),Promise.resolve().then((function(){return e.stream.dispatchEvent(S)})),h.report.reportApiInvoke(e.stream.sid,{name:"Stream.playerStatusChange",options:S,tag:"tracer"})(),window.MediaStream&&(o.isSafari()||"iOS"===o.getBrowserOS())){var T=new MediaStream(e.stream.stream.getAudioTracks());Object(u.setSrcObject)(t.video,T)}else Object(u.setSrcObject)(t.video,e.stream.stream)}if(r.autoplay&&b){var R=b.play();R&&R.catch&&R.catch((function(n){if(!t.destroyed&&b){var i=a[E],o={playerId:t.playerId,stateId:i.stateId+1,playDeferTimeout:null,error:A(b,E,r),status:p(b),reason:"error",updatedAt:Date.now()};if(i.status!==o.status){c.default.debug("[".concat(t.id,"] Player ").concat(t.playerId," Status Changed Detected by promise error: ").concat(i.status,"=>").concat(o.status),n),a[E]=o;var s={type:"player-status-change",playerId:t.playerId,mediaType:E,status:o.status,reason:o.reason,isErrorState:o.error,streamId:t.id};c.default.debug("[".concat(t.id,"] Media Player Status Change"),s),e.stream.dispatchEvent(s),h.report.reportApiInvoke(e.stream.sid,{name:"Stream.playerStatusChange",options:s,tag:"tracer"})()}}}))}return t.setAudioVolume=function(e){var n=parseInt(e)/100;isFinite(n)&&(n<0?n=0:n>1&&(n=1),t.video&&(t.video.volume=n),t.audio&&(t.audio.volume=n))},t},A=n(23),g=n(10),v=n(6),m=n(19),y=n(2),b=n(25),E=n(16),_=n(11),w=n.n(_),S=function(e){Object(y.checkValidString)(e,"profileName"),-1===(e=e.toLowerCase()).indexOf("_")&&(e+="_1"),Object(y.checkValidEnum)(e,"profileName",Object.keys(d.SUPPORT_RESOLUTION_LIST));var t=d.SUPPORT_RESOLUTION_LIST[e];t||(e=Object(d.getParameter)("DEFAULT_PROFILE"),t=d.SUPPORT_RESOLUTION_LIST[e]);var n={profileName:e,video:{width:t[0],height:t[1]},attributes:{resolution:"".concat(t[0],"x").concat(t[1]),minFrameRate:t[2],maxFrameRate:t[3],minVideoBW:t[4],maxVideoBW:t[5]}};return t[2]&&(n.video.frameRate=t[2]),t[6]&&t[7]&&(n.screen={width:t[0],height:t[1],frameRate:{min:t[6],max:t[7]}}),n},T=function(e){return Object.keys(d.SUPPORT_RESOLUTION_LIST).filter((function(t){var n=d.SUPPORT_RESOLUTION_LIST[t],r=["width","height","frameRate"];for(var i in r){var o=r[i];if(e[o]&&n[i]){if("number"==typeof e[o].max&&e[o].max<n[i])return!1;if("number"==typeof e[o].min&&e[o].min>n[i])return!1}}return!0})).reverse()},R=function(e){var t=d.AUDIO_PROFILE_SETTINGS[e]||d.AUDIO_PROFILE_SETTINGS.default;return{highQuality:t[0],stereo:t[1],speech:t[2],lowQuality:t[3]}},C=function(e){var t=Object(a.b)();if(t.params=i()({},e),t.stream=e.stream,t.url=e.url,t.onClose=void 0,t.local=!1,t.videoSource=e.videoSource,t.audioSource=e.audioSource,e.video=!(!e.videoSource&&!e.video),t.video=e.video,e.audio=!(!e.audioSource&&!e.audio),t.audio=e.audio,t.screen=!!e.screen,t.screenAudio=!!e.screenAudio,t.screenAttributes={width:1920,height:1080,maxFr:5,minFr:1},t.videoSize=e.videoSize,t.player=void 0,t.audioLevelHelper=null,e.attributes=e.attributes||{},t.attributes=e.attributes,t.microphoneId=e.microphoneId,t.cameraId=e.cameraId,t.facingMode=e.facingMode,t.inSwitchDevice=!1,t.userMuteVideo=!1,t.userMuteAudio=!1,t.peerMuteVideo=!1,t.peerMuteAudio=!1,t.lowStream=null,t.videoWidth=0,t.videoHeight=0,t.streamId=e.streamID,t.userId=null,t.uintId=e.uintUID||null,t.mirror=!1!==e.mirror,t.DTX=e.audioProcessing&&e.audioProcessing.DTX,t.audioProcessing=e.audioProcessing,t.optimizationMode=e.optimizationMode,t.highQuality=!1,t.stereo=!1,t.speech=!1,t.screen||delete t.screen,!(void 0===t.videoSize||t.videoSize instanceof Array&&4===t.videoSize.length))throw Error("Invalid Video Size");function n(){var e={};t.getVideoTrack()===this?(c.default.debug("Video Track Ended"),e.type="videoTrackEnded",e.track=this):t.getAudioTrack()===this?(c.default.debug("Audio Track Ended"),e.type="audioTrackEnded",e.track=this):c.default.debug("Detached Track ended",this.kind,this.label,this),e.type&&t.dispatchEvent(e)}return t.videoSize=[640,480,640,480],void 0!==e.local&&!0!==e.local||(t.local=!0),t.initialized=!t.local,t._streamInitID=null,function(e){e.audioMixing={audioContextInited:!1,defaultVolume:100,inEarMonitoring:"FILE",sounds:{},states:{IDLE:"IDLE",STARTING:"STARTING",BUSY:"BUSY",PAUSED:"PAUSED"},inEarMonitoringModes:{NONE:"NONE",FILE:"FILE",MICROPHONE:"MOCROPHONE",ALL:"ALL"},ctx:null,mediaStreamSource:null,mediaStreamDest:null,buffer:{}},e._initSoundIfNotExists=function(t,n){e.audioMixing.sounds[t]||(e.audioMixing.sounds[t]={soundId:t,state:"IDLE",muted:e.userMuteAudio,filePath:n,volume:e.audioMixing.defaultVolume,startAt:null,startOffset:null,pauseAt:null,pauseOffset:null,resumeAt:null,resumeOffset:null,stopAt:null,options:null,source:null})},e._initSoundIfNotExists(-1),e.loadAudioBuffer=function(t,n,r){var i=h.report.reportApiInvoke(e.sid,{callback:r,name:"Stream.loadAudioBuffer",options:arguments,tag:"tracer"});Object(y.checkValidString)(n,"url",1,1024,!1),Object(y.checkValidString)(t,"id",1,1024,!1);var o=function(t){c.default.error("[".concat(e.streamId,"] loadAudioBuffer Failed: ")+t),i(l.default.LOAD_AUDIO_FAILED)},a=new XMLHttpRequest;a.open("GET",n,!0),a.responseType="arraybuffer",a.onload=function(){if(a.status>400)o("".concat(a.status," ").concat(a.statusText));else{var n=a.response;e.audioMixing.audioContextInited||e._initAudioContext(),e.audioMixing.ctx.decodeAudioData(n,(function(n){e.audioMixing.buffer[t]=n,i(null)}),(function(t){c.default.error("[".concat(e.streamId,"] decodeAudioData Failed: "),t),i(t)}))}},a.onerror=function(){return o("load error")},a.ontimeout=function(){return o("timeout")},a.send()},e.createAudioBufferSource=function(t){var n=h.report.reportApiInvoke(e.sid,{name:"Stream.createAudioBufferSource",options:arguments,tag:"tracer"});if(e.audioMixing.buffer[t.id]){var r=e.audioMixing.buffer[t.id],i=e.audioMixing.ctx.createBufferSource();i.buffer=r;var a=e.audioMixing.ctx.createGain();if(i.connect(a),a.connect(e.audioMixing.mediaStreamDest),i.gainNode=a,t.loop)i.loop=!0,i.start(0,t.playTime/1e3);else if(t.cycle>1)if(Object(o.isChrome)()){i.loop=!0;var s=t.cycle*r.duration*1e3-(t.playTime||0);i.start(0,t.playTime/1e3,s/1e3)}else c.default.warning("[".concat(e.streamId,"] Cycle Param is ignored by current browser")),i.start(0,t.playTime/1e3);else i.start(0,t.playTime/1e3);var u=e.audioMixing.sounds[t.soundId];return u.source=i,e._flushAudioMixingMuteStatus(),i.addEventListener("ended",(function(){i===u.source&&e.dispatchEvent({type:"audioSourceEnded",soundId:t.soundId,source:i,sound:u})})),n(),i}var l="AUDIOBUFFER_NOT_FOUND";return c.default.error("[".concat(e.streamId,"] "),l,t.id),n(!1),!1},e.on("audioSourceEnded",(function(t){var n=t.source,r=t.sound;r&&r.state===e.audioMixing.states.BUSY&&!r.pauseAt&&(r.state=e.audioMixing.states.IDLE,r.startAt=null,r.startOffset=null,r.resumeAt=null,r.resumeOffset=null,n.gainNode&&n.gainNode.disconnect&&n.gainNode.disconnect(),n.buffer=null,e.audioMixing.mediaStreamSource.connect(e.audioMixing.mediaStreamDest))})),e.clearAudioBufferSource=function(){e.audioBufferSource.forEach((function(e){e.stop()}))},e._isSoundExists=function(t){return!!e.audioMixing.sounds[t.soundId]||(c.default.error("SoundId not exists. #".concat(t.soundId)),!1)},e._initAudioContext=function(){if(e.audioMixing.audioContextInited)throw new Error("Failed to init audio context. Already inited");if(!e.stream)throw new Error("Failed to init audio context. Local Stream not initialized");e.audioMixing.ctx=Object(b.a)(),e.audioMixing.mediaStreamSource=e.audioMixing.ctx.createMediaStreamSource(e.stream),e.audioMixing.mediaStreamDest=e.audioMixing.ctx.createMediaStreamDestination(),e.audioMixing.mediaStreamSource.connect(e.audioMixing.mediaStreamDest);var t=e.stream.getVideoTracks()[0];if(t&&e.audioMixing.mediaStreamDest.stream.addTrack(t),e._originStream=e.stream,e._isAudioMuted()?(e._unmuteAudio(),e.stream=e.audioMixing.mediaStreamDest.stream,e._muteAudio()):e.stream=e.audioMixing.mediaStreamDest.stream,e.audioLevelHelper=null,e.pc&&e.pc.peerConnection&&e.pc.peerConnection){var n=(e.pc.peerConnection&&e.pc.peerConnection.getSenders()).find((function(e){return e&&e.track&&"audio"==e.track.kind})),r=e.audioMixing.mediaStreamDest.stream.getAudioTracks()[0];n&&n.replaceTrack&&r&&n.replaceTrack(r)}e.audioMixing.audioContextInited=!0},e._cleanupAudioMixing=function(){if(e.audioMixing.audioContextInited){for(var t in e.audioMixing.sounds){var n=e.audioMixing.sounds[t];n.state!==e.audioMixing.states.BUSY&&n.state!==e.audioMixing.states.PAUSED||e._stopOneEffect({soundId:t})}e.audioLevelHelper=null,e.audioMixing.audioContextInited=!1}},e._reloadInEarMonitoringMode=function(t){if(t){if(!e.audioMixing.inEarMonitoringModes[t])return c.default.error("[".concat(e.streamId,"] Invalid InEarMonitoringMode ").concat(t));e.audioMixing.inEarMonitoring=t}switch(e.audioMixing.audioContextInited||e._initAudioContext(),e.audioMixing.inEarMonitoring){case e.audioMixing.inEarMonitoringModes.FILE:e.audioMixing.mediaStreamSource.connectedToDestination&&(e.audioMixing.mediaStreamSource.disconnect(e.audioMixing.ctx.destination),e.audioMixing.mediaStreamSource.connectedToDestination=!1);case e.audioMixing.inEarMonitoringModes.ALL:for(var n in e.audioMixing.sounds){var r=e.audioMixing.sounds[n];r&&r.source&&!r.source.connectedToDestination&&(r.source.gainNode.connect(e.audioMixing.ctx.destination),r.source.connectedToDestination=!0)}}switch(e.audioMixing.inEarMonitoring){case e.audioMixing.inEarMonitoringModes.MICROPHONE:e.audioMixing.source.forEach((function(t){t.connectedToDestination&&(t.gainNode.disconnect(e.audioMixing.ctx.destination),t.connectedToDestination=!1)}));case e.audioMixing.inEarMonitoringModes.ALL:e.audioMixing.mediaStreamSource.connectedToDestination||(e.audioMixing.mediaStreamSource.connect(e.audioMixing.ctx.destination),e.audioMixing.mediaStreamSource.connectedToDestination=!0)}},e._startAudioMixingBufferSource=function(t){e.audioMixing.audioContextInited||e._initAudioContext();var n={soundId:t.soundId,id:t.filePath,loop:t.loop,cycle:t.cycle,playTime:t.playTime||0},r=t.replace,i=e.createAudioBufferSource(n);return i.sound=e.audioMixing.sounds[t.soundId],i?(i.addEventListener("ended",e._audioMixingFinishedListener,{once:!0}),e._reloadInEarMonitoringMode(),r&&e.audioMixing.mediaStreamSource.disconnect(e.audioMixing.mediaStreamDest),i):null},e._stopAudioMixingBufferSource=function(t){var n=e.audioMixing.sounds[t.soundId].source;return n?(n.removeEventListener("ended",e._audioMixingFinishedListener),e.audioMixing.mediaStreamSource.connect(e.audioMixing.mediaStreamDest),n.stop(),n.gainNode&&n.gainNode.disconnect&&n.gainNode.disconnect(),n.buffer=null,n):null},e._flushAudioMixingMuteStatus=function(t){for(var n in e.audioMixing.sounds){var r=e.audioMixing.sounds[n];r&&(void 0!==t&&(r.muted=!!t),r.source&&(r.muted?r.source.gainNode.gain.value=0:r.source.gainNode.gain.value=r.volume/100))}},e._handleAudioMixingInvalidStateError=function(t,n,r){var i=e.audioMixing.sounds[n.soundId],o=-1===n.soundId?"INVALID_AUDIO_MIXING_STATE":"INVALID_PLAY_EFFECT_STATE";c.default.error("[".concat(e.streamId,"] Cannot ").concat(t,": ").concat(o,", state is ").concat(i.state)),r&&r(o)},e._handleAudioMixingNoSourceError=function(t,n,r){e.audioMixing.sounds[n.soundId].state=e.audioMixing.states.IDLE;var i=-1===n.soundId?"NO_AUDIO_MIXING_SOURCE":"NO_EFFECT_SOURCE";c.default.error("[".concat(e.streamId,"] Cannot ").concat(t,": ").concat(i)),r&&r(i)},e._getOneEffectStates=function(t){var n=e.audioMixing.sounds[t.soundId];return function(){return n?{state:n.state,startAt:n.startAt,resumeAt:n.resumeAt,pauseOffset:n.pauseOffset,pauseAt:n.pauseAt,resumeOffset:n.resumeOffset,stopAt:n.stopAt,duration:e._getOneEffectDuration(t),position:e._getOneEffectCurrentPosition(t)}:{}}},e._audioMixingFinishedListener=function(){var t=this.sound;t.state===e.audioMixing.states.IDLE&&e.audioMixing.buffer[t.options.filePath]&&!t.options.cacheResource&&(c.default.debug("Recycled buffer ".concat(t.options.filePath)),delete e.audioMixing.buffer[t.options.filePath]),-1===t.soundId&&e.dispatchEvent({type:"audioMixingFinished"})},e._playOneEffect=function(t,n){Object(y.checkValidObject)(t,"options");var r=t.soundId,i=(t.filePath,t.cacheResource);if(t.cycle,t.loop,t.playTime,t.replace,Object(o.isSafari)()&&Object(o.getBrowserVersion)()<12){var a="BROWSER_NOT_SUPPORT";return c.default.error("[".concat(e.streamId,"] Cannot _playOneEffect: "),a),n(a)}e.audioMixing.audioContextInited||e._initAudioContext(),e._initSoundIfNotExists(r);var s=e.audioMixing.sounds[r];if(s.state===e.audioMixing.states.IDLE){if(void 0!==t.cycle&&!t.cycle>0)return a="Invalid Parmeter cycle: "+t.cycle,c.default.error("[".concat(e.streamId,"] ").concat(r),a),n(a);if(Object(y.isEmpty)(i)&&(t.cacheResource=!0),s.state=e.audioMixing.states.STARTING,s.options=t,e.audioMixing.buffer[t.filePath]){var u=e._startAudioMixingBufferSource(t);if(u)return s.source=u,s.startAt=Date.now(),s.resumeAt=null,s.pauseOffset=null,s.pauseAt=null,s.resumeOffset=null,s.stopAt=null,s.startOffset=t.playTime||0,s.state=e.audioMixing.states.BUSY,e._flushAudioMixingMuteStatus(),n(null);s.state=e.audioMixing.states.IDLE;var l="CREATE_BUFFERSOURCE_FAILED";if(n)return n(l);c.default.error("[".concat(e.streamId,"] "),l)}else e.loadAudioBuffer(t.filePath,t.filePath,(function(r){if(r)s.state=e.audioMixing.states.IDLE,n?n(r):c.default.error("[".concat(e.streamId,"] "),r);else{var i=e._startAudioMixingBufferSource(t);if(i)return s.source=i,s.startAt=Date.now(),s.resumeAt=null,s.pauseOffset=null,s.pauseAt=null,s.resumeOffset=null,s.stopAt=null,s.startOffset=t.playTime||0,s.state=e.audioMixing.states.BUSY,e._flushAudioMixingMuteStatus(),n(null);if(s.state=e.audioMixing.states.IDLE,r="CREATE_BUFFERSOURCE_FAILED",n)return n(r);c.default.error("[".concat(e.streamId,"] "),r)}}))}else e._handleAudioMixingInvalidStateError("_playEffect",t,n)},e._stopOneEffect=function(t,n){var r=e.audioMixing.sounds[t.soundId];return e._isSoundExists(t)?r.state===e.audioMixing.states.BUSY||r.state===e.audioMixing.states.PAUSED?(e._stopAudioMixingBufferSource(t),r.stopAt=Date.now(),r.state=e.audioMixing.states.IDLE,e.audioMixing.buffer[r.options.filePath]&&!r.options.cacheResource&&(c.default.debug("Recycled buffer ".concat(r.options.filePath)),delete e.audioMixing.buffer[r.options.filePath]),void(n&&n(null))):void e._handleAudioMixingInvalidStateError("_stopOneEffect",t,n):n("SOUND_NOT_EXISTS")},e._pauseOneEffect=function(t,n){var r=e.audioMixing.sounds[t.soundId];if(r.state===e.audioMixing.states.BUSY)return e._stopAudioMixingBufferSource(t)?(r.pauseAt=Date.now(),r.state=e.audioMixing.states.PAUSED,r.resumeAt?r.pauseOffset=r.pauseAt-r.resumeAt+r.resumeOffset:r.pauseOffset=r.pauseAt-r.startAt+r.startOffset,n&&n(null)):void e._handleAudioMixingNoSourceError("_pauseOneEffect",t,n);e._handleAudioMixingInvalidStateError("_pauseOneEffect",t,n)},e._resumeOneEffect=function(t,n){var r=e.audioMixing.sounds[t.soundId];if(r.state===e.audioMixing.states.PAUSED){var i={soundId:t.soundId,filePath:r.options.filePath,cycle:r.options.cycle,loop:r.options.loop,playTime:r.pauseOffset,replace:r.options.replace},o=e._startAudioMixingBufferSource(i);if(!o){var a="CREATE_BUFFERSOURCE_FAILED";return n(a),void c.default.error("[".concat(e.streamId,"] "),a)}r.source=o,r.resumeAt=Date.now(),r.resumeOffset=r.pauseOffset,r.state=e.audioMixing.states.BUSY,r.pauseAt=null,r.pauseOffset=null,n(null)}else e._handleAudioMixingInvalidStateError("_resumeOneEffect",t,n)},e._getOneEffectDuration=function(t){var n=e.audioMixing.sounds[t.soundId];return n.options&&n.options.filePath&&e.audioMixing.buffer[n.options.filePath]?1e3*e.audioMixing.buffer[n.options.filePath].duration:null},e._getOneEffectCurrentPosition=function(t,n){var r=e.audioMixing.sounds[t.soundId];return r.state===e.audioMixing.states.PAUSED?r.pauseOffset%e._getOneEffectDuration(t):r.state===e.audioMixing.states.BUSY?r.resumeAt?(Date.now()-r.resumeAt+r.resumeOffset)%e._getOneEffectDuration(t):(Date.now()-r.startAt+r.startOffset)%e._getOneEffectDuration(t):void(n&&e._handleAudioMixingInvalidStateError("_getOneEffectCurrentPosition",t))},e._setOneEffectPosition=function(t,n,r){var i=e.audioMixing.sounds[t.soundId];if(i.state===e.audioMixing.states.BUSY){if(!e._stopAudioMixingBufferSource(t))return void e._handleAudioMixingNoSourceError("_setOneEffectPosition",t,r);var o={soundId:t.soundId,filePath:i.options.filePath,loop:i.options.loop,cycle:i.options.cycle,playTime:n},a=e._startAudioMixingBufferSource(o);if(!a){var s="CREATE_BUFFERSOURCE_FAILED";return r&&r(s),void c.default.error("[".concat(e.streamId,"] "),s)}i.source=a,i.startAt=Date.now(),i.startOffset=n,i.resumeAt=null,i.resumeOffset=null,i.pauseOffset=null,i.pauseAt=null}else{if(i.state!==e.audioMixing.states.PAUSED)return void e._handleAudioMixingInvalidStateError("_setOneEffectPosition",t,r);i.pauseOffset=n}r&&r(null)},e.startAudioMixing=function(t,n){var r=h.report.reportApiInvoke(e.sid,{callback:function(t){if(t)return n&&n(t);e.dispatchEvent({type:"audioMixingPlayed"}),n&&n(null)},getStates:e._getOneEffectStates({soundId:-1}),name:"Stream.startAudioMixing",options:t});Object(y.checkValidObject)(t,"options");var o=t.filePath,a=t.cacheResource,s=t.cycle,c=t.loop,u=t.playTime,l=t.replace;Object(y.checkValidString)(o,"filePath",1,Object(d.getParameter)("FILEPATH_LENMAX"),!1),Object(y.checkValidNumber)(u,"playTime",0,1e8),!Object(y.isEmpty)(s)&&Object(y.checkValidNumber)(s,"cycle"),!Object(y.isEmpty)(c)&&Object(y.checkValidBoolean)(c,"loop"),!Object(y.isEmpty)(l)&&Object(y.checkValidBoolean)(l,"replace"),!Object(y.isEmpty)(a)&&Object(y.checkValidBoolean)(a,"cacheResource");var f=i()({soundId:-1},t);e._playOneEffect(f,r)},e.stopAudioMixing=function(t){var n=h.report.reportApiInvoke(e.sid,{callback:t,getStates:e._getOneEffectStates({soundId:-1}),name:"Stream.stopAudioMixing"});e._stopOneEffect({soundId:-1},n)},e.pauseAudioMixing=function(t){var n=h.report.reportApiInvoke(e.sid,{callback:t,getStates:e._getOneEffectStates({soundId:-1}),name:"Stream.pauseAudioMixing"});return e._pauseOneEffect({soundId:-1},n)},e.resumeAudioMixing=function(t){var n=h.report.reportApiInvoke(e.sid,{callback:function(n,r){if(n)return t&&t(n);e.dispatchEvent({type:"audioMixingPlayed"}),t&&t(null)},getStates:e._getOneEffectStates({soundId:-1}),name:"Stream.resumeAudioMixing"});e._resumeOneEffect({soundId:-1},n)},e.adjustAudioMixingVolume=function(t){var n=h.report.reportApiInvoke(e.sid,{getStates:e._getOneEffectStates({soundId:-1}),name:"Stream.adjustAudioMixingVolume",options:arguments,tag:"tracer"});Object(y.checkValidNumber)(t,"volume",0,100),e.audioMixing.sounds[-1].volume=t,e._flushAudioMixingMuteStatus(),n()},e.getAudioMixingDuration=function(){var t=h.report.reportApiInvoke(e.sid,{getStates:e._getOneEffectStates({soundId:-1}),name:"Stream.getAudioMixingDuration"}),n=e._getOneEffectDuration({soundId:-1});return t(null,n),n},e.getAudioMixingCurrentPosition=function(){var t=h.report.reportApiInvoke(e.sid,{getStates:e._getOneEffectStates({soundId:-1}),name:"Stream.getAudioMixingCurrentPosition"}),n=e._getOneEffectCurrentPosition({soundId:-1},!0);return t(null,n),n},e.setAudioMixingPosition=function(t,n){var r=h.report.reportApiInvoke(e.sid,{callback:n,options:arguments,tag:"tracer",getStates:e._getOneEffectStates({soundId:-1}),name:"Stream.setAudioMixingPosition"});Object(y.checkValidNumber)(t,"position",0,1e8),e._setOneEffectPosition({soundId:-1},t,r)},e.playEffect=function(t,n){var r=h.report.reportApiInvoke(e.sid,{callback:function(t){if(t)return n&&n(t);e.dispatchEvent({type:"effectPlayed"}),n&&n(null)},name:"Stream.playEffect",options:t});Object(y.checkValidObject)(t,"options");var i=t.soundId,o=t.filePath,a=t.cycle;Object(y.checkValidNumber)(i,"soundId",1,1e4),Object(y.checkValidString)(o,"filePath",0,Object(d.getParameter)("FILEPATH_LENMAX"),!1),!Object(y.isEmpty)(a)&&Object(y.checkValidNumber)(a,"cycle"),e._playOneEffect(t,r)},e.stopEffect=function(t,n){var r=h.report.reportApiInvoke(e.sid,{callback:n,getStates:e._getOneEffectStates({soundId:t}),name:"Stream.stopEffect"});Object(y.checkValidNumber)(t,"soundId",1,1e4),e._stopOneEffect({soundId:t},r)},e.stopAllEffects=function(t){var n=h.report.reportApiInvoke(e.sid,{callback:t,name:"Stream.stopAllEffect"}),r=!1,i=0,o=0,a=function(e){r||(e?(n(e),r=!0):i+=1,i===o&&(n(null),r=!0))};for(var s in e.audioMixing.sounds){var c=e.audioMixing.sounds[s];-1!==c.soundId&&(c.state!==e.audioMixing.states.BUSY&&c.state!==e.audioMixing.states.PAUSED||(o++,e._stopOneEffect({soundId:s},a)))}o||n(null)},e.preloadEffect=function(t,n,r){var i=h.report.reportApiInvoke(e.sid,{callback:r,options:arguments,tag:"tracer",name:"Stream.preloadEffect"});Object(y.checkValidNumber)(t,"soundId",1,1e4),Object(y.checkValidString)(n,"filePath",1,Object(d.getParameter)("FILEPATH_LENMAX"),!1),e._initSoundIfNotExists(t,n),e.audioMixing.buffer[n]?i(null):e.loadAudioBuffer(n,n,i)},e.unloadEffect=function(t,n){var r=h.report.reportApiInvoke(e.sid,{callback:n,options:arguments,tag:"tracer",name:"Stream.unloadEffect"});Object(y.checkValidNumber)(t,"soundId",1,1e4);var i=e.audioMixing.sounds[t];if(!i){var o="SOUND_NOT_EXISTS";return c.default.error(o,t),void r(o)}var a=i.options?i.options.filePath:i.filePath;if(a)delete e.audioMixing.buffer[a],delete e.audioMixing.sounds[t],r(null);else{var s="SOUND_BUFFER_NOT_FOUND";c.default.error(s,t),r(s)}},e.pauseEffect=function(t,n){var r=h.report.reportApiInvoke(e.sid,{callback:n,options:arguments,tag:"tracer",name:"Stream.pauseEffect"});return e._pauseOneEffect({soundId:t},r)},e.pauseAllEffects=function(t){var n=h.report.reportApiInvoke(e.sid,{callback:t,name:"Stream.pauseAllEffects"}),r=!1,i=0,o=0,a=function(e){r||(e?(n(e),r=!0):i+=1,i===o&&(n(null),r=!0))};for(var s in e.audioMixing.sounds)"-1"!==s&&e.audioMixing.sounds[s].state===e.audioMixing.states.BUSY&&(o++,e._pauseOneEffect({soundId:s},a));o||n(null)},e.resumeEffect=function(t,n){Object(y.checkValidNumber)(t,"soundId",1,1e4);var r=h.report.reportApiInvoke(e.sid,{callback:n,options:arguments,tag:"tracer",name:"Stream.resumeEffect"});return e._resumeOneEffect({soundId:t},r)},e.resumeAllEffects=function(t){var n=h.report.reportApiInvoke(e.sid,{callback:t,name:"Stream.resumeAllEffects"}),r=!1,i=0,o=0,a=function(e){r||(e?(n(e),r=!0):i+=1,i===o&&(n(null),r=!0))};for(var s in e.audioMixing.sounds)"-1"!==s&&e.audioMixing.sounds[s].state===e.audioMixing.states.PAUSED&&(o++,e._resumeOneEffect({soundId:s},a));o||n(null)},e.getEffectsVolume=function(){var t=[];for(var n in e.audioMixing.sounds){var r=e.audioMixing.sounds[n];r&&"-1"!==n&&t.push({soundId:parseInt(n),volume:r.volume})}return t},e.setEffectsVolume=function(t,n){var r=h.report.reportApiInvoke(e.sid,{name:"Stream.setEffectsVolume",options:arguments,tag:"tracer",callback:n});for(var i in Object(y.checkValidNumber)(t,"volume",0,100),e.audioMixing.defaultVolume=t,e.audioMixing.sounds){var o=e.audioMixing.sounds[i];"-1"!==i&&(o.volume=t)}e._flushAudioMixingMuteStatus(),r(null)},e.setVolumeOfEffect=function(t,n,r){var i=h.report.reportApiInvoke(e.sid,{name:"Stream.setVolumeOfEffect",options:arguments,tag:"tracer",callback:r});Object(y.checkValidNumber)(t,"soundId",0,1e4),Object(y.checkValidNumber)(n,"volume",0,100),e._initSoundIfNotExists(t);var o=e.audioMixing.sounds[t];o.volume=n,e._flushAudioMixingMuteStatus(),i(null)}}(t),E.a.addVideoEffectCapability(t),function(e,t){e.videoConstraint={},t.cameraId&&(e.videoConstraint.deviceId={exact:t.cameraId}),t.facingMode&&(e.videoConstraint.facingMode=t.facingMode),e.videoSize&&(e.videoConstraint.width=e.videoSize[0],e.videoConstraint.height=e.videoSize[1]),Object(o.isLegacyChrome)()||(e.videoConstraint.frameRate=30),e.audioConstraint={},t.microphoneId&&(e.audioConstraint.deviceId={exact:t.microphoneId}),Object(o.isLegacyChrome)()||e.audioProcessing&&(void 0!==e.audioProcessing.AGC&&(Object(o.isFireFox)()?e.audioConstraint.autoGainControl=e.audioProcessing.AGC:Object(o.isChrome)()&&(e.audioConstraint.googAutoGainControl=e.audioProcessing.AGC,e.audioConstraint.googAutoGainControl2=e.audioProcessing.AGC)),void 0!==e.audioProcessing.AEC&&(e.audioConstraint.echoCancellation=e.audioProcessing.AEC),void 0!==e.audioProcessing.ANS&&(Object(o.isFireFox)()?e.audioConstraint.noiseSuppression=e.audioProcessing.ANS:Object(o.isChrome)()&&(e.audioConstraint.googNoiseSuppression=e.audioProcessing.ANS))),e.screenConstraint={},t.sourceId&&(e.screenConstraint.sourceId=t.sourceId),t.extensionId&&Object(o.isChrome)()?(e.screenConstraint.extensionId=t.extensionId,e.screenConstraint.mandatory={chromeMediaSource:"desktop",maxWidth:e.screenAttributes.width,maxHeight:e.screenAttributes.height,maxFrameRate:e.screenAttributes.maxFr,minFrameRate:e.screenAttributes.minFr}):(e.screenConstraint.mediaSource="screen",e.screenConstraint.width=e.screenAttributes.width,e.screenConstraint.height=e.screenAttributes.height,e.screenConstraint.frameRate={ideal:e.screenAttributes.maxFr,max:e.screenAttributes.maxFr}),t.mediaSource&&(e.screenConstraint.mediaSource=t.mediaSource),e.setVideoResolution=function(n){var r=h.report.reportApiInvoke(e.sid,{name:"Stream.setVideoResolution",options:arguments,tag:"tracer"});if(!(n instanceof Array)){var o=S(n+="");return o&&o.video?(e.videoConstraint=i()(e.videoConstraint,{width:{ideal:o.video.width},height:{ideal:o.video.height}}),t.attributes.resolution=o.attributes.resolution,(a=e.stream&&e.stream.getVideoTracks&&e.stream.getVideoTracks()[0])&&a.applyConstraints?(c.default.debug("setVideoResolution applyConstraints",e.videoConstraint),a.applyConstraints(e.videoConstraint).then(r).catch(r)):r(),!0):(r("NO_PROFILE_".concat(n)),!1)}var a,s=n[0],u=n[1];e.videoConstraint=i()(e.videoConstraint,{width:{ideal:s},height:{ideal:u}}),t.attributes.resolution="".concat(s,"x").concat(u),(a=e.stream&&e.stream.getVideoTracks&&e.stream.getVideoTracks()[0])&&a.applyConstraints?(c.default.debug("setVideoResolution applyConstraints",e.videoConstraint),E.a.disableVideoEffect(e).then((function(){return a.applyConstraints(e.videoConstraint).then(r).catch(r)})).then((function(){return E.a.restoreVideoEffect(e)}))):r()},e.setVideoFrameRate=function(t){var n=h.report.reportApiInvoke(e.sid,{name:"Stream.setVideoFrameRate",options:arguments,tag:"tracer"});if(Object(o.isFireFox)())return n("FIREFOX_NOT_SUPPORTED"),!1;if("object"===w()(t)&&t instanceof Array&&t.length>1){e.videoConstraint=i()(e.videoConstraint,{frameRate:t[0]}),e.attributes.minFrameRate=t[0],e.attributes.maxFrameRate=t[1];var r=e.stream&&e.stream.getVideoTracks&&e.stream.getVideoTracks()[0];return r&&r.applyConstraints?(c.default.debug("setVideoFrameRate applyConstraints",e.videoConstraint),r.applyConstraints(e.videoConstraint).then(n).catch(n)):n(),!0}return n("INVALID_PARAM_".concat(JSON.stringify(t))),!1},e.setVideoBitRate=function(n){var r=h.report.reportApiInvoke(e.sid,{name:"Stream.setVideoBitRate",options:arguments,tag:"tracer"});return"object"===w()(n)&&n instanceof Array&&n.length>1?(t.attributes.minVideoBW=n[0],t.attributes.maxVideoBW=n[1],e.connectionSpec&&(e.connectionSpec.minVideoBW=n[0],e.connectionSpec.maxVideoBW=n[1]),e.pc&&e.pc.renegotiate&&e.pc.renegotiate(),r(),!0):(r("INVALID_PARAM_".concat(JSON.stringify(n))),!1)},e.setScreenBitRate=function(t){var n=h.report.reportApiInvoke(e.sid,{name:"Stream.setScreenBitRate",options:arguments,tag:"tracer"});return"object"===w()(t)&&t instanceof Array&&t.length>1?(e.screenAttributes.minVideoBW=t[0],e.screenAttributes.maxVideoBW=t[1],n(),!0):(n("INVALID_PARAM_".concat(JSON.stringify(t))),!1)},e.setScreenProfile=function(t){var n=h.report.reportApiInvoke(e.sid,{name:"Stream.setScreenProfile",options:arguments,tag:"tracer"});Object(y.checkValidEnum)(t,"profile",["480p_1","480p_2","720p_1","720p_2","1080p_1","1080p_2"]);var r=S(t);return r&&r.screen?(e.screenConstraint.mandatory?(e.screenConstraint.mandatory.maxWidth=r.screen.width,e.screenConstraint.mandatory.maxHeight=r.screen.height,r.screen.frameRate&&r.screen.frameRate.min&&r.screen.frameRate.max&&(e.screenConstraint.mandatory.minFrameRate=r.screen.frameRate.min,e.screenConstraint.mandatory.maxFrameRate=r.screen.frameRate.max)):e.screenConstraint=i()(e.screenConstraint,r.screen),e.screenAttributes.width=r.screen.width,e.screenAttributes.height=r.screen.height,e.screenAttributes.minFr=r.screen.frameRate.min,e.screenAttributes.maxFr=r.screen.frameRate.max,n(),!0):(n("NO_SCREEN_PROFILE_".concat(JSON.stringify(t))),!1)},e.setVideoProfileCustom=function(t){var n=h.report.reportApiInvoke(e.sid,{name:"Stream.setVideoProfileCustom",options:arguments,tag:"tracer"});e.setVideoResolution(t[0]),e.setVideoFrameRate([t[1],t[1]]),e.setVideoBitRate([t[2],t[2]]),n()},e.setVideoProfileCustomPlus=function(n){var r=h.report.reportApiInvoke(e.sid,{name:"Stream.setVideoProfileCustom",options:arguments,tag:"tracer"});e.setVideoResolution([n.width,n.height]),t.attributes.resolution="".concat(n.width,"x").concat(n.height),e.setVideoFrameRate([n.framerate,n.framerate]),e.setVideoBitRate([n.bitrate,n.bitrate]),r()},e.setVideoProfile=function(n){var r=h.report.reportApiInvoke(e.sid,{name:"Stream.setVideoProfile",options:arguments,tag:"tracer"}),a=S(n);if(!a){var s="Invalid Profile ".concat(n);throw new Error(s)}if(e.profile=n,a&&a.video){e.profile=a.profileName,e.videoConstraint=i()(e.videoConstraint,a.video),e.connectionSpec&&a.attributes.maxVideoBW&&(e.connectionSpec.minVideoBW=a.attributes.minVideoBW,e.connectionSpec.maxVideoBW=a.attributes.maxVideoBW),Object(o.isEdge)()&&(e.videoConstraint.frameRate.max=60),Object(o.isFireFox)()&&(e.videoConstraint.frameRate=30),t.attributes=i()(t.attributes,a.attributes),e.pc&&e.pc.renegotiate&&e.pc.renegotiate();var u=e.stream&&e.stream.getVideoTracks&&e.stream.getVideoTracks()[0];return u&&u.applyConstraints?(c.default.debug("setVideoProfile applyConstraints",e.videoConstraint),E.a.disableVideoEffect(e).then((function(){return u.applyConstraints(e.videoConstraint)})).then((function(){return E.a.restoreVideoEffect(e)})).then((function(t){return new Promise((function(n,i){r(t),setTimeout((function(){Object(g.vsResHack)(e.stream,(function(t,r){e.videoWidth=t,e.videoHeight=r,n()}),(function(t){c.default.warning("[".concat(e.streamId,"] vsResHack failed: "),t),i()}))}),2500)}))})).catch(r)):r(),!0}return r("INVALID_VIDEO_PROFILE_".concat(n)),!1},e.setAudioProfile=function(t){var n=h.report.reportApiInvoke(e.sid,{name:"Stream.setAudioProfile",options:arguments,tag:"tracer"});Object(y.checkValidEnum)(t,"profile",["speech_low_quality","speech_standard","music_standard","standard_stereo","high_quality","high_quality_stereo"]),e.audioProfile=t;var r=R(t);return e.highQuality=r.highQuality,e.stereo=r.stereo,e.speech=r.speech,e.lowQuality=r.lowQuality,e.stereo&&Object(o.isChrome)()&&(e.audioConstraint.googAutoGainControl=!1,e.audioConstraint.googAutoGainControl2=!1,e.audioConstraint.echoCancellation=!1,e.audioConstraint.googNoiseSuppression=!1),n(),!0},e.setVideoEncoderConfiguration=function(t){Object(y.checkValidObject)(t,"config");var n=h.report.reportApiInvoke(e.sid,{name:"Stream.setVideoEncoderConfiguration",options:t,tag:"tracer"});t.resolution&&(Object(y.checkValidNumber)(t.resolution.width,"config.resolution.width"),Object(y.checkValidNumber)(t.resolution.height,"config.resolution.height"),e.setVideoResolution([t.resolution.width,t.resolution.height])),t.frameRate&&(Object(y.checkValidNumber)(t.frameRate.min,"config.frameRate.min"),Object(y.checkValidNumber)(t.frameRate.max,"config.frameRate.max"),e.setVideoFrameRate([t.frameRate.min,t.frameRate.max])),t.bitrate&&(Object(y.checkValidNumber)(t.bitrate.min,"config.bitrate.min",1,1e7),Object(y.checkValidNumber)(t.bitrate.max,"config.bitrate.max",1,1e7),e.setVideoBitRate([t.bitrate.min,t.bitrate.max])),n()},e.getSupportedProfile=function(t){var n=h.report.reportApiInvoke(e.sid,{name:"Stream.getSupportedProfile",options:arguments,tag:"tracer",callback:t});if(!e.local){var r="ONLY_LOCAL_STREAM_SUPPORTED";return c.default.error(r),n(r)}if(!e.stream)return r="STREAM_NOT_INIT",c.default.error(r),n(r);if(!e.stream.getVideoTracks)return r="TRACK_NOT_SUPPORT",c.default.error(r),n(r);var i=e.stream.getVideoTracks()[0];if(!i)return r="NO_VIDEO_TRACK_FOUND",c.default.error(r),n(r);if(!i.getCapabilities)return r="GETCAPABILITY_NOT_SUPPORT",c.default.error(r),n(r);var o=i.getCapabilities(),a=T(o);return n(null,a)}}(t,e),t.getId=function(){return t.streamId},t.getUserId=function(){return t.userId},t.checkDualStreamEnabled=function(){return!(!Object(d.getParameter)("DUALSTREAM_OPERATION_CHECK")||!t.isDualStream)&&(c.default.error("Operation not permitted: ".concat("DUAL_STREAM_ENABLED")),"DUAL_STREAM_ENABLED")},t.setUserId=function(e){var n=h.report.reportApiInvoke(t.sid,{name:"Stream.setUserId",options:arguments,tag:"tracer"});t.userId&&c.default.warning("[".concat(t.streamId,"] Stream.userId ").concat(t.userId," => ").concat(e)),t.userId=e,n()},t.getAttributes=function(){return e.screen?t.screenAttributes:e.attributes},t.hasAudio=function(){return!!t.audio},t.hasVideo=function(){return!!t.video},t.hasScreen=function(){return!!t.screen},t.hasScreenAudio=function(){return!!t.screenAudio},t.isVideoOn=function(){return(t.hasVideo()||t.hasScreen())&&!t.userMuteVideo},t.isAudioOn=function(){return t.hasAudio()&&!t.userMuteAudio},t.init=function(r,i){var o=h.report.reportApiInvoke(t.sid,{callback:function(e,t){if(e)return i&&i(e);r&&r(t)},name:"Stream.init",options:arguments,tag:"tracer"}),a=((new Date).getTime(),arguments[2]);if(void 0===a&&(a=2),!0===t.initialized)return o({type:"warning",msg:"STREAM_ALREADY_INITIALIZED"});if(!0!==t.local)return o({type:"warning",msg:"STREAM_NOT_LOCAL"});var s=Math.random().toString().slice(3);t._streamInitID=s,t.videoSource?t.videoName="videoSource":t.video&&(t.videoName=m.a.searchDeviceNameById(e.cameraId)||"default"),t.audioSource?t.audioName="audioSource":t.audio&&(t.audioName=m.a.searchDeviceNameById(e.microphoneId)||"default"),t.screen&&(t.screenName=e.extensionId||"default");try{if(e.audio||e.video||e.screen||e.screenAudio||e.videoSource||e.audioSource){c.default.debug("[".concat(t.streamId,"] Requested access to local media"));var u={streamId:t.streamId};e.videoSource?u.videoSource=e.videoSource:e.screen?u.screen=t.screenConstraint:e.video&&(u.video=t.videoConstraint),e.audioSource?u.audioSource=e.audioSource:e.screenAudio?u.screenAudio=e.screenAudio:e.audio&&(u.audio=t.audioConstraint),Object(A.b)(u,(function(r){if(u.screenAudio&&!r.getAudioTracks()[0]&&c.default.warning("[".concat(t.streamId,"] Audio sharing is not selected")),u.screen&&c.default.debug("[".concat(t.streamId,"] User has granted access to screen sharing")),(u.video||u.audio)&&c.default.debug("[".concat(t.streamId,"] User has granted access to local media")),null===t._streamInitID){r.getTracks().forEach((function(e){e.stop()}));var i={type:"error",msg:"STREAM_IS_CLOSED",info:"stream is closed and cannot be initialized"};return c.default.error(t.streamId,i.info),void o(i)}if(t._streamInitID!==s)return r.getTracks().forEach((function(e){e.stop()})),i={type:"error",msg:"ABORT_OTHER_INIT",info:"stream initialization is aborted because of another stream.init"},c.default.error(t.streamId,i.info),void o(i);t.dispatchEvent({type:"accessAllowed"}),t.stream=r,t.initialized=!0,t.reloadDeviceName(),t.hasVideo()&&Object(g.vsResHack)(r,(function(e,n){t.videoWidth=e,t.videoHeight=n}),(function(e){c.default.warning("[".concat(t.streamId,"] vsResHack failed: "),e)})),e.screen&&t.stream&&t.stream.getVideoTracks()[0]&&(t.stream.getVideoTracks()[0].onended=function(){t.dispatchEvent({type:"stopScreenSharing"})}),t.stream&&t.stream.getTracks&&t.stream.getTracks().forEach((function(r){r&&!r.onended&&(r.onended=n),"video"===r.kind&&e.optimizationMode&&(r.contentHint=e.optimizationMode,r.contentHint===e.optimizationMode&&c.default.debug("[".concat(t.streamId,"] set content hint to"),e.optimizationMode))})),o()}),(function(e){var n={type:"error",info:null};switch(e&&(n.msg=e.name||e.code||e,e.message&&(n.info=e.message),e.code&&(n.info?n.info+=". "+e.code:n.info=" "+e.code),e.constraint&&(n.info?n.info+=". Constraint: "+e.constraint:n.info="constraint: "+e.constraint)),n.msg){case"Starting video failed":case"TrackStartError":if(t.videoConstraint&&(delete t.videoConstraint.width,delete t.videoConstraint.height),a>0)return void setTimeout((function(){t.init((function(e){return o(e)}),o,a-1)}),1);n.msg="MEDIA_OPTION_INVALID";break;case"DevicesNotFoundError":n.msg="DEVICES_NOT_FOUND";break;case"NotSupportedError":n.msg="NOT_SUPPORTED";break;case"PermissionDeniedError":case"InvalidStateError":n.msg="PERMISSION_DENIED",t.dispatchEvent({type:"accessDenied"});break;case"PERMISSION_DENIED":case"NotAllowedError":t.dispatchEvent({type:"accessDenied"});break;case"ConstraintNotSatisfiedError":n.msg="CONSTRAINT_NOT_SATISFIED";break;default:n.msg||(n.msg="UNDEFINED")}var r="Media access ".concat(n.msg).concat(n.info?": "+n.info:"");c.default.error("[".concat(t.streamId,"] "),r),o(n)}))}else o({type:"warning",msg:"STREAM_HAS_NO_MEDIA_ATTRIBUTES"})}catch(e){c.default.error("[".concat(t.streamId,"] Stream init: "),e),o({type:"error",msg:e.message||e})}},t.reloadDeviceName=function(){if(t.stream){if(t.stream.getVideoTracks){var e=t.stream.getVideoTracks()[0];e&&e.label&&(t.videoName=e.label)}if(t.stream.getAudioTracks){var n=t.stream.getAudioTracks()[0];n&&n.label&&(t.audioName=n.label)}}},t.close=function(){var e=h.report.reportApiInvoke(null,{name:"Stream.close",options:arguments,tag:"tracer"});if(c.default.debug("[".concat(t.streamId,"] Close stream with id"),t.streamId),t._originStream)try{t._originStream.getTracks().map((function(e){return e.stop()}))}catch(e){}if(void 0!==t.stream){var n=t.stream.getTracks();for(var r in n)n.hasOwnProperty(r)&&(n[r].stop(),n[r].onended=null);!t.isLowStream&&t.local?E.a.disableVideoEffect(t).then((function(){t.stream=void 0})):(t.stream&&t.stream.clean&&t.stream.clean(),t.stream=void 0)}if(t._originStream){for(var r in console.log("clear _originStream"),n=t._originStream.getTracks())n.hasOwnProperty(r)&&(n[r].stop(),n[r].onended=null,console.log("clear onended"));!t.isLowStream&&t.local?E.a.disableVideoEffect(t).then((function(){t._originStream=void 0})):(t._originStream&&t._originStream.clean&&t._originStream.clean(),t._originStream=void 0)}if(Object(o.isSafari)()&&t.pc&&t.pc.peerConnection&&t.pc.peerConnection.removeTrack&&t.pc.peerConnection.getSenders){var i=t.pc.peerConnection.getSenders();i.forEach((function(e){e&&(c.default.debug("[".concat(t.streamId,"] Remove Track"),e),t.pc.peerConnection.removeTrack(e))}))}t.local&&(t.initialized=!1),t._streamInitID=null,t._onAudioMute=void 0,t._onAudioUnmute=void 0,t._onVideoMute=void 0,t._onVideoUnmute=void 0,t.lowStream&&t.lowStream.close(),e()},t.enableAudio=function(){var e,n=h.report.reportApiInvoke(t.sid,{name:"Stream.enableAudio",options:arguments,tag:"tracer"});return c.default.deprecate("[".concat(t.streamId,"] Stream.enableAudio is deprecated and will be removed in the future. Use Stream.unmuteAudio instead")),t.userMuteAudio||c.default.warning("[".concat(t.streamId,"] User already enableAudio")),t.userMuteAudio=!1,n(null,e=!t.peerMuteAudio&&t._unmuteAudio()),e},t.disableAudio=function(){var e=h.report.reportApiInvoke(t.sid,{name:"Stream.disableAudio",options:arguments,tag:"tracer"});c.default.deprecate("[".concat(t.streamId,"] Stream.disableAudio is deprecated and will be removed in the future. Use Stream.muteAudio instead")),t.userMuteAudio&&c.default.warning("[".concat(t.streamId,"] User already disableAudio")),t.userMuteAudio=!0;var n=t._muteAudio();return e(null,n),n},t.enableVideo=function(){var e,n=h.report.reportApiInvoke(t.sid,{name:"Stream.enableVideo",options:arguments,tag:"tracer"});return c.default.deprecate("[".concat(t.streamId,"] Stream.enableVideo is deprecated and will be removed in the future. Use Stream.unmuteVideo instead")),t.userMuteVideo||c.default.warning("[".concat(t.streamId,"] User already enableVideo")),t.userMuteVideo=!1,t.lowStream&&(t.lowStream.userMuteVideo=!1),n(null,e=!t.peerMuteVideo&&t._unmuteVideo()),e},t.disableVideo=function(){var e=h.report.reportApiInvoke(t.sid,{name:"Stream.disableVideo",options:arguments,tag:"tracer"});c.default.deprecate("[".concat(t.streamId,"] Stream.disableVideo is deprecated and will be removed in the future. Use Stream.muteVideo instead")),t.userMuteVideo&&c.default.warning("[".concat(t.streamId,"] User already disableVideo")),t.userMuteVideo=!0,t.lowStream&&(t.lowStream.userMuteVideo=!0);var n=t._muteVideo();return e(null,n),n},t.unmuteAudio=function(){var e,n=h.report.reportApiInvoke(t.sid,{name:"Stream.unmuteAudio",options:arguments,tag:"tracer"});return t.userMuteAudio||c.default.warning("[".concat(t.streamId,"] User already unmuteAudio")),t.userMuteAudio=!1,n(null,e=!t.peerMuteAudio&&t._unmuteAudio()),e},t.muteAudio=function(){var e=h.report.reportApiInvoke(t.sid,{name:"Stream.muteAudio",options:arguments,tag:"tracer"});t.userMuteAudio&&c.default.warning("[".concat(t.streamId,"] User already muteAudio")),t.userMuteAudio=!0;var n=t._muteAudio();return e(null,n),n},t.unmuteVideo=function(){var e,n=h.report.reportApiInvoke(t.sid,{name:"Stream.unmuteVideo",options:arguments,tag:"tracer"});return t.userMuteVideo||c.default.warning("[".concat(t.streamId,"] User already unmuteVideo")),t.userMuteVideo=!1,t.lowStream&&(t.lowStream.userMuteVideo=!1),n(null,e=!t.peerMuteVideo&&t._unmuteVideo()),e},t.muteVideo=function(){var e=h.report.reportApiInvoke(t.sid,{name:"Stream.muteVideo",options:arguments,tag:"tracer"});t.userMuteVideo&&c.default.warning("[".concat(t.streamId,"] User already muteVideo")),t.userMuteVideo=!0,t.lowStream&&(t.lowStream.userMuteVideo=!0);var n=t._muteVideo();return e(null,n),n},t._unmuteAudio=function(){return c.default.debug("[".concat(t.streamId,"] Unmuted audio stream with id "),t.streamId),t._flushAudioMixingMuteStatus(!1),!(!t.hasAudio()||!t.initialized||void 0===t.stream||!0===t.stream.getAudioTracks()[0].enabled||(t._onAudioUnmute&&t._onAudioUnmute(),t.pc&&(t.pc.isAudioMute=!1),t.stream.getAudioTracks()[0].enabled=!0,0))},t._isAudioMuted=function(){if(t.stream&&t.hasAudio()){var e=t.stream.getAudioTracks();return e.length>0&&!e[0].enabled}return!1},t._isVideoMuted=function(){if(t.stream&&t.hasVideo()){var e=t.stream.getVideoTracks();return e.length>0&&!e[0].enabled}return!1},t._muteAudio=function(){return c.default.debug("[".concat(t.streamId,"] Muted audio stream with id "),t.streamId),t._flushAudioMixingMuteStatus(!0),!!(t.hasAudio()&&t.initialized&&void 0!==t.stream&&t.stream.getAudioTracks()[0].enabled)&&(t._onAudioMute&&t._onAudioMute(),t.pc&&(t.pc.isAudioMute=!0),t.stream.getAudioTracks()[0].enabled=!1,t.sid&&h.report.audioSendingStopped(t.sid,{succ:!0,reason:"muteAudio"}),!0)},t._unmuteVideo=function(){return c.default.debug("[".concat(t.streamId,"] Unmuted video stream with id"),t.streamId),!(!t.initialized||void 0===t.stream||!t.stream.getVideoTracks().length||!0===t.stream.getVideoTracks()[0].enabled||(t._onVideoUnmute&&t._onVideoUnmute(),t.pc&&(t.pc.isVideoMute=!1),t.stream.getVideoTracks()[0].enabled=!0,t.lowStream&&t.lowStream._unmuteVideo(),0))},t._muteVideo=function(){return c.default.debug("[".concat(t.streamId,"] Muted video stream with id"),t.streamId),!!(t.initialized&&void 0!==t.stream&&t.stream.getVideoTracks().length&&t.stream.getVideoTracks()[0].enabled)&&(t._onVideoMute&&t._onVideoMute(),t.pc&&(t.pc.isVideoMute=!0),t.stream.getVideoTracks()[0].enabled=!1,t.lowStream&&t.lowStream._muteVideo(),t.sid&&h.report.videoSendingStopped(t.sid,{succ:!0,reason:"muteVideo"}),!0)},t.addTrack=function(r){var i=h.report.reportApiInvoke(t.sid,{name:"Stream.addTrack",options:arguments,tag:"tracer"});if(t.pc&&t.pc.addTrack(r,t.stream),"audio"==r.kind){t._cleanupAudioMixing();var o=new MediaStream;t.userMuteAudio&&(r.enabled=!1),o.addTrack(r);var a=t.stream.getVideoTracks()[0];a&&o.addTrack(a),t.audio=!0,e.audio=!0,t.stream=o,t.audioLevelHelper=null,t.player&&t.player.video&&(t.player.video.srcObject=t.stream)}else t.userMuteVideo&&(r.enabled=!1),t.stream.addTrack(r),t.video=!0,e.video=!0;r.onended||(r.onended=n),i()},t.removeTrack=function(n){var r=h.report.reportApiInvoke(t.sid,{name:"Stream.removeTrack",options:arguments,tag:"tracer"});t.pc&&t.pc.removeTrack(n,t.stream),t.stream.removeTrack(n),t._cleanupAudioMixing(),"audio"===n.kind?(t.audio=!1,e.audio=!1):(t.video=!1,e.video=!1),t.audioLevelHelper=null,"live"==n.readyState&&(n.stop(),c.default.debug("[".concat(t.streamId,"] Track ").concat(n.kind," Stopped"))),r()},t.setAudioOutput=function(e,n,r){var i=h.report.reportApiInvoke(t.sid,{callback:function(e,t){if(e)return r&&r(e);n&&n(t)},name:"Stream.setAudioOutput",options:arguments,tag:"tracer"});return Object(y.isValidString)(e,1,255)?(t.audioOutput=e,t.player?void t.player.setAudioOutput(e,(function(){return i()}),i):i()):(c.default.error("[".concat(t.streamId,"] setAudioOutput Invalid Parameter"),e),i(l.default.INVALID_PARAMETER))},t.play=function(e,n,r){"function"==typeof n&&(r=n,n=null),c.default.debug("[".concat(t.streamId,"] play()."),e,n);var i=h.report.reportApiInvoke(t.sid,{name:"Stream.play",options:arguments,tag:"tracer",callback:r});if(Object(y.checkValidString)(e,"elementID"),Object(y.isEmpty)(n)||(Object(y.isEmpty)(n.fit)||Object(y.checkValidEnum)(n.fit,"fit",["cover","contain"]),Object(y.isEmpty)(n.muted)||Object(y.checkValidBoolean)(n.muted,"muted")),t.player)c.default.warning("[".concat(t.streamId,"] Stream.play(): Stream is already playing. Fallback to resume stream")),t.resume().then((function(){i(null)})).catch(i);else{t.elementID=e,t.playOptions=n,!t.local||t.video||t.screen?(t.player=new p({id:t.getId(),stream:t,elementID:e,options:n}),t.local&&E.a.applyEffectInPlayer(t)):t.hasAudio()&&(t.player=new p({id:t.getId(),stream:t,elementID:e,options:n}));var o={video:null,audio:null},a=function e(n){if(o[n.mediaType]=n,o.video&&o.audio)if(t.removeEventListener("player-status-change",e),o.video.isErrorState||o.audio.isErrorState){var r=o.video.isErrorState?o.video:o.audio;i({isErrorState:!0,status:r.status,reason:r.reason,video:o.video,audio:o.audio})}else"aborted"===o.video.status&&"aborted"===o.audio.status?i({status:"aborted",reason:"stop",video:o.video,audio:o.audio}):i(null)};t.on("player-status-change",a),t.audioOutput&&t.player.setAudioOutput(t.audioOutput),void 0!==t.audioLevel&&t.player.setAudioVolume(t.audioLevel),t._flushAudioMixingMuteStatus(!1)}},t.stop=function(){var e=h.report.reportApiInvoke(t.sid,{name:"Stream.stop",options:arguments,tag:"tracer"});c.default.debug("[".concat(t.streamId,"] Stop stream player with id "),t.streamId),t.player?(E.a.removeEffectFromLocalPlayer(t),t.player.destroy(),delete t.player):c.default.error("[".concat(t.streamId,"] Stream.stop(): Stream is not playing")),t._flushAudioMixingMuteStatus(!0),e()},t.isPlaying=function(){return!!t.player},t.isPaused=function(){return!!(t.player&&(t.player.video&&t.player.video.paused&&t.player.mediaElemExists(t.player.video)||t.player.audio&&t.player.audio.paused&&t.player.mediaElemExists(t.player.audio)))},t.resume=function(){var e,n;return t.player?(t.player.video&&t.player.video.play&&(e=t.player.video.play()),e=e||Promise.resolve(),t.player.audio&&t.player.audio.play&&(n=t.player.audio.play()),n=n||Promise.resolve(),Promise.all([e,n])):Promise.reject("NO_PLAYER_FOUND")},t.getVideoTrack=function(){var e=h.report.reportApiInvoke(t.sid,{name:"Stream.getVideoTrack",options:arguments,tag:"tracer"});if(t.stream&&t.stream.getVideoTracks){var n=t.stream.getVideoTracks()[0];if(n)return c.default.info("[".concat(t.streamId,"] getVideoTrack"),n),e(),n}c.default.info("[".concat(t.streamId,"] getVideoTrack None")),e(null,"getVideoTrack None")},t.getAudioTrack=function(){var e=h.report.reportApiInvoke(t.sid,{name:"Stream.getAudioTrack",options:arguments,tag:"tracer"});if(t.stream&&t.stream.getAudioTracks){var n=t.stream.getAudioTracks()[0];if(n)return c.default.info("[".concat(t.streamId,"] getAudioTracks"),n),e(),n}c.default.info("[".concat(t.streamId,"] getAudioTracks None")),e(null,"getAudioTracks None")},t._hasVideoTracks=function(){return!!(t.stream&&t.stream.getVideoTracks&&t.stream.getVideoTracks()[0])},t._hasAudioTracks=function(){return!!(t.stream&&t.stream.getAudioTracks&&t.stream.getAudioTracks()[0])},t._replaceMediaStreamTrack=function(e,n,r){if(t.stream){if("video"==e.kind){if(o=t.stream.getVideoTracks()[0])return t.userMuteVideo&&(e.enabled=!1),t.stream.removeTrack(o),t.stream.addTrack(e),c.default.debug("[".concat(t.streamId,"] _replaceMediaStreamTrack ").concat(e.kind," SUCCESS")),"live"==o.readyState&&(o.stop(),c.default.debug("[".concat(t.streamId,"] Track ").concat(o.kind," Stopped"))),n&&n();var i="MEDIASTREAM_TRACK_NOT_FOUND";return c.default.error("[".concat(t.streamId,"] MEDIASTREAM_TRACK_NOT_FOUND ").concat(e.kind)),r(i)}if("audio"==e.kind){var o;if(o=t.stream.getAudioTracks()[0]){t.userMuteAudio&&(e.enabled=!1);var a=new MediaStream;a.addTrack(e);var s=t.stream&&t.stream.getVideoTracks()[0];return s&&a.addTrack(s),t.stream=a,t.audioLevelHelper=null,t.player&&t.player.video&&(t.player.video.srcObject=t.stream),c.default.debug("[".concat(t.streamId,"] _replaceMediaStreamTrack SUCCESS")),"live"==o.readyState&&(o.stop(),c.default.debug("[".concat(t.streamId,"] Track ").concat(o.kind," Stopped"))),n&&n()}return i="MEDIASTREAM_TRACK_NOT_FOUND",c.default.error("[".concat(t.streamId,"] MEDIASTREAM_TRACK_NOT_FOUND ").concat(e.kind)),r(i)}return i="INVALID_TRACK_TYPE",c.default.error("[".concat(t.streamId,"] _replaceMediaStreamTrack ").concat(i," ").concat(e.kind)),r&&r(i)}return i="NO_STREAM_FOUND",c.default.error("[".concat(t.streamId,"] _replaceMediaStreamTrack ").concat(i)),r&&r(i)},t.replaceTrack=function(e,r,i){var o=h.report.reportApiInvoke(t.sid,{callback:function(e,t){if(e)return i&&i(e);r&&r(t)},name:"Stream.replaceTrack",options:arguments,tag:"tracer"});return e&&e.kind?(t._cleanupAudioMixing(),e.onended||(e.onended=n),t.pc&&t.pc.hasSender&&t.pc.hasSender(e.kind)?void t.pc.replaceTrack(e,(function(){return c.default.debug("[".concat(t.streamId,"] PeerConnection.replaceTrack ").concat(e.kind," SUCCESS")),t._replaceMediaStreamTrack(e,(function(e){return o(null,e)}),o)}),(function(n){return c.default.error("[".concat(t.streamId,"] PeerConnection.replaceTrack ").concat(e.kind," Failed ").concat(n)),o(n)})):t._replaceMediaStreamTrack(e,(function(e){return o(null,e)}),o)):o("INVALID_TRACK")},t.setAudioVolume=function(e){var n=h.report.reportApiInvoke(t.sid,{name:"Stream.setAudioVolume",options:arguments,tag:"tracer"});Object(y.checkValidNumber)(e,"level",0,100),t.audioLevel=e,t.player&&t.player.setAudioVolume(e),n()},t.getStats=function(e,n,r){var a=[];a.push(t._getPCStats(r)),a.push(new Promise((function(e){var n={};t.pc&&t.pc.isSubscriber?null!==window.navigator.userAgent.match("Firefox")&&(Object(v.b)(n,"videoReceiveResolutionHeight",t.videoHeight),Object(v.b)(n,"videoReceiveResolutionWidth",t.videoWidth)):t.pc&&!t.pc.isSubscriber&&((Object(o.isSafari)()||Object(o.isFireFox)())&&(Object(v.b)(n,"videoSendResolutionHeight",t.videoHeight),Object(v.b)(n,"videoSendResolutionWidth",t.videoWidth)),(Object(o.isSafari)()||Object(o.isFireFox)())&&t.uplinkStats&&Object(v.b)(n,"videoSendPacketsLost",t.uplinkStats.uplink_cumulative_lost)),e(n)}))),a.push(new Promise((function(e){var n={};return t.traffic_stats&&t.pc&&t.pc.isSubscriber?(Object(v.b)(n,"accessDelay",t.traffic_stats.access_delay),Object(v.b)(n,"endToEndDelay",t.traffic_stats.e2e_delay),Object(v.b)(n,"videoReceiveDelay",t.traffic_stats.video_delay),Object(v.b)(n,"audioReceiveDelay",t.traffic_stats.audio_delay)):t.traffic_stats&&t.pc&&!t.pc.isSubscriber&&Object(v.b)(n,"accessDelay",t.traffic_stats.access_delay),e(n)}))),Promise.all(a).then((function(n){for(var r={},o=n.length-1;o>=0;o--){var a=n[o];i()(r,a)}e&&setTimeout(e.bind(t,r),0)})).catch((function(e){n&&setTimeout(n.bind(t,e),0)}))},t._getPCStats=function(e){return new Promise((function(n,r){if(!t.pc||"established"!==t.pc.state||!t.pc.getStats)return r("PEER_CONNECTION_NOT_ESTABLISHED");t.pc.getStats((function(e){if(!t.pc||"established"!==t.pc.state||!t.pc.getStats)return r("PEER_CONNECTION_STATE_CHANGE");var i=t.pc.isSubscriber?Object(v.c)(e):Object(v.a)(e);return n(i)}),e)})).then((function(e){return t.pc.isSubscriber?(Object(o.isFireFox)()||Object(o.isSafari)())&&(e.videoReceiveResolutionHeight&&"0"!==e.videoReceiveResolutionHeight||e.videoReceiveResolutionWidth&&"0"!==e.videoReceiveResolutionWidth||(Object(v.b)(e,"videoReceiveResolutionHeight",t.videoHeight),Object(v.b)(e,"videoReceiveResolutionWidth",t.videoWidth))):((Object(o.isSafari)()||Object(o.isFireFox)())&&(e.videoSendResolutionHeight&&"0"!==e.videoSendResolutionHeight||e.videoSendResolutionWidth&&"0"!==e.videoSendResolutionWidth||(Object(v.b)(e,"videoSendResolutionHeight",t.videoHeight),Object(v.b)(e,"videoSendResolutionWidth",t.videoWidth))),(Object(o.isSafari)()||Object(o.isFireFox)())&&t.uplinkStats&&Object(v.b)(e,"videoSendPacketsLost",t.uplinkStats.uplink_cumulative_lost)),Promise.resolve(e)}))},t.getAudioLevel=function(){if(t.audioLevelHelper)return t.audioLevelHelper.getAudioLevel();if(t.stream){if(0!==t.stream.getAudioTracks().length)return t.audioLevelHelper=new g.audioLevelHelper(t.stream),t.audioLevelHelper.getAudioLevel();c.default.warning("[".concat(t.streamId,"] can't get audioLevel beacuse no audio trace in stream"))}else c.default.warning("[".concat(t.streamId,"] can't get audioLevel beacuse no stream exist"))},t.setVideoProfile("480p_1"),t._switchVideoDevice=function(e,n,r){if(e===t.cameraId)return n&&n();var a={video:i()({},t.videoConstraint,{deviceId:{exact:e}}),audio:!1};c.default.debug("[".concat(t.streamId,"] ").concat(a)),Object(A.b)(a,(function(i){try{var a=function(){t.isPlaying()&&(t.stop(),t.elementID&&t.play(t.elementID,t.playOptions)),t.cameraId=e,t.videoConstraint.deviceId={exact:e},t.userMuteVideo&&(t.stream.getVideoTracks()[0].enabled=!1),E.a.restoreVideoEffect(t).then((function(){n&&n()}))};E.a.disableVideoEffect(t).then((function(){Object(o.isSafari)()?t.replaceTrack(i.getVideoTracks()[0],a,r):(t.removeTrack(t.stream.getVideoTracks()[0]),t.addTrack(i.getVideoTracks()[0]),a())}))}catch(e){return r&&r(e)}}),(function(e){return r&&r(e)}))},t._switchAudioDevice=function(e,n,r){if(e===t.microphoneId)return n&&n();var a={video:!1,audio:i()({},t.audioConstraint,{deviceId:{exact:e}})};c.default.debug("[".concat(t.streamId,"] "),a),Object(A.b)(a,(function(i){var a=function(){t._cleanupAudioMixing(),t.userMuteAudio&&(t.stream.getAudioTracks()[0].enabled=!1),t.isPlaying()&&(t.stop(),t.elementID&&t.play(t.elementID,t.playOptions)),t.microphoneId=e,t.audioConstraint.deviceId={exact:e},n&&n()};try{Object(o.isSafari)()?t.replaceTrack(i.getAudioTracks()[0],a,r):(t.removeTrack(t.stream.getAudioTracks()[0]),t.addTrack(i.getAudioTracks()[0]),a())}catch(e){return r&&r(e)}}),(function(e){return r&&r(e)}))},t.switchDevice=function(e,n,r,i){var o=h.report.reportApiInvoke(t.sid,{callback:function(e,t){if(e)return i&&i(e);r&&r(t)},name:"Stream.switchDevice",options:arguments,tag:"tracer"});Object(y.checkValidString)(n,"deviceId");var a=function(){return t.inSwitchDevice=!1,o()},s=function(e){t.inSwitchDevice=!1,c.default.error("[".concat(t.streamId,"] "),e),o(e)};if(t.inSwitchDevice)return o("Device switch is in process.");if(t.inSwitchDevice=!0,!t.local)return s("Only the local stream can switch the device.");if(t.screen&&"video"===e)return s("The device cannot be switched during screen-sharing.");if(!t.video&&"video"===e)return s("Video track not exist.");if(!t.audio&&"audio"===e)return s("Audio track not exist.");if(t.videoSource||t.audioSource)return s("The device cannot be switched when using videoSource or audioSource.");var u=!1;for(var l in t.audioMixing.sounds){var d=t.audioMixing.sounds[l];if(d.state!==t.audioMixing.states.IDLE){u=!0;break}}var f=t.audioMixing.audioContextInited;if(f&&u)return s("The device cannot be switched when using audio Mixing.");m.a.getDeviceById(n,(function(){if("video"===e)t._switchVideoDevice(n,a,s);else{if("audio"!==e)return s("Invalid type.");t._switchAudioDevice(n,a,s)}}),(function(){return s("The device does not exist.")}))},t},I=function(e){var t=h.report.reportApiInvoke(null,{name:"createStream",options:arguments,tag:"tracer",getStates:function(){return{audioTrackEnable:e&&e.audioSource?e.audioSource.enabled:null,videoTrackEnable:e&&e.videoSource?e.videoSource.enabled:null}}});Object(y.checkValidObject)(e,"StreamSpec");var n=e.streamID,r=e.audio,i=e.video,o=e.screen,a=e.screenAudio,s=(e.audioSource,e.videoSource,e.cameraId),u=e.facingMode,l=e.microphoneId,d=e.mirror,f=e.extensionId,p=e.mediaSource,A=e.audioProcessing,v=e.optimizationMode;if(!Object(y.isEmpty)(n)&&!Object(g.is32Uint)(n)&&!Object(y.isValidString)(n,1,255))throw new Error("[String streamID] Length of the string: [1,255]. ASCII characters only. [Number streamID] The value range is Uint32");if(Object(y.checkValidBoolean)(r,"audio"),Object(y.checkValidBoolean)(i,"video"),Object(y.isEmpty)(o)||Object(y.checkValidBoolean)(o,"screen"),Object(y.isEmpty)(a)||Object(y.checkValidBoolean)(a,"screenAudio"),Object(y.isEmpty)(s)||Object(y.checkValidString)(s,"cameraId",0,255,!1),Object(y.isEmpty)(u)||Object(y.checkValidEnum)(u,"facingMode",["user","environment","left","right"]),Object(y.isEmpty)(l)||Object(y.checkValidString)(l,"microphoneId",0,255,!1),Object(y.isEmpty)(f)||Object(y.checkValidString)(f,"extensionId"),Object(y.isEmpty)(p)||Object(y.checkValidEnum)(p,"mediaSource",["screen","application","window"]),Object(y.isEmpty)(d)||Object(y.checkValidBoolean)(d,"mirror"),!Object(y.isEmpty)(A)){var m=A.AGC,b=A.AEC,E=A.ANS;Object(y.isEmpty)(m)||Object(y.checkValidBoolean)(m,"AGC"),Object(y.isEmpty)(b)||Object(y.checkValidBoolean)(b,"AEC"),Object(y.isEmpty)(E)||Object(y.checkValidBoolean)(E,"ANS")}Object(y.isEmpty)(v)||Object(y.checkValidEnum)(v,"optimizationMode",["detail","motion"]),c.default.debug("Create stream"),!0===a&&!0===r&&c.default.warning("Do not set both 'screenAudio' and 'audio' to true at the same time"),e.screen&&!v&&(e.optimizationMode="detail");var _=C(e);return t(),_}},function(e,t,n){"use strict";n.d(t,"a",(function(){return E})),n.d(t,"b",(function(){return _}));var r=n(4),i=n(7),o=n.n(i),a=n(13),s=n.n(a),c=n(17),u=n.n(c),l=n(0),d=n(15),h=n(3);function f(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=function(e,t){if(e){if("string"==typeof e)return p(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?p(e,t):void 0}}(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i,o=!0,a=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return o=e.done,e},e:function(e){a=!0,i=e},f:function(){try{o||null==r.return||r.return()}finally{if(a)throw i}}}}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function A(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=function(e,t){if(e){if("string"==typeof e)return g(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?g(e,t):void 0}}(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i,o=!0,a=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return o=e.done,e},e:function(e){a=!0,i=e},f:function(){try{o||null==r.return||r.return()}finally{if(a)throw i}}}}function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var v=n(47),m=n.n(v),y=n(26),b=(n(5),103),E=function(e){var t={};if(t.clientId=e.clientId,e.session_id=b+=1,"undefined"==typeof window||!window.navigator)throw l.default.error("["+t.streamId+"]["+t.clientId+"]Publish/subscribe video/audio streams not supported yet"),new Error("NON_BROWSER_ENV_DETECTED");return null!==window.navigator.userAgent.match("Firefox")?(t.browser="mozilla",t=function(e){var t={},n=(mozRTCPeerConnection,mozRTCSessionDescription),r=!1;t.uid=e.uid,t.isVideoMute=e.isVideoMute,t.isAudioMute=e.isAudioMute,t.isSubscriber=e.isSubscriber,t.clientId=e.clientId,t.filterStatsCache=[],t.originStatsCache=[],t.lastTimeGetStats=null,t.pc_config={iceServers:[]},e.iceServers instanceof Array?e.iceServers.map((function(e){0===e.url.indexOf("stun:")&&t.pc_config.iceServers.push({url:e.url})})):(e.stunServerUrl&&(e.stunServerUrl instanceof Array?e.stunServerUrl.map((function(e){"string"==typeof e&&""!==e&&t.pc_config.iceServers.push({url:e})})):"string"==typeof e.stunServerUrl&&""!==e.stunServerUrl&&t.pc_config.iceServers.push({url:e.stunServerUrl})),e.turnServers&&(e.turnServers instanceof Array?e.turnServers.map((function(e){e.udpport&&t.pc_config.iceServers.push({username:e.username,credential:e.credential,credentialType:"password",urls:(e.useTurns?"turns:":"turn:")+e.url+":"+e.udpport+"?transport=udp"}),"string"==typeof e.tcpport&&""!==e.tcpport&&t.pc_config.iceServers.push({username:e.username,credential:e.credential,credentialType:"password",urls:(e.useTurns?"turns:":"turn:")+e.url+":"+e.tcpport+"?transport=tcp"}),!0===e.forceturn&&(t.pc_config.iceTransportPolicy="relay")})):l.default.error("[".concat(t.clientId,"] turnServers is not a array")))),void 0===e.audio&&(e.audio=!0),void 0===e.video&&(e.video=!0),t.mediaConstraints={offerToReceiveAudio:e.audio,offerToReceiveVideo:e.video,mozDontOfferDataChannel:!0},t.roapSessionId=103,t.peerConnection=new d.RTCPeerConnection(t.pc_config),t.iceCandidateTimer=setTimeout((function(){t.iceCandidateTimer=null,l.default.debug("[".concat(t.clientId,"]Candidates collected: ").concat(t.iceCandidateCount)),t.moreIceComing&&(t.moreIceComing=!1,t.markActionNeeded())}),Object(h.getParameter)("CANDIDATE_TIMEOUT")),t.peerConnection.onicecandidate=function(e){var n,r,i,o;r=(n=t.peerConnection.localDescription.sdp).match(/a=candidate:.+typ\ssrflx.+\r\n/),i=n.match(/a=candidate:.+typ\shost.+\r\n/),o=n.match(/a=candidate:.+typ\srelay.+\r\n/),null===r&&null===i&&null===o||void 0!==t.ice||!t.iceCandidateTimer||(clearTimeout(t.iceCandidateTimer),t.iceCandidateTimer=null,t.ice=0,t.moreIceComing=!1,t.markActionNeeded()),t.iceCandidateCount=t.iceCandidateCount+1},t.checkMLineReverseInSDP=function(e){return!(!~e.indexOf("m=audio")||!~e.indexOf("m=video"))&&e.indexOf("m=audio")>e.indexOf("m=video")},t.reverseMLineInSDP=function(e){var t=e.split("m=audio"),n=t[1].split("m=video"),r="m=video"+n[1],i="m=audio"+n[0];return t[0]+r+i},t.processSignalingMessage=function(r){var i,o=JSON.parse(r);t.incomingMessage=o,"new"===t.state?"OFFER"===o.messageType?(o.sdp=v(o.sdp),i={sdp:o.sdp,type:"offer"},t.peerConnection.setRemoteDescription(new n(i),(function(){l.default.debug("["+t.clientId+"]setRemoteDescription succeeded")}),(function(e){l.default.info("["+t.clientId+"]setRemoteDescription failed: "+e.name)})),t.state="offer-received",t.markActionNeeded()):t.error("Illegal message for this state: "+o.messageType+" in state "+t.state):"offer-sent"===t.state?"ANSWER"===o.messageType?(o.sdp=v(o.sdp),o.sdp=o.sdp.replace(/ generation 0/g,""),o.sdp=o.sdp.replace(/ udp /g," UDP "),-1!==o.sdp.indexOf("a=group:BUNDLE")?(o.sdp=o.sdp.replace(/a=group:BUNDLE audio video/,"a=group:BUNDLE sdparta_0 sdparta_1"),o.sdp=o.sdp.replace(/a=mid:audio/,"a=mid:sdparta_0"),o.sdp=o.sdp.replace(/a=mid:video/,"a=mid:sdparta_1")):(o.sdp=o.sdp.replace(/a=mid:audio/,"a=mid:sdparta_0"),o.sdp=o.sdp.replace(/a=mid:video/,"a=mid:sdparta_0")),i={sdp:o.sdp,type:"answer"},e.screen&&"detail"===e.optimizationMode&&(l.default.debug("[".concat(t.client,"] remove screen share abs ext")),o.sdp=m(i.sdp)),t.peerConnection.setRemoteDescription(new n(i),(function(){l.default.debug("["+t.clientId+"]setRemoteDescription succeeded")}),(function(e){l.default.info("["+t.clientId+"]setRemoteDescription failed: "+e)})),t.state="established"):"pr-answer"===o.messageType?(i={sdp:o.sdp,type:"pr-answer"},t.peerConnection.setRemoteDescription(new n(i),(function(){l.default.debug("["+t.clientId+"]setRemoteDescription succeeded")}),(function(e){l.default.info("["+t.clientId+"]setRemoteDescription failed: "+e.name)}))):"offer"===o.messageType?t.error("Not written yet"):t.error("Illegal message for this state: "+o.messageType+" in state "+t.state):"established"===t.state&&("OFFER"===o.messageType?(i={sdp:o.sdp,type:"offer"},t.peerConnection.setRemoteDescription(new n(i),(function(){l.default.debug("["+t.clientId+"]setRemoteDescription succeeded")}),(function(e){l.default.info("["+t.clientId+"]setRemoteDescription failed: "+e.name)})),t.state="offer-received",t.markActionNeeded()):t.error("Illegal message for this state: "+o.messageType+" in state "+t.state))},t.setRtpSenderParameters=function(){var e=u()(s.a.mark((function e(n){var r,i,o;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.peerConnection.getSenders(),i=r.find((function(e){return"video"===e.track.kind}))){e.next=4;break}return e.abrupt("return");case 4:return(o=i.getParameters()).degradationPreference=n,e.prev=6,l.default.debug("[".concat(t.clientId,"] setParameters"),o),e.next=10,i.setParameters(o);case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(6),l.default.debug("[".concat(t.clientId,"] setParameters failed, ignore"));case 15:case"end":return e.stop()}}),e,null,[[6,12]])})));return function(t){return e.apply(this,arguments)}}();var i={id:"",type:"",mediaType:"opus",googCodecName:"opus",aecDivergentFilterFraction:"0",audioInputLevel:"0",bytesSent:"0",packetsSent:"0",googEchoCancellationReturnLoss:"0",googEchoCancellationReturnLossEnhancement:"0"},o={id:"",type:"",mediaType:"",googCodecName:e.codec?e.codec.toUpperCase():"",bytesSent:"0",packetsLost:"0",packetsSent:"0",googAdaptationChanges:"0",googAvgEncodeMs:"0",googEncodeUsagePercent:"0",googFirsReceived:"0",googFrameHeightSent:"0",googFrameHeightInput:"0",googFrameRateInput:"0",googFrameRateSent:"0",googFrameWidthSent:"0",googFrameWidthInput:"0",googNacksReceived:"0",googPlisReceived:"0",googRtt:"0"},a={id:"",type:"",mediaType:"",audioOutputLevel:"0",bytesReceived:"0",packetsLost:"0",packetsReceived:"0",googAccelerateRate:"0",googCurrentDelayMs:"0",googDecodingCNG:"0",googDecodingCTN:"0",googDecodingCTSG:"0",googDecodingNormal:"0",googDecodingPLC:"0",googDecodingPLCCNG:"0",googExpandRate:"0",googJitterBufferMs:"0",googJitterReceived:"0",googPreemptiveExpandRate:"0",googPreferredJitterBufferMs:"0",googSecondaryDecodedRate:"0",googSpeechExpandRate:"0"},c={id:"",type:"",mediaType:"",googTargetDelayMs:"0",packetsLost:"0",googDecodeMs:"0",googMaxDecodeMs:"0",googRenderDelayMs:"0",googFrameWidthReceived:"0",googFrameHeightReceived:"0",googFrameRateReceived:"0",googFrameRateDecoded:"0",googFrameRateOutput:"0",googJitterBufferMs:"0",googCurrentDelayMs:"0",googMinPlayoutDelayMs:"0",googNacksSent:"0",googPlisSent:"0",googFirsSent:"0",bytesReceived:"0",packetsReceived:"0",googFramesDecoded:"0"},f=0,p=0,g=0;t.getVideoRelatedStats=function(e){t.peerConnection.getStats().then((function(n){var r,i=A(n.values());try{for(i.s();!(r=i.n()).done;){var o=r.value;if(t.isSubscriber){if(("inbound-rtp"===o.type||"inboundrtp"===o.type)&&"video"===o.mediaType){if(!t.lastReport)return void(t.lastReport=o);e&&e({browser:"firefox",mediaType:"video",peerId:t.uid,isVideoMute:t.isVideoMute,frameRateReceived:Math.round(o.framerateMean)+"",frameRateDecoded:o.framesDecoded-t.lastReport.framesDecoded+"",bytesReceived:o.bytesReceived+"",packetsReceived:o.packetsReceived+"",packetsLost:o.packetsLost+""}),t.lastReport=o}}else if(("outbound-rtp"===o.type||"outboundrtp"===o.type)&&"video"===o.mediaType){if(!t.lastReport)return void(t.lastReport=o);e&&e({mediaType:"video",isVideoMute:t.isVideoMute,frameRateInput:Math.round(o.framerateMean)+"",frameRateSent:o.framesEncoded-t.lastReport.framesEncoded+""}),t.lastReport=o}}}catch(e){i.e(e)}finally{i.f()}}))},t.getAudioRelatedStats=function(e){t.peerConnection.getStats().then((function(n){var r,i=A(n.values());try{for(i.s();!(r=i.n()).done;){var o=r.value;t.isSubscriber&&("inbound-rtp"!==o.type&&"inboundrtp"!==o.type||"audio"!==o.mediaType||e&&e({browser:"firefox",mediaType:"audio",peerId:t.uid,isAudioMute:t.isAudioMute,frameDropped:o.packetsLost+"",frameReceived:o.packetsReceived+"",googJitterReceived:o.jitter+"",bytesReceived:o.bytesReceived+"",packetsReceived:o.packetsReceived+"",packetsLost:o.packetsLost+""}))}}catch(e){i.e(e)}finally{i.f()}}))},t.getStatsRate=function(e){t.getStats((function(t){t.forEach((function(e){})),e(t)}))},t.getStats=function(e,n){n=(n=n||500)>500?500:n,t.lastTimeGetStats&&Date.now()-t.lastTimeGetStats<n?e&&e(t.filterStatsCache,t.originStatsCache):this._getStats((function(n,r){t.filterStatsCache=n,t.originStatsCache=r,t.lastTimeGetStats=Date.now(),e&&e(n,r)}))},t._getStats=function(n){t.peerConnection.getStats().then((function(r){var s,u=[],l=A(r.values());try{for(l.s();!(s=l.n()).done;){var d=s.value;u.push(d),"outbound-rtp"!==d.type&&"outboundrtp"!==d.type||"video"!==d.mediaType||-1!==d.id.indexOf("rtcp")||(o.id=d.id,o.type=d.type,o.mediaType=d.mediaType,o.bytesSent=d.bytesSent?d.bytesSent+"":"0",o.packetsSent=d.packetsSent?d.packetsSent+"":"0",o.googPlisReceived=d.pliCount?d.pliCount+"":"0",o.googNacksReceived=d.nackCount?d.nackCount+"":"0",o.googFirsReceived=d.firCount?d.firCount+"":"0",o.googFrameRateSent=d.framerateMean?Math.round(d.framerateMean)+"":"0"),"outbound-rtp"!==d.type&&"outboundrtp"!==d.type||"audio"!==d.mediaType||-1!==d.id.indexOf("rtcp")||(i.id=d.id,i.type=d.type,i.mediaType=d.mediaType,i.bytesSent=d.bytesSent?d.bytesSent+"":"0",i.packetsSent=d.packetsSent?d.packetsSent+"":"0",e.agoraStream.local&&(i.audioInputLevel=Math.round(32767*e.agoraStream.getAudioLevel()).toString())),"inbound-rtp"!==d.type&&"inboundrtp"!==d.type||"audio"!==d.mediaType||d.isRemote||-1!==d.id.indexOf("rtcp")||(a.id=d.id,a.type=d.type,a.mediaType=d.mediaType,a.bytesReceived=d.bytesReceived?d.bytesReceived+"":"0",a.packetsLost=d.packetsLost?d.packetsLost+"":"0",a.packetsReceived=d.packetsReceived?d.packetsReceived+"":"0",a.googJitterReceived=d.jitter?d.jitter+"":"0",e.agoraStream.local||(a.audioOutputLevel=Math.round(32767*e.agoraStream.getAudioLevel()).toString())),"inbound-rtp"!==d.type&&"inboundrtp"!==d.type||"video"!==d.mediaType||d.isRemote||-1!==d.id.indexOf("rtcp")||(c.id=d.id,c.type=d.type,c.mediaType=d.mediaType,c.bytesReceived=d.bytesReceived?d.bytesReceived+"":"0",c.googFrameRateReceived=d.framerateMean?Math.round(d.framerateMean)+"":"0",c.googFramesDecoded=d.framesDecoded?d.framesDecoded+"":"0",Date.now()-g>=1e3?(c.googFrameRateDecoded=(d.framesDecoded-f)/((Date.now()-g)/1e3),c.googFrameRateDecoded=Math.round(Math.max(0,c.googFrameRateDecoded)),g=Date.now(),p=c.googFrameRateDecoded,f=d.framesDecoded,c.googFrameRateDecoded=c.googFrameRateDecoded.toString()):c.googFrameRateDecoded=p.toString(),c.packetsLost=d.packetsLost?d.packetsLost+"":"0",c.packetsReceived=d.packetsReceived?d.packetsReceived+"":"0",c.googJitterBufferMs=d.jitter?d.jitter+"":"0",c.googNacksSent=d.nackCount?d.nackCount+"":"0",c.googPlisSent=d.pliCount?d.pliCount+"":"0",c.googFirsSent=d.firCount?d.firCount+"":"0"),-1!==d.id.indexOf("outbound_rtcp_video")&&(o.packetsLost=d.packetsLost?d.packetsLost+"":"0")}}catch(e){l.e(e)}finally{l.f()}var h=[o,i,a,c];h.push({id:"time",startTime:t.connectedTime,timestamp:new Date}),n(h,u)}),(function(e){l.default.error("["+t.clientId+"]"+e)}))},t.addStream=function(e){r=!0,t.peerConnection.addStream(e),t.markActionNeeded()},t.removeStream=function(){t.markActionNeeded()},t.close=function(){t.state="closed",t.peerConnection.close()},t.markActionNeeded=function(){t.actionNeeded=!0,t.doLater((function(){t.onstablestate()}))},t.doLater=function(e){window.setTimeout(e,1)},t.onstablestate=function(){if(t.actionNeeded){if("new"===t.state||"established"===t.state)r&&(t.mediaConstraints=void 0),t.peerConnection.createOffer((function(e){if(e.sdp=v(e.sdp),e.sdp=e.sdp.replace(/a=extmap:1 http:\/\/www.webrtc.org\/experiments\/rtp-hdrext\/abs-send-time/,"a=extmap:3 http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time"),e.sdp!==t.prevOffer)return t.peerConnection.setLocalDescription(e),t.state="preparing-offer",void t.markActionNeeded();l.default.debug("["+t.clientId+"]Not sending a new offer")}),(function(e){l.default.debug("["+t.clientId+"]Ups! create offer failed ",e)}),t.mediaConstraints);else if("preparing-offer"===t.state){if(t.moreIceComing)return;t.prevOffer=t.peerConnection.localDescription.sdp,t.offerCandidates=t.prevOffer.match(/a=candidate.+\r\n/g)||[],t.offerCandidates.length||(l.default.warning("[".concat(t.clientId,"]No Ice Candidate generated")),Object(h.getParameter)("SHIM_CANDIDATE")?(l.default.debug("Shimming fake candidate"),t.prevOffer+="a=candidate:2243255435 1 udp 2122194687 192.168.0.1 30000 typ host generation 0 network-id 1\r\n"):l.default.error("[".concat(t.clientId,"]None Ice Candidate not allowed"))),t.prevOffer=t.prevOffer.replace(/a=candidate:.+typ\shost.+\r\n/g,"a=candidate:2243255435 1 udp 2122194687 192.168.0.1 30000 typ host generation 0 network-id 1\r\n"),t.sendMessage("OFFER",t.prevOffer),t.state="offer-sent"}else if("offer-received"===t.state)t.peerConnection.createAnswer((function(e){if(t.peerConnection.setLocalDescription(e),t.state="offer-received-preparing-answer",t.iceStarted)t.markActionNeeded();else{var n=new Date;l.default.debug("["+t.clientId+"]"+n.getTime()+": Starting ICE in responder"),t.iceStarted=!0}}),(function(){l.default.debug("["+t.clientId+"]Ups! Something went wrong")}));else if("offer-received-preparing-answer"===t.state){if(t.moreIceComing)return;var e=t.peerConnection.localDescription.sdp;t.sendMessage("ANSWER",e),t.state="established"}else t.debug("Dazed and confused in state "+t.state+", stopping here");t.actionNeeded=!1}},t.sendMessage=function(e,n){var r={};r.messageType=e,r.sdp=n,"OFFER"===e?(r.offererSessionId=t.sessionId,r.answererSessionId=t.otherSessionId,r.seq=t.sequenceNumber+=1,r.tiebreaker=Math.floor(429496723*Math.random()+1)):(r.offererSessionId=t.incomingMessage.offererSessionId,r.answererSessionId=t.sessionId,r.seq=t.incomingMessage.seq),t.onsignalingmessage(JSON.stringify(r))},t._getSender=function(e){if(t.peerConnection&&t.peerConnection.getSenders){var n=t.peerConnection.getSenders().find((function(t){return t.track.kind==e}));if(n)return n}return null},t.hasSender=function(e){return!!t._getSender(e)},t.replaceTrack=function(e,n,r){var i=t._getSender(e.kind);if(!i)return r("NO_SENDER_FOUND");try{i.replaceTrack(e)}catch(e){return r&&r(e)}setTimeout((function(){return n&&n()}),50)},t.error=function(e){throw"Error in RoapOnJsep: "+e},t.sessionId=t.roapSessionId+=1,t.sequenceNumber=0,t.actionNeeded=!1,t.iceStarted=!1,t.moreIceComing=!0,t.iceCandidateCount=0,t.onsignalingmessage=e.callback,t.peerConnection.ontrack=function(e){t.onaddstream&&t.onaddstream(e,"ontrack")},t.peerConnection.onremovestream=function(e){t.onremovestream&&t.onremovestream(e)},t.peerConnection.oniceconnectionstatechange=function(e){"connected"===e.currentTarget.iceConnectionState&&(t.connectedTime=new Date),t.oniceconnectionstatechange&&t.oniceconnectionstatechange(e.currentTarget.iceConnectionState)};var v=function(t){var n;if(e.video&&e.maxVideoBW&&(null==(n=t.match(/m=video.*\r\n/))&&(n=t.match(/m=video.*\n/)),n&&n.length>0)){var r=n[0]+"b=TIAS:"+1e3*e.maxVideoBW+"\r\n";t=t.replace(n[0],r)}return e.audio&&e.maxAudioBW&&(null==(n=t.match(/m=audio.*\r\n/))&&(n=t.match(/m=audio.*\n/)),n&&n.length>0)&&(r=n[0]+"b=TIAS:"+1e3*e.maxAudioBW+"\r\n",t=t.replace(n[0],r)),t},m=function(e){return(e=e.replace(/a=.*abs-send-time\r\n/g,"")).replace(/a=.*goog-remb\r\n/g,"")};return t.onaddstream=null,t.onremovestream=null,t.state="new",t.markActionNeeded(),t}(e)):"iOS"===r.getBrowserOS()||r.isSafari()?(l.default.debug("["+t.streamId+"]["+t.clientId+"]Safari"),(t=function(e){var t={},n=d.RTCPeerConnection;t.uid=e.uid,t.isVideoMute=e.isVideoMute,t.isAudioMute=e.isAudioMute,t.isSubscriber=e.isSubscriber,t.clientId=e.clientId,t.filterStatsCache=[],t.originStatsCache=[],t.lastTimeGetStats=null,t.pc_config={iceServers:[{urls:["stun:webcs.agora.io:3478","stun:stun.l.google.com:19302"]}],bundlePolicy:"max-bundle"},t.con={optional:[{DtlsSrtpKeyAgreement:!0}]},e.iceServers instanceof Array?t.pc_config.iceServers=e.iceServers:(e.stunServerUrl&&(e.stunServerUrl instanceof Array?e.stunServerUrl.map((function(e){"string"==typeof e&&""!==e&&t.pc_config.iceServers.push({url:e})})):"string"==typeof e.stunServerUrl&&""!==e.stunServerUrl&&t.pc_config.iceServers.push({url:e.stunServerUrl})),e.turnServers&&(e.turnServers instanceof Array?e.turnServers.map((function(e){e.udpport&&t.pc_config.iceServers.push({username:e.username,credential:e.credential,credentialType:"password",urls:(e.useTurns?"turns:":"turn:")+e.url+":"+e.udpport+"?transport=udp"}),"string"==typeof e.tcpport&&""!==e.tcpport&&t.pc_config.iceServers.push({username:e.username,credential:e.credential,credentialType:"password",urls:(e.useTurns?"turns:":"turn:")+e.url+":"+e.tcpport+"?transport=tcp"}),!0===e.forceturn&&(t.pc_config.iceTransportPolicy="relay")})):l.default.error("[".concat(t.clientId,"] turnServers is not a array")))),void 0===e.audio&&(e.audio=!0),void 0===e.video&&(e.video=!0),t.mediaConstraints={mandatory:{OfferToReceiveVideo:e.video,OfferToReceiveAudio:e.audio}},t.roapSessionId=103;try{t.pc_config.sdpSemantics="plan-b",t.peerConnection=new n(t.pc_config,t.con)}catch(e){delete t.pc_config.sdpSemantics,t.peerConnection=new n(t.pc_config,t.con)}t.iceCandidateTimer=setTimeout((function(){t.iceCandidateTimer=null,t.moreIceComing&&(t.moreIceComing=!1,t.markActionNeeded())}),Object(h.getParameter)("CANDIDATE_TIMEOUT")),t.peerConnection.onicecandidate=function(e){var n,r,i,o;r=(n=t.peerConnection.localDescription.sdp).match(/a=candidate:.+typ\ssrflx.+\r\n/),i=n.match(/a=candidate:.+typ\shost.+\r\n/),o=n.match(/a=candidate:.+typ\srelay.+\r\n/),0===t.iceCandidateCount&&(t.timeout=setTimeout((function(){t.moreIceComing&&(t.moreIceComing=!1,t.markActionNeeded())}),1e3)),null===r&&null===i&&null===o||void 0!==t.ice||!t.iceCandidateTimer||(clearTimeout(t.iceCandidateTimer),t.iceCandidateTimer=null,t.ice=0,t.moreIceComing=!1,t.markActionNeeded()),t.iceCandidateCount=t.iceCandidateCount+1};var r=function(t){return e.screen&&(t=t.replace("a=x-google-flag:conference\r\n","")),t},i=function(n){var r,i;return(r=n.match(/m=video.*\r\n/))&&e.minVideoBW&&e.maxVideoBW&&(i=r[0]+"b=AS:"+e.maxVideoBW+"\r\n",n=n.replace(r[0],i),l.default.debug("["+t.clientId+"]Set Video Bitrate - min:"+e.minVideoBW+" max:"+e.maxVideoBW)),(r=n.match(/m=audio.*\r\n/))&&e.maxAudioBW&&(i=r[0]+"b=AS:"+e.maxAudioBW+"\r\n",n=n.replace(r[0],i)),n};t.processSignalingMessage=function(n){var o,a=JSON.parse(n);t.incomingMessage=a,"new"===t.state?"OFFER"===a.messageType?(o={sdp:a.sdp,type:"offer"},t.peerConnection.setRemoteDescription(new RTCSessionDescription(o)),t.state="offer-received",t.markActionNeeded()):t.error("Illegal message for this state: "+a.messageType+" in state "+t.state):"offer-sent"===t.state?"ANSWER"===a.messageType?((o={sdp:a.sdp,type:"answer"}).sdp=r(o.sdp),o.sdp=i(o.sdp),o.sdp=o.sdp.replace(/a=x-google-flag:conference\r\n/g,""),e.screen&&"detail"===e.optimizationMode&&(l.default.debug("[".concat(t.client,"] remove screen share abs ext")),o.sdp=o.sdp.replace(/a=.*abs-send-time\r\n/g,"").replace(/a=.*goog-remb\r\n/g,"")),t.peerConnection.setRemoteDescription(new RTCSessionDescription(o)),t.state="established"):"pr-answer"===a.messageType?(o={sdp:a.sdp,type:"pr-answer"},t.peerConnection.setRemoteDescription(new RTCSessionDescription(o))):"offer"===a.messageType?t.error("Not written yet"):t.error("Illegal message for this state: "+a.messageType+" in state "+t.state):"established"===t.state&&("OFFER"===a.messageType?(o={sdp:a.sdp,type:"offer"},t.peerConnection.setRemoteDescription(new RTCSessionDescription(o)),t.state="offer-received",t.markActionNeeded()):"ANSWER"===a.messageType?((o={sdp:a.sdp,type:"answer"}).sdp=r(o.sdp),o.sdp=i(o.sdp),t.peerConnection.setRemoteDescription(new RTCSessionDescription(o))):t.error("Illegal message for this state: "+a.messageType+" in state "+t.state))},t.setRtpSenderParameters=function(){var e=u()(s.a.mark((function e(n){var r,i,o;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.peerConnection.getSenders(),i=r.find((function(e){return"video"===e.track.kind}))){e.next=4;break}return e.abrupt("return");case 4:return(o=i.getParameters()).degradationPreference=n,e.prev=6,l.default.debug("[".concat(t.clientId,"] setParameters"),o),e.next=10,i.setParameters(o);case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(6),l.default.debug("[".concat(t.clientId,"] setParameters failed, ignore"));case 15:case"end":return e.stop()}}),e,null,[[6,12]])})));return function(t){return e.apply(this,arguments)}}();var o={id:"",type:"",mediaType:"",googCodecName:"opus",aecDivergentFilterFraction:"0",audioInputLevel:"0",bytesSent:"0",packetsSent:"0",googEchoCancellationReturnLoss:"0",googEchoCancellationReturnLossEnhancement:"0"},a={id:"",type:"",mediaType:"",googCodecName:e.codec?e.codec.toUpperCase():"",bytesSent:"0",packetsLost:"0",packetsSent:"0",googAdaptationChanges:"0",googAvgEncodeMs:"0",googEncodeUsagePercent:"0",googFirsReceived:"0",googFrameHeightSent:"0",googFrameHeightInput:"0",googFrameRateInput:"0",googFrameRateSent:"0",googFrameWidthSent:"0",googFrameWidthInput:"0",googNacksReceived:"0",googPlisReceived:"0",googRtt:"0",googFramesEncoded:"0"},c={id:"",type:"",mediaType:"",audioOutputLevel:"0",bytesReceived:"0",packetsLost:"0",packetsReceived:"0",googAccelerateRate:"0",googCurrentDelayMs:"0",googDecodingCNG:"0",googDecodingCTN:"0",googDecodingCTSG:"0",googDecodingNormal:"0",googDecodingPLC:"0",googDecodingPLCCNG:"0",googExpandRate:"0",googJitterBufferMs:"0",googJitterReceived:"0",googPreemptiveExpandRate:"0",googPreferredJitterBufferMs:"0",googSecondaryDecodedRate:"0",googSpeechExpandRate:"0"},f={id:"",type:"",mediaType:"",googTargetDelayMs:"0",packetsLost:"0",googDecodeMs:"0",googMaxDecodeMs:"0",googRenderDelayMs:"0",googFrameWidthReceived:"0",googFrameHeightReceived:"0",googFrameRateReceived:"0",googFrameRateDecoded:"0",googFrameRateOutput:"0",googFramesDecoded:"0",googFrameReceived:"0",googJitterBufferMs:"0",googCurrentDelayMs:"0",googMinPlayoutDelayMs:"0",googNacksSent:"0",googPlisSent:"0",googFirsSent:"0",bytesReceived:"0",packetsReceived:"0"},p={id:"bweforvideo",type:"VideoBwe",googAvailableSendBandwidth:"0",googAvailableReceiveBandwidth:"0",googActualEncBitrate:"0",googRetransmitBitrate:"0",googTargetEncBitrate:"0",googBucketDelay:"0",googTransmitBitrate:"0"},A=0,g=0,v=0;return t.isRemoteVideoStats=function(e){return!!(e.frameHeight&&e.frameWidth&&e.remoteSource)},t.getVideoRelatedStats=function(n){t.peerConnection.getStats().then((function(r){r.forEach((function(r){if(t.isSubscriber){var i={peerId:t.uid,mediaType:"video",isVideoMute:t.isVideoMute};if("track"===r.type&&(~r.id.indexOf("video")||~r.trackIdentifier.indexOf("v")||t.isRemoteVideoStats(r))){if(!t.lastReport)return void(t.lastReport=r);i.frameRateReceived=r.framesReceived-t.lastReport.framesReceived+"",i.frameRateDecoded=r.framesDecoded-t.lastReport.framesDecoded+"",t.lastReport=r}"inbound-rtp"===r.type&&~r.id.indexOf("Video")&&(i.bytesReceived=r.bytesReceived+"",i.packetsReceived=r.packetsReceived+"",i.packetsLost=r.packetsLost+""),n&&n(i)}else if("outbound-rtp"===r.type&&~r.id.indexOf("Video")){if(!t.lastReport)return void(t.lastReport=r);n&&n({mediaType:"video",isVideoMute:t.isVideoMute,frameRateInput:e.maxFrameRate+"",frameRateSent:r.framesEncoded-t.lastReport.framesEncoded+""}),t.lastReport=r}}))}))},t.getAudioRelatedStats=function(e){t.peerConnection.getStats().then((function(n){n.forEach((function(n){t.isSubscriber&&"inbound-rtp"===n.type&&~n.id.indexOf("Audio")&&e&&e({peerId:t.uid,mediaType:"audio",isAudioMute:t.isAudioMute,frameDropped:n.packetsLost+"",frameReceived:n.packetsReceived+"",googJitterReceived:n.jitter+"",bytesReceived:n.bytesReceived+"",packetsReceived:n.packetsReceived+"",packetsLost:n.packetsLost+""})}))}))},t.getStatsRate=function(e){t.getStats((function(t){t.forEach((function(e){"outbound-rtp"===e.type&&"video"===e.mediaType&&e.googFramesEncoded&&(e.googFrameRateSent=Math.ceil((e.googFramesEncoded-A)/3).toString(),A=e.googFramesEncoded),"inbound-rtp"===e.type&&-1!=e.id.indexOf("55543")&&(e.googFrameRateReceived&&(e.googFrameRateReceived=Math.ceil((e.googFrameReceived-v)/3).toString(),v=e.googFrameReceived),e.googFrameRateDecoded&&(e.googFrameRateDecoded=Math.ceil((e.googFramesDecoded-g)/3).toString(),g=e.googFramesDecoded))})),e(t)}))},t.getStats=function(e,n){n=(n=n||500)>500?500:n,t.lastTimeGetStats&&Date.now()-t.lastTimeGetStats<n?e&&e(t.filterStatsCache,t.originStatsCache):this._getStats((function(n,r){t.filterStatsCache=n,t.originStatsCache=r,t.lastTimeGetStats=Date.now(),e&&e(n,r)}))},t._getStats=function(n){var r=[];t.peerConnection.getStats().then((function(i){i.forEach((function(t){var n;r.push(t),"outbound-rtp"===t.type&&"audio"===t.mediaType&&(o.id=t.id,o.type=t.type,o.mediaType=t.mediaType,o.bytesSent=t.bytesSent?t.bytesSent+"":"0",o.packetsSent=t.packetsSent?t.packetsSent+"":"0",e.agoraStream.local&&(o.audioInputLevel=Math.round(32767*e.agoraStream.getAudioLevel()).toString())),"outbound-rtp"===t.type&&"video"===t.mediaType&&(a.id=t.id,a.type=t.type,a.mediaType=t.mediaType,a.bytesSent=t.bytesSent?t.bytesSent+"":"0",a.packetsSent=t.packetsSent?t.packetsSent+"":"0",a.googPlisReceived=t.pliCount?t.pliCount+"":"0",a.googNacksReceived=t.nackCount?t.nackCount+"":"0",a.googFirsReceived=t.firCount?t.firCount+"":"0",a.googFramesEncoded=t.framesEncoded?t.framesEncoded+"":"0",(n=i.get(t.trackId))&&(a.googFrameHeightSent=n.frameHeight&&n.frameHeight.toString(),a.googFrameWidthSent=n.frameWidth&&n.frameWidth.toString())),"inbound-rtp"!==t.type||-1==t.id.indexOf("44444")&&"audio"!==t.mediaType||(c.id=t.id,c.type=t.type,c.mediaType="audio",c.packetsReceived=t.packetsReceived?t.packetsReceived+"":"0",c.bytesReceived=t.bytesReceived?t.bytesReceived+"":"0",c.packetsLost=t.packetsLost?t.packetsLost+"":"0",c.packetsReceived=t.packetsReceived?t.packetsReceived+"":"0",c.googJitterReceived=t.jitter?t.jitter+"":"0",(n=i.get(t.trackId))&&(c.audioOutputLevel=n.audioLevel&&Math.round(32767*n.audioLevel).toString()),e.agoraStream.local||c.audioOutputLevel||(c.audioOutputLevel=Math.round(32767*e.agoraStream.getAudioLevel()).toString())),"inbound-rtp"!==t.type||-1==t.id.indexOf("55543")&&"video"!==t.mediaType||(f.id=t.id,f.type=t.type,f.mediaType="video",f.packetsReceived=t.packetsReceived?t.packetsReceived+"":"0",f.bytesReceived=t.bytesReceived?t.bytesReceived+"":"0",f.packetsLost=t.packetsLost?t.packetsLost+"":"0",f.googJitterBufferMs=t.jitter?t.jitter+"":"0",f.googNacksSent=t.nackCount?t.nackCount+"":"0",f.googPlisSent=t.pliCount?t.pliCount+"":"0",f.googFirsSent=t.firCount?t.firCount+"":"0",(n=i.get(t.trackId))&&(f.googFrameHeightReceived=n.frameHeight&&n.frameHeight.toString(),f.googFrameWidthReceived=n.frameWidth&&n.frameWidth.toString(),f.googFrameReceived=n.framesReceived&&n.framesReceived.toString(),f.googFramesDecoded=n.framesDecoded&&n.framesDecoded.toString())),"candidate-pair"===t.type&&(0==t.availableIncomingBitrate?p.googAvailableSendBandwidth=t.availableOutgoingBitrate+"":p.googAvailableReceiveBandwidth=t.availableIncomingBitrate+"")}));var s=[p,o,a,c,f];s.push({id:"time",startTime:t.connectedTime,timestamp:new Date}),n(s,r)})).catch((function(e){l.default.error("["+t.clientId+"] ",e)}))},t.addTrack=function(e,n){t.peerConnection.addTrack(e,n)},t.removeTrack=function(e,n){var r=t.peerConnection.getSenders().find((function(t){return t.track==e}));r.replaceTrack(null),t.peerConnection.removeTrack(r)},t.addStream=function(e){window.navigator.userAgent.indexOf("Safari")>-1&&-1===navigator.userAgent.indexOf("Chrome")?e.getTracks().forEach((function(n){return t.peerConnection.addTrack(n,e)})):t.peerConnection.addStream(e),t.markActionNeeded()},t.removeStream=function(){t.markActionNeeded()},t.close=function(){t.state="closed",t.peerConnection.close()},t.markActionNeeded=function(){t.actionNeeded=!0,t.doLater((function(){t.onstablestate()}))},t.doLater=function(e){window.setTimeout(e,1)},t.onstablestate=function(){var n;if(t.actionNeeded){if("new"===t.state||"established"===t.state)e.isSubscriber&&(t.peerConnection.addTransceiver("audio",{direction:"recvonly"}),t.peerConnection.addTransceiver("video",{direction:"recvonly"})),t.peerConnection.createOffer(t.mediaConstraints).then((function(n){if(n.sdp=i(n.sdp),e.isSubscriber||(n.sdp=n.sdp.replace(/a=.*video-orientation\r\n/g,"")),n.sdp!==t.prevOffer)return t.peerConnection.setLocalDescription(n),t.state="preparing-offer",void t.markActionNeeded();l.default.debug("["+t.clientId+"]Not sending a new offer")})).catch((function(e){l.default.debug("["+t.clientId+"]peer connection create offer failed ",e)}));else if("preparing-offer"===t.state){if(t.moreIceComing)return;t.prevOffer=t.peerConnection.localDescription.sdp,t.offerCandidates=t.prevOffer.match(/a=candidate.+\r\n/g)||[],t.offerCandidates.length||(l.default.warning("[".concat(t.clientId,"]No Ice Candidate generated")),Object(h.getParameter)("SHIM_CANDIDATE")?(l.default.debug("Shimming fake candidate"),t.prevOffer+="a=candidate:2243255435 1 udp 2122194687 192.168.0.1 30000 typ host generation 0 network-id 1\r\n"):l.default.error("[".concat(t.clientId,"]None Ice Candidate not allowed"))),t.prevOffer=t.prevOffer.replace(/a=candidate:.+typ\shost.+\r\n/g,"a=candidate:2243255435 1 udp 2122194687 192.168.0.1 30000 typ host generation 0 network-id 1\r\n"),t.sendMessage("OFFER",t.prevOffer),t.state="offer-sent"}else if("offer-received"===t.state)t.peerConnection.createAnswer((function(e){if(t.peerConnection.setLocalDescription(e),t.state="offer-received-preparing-answer",t.iceStarted)t.markActionNeeded();else{var n=new Date;l.default.debug("["+t.clientId+"]"+n.getTime()+": Starting ICE in responder"),t.iceStarted=!0}}),(function(e){l.default.debug("["+t.clientId+"]peer connection create answer failed ",e)}),t.mediaConstraints);else if("offer-received-preparing-answer"===t.state){if(t.moreIceComing)return;n=t.peerConnection.localDescription.sdp,t.sendMessage("ANSWER",n),t.state="established"}else t.debug("Dazed and confused in state "+t.state+", stopping here");t.actionNeeded=!1}},t.sendMessage=function(e,n){var r={};r.messageType=e,r.sdp=n,"OFFER"===e?(r.offererSessionId=t.sessionId,r.answererSessionId=t.otherSessionId,r.seq=t.sequenceNumber+=1,r.tiebreaker=Math.floor(429496723*Math.random()+1)):(r.offererSessionId=t.incomingMessage.offererSessionId,r.answererSessionId=t.sessionId,r.seq=t.incomingMessage.seq),t.onsignalingmessage(JSON.stringify(r))},t._getSender=function(e){if(t.peerConnection&&t.peerConnection.getSenders){var n=t.peerConnection.getSenders().find((function(t){return t.track.kind==e}));if(n)return n}return null},t.hasSender=function(e){return!!t._getSender(e)},t.replaceTrack=function(e,n,r){var i=t._getSender(e.kind);if(!i)return r("NO_SENDER_FOUND");try{i.replaceTrack(e)}catch(e){return r&&r(e)}setTimeout((function(){return n&&n()}),50)},t.error=function(e){throw"Error in RoapOnJsep: "+e},t.sessionId=t.roapSessionId+=1,t.sequenceNumber=0,t.actionNeeded=!1,t.iceStarted=!1,t.moreIceComing=!0,t.iceCandidateCount=0,t.onsignalingmessage=e.callback,t.peerConnection.ontrack=function(e){console.log("!!! ontrack, ",e.track.kind,e.track),t.onaddstream&&t.onaddstream(e,"ontrack")},t.peerConnection.onremovestream=function(e){t.onremovestream&&t.onremovestream(e)},t.peerConnection.oniceconnectionstatechange=function(e){"connected"===e.currentTarget.iceConnectionState&&(t.connectedTime=new Date),t.oniceconnectionstatechange&&t.oniceconnectionstatechange(e.currentTarget.iceConnectionState)},t.renegotiate=function(){void 0!==t.prevOffer&&t.peerConnection.createOffer().then((function(e){return e.sdp=e.sdp.replace(/a=recvonly\r\n/g,"a=inactive\r\n"),e.sdp=r(e.sdp),e.sdp=i(e.sdp),t.peerConnection.setLocalDescription(e)})).then((function(){t.onnegotiationneeded&&t.onnegotiationneeded(t.peerConnection.localDescription.sdp)})).catch((function(e){console.log("createOffer error: ",e)}))},t.peerConnection.onnegotiationneeded=t.renegotiate,t.onaddstream=null,t.onremovestream=null,t.state="new",t.markActionNeeded(),t}(e)).browser="safari"):~window.navigator.userAgent.indexOf("Edge")?t=new m.a(e):(t=function(e){var t={},n=d.RTCPeerConnection;t.uid=e.uid,t.isVideoMute=e.isVideoMute,t.isAudioMute=e.isAudioMute,t.isSubscriber=e.isSubscriber,t.clientId=e.clientId,t.filterStatsCache=[],t.originStatsCache=[],t.lastTimeGetStats=null,t.pc_config={iceServers:[{url:"stun:webcs.agora.io:3478"}]};var i={id:"outbound_audio_ssrc_send",type:"ssrc",mediaType:"",googCodecName:"opus",aecDivergentFilterFraction:"0",audioInputLevel:"0",bytesSent:"0",packetsSent:"0",googEchoCancellationReturnLoss:"0",googEchoCancellationReturnLossEnhancement:"0"},a={id:"outbound_video_ssrc_send",type:"ssrc",mediaType:"",googCodecName:e.codec?e.codec.toUpperCase():"",bytesSent:"0",packetsLost:"0",packetsSent:"0",googAdaptationChanges:"0",googAvgEncodeMs:"0",googEncodeUsagePercent:"0",googFirsReceived:"0",googFrameHeightSent:"0",googFrameHeightInput:"0",googFrameRateInput:"0",googFrameRateSent:"0",googFrameWidthSent:"0",googFrameWidthInput:"0",googNacksReceived:"0",googPlisReceived:"0",googRtt:"0"},c={id:"inbound_audio_ssrc_recv",type:"ssrc",mediaType:"",googCodecName:"opus",audioOutputLevel:"0",bytesReceived:"0",packetsLost:"0",packetsReceived:"0",googAccelerateRate:"0",googCurrentDelayMs:"0",googDecodingCNG:"0",googDecodingCTN:"0",googDecodingCTSG:"0",googDecodingNormal:"0",googDecodingPLC:"0",googDecodingPLCCNG:"0",googExpandRate:"0",googJitterBufferMs:"0",googJitterReceived:"0",googPreemptiveExpandRate:"0",googPreferredJitterBufferMs:"0",googSecondaryDecodedRate:"0",googSpeechExpandRate:"0"},p={id:"inbound_video_ssrc_recv",type:"ssrc",mediaType:"",googTargetDelayMs:"0",packetsLost:"0",googDecodeMs:"0",googMaxDecodeMs:"0",googRenderDelayMs:"0",googFrameWidthReceived:"0",googFrameHeightReceived:"0",googFrameRateReceived:"0",googFrameRateDecoded:"0",googFrameRateOutput:"0",googJitterBufferMs:"0",googCurrentDelayMs:"0",googMinPlayoutDelayMs:"0",googNacksSent:"0",googPlisSent:"0",googFirsSent:"0",bytesReceived:"0",packetsReceived:"0",googFramesReceived:"0",googFramesDecoded:"0"},A={id:"bweforvideo",type:"VideoBwe",googAvailableSendBandwidth:"0",googAvailableReceiveBandwidth:"0",googActualEncBitrate:"0",googRetransmitBitrate:"0",googTargetEncBitrate:"0",googBucketDelay:"0",googTransmitBitrate:"0"};t.con={optional:[{DtlsSrtpKeyAgreement:!0}]},e.iceServers instanceof Array?t.pc_config.iceServers=e.iceServers:(e.stunServerUrl&&(e.stunServerUrl instanceof Array?e.stunServerUrl.map((function(e){"string"==typeof e&&""!==e&&t.pc_config.iceServers.push({url:e})})):"string"==typeof e.stunServerUrl&&""!==e.stunServerUrl&&t.pc_config.iceServers.push({url:e.stunServerUrl})),e.turnServers&&(e.turnServers instanceof Array?e.turnServers.map((function(e){e.udpport&&t.pc_config.iceServers.push({username:e.username,credential:e.credential,credentialType:"password",urls:(e.useTurns?"turns:":"turn:")+e.url+":"+e.udpport+"?transport=udp"}),"string"==typeof e.tcpport&&""!==e.tcpport&&t.pc_config.iceServers.push({username:e.username,credential:e.credential,credentialType:"password",urls:(e.useTurns?"turns:":"turn:")+e.url+":"+e.tcpport+"?transport=tcp"}),!0===e.forceturn&&(t.pc_config.iceTransportPolicy="relay")})):l.default.error("[".concat(t.clientId,"] turnServers is not a array")))),void 0===e.audio&&(e.audio=!0),void 0===e.video&&(e.video=!0),t.mediaConstraints={mandatory:{OfferToReceiveVideo:e.video,OfferToReceiveAudio:e.audio}},t.roapSessionId=103;try{t.pc_config.sdpSemantics="plan-b",t.peerConnection=new n(t.pc_config,t.con)}catch(e){delete t.pc_config.sdpSemantics,t.peerConnection=new n(t.pc_config,t.con)}t.iceCandidateTimer=setTimeout((function(){t.iceCandidateTimer=null,l.default.debug("[".concat(t.clientId,"]Candidates collected: ").concat(t.iceCandidateCount)),t.moreIceComing&&(t.moreIceComing=!1,t.markActionNeeded())}),Object(h.getParameter)("CANDIDATE_TIMEOUT")),t.peerConnection.onicecandidate=function(e){var n,r,i,o;r=(n=t.peerConnection.localDescription.sdp).match(/a=candidate:.+typ\ssrflx.+\r\n/),i=n.match(/a=candidate:.+typ\shost.+\r\n/),o=n.match(/a=candidate:.+typ\srelay.+\r\n/),null===r&&null===i&&null===o||void 0!==t.ice||!t.iceCandidateTimer||(clearTimeout(t.iceCandidateTimer),t.iceCandidateTimer=null,t.ice=0,t.moreIceComing=!1,t.markActionNeeded()),t.iceCandidateCount=t.iceCandidateCount+1};var g=function(e){return e.replace("a=x-google-flag:conference\r\n","")},v=function(n){var r,i;if((r=n.match(/m=video.*\r\n/))&&e.minVideoBW&&e.maxVideoBW){i=r[0]+"b=AS:"+e.maxVideoBW+"\r\n";var o=0,a=0;"h264"===e.codec?(o=n.search(/a=rtpmap:(\d+) H264\/90000\r\n/),a=n.search(/H264\/90000\r\n/)):"vp8"===e.codec?(o=n.search(/a=rtpmap:(\d+) VP8\/90000\r\n/),a=n.search(/VP8\/90000\r\n/)):"vp9"===e.codec&&(o=n.search(/a=rtpmap:(\d+) VP9\/90000\r\n/),a=n.search(/VP9\/90000\r\n/)),-1!==o&&-1!==a&&a-o>10&&(i=i+"a=fmtp:"+n.slice(o+9,a-1)+" x-google-min-bitrate="+e.minVideoBW+"\r\n"),n=n.replace(r[0],i),l.default.debug("["+t.clientId+"]Set Video Bitrate - min:"+e.minVideoBW+" max:"+e.maxVideoBW)}return(r=n.match(/m=audio.*\r\n/))&&e.maxAudioBW&&(i=r[0]+"b=AS:"+e.maxAudioBW+"\r\n",n=n.replace(r[0],i)),n};t.processSignalingMessage=function(n){var r,i=JSON.parse(n);t.incomingMessage=i,"new"===t.state?"OFFER"===i.messageType?(r={sdp:i.sdp,type:"offer"},t.peerConnection.setRemoteDescription(new RTCSessionDescription(r)).catch((function(e){})),t.state="offer-received",t.markActionNeeded()):t.error("Illegal message for this state: "+i.messageType+" in state "+t.state):"offer-sent"===t.state?"ANSWER"===i.messageType?((r={sdp:i.sdp,type:"answer"}).sdp=g(r.sdp),r.sdp=v(r.sdp),e.screen&&"detail"===e.optimizationMode&&(l.default.debug("[".concat(t.client,"] remove screen share abs ext")),r.sdp=r.sdp.replace(/a=.*abs-send-time\r\n/g,"").replace(/a=.*goog-remb\r\n/g,"")),e.isSubscriber&&(r.sdp=r.sdp.replace("minptime=10","minptime=10;stereo=1; sprop-stereo=1")),t.peerConnection.setRemoteDescription(new RTCSessionDescription(r)).catch((function(e){})),t.state="established"):"pr-answer"===i.messageType?(r={sdp:i.sdp,type:"pr-answer"},t.peerConnection.setRemoteDescription(new RTCSessionDescription(r)).catch((function(e){}))):"offer"===i.messageType?t.error("Not written yet"):t.error("Illegal message for this state: "+i.messageType+" in state "+t.state):"established"===t.state&&("OFFER"===i.messageType?(r={sdp:i.sdp,type:"offer"},t.peerConnection.setRemoteDescription(new RTCSessionDescription(r)).catch((function(e){})),t.state="offer-received",t.markActionNeeded()):"ANSWER"===i.messageType?((r={sdp:i.sdp,type:"answer"}).sdp=g(r.sdp),r.sdp=v(r.sdp),t.peerConnection.setRemoteDescription(new RTCSessionDescription(r)).catch((function(e){}))):t.error("Illegal message for this state: "+i.messageType+" in state "+t.state))},t.setRtpSenderParameters=function(){var e=u()(s.a.mark((function e(n){var r,i,o;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.peerConnection.getSenders(),console.log("senders",r),i=r.find((function(e){return"video"===e.track.kind}))){e.next=5;break}return e.abrupt("return");case 5:return(o=i.getParameters()).degradationPreference=n,e.prev=7,l.default.debug("[".concat(t.clientId,"] setParameters"),o),e.next=11,i.setParameters(o);case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(7),l.default.debug("[".concat(t.clientId,"] setParameters failed, ignore"));case 16:case"end":return e.stop()}}),e,null,[[7,13]])})));return function(t){return e.apply(this,arguments)}}();var m=0,y=0;return t.getVideoRelatedStats=function(e){t.getStats((function(n){n.forEach((function(n){if(t.isSubscriber){if("video"===n.mediaType&&n.id&&~n.id.indexOf("recv")){if(r.isChromeKernel()&&+r.getBrowserVersion()>=76){var i=+n.googFramesReceived-m,o=+n.googFramesDecoded-y;t._setStat(p,"googFrameRateReceived",i),t._setStat(p,"googFrameRateDecoded",o),t._setStat(p,"googFrameRateOutput",o),m=+n.googFramesReceived,y=+n.googFramesDecoded}e&&e({mediaType:"video",peerId:t.uid,isVideoMute:t.isVideoMute,frameRateReceived:n.googFrameRateReceived,frameRateDecoded:n.googFrameRateDecoded,bytesReceived:n.bytesReceived,packetsReceived:n.packetsReceived,packetsLost:n.packetsLost})}}else"video"===n.mediaType&&n.id&&~n.id.indexOf("send")&&e&&e({mediaType:"video",isVideoMute:t.isVideoMute,frameRateInput:n.googFrameRateInput,frameRateSent:n.googFrameRateSent,googRtt:n.googRtt})}))}))},t.getAudioRelatedStats=function(e){t.getStats((function(n){n.forEach((function(n){t.isSubscriber&&"audio"===n.mediaType&&n.id&&~n.id.indexOf("recv")&&e&&e({mediaType:"audio",peerId:t.uid,isAudioMute:t.isAudioMute,frameDropped:parseInt(n.googDecodingPLC)+parseInt(n.googDecodingPLCCNG)+"",frameReceived:n.googDecodingCTN,googJitterReceived:n.googJitterReceived,bytesReceived:n.bytesReceived,packetsReceived:n.packetsReceived,packetsLost:n.packetsLost})}))}))},t.getStatsRate=function(e){t.getStats((function(t){e(t)}))},t.getStats=function(e,n){n=(n=n||500)>500?500:n,t.lastTimeGetStats&&Date.now()-t.lastTimeGetStats<n?e&&e(t.filterStatsCache,t.originStatsCache):(t.lastTimeGetStats=Date.now(),this._getStats((function(n,r){t.filterStatsCache=n,t.originStatsCache=r,e&&e(n,r)})))},t._setStat=function(e,t,n){e.hasOwnProperty(t)&&(null!=n&&n!==1/0&&n==n||(n=0),e[t]=n+"")},t._processGetStatsAfterChrome76=function(e){var n=this;t.lastStats||(t.lastStats=new Map),t.peerConnection.getStats().then((function(r){var s,u=[],l=[],d=new Map,h=new Date,g=f(r.values());try{for(g.s();!(s=g.n()).done;){var v=s.value;"codec"!=v.type?"candidate-pair"!=v.type?("inbound-rtp"===v.type&&"video"===v.mediaType&&d.set("inbound-video",v),"inbound-rtp"===v.type&&"audio"===v.mediaType&&d.set("inbound-audio",v),"outbound-rtp"===v.type&&"audio"===v.mediaType&&d.set("outbound-audio",v),"outbound-rtp"===v.type&&"video"===v.mediaType&&d.set("outbound-video",v),"track"===v.type&&"video"===v.kind&&v.remoteSource&&d.set("remote-video-track",v),"track"===v.type&&"audio"===v.kind&&v.remoteSource&&d.set("remote-audio-track",v),"remote-inbound-rtp"===v.type&&"video"===v.mediaType&&d.set("remote-inbound-video",v),"remote-inbound-rtp"===v.type&&"audio"===v.mediaType&&d.set("remote-inbound-audio",v),"track"!==v.type||"video"!==v.kind||v.remoteSource||d.set("local-video-track",v),"track"!==v.type||"audio"!==v.kind||v.remoteSource||d.set("local-audio-track",v),"media-source"===v.type&&"video"===v.kind&&d.set("media-source-video",v),"media-source"===v.type&&"audio"===v.kind&&d.set("media-source-audio",v)):l.push(v):u.push(v)}}catch(e){g.e(e)}finally{g.f()}d.set("codec",u),d.set("candidatePairs",l),d.set("timestamp",+h);var m=null,y=null;if(p.timestamp=h,c.timestamp=h,i.timestamp=h,i.timestamp=h,A.timestamp=h,n.isSubscriber)(m=d.get("inbound-video"))&&(t._setStat(p,"id","inbound_video_ssrc_recv"),t._setStat(p,"mediaType",m.mediaType),t._setStat(p,"packetsLost",m.packetsLost),t._setStat(p,"googDecodeMs",null),t._setStat(p,"googMaxDecodeMs",null),t._setStat(p,"googRenderDelayMs",null),t._setStat(p,"googMinPlayoutDelayMs",null),t._setStat(p,"googNacksSent",m.nackCount),t._setStat(p,"googPlisSent",m.pliCount),t._setStat(p,"googFirsSent",m.firCount),t._setStat(p,"bytesReceived",m.bytesReceived),t._setStat(p,"packetsReceived",m.packetsReceived)),(m=d.get("inbound-audio"))&&(t._setStat(c,"id","inbound_audio_ssrc_recv"),t._setStat(c,"mediaType",m.mediaType),t._setStat(c,"bytesReceived",m.bytesReceived),t._setStat(c,"packetsLost",m.packetsLost),t._setStat(c,"packetsReceived",m.packetsReceived),t._setStat(c,"googAccelerateRate",m.removedSamplesForAcceleration),t._setStat(c,"googCurrentDelayMs",m.jitterBufferDelay),t._setStat(c,"googDecodingCNG",null),t._setStat(c,"googDecodingCTN",null),t._setStat(c,"googDecodingCTSG",null),t._setStat(c,"googDecodingNormal",null),t._setStat(c,"googDecodingPLC",null),t._setStat(c,"googDecodingPLCCNG",null),t._setStat(c,"googJitterReceived",m.jitter),t._setStat(c,"googPreferredJitterBufferMs",null),t._setStat(c,"googSecondaryDecodedRate",null)),(m=d.get("remote-video-track"))&&(t._setStat(p,"googTargetDelayMs",m.jitterBufferDelay),t._setStat(p,"googFrameWidthReceived",m.frameWidth),t._setStat(p,"googFrameHeightReceived",m.frameHeight),t._setStat(p,"googJitterBufferMs",m.jitterBufferDelay/m.jitterBufferEmittedCount*1e3),t._setStat(p,"googCurrentDelayMs",m.jitterBufferDelay),t._setStat(p,"googFramesDecoded",m.framesDecoded),t._setStat(p,"googFramesReceived",m.framesReceived)),(m=d.get("remote-audio-track"))&&(t._setStat(c,"audioOutputLevel",32767*m.audioLevel),t._setStat(c,"googJitterBufferMs",m.jitterBufferDelay/m.jitterBufferEmittedCount*1e3),t._setStat(c,"googExpandRate",m.concealedSamples),t._setStat(c,"googPreemptiveExpandRate",m.insertedSamplesForDeceleration),t._setStat(c,"googSpeechExpandRate",m.silentConcealedSamples));else{var b=t.lastStats.get("timestamp"),E=t.lastStats.get("outbound-video");if((m=d.get("outbound-audio"))&&(t._setStat(i,"id","outbound_audio_ssrc_send"),t._setStat(i,"mediaType",m.mediaType),t._setStat(i,"aecDivergentFilterFraction",null),t._setStat(i,"bytesSent",m.bytesSent),t._setStat(i,"packetsSent",m.packetsSent),y=m.transportId),m=d.get("outbound-video")){if(t._setStat(a,"id","outbound_video_ssrc_send"),t._setStat(a,"mediaType",m.mediaType),t._setStat(a,"bytesSent",m.bytesSent),t._setStat(a,"packetsSent",m.packetsSent),t._setStat(a,"googAdaptationChanges",m.qualityLimitationDurations),t._setStat(a,"googAvgEncodeMs",null),t._setStat(a,"googEncodeUsagePercent",null),y=m.transportId,m.totalEncodedBytesTarget&&E&&E.totalEncodedBytesTarget){var _=(m.totalEncodedBytesTarget-E.totalEncodedBytesTarget)/(+new Date-b);t._setStat(A,"googTargetEncBitrate",Math.floor(8*_*1e3))}if(m.retransmittedBytesSent&&E&&E.retransmittedBytesSent){var w=(m.retransmittedBytesSent-E.retransmittedBytesSent)/(+new Date-b);t._setStat(A,"googRetransmitBitrate",Math.floor(8*w*1e3))}if(m.bytesSent&&E&&E.bytesSent){var S=(m.bytesSent-E.bytesSent)/(+new Date-b);t._setStat(A,"googTransmitBitrate",Math.floor(8*S*1e3)),t._setStat(A,"googActualEncBitrate",Math.floor(8*S*1e3))}if(m.totalPacketSendDelay&&E&&E.totalPacketSendDelay){var T=(m.totalPacketSendDelay-E.totalPacketSendDelay)/(+new Date-b);t._setStat(A,"googBucketDelay",Math.floor(1e3*T))}}if((m=d.get("remote-inbound-video"))&&(t._setStat(a,"packetsLost",m.packetsLost),t._setStat(a,"googRtt",m.roundTripTime)),(m=d.get("local-video-track"))&&(t._setStat(a,"googFrameHeightSent",m.frameHeight),t._setStat(a,"googFrameWidthSent",m.frameWidth),void 0!==m.framesPerSecond&&t._setStat(a,"googFrameRateSent",m.framesPerSecond)),(m=d.get("local-audio-track"))&&(t._setStat(i,"googEchoCancellationReturnLoss",m.echoReturnLoss),t._setStat(i,"googEchoCancellationReturnLossEnhancement",m.echoReturnLossEnhancement)),(m=d.get("media-source-video"))&&(t._setStat(a,"googFrameHeightInput",m.height),t._setStat(a,"googFrameWidthInput",m.width),t._setStat(a,"googFrameRateInput",m.framesPerSecond)),(m=d.get("media-source-audio"))&&t._setStat(i,"audioInputLevel",32767*m.totalAudioEnergy),(m=d.get("inbound-video"))&&(t._setStat(a,"googFirsReceived",m.firCount),t._setStat(a,"googNacksReceived",m.nackCount),t._setStat(a,"googPlisReceived",m.pliCount)),y)d.get("candidatePairs").map((function(e){y==e.transportId&&t._setStat(A,"googAvailableSendBandwidth",e.availableOutgoingBitrate)}));else{var R=d.get("candidatePairs")[0];R&&t._setStat(A,"googAvailableSendBandwidth",R.availableOutgoingBitrate)}}t.lastStats=d;var C=[o()({},a),o()({},i),o()({},p),o()({},c),o()({},A)];C.push({id:"time",startTime:t.connectedTime,timestamp:new Date}),e(C)}))},t._processGetStatsBeforeChrome76=function(e){t.peerConnection.getStats((function(n){var r=[],s=[],u=null;Object.keys(n).forEach((function(e){var t=n[e];t&&(s.push(t),u=t.timestamp,"VideoBwe"===t.type?A=t:t.id.indexOf("_send")>-1&&"video"===t.mediaType?a=t:t.id.indexOf("_send")>-1&&"audio"===t.mediaType?i=t:t.id.indexOf("_recv")>-1&&"video"===t.mediaType?p=t:t.id.indexOf("_recv")>-1&&"audio"===t.mediaType&&(c=t))})),(r=[o()({},a),o()({},i),o()({},p),o()({},c),o()({},A)]).push({id:"time",startTime:t.connectedTime,timestamp:u||new Date}),e(r,s)}))},t._getStats=function(e){Object(h.getParameter)("CHROME_NEW_STATS")&&r.isChromeKernel()&&+r.getBrowserVersion()>=76?t._processGetStatsAfterChrome76(e):t._processGetStatsBeforeChrome76(e)},t.addTrack=function(e,n){t.peerConnection.addTrack(e,n)},t.removeTrack=function(e,n){t.peerConnection.removeTrack(t.peerConnection.getSenders().find((function(t){return t.track==e})))},t.addStream=function(e){t.peerConnection.addStream(e),t.markActionNeeded()},t.removeStream=function(){t.markActionNeeded()},t.close=function(){t.state="closed",t.peerConnection.close()},t.markActionNeeded=function(){t.actionNeeded=!0,t.doLater((function(){t.onstablestate()}))},t.doLater=function(e){window.setTimeout(e,1)},t.onstablestate=function(){var n;if(t.actionNeeded){if("new"===t.state||"established"===t.state)t.peerConnection.createOffer(t.mediaConstraints).then((function(n){return n?n.sdp!==t.prevOffer?(e.isSubscriber&&(n.sdp=n.sdp.replace("minptime=10","minptime=10;stereo=1; sprop-stereo=1")),t.peerConnection.setLocalDescription(n),t.state="preparing-offer",void t.markActionNeeded()):void l.default.debug("["+t.clientId+"]Not sending a new offer"):(l.default.debug("["+t.clientId+"]sessionDescription is null"),void t.onsignalingmessage(null))})).catch((function(e){l.default.debug("["+t.clientId+"]peer connection create offer failed ",e)}));else if("preparing-offer"===t.state){if(t.moreIceComing)return;t.prevOffer=t.peerConnection.localDescription.sdp,t.offerCandidates=t.prevOffer.match(/a=candidate.+\r\n/g)||[],t.offerCandidates.length||(l.default.warning("[".concat(t.clientId,"]No Ice Candidate generated")),Object(h.getParameter)("SHIM_CANDIDATE")?(l.default.debug("Shimming fake candidate"),t.prevOffer+="a=candidate:2243255435 1 udp 2122194687 192.168.0.1 30000 typ host generation 0 network-id 1\r\n"):l.default.error("[".concat(t.clientId,"]None Ice Candidate not allowed"))),t.prevOffer=t.prevOffer.replace(/a=candidate:.+typ\shost.+\r\n/g,"a=candidate:2243255435 1 udp 2122194687 192.168.0.1 30000 typ host generation 0 network-id 1\r\n"),t.sendMessage("OFFER",t.prevOffer),t.state="offer-sent"}else if("offer-received"===t.state)t.peerConnection.createAnswer((function(e){if(t.peerConnection.setLocalDescription(e),t.state="offer-received-preparing-answer",t.iceStarted)t.markActionNeeded();else{var n=new Date;l.default.debug("["+t.clientId+"]"+n.getTime()+": Starting ICE in responder"),t.iceStarted=!0}}),(function(e){l.default.debug("["+t.clientId+"]peer connection create answer failed ",e)}),t.mediaConstraints);else if("offer-received-preparing-answer"===t.state){if(t.moreIceComing)return;n=t.peerConnection.localDescription.sdp,t.sendMessage("ANSWER",n),t.state="established"}else l.default.debug("[".concat(t.clientId,"] Dazed and confused in state ' + that.state + ', stopping here'"));t.actionNeeded=!1}},t.sendMessage=function(e,n){var r={};r.messageType=e,r.sdp=n,"OFFER"===e?(r.offererSessionId=t.sessionId,r.answererSessionId=t.otherSessionId,r.seq=t.sequenceNumber+=1,r.tiebreaker=Math.floor(429496723*Math.random()+1)):(r.offererSessionId=t.incomingMessage.offererSessionId,r.answererSessionId=t.sessionId,r.seq=t.incomingMessage.seq),t.onsignalingmessage(JSON.stringify(r))},t._getSender=function(e){if(t.peerConnection&&t.peerConnection.getSenders){var n=t.peerConnection.getSenders().find((function(t){return t.track.kind==e}));if(n)return n}return null},t.hasSender=function(e){return!!t._getSender(e)},t.replaceTrack=function(e,n,r){var i=t._getSender(e.kind);if(!i)return r("NO_SENDER_FOUND");try{i.replaceTrack(e)}catch(e){return r&&r(e)}setTimeout((function(){return n&&n()}),50)},t.error=function(e){throw"Error in RoapOnJsep: "+e},t.sessionId=t.roapSessionId+=1,t.sequenceNumber=0,t.actionNeeded=!1,t.iceStarted=!1,t.moreIceComing=!0,t.iceCandidateCount=0,t.onsignalingmessage=e.callback,t.peerConnection.ontrack=function(e){t.onaddstream&&(t.onaddstream(e,"ontrack"),t.peerConnection.onaddstream=null)},t.peerConnection.onaddstream=function(e){t.onaddstream&&(t.onaddstream(e,"onaddstream"),t.peerConnection.ontrack=null)},t.peerConnection.onremovestream=function(e){t.onremovestream&&t.onremovestream(e)},t.peerConnection.oniceconnectionstatechange=function(e){"connected"===e.currentTarget.iceConnectionState&&(t.connectedTime=new Date),t.oniceconnectionstatechange&&t.oniceconnectionstatechange(e.currentTarget.iceConnectionState)},t.renegotiate=function(){void 0!==t.prevOffer&&t.peerConnection.createOffer().then((function(e){return e.sdp=e.sdp.replace(/a=recvonly\r\n/g,"a=inactive\r\n"),e.sdp=g(e.sdp),e.sdp=v(e.sdp),t.peerConnection.setLocalDescription(e)})).then((function(){t.onnegotiationneeded&&t.onnegotiationneeded(t.peerConnection.localDescription.sdp)})).catch((function(e){console.log("createOffer error: ",e)}))},t.peerConnection.onnegotiationneeded=t.renegotiate,t.onaddstream=null,t.onremovestream=null,t.onnegotiationneeded=null,t.state="new",t.markActionNeeded(),t}(e)).browser="chrome-stable",t},_=function(e,t,n){var i={};i.config=e,i.streamId=e.streamId,delete e.streamId,navigator.getMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;var o=0,a=1,s=!1,c=null,u=function(e){if(o++,c)if(c===e)l.default.debug("Using Video Source/ Audio Source");else{var n=c.getVideoTracks()[0],r=c.getAudioTracks()[0],i=e.getVideoTracks()[0],u=e.getAudioTracks()[0];i&&(n&&c.removeTrack(n),c.addTrack(i)),u&&(r&&c.removeTrack(r),c.addTrack(u))}else c=e;o!==a||s||(s=!0,setTimeout((function(){t(c)}),0))},d=function(e){l.default.error("Failed to GetUserMedia",e.name,e.code,e.message,e),o++,s||(s=!0,setTimeout((function(){n&&n(e)}),0))},h=function(){var t={video:e.video,audio:e.audio};if(l.default.debug("GetUserMedia",JSON.stringify(t)),navigator.mediaDevices&&navigator.mediaDevices.getUserMedia)navigator.mediaDevices.getUserMedia(t).then(u).catch(d);else if("undefined"!=typeof navigator&&navigator.getMedia)navigator.getMedia(e,u,d);else{var r={name:"MEDIA_NOT_SUPPORT",message:"Video/audio streams not supported yet"};l.default.error("["+i.streamId+"]"+r.message),n&&n(r)}};if((e.videoSource||e.audioSource)&&(c=new MediaStream,e.videoSource&&c.addTrack(e.videoSource),e.audioSource&&c.addTrack(e.audioSource)),e.video||e.audio||e.screen||e.screenAudio){if(!e.screen&&e.screenAudio)return n&&n({code:"Set screen to true before sharing the audio"});if(e.screen){if(y.a.isElectron())return e.screen.sourceId?y.a.getScreenStream(e.screen.sourceId,e.screen,(function(t,n){t?d(t):(e.audio&&(a++,h()),u(n))})):y.a.shareScreen(e.screen,(function(t,n){t?d(t):(e.audio&&(a++,h()),u(n))}));if(r.isFireFox()){if(l.default.debug("["+i.streamId+"]Screen access requested"),!~["screen","window","application"].indexOf(e.screen.mediaSource))return n&&n({code:"Invalid mediaSource, mediaSource should be one of [screen, window, application]"});navigator.getMedia({video:e.screen},(function(t){e.audio&&(a++,h()),u(t)}),d)}else if(r.isChromeKernel()&&e.screen.extensionId){if(window.navigator.appVersion.match(/Chrome\/([\w\W]*?)\./)[1]<34)return void n({code:"This browser does not support screen sharing"});l.default.debug("["+i.streamId+"]Screen access on chrome stable, looking for extension");try{chrome.runtime.sendMessage(e.screen.extensionId,{getStream:!0},(function(t){void 0===t?(l.default.error("["+i.streamId+"]No response from Chrome Plugin. Plugin not installed properly"),d({name:"PluginNotInstalledProperly",message:"No response from Chrome Plugin. Plugin not installed properly."})):(e.screen.mandatory.chromeMediaSourceId=t.streamId,navigator.getMedia({video:e.screen},(function(t){e.audio&&(a++,h()),u(t)}),d))}))}catch(e){return l.default.debug("["+i.streamId+"]AgoraRTC screensharing plugin is not accessible"),void n({code:"no_plugin_present"})}}else{if(window.navigator.mediaDevices.getDisplayMedia){var f={};return"number"==typeof e.screen.width&&"number"==typeof e.screen.height?f.video={width:{ideal:e.screen.width},height:{ideal:e.screen.height}}:f.video={width:e.screen.width,height:e.screen.height},e.screen.frameRate&&e.screen.frameRate.min?f.video.frameRate={ideal:e.screen.frameRate.max,max:e.screen.frameRate.max}:f.video.frameRate=e.screen.frameRate,e.screenAudio&&(f.audio=e.screenAudio),l.default.debug("use getDisplayMedia, constraints:",f),window.navigator.mediaDevices.getDisplayMedia(f).then((function(t){!e.screenAudio&&e.audio&&(a++,h()),u(t)})).catch(d)}l.default.error("["+i.streamId+"]This browser does not support screenSharing"),n({code:"This browser does not support screen sharing"})}}else h()}else u(c)}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(0)),o=function(){function e(e,t,n){void 0===t&&(t=""),this.name="AgoraRTCException",this.code=e,this.message="AgoraRTCError "+this.code+": "+t,this.data=n}return e.prototype.toString=function(){return this.data?this.message+" data: "+JSON.stringify(this.data):this.message},e.prototype.throw=function(){throw i.default.error(this.toString()),this},e}();t.AgoraRTCError=o,function(e){e.UNEXPECTED_ERROR="UNEXPECTED_ERROR",e.UNEXPECTED_RESPONSE="UNEXPECTED_RESPONSE",e.TIMEOUT="TIMEOUT",e.INVALID_PARAMS="INVALID_PARAMS",e.NOT_SUPPORT="NOT_SUPPORT",e.INVALID_OPERATION="INVALID_OPERATION",e.OPERATION_ABORT="OPERATION_ABORT",e.WEB_SECURITY_RESTRICT="WEB_SECURITY_RESTRICT",e.NETWORK_ERROR="NETWORK_ERROR",e.NETWORK_TIMEOUT="NETWORK_TIMEOUT",e.NETWORK_RESPONSE_ERROR="NETWORK_RESPONSE_ERROR",e.API_INVOKE_TIMEOUT="API_INVOKE_TIMEOUT",e.ENUMERATE_DEVICES_FAILED="ENUMERATE_DEVICES_FAILED",e.DEVICE_NOT_FOUND="DEVICE_NOT_FOUND",e.ELECTRON_IS_NULL="ELECTRON_IS_NULL",e.ELECTRON_DESKTOP_CAPTURER_GET_SOURCES_ERROR="ELECTRON_DESKTOP_CAPTURER_GET_SOURCES_ERROR",e.STREAM_ALREADY_INITIALIZED="STREAM_ALREADY_INITIALIZED",e.STREAM_IS_CLOSED="STREAM_IS_CLOSED",e.ABORT_OTHER_INIT="ABORT_OTHER_INIT",e.CHROME_PLUGIN_NO_RESPONSE="CHROME_PLUGIN_NO_RESPONSE",e.CHROME_PLUGIN_NOT_INSTALL="CHROME_PLUGIN_NOT_INSTALL",e.MEDIA_OPTION_INVALID="MEDIA_OPTION_INVALID",e.PERMISSION_DENIED="PERMISSION_DENIED",e.CONSTRAINT_NOT_SATISFIED="CONSTRAINT_NOT_SATISFIED",e.CAN_NOT_AUTOPLAY="CAN_NOT_AUTOPLAY",e.HIGH_STREAM_NO_VIDEO_TRACK="HIGH_STREAM_NO_VIDEO_TRACK",e.SCREEN_SHARE_CAN_NOT_CREATE_LOW_STREAM="SCREEN_SHARE_CAN_NOT_CREATE_LOW_STREAM",e.TRACK_IS_DISABLED="TRACK_IS_DISABLED",e.SHARE_AUDIO_NOT_ALLOWED="SHARE_AUDIO_NOT_ALLOWED",e.TOKEN_GENERATOR_FUNCTION_ERROR="TOKEN_GENERATOR_FUNCTION_ERROR",e.INVALID_UINT_UID_FROM_STRING_UID="INVALID_UINT_UID_FROM_STRING_UID",e.CAN_NOT_GET_PROXY_SERVER="CAN_NOT_GET_PROXY_SERVER",e.CAN_NOT_GET_GATEWAY_SERVER="CAN_NOT_GET_GATEWAY_SERVER",e.UID_CONFLICT="UID_CONFLICT",e.INVALID_LOCAL_TRACK="INVALID_LOCAL_TRACK",e.INVALID_TRACK="INVALID_TRACK",e.SENDER_NOT_FOUND="SENDER_NOT_FOUND",e.CREATE_OFFER_FAILED="CREATE_OFFER_FAILED",e.SET_ANSWER_FAILED="SET_ANSWER_FAILED",e.ICE_FAILED="ICE_FAILED",e.PC_CLOSED="PC_CLOSED",e.SENDER_REPLACE_FAILED="SENDER_REPLACE_FAILED",e.GATEWAY_P2P_LOST="GATEWAY_P2P_LOST",e.NO_ICE_CANDIDATE="NO_ICE_CANDIDATE",e.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS="CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS",e.INVALID_REMOTE_USER="INVALID_REMOTE_USER",e.REMOTE_USER_IS_NOT_PUBLISHED="REMOTE_USER_IS_NOT_PUBLISHED",e.SUBSCRIPTION_IS_IN_PROGRESS="SUBSCRIPTION_IS_IN_PROGRESS",e.CUSTOM_REPORT_SEND_FAILED="CUSTOM_REPORT_SEND_FAILED",e.CUSTOM_REPORT_FREQUENCY_TOO_HIGH="CUSTOM_REPORT_FREQUENCY_TOO_HIGH",e.FETCH_AUDIO_FILE_FAILED="FETCH_AUDIO_FILE_FAILED",e.READ_LOCAL_AUDIO_FILE_ERROR="READ_LOCAL_AUDIO_FILE_ERROR",e.DECODE_AUDIO_FILE_FAILED="DECODE_AUDIO_FILE_FAILED",e.EFFECT_ID_CONFLICTED="EFFECT_ID_CONFLICTED",e.EFFECT_SOUND_ID_NOT_FOUND="EFFECT_SOUND_ID_NOT_FOUND",e.WS_ABORT="WS_ABORT",e.WS_DISCONNECT="WS_DISCONNECT",e.WS_ERR="WS_ERR",e.CAN_NOT_CONNECT_TO_LIVE_STREAMING_WORKER="CAN_NOT_CONNECT_TO_LIVE_STREAMING_WORKER",e.LIVE_STREAMING_TASK_CONFLICT="LIVE_STREAMING_TASK_CONFLICT",e.LIVE_STREAMING_INVALID_ARGUMENT="LIVE_STREAMING_INVALID_ARGUMENT",e.LIVE_STREAMING_INTERNAL_SERVER_ERROR="LIVE_STREAMING_INTERNAL_SERVER_ERROR",e.LIVE_STREAMING_PUBLISH_STREAM_NOT_AUTHORIZED="LIVE_STREAMING_PUBLISH_STREAM_NOT_AUTHORIZED",e.LIVE_STREAMING_TRANSCODING_NOT_SUPPORT="LIVE_STREAMING_TRANSCODING_NOT_SUPPORT",e.LIVE_STREAMING_CDN_ERROR="LIVE_STREAMING_CDN_ERROR",e.LIVE_STREAMING_INVALID_RAW_STREAM="LIVE_STREAMING_INVALID_RAW_STREAM",e.LIVE_STREAMING_WARN_STREAM_NUM_REACH_LIMIT="LIVE_STREAMING_WARN_STREAM_NUM_REACH_LIMIT",e.LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE="LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE",e.LIVE_STREAMING_WARN_FREQUENT_REQUEST="LIVE_STREAMING_WARN_FREQUENT_REQUEST",e.WEBGL_INTERNAL_ERROR="WEBGL_INTERNAL_ERROR",e.BEAUTY_PROCESSOR_INTERNAL_ERROR="BEAUTY_PROCESSOR_INTERNAL_ERROR",e.CROSS_CHANNEL_WAIT_STATUS_ERROR="CROSS_CHANNEL_WAIT_STATUS_ERROR",e.CROSS_CHANNEL_FAILED_JOIN_SRC="CROSS_CHANNEL_FAILED_JOIN_SEC",e.CROSS_CHANNEL_FAILED_JOIN_DEST="CROSS_CHANNEL_FAILED_JOIN_DEST",e.CROSS_CHANNEL_FAILED_PACKET_SENT_TO_DEST="CROSS_CHANNEL_FAILED_PACKET_SENT_TO_DEST",e.CROSS_CHANNEL_SERVER_ERROR_RESPONSE="CROSS_CHANNEL_SERVER_ERROR_RESPONSE",e.METADATA_OUT_OF_RANGE="METADATA_OUT_OF_RANGE"}(t.AgoraRTCErrorCode||(t.AgoraRTCErrorCode={}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(0),i=window.AudioContext||window.webkitAudioContext,o=n(3),a=o.getParameter,s=o.setParameter,c=function(){return a("AUDIO_CONTEXT")||(console.log("Creating Audio Context"),s("AUDIO_CONTEXT",function(){if(i){var e=new i;return window.ctx=e,new Promise((function(e){document.body?e():window.addEventListener("load",e)})).then((function(){var t=function t(){"suspended"==e.state?(r.default.debug("AudioContext is suspended, auto resume"),e.resume().then((function(){r.default.debug("AudioContext resume success"),document.body.removeEventListener("touchend",t,!0),document.body.removeEventListener("mousedown",t,!0)}))):(r.default.debug("AudioContext is running"),document.body.removeEventListener("touchend",t,!0),document.body.removeEventListener("mousedown",t,!0))};r.default.debug(">>> add event listener >>>>"),document.body.addEventListener("touchend",t,!0),document.body.addEventListener("mousedown",t,!0)})),e}throw new Error("AUDIO_CONTEXT_NOT_SUPPORTED")}())),a("AUDIO_CONTEXT")};c()},function(e,t,n){"use strict";var r=n(1),i=null,o=function(){try{i=window.require("electron")}catch(e){}return i},a=function(e){var t=r.report.reportApiInvoke(null,{callback:e,name:"getScreenSources",options:arguments,tag:"tracer"}),n=o();if(!n)return t&&t("electron is null");try{var i=n.desktopCapturer.getSources({types:["window","screen"]})}catch(e){console.log(e)}i instanceof Promise?(console.log("electron.desktopCapturer.getSources return type is Promise"),i.then((function(e){return t&&t(null,e)})).catch((function(e){return t&&t(e)}))):i=n.desktopCapturer.getSources({types:["window","screen"]},(function(e,n){console.log("electron.desktopCapturer.getSources return type is callback"),t&&t(null,n)}))},s=function(e,t,n){var r=t.width;t={audio:!1,video:{mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:e,maxHeight:t.height,maxWidth:r,maxFrameRate:t.frameRate&&t.frameRate.max,minFrameRate:t.frameRate&&t.frameRate.min}}},navigator.webkitGetUserMedia(t,(function(e){n&&n(null,e)}),(function(e){n&&n(e)}))};t.a={isElectron:function(){return!!o()},getElectronInstance:o,getScreenSources:a,getScreenStream:s,shareScreen:function(e,t){a((function(n,r){if(n)return t&&t(n);!function(e,t){var n=document.createElement("div");n.innerText="share screen",n.setAttribute("style","text-align: center; height: 25px; line-height: 25px; border-radius: 4px 4px 0 0; background: #D4D2D4; border-bottom:  solid 1px #B9B8B9;");var r=document.createElement("div");r.setAttribute("style","width: 100%; height: 500px; padding: 15px 25px ; box-sizing: border-box;");var i=document.createElement("div");i.innerText="Agora Web Screensharing wants to share the contents of your screen with webdemo.agorabeckon.com. Choose what you'd like to share.",i.setAttribute("style","height: 12%;");var o=document.createElement("div");o.setAttribute("style","width: 100%; height: 80%; background: #FFF; border:  solid 1px #CBCBCB; display: flex; flex-wrap: wrap; justify-content: space-around; overflow-y: scroll; padding: 0 15px; box-sizing: border-box;");var a=document.createElement("div");a.setAttribute("style","text-align: right; padding: 16px 0;");var s=document.createElement("button");s.innerHTML="cancel",s.setAttribute("style","width: 85px;"),s.onclick=function(){document.body.removeChild(c),t&&t("NotAllowedError")},a.appendChild(s),r.appendChild(i),r.appendChild(o),r.appendChild(a);var c=document.createElement("div");c.setAttribute("style","position: absolute; z-index: 99999999; top: 50%; left: 50%; width: 620px; height: 525px; background: #ECECEC; border-radius: 4px; -webkit-transform: translate(-50%,-50%); transform: translate(-50%,-50%);"),c.appendChild(n),c.appendChild(r),document.body.appendChild(c),e.map((function(e){if(e.id){var n=document.createElement("div");n.setAttribute("style","width: 30%; height: 160px; padding: 20px 0; text-align: center;box-sizing: content-box;"),n.innerHTML='<div style="height: 120px; display: table-cell; vertical-align: middle;"><img style="width: 100%; background: #333333; box-shadow: 1px 1px 1px 1px rgba(0, 0, 0, 0.2);" src='+e.thumbnail.toDataURL()+' /></div><span style="\theight: 40px; line-height: 40px; display: inline-block; width: 70%; word-break: keep-all; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">'+e.name+"</span>",n.onclick=function(){document.body.removeChild(c),t&&t(null,e.id)},o.appendChild(n)}}))}(r,(function(n,r){if(n)return t&&t(n);s(r,e,t)}))}))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2);!function(e){e.TRANSCODE="mix_streaming",e.RAW="raw_streaming",e.INJECT="inject_streaming"}(t.LiveStreamingServiceMode||(t.LiveStreamingServiceMode={})),t.DEFAULT_LIVE_STREAMING_TRANSCODING_USER={alpha:1,height:640,width:360,x:0,y:0,zOrder:0,audioChannel:0},t.DEFAULT_LIVE_STREAMING_TRANSCODING_WATERMARK={x:0,y:0,width:160,height:160,zOrder:255,alpha:1},t.isLiveStreamingTranscodingConfig=function(e){return r.isEmpty(e.width)||r.checkValidNumber(e.width,"config.width",0),r.isEmpty(e.height)||r.checkValidNumber(e.height,"config.height",0),r.isEmpty(e.videoBitrate)||r.checkValidNumber(e.videoBitrate,"config.videoBitrate",1,1e6),r.isEmpty(e.videoFramerate)||r.checkValidNumber(e.videoFramerate,"config.videoFramerate"),r.isEmpty(e.lowLatency)||r.checkValidBoolean(e.lowLatency,"config.lowLatency"),r.isEmpty(e.audioSampleRate)||r.checkValidEnum(e.audioSampleRate,"config.audioSampleRate",[32e3,44100,48e3]),r.isEmpty(e.audioBitrate)||r.checkValidNumber(e.audioBitrate,"config.audioBitrate",1,128),r.isEmpty(e.audioChannels)||r.checkValidEnum(e.audioChannels,"config.audioChannels",[1,2,3,4,5]),r.isEmpty(e.videoGop)||r.checkValidNumber(e.videoGop,"config.videoGop"),r.isEmpty(e.videoCodecProfile)||r.checkValidEnum(e.videoCodecProfile,"config.videoCodecProfile",[66,77,100]),r.isEmpty(e.userCount)||r.checkValidNumber(e.userCount,"config.userCount",0,17),r.isEmpty(e.backgroundColor)||r.checkValidNumber(e.backgroundColor,"config.backgroundColor",0,16777215),e.transcodingUsers&&!r.isEmpty(e.transcodingUsers)&&(r.checkValidArray(e.transcodingUsers,"config.transcodingUsers"),e.transcodingUsers.forEach((function(e,t){r.checkValidUID(e.uid),r.isEmpty(e.x)||r.checkValidNumber(e.x,"transcodingUser["+t+"].x",0,1e4),r.isEmpty(e.y)||r.checkValidNumber(e.y,"transcodingUser["+t+"].y",0,1e4),r.isEmpty(e.width)||r.checkValidNumber(e.width,"transcodingUser["+t+"].width",0,1e4),r.isEmpty(e.height)||r.checkValidNumber(e.height,"transcodingUser["+t+"].height",0,1e4),r.isEmpty(e.zOrder)||r.checkValidNumber(e.zOrder-1,"transcodingUser["+t+"].zOrder",0,100),r.isEmpty(e.alpha)||r.checkValidFloatNumber(e.alpha,"transcodingUser["+t+"].alpha",0,1)}))),e.images&&!r.isEmpty(e.images)&&(r.checkValidArray(e.images,"config.images"),e.images.forEach((function(e,t){r.checkValidString(e.url,"images["+t+"].url",1,1e3,!1),r.isEmpty(e.x)||r.checkValidNumber(e.x,"images["+t+"].x",0,1e4),r.isEmpty(e.y)||r.checkValidNumber(e.y,"images["+t+"].y",0,1e4),r.isEmpty(e.width)||r.checkValidNumber(e.width,"images["+t+"].width",0,1e4),r.isEmpty(e.height)||r.checkValidNumber(e.height,"images["+t+"].height",0,1e4),r.isEmpty(e.zOrder)||r.checkValidNumber(e.zOrder,"images["+t+"].zOrder",0,255),r.isEmpty(e.alpha)||r.checkValidFloatNumber(e.alpha,"images["+t+"].alpha",0,1)}))),!0},t.DEFAULT_TRANSCODING_CONFIG={audioBitrate:48,audioChannels:1,audioSampleRate:48e3,backgroundColor:0,height:360,lowLatency:!1,videoBitrate:400,videoCodecProfile:100,videoCodecType:1,videoFramerate:15,videoGop:30,width:640,images:[],userConfigs:[],userConfigExtraInfo:""},t.isInjectStreamConfig=function(e){return r.isEmpty(e.audioVolume)||r.checkValidNumber(e.audioVolume,"config.audioVolume",0,1e3),r.isEmpty(e.audioBitrate)||r.checkValidNumber(e.audioBitrate,"config.audioBitrate",1,1e4),r.isEmpty(e.audioChannels)||r.checkValidEnum(e.audioChannels,"config.audioChannels",[1,2]),r.isEmpty(e.audioSampleRate)||r.checkValidEnum(e.audioSampleRate,"config.audioSampleRate",[32e3,44100,48e3]),r.isEmpty(e.width)||r.checkValidNumber(e.width,"config.width",0,1e4),r.isEmpty(e.height)||r.checkValidNumber(e.height,"config.height",0,1e4),r.isEmpty(e.videoBitrate)||r.checkValidNumber(e.videoBitrate,"config.videoBitrate",1,1e4),r.isEmpty(e.videoFramerate)||r.checkValidNumber(e.videoFramerate,"config.videoFramerate",1,1e4),r.isEmpty(e.videoGop)||r.checkValidNumber(e.videoGop,"config.videoGop",1,1e4),!0},t.DEFAULT_INJECT_CONFIG={audioBitrate:48,audioChannels:2,audioVolume:100,audioSampleRate:48e3,height:0,width:0,videoBitrate:400,videoFramerate:15,videoGop:30},function(e){e.WARNING="@live_uap-warning",e.ERROR="@line_uap-error",e.PUBLISH_STREAM_STATUS="@live_uap-publish-status",e.INJECT_STREAM_STATUS="@live_uap-inject-status",e.WORKER_STATUS="@live_uap-worker-status",e.REQUEST_NEW_ADDRESS="@live_uap-request-address"}(t.LiveStreamingUapSignalEvents||(t.LiveStreamingUapSignalEvents={})),function(e){e.REQUEST_WORKER_MANAGER_LIST="@live_req_worker_manager"}(t.LiveStreamingInternalEvents||(t.LiveStreamingInternalEvents={})),function(e){e[e.LIVE_STREAM_RESPONSE_SUCCEED=200]="LIVE_STREAM_RESPONSE_SUCCEED",e[e.LIVE_STREAM_RESPONSE_ALREADY_EXISTS_STREAM=454]="LIVE_STREAM_RESPONSE_ALREADY_EXISTS_STREAM",e[e.LIVE_STREAM_RESPONSE_TRANSCODING_PARAMETER_ERROR=450]="LIVE_STREAM_RESPONSE_TRANSCODING_PARAMETER_ERROR",e[e.LIVE_STREAM_RESPONSE_BAD_STREAM=451]="LIVE_STREAM_RESPONSE_BAD_STREAM",e[e.LIVE_STREAM_RESPONSE_WM_PARAMETER_ERROR=400]="LIVE_STREAM_RESPONSE_WM_PARAMETER_ERROR",e[e.LIVE_STREAM_RESPONSE_WM_WORKER_NOT_EXIST=404]="LIVE_STREAM_RESPONSE_WM_WORKER_NOT_EXIST",e[e.LIVE_STREAM_RESPONSE_NOT_AUTHORIZED=456]="LIVE_STREAM_RESPONSE_NOT_AUTHORIZED",e[e.LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE=457]="LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE",e[e.LIVE_STREAM_RESPONSE_REQUEST_TOO_OFTEN=429]="LIVE_STREAM_RESPONSE_REQUEST_TOO_OFTEN",e[e.LIVE_STREAM_RESPONSE_NOT_FOUND_PUBLISH=452]="LIVE_STREAM_RESPONSE_NOT_FOUND_PUBLISH",e[e.LIVE_STREAM_RESPONSE_NOT_SUPPORTED=453]="LIVE_STREAM_RESPONSE_NOT_SUPPORTED",e[e.LIVE_STREAM_RESPONSE_MAX_STREAM_NUM=455]="LIVE_STREAM_RESPONSE_MAX_STREAM_NUM",e[e.LIVE_STREAM_RESPONSE_INTERNAL_SERVER_ERROR=500]="LIVE_STREAM_RESPONSE_INTERNAL_SERVER_ERROR",e[e.LIVE_STREAM_RESPONSE_WORKER_LOST=501]="LIVE_STREAM_RESPONSE_WORKER_LOST",e[e.LIVE_STREAM_RESPONSE_RESOURCE_LIMIT=502]="LIVE_STREAM_RESPONSE_RESOURCE_LIMIT",e[e.LIVE_STREAM_RESPONSE_WORKER_QUIT=503]="LIVE_STREAM_RESPONSE_WORKER_QUIT",e[e.ERROR_FAIL_SEND_MESSAGE=504]="ERROR_FAIL_SEND_MESSAGE",e[e.LIVE_STREAM_RESPONSE_INGNORE_MESSAGE=505]="LIVE_STREAM_RESPONSE_INGNORE_MESSAGE",e[e.PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE=30]="PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE",e[e.PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT=31]="PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT",e[e.PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH=32]="PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH",e[e.PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN=33]="PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN"}(t.LIVE_STREAM_ERROR_CODE||(t.LIVE_STREAM_ERROR_CODE={})),function(e){e.CONNECTED="websocket:connected",e.RECONNECTING="websocket:reconnecting",e.WILL_RECONNECT="websocket:will_reconnect",e.CLOSED="websocket:closed",e.FAILED="websocket:failed",e.ON_MESSAGE="websocket:on_message",e.REQUEST_NEW_URLS="websocket:request_new_urls"}(t.WebSocketManagerEvents||(t.WebSocketManagerEvents={}))},function(e,t,n){var r=n(54),i=n(55);e.exports=function(e,t,n){var o=t&&n||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var a=(e=e||{}).random||(e.rng||r)();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,t)for(var s=0;s<16;++s)t[o+s]=a[s];return t||i(a)}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=n(3),c=a(n(34)),u=n(24),l=a(n(0)),d=n(1);function h(e){return new Promise((function(t){window.setTimeout(t,e)}))}function f(e,t){return new Promise((function(n,r){t.timeout=t.timeout||s.getParameter("HTTP_CONNECT_TIMEOUT"),t.responseType=t.responseType||"json",t.data&&(t.data=JSON.stringify(t.data)),t.headers=t.headers||{},t.headers["Content-Type"]="application/json",t.method="POST",t.url=e,c.default.request(t).then((function(e){n(e.data)})).catch((function(e){c.default.isCancel(e)?r(new u.AgoraRTCError(u.AgoraRTCErrorCode.OPERATION_ABORT,"cancel token canceled")):"ECONNABORTED"===e.code?r(new u.AgoraRTCError(u.AgoraRTCErrorCode.NETWORK_TIMEOUT,e.message)):e.response?r(new u.AgoraRTCError(u.AgoraRTCErrorCode.NETWORK_RESPONSE_ERROR,e.response.status)):r(new u.AgoraRTCError(u.AgoraRTCErrorCode.NETWORK_ERROR,e.message))}))}))}function p(e,n,r,a){var s=this,c=Object.assign({},t.DEFAULT_RETRY_CONFIG,a),l=c.timeout,d=function(){return i(s,void 0,void 0,(function(){return o(this,(function(e){switch(e.label){case 0:return[4,h(l)];case 1:return e.sent(),l*=c.timeoutFactor,l=Math.min(c.maxRetryTimeout,l),[2]}}))}))},f=!1,p=new Promise((function(t,a){return i(s,void 0,void 0,(function(){var i,s,l;return o(this,(function(o){switch(o.label){case 0:n=n||function(){return!1},r=r||function(){return!0},i=0,o.label=1;case 1:if(!(i<c.maxRetryCount))return[3,12];if(f)return[2,a(new u.AgoraRTCError(u.AgoraRTCErrorCode.OPERATION_ABORT))];o.label=2;case 2:return o.trys.push([2,7,,11]),[4,e()];case 3:return s=o.sent(),n(s,i)?i+1===c.maxRetryCount?[2,t(s)]:[4,d()]:[3,5];case 4:return o.sent(),[3,6];case 5:return[2,t(s)];case 6:return[3,11];case 7:return l=o.sent(),r(l,i)?i+1===c.maxRetryCount?[2,a(l)]:[4,d()]:[3,9];case 8:return o.sent(),[3,10];case 9:return[2,a(l)];case 10:return[3,11];case 11:return i+=1,[3,1];case 12:return[2]}}))}))}));return p.cancel=function(){return f=!0},p}function A(e,t){return{addressList:e.servers.map((function(e,n){return"wss://"+e.address.replace(/\./g,"-")+".edge.agora.io:"+e.wss+"?serviceName="+encodeURIComponent(t)})),workerToken:e.workerToken,vid:e.vid}}t.wait=h,t.post=f,t.DEFAULT_RETRY_CONFIG={timeout:500,timeoutFactor:1.5,maxRetryCount:1/0,maxRetryTimeout:1e4},t.getRetryWaitTime=function(e,t){var n=t.timeout*Math.pow(t.timeoutFactor,e);return Math.min(t.maxRetryTimeout,n)},t.retryable=p,t.liveStreamingServerResponseToResult=A;var g=1;function v(e,n,a,c,h){var v=this;void 0===h&&(h=t.DEFAULT_RETRY_CONFIG),g+=1;var m,y,b={sid:a.sid,command:"convergeAllocateEdge",uid:"666",appId:a.appId,ts:Math.floor(Date.now()/1e3),seq:g,requestId:g,version:s.VERSION,cname:a.cname},E={service_name:n,json_body:JSON.stringify(b)},_=e[0];return p((function(){return i(v,void 0,void 0,(function(){var e,t,i,a,d;return o(this,(function(o){switch(o.label){case 0:return m=Date.now(),[4,f(_,{data:E,cancelToken:c,headers:{"X-Packet-Service-Type":"0","X-Packet-URI":"61"}})];case 1:if(e=o.sent(),y=Date.now()-m,0!==e.code)throw i=new u.AgoraRTCError(u.AgoraRTCErrorCode.UNEXPECTED_RESPONSE,"live streaming ap error, code"+e.code,{retry:!0}),l.default.error(i.toString()),i;if(200!==(t=JSON.parse(e.json_body)).code)throw i=new u.AgoraRTCError(u.AgoraRTCErrorCode.UNEXPECTED_RESPONSE,"live streaming app center error, code: "+t.code+", reason: "+t.reason),l.default.error(i.toString()),i;if(!t.servers||0===t.servers.length)throw i=new u.AgoraRTCError(u.AgoraRTCErrorCode.UNEXPECTED_RESPONSE,"live streaming app center empty server"),l.default.error(i.toString()),i;if(a=A(t,n),s.getParameter("LIVE_STREAMING_ADDRESS"))try{d=JSON.parse(s.getParameter("LIVE_STREAMING_ADDRESS")),a.addressList=d}catch(e){a.addressList=[s.getParameter("LIVE_STREAMING_ADDRESS")]}return[2,r(r({},a),{responseTime:y})]}}))}))}),(function(t,r){return d.report.requestApWorkerEvent(a.sid,{success:!0,sc:200,serviceName:n,responseDetail:JSON.stringify(t.addressList),firstSuccess:0===r,responseTime:y,serverIp:e[r%e.length]}),!1}),(function(t,r){return d.report.requestApWorkerEvent(a.sid,{success:!1,sc:t.data&&t.data.code||200,serviceName:n,responseTime:y,serverIp:e[r%e.length]}),!!(t.code!==u.AgoraRTCErrorCode.OPERATION_ABORT&&t.code!==u.AgoraRTCErrorCode.UNEXPECTED_RESPONSE||t.data&&t.data.retry)&&(_=e[(r+1)%e.length],!0)}),h)}t.requestLiveStreamingWorkerManager=v,t.getLiveStreamingWorkerMangerResult=function(e,t,n){return i(this,void 0,void 0,(function(){var r,i;return o(this,(function(o){switch(o.label){case 0:r=s.getParameter("UAP_AP").map((function(e){return t.proxyServer?"https://"+t.proxyServer+"/ap/?url="+e+"/api/v1?action=uap":"https://"+e+"/api/v1?action=uap"})),o.label=1;case 1:return o.trys.push([1,3,,4]),[4,v(r,e,t,n)];case 2:return[2,o.sent()];case 3:throw i=o.sent(),d.report.requestApWorkerEvent(t.sid,{success:!1,sc:i.data&&i.data.code||200,serviceName:e,responseTime:i.data&&i.data.responseTime}),i;case 4:return[2]}}))}))}},function(e,t,n){var r=n(68),i=n(69),o=n(31),a=n(70);e.exports=function(e){return r(e)||i(e)||o(e)||a()}},function(e,t,n){var r=n(32);e.exports=function(e,t){if(e){if("string"==typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}}},function(e,t){e.exports=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}},function(e,t,n){"use strict";var r=this&&this.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),i=0;for(t=0;t<n;t++)for(var o=arguments[t],a=0,s=o.length;a<s;a++,i++)r[i]=o[a];return r};Object.defineProperty(t,"__esModule",{value:!0});var i=n(24),o=function(){function e(){this._events={},this.addListener=this.on}return e.prototype.getListeners=function(e){return this._events[e]?this._events[e].map((function(e){return e.listener})):[]},e.prototype.on=function(e,t){this._events[e]||(this._events[e]=[]);var n=this._events[e];-1===this._indexOfListener(n,t)&&n.push({listener:t,once:!1})},e.prototype.once=function(e,t){this._events[e]||(this._events[e]=[]);var n=this._events[e];-1===this._indexOfListener(n,t)&&n.push({listener:t,once:!0})},e.prototype.off=function(e,t){if(this._events[e]){var n=this._events[e],r=this._indexOfListener(n,t);-1!==r&&n.splice(r,1),0===this._events[e].length&&delete this._events[e]}},e.prototype.removeAllListeners=function(e){e?delete this._events[e]:this._events={}},e.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];this._events[e]||(this._events[e]=[]);for(var r=this._events[e].map((function(e){return e})),i=0;i<r.length;i+=1){var o=r[i];o.once&&this.off(e,o.listener),o.listener.apply(this,t||[])}},e.prototype._indexOfListener=function(e,t){for(var n=e.length;n--;)if(e[n].listener===t)return n;return-1},e}();function a(e,t){for(var n=[],o=2;o<arguments.length;o++)n[o-2]=arguments[o];var a=null,s=null;if(e.emit.apply(e,r([t],n,[function(e){a=e},function(e){s=e}])),null!==s)throw s;if(null===a)throw new i.AgoraRTCError(i.AgoraRTCErrorCode.UNEXPECTED_ERROR,"handler is not sync");return a}t.EventEmitter=o,t.emitAsPromise=function(e,t){for(var n=[],o=2;o<arguments.length;o++)n[o-2]=arguments[o];return 0===e.getListeners(t).length?Promise.reject(new i.AgoraRTCError(i.AgoraRTCErrorCode.UNEXPECTED_ERROR,"can not emit promise")):new Promise((function(i,o){e.emit.apply(e,r([t],n,[i,o]))}))},t.emitAsInvokerNoResponse=function(e,t){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];return 0===e.getListeners(t).length?null:a.apply(void 0,r([e,t],n))},t.emitAsInvoker=a},function(e,t,n){e.exports=n(74)},function(e,t,n){"use strict";e.exports=function(e,t){return function(){for(var n=new Array(arguments.length),r=0;r<n.length;r++)n[r]=arguments[r];return e.apply(t,n)}}},function(e,t,n){"use strict";var r=n(18);function i(e){return encodeURIComponent(e).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}e.exports=function(e,t,n){if(!t)return e;var o;if(n)o=n(t);else if(r.isURLSearchParams(t))o=t.toString();else{var a=[];r.forEach(t,(function(e,t){null!=e&&(r.isArray(e)?t+="[]":e=[e],r.forEach(e,(function(e){r.isDate(e)?e=e.toISOString():r.isObject(e)&&(e=JSON.stringify(e)),a.push(i(t)+"="+i(e))})))})),o=a.join("&")}if(o){var s=e.indexOf("#");-1!==s&&(e=e.slice(0,s)),e+=(-1===e.indexOf("?")?"?":"&")+o}return e}},function(e,t,n){"use strict";e.exports=function(e){return!(!e||!e.__CANCEL__)}},function(e,t,n){"use strict";(function(t){var r=n(18),i=n(80),o={"Content-Type":"application/x-www-form-urlencoded"};function a(e,t){!r.isUndefined(e)&&r.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}var s,c={adapter:(("undefined"!=typeof XMLHttpRequest||void 0!==t&&"[object process]"===Object.prototype.toString.call(t))&&(s=n(39)),s),transformRequest:[function(e,t){return i(t,"Accept"),i(t,"Content-Type"),r.isFormData(e)||r.isArrayBuffer(e)||r.isBuffer(e)||r.isStream(e)||r.isFile(e)||r.isBlob(e)?e:r.isArrayBufferView(e)?e.buffer:r.isURLSearchParams(e)?(a(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):r.isObject(e)?(a(t,"application/json;charset=utf-8"),JSON.stringify(e)):e}],transformResponse:[function(e){if("string"==typeof e)try{e=JSON.parse(e)}catch(e){}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};r.forEach(["delete","get","head"],(function(e){c.headers[e]={}})),r.forEach(["post","put","patch"],(function(e){c.headers[e]=r.merge(o)})),e.exports=c}).call(this,n(79))},function(e,t,n){"use strict";var r=n(18),i=n(81),o=n(36),a=n(83),s=n(86),c=n(87),u=n(40);e.exports=function(e){return new Promise((function(t,l){var d=e.data,h=e.headers;r.isFormData(d)&&delete h["Content-Type"];var f=new XMLHttpRequest;if(e.auth){var p=e.auth.username||"",A=e.auth.password||"";h.Authorization="Basic "+btoa(p+":"+A)}var g=a(e.baseURL,e.url);if(f.open(e.method.toUpperCase(),o(g,e.params,e.paramsSerializer),!0),f.timeout=e.timeout,f.onreadystatechange=function(){if(f&&4===f.readyState&&(0!==f.status||f.responseURL&&0===f.responseURL.indexOf("file:"))){var n="getAllResponseHeaders"in f?s(f.getAllResponseHeaders()):null,r={data:e.responseType&&"text"!==e.responseType?f.response:f.responseText,status:f.status,statusText:f.statusText,headers:n,config:e,request:f};i(t,l,r),f=null}},f.onabort=function(){f&&(l(u("Request aborted",e,"ECONNABORTED",f)),f=null)},f.onerror=function(){l(u("Network Error",e,null,f)),f=null},f.ontimeout=function(){var t="timeout of "+e.timeout+"ms exceeded";e.timeoutErrorMessage&&(t=e.timeoutErrorMessage),l(u(t,e,"ECONNABORTED",f)),f=null},r.isStandardBrowserEnv()){var v=n(88),m=(e.withCredentials||c(g))&&e.xsrfCookieName?v.read(e.xsrfCookieName):void 0;m&&(h[e.xsrfHeaderName]=m)}if("setRequestHeader"in f&&r.forEach(h,(function(e,t){void 0===d&&"content-type"===t.toLowerCase()?delete h[t]:f.setRequestHeader(t,e)})),r.isUndefined(e.withCredentials)||(f.withCredentials=!!e.withCredentials),e.responseType)try{f.responseType=e.responseType}catch(t){if("json"!==e.responseType)throw t}"function"==typeof e.onDownloadProgress&&f.addEventListener("progress",e.onDownloadProgress),"function"==typeof e.onUploadProgress&&f.upload&&f.upload.addEventListener("progress",e.onUploadProgress),e.cancelToken&&e.cancelToken.promise.then((function(e){f&&(f.abort(),l(e),f=null)})),void 0===d&&(d=null),f.send(d)}))}},function(e,t,n){"use strict";var r=n(82);e.exports=function(e,t,n,i,o){var a=new Error(e);return r(a,t,n,i,o)}},function(e,t,n){"use strict";var r=n(18);e.exports=function(e,t){t=t||{};var n={},i=["url","method","params","data"],o=["headers","auth","proxy"],a=["baseURL","url","transformRequest","transformResponse","paramsSerializer","timeout","withCredentials","adapter","responseType","xsrfCookieName","xsrfHeaderName","onUploadProgress","onDownloadProgress","maxContentLength","validateStatus","maxRedirects","httpAgent","httpsAgent","cancelToken","socketPath"];r.forEach(i,(function(e){void 0!==t[e]&&(n[e]=t[e])})),r.forEach(o,(function(i){r.isObject(t[i])?n[i]=r.deepMerge(e[i],t[i]):void 0!==t[i]?n[i]=t[i]:r.isObject(e[i])?n[i]=r.deepMerge(e[i]):void 0!==e[i]&&(n[i]=e[i])})),r.forEach(a,(function(r){void 0!==t[r]?n[r]=t[r]:void 0!==e[r]&&(n[r]=e[r])}));var s=i.concat(o).concat(a),c=Object.keys(t).filter((function(e){return-1===s.indexOf(e)}));return r.forEach(c,(function(r){void 0!==t[r]?n[r]=t[r]:void 0!==e[r]&&(n[r]=e[r])})),n}},function(e,t,n){"use strict";function r(e){this.message=e}r.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},r.prototype.__CANCEL__=!0,e.exports=r},function(e,t){e.exports=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var s=o(n(56)),c=a(n(60)),u=a(n(61)),l=o(n(0)),d=n(3),h=s.default.Root.fromJSON(u),f=function(){function e(){this.requestArray=[],this.retryBackoffCount=0,this.state=0}return e.prototype.setProxy=function(e){this.proxyServer=e},e.prototype.sendReportList=function(e,t){var n=this,r=this._dataConvert("ProtoRaws",{vid:t,sendTs:Math.round(Date.now()/1e3),payloads:e.map((function(e){return{id:c[e.type],msg:n._dataConvert(e.type,e.data)}}))});this.send(r)},e.prototype._dataConvert=function(e,t){var n;try{n=h.lookupType("protobuf."+e)}catch(t){l.default.error("[send-proto] invalid proto name "+e)}var r=n.create(t);return n.encode(r).finish()},e.prototype.send=function(e){0==this.state?this._send(e):this.requestArray.push(e)},e.prototype._send=function(e){return r(this,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,4]),this.state=1,[4,this.request(e)];case 1:return t.sent(),this.retryBackoffCount=0,0!==this.requestArray.length?this._send(this.requestArray.shift()):this.state=0,[3,4];case 2:return t.sent(),[4,p(this.retryBackoffCount++<2?200:1e4)];case 3:return t.sent(),this._send(e),[3,4];case 4:return[2]}}))}))},e.prototype.request=function(e){return r(this,void 0,void 0,(function(){var t,n;return i(this,(function(r){switch(r.label){case 0:t=this._getAddress(),n=this._getBackupAddress(),r.label=1;case 1:return r.trys.push([1,3,,5]),[4,this._request(t,e)];case 2:return r.sent(),[3,5];case 3:return r.sent(),[4,this._request(n,e)];case 4:return r.sent(),[3,5];case 5:return[2]}}))}))},e.prototype._request=function(e,t){return this._post(e,t)},e.prototype._post=function(e,t){var n=this;return new Promise((function(r,i){var o=new XMLHttpRequest;o.timeout=d.getParameter("HTTP_CONNECT_TIMEOUT"),o.open("POST",e,!0),o.setRequestHeader("Content-type","application/octet-stream"),n.proxyServer||(o.setRequestHeader("Cache-Control","no-cache, no-store"),o.setRequestHeader("Pragma","no-cache"),o.setRequestHeader("Expires","0")),o.onload=function(e){r(o.responseText)},o.onerror=function(e){i(e)},o.ontimeout=function(e){i(e)},o.send(t)}))},e.prototype._getAddress=function(){return this.proxyServer?"https://"+this.proxyServer+"/rs/?h="+d.getParameter("EVENT_REPORT_DOMAIN")+"&p=6443&d=events/proto-raws":"https://"+d.getParameter("EVENT_REPORT_DOMAIN")+":6443/events/proto-raws"},e.prototype._getBackupAddress=function(){return this.proxyServer?"https://"+this.proxyServer+"/rs/?h="+d.getParameter("EVENT_REPORT_BACKUP_DOMAIN")+"&p=6443&d=events/proto-raws":"https://"+d.getParameter("EVENT_REPORT_BACKUP_DOMAIN")+":6443/events/proto-raws"},e}();t.default=f;var p=function(e){return new Promise((function(t){window.setTimeout(t,e)}))}},function(e,t){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},function(e,t){function n(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}e.exports=function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a,s=o(n(0)),c=n(15);!function(e){e.NEW="new",e.PREPARING_OFFER="preparing-offer",e.OFFER_SENT="offer-sent",e.ESTABLISHED="established",e.CLOSED="closed"}(a||(a={}));var u=function(){function e(e){this.candidate=null,this.state=a.NEW,this.config=e,this.isSubscriber=this.config.isSubscriber,this.peerConnection=this.initPeecConnection(e),this.peerConnection.onicecandidate=this._onicecandidate.bind(this),this.peerConnection.oniceconnectionstatechange=this._oniceconnectionstatechange.bind(this),this.peerConnection.onaddstream=this._onaddstream.bind(this),this.peerConnection.ontrack=this._ontrack.bind(this),this.processSignalingMessage=this.setAnswer.bind(this),this.peerConnection.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0}).then(this.setLocalSDP.bind(this)),this.sendVideoStats={id:"",type:"",mediaType:"",googCodecName:this.config.codec.toUpperCase(),bytesSent:"0",packetsLost:"0",packetsSent:"0",googAdaptationChanges:"0",googAvgEncodeMs:"0",googEncodeUsagePercent:"0",googFirsReceived:"0",googFrameHeightSent:"0",googFrameHeightInput:"0",googFrameRateInput:"0",googFrameRateSent:"0",googFrameWidthSent:"0",googFrameWidthInput:"0",googNacksReceived:"0",googPlisReceived:"0",googRtt:"0",googFramesEncoded:"0"},this.sendAudioStats={id:"",type:"",mediaType:"",googCodecName:"opus",aecDivergentFilterFraction:"0",audioInputLevel:"0",bytesSent:"0",packetsSent:"0",googEchoCancellationReturnLoss:"0",googEchoCancellationReturnLossEnhancement:"0"},this.receiveAudioStats={id:"",type:"",mediaType:"",audioOutputLevel:"0",bytesReceived:"0",packetsLost:"0",packetsReceived:"0",googAccelerateRate:"0",googCurrentDelayMs:"0",googDecodingCNG:"0",googDecodingCTN:"0",googDecodingCTSG:"0",googDecodingNormal:"0",googDecodingPLC:"0",googDecodingPLCCNG:"0",googExpandRate:"0",googJitterBufferMs:"0",googJitterReceived:"0",googPreemptiveExpandRate:"0",googPreferredJitterBufferMs:"0",googSecondaryDecodedRate:"0",googSpeechExpandRate:"0"},this.receiveVideoStats={id:"",type:"",mediaType:"",googTargetDelayMs:"0",packetsLost:"0",googDecodeMs:"0",googMaxDecodeMs:"0",googRenderDelayMs:"0",googFrameWidthReceived:"0",googFrameHeightReceived:"0",googFrameRateReceived:"0",googFrameRateDecoded:"0",googFrameRateOutput:"0",googFramesDecoded:"0",googFrameReceived:"0",googJitterBufferMs:"0",googCurrentDelayMs:"0",googMinPlayoutDelayMs:"0",googNacksSent:"0",googPlisSent:"0",googFirsSent:"0",bytesReceived:"0",packetsReceived:"0"}}return e.prototype.addStream=function(e){this.peerConnection.addStream(e)},e.prototype.setRtpSenderParameters=function(e){return r(this,void 0,void 0,(function(){return i(this,(function(e){return[2]}))}))},e.prototype.setAnswer=function(e){var t=JSON.parse(e);this.peerConnection.setRemoteDescription(new RTCSessionDescription({sdp:t.sdp,type:"answer"})),this.onsignalingmessage&&this.onsignalingmessage("")},e.prototype.close=function(){this.peerConnection.close()},e.prototype.getStats=function(e,t){if(void 0===t&&(t=500),t=t>500?500:t,Date.now()-this.lastTimeGetStats<t){var n=[];this.config.isSubscriber?(n.push(this.receiveVideoStats),n.push(this.receiveAudioStats)):(n.push(this.sendAudioStats),n.push(this.sendVideoStats)),n.push({id:"time",startTime:this.connectedTime,timestamp:Date.now()}),e&&e(n)}else this._getStats(e)},e.prototype._getStats=function(e){var t=this,n=[];this.peerConnection.getStats(null).then((function(r){t.lastTimeGetStats=Date.now(),Object.keys(r).map((function(e){var n=r[e];t.config.isSubscriber?n.type&&"inboundrtp"===n.type&&n.mediaType&&"audio"===n.mediaType?(t.receiveAudioStats.id=n.id+"recv",t.receiveAudioStats.type=n.type+"",t.receiveAudioStats.mediaType=n.mediaType+"",t.receiveAudioStats.packetsReceived=n.packetsReceived+"",t.receiveAudioStats.bytesReceived=n.bytesReceived+"",t.receiveAudioStats.packetsLost=n.packetsLost+"",t.receiveAudioStats.googJitterReceived=n.jitter+""):n.type&&"inboundrtp"===n.type&&n.mediaType&&"video"===n.mediaType?(t.receiveVideoStats.id=n.id+"recv",t.receiveVideoStats.type=n.type+"",t.receiveVideoStats.mediaType=n.mediaType+"",t.receiveVideoStats.packetsReceived=n.packetsReceived+"",t.receiveVideoStats.bytesReceived=n.bytesReceived+"",t.receiveVideoStats.packetsLost=n.packetsLost+"",t.receiveVideoStats.googJitterBufferMs=n.jitter+"",t.receiveVideoStats.googPlisSent=n.pliCount+"",t.receiveVideoStats.googFirsSent=n.firCount+"",t.receiveVideoStats.googNacksSent=n.nackCount+""):n.remoteSource&&n.type&&"track"===n.type&&n.trackIdentifier&&-1!==n.trackIdentifier.indexOf("v")?(t.receiveVideoStats.googFrameHeightReceived=n.frameHeight+"",t.receiveVideoStats.googFrameWidthReceived=n.frameWidth+"",t.receiveVideoStats.googFrameRateDecoded=n.framesPerSecond+"",t.receiveVideoStats.googFrameRateOutput=n.framesPerSecond+"",t.receiveVideoStats.googFrameRateReceived=n.framesPerSecond+"",t.receiveVideoStats.googFramesDecoded=n.framesDecoded+"",t.receiveVideoStats.googFrameReceived=n.framesReceived+""):n.remoteSource&&n.type&&"track"===n.type&&n.trackIdentifier&&-1!==n.trackIdentifier.indexOf("a")&&(t.receiveAudioStats.audioOutputLevel=n.audioLevel+""):!n.isRemote&&n.type&&"outboundrtp"===n.type&&n.mediaType&&"audio"===n.mediaType?(t.sendAudioStats.id=n.id+"send",t.sendAudioStats.type=n.type+"",t.sendAudioStats.mediaType=n.mediaType+"",t.sendAudioStats.packetsSent=n.packetsSent+"",t.sendAudioStats.bytesSent=n.bytesSent+""):!n.isRemote&&n.type&&"outboundrtp"===n.type&&n.mediaType&&"video"===n.mediaType?(t.sendVideoStats.id=n.id+"send",t.sendVideoStats.type=n.type+"",t.sendVideoStats.mediaType=n.mediaType+"",t.sendVideoStats.packetsSent=n.packetsSent+"",t.sendVideoStats.bytesSent=n.bytesSent+"",t.sendVideoStats.googRtt=n.roundTripTime+"",t.sendVideoStats.googPlisReceived=n.pliCount+"",t.sendVideoStats.googFirsReceived=n.firCount+"",t.sendVideoStats.googNacksReceived=n.nackCount+""):!n.remoteSource&&n.type&&"track"===n.type&&n.framesSent&&0!==n.framesSent&&(t.sendVideoStats.googFrameHeightSent=n.frameHeight+"",t.sendVideoStats.googFrameHeightInput=n.frameHeight+"",t.sendVideoStats.googFrameWidthSent=n.frameWidth+"",t.sendVideoStats.googFrameWidthInput=n.frameWidth+"",t.sendVideoStats.googFramesEncoded=n.framesSent+"",t.sendVideoStats.googFrameRateSent=n.framesPerSecond+"")})),t.config.isSubscriber?(n.push(t.receiveVideoStats),n.push(t.receiveAudioStats)):(n.push(t.sendAudioStats),n.push(t.sendVideoStats)),n.push({id:"time",startTime:t.connectedTime,timestamp:Date.now()}),e&&e(n)}))},e.prototype.getStatsRate=function(e){this.getStats(e)},e.prototype.initPeecConnection=function(e){var t=e.stunServerUrl,n=e.turnServer,r=e.iceServers;return this.pcConfig={iceServers:[{urls:"stun:webcs.agora.io:3478"}]},r instanceof Array?this.pcConfig.iceServers=e.iceServers:t&&(t instanceof Array?t.map((function(e){"string"==typeof e&&""!==e&&this.pcConfig.iceServers.push({urls:e})})):"string"==typeof t&&""!==t&&this.pcConfig.iceServers.push({urls:t})),n&&(n instanceof Array?n.map((function(e){"string"==typeof e.url&&""!==e.url&&this.pcConfig.iceServers.push({username:e.username,credential:e.credential,url:e.url})})):"auto"!==n.mode&&"manual"!==n.mode||(n.udpport&&this.pcConfig.iceServers.push({username:n.username,credential:n.credential,credentialType:"password",urls:"turn:"+n.url+":"+n.udpport+"?transport=udp"}),"string"==typeof n.tcpport&&""!==n.tcpport&&this.pcConfig.iceServers.push({username:n.username,credential:n.credential,credentialType:"password",urls:"turn:"+n.url+":"+n.tcpport+"?transport=tcp"}),!0===n.forceturn&&(this.pcConfig.iceTransportPolicy="relay"))),new c.RTCPeerConnection(this.pcConfig)},e.prototype._ontrack=function(e){this.onaddstream&&this.onaddstream(e,"ontrack")},e.prototype._onaddstream=function(e){this.onaddstream&&this.onaddstream(e,"onaddstream")},e.prototype._oniceconnectionstatechange=function(e){"connected"===e.currentTarget.iceConnectionState&&(this.state=a.ESTABLISHED,this.connectedTime=Date.now()),this.oniceconnectionstatechange&&this.oniceconnectionstatechange(e.currentTarget.iceConnectionState)},e.prototype._onicecandidate=function(e){!this.candidate&&e&&(this.candidate=e.candidate,this.peerConnection.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0}).then(this.editLocalSDP.bind(this)).then(this.setLocalSDP.bind(this)).then(this.sendOffer.bind(this)).catch())},e.prototype.setLocalSDP=function(e){return this.peerConnection.setLocalDescription(new RTCSessionDescription({sdp:e.sdp,type:"offer"})),this.state=a.PREPARING_OFFER,e},e.prototype.editLocalSDP=function(e){return e.sdp=this.setBandWidth(e.sdp),e.sdp=this.reviseOpus(e.sdp),e.sdp=this.addCandidate(e.sdp),e},e.prototype.setSendRecv=function(e){return(e=(e=e.replace(/a=recvonly\r\n/g,"a=sendrecv\r\n")).replace(/a=sendonly\r\n/g,"a=sendrecv\r\n")).replace(/a=inactive\r\n/g,"a=sendrecv\r\n")},e.prototype.setBandWidth=function(e){var t,n,r=this.config,i=r.codec,o=r.minVideoBW,a=r.maxVideoBW,c=r.maxAudioBW,u=r.clientId;if((t=e.match(/m=video.*\r\n/))&&o&&a){n=t[0]+"b=AS:"+a+"\r\n";var l=0,d=0;"h264"===i?(l=e.search(/a=rtpmap:(\d+) H264\/90000\r\n/),d=e.search(/H264\/90000\r\n/)):"vp8"===i?(l=e.search(/a=rtpmap:(\d+) VP8\/90000\r\n/),d=e.search(/VP8\/90000\r\n/)):"vp9"===i&&(l=e.search(/a=rtpmap:(\d+) VP9\/90000\r\n/),d=e.search(/VP9\/90000\r\n/)),-1!==l&&-1!==d&&d-l>10&&(n=n+"a=fmtp:"+e.slice(l+9,d-1)+" x-google-min-bitrate="+o+"\r\n"),e=e.replace(t[0],n),s.default.debug("["+u+"]Set Video Bitrate - min:"+o+" max:"+a)}return(t=e.match(/m=audio.*\r\n/))&&c&&(n=t[0]+"b=AS:"+c+"\r\n",e=e.replace(t[0],n)),e},e.prototype.reviseOpus=function(e){return(e=e.replace(/a=rtpmap:102 opus\/48000\/2/g,"a=rtpmap:111 opus/48000/2")).replace(/m=audio 9 UDP\/TLS\/RTP\/SAVPF 102 0 8 97 13 118 101/g,"m=audio 9 UDP/TLS/RTP/SAVPF 111 0 8 97 13 118 101")},e.prototype.addCandidate=function(e){return e+"a=candidate:2243255435 1 udp 2122194687 192.168.0.1 30000 typ host generation 0 network-id 1\r\n"},e.prototype.sendOffer=function(e){this.config.callback(JSON.stringify({sdp:e.sdp,messageType:"OFFER",tiebreaker:Math.floor(429496723*Math.random()+1)})),this.state=a.OFFER_SENT},e}();t.default=u},function(e,t,n){var r=n(63),i=n(64),o=n(31),a=n(65);e.exports=function(e,t){return r(e)||i(e,t)||o(e,t)||a()}},function(e,t,n){var r,i,o;i=this,o=function(){"use strict";var e,t=this;function n(e){t.console&&(t.console.error?t.console.error(e):t.console.log&&t.console.log(e))}function r(e,t,r,i){var o=i||n,a=e.createShader(r);return e.shaderSource(a,t),e.compileShader(a),e.getShaderParameter(a,e.COMPILE_STATUS)?a:(o("*** Error compiling shader '"+a+"':"+e.getShaderInfoLog(a)),e.deleteShader(a),null)}function i(e,t,r,i,o){var a=o||n,s=e.createProgram();return t.forEach((function(t){e.attachShader(s,t)})),r&&r.forEach((function(t,n){e.bindAttribLocation(s,i?i[n]:n,t)})),e.linkProgram(s),e.getProgramParameter(s,e.LINK_STATUS)?s:(a("Error in program linking:"+e.getProgramInfoLog(s)),e.deleteProgram(s),null)}(e=e||t)===e.top&&(console.log("%c%s","color:blue;font-weight:bold;","for more about webgl-utils.js see:"),console.log("%c%s","color:blue;font-weight:bold;","http://webglfundamentals.org/webgl/lessons/webgl-boilerplate.html"));var o,a=["VERTEX_SHADER","FRAGMENT_SHADER"];return!document.documentMode&&!!window.StyleMedia&&(HTMLCanvasElement.prototype.getContext=(o=HTMLCanvasElement.prototype.getContext,function(){var e=arguments,t=e[0];return"webgl"===t&&((e=[].slice.call(arguments))[0]="experimental-webgl"),o.apply(this,e)})),{createProgram:i,createProgramFromSources:function(e,t,n,o,s){for(var c=[],u=0;u<t.length;++u)c.push(r(e,t[u],e[a[u]],s));return i(e,c,n,o,s)}}},void 0===(r=function(){return o.call(i)}.apply(t,[]))||(e.exports=r)},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=n(66),s=n(4),c=o(n(0));t.getSupportedCodec=function(e){return r(void 0,void 0,void 0,(function(){var t,n,r,o,l;return i(this,(function(i){switch(i.label){case 0:return t={video:[],audio:[]},"undefined"!=typeof window?[3,1]:(c.default.error("getSupportedCodec: NOT_BROWSER_ENV"),[2,Promise.reject("NOT_BROWSER_ENV")]);case 1:try{n=a.createRTCPeerConnection({iceServers:[]})}catch(e){return c.default.error("Failed to init RTCPeerConnection",e),[2,Promise.reject(e)]}return n?[3,2]:(c.default.warning("getSupportedCodec: no RTCPeerConnection constructor is detected"),[2,Promise.resolve(t)]);case 2:return e&&e.stream?[3,7]:(r={mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!0}},o=void 0,(s.isSafari()||s.isFireFox()||s.isWeChatBrowser())&&n.addTransceiver?(n.addTransceiver("audio"),n.addTransceiver("video"),[4,n.createOffer()]):[3,4]);case 3:return o=i.sent(),[3,6];case 4:return[4,new Promise((function(e,t){var i=setTimeout((function(){t("CREATEOFFER_TIMEOUT")}),3e3);n.createOffer((function(t){clearTimeout(i),e(t)}),(function(e){clearTimeout(i),t(e)}),r)}))];case 5:o=i.sent(),i.label=6;case 6:return n.close(),l=o.sdp,[2,u(l)];case 7:return e.stream.getTracks&&n.addTrack?e.stream.getTracks().forEach((function(t){n.addTrack(t,e.stream)})):n.addStream(e.stream),o=void 0,s.isSafari()||s.isFireFox()?[4,n.createOffer()]:[3,9];case 8:return o=i.sent(),[3,11];case 9:return[4,new Promise((function(e,t){n.createOffer(e,t)}))];case 10:o=i.sent(),i.label=11;case 11:return n.close(),l=o.sdp,[2,u(l)]}}))}))};var u=function(e){var t={video:[],audio:[]};return e.match(/ VP8/i)&&t.video.push("VP8"),e.match(/ VP9/i)&&t.video.push("VP9"),e.match(/ H264/i)&&t.video.push("H264"),e.match(/ opus/i)&&t.audio.push("OPUS"),Promise.resolve(t)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.encryptAES=function(e,t){for(var n,r,i,o,a=e.length,s=(n=e,(new TextEncoder).encode(n)),c=function(e,t){if(0===t)return e;var n=new e.constructor(e.length+t),r=new e.constructor(t);return n.set(e,0),n.set(r,e.length),n}(s,(4-s.length%4)%4),u=(r=[a],i=new Uint32Array(c.buffer),(o=new Uint32Array(r.length+i.length)).set(r,0),o.set(i,r.length),o),l=0;l<u.length;l++)u[l]=u[l]^t,u[l]=~u[l];return function(e){for(var t="",n=0;n<e.length;n+=1)t+=String.fromCharCode(e[n]);return window.btoa(t)}(new Uint8Array(u.buffer))}},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=o(n(0)),s=n(71),c=n(24),u=n(1),l=n(27);t.addLiveStreamingCapability=function(e,t){var n=this,o=function(t){var n=t.type;if(!e.joinInfo)return new c.AgoraRTCError(c.AgoraRTCErrorCode.INVALID_OPERATION,"can not create live streaming client, please join channel first").throw();switch(n){case l.LiveStreamingServiceMode.INJECT:return e._injectStreamingClient||(e._injectStreamingClient=new s.AgoraRTCLiveStreamingClient(e.joinInfo),e._injectStreamingClient.onInjectStatusChange=function(t,n,r){e.gatewayClient.dispatchEvent({type:"streamInjectedStatus",url:r,status:t})}),e._injectStreamingClient;case l.LiveStreamingServiceMode.RAW:return e._liveRawStreamingClient||(e._liveRawStreamingClient=new s.AgoraRTCLiveStreamingClient(e.joinInfo),e._liveRawStreamingClient.setGatewayConnectionState(e.getConnectionState()),e.on("connection-state-change",(function(t){e._liveRawStreamingClient.setGatewayConnectionState(t.curState),"CONNECTING"===t.prevState&&"CONNECTED"===t.curState&&e._liveRawStreamingClient&&e._liveRawStreamingClient.resetAllTask()})),e._liveRawStreamingClient.onLiveStreamError=function(t,n){a.default.error("LIVE_STREAMING_ERROR",n.toString()),e.gatewayClient.dispatchEvent({type:"liveStreamingFailed",url:t,reason:n.code})},e._liveRawStreamingClient.onLiveStreamWarning=function(t,n){a.default.warning("LIVE_STREAMING_WARNING",n.toString()),e.gatewayClient.dispatchEvent({type:"liveStreamingWarning",url:t,reason:n.code})}),e._liveRawStreamingClient;case l.LiveStreamingServiceMode.TRANSCODE:return e._liveTranscodeStreamingClient||(e._liveTranscodeStreamingClient=new s.AgoraRTCLiveStreamingClient(e.joinInfo),e._liveTranscodeStreamingClient.setGatewayConnectionState(e.getConnectionState()),e.on("connection-state-change",(function(t){e._liveTranscodeStreamingClient.setGatewayConnectionState(t.curState),"CONNECTING"===t.prevState&&"CONNECTED"===t.curState&&e._liveTranscodeStreamingClient&&e._liveTranscodeStreamingClient.resetAllTask()})),e._liveTranscodeStreamingClient.onLiveStreamError=function(t,n){a.default.error("LIVE_STREAMING_ERROR",n.toString()),e.gatewayClient.dispatchEvent({type:"liveStreamingFailed",url:t,reason:n.code})},e._liveTranscodeStreamingClient.onLiveStreamWarning=function(t,n){a.default.warning("LIVE_STREAMING_WARNING",n.toString()),e.gatewayClient.dispatchEvent({type:"liveStreamingWarning",url:t,reason:n})}),e._liveTranscodeStreamingClient}};e.gatewayClient.addEventListener("join",(function(t){e._injectStreamingClient&&e._injectStreamingClient.resetAllTask()})),e.gatewayClient.addEventListener("stream-unpublished",(function(t){t.options&&0===t.options.streamType&&(e._liveRawStreamingClient&&e._liveRawStreamingClient.resetAllTask(),e._liveTranscodeStreamingClient&&e._liveTranscodeStreamingClient.resetAllTask())})),e.gatewayClient.addEventListener("stream-published",(function(e){})),e.startLiveStreaming=function(n,r){a.default.debug("startLiveStreaming");var i=u.report.reportApiInvoke(t.sessionId,{name:"Client.startLiveStreaming",options:arguments,tag:"tracer"});if(e.gatewayClient&&"audience"===e.gatewayClient.role){var o={code:403,reason:"AUDIENCE_STREAMING_FORBIDDEN"};throw i(o),o}var s=e._startLiveStreaming(n,r);return s.then((function(e){i(null,e)})).catch((function(t){a.default.error("LIVE_STREAMING_ERROR",t.toString()),e.gatewayClient.dispatchEvent({type:"liveStreamingFailed",url:n,reason:t.code}),i(t)})),s},e._startLiveStreaming=function(s,u){return r(n,void 0,void 0,(function(){var n;return i(this,(function(r){switch(r.label){case 0:return u||("vp8"===t.codec&&a.default.warning("VP8 is not supported by raw_streaming. Subscriber side will suffer"),"vp9"===t.codec&&a.default.warning("VP9 is not supported by raw_streaming. Subscriber side will suffer"),"rtc"===t.mode&&a.default.warning("RTC mode is not supported by raw_streaming. Subscriber side will suffer")),(e._liveRawStreamingClient&&e._liveRawStreamingClient.haveUrl(s)||e._liveTranscodeStreamingClient&&e._liveTranscodeStreamingClient.haveUrl(s))&&new c.AgoraRTCError(c.AgoraRTCErrorCode.LIVE_STREAMING_TASK_CONFLICT).throw(),n=u?l.LiveStreamingServiceMode.TRANSCODE:l.LiveStreamingServiceMode.RAW,[4,o({type:n}).startLiveStreamingTask(s,n)];case 1:return r.sent(),e.gatewayClient.dispatchEvent({type:"liveStreamingStarted",url:s}),[2]}}))}))},e.setLiveTranscoding=function(n){a.default.debug("setLiveTranscoding: "+JSON.stringify(n));var r=u.report.reportApiInvoke(t.sessionId,{name:"Client.setLiveTranscoding",options:arguments,tag:"tracer"}),i=o({type:l.LiveStreamingServiceMode.TRANSCODE});return i.setTranscodingConfig(n).then((function(){e.gatewayClient.dispatchEvent({type:"liveTranscodingUpdated"}),r(null)})).catch((function(t){a.default.error("SET_LIVE_TRANSCODING_ERROR",t.toString()),e.gatewayClient.dispatchEvent({type:"liveStreamingFailed",reason:t.code}),r(t)}))},e.stopLiveStreaming=function(n){var r=u.report.reportApiInvoke(t.sessionId,{name:"Client.stopLiveStreaming",options:arguments,tag:"tracer"}),i=e._stopLiveStreaming(n);return i.then((function(e){r(null,e)})).catch((function(t){a.default.error("STOP_LIVE_STREAMING_ERROR",t.toString()),e.gatewayClient.dispatchEvent({type:"liveStreamingFailed",url:n,reason:t.code}),r(t)})),i},e._stopLiveStreaming=function(t){return r(this,void 0,void 0,(function(){var n;return i(this,(function(r){switch(r.label){case 0:return a.default.debug("stopLiveStreaming: "+JSON.stringify(t)),n=[e._liveRawStreamingClient,e._liveTranscodeStreamingClient],[4,Promise.all(n.map((function(e){return e&&e.haveUrl(t)&&e.stopLiveStreamingTask(t)})))];case 1:return r.sent(),a.default.debug("stopLiveStreaming sucess: "+JSON.stringify(t)),e.gatewayClient.dispatchEvent({type:"liveStreamingStopped",url:t}),[2]}}))}))},e.addInjectStreamUrl=function(n,r){var i=u.report.reportApiInvoke(t.sessionId,{name:"Client.addInjectStreamUrl",options:[n,r],tag:"tracer"});if("audience"===e.gatewayClient.role){var o={code:403,reason:"AUDIENCE_INJECTING_FORBIDDEN"};throw i(o),o}var s=e._addInjectStreamUrl(n,r);return s.then((function(e){i(null,e)})).catch((function(e){a.default.error("ADD_INJECT_STREAM_ERROR",e.toString()),i(e)})),s},e._addInjectStreamUrl=function(e,t){return r(n,void 0,void 0,(function(){var n;return i(this,(function(r){switch(r.label){case 0:return(n=o({type:l.LiveStreamingServiceMode.INJECT})).setInjectStreamConfig(t,0),[4,n.startLiveStreamingTask(e,l.LiveStreamingServiceMode.INJECT)];case 1:return r.sent(),[2]}}))}))},e.removeInjectStreamUrl=function(n){return r(this,void 0,void 0,(function(){var r,o;return i(this,(function(i){return r=u.report.reportApiInvoke(t.sessionId,{name:"Client.removeInjectStreamUrl",options:[n],tag:"tracer"}),(o=e._removeInjectStreamUrl(n)).then((function(e){r(null,e)})).catch((function(e){a.default.error("REMOVE_INJECT_STREAM_ERROR",e.toString()),r(e)})),[2,o]}))}))},e._removeInjectStreamUrl=function(e){return r(n,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:return[4,o({type:l.LiveStreamingServiceMode.INJECT}).stopLiveStreamingTask(e)];case 1:return t.sent(),[2]}}))}))},e._terminateLiveStreaming=function(){return r(n,void 0,void 0,(function(){return i(this,(function(t){return[e._injectStreamingClient,e._liveRawStreamingClient,e._liveTranscodeStreamingClient].forEach((function(e){e&&e.terminate()})),[2]}))}))}}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(5)),o=r(n(0)),a=n(10);t.default=function(e,t){void 0===t&&(t={width:160,height:120,framerate:15});var n=t.width,r=t.height,s=t.framerate,c=e.stream;if(!c)throw i.default.INVALID_LOCAL_STREAM;if(!c.getVideoTracks()[0])throw i.default.HIGH_STREAM_NOT_VIDEO_TRACE;var u=c.getVideoTracks()[0];o.default.debug("Start getLowStream");var l=document.createElement("video"),d=document.createElement("canvas");l.setAttribute("style","display:none"),l.setAttribute("muted",""),l.muted=!0,l.setAttribute("autoplay",""),l.autoplay=!0,l.setAttribute("playsinline",""),d.setAttribute("style","display:none"),d.setAttribute("width",n.toString()),d.setAttribute("height",r.toString());var h=d.getContext("2d");if(!h)throw new Error("not get canvas context");l.srcObject=c,document.body.append(l),document.body.append(d),l.play(),o.default.debug("Start render lowStream");var f=a.audioTimerLoop((function(){return function(){if(l.paused&&l.play(),l.videoHeight>2&&l.videoWidth>2){var t=l.videoWidth,n=l.videoHeight/t,r=d.width*n;Math.abs(r-d.height)>=2&&(o.default.debug("adjust low stream resolution",d.width+"x"+d.height+" -> "+d.width+"x"+r),d.height=r)}h.drawImage(l,0,0,d.width,d.height);var i=e.stream;if(i){var a=i.getVideoTracks()[0];u!==a&&(o.default.debug("adjust low stream track"),l.srcObject=i,u=a)}}()}),s),p=d.captureStream(s),A=p.getVideoTracks()[0];return A.requestFrame&&A.requestFrame(),p.clean=function(){o.default.debug("Start clean lowStream"),f(),(l||l.parentNode||l.parentNode.removeChild)&&l.parentNode.removeChild(l),(d||d.parentNode||d.parentNode.removeChild)&&d.parentNode.removeChild(d),o.default.debug("Clean lowStream")},p}},function(e,t){var n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(n){var r=new Uint8Array(16);e.exports=function(){return n(r),r}}else{var i=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),i[t]=e>>>((3&t)<<3)&255;return i}}},function(e,t){for(var n=[],r=0;r<256;++r)n[r]=(r+256).toString(16).substr(1);e.exports=function(e,t){var r=t||0,i=n;return[i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]]].join("")}},function(module,exports,__webpack_require__){(function(global,module){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;
/*!
 * protobuf.js v6.10.0 (c) 2016, daniel wirtz
 * compiled wed, 15 jul 2020 23:34:13 utc
 * licensed under the bsd-3-clause license
 * see: https://github.com/dcodeio/protobuf.js for details
 */!function(undefined){"use strict";!function(e,t,n){var r=function n(r){var i=t[r];return i||e[r][0].call(i=t[r]={exports:{}},n,i,i.exports),i.exports}(16);r.util.global.protobuf=r,__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__(59)],(__WEBPACK_AMD_DEFINE_RESULT__=function(e){return e&&e.isLong&&(r.util.Long=e,r.configure()),r}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__))===undefined||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__),module&&module.exports&&(module.exports=r)}({1:[function(e,t,n){t.exports=function(e,t){for(var n=new Array(arguments.length-1),r=0,i=2,o=!0;i<arguments.length;)n[r++]=arguments[i++];return new Promise((function(i,a){n[r]=function(e){if(o)if(o=!1,e)a(e);else{for(var t=new Array(arguments.length-1),n=0;n<t.length;)t[n++]=arguments[n];i.apply(null,t)}};try{e.apply(t||null,n)}catch(e){o&&(o=!1,a(e))}}))}},{}],2:[function(e,t,n){var r=n;r.length=function(e){var t=e.length;if(!t)return 0;for(var n=0;--t%4>1&&"="===e.charAt(t);)++n;return Math.ceil(3*e.length)/4-n};for(var i=new Array(64),o=new Array(123),a=0;a<64;)o[i[a]=a<26?a+65:a<52?a+71:a<62?a-4:a-59|43]=a++;r.encode=function(e,t,n){for(var r,o=null,a=[],s=0,c=0;t<n;){var u=e[t++];switch(c){case 0:a[s++]=i[u>>2],r=(3&u)<<4,c=1;break;case 1:a[s++]=i[r|u>>4],r=(15&u)<<2,c=2;break;case 2:a[s++]=i[r|u>>6],a[s++]=i[63&u],c=0}s>8191&&((o||(o=[])).push(String.fromCharCode.apply(String,a)),s=0)}return c&&(a[s++]=i[r],a[s++]=61,1===c&&(a[s++]=61)),o?(s&&o.push(String.fromCharCode.apply(String,a.slice(0,s))),o.join("")):String.fromCharCode.apply(String,a.slice(0,s))},r.decode=function(e,t,n){for(var r,i=n,a=0,s=0;s<e.length;){var c=e.charCodeAt(s++);if(61===c&&a>1)break;if((c=o[c])===undefined)throw Error("invalid encoding");switch(a){case 0:r=c,a=1;break;case 1:t[n++]=r<<2|(48&c)>>4,r=c,a=2;break;case 2:t[n++]=(15&r)<<4|(60&c)>>2,r=c,a=3;break;case 3:t[n++]=(3&r)<<6|c,a=0}}if(1===a)throw Error("invalid encoding");return n-i},r.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}},{}],3:[function(e,t,n){function r(e,t){"string"==typeof e&&(t=e,e=undefined);var n=[];function i(e){if("string"!=typeof e){var t=o();if(r.verbose&&console.log("codegen: "+t),t="return "+t,e){for(var a=Object.keys(e),s=new Array(a.length+1),c=new Array(a.length),u=0;u<a.length;)s[u]=a[u],c[u]=e[a[u++]];return s[u]=t,Function.apply(null,s).apply(null,c)}return Function(t)()}for(var l=new Array(arguments.length-1),d=0;d<l.length;)l[d]=arguments[++d];if(d=0,e=e.replace(/%([%dfijs])/g,(function(e,t){var n=l[d++];switch(t){case"d":case"f":return String(Number(n));case"i":return String(Math.floor(n));case"j":return JSON.stringify(n);case"s":return String(n)}return"%"})),d!==l.length)throw Error("parameter count mismatch");return n.push(e),i}function o(r){return"function "+(r||t||"")+"("+(e&&e.join(",")||"")+"){\n  "+n.join("\n  ")+"\n}"}return i.toString=o,i}t.exports=r,r.verbose=!1},{}],4:[function(e,t,n){function r(){this._listeners={}}t.exports=r,r.prototype.on=function(e,t,n){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:t,ctx:n||this}),this},r.prototype.off=function(e,t){if(e===undefined)this._listeners={};else if(t===undefined)this._listeners[e]=[];else for(var n=this._listeners[e],r=0;r<n.length;)n[r].fn===t?n.splice(r,1):++r;return this},r.prototype.emit=function(e){var t=this._listeners[e];if(t){for(var n=[],r=1;r<arguments.length;)n.push(arguments[r++]);for(r=0;r<t.length;)t[r].fn.apply(t[r++].ctx,n)}return this}},{}],5:[function(e,t,n){t.exports=o;var r=e(1),i=e(7)("fs");function o(e,t,n){return"function"==typeof t?(n=t,t={}):t||(t={}),n?!t.xhr&&i&&i.readFile?i.readFile(e,(function(r,i){return r&&"undefined"!=typeof XMLHttpRequest?o.xhr(e,t,n):r?n(r):n(null,t.binary?i:i.toString("utf8"))})):o.xhr(e,t,n):r(o,this,e,t)}o.xhr=function(e,t,n){var r=new XMLHttpRequest;r.onreadystatechange=function(){if(4!==r.readyState)return undefined;if(0!==r.status&&200!==r.status)return n(Error("status "+r.status));if(t.binary){var e=r.response;if(!e){e=[];for(var i=0;i<r.responseText.length;++i)e.push(255&r.responseText.charCodeAt(i))}return n(null,"undefined"!=typeof Uint8Array?new Uint8Array(e):e)}return n(null,r.responseText)},t.binary&&("overrideMimeType"in r&&r.overrideMimeType("text/plain; charset=x-user-defined"),r.responseType="arraybuffer"),r.open("GET",e),r.send()}},{1:1,7:7}],6:[function(e,t,n){function r(e){return"undefined"!=typeof Float32Array?function(){var t=new Float32Array([-0]),n=new Uint8Array(t.buffer),r=128===n[3];function i(e,r,i){t[0]=e,r[i]=n[0],r[i+1]=n[1],r[i+2]=n[2],r[i+3]=n[3]}function o(e,r,i){t[0]=e,r[i]=n[3],r[i+1]=n[2],r[i+2]=n[1],r[i+3]=n[0]}function a(e,r){return n[0]=e[r],n[1]=e[r+1],n[2]=e[r+2],n[3]=e[r+3],t[0]}function s(e,r){return n[3]=e[r],n[2]=e[r+1],n[1]=e[r+2],n[0]=e[r+3],t[0]}e.writeFloatLE=r?i:o,e.writeFloatBE=r?o:i,e.readFloatLE=r?a:s,e.readFloatBE=r?s:a}():function(){function t(e,t,n,r){var i=t<0?1:0;if(i&&(t=-t),0===t)e(1/t>0?0:2147483648,n,r);else if(isNaN(t))e(2143289344,n,r);else if(t>34028234663852886e22)e((i<<31|2139095040)>>>0,n,r);else if(t<11754943508222875e-54)e((i<<31|Math.round(t/1401298464324817e-60))>>>0,n,r);else{var o=Math.floor(Math.log(t)/Math.LN2);e((i<<31|o+127<<23|8388607&Math.round(t*Math.pow(2,-o)*8388608))>>>0,n,r)}}function n(e,t,n){var r=e(t,n),i=2*(r>>31)+1,o=r>>>23&255,a=8388607&r;return 255===o?a?NaN:i*(1/0):0===o?1401298464324817e-60*i*a:i*Math.pow(2,o-150)*(a+8388608)}e.writeFloatLE=t.bind(null,i),e.writeFloatBE=t.bind(null,o),e.readFloatLE=n.bind(null,a),e.readFloatBE=n.bind(null,s)}(),"undefined"!=typeof Float64Array?function(){var t=new Float64Array([-0]),n=new Uint8Array(t.buffer),r=128===n[7];function i(e,r,i){t[0]=e,r[i]=n[0],r[i+1]=n[1],r[i+2]=n[2],r[i+3]=n[3],r[i+4]=n[4],r[i+5]=n[5],r[i+6]=n[6],r[i+7]=n[7]}function o(e,r,i){t[0]=e,r[i]=n[7],r[i+1]=n[6],r[i+2]=n[5],r[i+3]=n[4],r[i+4]=n[3],r[i+5]=n[2],r[i+6]=n[1],r[i+7]=n[0]}function a(e,r){return n[0]=e[r],n[1]=e[r+1],n[2]=e[r+2],n[3]=e[r+3],n[4]=e[r+4],n[5]=e[r+5],n[6]=e[r+6],n[7]=e[r+7],t[0]}function s(e,r){return n[7]=e[r],n[6]=e[r+1],n[5]=e[r+2],n[4]=e[r+3],n[3]=e[r+4],n[2]=e[r+5],n[1]=e[r+6],n[0]=e[r+7],t[0]}e.writeDoubleLE=r?i:o,e.writeDoubleBE=r?o:i,e.readDoubleLE=r?a:s,e.readDoubleBE=r?s:a}():function(){function t(e,t,n,r,i,o){var a=r<0?1:0;if(a&&(r=-r),0===r)e(0,i,o+t),e(1/r>0?0:2147483648,i,o+n);else if(isNaN(r))e(0,i,o+t),e(2146959360,i,o+n);else if(r>17976931348623157e292)e(0,i,o+t),e((a<<31|2146435072)>>>0,i,o+n);else{var s;if(r<22250738585072014e-324)e((s=r/5e-324)>>>0,i,o+t),e((a<<31|s/4294967296)>>>0,i,o+n);else{var c=Math.floor(Math.log(r)/Math.LN2);1024===c&&(c=1023),e(4503599627370496*(s=r*Math.pow(2,-c))>>>0,i,o+t),e((a<<31|c+1023<<20|1048576*s&1048575)>>>0,i,o+n)}}}function n(e,t,n,r,i){var o=e(r,i+t),a=e(r,i+n),s=2*(a>>31)+1,c=a>>>20&2047,u=4294967296*(1048575&a)+o;return 2047===c?u?NaN:s*(1/0):0===c?5e-324*s*u:s*Math.pow(2,c-1075)*(u+4503599627370496)}e.writeDoubleLE=t.bind(null,i,0,4),e.writeDoubleBE=t.bind(null,o,4,0),e.readDoubleLE=n.bind(null,a,0,4),e.readDoubleBE=n.bind(null,s,4,0)}(),e}function i(e,t,n){t[n]=255&e,t[n+1]=e>>>8&255,t[n+2]=e>>>16&255,t[n+3]=e>>>24}function o(e,t,n){t[n]=e>>>24,t[n+1]=e>>>16&255,t[n+2]=e>>>8&255,t[n+3]=255&e}function a(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0}function s(e,t){return(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0}t.exports=r(r)},{}],7:[function(require,module,exports){function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(e){}return null}module.exports=inquire},{}],8:[function(e,t,n){var r=n,i=r.isAbsolute=function(e){return/^(?:\/|\w+:)/.test(e)},o=r.normalize=function(e){var t=(e=e.replace(/\\/g,"/").replace(/\/{2,}/g,"/")).split("/"),n=i(e),r="";n&&(r=t.shift()+"/");for(var o=0;o<t.length;)".."===t[o]?o>0&&".."!==t[o-1]?t.splice(--o,2):n?t.splice(o,1):++o:"."===t[o]?t.splice(o,1):++o;return r+t.join("/")};r.resolve=function(e,t,n){return n||(t=o(t)),i(t)?t:(n||(e=o(e)),(e=e.replace(/(?:\/|^)[^/]+$/,"")).length?o(e+"/"+t):t)}},{}],9:[function(e,t,n){t.exports=function(e,t,n){var r=n||8192,i=r>>>1,o=null,a=r;return function(n){if(n<1||n>i)return e(n);a+n>r&&(o=e(r),a=0);var s=t.call(o,a,a+=n);return 7&a&&(a=1+(7|a)),s}}},{}],10:[function(e,t,n){var r=n;r.length=function(e){for(var t=0,n=0,r=0;r<e.length;++r)(n=e.charCodeAt(r))<128?t+=1:n<2048?t+=2:55296==(64512&n)&&56320==(64512&e.charCodeAt(r+1))?(++r,t+=4):t+=3;return t},r.read=function(e,t,n){if(n-t<1)return"";for(var r,i=null,o=[],a=0;t<n;)(r=e[t++])<128?o[a++]=r:r>191&&r<224?o[a++]=(31&r)<<6|63&e[t++]:r>239&&r<365?(r=((7&r)<<18|(63&e[t++])<<12|(63&e[t++])<<6|63&e[t++])-65536,o[a++]=55296+(r>>10),o[a++]=56320+(1023&r)):o[a++]=(15&r)<<12|(63&e[t++])<<6|63&e[t++],a>8191&&((i||(i=[])).push(String.fromCharCode.apply(String,o)),a=0);return i?(a&&i.push(String.fromCharCode.apply(String,o.slice(0,a))),i.join("")):String.fromCharCode.apply(String,o.slice(0,a))},r.write=function(e,t,n){for(var r,i,o=n,a=0;a<e.length;++a)(r=e.charCodeAt(a))<128?t[n++]=r:r<2048?(t[n++]=r>>6|192,t[n++]=63&r|128):55296==(64512&r)&&56320==(64512&(i=e.charCodeAt(a+1)))?(r=65536+((1023&r)<<10)+(1023&i),++a,t[n++]=r>>18|240,t[n++]=r>>12&63|128,t[n++]=r>>6&63|128,t[n++]=63&r|128):(t[n++]=r>>12|224,t[n++]=r>>6&63|128,t[n++]=63&r|128);return n-o}},{}],11:[function(e,t,n){var r=n,i=e(14),o=e(33);function a(e,t,n,r){if(t.resolvedType)if(t.resolvedType instanceof i){e("switch(d%s){",r);for(var o=t.resolvedType.values,a=Object.keys(o),s=0;s<a.length;++s)t.repeated&&o[a[s]]===t.typeDefault&&e("default:"),e("case%j:",a[s])("case %i:",o[a[s]])("m%s=%j",r,o[a[s]])("break");e("}")}else e('if(typeof d%s!=="object")',r)("throw TypeError(%j)",t.fullName+": object expected")("m%s=types[%i].fromObject(d%s)",r,n,r);else{var c=!1;switch(t.type){case"double":case"float":e("m%s=Number(d%s)",r,r);break;case"uint32":case"fixed32":e("m%s=d%s>>>0",r,r);break;case"int32":case"sint32":case"sfixed32":e("m%s=d%s|0",r,r);break;case"uint64":c=!0;case"int64":case"sint64":case"fixed64":case"sfixed64":e("if(util.Long)")("(m%s=util.Long.fromValue(d%s)).unsigned=%j",r,r,c)('else if(typeof d%s==="string")',r)("m%s=parseInt(d%s,10)",r,r)('else if(typeof d%s==="number")',r)("m%s=d%s",r,r)('else if(typeof d%s==="object")',r)("m%s=new util.LongBits(d%s.low>>>0,d%s.high>>>0).toNumber(%s)",r,r,r,c?"true":"");break;case"bytes":e('if(typeof d%s==="string")',r)("util.base64.decode(d%s,m%s=util.newBuffer(util.base64.length(d%s)),0)",r,r,r)("else if(d%s.length)",r)("m%s=d%s",r,r);break;case"string":e("m%s=String(d%s)",r,r);break;case"bool":e("m%s=Boolean(d%s)",r,r)}}return e}function s(e,t,n,r){if(t.resolvedType)t.resolvedType instanceof i?e("d%s=o.enums===String?types[%i].values[m%s]:m%s",r,n,r,r):e("d%s=types[%i].toObject(m%s,o)",r,n,r);else{var o=!1;switch(t.type){case"double":case"float":e("d%s=o.json&&!isFinite(m%s)?String(m%s):m%s",r,r,r,r);break;case"uint64":o=!0;case"int64":case"sint64":case"fixed64":case"sfixed64":e('if(typeof m%s==="number")',r)("d%s=o.longs===String?String(m%s):m%s",r,r,r)("else")("d%s=o.longs===String?util.Long.prototype.toString.call(m%s):o.longs===Number?new util.LongBits(m%s.low>>>0,m%s.high>>>0).toNumber(%s):m%s",r,r,r,r,o?"true":"",r);break;case"bytes":e("d%s=o.bytes===String?util.base64.encode(m%s,0,m%s.length):o.bytes===Array?Array.prototype.slice.call(m%s):m%s",r,r,r,r,r);break;default:e("d%s=m%s",r,r)}}return e}r.fromObject=function(e){var t=e.fieldsArray,n=o.codegen(["d"],e.name+"$fromObject")("if(d instanceof this.ctor)")("return d");if(!t.length)return n("return new this.ctor");n("var m=new this.ctor");for(var r=0;r<t.length;++r){var s=t[r].resolve(),c=o.safeProp(s.name);s.map?(n("if(d%s){",c)('if(typeof d%s!=="object")',c)("throw TypeError(%j)",s.fullName+": object expected")("m%s={}",c)("for(var ks=Object.keys(d%s),i=0;i<ks.length;++i){",c),a(n,s,r,c+"[ks[i]]")("}")("}")):s.repeated?(n("if(d%s){",c)("if(!Array.isArray(d%s))",c)("throw TypeError(%j)",s.fullName+": array expected")("m%s=[]",c)("for(var i=0;i<d%s.length;++i){",c),a(n,s,r,c+"[i]")("}")("}")):(s.resolvedType instanceof i||n("if(d%s!=null){",c),a(n,s,r,c),s.resolvedType instanceof i||n("}"))}return n("return m")},r.toObject=function(e){var t=e.fieldsArray.slice().sort(o.compareFieldsById);if(!t.length)return o.codegen()("return {}");for(var n=o.codegen(["m","o"],e.name+"$toObject")("if(!o)")("o={}")("var d={}"),r=[],a=[],c=[],u=0;u<t.length;++u)t[u].partOf||(t[u].resolve().repeated?r:t[u].map?a:c).push(t[u]);if(r.length){for(n("if(o.arrays||o.defaults){"),u=0;u<r.length;++u)n("d%s=[]",o.safeProp(r[u].name));n("}")}if(a.length){for(n("if(o.objects||o.defaults){"),u=0;u<a.length;++u)n("d%s={}",o.safeProp(a[u].name));n("}")}if(c.length){for(n("if(o.defaults){"),u=0;u<c.length;++u){var l=c[u],d=o.safeProp(l.name);if(l.resolvedType instanceof i)n("d%s=o.enums===String?%j:%j",d,l.resolvedType.valuesById[l.typeDefault],l.typeDefault);else if(l.long)n("if(util.Long){")("var n=new util.Long(%i,%i,%j)",l.typeDefault.low,l.typeDefault.high,l.typeDefault.unsigned)("d%s=o.longs===String?n.toString():o.longs===Number?n.toNumber():n",d)("}else")("d%s=o.longs===String?%j:%i",d,l.typeDefault.toString(),l.typeDefault.toNumber());else if(l.bytes){var h="["+Array.prototype.slice.call(l.typeDefault).join(",")+"]";n("if(o.bytes===String)d%s=%j",d,String.fromCharCode.apply(String,l.typeDefault))("else{")("d%s=%s",d,h)("if(o.bytes!==Array)d%s=util.newBuffer(d%s)",d,d)("}")}else n("d%s=%j",d,l.typeDefault)}n("}")}var f=!1;for(u=0;u<t.length;++u){l=t[u];var p=e._fieldsArray.indexOf(l);d=o.safeProp(l.name),l.map?(f||(f=!0,n("var ks2")),n("if(m%s&&(ks2=Object.keys(m%s)).length){",d,d)("d%s={}",d)("for(var j=0;j<ks2.length;++j){"),s(n,l,p,d+"[ks2[j]]")("}")):l.repeated?(n("if(m%s&&m%s.length){",d,d)("d%s=[]",d)("for(var j=0;j<m%s.length;++j){",d),s(n,l,p,d+"[j]")("}")):(n("if(m%s!=null&&m.hasOwnProperty(%j)){",d,l.name),s(n,l,p,d),l.partOf&&n("if(o.oneofs)")("d%s=%j",o.safeProp(l.partOf.name),l.name)),n("}")}return n("return d")}},{14:14,33:33}],12:[function(e,t,n){t.exports=function(e){var t=o.codegen(["r","l"],e.name+"$decode")("if(!(r instanceof Reader))")("r=Reader.create(r)")("var c=l===undefined?r.len:r.pos+l,m=new this.ctor"+(e.fieldsArray.filter((function(e){return e.map})).length?",k,value":""))("while(r.pos<c){")("var t=r.uint32()");e.group&&t("if((t&7)===4)")("break"),t("switch(t>>>3){");for(var n=0;n<e.fieldsArray.length;++n){var s=e._fieldsArray[n].resolve(),c=s.resolvedType instanceof r?"int32":s.type,u="m"+o.safeProp(s.name);t("case %i:",s.id),s.map?(t("if(%s===util.emptyObject)",u)("%s={}",u)("var c2 = r.uint32()+r.pos"),i.defaults[s.keyType]!==undefined?t("k=%j",i.defaults[s.keyType]):t("k=null"),i.defaults[c]!==undefined?t("value=%j",i.defaults[c]):t("value=null"),t("while(r.pos<c2){")("var tag2=r.uint32()")("switch(tag2>>>3){")("case 1: k=r.%s(); break",s.keyType)("case 2:"),i.basic[c]===undefined?t("value=types[%i].decode(r,r.uint32())",n):t("value=r.%s()",c),t("break")("default:")("r.skipType(tag2&7)")("break")("}")("}"),i.long[s.keyType]!==undefined?t('%s[typeof k==="object"?util.longToHash(k):k]=value',u):t("%s[k]=value",u)):s.repeated?(t("if(!(%s&&%s.length))",u,u)("%s=[]",u),i.packed[c]!==undefined&&t("if((t&7)===2){")("var c2=r.uint32()+r.pos")("while(r.pos<c2)")("%s.push(r.%s())",u,c)("}else"),i.basic[c]===undefined?t(s.resolvedType.group?"%s.push(types[%i].decode(r))":"%s.push(types[%i].decode(r,r.uint32()))",u,n):t("%s.push(r.%s())",u,c)):i.basic[c]===undefined?t(s.resolvedType.group?"%s=types[%i].decode(r)":"%s=types[%i].decode(r,r.uint32())",u,n):t("%s=r.%s()",u,c),t("break")}for(t("default:")("r.skipType(t&7)")("break")("}")("}"),n=0;n<e._fieldsArray.length;++n){var l=e._fieldsArray[n];l.required&&t("if(!m.hasOwnProperty(%j))",l.name)("throw util.ProtocolError(%j,{instance:m})",a(l))}return t("return m")};var r=e(14),i=e(32),o=e(33);function a(e){return"missing required '"+e.name+"'"}},{14:14,32:32,33:33}],13:[function(e,t,n){t.exports=function(e){for(var t,n=o.codegen(["m","w"],e.name+"$encode")("if(!w)")("w=Writer.create()"),s=e.fieldsArray.slice().sort(o.compareFieldsById),c=0;c<s.length;++c){var u=s[c].resolve(),l=e._fieldsArray.indexOf(u),d=u.resolvedType instanceof r?"int32":u.type,h=i.basic[d];t="m"+o.safeProp(u.name),u.map?(n("if(%s!=null&&Object.hasOwnProperty.call(m,%j)){",t,u.name)("for(var ks=Object.keys(%s),i=0;i<ks.length;++i){",t)("w.uint32(%i).fork().uint32(%i).%s(ks[i])",(u.id<<3|2)>>>0,8|i.mapKey[u.keyType],u.keyType),h===undefined?n("types[%i].encode(%s[ks[i]],w.uint32(18).fork()).ldelim().ldelim()",l,t):n(".uint32(%i).%s(%s[ks[i]]).ldelim()",16|h,d,t),n("}")("}")):u.repeated?(n("if(%s!=null&&%s.length){",t,t),u.packed&&i.packed[d]!==undefined?n("w.uint32(%i).fork()",(u.id<<3|2)>>>0)("for(var i=0;i<%s.length;++i)",t)("w.%s(%s[i])",d,t)("w.ldelim()"):(n("for(var i=0;i<%s.length;++i)",t),h===undefined?a(n,u,l,t+"[i]"):n("w.uint32(%i).%s(%s[i])",(u.id<<3|h)>>>0,d,t)),n("}")):(u.optional&&n("if(%s!=null&&Object.hasOwnProperty.call(m,%j))",t,u.name),h===undefined?a(n,u,l,t):n("w.uint32(%i).%s(%s)",(u.id<<3|h)>>>0,d,t))}return n("return w")};var r=e(14),i=e(32),o=e(33);function a(e,t,n,r){return t.resolvedType.group?e("types[%i].encode(%s,w.uint32(%i)).uint32(%i)",n,r,(t.id<<3|3)>>>0,(t.id<<3|4)>>>0):e("types[%i].encode(%s,w.uint32(%i).fork()).ldelim()",n,r,(t.id<<3|2)>>>0)}},{14:14,32:32,33:33}],14:[function(e,t,n){t.exports=a;var r=e(22);((a.prototype=Object.create(r.prototype)).constructor=a).className="Enum";var i=e(21),o=e(33);function a(e,t,n,i,o){if(r.call(this,e,n),t&&"object"!=typeof t)throw TypeError("values must be an object");if(this.valuesById={},this.values=Object.create(this.valuesById),this.comment=i,this.comments=o||{},this.reserved=undefined,t)for(var a=Object.keys(t),s=0;s<a.length;++s)"number"==typeof t[a[s]]&&(this.valuesById[this.values[a[s]]=t[a[s]]]=a[s])}a.fromJSON=function(e,t){var n=new a(e,t.values,t.options,t.comment,t.comments);return n.reserved=t.reserved,n},a.prototype.toJSON=function(e){var t=!!e&&Boolean(e.keepComments);return o.toObject(["options",this.options,"values",this.values,"reserved",this.reserved&&this.reserved.length?this.reserved:undefined,"comment",t?this.comment:undefined,"comments",t?this.comments:undefined])},a.prototype.add=function(e,t,n){if(!o.isString(e))throw TypeError("name must be a string");if(!o.isInteger(t))throw TypeError("id must be an integer");if(this.values[e]!==undefined)throw Error("duplicate name '"+e+"' in "+this);if(this.isReservedId(t))throw Error("id "+t+" is reserved in "+this);if(this.isReservedName(e))throw Error("name '"+e+"' is reserved in "+this);if(this.valuesById[t]!==undefined){if(!this.options||!this.options.allow_alias)throw Error("duplicate id "+t+" in "+this);this.values[e]=t}else this.valuesById[this.values[e]=t]=e;return this.comments[e]=n||null,this},a.prototype.remove=function(e){if(!o.isString(e))throw TypeError("name must be a string");var t=this.values[e];if(null==t)throw Error("name '"+e+"' does not exist in "+this);return delete this.valuesById[t],delete this.values[e],delete this.comments[e],this},a.prototype.isReservedId=function(e){return i.isReservedId(this.reserved,e)},a.prototype.isReservedName=function(e){return i.isReservedName(this.reserved,e)}},{21:21,22:22,33:33}],15:[function(e,t,n){t.exports=u;var r=e(22);((u.prototype=Object.create(r.prototype)).constructor=u).className="Field";var i,o=e(14),a=e(32),s=e(33),c=/^required|optional|repeated$/;function u(e,t,n,i,o,u,l){if(s.isObject(i)?(l=o,u=i,i=o=undefined):s.isObject(o)&&(l=u,u=o,o=undefined),r.call(this,e,u),!s.isInteger(t)||t<0)throw TypeError("id must be a non-negative integer");if(!s.isString(n))throw TypeError("type must be a string");if(i!==undefined&&!c.test(i=i.toString().toLowerCase()))throw TypeError("rule must be a string rule");if(o!==undefined&&!s.isString(o))throw TypeError("extend must be a string");this.rule=i&&"optional"!==i?i:undefined,this.type=n,this.id=t,this.extend=o||undefined,this.required="required"===i,this.optional=!this.required,this.repeated="repeated"===i,this.map=!1,this.message=null,this.partOf=null,this.typeDefault=null,this.defaultValue=null,this.long=!!s.Long&&a.long[n]!==undefined,this.bytes="bytes"===n,this.resolvedType=null,this.extensionField=null,this.declaringField=null,this._packed=null,this.comment=l}u.fromJSON=function(e,t){return new u(e,t.id,t.type,t.rule,t.extend,t.options,t.comment)},Object.defineProperty(u.prototype,"packed",{get:function(){return null===this._packed&&(this._packed=!1!==this.getOption("packed")),this._packed}}),u.prototype.setOption=function(e,t,n){return"packed"===e&&(this._packed=null),r.prototype.setOption.call(this,e,t,n)},u.prototype.toJSON=function(e){var t=!!e&&Boolean(e.keepComments);return s.toObject(["rule","optional"!==this.rule&&this.rule||undefined,"type",this.type,"id",this.id,"extend",this.extend,"options",this.options,"comment",t?this.comment:undefined])},u.prototype.resolve=function(){if(this.resolved)return this;if((this.typeDefault=a.defaults[this.type])===undefined&&(this.resolvedType=(this.declaringField?this.declaringField.parent:this.parent).lookupTypeOrEnum(this.type),this.resolvedType instanceof i?this.typeDefault=null:this.typeDefault=this.resolvedType.values[Object.keys(this.resolvedType.values)[0]]),this.options&&null!=this.options.default&&(this.typeDefault=this.options.default,this.resolvedType instanceof o&&"string"==typeof this.typeDefault&&(this.typeDefault=this.resolvedType.values[this.typeDefault])),this.options&&(!0!==this.options.packed&&(this.options.packed===undefined||!this.resolvedType||this.resolvedType instanceof o)||delete this.options.packed,Object.keys(this.options).length||(this.options=undefined)),this.long)this.typeDefault=s.Long.fromNumber(this.typeDefault,"u"===this.type.charAt(0)),Object.freeze&&Object.freeze(this.typeDefault);else if(this.bytes&&"string"==typeof this.typeDefault){var e;s.base64.test(this.typeDefault)?s.base64.decode(this.typeDefault,e=s.newBuffer(s.base64.length(this.typeDefault)),0):s.utf8.write(this.typeDefault,e=s.newBuffer(s.utf8.length(this.typeDefault)),0),this.typeDefault=e}return this.map?this.defaultValue=s.emptyObject:this.repeated?this.defaultValue=s.emptyArray:this.defaultValue=this.typeDefault,this.parent instanceof i&&(this.parent.ctor.prototype[this.name]=this.defaultValue),r.prototype.resolve.call(this)},u.d=function(e,t,n,r){return"function"==typeof t?t=s.decorateType(t).name:t&&"object"==typeof t&&(t=s.decorateEnum(t).name),function(i,o){s.decorateType(i.constructor).add(new u(o,e,t,n,{default:r}))}},u._configure=function(e){i=e}},{14:14,22:22,32:32,33:33}],16:[function(e,t,n){var r=t.exports=e(17);r.build="light",r.load=function(e,t,n){return"function"==typeof t?(n=t,t=new r.Root):t||(t=new r.Root),t.load(e,n)},r.loadSync=function(e,t){return t||(t=new r.Root),t.loadSync(e)},r.encoder=e(13),r.decoder=e(12),r.verifier=e(36),r.converter=e(11),r.ReflectionObject=e(22),r.Namespace=e(21),r.Root=e(26),r.Enum=e(14),r.Type=e(31),r.Field=e(15),r.OneOf=e(23),r.MapField=e(18),r.Service=e(30),r.Method=e(20),r.Message=e(19),r.wrappers=e(37),r.types=e(32),r.util=e(33),r.ReflectionObject._configure(r.Root),r.Namespace._configure(r.Type,r.Service,r.Enum),r.Root._configure(r.Type),r.Field._configure(r.Type)},{11:11,12:12,13:13,14:14,15:15,17:17,18:18,19:19,20:20,21:21,22:22,23:23,26:26,30:30,31:31,32:32,33:33,36:36,37:37}],17:[function(e,t,n){var r=n;function i(){r.util._configure(),r.Writer._configure(r.BufferWriter),r.Reader._configure(r.BufferReader)}r.build="minimal",r.Writer=e(38),r.BufferWriter=e(39),r.Reader=e(24),r.BufferReader=e(25),r.util=e(35),r.rpc=e(28),r.roots=e(27),r.configure=i,i()},{24:24,25:25,27:27,28:28,35:35,38:38,39:39}],18:[function(e,t,n){t.exports=a;var r=e(15);((a.prototype=Object.create(r.prototype)).constructor=a).className="MapField";var i=e(32),o=e(33);function a(e,t,n,i,a,s){if(r.call(this,e,t,i,undefined,undefined,a,s),!o.isString(n))throw TypeError("keyType must be a string");this.keyType=n,this.resolvedKeyType=null,this.map=!0}a.fromJSON=function(e,t){return new a(e,t.id,t.keyType,t.type,t.options,t.comment)},a.prototype.toJSON=function(e){var t=!!e&&Boolean(e.keepComments);return o.toObject(["keyType",this.keyType,"type",this.type,"id",this.id,"extend",this.extend,"options",this.options,"comment",t?this.comment:undefined])},a.prototype.resolve=function(){if(this.resolved)return this;if(i.mapKey[this.keyType]===undefined)throw Error("invalid key type: "+this.keyType);return r.prototype.resolve.call(this)},a.d=function(e,t,n){return"function"==typeof n?n=o.decorateType(n).name:n&&"object"==typeof n&&(n=o.decorateEnum(n).name),function(r,i){o.decorateType(r.constructor).add(new a(i,e,t,n))}}},{15:15,32:32,33:33}],19:[function(e,t,n){t.exports=i;var r=e(35);function i(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)this[t[n]]=e[t[n]]}i.create=function(e){return this.$type.create(e)},i.encode=function(e,t){return this.$type.encode(e,t)},i.encodeDelimited=function(e,t){return this.$type.encodeDelimited(e,t)},i.decode=function(e){return this.$type.decode(e)},i.decodeDelimited=function(e){return this.$type.decodeDelimited(e)},i.verify=function(e){return this.$type.verify(e)},i.fromObject=function(e){return this.$type.fromObject(e)},i.toObject=function(e,t){return this.$type.toObject(e,t)},i.prototype.toJSON=function(){return this.$type.toObject(this,r.toJSONOptions)}},{35:35}],20:[function(e,t,n){t.exports=o;var r=e(22);((o.prototype=Object.create(r.prototype)).constructor=o).className="Method";var i=e(33);function o(e,t,n,o,a,s,c,u){if(i.isObject(a)?(c=a,a=s=undefined):i.isObject(s)&&(c=s,s=undefined),t!==undefined&&!i.isString(t))throw TypeError("type must be a string");if(!i.isString(n))throw TypeError("requestType must be a string");if(!i.isString(o))throw TypeError("responseType must be a string");r.call(this,e,c),this.type=t||"rpc",this.requestType=n,this.requestStream=!!a||undefined,this.responseType=o,this.responseStream=!!s||undefined,this.resolvedRequestType=null,this.resolvedResponseType=null,this.comment=u}o.fromJSON=function(e,t){return new o(e,t.type,t.requestType,t.responseType,t.requestStream,t.responseStream,t.options,t.comment)},o.prototype.toJSON=function(e){var t=!!e&&Boolean(e.keepComments);return i.toObject(["type","rpc"!==this.type&&this.type||undefined,"requestType",this.requestType,"requestStream",this.requestStream,"responseType",this.responseType,"responseStream",this.responseStream,"options",this.options,"comment",t?this.comment:undefined])},o.prototype.resolve=function(){return this.resolved?this:(this.resolvedRequestType=this.parent.lookupType(this.requestType),this.resolvedResponseType=this.parent.lookupType(this.responseType),r.prototype.resolve.call(this))}},{22:22,33:33}],21:[function(e,t,n){t.exports=l;var r=e(22);((l.prototype=Object.create(r.prototype)).constructor=l).className="Namespace";var i,o,a,s=e(15),c=e(33);function u(e,t){if(!e||!e.length)return undefined;for(var n={},r=0;r<e.length;++r)n[e[r].name]=e[r].toJSON(t);return n}function l(e,t){r.call(this,e,t),this.nested=undefined,this._nestedArray=null}function d(e){return e._nestedArray=null,e}l.fromJSON=function(e,t){return new l(e,t.options).addJSON(t.nested)},l.arrayToJSON=u,l.isReservedId=function(e,t){if(e)for(var n=0;n<e.length;++n)if("string"!=typeof e[n]&&e[n][0]<=t&&e[n][1]>t)return!0;return!1},l.isReservedName=function(e,t){if(e)for(var n=0;n<e.length;++n)if(e[n]===t)return!0;return!1},Object.defineProperty(l.prototype,"nestedArray",{get:function(){return this._nestedArray||(this._nestedArray=c.toArray(this.nested))}}),l.prototype.toJSON=function(e){return c.toObject(["options",this.options,"nested",u(this.nestedArray,e)])},l.prototype.addJSON=function(e){if(e)for(var t,n=Object.keys(e),r=0;r<n.length;++r)t=e[n[r]],this.add((t.fields!==undefined?i.fromJSON:t.values!==undefined?a.fromJSON:t.methods!==undefined?o.fromJSON:t.id!==undefined?s.fromJSON:l.fromJSON)(n[r],t));return this},l.prototype.get=function(e){return this.nested&&this.nested[e]||null},l.prototype.getEnum=function(e){if(this.nested&&this.nested[e]instanceof a)return this.nested[e].values;throw Error("no such enum: "+e)},l.prototype.add=function(e){if(!(e instanceof s&&e.extend!==undefined||e instanceof i||e instanceof a||e instanceof o||e instanceof l))throw TypeError("object must be a valid nested object");if(this.nested){var t=this.get(e.name);if(t){if(!(t instanceof l&&e instanceof l)||t instanceof i||t instanceof o)throw Error("duplicate name '"+e.name+"' in "+this);for(var n=t.nestedArray,r=0;r<n.length;++r)e.add(n[r]);this.remove(t),this.nested||(this.nested={}),e.setOptions(t.options,!0)}}else this.nested={};return this.nested[e.name]=e,e.onAdd(this),d(this)},l.prototype.remove=function(e){if(!(e instanceof r))throw TypeError("object must be a ReflectionObject");if(e.parent!==this)throw Error(e+" is not a member of "+this);return delete this.nested[e.name],Object.keys(this.nested).length||(this.nested=undefined),e.onRemove(this),d(this)},l.prototype.define=function(e,t){if(c.isString(e))e=e.split(".");else if(!Array.isArray(e))throw TypeError("illegal path");if(e&&e.length&&""===e[0])throw Error("path must be relative");for(var n=this;e.length>0;){var r=e.shift();if(n.nested&&n.nested[r]){if(!((n=n.nested[r])instanceof l))throw Error("path conflicts with non-namespace objects")}else n.add(n=new l(r))}return t&&n.addJSON(t),n},l.prototype.resolveAll=function(){for(var e=this.nestedArray,t=0;t<e.length;)e[t]instanceof l?e[t++].resolveAll():e[t++].resolve();return this.resolve()},l.prototype.lookup=function(e,t,n){if("boolean"==typeof t?(n=t,t=undefined):t&&!Array.isArray(t)&&(t=[t]),c.isString(e)&&e.length){if("."===e)return this.root;e=e.split(".")}else if(!e.length)return this;if(""===e[0])return this.root.lookup(e.slice(1),t);var r=this.get(e[0]);if(r){if(1===e.length){if(!t||t.indexOf(r.constructor)>-1)return r}else if(r instanceof l&&(r=r.lookup(e.slice(1),t,!0)))return r}else for(var i=0;i<this.nestedArray.length;++i)if(this._nestedArray[i]instanceof l&&(r=this._nestedArray[i].lookup(e,t,!0)))return r;return null===this.parent||n?null:this.parent.lookup(e,t)},l.prototype.lookupType=function(e){var t=this.lookup(e,[i]);if(!t)throw Error("no such type: "+e);return t},l.prototype.lookupEnum=function(e){var t=this.lookup(e,[a]);if(!t)throw Error("no such Enum '"+e+"' in "+this);return t},l.prototype.lookupTypeOrEnum=function(e){var t=this.lookup(e,[i,a]);if(!t)throw Error("no such Type or Enum '"+e+"' in "+this);return t},l.prototype.lookupService=function(e){var t=this.lookup(e,[o]);if(!t)throw Error("no such Service '"+e+"' in "+this);return t},l._configure=function(e,t,n){i=e,o=t,a=n}},{15:15,22:22,33:33}],22:[function(e,t,n){t.exports=o,o.className="ReflectionObject";var r,i=e(33);function o(e,t){if(!i.isString(e))throw TypeError("name must be a string");if(t&&!i.isObject(t))throw TypeError("options must be an object");this.options=t,this.parsedOptions=null,this.name=e,this.parent=null,this.resolved=!1,this.comment=null,this.filename=null}Object.defineProperties(o.prototype,{root:{get:function(){for(var e=this;null!==e.parent;)e=e.parent;return e}},fullName:{get:function(){for(var e=[this.name],t=this.parent;t;)e.unshift(t.name),t=t.parent;return e.join(".")}}}),o.prototype.toJSON=function(){throw Error()},o.prototype.onAdd=function(e){this.parent&&this.parent!==e&&this.parent.remove(this),this.parent=e,this.resolved=!1;var t=e.root;t instanceof r&&t._handleAdd(this)},o.prototype.onRemove=function(e){var t=e.root;t instanceof r&&t._handleRemove(this),this.parent=null,this.resolved=!1},o.prototype.resolve=function(){return this.resolved||this.root instanceof r&&(this.resolved=!0),this},o.prototype.getOption=function(e){return this.options?this.options[e]:undefined},o.prototype.setOption=function(e,t,n){return n&&this.options&&this.options[e]!==undefined||((this.options||(this.options={}))[e]=t),this},o.prototype.setParsedOption=function(e,t,n){this.parsedOptions||(this.parsedOptions=[]);var r=this.parsedOptions;if(n){var o=r.find((function(t){return Object.prototype.hasOwnProperty.call(t,e)}));if(o){var a=o[e];i.setProperty(a,n,t)}else(o={})[e]=i.setProperty({},n,t),r.push(o)}else{var s={};s[e]=t,r.push(s)}return this},o.prototype.setOptions=function(e,t){if(e)for(var n=Object.keys(e),r=0;r<n.length;++r)this.setOption(n[r],e[n[r]],t);return this},o.prototype.toString=function(){var e=this.constructor.className,t=this.fullName;return t.length?e+" "+t:e},o._configure=function(e){r=e}},{33:33}],23:[function(e,t,n){t.exports=a;var r=e(22);((a.prototype=Object.create(r.prototype)).constructor=a).className="OneOf";var i=e(15),o=e(33);function a(e,t,n,i){if(Array.isArray(t)||(n=t,t=undefined),r.call(this,e,n),t!==undefined&&!Array.isArray(t))throw TypeError("fieldNames must be an Array");this.oneof=t||[],this.fieldsArray=[],this.comment=i}function s(e){if(e.parent)for(var t=0;t<e.fieldsArray.length;++t)e.fieldsArray[t].parent||e.parent.add(e.fieldsArray[t])}a.fromJSON=function(e,t){return new a(e,t.oneof,t.options,t.comment)},a.prototype.toJSON=function(e){var t=!!e&&Boolean(e.keepComments);return o.toObject(["options",this.options,"oneof",this.oneof,"comment",t?this.comment:undefined])},a.prototype.add=function(e){if(!(e instanceof i))throw TypeError("field must be a Field");return e.parent&&e.parent!==this.parent&&e.parent.remove(e),this.oneof.push(e.name),this.fieldsArray.push(e),e.partOf=this,s(this),this},a.prototype.remove=function(e){if(!(e instanceof i))throw TypeError("field must be a Field");var t=this.fieldsArray.indexOf(e);if(t<0)throw Error(e+" is not a member of "+this);return this.fieldsArray.splice(t,1),(t=this.oneof.indexOf(e.name))>-1&&this.oneof.splice(t,1),e.partOf=null,this},a.prototype.onAdd=function(e){r.prototype.onAdd.call(this,e);for(var t=0;t<this.oneof.length;++t){var n=e.get(this.oneof[t]);n&&!n.partOf&&(n.partOf=this,this.fieldsArray.push(n))}s(this)},a.prototype.onRemove=function(e){for(var t,n=0;n<this.fieldsArray.length;++n)(t=this.fieldsArray[n]).parent&&t.parent.remove(t);r.prototype.onRemove.call(this,e)},a.d=function(){for(var e=new Array(arguments.length),t=0;t<arguments.length;)e[t]=arguments[t++];return function(t,n){o.decorateType(t.constructor).add(new a(n,e)),Object.defineProperty(t,n,{get:o.oneOfGetter(e),set:o.oneOfSetter(e)})}}},{15:15,22:22,33:33}],24:[function(e,t,n){t.exports=c;var r,i=e(35),o=i.LongBits,a=i.utf8;function s(e,t){return RangeError("index out of range: "+e.pos+" + "+(t||1)+" > "+e.len)}function c(e){this.buf=e,this.pos=0,this.len=e.length}var u,l="undefined"!=typeof Uint8Array?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new c(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new c(e);throw Error("illegal buffer")},d=function(){return i.Buffer?function(e){return(c.create=function(e){return i.Buffer.isBuffer(e)?new r(e):l(e)})(e)}:l};function h(){var e=new o(0,0),t=0;if(!(this.len-this.pos>4)){for(;t<3;++t){if(this.pos>=this.len)throw s(this);if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e}return e.lo=(e.lo|(127&this.buf[this.pos++])<<7*t)>>>0,e}for(;t<4;++t)if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e;if(e.lo=(e.lo|(127&this.buf[this.pos])<<28)>>>0,e.hi=(e.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return e;if(t=0,this.len-this.pos>4){for(;t<5;++t)if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}else for(;t<5;++t){if(this.pos>=this.len)throw s(this);if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}throw Error("invalid varint encoding")}function f(e,t){return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0}function p(){if(this.pos+8>this.len)throw s(this,8);return new o(f(this.buf,this.pos+=4),f(this.buf,this.pos+=4))}c.create=d(),c.prototype._slice=i.Array.prototype.subarray||i.Array.prototype.slice,c.prototype.uint32=(u=4294967295,function(){if(u=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128)return u;if(u=(u|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)return u;if(u=(u|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)return u;if(u=(u|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)return u;if(u=(u|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128)return u;if((this.pos+=5)>this.len)throw this.pos=this.len,s(this,10);return u}),c.prototype.int32=function(){return 0|this.uint32()},c.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(1&e)|0},c.prototype.bool=function(){return 0!==this.uint32()},c.prototype.fixed32=function(){if(this.pos+4>this.len)throw s(this,4);return f(this.buf,this.pos+=4)},c.prototype.sfixed32=function(){if(this.pos+4>this.len)throw s(this,4);return 0|f(this.buf,this.pos+=4)},c.prototype.float=function(){if(this.pos+4>this.len)throw s(this,4);var e=i.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e},c.prototype.double=function(){if(this.pos+8>this.len)throw s(this,4);var e=i.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e},c.prototype.bytes=function(){var e=this.uint32(),t=this.pos,n=this.pos+e;if(n>this.len)throw s(this,e);return this.pos+=e,Array.isArray(this.buf)?this.buf.slice(t,n):t===n?new this.buf.constructor(0):this._slice.call(this.buf,t,n)},c.prototype.string=function(){var e=this.bytes();return a.read(e,0,e.length)},c.prototype.skip=function(e){if("number"==typeof e){if(this.pos+e>this.len)throw s(this,e);this.pos+=e}else do{if(this.pos>=this.len)throw s(this)}while(128&this.buf[this.pos++]);return this},c.prototype.skipType=function(e){switch(e){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;4!=(e=7&this.uint32());)this.skipType(e);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+e+" at offset "+this.pos)}return this},c._configure=function(e){r=e,c.create=d(),r._configure();var t=i.Long?"toLong":"toNumber";i.merge(c.prototype,{int64:function(){return h.call(this)[t](!1)},uint64:function(){return h.call(this)[t](!0)},sint64:function(){return h.call(this).zzDecode()[t](!1)},fixed64:function(){return p.call(this)[t](!0)},sfixed64:function(){return p.call(this)[t](!1)}})}},{35:35}],25:[function(e,t,n){t.exports=o;var r=e(24);(o.prototype=Object.create(r.prototype)).constructor=o;var i=e(35);function o(e){r.call(this,e)}o._configure=function(){i.Buffer&&(o.prototype._slice=i.Buffer.prototype.slice)},o.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))},o._configure()},{24:24,35:35}],26:[function(e,t,n){t.exports=d;var r=e(21);((d.prototype=Object.create(r.prototype)).constructor=d).className="Root";var i,o,a,s=e(15),c=e(14),u=e(23),l=e(33);function d(e){r.call(this,"",e),this.deferred=[],this.files=[]}function h(){}d.fromJSON=function(e,t){return t||(t=new d),e.options&&t.setOptions(e.options),t.addJSON(e.nested)},d.prototype.resolvePath=l.path.resolve,d.prototype.fetch=l.fetch,d.prototype.load=function e(t,n,r){"function"==typeof n&&(r=n,n=undefined);var i=this;if(!r)return l.asPromise(e,i,t,n);var s=r===h;function c(e,t){if(r){var n=r;if(r=null,s)throw e;n(e,t)}}function u(e){var t=e.lastIndexOf("google/protobuf/");if(t>-1){var n=e.substring(t);if(n in a)return n}return null}function d(e,t){try{if(l.isString(t)&&"{"===t.charAt(0)&&(t=JSON.parse(t)),l.isString(t)){o.filename=e;var r,a=o(t,i,n),d=0;if(a.imports)for(;d<a.imports.length;++d)(r=u(a.imports[d])||i.resolvePath(e,a.imports[d]))&&f(r);if(a.weakImports)for(d=0;d<a.weakImports.length;++d)(r=u(a.weakImports[d])||i.resolvePath(e,a.weakImports[d]))&&f(r,!0)}else i.setOptions(t.options).addJSON(t.nested)}catch(e){c(e)}s||p||c(null,i)}function f(e,t){if(!(i.files.indexOf(e)>-1))if(i.files.push(e),e in a)s?d(e,a[e]):(++p,setTimeout((function(){--p,d(e,a[e])})));else if(s){var n;try{n=l.fs.readFileSync(e).toString("utf8")}catch(e){return void(t||c(e))}d(e,n)}else++p,i.fetch(e,(function(n,o){--p,r&&(n?t?p||c(null,i):c(n):d(e,o))}))}var p=0;l.isString(t)&&(t=[t]);for(var A,g=0;g<t.length;++g)(A=i.resolvePath("",t[g]))&&f(A);return s?i:(p||c(null,i),undefined)},d.prototype.loadSync=function(e,t){if(!l.isNode)throw Error("not supported");return this.load(e,t,h)},d.prototype.resolveAll=function(){if(this.deferred.length)throw Error("unresolvable extensions: "+this.deferred.map((function(e){return"'extend "+e.extend+"' in "+e.parent.fullName})).join(", "));return r.prototype.resolveAll.call(this)};var f=/^[A-Z]/;function p(e,t){var n=t.parent.lookup(t.extend);if(n){var r=new s(t.fullName,t.id,t.type,t.rule,undefined,t.options);return r.declaringField=t,t.extensionField=r,n.add(r),!0}return!1}d.prototype._handleAdd=function(e){if(e instanceof s)e.extend===undefined||e.extensionField||p(0,e)||this.deferred.push(e);else if(e instanceof c)f.test(e.name)&&(e.parent[e.name]=e.values);else if(!(e instanceof u)){if(e instanceof i)for(var t=0;t<this.deferred.length;)p(0,this.deferred[t])?this.deferred.splice(t,1):++t;for(var n=0;n<e.nestedArray.length;++n)this._handleAdd(e._nestedArray[n]);f.test(e.name)&&(e.parent[e.name]=e)}},d.prototype._handleRemove=function(e){if(e instanceof s){if(e.extend!==undefined)if(e.extensionField)e.extensionField.parent.remove(e.extensionField),e.extensionField=null;else{var t=this.deferred.indexOf(e);t>-1&&this.deferred.splice(t,1)}}else if(e instanceof c)f.test(e.name)&&delete e.parent[e.name];else if(e instanceof r){for(var n=0;n<e.nestedArray.length;++n)this._handleRemove(e._nestedArray[n]);f.test(e.name)&&delete e.parent[e.name]}},d._configure=function(e,t,n){i=e,o=t,a=n}},{14:14,15:15,21:21,23:23,33:33}],27:[function(e,t,n){t.exports={}},{}],28:[function(e,t,n){n.Service=e(29)},{29:29}],29:[function(e,t,n){t.exports=i;var r=e(35);function i(e,t,n){if("function"!=typeof e)throw TypeError("rpcImpl must be a function");r.EventEmitter.call(this),this.rpcImpl=e,this.requestDelimited=Boolean(t),this.responseDelimited=Boolean(n)}(i.prototype=Object.create(r.EventEmitter.prototype)).constructor=i,i.prototype.rpcCall=function e(t,n,i,o,a){if(!o)throw TypeError("request must be specified");var s=this;if(!a)return r.asPromise(e,s,t,n,i,o);if(!s.rpcImpl)return setTimeout((function(){a(Error("already ended"))}),0),undefined;try{return s.rpcImpl(t,n[s.requestDelimited?"encodeDelimited":"encode"](o).finish(),(function(e,n){if(e)return s.emit("error",e,t),a(e);if(null===n)return s.end(!0),undefined;if(!(n instanceof i))try{n=i[s.responseDelimited?"decodeDelimited":"decode"](n)}catch(e){return s.emit("error",e,t),a(e)}return s.emit("data",n,t),a(null,n)}))}catch(e){return s.emit("error",e,t),setTimeout((function(){a(e)}),0),undefined}},i.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}},{35:35}],30:[function(e,t,n){t.exports=s;var r=e(21);((s.prototype=Object.create(r.prototype)).constructor=s).className="Service";var i=e(20),o=e(33),a=e(28);function s(e,t){r.call(this,e,t),this.methods={},this._methodsArray=null}function c(e){return e._methodsArray=null,e}s.fromJSON=function(e,t){var n=new s(e,t.options);if(t.methods)for(var r=Object.keys(t.methods),o=0;o<r.length;++o)n.add(i.fromJSON(r[o],t.methods[r[o]]));return t.nested&&n.addJSON(t.nested),n.comment=t.comment,n},s.prototype.toJSON=function(e){var t=r.prototype.toJSON.call(this,e),n=!!e&&Boolean(e.keepComments);return o.toObject(["options",t&&t.options||undefined,"methods",r.arrayToJSON(this.methodsArray,e)||{},"nested",t&&t.nested||undefined,"comment",n?this.comment:undefined])},Object.defineProperty(s.prototype,"methodsArray",{get:function(){return this._methodsArray||(this._methodsArray=o.toArray(this.methods))}}),s.prototype.get=function(e){return this.methods[e]||r.prototype.get.call(this,e)},s.prototype.resolveAll=function(){for(var e=this.methodsArray,t=0;t<e.length;++t)e[t].resolve();return r.prototype.resolve.call(this)},s.prototype.add=function(e){if(this.get(e.name))throw Error("duplicate name '"+e.name+"' in "+this);return e instanceof i?(this.methods[e.name]=e,e.parent=this,c(this)):r.prototype.add.call(this,e)},s.prototype.remove=function(e){if(e instanceof i){if(this.methods[e.name]!==e)throw Error(e+" is not a member of "+this);return delete this.methods[e.name],e.parent=null,c(this)}return r.prototype.remove.call(this,e)},s.prototype.create=function(e,t,n){for(var r,i=new a.Service(e,t,n),s=0;s<this.methodsArray.length;++s){var c=o.lcFirst((r=this._methodsArray[s]).resolve().name).replace(/[^$\w_]/g,"");i[c]=o.codegen(["r","c"],o.isReserved(c)?c+"_":c)("return this.rpcCall(m,q,s,r,c)")({m:r,q:r.resolvedRequestType.ctor,s:r.resolvedResponseType.ctor})}return i}},{20:20,21:21,28:28,33:33}],31:[function(e,t,n){t.exports=m;var r=e(21);((m.prototype=Object.create(r.prototype)).constructor=m).className="Type";var i=e(14),o=e(23),a=e(15),s=e(18),c=e(30),u=e(19),l=e(24),d=e(38),h=e(33),f=e(13),p=e(12),A=e(36),g=e(11),v=e(37);function m(e,t){r.call(this,e,t),this.fields={},this.oneofs=undefined,this.extensions=undefined,this.reserved=undefined,this.group=undefined,this._fieldsById=null,this._fieldsArray=null,this._oneofsArray=null,this._ctor=null}function y(e){return e._fieldsById=e._fieldsArray=e._oneofsArray=null,delete e.encode,delete e.decode,delete e.verify,e}Object.defineProperties(m.prototype,{fieldsById:{get:function(){if(this._fieldsById)return this._fieldsById;this._fieldsById={};for(var e=Object.keys(this.fields),t=0;t<e.length;++t){var n=this.fields[e[t]],r=n.id;if(this._fieldsById[r])throw Error("duplicate id "+r+" in "+this);this._fieldsById[r]=n}return this._fieldsById}},fieldsArray:{get:function(){return this._fieldsArray||(this._fieldsArray=h.toArray(this.fields))}},oneofsArray:{get:function(){return this._oneofsArray||(this._oneofsArray=h.toArray(this.oneofs))}},ctor:{get:function(){return this._ctor||(this.ctor=m.generateConstructor(this)())},set:function(e){var t=e.prototype;t instanceof u||((e.prototype=new u).constructor=e,h.merge(e.prototype,t)),e.$type=e.prototype.$type=this,h.merge(e,u,!0),this._ctor=e;for(var n=0;n<this.fieldsArray.length;++n)this._fieldsArray[n].resolve();var r={};for(n=0;n<this.oneofsArray.length;++n)r[this._oneofsArray[n].resolve().name]={get:h.oneOfGetter(this._oneofsArray[n].oneof),set:h.oneOfSetter(this._oneofsArray[n].oneof)};n&&Object.defineProperties(e.prototype,r)}}}),m.generateConstructor=function(e){for(var t,n=h.codegen(["p"],e.name),r=0;r<e.fieldsArray.length;++r)(t=e._fieldsArray[r]).map?n("this%s={}",h.safeProp(t.name)):t.repeated&&n("this%s=[]",h.safeProp(t.name));return n("if(p)for(var ks=Object.keys(p),i=0;i<ks.length;++i)if(p[ks[i]]!=null)")("this[ks[i]]=p[ks[i]]")},m.fromJSON=function(e,t){var n=new m(e,t.options);n.extensions=t.extensions,n.reserved=t.reserved;for(var u=Object.keys(t.fields),l=0;l<u.length;++l)n.add((void 0!==t.fields[u[l]].keyType?s.fromJSON:a.fromJSON)(u[l],t.fields[u[l]]));if(t.oneofs)for(u=Object.keys(t.oneofs),l=0;l<u.length;++l)n.add(o.fromJSON(u[l],t.oneofs[u[l]]));if(t.nested)for(u=Object.keys(t.nested),l=0;l<u.length;++l){var d=t.nested[u[l]];n.add((d.id!==undefined?a.fromJSON:d.fields!==undefined?m.fromJSON:d.values!==undefined?i.fromJSON:d.methods!==undefined?c.fromJSON:r.fromJSON)(u[l],d))}return t.extensions&&t.extensions.length&&(n.extensions=t.extensions),t.reserved&&t.reserved.length&&(n.reserved=t.reserved),t.group&&(n.group=!0),t.comment&&(n.comment=t.comment),n},m.prototype.toJSON=function(e){var t=r.prototype.toJSON.call(this,e),n=!!e&&Boolean(e.keepComments);return h.toObject(["options",t&&t.options||undefined,"oneofs",r.arrayToJSON(this.oneofsArray,e),"fields",r.arrayToJSON(this.fieldsArray.filter((function(e){return!e.declaringField})),e)||{},"extensions",this.extensions&&this.extensions.length?this.extensions:undefined,"reserved",this.reserved&&this.reserved.length?this.reserved:undefined,"group",this.group||undefined,"nested",t&&t.nested||undefined,"comment",n?this.comment:undefined])},m.prototype.resolveAll=function(){for(var e=this.fieldsArray,t=0;t<e.length;)e[t++].resolve();var n=this.oneofsArray;for(t=0;t<n.length;)n[t++].resolve();return r.prototype.resolveAll.call(this)},m.prototype.get=function(e){return this.fields[e]||this.oneofs&&this.oneofs[e]||this.nested&&this.nested[e]||null},m.prototype.add=function(e){if(this.get(e.name))throw Error("duplicate name '"+e.name+"' in "+this);if(e instanceof a&&e.extend===undefined){if(this._fieldsById?this._fieldsById[e.id]:this.fieldsById[e.id])throw Error("duplicate id "+e.id+" in "+this);if(this.isReservedId(e.id))throw Error("id "+e.id+" is reserved in "+this);if(this.isReservedName(e.name))throw Error("name '"+e.name+"' is reserved in "+this);return e.parent&&e.parent.remove(e),this.fields[e.name]=e,e.message=this,e.onAdd(this),y(this)}return e instanceof o?(this.oneofs||(this.oneofs={}),this.oneofs[e.name]=e,e.onAdd(this),y(this)):r.prototype.add.call(this,e)},m.prototype.remove=function(e){if(e instanceof a&&e.extend===undefined){if(!this.fields||this.fields[e.name]!==e)throw Error(e+" is not a member of "+this);return delete this.fields[e.name],e.parent=null,e.onRemove(this),y(this)}if(e instanceof o){if(!this.oneofs||this.oneofs[e.name]!==e)throw Error(e+" is not a member of "+this);return delete this.oneofs[e.name],e.parent=null,e.onRemove(this),y(this)}return r.prototype.remove.call(this,e)},m.prototype.isReservedId=function(e){return r.isReservedId(this.reserved,e)},m.prototype.isReservedName=function(e){return r.isReservedName(this.reserved,e)},m.prototype.create=function(e){return new this.ctor(e)},m.prototype.setup=function(){for(var e=this.fullName,t=[],n=0;n<this.fieldsArray.length;++n)t.push(this._fieldsArray[n].resolve().resolvedType);this.encode=f(this)({Writer:d,types:t,util:h}),this.decode=p(this)({Reader:l,types:t,util:h}),this.verify=A(this)({types:t,util:h}),this.fromObject=g.fromObject(this)({types:t,util:h}),this.toObject=g.toObject(this)({types:t,util:h});var r=v[e];if(r){var i=Object.create(this);i.fromObject=this.fromObject,this.fromObject=r.fromObject.bind(i),i.toObject=this.toObject,this.toObject=r.toObject.bind(i)}return this},m.prototype.encode=function(e,t){return this.setup().encode(e,t)},m.prototype.encodeDelimited=function(e,t){return this.encode(e,t&&t.len?t.fork():t).ldelim()},m.prototype.decode=function(e,t){return this.setup().decode(e,t)},m.prototype.decodeDelimited=function(e){return e instanceof l||(e=l.create(e)),this.decode(e,e.uint32())},m.prototype.verify=function(e){return this.setup().verify(e)},m.prototype.fromObject=function(e){return this.setup().fromObject(e)},m.prototype.toObject=function(e,t){return this.setup().toObject(e,t)},m.d=function(e){return function(t){h.decorateType(t,e)}}},{11:11,12:12,13:13,14:14,15:15,18:18,19:19,21:21,23:23,24:24,30:30,33:33,36:36,37:37,38:38}],32:[function(e,t,n){var r=n,i=e(33),o=["double","float","int32","uint32","sint32","fixed32","sfixed32","int64","uint64","sint64","fixed64","sfixed64","bool","string","bytes"];function a(e,t){var n=0,r={};for(t|=0;n<e.length;)r[o[n+t]]=e[n++];return r}r.basic=a([1,5,0,0,0,5,5,0,0,0,1,1,0,2,2]),r.defaults=a([0,0,0,0,0,0,0,0,0,0,0,0,!1,"",i.emptyArray,null]),r.long=a([0,0,0,1,1],7),r.mapKey=a([0,0,0,5,5,0,0,0,1,1,0,2],2),r.packed=a([1,5,0,0,0,5,5,0,0,0,1,1,0])},{33:33}],33:[function(e,t,n){var r,i,o=t.exports=e(35),a=e(27);o.codegen=e(3),o.fetch=e(5),o.path=e(8),o.fs=o.inquire("fs"),o.toArray=function(e){if(e){for(var t=Object.keys(e),n=new Array(t.length),r=0;r<t.length;)n[r]=e[t[r++]];return n}return[]},o.toObject=function(e){for(var t={},n=0;n<e.length;){var r=e[n++],i=e[n++];i!==undefined&&(t[r]=i)}return t};var s=/\\/g,c=/"/g;o.isReserved=function(e){return/^(?:do|if|in|for|let|new|try|var|case|else|enum|eval|false|null|this|true|void|with|break|catch|class|const|super|throw|while|yield|delete|export|import|public|return|static|switch|typeof|default|extends|finally|package|private|continue|debugger|function|arguments|interface|protected|implements|instanceof)$/.test(e)},o.safeProp=function(e){return!/^[$\w_]+$/.test(e)||o.isReserved(e)?'["'+e.replace(s,"\\\\").replace(c,'\\"')+'"]':"."+e},o.ucFirst=function(e){return e.charAt(0).toUpperCase()+e.substring(1)};var u=/_([a-z])/g;o.camelCase=function(e){return e.substring(0,1)+e.substring(1).replace(u,(function(e,t){return t.toUpperCase()}))},o.compareFieldsById=function(e,t){return e.id-t.id},o.decorateType=function(t,n){if(t.$type)return n&&t.$type.name!==n&&(o.decorateRoot.remove(t.$type),t.$type.name=n,o.decorateRoot.add(t.$type)),t.$type;r||(r=e(31));var i=new r(n||t.name);return o.decorateRoot.add(i),i.ctor=t,Object.defineProperty(t,"$type",{value:i,enumerable:!1}),Object.defineProperty(t.prototype,"$type",{value:i,enumerable:!1}),i};var l=0;o.decorateEnum=function(t){if(t.$type)return t.$type;i||(i=e(14));var n=new i("Enum"+l++,t);return o.decorateRoot.add(n),Object.defineProperty(t,"$type",{value:n,enumerable:!1}),n},o.setProperty=function(e,t,n){if("object"!=typeof e)throw TypeError("dst must be an object");if(!t)throw TypeError("path must be specified");return function e(t,n,r){var i=n.shift();if(n.length>0)t[i]=e(t[i]||{},n,r);else{var o=t[i];o&&(r=[].concat(o).concat(r)),t[i]=r}return t}(e,t=t.split("."),n)},Object.defineProperty(o,"decorateRoot",{get:function(){return a.decorated||(a.decorated=new(e(26)))}})},{14:14,26:26,27:27,3:3,31:31,35:35,5:5,8:8}],34:[function(e,t,n){t.exports=i;var r=e(35);function i(e,t){this.lo=e>>>0,this.hi=t>>>0}var o=i.zero=new i(0,0);o.toNumber=function(){return 0},o.zzEncode=o.zzDecode=function(){return this},o.length=function(){return 1};var a=i.zeroHash="\0\0\0\0\0\0\0\0";i.fromNumber=function(e){if(0===e)return o;var t=e<0;t&&(e=-e);var n=e>>>0,r=(e-n)/4294967296>>>0;return t&&(r=~r>>>0,n=~n>>>0,++n>4294967295&&(n=0,++r>4294967295&&(r=0))),new i(n,r)},i.from=function(e){if("number"==typeof e)return i.fromNumber(e);if(r.isString(e)){if(!r.Long)return i.fromNumber(parseInt(e,10));e=r.Long.fromString(e)}return e.low||e.high?new i(e.low>>>0,e.high>>>0):o},i.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var t=1+~this.lo>>>0,n=~this.hi>>>0;return t||(n=n+1>>>0),-(t+4294967296*n)}return this.lo+4294967296*this.hi},i.prototype.toLong=function(e){return r.Long?new r.Long(0|this.lo,0|this.hi,Boolean(e)):{low:0|this.lo,high:0|this.hi,unsigned:Boolean(e)}};var s=String.prototype.charCodeAt;i.fromHash=function(e){return e===a?o:new i((s.call(e,0)|s.call(e,1)<<8|s.call(e,2)<<16|s.call(e,3)<<24)>>>0,(s.call(e,4)|s.call(e,5)<<8|s.call(e,6)<<16|s.call(e,7)<<24)>>>0)},i.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},i.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this},i.prototype.zzDecode=function(){var e=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this},i.prototype.length=function(){var e=this.lo,t=(this.lo>>>28|this.hi<<4)>>>0,n=this.hi>>>24;return 0===n?0===t?e<16384?e<128?1:2:e<2097152?3:4:t<16384?t<128?5:6:t<2097152?7:8:n<128?9:10}},{35:35}],35:[function(e,t,n){var r=n;function i(e,t,n){for(var r=Object.keys(t),i=0;i<r.length;++i)e[r[i]]!==undefined&&n||(e[r[i]]=t[r[i]]);return e}function o(e){function t(e,n){if(!(this instanceof t))return new t(e,n);Object.defineProperty(this,"message",{get:function(){return e}}),Error.captureStackTrace?Error.captureStackTrace(this,t):Object.defineProperty(this,"stack",{value:(new Error).stack||""}),n&&i(this,n)}return(t.prototype=Object.create(Error.prototype)).constructor=t,Object.defineProperty(t.prototype,"name",{get:function(){return e}}),t.prototype.toString=function(){return this.name+": "+this.message},t}r.asPromise=e(1),r.base64=e(2),r.EventEmitter=e(4),r.float=e(6),r.inquire=e(7),r.utf8=e(10),r.pool=e(9),r.LongBits=e(34),r.isNode=Boolean(void 0!==global&&global&&global.process&&global.process.versions&&global.process.versions.node),r.global=r.isNode&&global||"undefined"!=typeof window&&window||"undefined"!=typeof self&&self||this,r.emptyArray=Object.freeze?Object.freeze([]):[],r.emptyObject=Object.freeze?Object.freeze({}):{},r.isInteger=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},r.isString=function(e){return"string"==typeof e||e instanceof String},r.isObject=function(e){return e&&"object"==typeof e},r.isset=r.isSet=function(e,t){var n=e[t];return!(null==n||!e.hasOwnProperty(t))&&("object"!=typeof n||(Array.isArray(n)?n.length:Object.keys(n).length)>0)},r.Buffer=function(){try{var e=r.inquire("buffer").Buffer;return e.prototype.utf8Write?e:null}catch(e){return null}}(),r._Buffer_from=null,r._Buffer_allocUnsafe=null,r.newBuffer=function(e){return"number"==typeof e?r.Buffer?r._Buffer_allocUnsafe(e):new r.Array(e):r.Buffer?r._Buffer_from(e):"undefined"==typeof Uint8Array?e:new Uint8Array(e)},r.Array="undefined"!=typeof Uint8Array?Uint8Array:Array,r.Long=r.global.dcodeIO&&r.global.dcodeIO.Long||r.global.Long||r.inquire("long"),r.key2Re=/^true|false|0|1$/,r.key32Re=/^-?(?:0|[1-9][0-9]*)$/,r.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,r.longToHash=function(e){return e?r.LongBits.from(e).toHash():r.LongBits.zeroHash},r.longFromHash=function(e,t){var n=r.LongBits.fromHash(e);return r.Long?r.Long.fromBits(n.lo,n.hi,t):n.toNumber(Boolean(t))},r.merge=i,r.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)},r.newError=o,r.ProtocolError=o("ProtocolError"),r.oneOfGetter=function(e){for(var t={},n=0;n<e.length;++n)t[e[n]]=1;return function(){for(var e=Object.keys(this),n=e.length-1;n>-1;--n)if(1===t[e[n]]&&this[e[n]]!==undefined&&null!==this[e[n]])return e[n]}},r.oneOfSetter=function(e){return function(t){for(var n=0;n<e.length;++n)e[n]!==t&&delete this[e[n]]}},r.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},r._configure=function(){var e=r.Buffer;e?(r._Buffer_from=e.from!==Uint8Array.from&&e.from||function(t,n){return new e(t,n)},r._Buffer_allocUnsafe=e.allocUnsafe||function(t){return new e(t)}):r._Buffer_from=r._Buffer_allocUnsafe=null}},{1:1,10:10,2:2,34:34,4:4,6:6,7:7,9:9}],36:[function(e,t,n){t.exports=function(e){var t=i.codegen(["m"],e.name+"$verify")('if(typeof m!=="object"||m===null)')("return%j","object expected"),n={};e.oneofsArray.length&&t("var p={}");for(var r=0;r<e.fieldsArray.length;++r){var c=e._fieldsArray[r].resolve(),u="m"+i.safeProp(c.name);if(c.optional&&t("if(%s!=null&&m.hasOwnProperty(%j)){",u,c.name),c.map)t("if(!util.isObject(%s))",u)("return%j",o(c,"object"))("var k=Object.keys(%s)",u)("for(var i=0;i<k.length;++i){"),s(t,c,"k[i]"),a(t,c,r,u+"[k[i]]")("}");else if(c.repeated)t("if(!Array.isArray(%s))",u)("return%j",o(c,"array"))("for(var i=0;i<%s.length;++i){",u),a(t,c,r,u+"[i]")("}");else{if(c.partOf){var l=i.safeProp(c.partOf.name);1===n[c.partOf.name]&&t("if(p%s===1)",l)("return%j",c.partOf.name+": multiple values"),n[c.partOf.name]=1,t("p%s=1",l)}a(t,c,r,u)}c.optional&&t("}")}return t("return null")};var r=e(14),i=e(33);function o(e,t){return e.name+": "+t+(e.repeated&&"array"!==t?"[]":e.map&&"object"!==t?"{k:"+e.keyType+"}":"")+" expected"}function a(e,t,n,i){if(t.resolvedType)if(t.resolvedType instanceof r){e("switch(%s){",i)("default:")("return%j",o(t,"enum value"));for(var a=Object.keys(t.resolvedType.values),s=0;s<a.length;++s)e("case %i:",t.resolvedType.values[a[s]]);e("break")("}")}else e("{")("var e=types[%i].verify(%s);",n,i)("if(e)")("return%j+e",t.name+".")("}");else switch(t.type){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":e("if(!util.isInteger(%s))",i)("return%j",o(t,"integer"));break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":e("if(!util.isInteger(%s)&&!(%s&&util.isInteger(%s.low)&&util.isInteger(%s.high)))",i,i,i,i)("return%j",o(t,"integer|Long"));break;case"float":case"double":e('if(typeof %s!=="number")',i)("return%j",o(t,"number"));break;case"bool":e('if(typeof %s!=="boolean")',i)("return%j",o(t,"boolean"));break;case"string":e("if(!util.isString(%s))",i)("return%j",o(t,"string"));break;case"bytes":e('if(!(%s&&typeof %s.length==="number"||util.isString(%s)))',i,i,i)("return%j",o(t,"buffer"))}return e}function s(e,t,n){switch(t.keyType){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":e("if(!util.key32Re.test(%s))",n)("return%j",o(t,"integer key"));break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":e("if(!util.key64Re.test(%s))",n)("return%j",o(t,"integer|Long key"));break;case"bool":e("if(!util.key2Re.test(%s))",n)("return%j",o(t,"boolean key"))}return e}},{14:14,33:33}],37:[function(e,t,n){var r=n,i=e(19);r[".google.protobuf.Any"]={fromObject:function(e){if(e&&e["@type"]){var t=e["@type"].substring(e["@type"].lastIndexOf("/")+1),n=this.lookup(t);if(n){var r="."===e["@type"].charAt(0)?e["@type"].substr(1):e["@type"];return-1===r.indexOf("/")&&(r="/"+r),this.create({type_url:r,value:n.encode(n.fromObject(e)).finish()})}}return this.fromObject(e)},toObject:function(e,t){var n="",r="";if(t&&t.json&&e.type_url&&e.value){r=e.type_url.substring(e.type_url.lastIndexOf("/")+1),n=e.type_url.substring(0,e.type_url.lastIndexOf("/")+1);var o=this.lookup(r);o&&(e=o.decode(e.value))}if(!(e instanceof this.ctor)&&e instanceof i){var a=e.$type.toObject(e,t);return""===n&&(n="type.googleapis.com/"),r=n+("."===e.$type.fullName[0]?e.$type.fullName.substr(1):e.$type.fullName),a["@type"]=r,a}return this.toObject(e,t)}}},{19:19}],38:[function(e,t,n){t.exports=d;var r,i=e(35),o=i.LongBits,a=i.base64,s=i.utf8;function c(e,t,n){this.fn=e,this.len=t,this.next=undefined,this.val=n}function u(){}function l(e){this.head=e.head,this.tail=e.tail,this.len=e.len,this.next=e.states}function d(){this.len=0,this.head=new c(u,0,0),this.tail=this.head,this.states=null}var h=function(){return i.Buffer?function(){return(d.create=function(){return new r})()}:function(){return new d}};function f(e,t,n){t[n]=255&e}function p(e,t){this.len=e,this.next=undefined,this.val=t}function A(e,t,n){for(;e.hi;)t[n++]=127&e.lo|128,e.lo=(e.lo>>>7|e.hi<<25)>>>0,e.hi>>>=7;for(;e.lo>127;)t[n++]=127&e.lo|128,e.lo=e.lo>>>7;t[n++]=e.lo}function g(e,t,n){t[n]=255&e,t[n+1]=e>>>8&255,t[n+2]=e>>>16&255,t[n+3]=e>>>24}d.create=h(),d.alloc=function(e){return new i.Array(e)},i.Array!==Array&&(d.alloc=i.pool(d.alloc,i.Array.prototype.subarray)),d.prototype._push=function(e,t,n){return this.tail=this.tail.next=new c(e,t,n),this.len+=t,this},p.prototype=Object.create(c.prototype),p.prototype.fn=function(e,t,n){for(;e>127;)t[n++]=127&e|128,e>>>=7;t[n]=e},d.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new p((e>>>=0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this},d.prototype.int32=function(e){return e<0?this._push(A,10,o.fromNumber(e)):this.uint32(e)},d.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)},d.prototype.uint64=function(e){var t=o.from(e);return this._push(A,t.length(),t)},d.prototype.int64=d.prototype.uint64,d.prototype.sint64=function(e){var t=o.from(e).zzEncode();return this._push(A,t.length(),t)},d.prototype.bool=function(e){return this._push(f,1,e?1:0)},d.prototype.fixed32=function(e){return this._push(g,4,e>>>0)},d.prototype.sfixed32=d.prototype.fixed32,d.prototype.fixed64=function(e){var t=o.from(e);return this._push(g,4,t.lo)._push(g,4,t.hi)},d.prototype.sfixed64=d.prototype.fixed64,d.prototype.float=function(e){return this._push(i.float.writeFloatLE,4,e)},d.prototype.double=function(e){return this._push(i.float.writeDoubleLE,8,e)};var v=i.Array.prototype.set?function(e,t,n){t.set(e,n)}:function(e,t,n){for(var r=0;r<e.length;++r)t[n+r]=e[r]};d.prototype.bytes=function(e){var t=e.length>>>0;if(!t)return this._push(f,1,0);if(i.isString(e)){var n=d.alloc(t=a.length(e));a.decode(e,n,0),e=n}return this.uint32(t)._push(v,t,e)},d.prototype.string=function(e){var t=s.length(e);return t?this.uint32(t)._push(s.write,t,e):this._push(f,1,0)},d.prototype.fork=function(){return this.states=new l(this),this.head=this.tail=new c(u,0,0),this.len=0,this},d.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new c(u,0,0),this.len=0),this},d.prototype.ldelim=function(){var e=this.head,t=this.tail,n=this.len;return this.reset().uint32(n),n&&(this.tail.next=e.next,this.tail=t,this.len+=n),this},d.prototype.finish=function(){for(var e=this.head.next,t=this.constructor.alloc(this.len),n=0;e;)e.fn(e.val,t,n),n+=e.len,e=e.next;return t},d._configure=function(e){r=e,d.create=h(),r._configure()}},{35:35}],39:[function(e,t,n){t.exports=o;var r=e(38);(o.prototype=Object.create(r.prototype)).constructor=o;var i=e(35);function o(){r.call(this)}function a(e,t,n){e.length<40?i.utf8.write(e,t,n):t.utf8Write?t.utf8Write(e,n):t.write(e,n)}o._configure=function(){o.alloc=i._Buffer_allocUnsafe,o.writeBytesBuffer=i.Buffer&&i.Buffer.prototype instanceof Uint8Array&&"set"===i.Buffer.prototype.set.name?function(e,t,n){t.set(e,n)}:function(e,t,n){if(e.copy)e.copy(t,n,0,e.length);else for(var r=0;r<e.length;)t[n++]=e[r++]}},o.prototype.bytes=function(e){i.isString(e)&&(e=i._Buffer_from(e,"base64"));var t=e.length>>>0;return this.uint32(t),t&&this._push(o.writeBytesBuffer,t,e),this},o.prototype.string=function(e){var t=i.Buffer.byteLength(e);return this.uint32(t),t&&this._push(a,t,e),this},o._configure()},{35:35,38:38}]},{})}()}).call(this,__webpack_require__(57),__webpack_require__(58)(module))},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t){e.exports=r;var n=null;try{n=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(e){}function r(e,t,n){this.low=0|e,this.high=0|t,this.unsigned=!!n}function i(e){return!0===(e&&e.__isLong__)}r.prototype.__isLong__,Object.defineProperty(r.prototype,"__isLong__",{value:!0}),r.isLong=i;var o={},a={};function s(e,t){var n,r,i;return t?(i=0<=(e>>>=0)&&e<256)&&(r=a[e])?r:(n=u(e,(0|e)<0?-1:0,!0),i&&(a[e]=n),n):(i=-128<=(e|=0)&&e<128)&&(r=o[e])?r:(n=u(e,e<0?-1:0,!1),i&&(o[e]=n),n)}function c(e,t){if(isNaN(e))return t?m:v;if(t){if(e<0)return m;if(e>=p)return w}else{if(e<=-A)return S;if(e+1>=A)return _}return e<0?c(-e,t).neg():u(e%f|0,e/f|0,t)}function u(e,t,n){return new r(e,t,n)}r.fromInt=s,r.fromNumber=c,r.fromBits=u;var l=Math.pow;function d(e,t,n){if(0===e.length)throw Error("empty string");if("NaN"===e||"Infinity"===e||"+Infinity"===e||"-Infinity"===e)return v;if("number"==typeof t?(n=t,t=!1):t=!!t,(n=n||10)<2||36<n)throw RangeError("radix");var r;if((r=e.indexOf("-"))>0)throw Error("interior hyphen");if(0===r)return d(e.substring(1),t,n).neg();for(var i=c(l(n,8)),o=v,a=0;a<e.length;a+=8){var s=Math.min(8,e.length-a),u=parseInt(e.substring(a,a+s),n);if(s<8){var h=c(l(n,s));o=o.mul(h).add(c(u))}else o=(o=o.mul(i)).add(c(u))}return o.unsigned=t,o}function h(e,t){return"number"==typeof e?c(e,t):"string"==typeof e?d(e,t):u(e.low,e.high,"boolean"==typeof t?t:e.unsigned)}r.fromString=d,r.fromValue=h;var f=4294967296,p=f*f,A=p/2,g=s(1<<24),v=s(0);r.ZERO=v;var m=s(0,!0);r.UZERO=m;var y=s(1);r.ONE=y;var b=s(1,!0);r.UONE=b;var E=s(-1);r.NEG_ONE=E;var _=u(-1,2147483647,!1);r.MAX_VALUE=_;var w=u(-1,-1,!0);r.MAX_UNSIGNED_VALUE=w;var S=u(0,-2147483648,!1);r.MIN_VALUE=S;var T=r.prototype;T.toInt=function(){return this.unsigned?this.low>>>0:this.low},T.toNumber=function(){return this.unsigned?(this.high>>>0)*f+(this.low>>>0):this.high*f+(this.low>>>0)},T.toString=function(e){if((e=e||10)<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(S)){var t=c(e),n=this.div(t),r=n.mul(t).sub(this);return n.toString(e)+r.toInt().toString(e)}return"-"+this.neg().toString(e)}for(var i=c(l(e,6),this.unsigned),o=this,a="";;){var s=o.div(i),u=(o.sub(s.mul(i)).toInt()>>>0).toString(e);if((o=s).isZero())return u+a;for(;u.length<6;)u="0"+u;a=""+u+a}},T.getHighBits=function(){return this.high},T.getHighBitsUnsigned=function(){return this.high>>>0},T.getLowBits=function(){return this.low},T.getLowBitsUnsigned=function(){return this.low>>>0},T.getNumBitsAbs=function(){if(this.isNegative())return this.eq(S)?64:this.neg().getNumBitsAbs();for(var e=0!=this.high?this.high:this.low,t=31;t>0&&0==(e&1<<t);t--);return 0!=this.high?t+33:t+1},T.isZero=function(){return 0===this.high&&0===this.low},T.eqz=T.isZero,T.isNegative=function(){return!this.unsigned&&this.high<0},T.isPositive=function(){return this.unsigned||this.high>=0},T.isOdd=function(){return 1==(1&this.low)},T.isEven=function(){return 0==(1&this.low)},T.equals=function(e){return i(e)||(e=h(e)),(this.unsigned===e.unsigned||this.high>>>31!=1||e.high>>>31!=1)&&this.high===e.high&&this.low===e.low},T.eq=T.equals,T.notEquals=function(e){return!this.eq(e)},T.neq=T.notEquals,T.ne=T.notEquals,T.lessThan=function(e){return this.comp(e)<0},T.lt=T.lessThan,T.lessThanOrEqual=function(e){return this.comp(e)<=0},T.lte=T.lessThanOrEqual,T.le=T.lessThanOrEqual,T.greaterThan=function(e){return this.comp(e)>0},T.gt=T.greaterThan,T.greaterThanOrEqual=function(e){return this.comp(e)>=0},T.gte=T.greaterThanOrEqual,T.ge=T.greaterThanOrEqual,T.compare=function(e){if(i(e)||(e=h(e)),this.eq(e))return 0;var t=this.isNegative(),n=e.isNegative();return t&&!n?-1:!t&&n?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1},T.comp=T.compare,T.negate=function(){return!this.unsigned&&this.eq(S)?S:this.not().add(y)},T.neg=T.negate,T.add=function(e){i(e)||(e=h(e));var t=this.high>>>16,n=65535&this.high,r=this.low>>>16,o=65535&this.low,a=e.high>>>16,s=65535&e.high,c=e.low>>>16,l=0,d=0,f=0,p=0;return f+=(p+=o+(65535&e.low))>>>16,d+=(f+=r+c)>>>16,l+=(d+=n+s)>>>16,l+=t+a,u((f&=65535)<<16|(p&=65535),(l&=65535)<<16|(d&=65535),this.unsigned)},T.subtract=function(e){return i(e)||(e=h(e)),this.add(e.neg())},T.sub=T.subtract,T.multiply=function(e){if(this.isZero())return v;if(i(e)||(e=h(e)),n)return u(n.mul(this.low,this.high,e.low,e.high),n.get_high(),this.unsigned);if(e.isZero())return v;if(this.eq(S))return e.isOdd()?S:v;if(e.eq(S))return this.isOdd()?S:v;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(g)&&e.lt(g))return c(this.toNumber()*e.toNumber(),this.unsigned);var t=this.high>>>16,r=65535&this.high,o=this.low>>>16,a=65535&this.low,s=e.high>>>16,l=65535&e.high,d=e.low>>>16,f=65535&e.low,p=0,A=0,m=0,y=0;return m+=(y+=a*f)>>>16,A+=(m+=o*f)>>>16,m&=65535,A+=(m+=a*d)>>>16,p+=(A+=r*f)>>>16,A&=65535,p+=(A+=o*d)>>>16,A&=65535,p+=(A+=a*l)>>>16,p+=t*f+r*d+o*l+a*s,u((m&=65535)<<16|(y&=65535),(p&=65535)<<16|(A&=65535),this.unsigned)},T.mul=T.multiply,T.divide=function(e){if(i(e)||(e=h(e)),e.isZero())throw Error("division by zero");var t,r,o;if(n)return this.unsigned||-2147483648!==this.high||-1!==e.low||-1!==e.high?u((this.unsigned?n.div_u:n.div_s)(this.low,this.high,e.low,e.high),n.get_high(),this.unsigned):this;if(this.isZero())return this.unsigned?m:v;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return m;if(e.gt(this.shru(1)))return b;o=m}else{if(this.eq(S))return e.eq(y)||e.eq(E)?S:e.eq(S)?y:(t=this.shr(1).div(e).shl(1)).eq(v)?e.isNegative()?y:E:(r=this.sub(e.mul(t)),o=t.add(r.div(e)));if(e.eq(S))return this.unsigned?m:v;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();o=v}for(r=this;r.gte(e);){t=Math.max(1,Math.floor(r.toNumber()/e.toNumber()));for(var a=Math.ceil(Math.log(t)/Math.LN2),s=a<=48?1:l(2,a-48),d=c(t),f=d.mul(e);f.isNegative()||f.gt(r);)f=(d=c(t-=s,this.unsigned)).mul(e);d.isZero()&&(d=y),o=o.add(d),r=r.sub(f)}return o},T.div=T.divide,T.modulo=function(e){return i(e)||(e=h(e)),n?u((this.unsigned?n.rem_u:n.rem_s)(this.low,this.high,e.low,e.high),n.get_high(),this.unsigned):this.sub(this.div(e).mul(e))},T.mod=T.modulo,T.rem=T.modulo,T.not=function(){return u(~this.low,~this.high,this.unsigned)},T.and=function(e){return i(e)||(e=h(e)),u(this.low&e.low,this.high&e.high,this.unsigned)},T.or=function(e){return i(e)||(e=h(e)),u(this.low|e.low,this.high|e.high,this.unsigned)},T.xor=function(e){return i(e)||(e=h(e)),u(this.low^e.low,this.high^e.high,this.unsigned)},T.shiftLeft=function(e){return i(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?u(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):u(0,this.low<<e-32,this.unsigned)},T.shl=T.shiftLeft,T.shiftRight=function(e){return i(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?u(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):u(this.high>>e-32,this.high>=0?0:-1,this.unsigned)},T.shr=T.shiftRight,T.shiftRightUnsigned=function(e){if(i(e)&&(e=e.toInt()),0==(e&=63))return this;var t=this.high;return e<32?u(this.low>>>e|t<<32-e,t>>>e,this.unsigned):u(32===e?t:t>>>e-32,0,this.unsigned)},T.shru=T.shiftRightUnsigned,T.shr_u=T.shiftRightUnsigned,T.toSigned=function(){return this.unsigned?u(this.low,this.high,!1):this},T.toUnsigned=function(){return this.unsigned?this:u(this.low,this.high,!0)},T.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()},T.toBytesLE=function(){var e=this.high,t=this.low;return[255&t,t>>>8&255,t>>>16&255,t>>>24,255&e,e>>>8&255,e>>>16&255,e>>>24]},T.toBytesBE=function(){var e=this.high,t=this.low;return[e>>>24,e>>>16&255,e>>>8&255,255&e,t>>>24,t>>>16&255,t>>>8&255,255&t]},r.fromBytes=function(e,t,n){return n?r.fromBytesLE(e,t):r.fromBytesBE(e,t)},r.fromBytesLE=function(e,t){return new r(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,t)},r.fromBytesBE=function(e,t){return new r(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],t)}},function(e){e.exports=JSON.parse('{"PeerPublishStatus":408,"JoinChannelTimeout":407,"OnUpdateStream":356,"OnRemoveStream":355,"OnAddVideoStream":353,"OnAddAudioStream":352,"FirstAudioDecode":351,"FirstVideoDecode":350,"FirstAudioReceived":349,"FirstVideoReceived":348,"ReqUserAccount":196,"ApiInvoke":41,"RequestProxyWorkerManager":36,"RequestProxyAppCenter":35,"VideoSendingStopped":34,"AudioSendingStopped":33,"StreamSwitch":32,"FirstFrame":31,"Publish":30,"Subscribe":29,"JoinGateway":28,"JoinChooseServer":27,"Session":26,"APWorkerEvent":160,"WorkerEvent":156,"JoinWebProxyAP":700,"WebSocketQuit":671}')},function(e){e.exports=JSON.parse('{"nested":{"protobuf":{"nested":{"Session":{"fields":{"sid":{"type":"string","id":1},"cname":{"type":"string","id":2},"cid":{"type":"int64","id":3},"lts":{"type":"int64","id":4},"ip":{"type":"string","id":5},"uid":{"type":"int64","id":6},"success":{"type":"bool","id":7},"elapse":{"type":"int64","id":8},"peer":{"type":"int64","id":9},"eventType":{"type":"string","id":10},"version":{"type":"string","id":11},"browser":{"type":"string","id":12},"appid":{"type":"string","id":13},"mode":{"type":"string","id":14},"extend":{"type":"string","id":15},"process":{"type":"string","id":16},"build":{"type":"string","id":17},"ipv6":{"type":"string","id":18},"sourceHost":{"type":"string","id":19},"sourcePath":{"type":"string","id":20},"collectorHost":{"type":"string","id":21},"collectorName":{"type":"string","id":22}}},"JoinChooseServer":{"fields":{"sid":{"type":"string","id":1},"cname":{"type":"string","id":2},"cid":{"type":"int64","id":3},"lts":{"type":"int64","id":4},"ip":{"type":"string","id":5},"uid":{"type":"int64","id":6},"success":{"type":"bool","id":7},"elapse":{"type":"int64","id":8},"peer":{"type":"int64","id":9},"eventType":{"type":"string","id":10},"chooseServerAddr":{"type":"string","id":11},"chooseServerAddrList":{"type":"string","id":12},"errorCode":{"type":"string","id":13},"eventElapse":{"type":"int64","id":14}}},"JoinGateway":{"fields":{"sid":{"type":"string","id":1},"cname":{"type":"string","id":2},"cid":{"type":"int64","id":3},"lts":{"type":"int64","id":4},"ip":{"type":"string","id":5},"uid":{"type":"int64","id":6},"success":{"type":"bool","id":7},"elapse":{"type":"int64","id":8},"peer":{"type":"int64","id":9},"eventType":{"type":"string","id":10},"gatewayAddr":{"type":"string","id":11},"errorCode":{"type":"string","id":12},"eventElapse":{"type":"int64","id":13},"firstSuccess":{"type":"bool","id":14}}},"Subscribe":{"fields":{"sid":{"type":"string","id":1},"cname":{"type":"string","id":2},"cid":{"type":"int64","id":3},"lts":{"type":"int64","id":4},"ip":{"type":"string","id":5},"uid":{"type":"int64","id":6},"success":{"type":"bool","id":7},"elapse":{"type":"int64","id":8},"peer":{"type":"int64","id":9},"eventType":{"type":"string","id":10},"localSdp":{"type":"string","id":11},"remoteSdp":{"type":"string","id":12},"extend":{"type":"string","id":13},"errorCode":{"type":"string","id":14},"eventElapse":{"type":"int64","id":15},"video":{"type":"bool","id":16},"audio":{"type":"bool","id":17},"subscribeRequestid":{"type":"int32","id":18},"p2pid":{"type":"int32","id":19}}},"Publish":{"fields":{"sid":{"type":"string","id":1},"cname":{"type":"string","id":2},"cid":{"type":"int64","id":3},"lts":{"type":"int64","id":4},"ip":{"type":"string","id":5},"uid":{"type":"int64","id":6},"success":{"type":"bool","id":7},"elapse":{"type":"int64","id":8},"peer":{"type":"int64","id":9},"eventType":{"type":"string","id":10},"localSdp":{"type":"string","id":11},"remoteSdp":{"type":"string","id":12},"extend":{"type":"string","id":13},"errorCode":{"type":"string","id":14},"eventElapse":{"type":"int64","id":15},"videoName":{"type":"string","id":16},"audioName":{"type":"string","id":17},"screenName":{"type":"string","id":18},"video":{"type":"bool","id":19},"audio":{"type":"bool","id":20},"publishRequestid":{"type":"int32","id":21},"p2pid":{"type":"int32","id":22},"screenshare":{"type":"bool","id":23}}},"FirstFrame":{"fields":{"sid":{"type":"string","id":1},"cname":{"type":"string","id":2},"cid":{"type":"int64","id":3},"lts":{"type":"int64","id":4},"ip":{"type":"string","id":5},"uid":{"type":"int64","id":6},"success":{"type":"bool","id":7},"elapse":{"type":"int64","id":8},"peer":{"type":"int64","id":9},"eventType":{"type":"string","id":10},"extend":{"type":"string","id":11},"errorCode":{"type":"string","id":12},"width":{"type":"int64","id":13},"height":{"type":"int64","id":14}}},"StreamSwitch":{"fields":{"sid":{"type":"string","id":1},"cname":{"type":"string","id":2},"cid":{"type":"int64","id":3},"lts":{"type":"int64","id":4},"ip":{"type":"string","id":5},"uid":{"type":"int64","id":6},"success":{"type":"bool","id":7},"elapse":{"type":"int64","id":8},"peer":{"type":"int64","id":9},"eventType":{"type":"string","id":10},"isDual":{"type":"bool","id":11}}},"AudioSendingStopped":{"fields":{"sid":{"type":"string","id":1},"cname":{"type":"string","id":2},"cid":{"type":"int64","id":3},"lts":{"type":"int64","id":4},"ip":{"type":"string","id":5},"uid":{"type":"int64","id":6},"success":{"type":"bool","id":7},"elapse":{"type":"int64","id":8},"peer":{"type":"int64","id":9},"reason":{"type":"string","id":10},"eventType":{"type":"string","id":11}}},"VideoSendingStopped":{"fields":{"sid":{"type":"string","id":1},"cname":{"type":"string","id":2},"cid":{"type":"int64","id":3},"lts":{"type":"int64","id":4},"ip":{"type":"string","id":5},"uid":{"type":"int64","id":6},"success":{"type":"bool","id":7},"elapse":{"type":"int64","id":8},"peer":{"type":"int64","id":9},"reason":{"type":"string","id":10},"eventType":{"type":"string","id":11}}},"RequestProxyAppCenter":{"fields":{"sid":{"type":"string","id":1},"cname":{"type":"string","id":2},"cid":{"type":"int64","id":3},"lts":{"type":"int64","id":4},"ip":{"type":"string","id":5},"uid":{"type":"int64","id":6},"success":{"type":"bool","id":7},"elapse":{"type":"int64","id":8},"peer":{"type":"int64","id":9},"eventType":{"type":"string","id":10},"APAddr":{"type":"string","id":11},"workerManagerList":{"type":"string","id":12},"errorCode":{"type":"string","id":13},"eventElapse":{"type":"int64","id":14},"extend":{"type":"string","id":15},"response":{"type":"string","id":16}}},"RequestProxyWorkerManager":{"fields":{"sid":{"type":"string","id":1},"cname":{"type":"string","id":2},"cid":{"type":"int64","id":3},"lts":{"type":"int64","id":4},"ip":{"type":"string","id":5},"uid":{"type":"int64","id":6},"success":{"type":"bool","id":7},"elapse":{"type":"int64","id":8},"peer":{"type":"int64","id":9},"eventType":{"type":"string","id":10},"workerManagerAddr":{"type":"string","id":11},"errorCode":{"type":"string","id":12},"eventElapse":{"type":"int64","id":13},"extend":{"type":"string","id":14},"response":{"type":"string","id":15}}},"ApiInvoke":{"fields":{"sid":{"type":"string","id":1},"cname":{"type":"string","id":2},"cid":{"type":"int64","id":3},"lts":{"type":"int64","id":4},"ip":{"type":"string","id":5},"uid":{"type":"int64","id":6},"success":{"type":"bool","id":7},"elapse":{"type":"int64","id":8},"apiName":{"type":"string","id":9},"errorCode":{"type":"string","id":10},"options":{"type":"string","id":11},"execElapse":{"type":"int64","id":12},"execStates":{"type":"string","id":13},"execResult":{"type":"string","id":14},"invokeId":{"type":"int64","id":15}}},"ReqUserAccount":{"fields":{"sid":{"type":"string","id":1},"cname":{"type":"string","id":2},"cid":{"type":"int64","id":3},"lts":{"type":"int64","id":4},"ip":{"type":"string","id":5},"uid":{"type":"int64","id":6},"success":{"type":"bool","id":7},"elapse":{"type":"int64","id":8},"eventType":{"type":"string","id":9},"serverAddress":{"type":"string","id":10},"stringUid":{"type":"string","id":11},"errorCode":{"type":"string","id":12},"extend":{"type":"string","id":13}}},"FirstVideoReceived":{"fields":{"lts":{"type":"int64","id":1},"peer":{"type":"int64","id":2},"elapse":{"type":"int64","id":3},"sid":{"type":"string","id":4},"cname":{"type":"string","id":5},"cid":{"type":"int64","id":6},"uid":{"type":"int64","id":8},"subscribeRequestid":{"type":"int32","id":9},"p2pid":{"type":"int32","id":10},"subscribeElapse":{"type":"int64","id":11}}},"FirstAudioReceived":{"fields":{"lts":{"type":"int64","id":1},"sid":{"type":"string","id":2},"cname":{"type":"string","id":3},"cid":{"type":"int64","id":4},"uid":{"type":"int64","id":6},"peer":{"type":"int64","id":7},"elapse":{"type":"int64","id":8},"subscribeRequestid":{"type":"int32","id":9},"p2pid":{"type":"int32","id":10},"subscribeElapse":{"type":"int64","id":11}}},"FirstVideoDecode":{"fields":{"lts":{"type":"int64","id":1},"sid":{"type":"string","id":2},"cname":{"type":"string","id":3},"cid":{"type":"int64","id":4},"uid":{"type":"int64","id":6},"peer":{"type":"int64","id":7},"elapse":{"type":"int64","id":8},"videowidth":{"type":"int32","id":9},"videoheight":{"type":"int32","id":10},"subscribeRequestid":{"type":"int32","id":11},"p2pid":{"type":"int32","id":12},"subscribeElapse":{"type":"int64","id":13}}},"FirstAudioDecode":{"fields":{"lts":{"type":"int64","id":1},"sid":{"type":"string","id":2},"cname":{"type":"string","id":3},"cid":{"type":"int64","id":4},"uid":{"type":"int64","id":6},"peer":{"type":"int64","id":7},"elapse":{"type":"int64","id":8},"subscribeRequestid":{"type":"int32","id":9},"p2pid":{"type":"int32","id":10},"subscribeElapse":{"type":"int64","id":11}}},"OnAddAudioStream":{"fields":{"lts":{"type":"int64","id":1},"sid":{"type":"string","id":2},"cname":{"type":"string","id":3},"cid":{"type":"int64","id":4},"uid":{"type":"int64","id":6},"peer":{"type":"int64","id":7}}},"OnAddVideoStream":{"fields":{"lts":{"type":"int64","id":1},"sid":{"type":"string","id":2},"cname":{"type":"string","id":3},"cid":{"type":"int64","id":4},"uid":{"type":"int64","id":6},"peer":{"type":"int64","id":7}}},"OnRemoveStream":{"fields":{"lts":{"type":"int64","id":1},"sid":{"type":"string","id":2},"cname":{"type":"string","id":3},"cid":{"type":"int64","id":4},"uid":{"type":"int64","id":6},"peer":{"type":"int64","id":7}}},"OnUpdateStream":{"fields":{"lts":{"type":"int64","id":1},"sid":{"type":"string","id":2},"cname":{"type":"string","id":3},"cid":{"type":"int64","id":4},"uid":{"type":"int64","id":6},"peer":{"type":"int64","id":7},"audio":{"type":"bool","id":8},"video":{"type":"bool","id":9}}},"JoinChannelTimeout":{"fields":{"lts":{"type":"int64","id":1},"sid":{"type":"string","id":2},"cname":{"type":"string","id":3},"cid":{"type":"int64","id":4},"uid":{"type":"int64","id":5},"elapse":{"type":"int64","id":6},"timeout":{"type":"int32","id":7}}},"PeerPublishStatus":{"fields":{"lts":{"type":"int64","id":1},"sid":{"type":"string","id":2},"cname":{"type":"string","id":3},"cid":{"type":"int64","id":4},"uid":{"type":"int64","id":5},"peer":{"type":"int64","id":6},"elapse":{"type":"int64","id":7},"peerPublishDuration":{"type":"int64","id":8},"joinChannelSuccessElapse":{"type":"int64","id":9},"subscribeElapse":{"type":"int64","id":10},"audiotag":{"type":"int32","id":11},"videotag":{"type":"int32","id":12},"screensharetag":{"type":"int32","id":13},"firsttimetag":{"type":"int32","id":14}}},"WebSocketQuit":{"fields":{"lts":{"type":"int64","id":1},"sid":{"type":"string","id":2},"cname":{"type":"string","id":3},"cid":{"type":"int64","id":4},"uid":{"type":"int64","id":5},"elapse":{"type":"int64","id":6},"succ":{"type":"int32","id":7},"errorCode":{"type":"string","id":8},"ip":{"type":"string","id":9}}},"Message":{"fields":{"id":{"type":"int64","id":1},"msg":{"type":"bytes","id":2}}},"ProtoRaws":{"fields":{"sendTs":{"type":"int64","id":1},"payloads":{"rule":"repeated","type":"Message","id":2},"vid":{"type":"int32","id":3}}},"APWorkerEvent":{"fields":{"sid":{"type":"string","id":1},"cname":{"type":"string","id":2},"cid":{"type":"int64","id":3},"lts":{"type":"int64","id":4},"ip":{"type":"string","id":5},"uid":{"type":"int64","id":6},"success":{"type":"bool","id":7},"elapse":{"type":"int64","id":8},"peer":{"type":"int64","id":9},"ec":{"type":"int32","id":10},"sc":{"type":"int32","id":11},"serverIp":{"type":"string","id":12},"firstSuccess":{"type":"bool","id":13},"responseTime":{"type":"int32","id":14},"serviceName":{"type":"string","id":15},"responseDetail":{"type":"string","id":16}}},"WorkerEvent":{"fields":{"sid":{"type":"string","id":1},"cname":{"type":"string","id":2},"cid":{"type":"int64","id":3},"lts":{"type":"int64","id":4},"ip":{"type":"string","id":5},"uid":{"type":"int64","id":6},"success":{"type":"bool","id":7},"elapse":{"type":"int64","id":8},"peer":{"type":"int64","id":9},"command":{"type":"string","id":10},"actionType":{"type":"string","id":11},"url":{"type":"string","id":12},"payload":{"type":"string","id":13},"serverCode":{"type":"int32","id":14},"code":{"type":"int32","id":15},"traceId":{"type":"string","id":16},"workerType":{"type":"int32","id":17},"responseTime":{"type":"int32","id":18},"requestId":{"type":"int64","id":19},"packIndex":{"type":"int32","id":20},"requestByUser":{"type":"bool","id":21},"tid":{"type":"string","id":22}}},"JoinWebProxyAP":{"fields":{"lts":{"type":"int64","id":1},"sid":{"type":"string","id":2},"cname":{"type":"string","id":3},"cid":{"type":"int64","id":4},"ip":{"type":"string","id":5},"uid":{"type":"int64","id":6},"sucess":{"type":"int32","id":7},"elapse":{"type":"int64","id":8},"eventType":{"type":"string","id":9},"apServerAddr":{"type":"string","id":10},"turnServerAddrList":{"type":"string","id":11},"errorCode":{"type":"string","id":12}}}}}}}')},function(e,t,n){var r=function(e){"use strict";var t=Object.prototype,n=t.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},i=r.iterator||"@@iterator",o=r.asyncIterator||"@@asyncIterator",a=r.toStringTag||"@@toStringTag";function s(e,t,n,r){var i=t&&t.prototype instanceof l?t:l,o=Object.create(i.prototype),a=new _(r||[]);return o._invoke=function(e,t,n){var r="suspendedStart";return function(i,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw o;return{value:void 0,done:!0}}for(n.method=i,n.arg=o;;){var a=n.delegate;if(a){var s=y(a,n);if(s){if(s===u)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var l=c(e,t,n);if("normal"===l.type){if(r=n.done?"completed":"suspendedYield",l.arg===u)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(r="completed",n.method="throw",n.arg=l.arg)}}}(e,n,a),o}function c(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=s;var u={};function l(){}function d(){}function h(){}var f={};f[i]=function(){return this};var p=Object.getPrototypeOf,A=p&&p(p(w([])));A&&A!==t&&n.call(A,i)&&(f=A);var g=h.prototype=l.prototype=Object.create(f);function v(e){["next","throw","return"].forEach((function(t){e[t]=function(e){return this._invoke(t,e)}}))}function m(e,t){var r;this._invoke=function(i,o){function a(){return new t((function(r,a){!function r(i,o,a,s){var u=c(e[i],e,o);if("throw"!==u.type){var l=u.arg,d=l.value;return d&&"object"==typeof d&&n.call(d,"__await")?t.resolve(d.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(d).then((function(e){l.value=e,a(l)}),(function(e){return r("throw",e,a,s)}))}s(u.arg)}(i,o,r,a)}))}return r=r?r.then(a,a):a()}}function y(e,t){var n=e.iterator[t.method];if(void 0===n){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,y(e,t),"throw"===t.method))return u;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return u}var r=c(n,e.iterator,t.arg);if("throw"===r.type)return t.method="throw",t.arg=r.arg,t.delegate=null,u;var i=r.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,u):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,u)}function b(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function E(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function _(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(b,this),this.reset(!0)}function w(e){if(e){var t=e[i];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,o=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return o.next=o}}return{next:S}}function S(){return{value:void 0,done:!0}}return d.prototype=g.constructor=h,h.constructor=d,h[a]=d.displayName="GeneratorFunction",e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===d||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,h):(e.__proto__=h,a in e||(e[a]="GeneratorFunction")),e.prototype=Object.create(g),e},e.awrap=function(e){return{__await:e}},v(m.prototype),m.prototype[o]=function(){return this},e.AsyncIterator=m,e.async=function(t,n,r,i,o){void 0===o&&(o=Promise);var a=new m(s(t,n,r,i),o);return e.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},v(g),g[a]="Generator",g[i]=function(){return this},g.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},e.values=w,_.prototype={constructor:_,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(E),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return a.type="throw",a.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],a=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var s=n.call(o,"catchLoc"),c=n.call(o,"finallyLoc");if(s&&c){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,u):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),u},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),E(n),u}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;E(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:w(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),u}},e}(e.exports);try{regeneratorRuntime=r}catch(e){Function("r","regeneratorRuntime = r")(r)}},function(e,t){e.exports=function(e){if(Array.isArray(e))return e}},function(e,t){e.exports=function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}}},function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r="object"==typeof window&&window.RTCPeerConnection,i="object"==typeof window&&window.webkitRTCPeerConnection,o="object"==typeof window&&window.mozRTCPeerConnection;t.createRTCPeerConnection=function(e){var t=r||i||o;return t?new t(e):null}},function(e,t,n){var r;
/*!
 * EventEmitter v5.2.9 - git.io/ee
 * Unlicense - http://unlicense.org/
 * Oliver Caldwell - https://oli.me.uk/
 * @preserve
 */!function(t){"use strict";function i(){}var o=i.prototype,a=t.EventEmitter;function s(e,t){for(var n=e.length;n--;)if(e[n].listener===t)return n;return-1}function c(e){return function(){return this[e].apply(this,arguments)}}o.getListeners=function(e){var t,n,r=this._getEvents();if(e instanceof RegExp)for(n in t={},r)r.hasOwnProperty(n)&&e.test(n)&&(t[n]=r[n]);else t=r[e]||(r[e]=[]);return t},o.flattenListeners=function(e){var t,n=[];for(t=0;t<e.length;t+=1)n.push(e[t].listener);return n},o.getListenersAsObject=function(e){var t,n=this.getListeners(e);return n instanceof Array&&((t={})[e]=n),t||n},o.addListener=function(e,t){if(!function e(t){return"function"==typeof t||t instanceof RegExp||!(!t||"object"!=typeof t)&&e(t.listener)}(t))throw new TypeError("listener must be a function");var n,r=this.getListenersAsObject(e),i="object"==typeof t;for(n in r)r.hasOwnProperty(n)&&-1===s(r[n],t)&&r[n].push(i?t:{listener:t,once:!1});return this},o.on=c("addListener"),o.addOnceListener=function(e,t){return this.addListener(e,{listener:t,once:!0})},o.once=c("addOnceListener"),o.defineEvent=function(e){return this.getListeners(e),this},o.defineEvents=function(e){for(var t=0;t<e.length;t+=1)this.defineEvent(e[t]);return this},o.removeListener=function(e,t){var n,r,i=this.getListenersAsObject(e);for(r in i)i.hasOwnProperty(r)&&-1!==(n=s(i[r],t))&&i[r].splice(n,1);return this},o.off=c("removeListener"),o.addListeners=function(e,t){return this.manipulateListeners(!1,e,t)},o.removeListeners=function(e,t){return this.manipulateListeners(!0,e,t)},o.manipulateListeners=function(e,t,n){var r,i,o=e?this.removeListener:this.addListener,a=e?this.removeListeners:this.addListeners;if("object"!=typeof t||t instanceof RegExp)for(r=n.length;r--;)o.call(this,t,n[r]);else for(r in t)t.hasOwnProperty(r)&&(i=t[r])&&("function"==typeof i?o.call(this,r,i):a.call(this,r,i));return this},o.removeEvent=function(e){var t,n=typeof e,r=this._getEvents();if("string"===n)delete r[e];else if(e instanceof RegExp)for(t in r)r.hasOwnProperty(t)&&e.test(t)&&delete r[t];else delete this._events;return this},o.removeAllListeners=c("removeEvent"),o.emitEvent=function(e,t){var n,r,i,o,a=this.getListenersAsObject(e);for(o in a)if(a.hasOwnProperty(o))for(n=a[o].slice(0),i=0;i<n.length;i++)!0===(r=n[i]).once&&this.removeListener(e,r.listener),r.listener.apply(this,t||[])===this._getOnceReturnValue()&&this.removeListener(e,r.listener);return this},o.trigger=c("emitEvent"),o.emit=function(e){var t=Array.prototype.slice.call(arguments,1);return this.emitEvent(e,t)},o.setOnceReturnValue=function(e){return this._onceReturnValue=e,this},o._getOnceReturnValue=function(){return!this.hasOwnProperty("_onceReturnValue")||this._onceReturnValue},o._getEvents=function(){return this._events||(this._events={})},i.noConflict=function(){return t.EventEmitter=a,i},void 0===(r=function(){return i}.call(t,n,t,e))||(e.exports=r)}("undefined"!=typeof window?window:this||{})},function(e,t,n){var r=n(32);e.exports=function(e){if(Array.isArray(e))return r(e)}},function(e,t){e.exports=function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}},function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=n(72),c=n(27),u=n(91),l=n(20),d=n(24),h=n(29),f=a(n(0)),p=a(n(34)),A=function(){function e(e){this.retryTimeout=1e4,this.streamingTasks=new Map,this.isStartingStreamingTask=!1,this.taskMutex=new u.PromiseMutex("LS"),this.cancelToken=p.default.CancelToken.source(),this.injectConfig=r({},c.DEFAULT_INJECT_CONFIG),this.injectLoopTimes=0,this.lastTaskId=1,this.statusError=new Map,this.spec=e}return Object.defineProperty(e.prototype,"isNeedReset",{get:function(){for(var e=this,t=0,n=Array.from(this.streamingTasks.values());t<n.length;t++){var r=n[t];if(r.mode===c.LiveStreamingServiceMode.INJECT)return!0;if(r.mode===c.LiveStreamingServiceMode.TRANSCODE&&(this.transcodingConfig&&(this.transcodingConfig.userConfigs||this.transcodingConfig.transcodingUsers)||[]).find((function(t){return t.uid===e.spec.uid})))return!0}return!1},enumerable:!0,configurable:!0}),e.prototype.setTranscodingConfig=function(e){return i(this,void 0,void 0,(function(){var t,n,i,a,s,u=this;return o(this,(function(o){switch(o.label){case 0:(t=r(r({},c.DEFAULT_TRANSCODING_CONFIG),e)).transcodingUsers||(t.transcodingUsers=t.userConfigs),66!==t.videoCodecProfile&&77!==t.videoCodecProfile&&100!==t.videoCodecProfile&&(f.default.debug("["+this.spec.clientId+"] set transcoding config, fix video codec profile: "+t.videoCodecProfile+" -> 100"),t.videoCodecProfile=100),t.transcodingUsers&&(t.transcodingUsers=t.transcodingUsers.map((function(e){return r(r(r({},c.DEFAULT_LIVE_STREAMING_TRANSCODING_USER),e),{zOrder:e.zOrder?e.zOrder+1:1})}))),t.images&&(t.images=t.images.map((function(e){return r(r({},c.DEFAULT_LIVE_STREAMING_TRANSCODING_WATERMARK),e)})));try{c.isLiveStreamingTranscodingConfig(t)}catch(e){throw e}return t.transcodingUsers&&(t.userConfigs=t.transcodingUsers.map((function(e){return r({},e)})),t.userCount=t.transcodingUsers.length,delete t.transcodingUsers),n=(t.userConfigs||[]).map((function(e){return"number"==typeof e.uid?Promise.resolve(e.uid):l.getUserAccount(u.spec,null,e.uid)})),[4,this.taskMutex.lock()];case 1:return i=o.sent(),[4,Promise.all(n)];case 2:if(o.sent().forEach((function(e,n){t.userConfigs&&t.userConfigs[n]&&(t.userConfigs[n].uid=e&&e.uid||e)})),this.transcodingConfig=t,!this.connection)return i(),[2];o.label=3;case 3:return o.trys.push([3,5,,6]),[4,this.connection.request("request",{clientRequest:{command:"UpdateTranscoding",transcodingConfig:this.transcodingConfig}},!1,{command:"UpdateTranscoding",workerType:1,requestByUser:!0,tid:Array.from(this.streamingTasks.values()).map((function(e){return e.taskId})).join("#")})];case 4:return a=o.sent(),i(),f.default.debug("["+this.spec.clientId+"] update live transcoding config success, code: "+a.code+", config:",JSON.stringify(this.transcodingConfig)),[3,6];case 5:if(s=o.sent(),i(),!s.data||!s.data.retry)throw s;return s.data.changeAddress&&this.connection.tryNextAddress(),this.streamingTasks.forEach((function(e){f.default.warning("["+u.spec.clientId+"] live streaming receive error",s.toString(),"try to republish",e.url),u.startLiveStreamingTask(e.url,e.mode,s).then((function(){f.default.debug("["+u.spec.clientId+"] live streaming republish "+e.url+" success")})).catch((function(t){f.default.error("["+u.spec.clientId+"] live streaming republish failed",e.url,t.toString()),u.onLiveStreamError&&u.onLiveStreamError(e.url,t)}))})),[3,6];case 6:return[2]}}))}))},e.prototype.setInjectStreamConfig=function(e,t){this.injectConfig=Object.assign({},this.injectConfig,e),this.injectLoopTimes=t},e.prototype.startLiveStreamingTask=function(e,t,n){return i(this,void 0,void 0,(function(){var i,a,s,u,l,p,A,g,v=this;return o(this,(function(o){switch(o.label){case 0:return Array.from(this.streamingTasks.values()).find((function(e){return e.mode===c.LiveStreamingServiceMode.INJECT}))&&t===c.LiveStreamingServiceMode.INJECT?[2,new d.AgoraRTCError(d.AgoraRTCErrorCode.LIVE_STREAMING_TASK_CONFLICT,"inject stream over limit").throw()]:(i={command:"PublishStream",ts:Date.now(),url:e,uid:this.spec.uid.toString(),autoDestroyTime:30},f.default.debug("["+this.spec.clientId+"] start live streaming "+e+", mode: "+t),[4,this.taskMutex.lock()]);case 1:if(a=o.sent(),!this.transcodingConfig&&t===c.LiveStreamingServiceMode.TRANSCODE)throw a(),new d.AgoraRTCError(d.AgoraRTCErrorCode.INVALID_OPERATION,"[LiveStreaming] no transcoding config found, can not start transcoding streaming task");if(!this.connection&&n)return a(),[2];if(this.streamingTasks.get(e)&&!n)return a(),[2,new d.AgoraRTCError(d.AgoraRTCErrorCode.LIVE_STREAMING_TASK_CONFLICT).throw()];if(!this.transcodingConfig&&t===c.LiveStreamingServiceMode.TRANSCODE)throw a(),new d.AgoraRTCError(d.AgoraRTCErrorCode.INVALID_OPERATION,"[LiveStreaming] no transcoding config found, can not start transcoding streaming task");o.label=2;case 2:return o.trys.push([2,5,,6]),this.connection?[3,4]:(s=this,[4,this.connect(t)]);case 3:s.connection=o.sent(),o.label=4;case 4:return[3,6];case 5:throw u=o.sent(),a(),u;case 6:switch(t){case c.LiveStreamingServiceMode.TRANSCODE:i.transcodingConfig=r({},this.transcodingConfig);break;case c.LiveStreamingServiceMode.RAW:break;case c.LiveStreamingServiceMode.INJECT:i={cname:this.spec.cname,command:"InjectStream",sid:this.spec.sid,transcodingConfig:this.injectConfig,ts:Date.now(),url:e,loopTimes:this.injectLoopTimes}}this.uapResponse&&this.uapResponse.vid&&(i.vid=this.uapResponse.vid),this.isStartingStreamingTask=!0,l=this.lastTaskId++,o.label=7;case 7:return o.trys.push([7,9,,14]),p=new Promise((function(t,r){h.wait(v.retryTimeout).then((function(){if(n)return r(n);var t=v.statusError.get(e);return t?(v.statusError.delete(e),r(t)):void 0}))})),[4,Promise.race([this.connection.request("request",{clientRequest:i},!0,{url:e,command:"PublishStream",workerType:t===c.LiveStreamingServiceMode.TRANSCODE?1:2,requestByUser:!n,tid:l.toString()}),p])];case 8:return A=o.sent(),this.isStartingStreamingTask=!1,f.default.debug("["+this.spec.clientId+"] live streaming started, code: "+A.code),this.streamingTasks.set(e,{clientRequest:i,mode:t,url:e,taskId:l}),a(),[3,14];case 9:if(g=o.sent(),a(),this.isStartingStreamingTask=!1,!g.data||!g.data.retry||n)throw g;return g.data.changeAddress?[3,11]:[4,this.startLiveStreamingTask(e,t,g)];case 10:return[2,o.sent()];case 11:return this.connection.tryNextAddress(),[4,this.startLiveStreamingTask(e,t,g)];case 12:return[2,o.sent()];case 13:return[3,14];case 14:return[2]}}))}))},e.prototype.stopLiveStreamingTask=function(e){var t=this;return new Promise((function(n,r){var i=t.streamingTasks.get(e);if(!i||!t.connection)return new d.AgoraRTCError(d.AgoraRTCErrorCode.UNEXPECTED_ERROR,"can not find streaming task to stop").throw();var o=i.mode;i.abortTask=function(){f.default.debug("["+t.spec.clientId+"] stop live streaming success(worker exception)"),t.streamingTasks.delete(e),n()},f.default.debug("stop live streaming task request: "+JSON.stringify(e)),t.connection.request("request",{clientRequest:{command:o===c.LiveStreamingServiceMode.INJECT?"UninjectStream":"UnpublishStream",url:i.url}},!1,{url:e,command:"UnPublishStream",workerType:o===c.LiveStreamingServiceMode.TRANSCODE?1:2,requestByUser:!0,tid:(t.lastTaskId++).toString()}).then((function(r){f.default.debug("["+t.spec.clientId+"] stop live streaming success, code: "+r.code),t.streamingTasks.delete(e),0===t.streamingTasks.size&&o!==c.LiveStreamingServiceMode.INJECT&&(t.connection.close(),t.connection=void 0),n()})).catch(r)}))},e.prototype.controlInjectStream=function(e,t,n,r){return i(this,void 0,void 0,(function(){var i;return o(this,(function(o){switch(o.label){case 0:if(!(i=this.streamingTasks.get(e))||!this.connection||i.mode!==c.LiveStreamingServiceMode.INJECT)throw new d.AgoraRTCError(d.AgoraRTCErrorCode.INVALID_OPERATION,"can not find inject stream task to control");return[4,this.connection.request("request",{clientRequest:{command:"ControlStream",url:e,control:t,audioVolume:n,position:r}})];case 1:return[2,o.sent().serverResponse]}}))}))},e.prototype.resetAllTask=function(){var e=this,t=Array.from(this.streamingTasks.values());this.terminate();for(var n=function(t){r.startLiveStreamingTask(t.url,t.mode).catch((function(n){e.onLiveStreamError&&e.onLiveStreamError(t.url,n)}))},r=this,i=0,o=t;i<o.length;i++)n(o[i])},e.prototype.setGatewayConnectionState=function(e){this.connection&&(this.connection.gatewayConnectionState=e)},e.prototype.terminate=function(){this.cancelToken&&this.cancelToken.cancel(),this.streamingTasks=new Map,this.isStartingStreamingTask=!1,this.statusError=new Map,this.cancelToken=p.default.CancelToken.source(),this.uapResponse=void 0,this.connection&&this.connection.close(),this.connection=void 0},e.prototype.connect=function(e){return i(this,void 0,void 0,(function(){var t,n=this;return o(this,(function(r){switch(r.label){case 0:if(this.connection)throw new d.AgoraRTCError(d.AgoraRTCErrorCode.UNEXPECTED_ERROR,"live streaming connection has already connected");return[4,h.getLiveStreamingWorkerMangerResult(e,this.spec,this.cancelToken.token)];case 1:return t=r.sent(),this.uapResponse=t,this.connection=new s.AgoraLiveStreamingUapSignal(t.workerToken,this.spec,e),this.connection.on(c.LiveStreamingUapSignalEvents.WARNING,(function(e,t){return n.onLiveStreamWarning&&n.onLiveStreamWarning(t,e)})),this.connection.on(c.LiveStreamingUapSignalEvents.PUBLISH_STREAM_STATUS,(function(e){return n.handlePublishStreamServer(e)})),this.connection.on(c.LiveStreamingUapSignalEvents.INJECT_STREAM_STATUS,(function(e){return n.handleInjectStreamServerStatus(e)})),this.connection.on(c.LiveStreamingUapSignalEvents.REQUEST_NEW_ADDRESS,(function(t,r){if(!n.connection)return r(new d.AgoraRTCError(d.AgoraRTCErrorCode.UNEXPECTED_ERROR,"can not get new live streaming address list"));h.getLiveStreamingWorkerMangerResult(e,n.spec,n.cancelToken.token).then((function(e){n.uapResponse=e,t(e.addressList)})).catch(r)})),[4,this.connection.init(t.addressList)];case 2:return r.sent(),[2,this.connection]}}))}))},e.prototype.handlePublishStreamServer=function(e){var t=this,n=e.serverStatus&&e.serverStatus.url;if(!n)throw new d.AgoraRTCError(d.AgoraRTCErrorCode.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"empty url",{code:e.code});var r=this.streamingTasks.get(n);switch(e.code){case c.LIVE_STREAM_ERROR_CODE.PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN:case c.LIVE_STREAM_ERROR_CODE.PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT:case c.LIVE_STREAM_ERROR_CODE.PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE:case c.LIVE_STREAM_ERROR_CODE.PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH:var i=new d.AgoraRTCError(d.AgoraRTCErrorCode.LIVE_STREAMING_CDN_ERROR,"",{code:e.code});if(r)return f.default.error(i.toString()),this.onLiveStreamError&&this.onLiveStreamError(n,i);if(!this.isStartingStreamingTask)return;this.statusError.set(n,i);case c.LIVE_STREAM_ERROR_CODE.LIVE_STREAM_RESPONSE_WORKER_LOST:case c.LIVE_STREAM_ERROR_CODE.LIVE_STREAM_RESPONSE_WORKER_QUIT:if(!this.connection||0===this.streamingTasks.size)return;this.connection.tryNextAddress();for(var o=Array.from(this.streamingTasks.values()),a=function(n){if(n.abortTask)return n.abortTask(),"continue";f.default.warning("["+s.spec.clientId+"] publish stream status code",e.code,"try to republish",n.url),s.startLiveStreamingTask(n.url,n.mode,new d.AgoraRTCError(d.AgoraRTCErrorCode.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"",{code:e.code})).then((function(){f.default.debug("["+t.spec.clientId+"] republish live stream success",n.url)})).catch((function(e){f.default.error(e.toString()),t.onLiveStreamError&&t.onLiveStreamError(n.url,e)}))},s=this,u=0,l=o;u<l.length;u++)a(l[u]);return}},e.prototype.handleInjectStreamServerStatus=function(e){var t=Number(e.uid),n=e.serverStatus&&e.serverStatus.url;switch(e.code){case 200:return void(this.onInjectStatusChange&&this.onInjectStatusChange(0,t,n));case 451:return this.onInjectStatusChange&&this.onInjectStatusChange(1,t,n),void this.streamingTasks.delete(n);case 453:return this.onInjectStatusChange&&this.onInjectStatusChange(2,t,n),void this.streamingTasks.delete(n);case 470:return this.onInjectStatusChange&&this.onInjectStatusChange(10,t,n),void this.streamingTasks.delete(n);case 499:return this.onInjectStatusChange&&this.onInjectStatusChange(3,t,n),void this.streamingTasks.delete(n);default:return void f.default.debug("inject stream server status",e)}},e.prototype.haveUrl=function(e){return this.streamingTasks.has(e)||void 0},e}();t.AgoraRTCLiveStreamingClient=A},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__assign||function(){return(o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},a=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},s=this&&this.__generator||function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},c=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=n(27),l=n(73),d=n(33),h=n(24),f=n(3),p=c(n(0)),A=n(1),g=n(29),v=function(e){function t(t,n,r){var i=e.call(this)||this;return i._gatewayConnectionState="CONNECTED",i.reconnectMode="retry",i.reqId=0,i.commandReqId=0,i.waitingResponseList=[],i.handleWebSocketOpen=function(){i.reconnectMode="retry",i.startPingPong()},i.handleWebSocketMessage=function(e){if(e.data){var t=JSON.parse(e.data);if(t.requestId)i.emit("@"+t.requestId,t);else if(i.serviceMode===u.LiveStreamingServiceMode.INJECT)i.emit(u.LiveStreamingUapSignalEvents.INJECT_STREAM_STATUS,t);else{A.report.requestWorkerEvent(i.spec.sid,{actionType:"status",serverCode:t.code,workerType:i.serviceMode===u.LiveStreamingServiceMode.TRANSCODE?1:2});var n=t.serverStatus&&t.serverStatus.url;n&&i.waitingResponseList.includes(n)&&200===t.code&&i.emit(n),i.emit(u.LiveStreamingUapSignalEvents.PUBLISH_STREAM_STATUS,t)}}},i.spec=n,i.token=t,i.serviceMode=r,i.websocket=new l.AgoraWebSocketManager("live-streaming"),i.websocket.on(u.WebSocketManagerEvents.CONNECTED,i.handleWebSocketOpen),i.websocket.on(u.WebSocketManagerEvents.ON_MESSAGE,i.handleWebSocketMessage),i.websocket.on(u.WebSocketManagerEvents.REQUEST_NEW_URLS,(function(e,t){d.emitAsPromise(i,u.LiveStreamingUapSignalEvents.REQUEST_NEW_ADDRESS).then(e).catch(t)})),i.websocket.on(u.WebSocketManagerEvents.RECONNECTING,(function(){i.websocket.reconnectMode=i.reconnectMode})),i}return i(t,e),Object.defineProperty(t.prototype,"gatewayConnectionState",{get:function(){return this._gatewayConnectionState},set:function(e){this._gatewayConnectionState=e,"CONNECTED"===e&&this.emit("gateway-connected",e)},enumerable:!0,configurable:!0}),t.prototype.init=function(e){return this.websocket.init(e)},t.prototype.request=function(e,t,n,r){return a(this,void 0,void 0,(function(){var i,a,c,l,d,p,v,m,y,b,E=this;return s(this,(function(s){switch(s.label){case 0:if(this.reqId+=1,i=this.reqId,"request"===e&&(this.commandReqId+=1),a=this.commandReqId,!i||!this.websocket)throw new h.AgoraRTCError(h.AgoraRTCErrorCode.UNEXPECTED_ERROR);if(c=f.VERSION,"closed"===this.websocket.state)throw new h.AgoraRTCError(h.AgoraRTCErrorCode.WS_DISCONNECT);return l=function(){return new Promise((function(e,t){var n=function(){"CONNECTED"===E.gatewayConnectionState&&"connected"===E.websocket.state&&(E.off("gateway-connected",n),E.websocket.off(u.WebSocketManagerEvents.CONNECTED,n),e(void 0))};E.on("gateway-connected",n),E.websocket.once(u.WebSocketManagerEvents.CLOSED,(function(){return t(new h.AgoraRTCError(h.AgoraRTCErrorCode.WS_ABORT))})),E.websocket.on(u.WebSocketManagerEvents.CONNECTED,n)}))},"connected"===this.websocket.state&&"CONNECTED"===this.gatewayConnectionState?[3,2]:[4,l()];case 1:s.sent(),s.label=2;case 2:d=Promise.race([new Promise((function(e,t){var n=function(){t(new h.AgoraRTCError(h.AgoraRTCErrorCode.WS_ABORT))};E.websocket.once(u.WebSocketManagerEvents.RECONNECTING,n),E.websocket.once(u.WebSocketManagerEvents.CLOSED,n),E.once("@"+i,(function(t){e(t)}))})),g.wait(f.getParameter("LIVE_STREAMING_TIMEOUT")).then((function(){return!1}))]),(p=o({command:e,sdkVersion:c,seq:i,requestId:i,allocate:n,cname:this.spec.cname,appId:this.spec.appId,sid:this.spec.sid,uid:this.spec.uid.toString(),ts:Math.floor(Date.now()/1e3)},t)).clientRequest&&(p.clientRequest.workerToken=this.token),r&&A.report.requestWorkerEvent(this.spec.sid,o(o({},r),{requestId:a,actionType:"request",payload:JSON.stringify(t.clientRequest),serverCode:0,code:0})),v=Date.now(),this.websocket.sendMessage(p),m=null,s.label=3;case 3:return s.trys.push([3,5,,8]),[4,d];case 4:return m=s.sent(),[3,8];case 5:if(y=s.sent(),"closed"===this.websocket.state)throw y;return[4,l()];case 6:return s.sent(),[4,this.request(e,t,n,r)];case 7:return[2,s.sent()];case 8:if(!1===m)throw b=new h.AgoraRTCError(h.AgoraRTCErrorCode.NETWORK_TIMEOUT,(t&&t.clientRequest&&t.clientRequest.command)+" timeout",{changeAddress:!0,retry:!0}),this.emit(u.LiveStreamingUapSignalEvents.WARNING,b,r&&r.url||"unknown url"),r&&A.report.requestWorkerEvent(this.spec.sid,o(o({},r),{requestId:a,actionType:"response",payload:"TIMEOUT",serverCode:0,success:0,responseTime:Date.now()-v})),b;return r&&A.report.requestWorkerEvent(this.spec.sid,o(o({},r),{requestId:a,actionType:"response",payload:JSON.stringify(m.serverResponse),serverCode:m.code,success:200===m.code,responseTime:Date.now()-v})),200===m.code?[3,10]:[4,this.handleResponseError(m)];case 9:s.sent(),s.label=10;case 10:return[2,m]}}))}))},t.prototype.tryNextAddress=function(){this.reconnectMode="tryNext",this.websocket.reconnect("tryNext")},t.prototype.close=function(){var e="__VERSION__"===f.VERSION?"0.0.1":f.VERSION;this.reqId+=1,"connected"===this.websocket.state?(this.websocket.sendMessage({command:"request",appId:this.spec.appId,cname:this.spec.cname,uid:this.spec.uid.toString(),sdkVersion:e,sid:this.spec.sid,seq:this.reqId,ts:Math.floor(Date.now()/1e3),requestId:this.reqId,clientRequest:{command:"DestroyWorker"}}),this.websocket.close(!1,!0)):this.websocket.close(!1),this.pingpongTimer&&(window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0)},t.prototype.handleResponseError=function(e){return a(this,void 0,void 0,(function(){var t,n,r,i,o=this;return s(this,(function(a){switch(p.default.debug("[live-streaming] receive response error "+e.code),e.code){case u.LIVE_STREAM_ERROR_CODE.LIVE_STREAM_RESPONSE_ALREADY_EXISTS_STREAM:return p.default.warning("live stream response already exists stream"),t=e.serverResponse.url,this.emit(u.LiveStreamingUapSignalEvents.WARNING,"live stream response already exists stream, code 454",t),this.waitingResponseList.includes(t)||this.waitingResponseList.push(t),[2,new Promise((function(n,r){o.once(t,(function(){o.waitingResponseList.splice(o.waitingResponseList.indexOf(t),1),n()})),setTimeout((function(){o.waitingResponseList.splice(o.waitingResponseList.indexOf(t),1),r(new h.AgoraRTCError(h.AgoraRTCErrorCode.TIMEOUT,"live stream timeout waiting 454",{code:e.code}))}),1e4)}))];case u.LIVE_STREAM_ERROR_CODE.LIVE_STREAM_RESPONSE_TRANSCODING_PARAMETER_ERROR:case u.LIVE_STREAM_ERROR_CODE.LIVE_STREAM_RESPONSE_BAD_STREAM:case u.LIVE_STREAM_ERROR_CODE.LIVE_STREAM_RESPONSE_WM_PARAMETER_ERROR:return[2,new h.AgoraRTCError(h.AgoraRTCErrorCode.LIVE_STREAMING_INVALID_ARGUMENT,"",{code:e.code}).throw()];case u.LIVE_STREAM_ERROR_CODE.LIVE_STREAM_RESPONSE_INGNORE_MESSAGE:throw new h.AgoraRTCError(h.AgoraRTCErrorCode.LIVE_STREAMING_INVALID_ARGUMENT,"",{retry:!0,changeAddress:!0});case u.LIVE_STREAM_ERROR_CODE.LIVE_STREAM_RESPONSE_WM_WORKER_NOT_EXIST:if("UnpublishStream"===e.serverResponse.command||"UninjectStream"===e.serverResponse.command)return[2];throw new h.AgoraRTCError(h.AgoraRTCErrorCode.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"live stream response wm worker not exist",{retry:!0});case u.LIVE_STREAM_ERROR_CODE.LIVE_STREAM_RESPONSE_NOT_AUTHORIZED:return[2,new h.AgoraRTCError(h.AgoraRTCErrorCode.LIVE_STREAMING_PUBLISH_STREAM_NOT_AUTHORIZED,"",{code:e.code}).throw()];case u.LIVE_STREAM_ERROR_CODE.LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE:return n=new h.AgoraRTCError(h.AgoraRTCErrorCode.LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE),[2,this.emit(u.LiveStreamingUapSignalEvents.WARNING,n,e.serverResponse.url)];case u.LIVE_STREAM_ERROR_CODE.LIVE_STREAM_RESPONSE_REQUEST_TOO_OFTEN:return n=new h.AgoraRTCError(h.AgoraRTCErrorCode.LIVE_STREAMING_WARN_FREQUENT_REQUEST),[2,this.emit(u.LiveStreamingUapSignalEvents.WARNING,n,e.serverResponse.url)];case u.LIVE_STREAM_ERROR_CODE.LIVE_STREAM_RESPONSE_NOT_FOUND_PUBLISH:throw new h.AgoraRTCError(h.AgoraRTCErrorCode.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"live stream response wm worker not exist",{retry:!0});case u.LIVE_STREAM_ERROR_CODE.LIVE_STREAM_RESPONSE_NOT_SUPPORTED:return[2,new h.AgoraRTCError(h.AgoraRTCErrorCode.LIVE_STREAMING_TRANSCODING_NOT_SUPPORT,"",{code:e.code}).throw()];case u.LIVE_STREAM_ERROR_CODE.LIVE_STREAM_RESPONSE_MAX_STREAM_NUM:return n=new h.AgoraRTCError(h.AgoraRTCErrorCode.LIVE_STREAMING_WARN_STREAM_NUM_REACH_LIMIT),[2,this.emit(u.LiveStreamingUapSignalEvents.WARNING,n,e.serverResponse.url)];case u.LIVE_STREAM_ERROR_CODE.LIVE_STREAM_RESPONSE_INTERNAL_SERVER_ERROR:return[2,new h.AgoraRTCError(h.AgoraRTCErrorCode.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"",{code:e.code}).throw()];case u.LIVE_STREAM_ERROR_CODE.LIVE_STREAM_RESPONSE_RESOURCE_LIMIT:throw new h.AgoraRTCError(h.AgoraRTCErrorCode.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"live stream resource limit",{retry:!0,changeAddress:!0});case u.LIVE_STREAM_ERROR_CODE.LIVE_STREAM_RESPONSE_WORKER_LOST:case u.LIVE_STREAM_ERROR_CODE.LIVE_STREAM_RESPONSE_WORKER_QUIT:if("UnpublishStream"===e.serverResponse.command||"UninjectStream"===e.serverResponse.command)return[2];throw new h.AgoraRTCError(h.AgoraRTCErrorCode.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"error fail send message",{retry:!0,changeAddress:!0});case u.LIVE_STREAM_ERROR_CODE.ERROR_FAIL_SEND_MESSAGE:if("UnpublishStream"===e.serverResponse.command||"UninjectStream"===e.serverResponse.command)return[2];if("UpdateTranscoding"===e.serverResponse.command||"ControlStream"===e.serverResponse.command)return[2,new h.AgoraRTCError(h.AgoraRTCErrorCode.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"error fail send message",{code:e.code}).throw()];throw new h.AgoraRTCError(h.AgoraRTCErrorCode.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"error fail send message",{retry:!0,changeAddress:!0});case u.LIVE_STREAM_ERROR_CODE.PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN:case u.LIVE_STREAM_ERROR_CODE.PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT:case u.LIVE_STREAM_ERROR_CODE.PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE:case u.LIVE_STREAM_ERROR_CODE.PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH:return r=e.serverResponse.url,this.waitingResponseList.includes(r)||this.waitingResponseList.push(r),i=new h.AgoraRTCError(h.AgoraRTCErrorCode.LIVE_STREAMING_CDN_ERROR,"",{code:e.code}),this.emit(u.LiveStreamingUapSignalEvents.WARNING,i,r),[2,new Promise((function(e,t){o.once(r,(function(){o.waitingResponseList.splice(o.waitingResponseList.indexOf(r),1),e()})),setTimeout((function(){o.waitingResponseList.splice(o.waitingResponseList.indexOf(r),1),t(i)}),1e4)}))]}return[2]}))}))},t.prototype.startPingPong=function(){var e=this;this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval((function(){"connected"===e.websocket.state&&e.request("ping",{}).catch((function(){}))}),6e3)},t}(d.EventEmitter);t.AgoraLiveStreamingUapSignal=v},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},a=this&&this.__generator||function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var c=n(24),u=n(33),l=n(29),d=n(27),h=s(n(0)),f=function(e){function t(t){var n=e.call(this)||this;return n.connectionID=0,n.currentURLIndex=0,n.reconnectMode="tryNext",n._state="closed",n.retryConfig=l.DEFAULT_RETRY_CONFIG,n.reconnectCount=0,n.name=t,n}return i(t,e),Object.defineProperty(t.prototype,"url",{get:function(){return this.websocket?this.websocket.url:null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"state",{get:function(){return this._state},set:function(e){e!==this._state&&(this._state=e,"reconnecting"===this._state?this.emit(d.WebSocketManagerEvents.RECONNECTING,this.reconnectMode):"connected"===this._state?this.emit(d.WebSocketManagerEvents.CONNECTED):"closed"===this._state?this.emit(d.WebSocketManagerEvents.CLOSED):"failed"===this._state&&this.emit(d.WebSocketManagerEvents.FAILED))},enumerable:!0,configurable:!0}),t.prototype.init=function(e){var t=this;return new Promise((function(n,r){t.urls=e;var i=t.urls[t.currentURLIndex];t.state="connecting",t.createWebSocketConnection(i).then(n).catch(r),t.once(d.WebSocketManagerEvents.CLOSED,(function(){return r(new c.AgoraRTCError(c.AgoraRTCErrorCode.WS_DISCONNECT))})),t.once(d.WebSocketManagerEvents.CONNECTED,(function(){return n()}))}))},t.prototype.close=function(e,t){if(this.currentURLIndex=0,this.reconnectCount=0,this.websocket){this.websocket.onclose=null,this.websocket.onopen=null,this.websocket.onmessage=null;var n=this.websocket;t?setTimeout((function(){return n.close()}),500):n.close(),this.websocket=void 0}this.state=e?"failed":"closed"},t.prototype.reconnect=function(e){if(this.websocket){void 0!==e&&(this.reconnectMode=e);var t=this.websocket.onclose;this.websocket.onclose=null,this.websocket.close(),t&&t.bind(this.websocket)({code:9999})}else h.default.warning("["+this.name+"] can not reconnect, no websocket")},t.prototype.sendMessage=function(e){if(!this.websocket||this.websocket.readyState!==WebSocket.OPEN)throw new c.AgoraRTCError(c.AgoraRTCErrorCode.WS_ABORT,"websocket is not ready");var t=JSON.stringify(e);try{this.websocket.send(t)}catch(e){throw new c.AgoraRTCError(c.AgoraRTCErrorCode.WS_ERR,"send websocket message error"+e.toString())}},t.prototype.createWebSocketConnection=function(e){return o(this,void 0,void 0,(function(){var t,n=this;return a(this,(function(r){return this.connectionID+=1,t=this.connectionID,[2,new Promise((function(r,i){n.websocket&&(n.websocket.onclose=null,n.websocket.close()),h.default.debug("["+n.name+"] start connect, url: "+e);try{n.websocket=new WebSocket(e),n.websocket.binaryType="arraybuffer"}catch(e){var s=new c.AgoraRTCError(c.AgoraRTCErrorCode.WS_ERR,"init websocket failed! Error: "+e.toString());return h.default.error("["+n.name+"]"+s),void i(s)}l.wait(5e3).then((function(){t===n.connectionID&&n.websocket&&n.websocket.readyState!==WebSocket.OPEN&&n.websocket&&n.websocket.close()})),n.websocket.onopen=function(){h.default.debug("["+n.name+"] websockect opened:",e),n.reconnectMode="retry",n.state="connected",n.reconnectCount=0,r()},n.websocket.onclose=function(e){return o(n,void 0,void 0,(function(){var t,n;return a(this,(function(o){switch(o.label){case 0:return h.default.debug("["+this.name+"] websocket close "+(this.websocket&&this.websocket.url)+", code: "+e.code+", reason: "+e.reason+", current mode: "+this.reconnectMode),this.reconnectCount<this.retryConfig.maxRetryCount?("connected"===this.state&&(this.state="reconnecting"),t=u.emitAsInvokerNoResponse(this,d.WebSocketManagerEvents.WILL_RECONNECT,this.reconnectMode)||this.reconnectMode,[4,this.reconnectWithAction(t)]):[3,2];case 1:return n=o.sent(),"closed"===this.state?(h.default.debug("["+this.connectionID+"] ws is closed, no need to reconnect"),[2]):n?(r(),[3,3]):(i(new c.AgoraRTCError(c.AgoraRTCErrorCode.WS_DISCONNECT,"websocket reconnect failed: "+e.code)),this.close(!0),[2]);case 2:i(new c.AgoraRTCError(c.AgoraRTCErrorCode.WS_DISCONNECT,"websocket close: "+e.code)),this.close(),o.label=3;case 3:return[2]}}))}))},n.websocket.onmessage=function(e){n.emit(d.WebSocketManagerEvents.ON_MESSAGE,e)}}))]}))}))},t.prototype.reconnectWithAction=function(e,t){return o(this,void 0,void 0,(function(){var n,r,i,o;return a(this,(function(a){switch(a.label){case 0:return!t&&this.reconnectCount>=this.retryConfig.maxRetryCount?[2,!1]:this.urls?"closed"===this.state?[2,!1]:(n=l.getRetryWaitTime(this.reconnectCount,this.retryConfig),h.default.debug("["+this.name+"] wait "+n+"ms to reconnect websocket, mode: "+e),[4,l.wait(n)]):[2,!1];case 1:if(a.sent(),"closed"===this.state)return[2,!1];this.reconnectCount+=1,a.label=2;case 2:return a.trys.push([2,12,,14]),"retry"!==e?[3,4]:(i=this.urls[this.currentURLIndex],[4,this.createWebSocketConnection(i)]);case 3:return a.sent(),[3,11];case 4:return"tryNext"!==e?[3,8]:(this.currentURLIndex+=1,this.currentURLIndex>=this.urls.length?[4,this.reconnectWithAction("recover")]:[3,6]);case 5:return[2,a.sent()];case 6:return h.default.debug("["+this.name+"] websocket url length: "+this.urls.length+" current index: "+this.currentURLIndex),i=this.urls[this.currentURLIndex],[4,this.createWebSocketConnection(i)];case 7:return a.sent(),[3,11];case 8:return"recover"!==e?[3,11]:(h.default.debug("["+this.name+"] request new urls"),r=this,[4,u.emitAsPromise(this,d.WebSocketManagerEvents.REQUEST_NEW_URLS)]);case 9:return r.urls=a.sent(),this.currentURLIndex=0,i=this.urls[this.currentURLIndex],[4,this.createWebSocketConnection(i)];case 10:a.sent(),a.label=11;case 11:return[2,!0];case 12:return o=a.sent(),h.default.error("["+this.name+"] reconnect failed",o.toString()),[4,this.reconnectWithAction(e)];case 13:return[2,a.sent()];case 14:return[2]}}))}))},t}(u.EventEmitter);t.AgoraWebSocketManager=f},function(e,t,n){"use strict";var r=n(18),i=n(35),o=n(75),a=n(41);function s(e){var t=new o(e),n=i(o.prototype.request,t);return r.extend(n,o.prototype,t),r.extend(n,t),n}var c=s(n(38));c.Axios=o,c.create=function(e){return s(a(c.defaults,e))},c.Cancel=n(42),c.CancelToken=n(89),c.isCancel=n(37),c.all=function(e){return Promise.all(e)},c.spread=n(90),e.exports=c,e.exports.default=c},function(e,t,n){"use strict";var r=n(18),i=n(36),o=n(76),a=n(77),s=n(41);function c(e){this.defaults=e,this.interceptors={request:new o,response:new o}}c.prototype.request=function(e){"string"==typeof e?(e=arguments[1]||{}).url=arguments[0]:e=e||{},(e=s(this.defaults,e)).method?e.method=e.method.toLowerCase():this.defaults.method?e.method=this.defaults.method.toLowerCase():e.method="get";var t=[a,void 0],n=Promise.resolve(e);for(this.interceptors.request.forEach((function(e){t.unshift(e.fulfilled,e.rejected)})),this.interceptors.response.forEach((function(e){t.push(e.fulfilled,e.rejected)}));t.length;)n=n.then(t.shift(),t.shift());return n},c.prototype.getUri=function(e){return e=s(this.defaults,e),i(e.url,e.params,e.paramsSerializer).replace(/^\?/,"")},r.forEach(["delete","get","head","options"],(function(e){c.prototype[e]=function(t,n){return this.request(r.merge(n||{},{method:e,url:t}))}})),r.forEach(["post","put","patch"],(function(e){c.prototype[e]=function(t,n,i){return this.request(r.merge(i||{},{method:e,url:t,data:n}))}})),e.exports=c},function(e,t,n){"use strict";var r=n(18);function i(){this.handlers=[]}i.prototype.use=function(e,t){return this.handlers.push({fulfilled:e,rejected:t}),this.handlers.length-1},i.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},i.prototype.forEach=function(e){r.forEach(this.handlers,(function(t){null!==t&&e(t)}))},e.exports=i},function(e,t,n){"use strict";var r=n(18),i=n(78),o=n(37),a=n(38);function s(e){e.cancelToken&&e.cancelToken.throwIfRequested()}e.exports=function(e){return s(e),e.headers=e.headers||{},e.data=i(e.data,e.headers,e.transformRequest),e.headers=r.merge(e.headers.common||{},e.headers[e.method]||{},e.headers),r.forEach(["delete","get","head","post","put","patch","common"],(function(t){delete e.headers[t]})),(e.adapter||a.adapter)(e).then((function(t){return s(e),t.data=i(t.data,t.headers,e.transformResponse),t}),(function(t){return o(t)||(s(e),t&&t.response&&(t.response.data=i(t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)}))}},function(e,t,n){"use strict";var r=n(18);e.exports=function(e,t,n){return r.forEach(n,(function(n){e=n(e,t)})),e}},function(e,t){var n,r,i=e.exports={};function o(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(e){if(n===setTimeout)return setTimeout(e,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(e){n=o}try{r="function"==typeof clearTimeout?clearTimeout:a}catch(e){r=a}}();var c,u=[],l=!1,d=-1;function h(){l&&c&&(l=!1,c.length?u=c.concat(u):d=-1,u.length&&f())}function f(){if(!l){var e=s(h);l=!0;for(var t=u.length;t;){for(c=u,u=[];++d<t;)c&&c[d].run();d=-1,t=u.length}c=null,l=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===a||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function A(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];u.push(new p(e,t)),1!==u.length||l||s(f)},p.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=A,i.addListener=A,i.once=A,i.off=A,i.removeListener=A,i.removeAllListeners=A,i.emit=A,i.prependListener=A,i.prependOnceListener=A,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(e,t,n){"use strict";var r=n(18);e.exports=function(e,t){r.forEach(e,(function(n,r){r!==t&&r.toUpperCase()===t.toUpperCase()&&(e[t]=n,delete e[r])}))}},function(e,t,n){"use strict";var r=n(40);e.exports=function(e,t,n){var i=n.config.validateStatus;!i||i(n.status)?e(n):t(r("Request failed with status code "+n.status,n.config,null,n.request,n))}},function(e,t,n){"use strict";e.exports=function(e,t,n,r,i){return e.config=t,n&&(e.code=n),e.request=r,e.response=i,e.isAxiosError=!0,e.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code}},e}},function(e,t,n){"use strict";var r=n(84),i=n(85);e.exports=function(e,t){return e&&!r(t)?i(e,t):t}},function(e,t,n){"use strict";e.exports=function(e){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(e)}},function(e,t,n){"use strict";e.exports=function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}},function(e,t,n){"use strict";var r=n(18),i=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];e.exports=function(e){var t,n,o,a={};return e?(r.forEach(e.split("\n"),(function(e){if(o=e.indexOf(":"),t=r.trim(e.substr(0,o)).toLowerCase(),n=r.trim(e.substr(o+1)),t){if(a[t]&&i.indexOf(t)>=0)return;a[t]="set-cookie"===t?(a[t]?a[t]:[]).concat([n]):a[t]?a[t]+", "+n:n}})),a):a}},function(e,t,n){"use strict";var r=n(18);e.exports=r.isStandardBrowserEnv()?function(){var e,t=/(msie|trident)/i.test(navigator.userAgent),n=document.createElement("a");function i(e){var r=e;return t&&(n.setAttribute("href",r),r=n.href),n.setAttribute("href",r),{href:n.href,protocol:n.protocol?n.protocol.replace(/:$/,""):"",host:n.host,search:n.search?n.search.replace(/^\?/,""):"",hash:n.hash?n.hash.replace(/^#/,""):"",hostname:n.hostname,port:n.port,pathname:"/"===n.pathname.charAt(0)?n.pathname:"/"+n.pathname}}return e=i(window.location.href),function(t){var n=r.isString(t)?i(t):t;return n.protocol===e.protocol&&n.host===e.host}}():function(){return!0}},function(e,t,n){"use strict";var r=n(18);e.exports=r.isStandardBrowserEnv()?{write:function(e,t,n,i,o,a){var s=[];s.push(e+"="+encodeURIComponent(t)),r.isNumber(n)&&s.push("expires="+new Date(n).toGMTString()),r.isString(i)&&s.push("path="+i),r.isString(o)&&s.push("domain="+o),!0===a&&s.push("secure"),document.cookie=s.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},function(e,t,n){"use strict";var r=n(42);function i(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new Promise((function(e){t=e}));var n=this;e((function(e){n.reason||(n.reason=new r(e),t(n.reason))}))}i.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},i.source=function(){var e;return{token:new i((function(t){e=t})),cancel:e}},e.exports=i},function(e,t,n){"use strict";e.exports=function(e){return function(t){return e.apply(null,t)}}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(0)),o=1,a=function(){function e(e){this.lockingPromise=Promise.resolve(),this.locks=0,this.name="",this.lockId=o++,e&&(this.name=e),i.default.debug("[lock-"+this.name+"-"+this.lockId+"] is created.")}return Object.defineProperty(e.prototype,"isLocked",{get:function(){return this.locks>0},enumerable:!0,configurable:!0}),e.prototype.lock=function(){var e,t=this;this.locks+=1,i.default.debug("[lock-"+this.name+"-"+this.lockId+"] is locked, current queue "+this.locks+".");var n=new Promise((function(n){e=function(){t.locks-=1,i.default.debug("[lock-"+t.name+"-"+t.lockId+"] is not locked, current queue "+t.locks+"."),n()}})),r=this.lockingPromise.then((function(){return e}));return this.lockingPromise=this.lockingPromise.then((function(){return n})),r},e}();t.PromiseMutex=a},function(e,t,n){"use strict";n.r(t);var r=n(3),i=n(0),o=n(1),a=n(8),s=n(4),c=function(){};c.prototype.set=function(e,t){["BatteryLevel"].indexOf(e)>-1&&(this[e]=t)};var u=new function(){var e=Object(a.b)();return e.states={UNINIT:"UNINIT",INITING:"INITING",INITED:"INITED"},e.state=e.states.UNINIT,e.batteryManager=null,e._init=function(t,n){e.state=e.states.INITING,navigator.getBattery?navigator.getBattery().then((function(n){e.batteryManager=n,t&&setTimeout((function(){t()}),0)})).catch((function(e){i.default.debug("navigator.getBattery is disabled",e),t&&t()})):(e.state=e.states.INITED,t&&t())},e._getBatteryStats=function(){var t={};return e.batteryManager&&e.batteryManager.level?t.BatteryLevel=Math.floor(100*e.batteryManager.level):t.BatteryLevel="UNSUPPORTED",t},e.getStats=function(t,n){var r=new c,i=e._getBatteryStats();i&&i.BatteryLevel&&r.set("BatteryLevel",i.BatteryLevel),t&&t(r)},e._init(),e},l=n(22),d=n(19),h=n(26),f=n(50),p=n(9),A=["live","rtc","web","interop","h264_interop","web-only"],g=["vp8","vp9","h264"],v=["aes-128-gcm","aes-256-gcm","aes-128-xts","aes-256-xts","aes-128-ecb","sm4-128-ecb"],m=n(11),y=n.n(m),b=n(7),E=n.n(b),_=n(12),w=n(5),S=n(10),T=n(20),R=n(6),C=n(14),I={1001:"FRAMERATE_INPUT_TOO_LOW",1002:"FRAMERATE_SENT_TOO_LOW",1003:"SEND_VIDEO_BITRATE_TOO_LOW",1005:"RECV_VIDEO_DECODE_FAILED",2001:"AUDIO_INPUT_LEVEL_TOO_LOW",2002:"AUDIO_OUTPUT_LEVEL_TOO_LOW",2003:"SEND_AUDIO_BITRATE_TOO_LOW",2005:"RECV_AUDIO_DECODE_FAILED",3001:"FRAMERATE_INPUT_TOO_LOW_RECOVER",3002:"FRAMERATE_SENT_TOO_LOW_RECOVER",3003:"SEND_VIDEO_BITRATE_TOO_LOW_RECOVER",3005:"RECV_VIDEO_DECODE_FAILED_RECOVER",4001:"AUDIO_INPUT_LEVEL_TOO_LOW_RECOVER",4002:"AUDIO_OUTPUT_LEVEL_TOO_LOW_RECOVER",4003:"SEND_AUDIO_BITRATE_TOO_LOW_RECOVER",4005:"RECV_AUDIO_DECODE_FAILED_RECOVER"},x={FramerateInput:1001,FramerateSent:1002,SendVideoBitrate:1003,VideoDecode:1005,AudioIntputLevel:2001,AudioOutputLevel:2002,SendAudioBitrate:2003,AudioDecode:2005},O=function(e){var t={remoteStreamStorage:{},localStreamStorage:{}};return t.gatewayClient=e,t.checkAudioOutputLevel=function(e){return!(e&&parseInt(e.audioRecvBytesDelta)>0&&parseInt(e.audioDecodingNormalDelta)>0&&0===parseInt(e.audioOutputLevel))},t.checkAudioIntputLevel=function(e){return!e||0!==parseInt(e.audioInputLevel)},t.checkFramerateInput=function(e,t){if(!e||!t.attributes)return!0;var n=parseInt(t.attributes.maxFrameRate),r=parseInt(e.googFrameRateInput);return!n||!r||!(n>10&&r<5||n<10&&n>=5&&r<=1)},t.checkFramerateSent=function(e){return!(e&&parseInt(e.googFrameRateInput)>5&&parseInt(e.googFrameRateSent)<=1)},t.checkSendVideoBitrate=function(e){return!e||0!==parseInt(e.videoSendBytesDelta)},t.checkSendAudioBitrate=function(e){return!e||0!==parseInt(e.audioSendBytesDelta)},t.checkVideoDecode=function(e){return!e||0===parseInt(e.videoRecvBytesDelta)||0!==parseInt(e.googFrameRateDecoded)},t.checkAudioDecode=function(e){return!e||0===parseInt(e.audioRecvBytesDelta)||0!==parseInt(e.audioDecodingNormalDelta)},t.record=function(e,n,r,i,o){r[e]||(r[e]={isPrevNormal:!0,record:[]});var a=r[e],s=t["check"+e](n,o);if(a.record.push(s),a.record.length>=5){a.isCurNormal=-1!==a.record.indexOf(!0);var c=x[e];a.isPrevNormal&&!a.isCurNormal&&t.gatewayClient.dispatchEvent({type:"exception",code:c,msg:I[c],uid:i}),!a.isPrevNormal&&a.isCurNormal&&t.gatewayClient.dispatchEvent({type:"exception",code:c+2e3,msg:I[c+2e3],uid:i}),a.isPrevNormal=a.isCurNormal,a.record=[]}},t.setLocalStats=function(e){var n={};Object.keys(e).map((function(r){var i=e[r],o=t.gatewayClient.localStreams[parseInt(r)],a=t.localStreamStorage[r]||{};o&&o.hasVideo()&&(t.record("SendVideoBitrate",i.videoStats,a,r),t.record("FramerateInput",i.videoStats,a,r,o),t.record("FramerateSent",i.videoStats,a,r)),o&&o.hasAudio()&&(t.record("AudioIntputLevel",i.audioStats,a,r),t.record("SendAudioBitrate",i.audioStats,a,r)),n[r]=a})),t.localStreamStorage=n},t.setRemoteStats=function(n){var r={};Object.keys(n).map((function(i){var o=n[i],a=e.remoteStreams[i],s=t.remoteStreamStorage[i]||{};a&&a.hasVideo()&&a.isPlaying()&&t.record("VideoDecode",o.videoStats,s,i),a&&a.hasAudio()&&a.isPlaying()&&(t.record("AudioOutputLevel",o.audioStats,s,i),t.record("AudioDecode",o.audioStats,s,i)),r[i]=s})),t.remoteStreamStorage=r},t};function N(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var B=n(2),M=new function(){var e=Object(a.b)();return e.states={UNINIT:"UNINIT",INITING:"INITING",INITED:"INITED"},e.state=e.states.UNINIT,e.type=null,e.lastConnectedAt=null,e.lastDisconnectedAt=null,e.lastTypeChangedAt=null,e.networkChangeTimer=null,e._init=function(t,n){if(e.state=e.states.INITING,navigator.connection&&navigator.connection.addEventListener){var r=e._getNetworkInfo();e.type=r&&r.type,e.state=e.states.INITED,t&&t()}else e.state=e.states.UNINIT,n&&n("DO_NOT_SUPPORT")},e._getNetworkInfo=function(){return navigator.connection},e._reloadNetworkInfo=function(){var t=e._getNetworkInfo(),n=t&&t.type||"UNSUPPORTED",r=Date.now();if(n!==e.type){e.lastTypeChangedAt=r,"none"==n?e.lastDisconnectedAt=r:"none"==e.type&&(e.lastConnectedAt=r),e.type=n;var i={type:"networkTypeChanged",networkType:n};e.dispatchEvent(i)}},e.getStats=function(t,n){var r={},i=e._getNetworkInfo();i&&(r.NetworkType=i.type||"UNSUPPORTED"),setTimeout((function(){t(r)}),0)},e._init((function(){navigator.connection.addEventListener("change",(function(){e._reloadNetworkInfo()})),e.networkChangeTimer=setInterval((function(){e._reloadNetworkInfo()}),5e3)}),(function(e){})),e},L=n(52),k=n(16),U=n(53),D=n.n(U),P=n(21),F="host",H=function(e){var t={key:void 0,highStream:null,lowStream:null,lowStreamParameter:null,isDualStream:!1,highStreamState:2,lowStreamState:2,proxyServer:null,turnServers:[],useProxyServer:!1,useLocalAccessPoint:!1};if(t.mode=e.mode,t.codec=e.codec,t.clientId=Object(S.generateSessionId)().slice(0,5),t.uintUid=null,t.customReportCount=0,e=E()({},e),t.aespassword=null,t.aesmode="none",t.hasPublished=!1,t.getSessionId=function(){return e.sessionId},t.startChannelMediaRelay=function(n,r){var i=o.report.reportApiInvoke(e.sessionId,{callback:function(e){if(e)return r&&r(e);r&&r()},name:"Client.startChannelMediaRelay",options:arguments,tag:"tracer"});if(!(n instanceof p.ChannelMediaRelayConfiguration))throw"Configration should be instance of [ChannelMediaRelayConfiguration]";var a=n.getSrcChannelMediaInfo(),s=n.getDestChannelMediaInfos();if(Object(B.isEmpty)(a))throw"srcChannelMediaInfo should not be empty";if(Object(B.isEmpty)(s)||0===s.length)throw"destChannelMediaInfos should not be empty";if(!Object(S.is32Uint)(a.uid))throw"Invalid uid in srcChannelMediaInfo";if(!Object(B.isValidChannelName)(a.channelName))throw"Invalid channelName in srcChannelMediaInfo";if(a.token&&!Object(B.isValidToken)(a.token))throw"Invalid token in srcChannelMediaInfo";if(s.forEach((function(e){if(!Object(S.is32Uint)(e.uid))throw"Invalid uid in destChannelMediaInfo";if(!Object(B.isValidChannelName)(e.channelName))throw"Invalid channelName in destChannelMediaInfo";if(e.token&&!Object(B.isValidToken)(e.token))throw"Invalid token in destChannelMediaInfo"})),t.gatewayClient.state!==_.a.CONNECTED)throw"startChannelMediaRelay should be used after join";t.gatewayClient.startChannelMediaRelay(n).then((function(){i&&i()})).catch((function(e){i&&i(e)}))},t.updateChannelMediaRelay=function(n,r){var i=o.report.reportApiInvoke(e.sessionId,{callback:function(e){if(e)return r&&r(e);r&&r()},name:"Client.updateChannelMediaRelay",options:arguments,tag:"tracer"});if(!(n instanceof p.ChannelMediaRelayConfiguration))throw"Configration should be instance of [ChannelMediaRelayConfiguration]";var a=n.getSrcChannelMediaInfo(),s=n.getDestChannelMediaInfos();if(Object(B.isEmpty)(a))throw"srcChannelMediaInfo should not be empty";if(Object(B.isEmpty)(s)||0===s.length)throw"destChannelMediaInfos should not be empty";if(!Object(S.is32Uint)(a.uid))throw"Invalid uid in srcChannelMediaInfo";if(!Object(B.isValidChannelName)(a.channelName))throw"Invalid channelName in srcChannelMediaInfo";if(a.token&&!Object(B.isValidToken)(a.token))throw"Invalid token in srcChannelMediaInfo";if(s.forEach((function(e){if(!Object(S.is32Uint)(e.uid))throw"Invalid uid in destChannelMediaInfo";if(!Object(B.isValidChannelName)(e.channelName))throw"Invalid channelName in destChannelMediaInfo";if(e.token&&!Object(B.isValidToken)(e.token))throw"Invalid token in destChannelMediaInfo"})),t.gatewayClient.state!==_.a.CONNECTED)throw"updateChannelMediaRelay should be used after join";t.gatewayClient.updateChannelMediaRelay(n).then((function(){i&&i()})).catch((function(e){i&&i(e)}))},t.stopChannelMediaRelay=function(n){var r=o.report.reportApiInvoke(e.sessionId,{callback:function(e){if(e)return n&&n(e);n&&n()},name:"Client.stopChannelMediaRelay",options:arguments,tag:"tracer"});t.gatewayClient.stopChannelMediaRelay().then((function(){r&&r()})).catch((function(e){r&&r(e)}))},t.getConnectionState=function(){var n=o.report.reportApiInvoke(e.sessionId,{name:"Client.getConnectionState",options:arguments,tag:"tracer"}),r=_.a.connetionStateMap[t.gatewayClient.state];return n(),r},t.setClientRole=function(n,r){var a=o.report.reportApiInvoke(e.sessionId,{callback:r,name:"Client.setClientRole",options:arguments,tag:"tracer"});if(Object(B.checkValidEnum)(n,"setClientRole",[F,"audience"]),"rtc"===t.mode){var s="RTC mode can not use setClientRole";return i.default.warning("[".concat(t.clientId,"] ").concat(s)),a&&a(s)}t.gatewayClient&&t.gatewayClient.state===_.a.CONNECTED?("audience"===n&&(0===this.highStreamState?this._unpublish(this.highStream,(function(){a&&a(null,{role:n})}),(function(e){a&&a(e)})):t.gatewayClient.setClientRole("audience",a)),n===F&&t.gatewayClient.setClientRole(F,a)):(t.gatewayClient.role=n,a&&a(null,{role:n}))},t.getGatewayInfo=function(e){if(t.gatewayClient.state!==_.a.CONNECTED){var n="Client is not in connected state";return i.default.error("[".concat(t.clientId,"] ").concat(n)),void e(n)}t.gatewayClient.getGatewayInfo((function(t){e(null,t)}),e)},t.renewToken=function(n,r,a){var s=o.report.reportApiInvoke(e.sessionId,{callback:function(e,t){if(e)return i.default.error("Failed to renew token ".concat(e),t),a&&a(e);r&&r(t)},name:"Client.renewToken",options:arguments,tag:"tracer"});if(!Object(B.isValidToken)(n))throw new Error("Invalid token: Token is of the string type .Length of the string: [1,255]. ASCII characters only.");return t.gatewayClient?t.key?(t.key=n,void t.gatewayClient.renewToken(n,(function(e){return s(null,e)}),s)):(i.default.error("[".concat(t.clientId,"] renewToken should not be called before user join")),s(w.default.INVALID_OPERATION)):(i.default.error("[".concat(t.clientId,"] renewToken Failed. GatewayClient not Exist")),s(w.default.INVALID_OPERATION))},t.setLowStreamParameter=function(n){var r=o.report.reportApiInvoke(e.sessionId,{name:"Client.setLowStreamParameter",options:arguments,tag:"tracer"});Object(B.checkValidObject)(n,"param");var a=n.width,s=n.height,c=n.framerate,u=n.bitrate;Object(B.isEmpty)(a)||Object(B.checkValidNumber)(a,"width"),Object(B.isEmpty)(s)||Object(B.checkValidNumber)(s,"height"),Object(B.isEmpty)(c)||Object(B.checkValidNumber)(c,"framerate"),Object(B.isEmpty)(u)||Object(B.checkValidNumber)(u,"bitrate",1,1e7),(!a&&s||a&&!s)&&i.default.warning("[".concat(t.clientId,"] The width and height parameters take effect only when both are set")),t.lowStreamParameter=n,r()},t.init=function(t,n,r){var i=o.report.reportApiInvoke(e.sessionId,{callback:function(e,t){if(e)return r&&r(e);n&&n(t)},name:"Client.init",options:arguments,tag:"tracer"});Object(B.checkValidString)(t),Object(s.isChromeKernel)()&&Object(s.getChromeKernelVersion)()<=48?r?i(w.default.BAD_ENVIRONMENT):Object(S.popBanTip)():(e.appId=t,e.sessionId=Object(S.generateSessionId)(),i())},t.setTurnServer=function(n){var r=o.report.reportApiInvoke(e.sessionId,{name:"Client.setTurnServer",options:arguments,tag:"tracer"});if(t.gatewayClient&&t.gatewayClient.state!==_.a.DISCONNECTED)throw new Error("Set turn server before join channel");if(t.useProxyServer)throw new Error("You have already set the proxy");if(t.useLocalAccessPoint)throw new Error("You have already set the local proxy");n instanceof Array||(n=[n]);var a=[];n.map((function(e,n){Object(B.checkValidObject)(e,"turnServer");var r=e.turnServerURL,o=e.username,s=e.password,c=e.udpport,u=e.forceturn,l=e.tcpport;if(Object(B.checkValidString)(r,"turnServerURL"),Object(B.checkValidString)(o,"username"),Object(B.checkValidString)(s,"password"),Object(B.checkValidString)(c,"udpport"),0===parseInt(c))throw new Error("udpport should not be ".concat(c));Object(B.isEmpty)(u)||Object(B.checkValidBoolean)(u,"forceturn");var d={mode:"manual"};if(d.url=r,d.udpport=c,d.username=o,d.credential=s,d.forceturn=u||!1,!Object(B.isEmpty)(l)){if(Object(B.checkValidString)(l,"tcpport"),0===parseInt(l))throw new Error("tcpport should not be ".concat(l));d.tcpport=l,i.default.info("[".concat(t.clientId,"] Set turnserver[").concat(n,"] tcpurl. ").concat(d.url,":").concat(d.tcpport))}i.default.info("[".concat(t.clientId,"] Set turnserver[").concat(n,"] udpurl. ").concat(d.url,":").concat(d.udpport,",username: ").concat(d.username)),a.push(d)})),t.turnServers=a,r()},t.setProxyServer=function(n){var r=o.report.reportApiInvoke(e.sessionId,{name:"Client.setProxyServer",options:arguments,tag:"tracer"});if(t.gatewayClient&&t.gatewayClient.state!==_.a.DISCONNECTED)throw new Error("Set proxy server before join channel");if(!n)throw new Error("Do not set the proxyServer parameter as empty");if(t.useProxyServer)throw new Error("You have already set the proxy");if(t.useLocalAccessPoint)throw new Error("You have already set the local proxy");Object(B.checkValidString)(n,"proxyServer"),t.proxyServer=n,o.report.setProxyServer(n),i.default.setProxyServer(n),r()},t.startProxyServer=function(n){var r=o.report.reportApiInvoke(e.sessionId,{name:"Client.startProxyServer",options:arguments,tag:"tracer"});if(t.gatewayClient&&t.gatewayClient.state!==_.a.DISCONNECTED)throw new Error("Start proxy server before join channel");if(t.proxyServer)throw new Error("You have already set the proxy");if(t.useLocalAccessPoint)throw new Error("You have already set the local proxy");t.useProxyServer=!0,t.proxyServerType=n||1,r()},t.stopProxyServer=function(){var n=o.report.reportApiInvoke(e.sessionId,{name:"Client.stopProxyServer",options:arguments,tag:"tracer"});if(t.gatewayClient&&t.gatewayClient.state!==_.a.DISCONNECTED)throw new Error("Stop proxy server after leave channel");o.report.setProxyServer(),i.default.setProxyServer(),t.turnServers=[],t.proxyServer=null,t.useProxyServer=!1,t.proxyServerType=null,n()},t.setEncryptionSecret=function(n){var r=o.report.reportApiInvoke(e.sessionId,{name:"Client.setEncryptionSecret",options:arguments,tag:"tracer"});Object(B.checkValidString)(n,"password");var i=new RegExp("^(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.*[!@#$%^&*])(?=.{8,})");i.test(n)||console.warn("The secret is not strong:\n      The secret must contain at least 1 lowercase alphabetical character,\n      The secret must contain at least 1 uppercase alphabetical character,\n      The secret must contain at least 1 numeric character,\n      The secret must contain at least one special character,\n      The secret must be eight characters or longer,\n      "),t.aespassword=n,r()},t.setEncryptionMode=function(n){var r=o.report.reportApiInvoke(e.sessionId,{name:"Client.setEncryptionMode",options:arguments,tag:"tracer"});if(Object(B.checkValidString)(n,"encryptionMode"),-1===v.indexOf(n))throw new Error('Invalid encryptionMode: encryptionMode should be "aes-128-xts" | "aes-256-xts" | "aes-128-ecb" | "sm4-128-ecb" | "aes-128-gcm" | "aes-256-gcm"');t.aesmode=n,r()},t.configPublisher=function(n){var r=o.report.reportApiInvoke(e.sessionId,{name:"Client.configPublisher",options:arguments,tag:"tracer"});Object(B.checkValidObject)(n,"config");var i=n.width,a=n.height,s=n.framerate,c=n.bitrate,u=n.publisherUrl;Object(B.checkValidNumber)(i,"width"),Object(B.checkValidNumber)(a,"height"),Object(B.checkValidNumber)(s,"framerate"),Object(B.checkValidNumber)(c,"bitrate",1,1e7),u&&Object(B.checkValidString)(u,"publisherUrl"),t.gatewayClient.configPublisher(n),r()},t.enableDualStream=function(n,r){var a=o.report.reportApiInvoke(e.sessionId,{callback:function(e,t){if(e)return r&&r(e);n&&n(t)},name:"Client.enableDualStream",options:arguments,tag:"tracer"});return"iOS"===Object(s.getBrowserOS)()?(o.report.streamSwitch(e.sessionId,{lts:(new Date).getTime(),isdual:!0,succ:!1}),a(w.default.IOS_NOT_SUPPORT)):Object(s.isWeChatBrowser)()?(o.report.streamSwitch(e.sessionId,{lts:(new Date).getTime(),isdual:!0,succ:!1}),a(w.default.WECHAT_NOT_SUPPORT)):(o.report.streamSwitch(e.sessionId,{lts:(new Date).getTime(),isdual:!0,succ:!0}),t.isDualStream=!0,t.highStream&&(t.highStream.isDualStream=!0),void(0===t.highStreamState?t._publishLowStream((function(e){return a(null,e)}),(function(e){i.default.warning("[".concat(t.clientId,"]"),e),a(w.default.ENABLE_DUALSTREAM_FAILED)})):1===t.highStreamState?a(w.default.STILL_ON_PUBLISHING):a(null)))},t.disableDualStream=function(n,r){var a=o.report.reportApiInvoke(e.sessionId,{callback:function(e,t){if(e)return r&&r(e);n&&n(t)},name:"Client.disableDualStream",options:arguments,tag:"tracer"});o.report.streamSwitch(e.sessionId,{lts:(new Date).getTime(),isdual:!1,succ:!0}),t.isDualStream=!1,t.highStream&&(t.highStream.isDualStream=!1),0===t.highStreamState?t._unpublishLowStream((function(){t.highStream.lowStream=null,a()}),(function(e){i.default.warning("[".concat(t.clientId,"]"),e),a(w.default.DISABLE_DUALSTREAM_FAILED)})):1===t.highStreamState?a(w.default.STILL_ON_PUBLISHING):a()},t._getLowStream=function(e,n){t.lowStream?e(t.lowStream):t._createLowStream((function(n){t.lowStream=n,e(t.lowStream)}),n)},t._createLowStream=function(e,n){if(t.highStream&&t.highStream.stream){var r=E()({},t.highStream.params);if(r.streamID+=1,r.audio=!1,r.video)if(t.highStream.stream.getVideoTracks()[0]){var i=new l.a(r);i.isLowStream=!0,i.streamId=t.highStream.getId()+1;var o={};t.lowStreamParameter&&(o=E()({},t.lowStreamParameter)),o.width&&o.height||(o.width=160,o.height=120),o.framerate=o.framerate||15,o.bitrate=o.bitrate||50,i.setVideoProfileCustomPlus(o);try{var a=D()(t.highStream,{width:i.videoConstraint.width.ideal,height:i.videoConstraint.height.ideal,framerate:i.videoConstraint.frameRate});return i.stream=a,t.highStream.lowStream=i,t.highStream.userMuteVideo&&i.muteVideo(),e&&e(i)}catch(e){return n&&n(e)}}else n&&n(w.default.HIGH_STREAM_NOT_VIDEO_TRACE);else n&&n(w.default.HIGH_STREAM_NOT_VIDEO_TRACE)}else n&&n(w.default.HIGH_STREAM_NOT_VIDEO_TRACE)},t._publishLowStream=function(e,n){return 2!==t.lowStreamState?n&&n(w.default.LOW_STREAM_ALREADY_PUBLISHED):t.highStream&&t.highStream.hasScreen()?n&&n(w.default.SHARING_SCREEN_NOT_SUPPORT):void t._getLowStream((function(r){t.lowStreamState=1,t.gatewayClient.publish(r,{streamType:1},(function(){t.lowStreamState=0,e&&e()}),(function(e){1===t.lowStreamState&&(t.lowStreamState=2),i.default.debug("[".concat(t.clientId,"] publish low stream failed")),n&&n(e)}))}),n)},t._unpublishLowStream=function(e,n){if(0!==t.lowStreamState)return n&&n(w.default.LOW_STREAM_NOT_YET_PUBLISHED);t.lowStream&&(t.gatewayClient.unpublish(t.lowStream,{streamType:1},(function(){}),(function(e){i.default.debug("[".concat(t.clientId,"] unpublish low stream failed")),n&&n(e)})),t.lowStream.close(),t.lowStream=null,t.lowStreamState=2,e&&e())},t.join=function(n,r,a,s,c,u){s&&"function"==typeof s&&(u=c,c=s,s=null);var l=o.report.reportApiInvoke(e.sessionId,{callback:function(e,t){if(e)return u&&u(e);c&&c(t)},name:"Client.join",options:arguments,tag:"tracer"});if(n&&!Object(B.isValidToken)(n))return i.default.warning("[".concat(t.clientId,"] Param channelKey should be string")),l(w.default.INVALID_PARAMETER);if(!Object(B.isValidChannelName)(r))return i.default.error("Invalid Channel Name ".concat(r)),i.default.warning("[".concat(t.clientId,"] The length must be within 64 bytes. The supported characters: a-z,A-Z,0-9,space,!, #, $, %, &, (, ), +, -, :, ;, <, =, ., >, ?, @, [, ], ^, _,  {, }, |, ~, ,")),l(w.default.INVALID_PARAMETER);if("string"==typeof r&&""===r)return i.default.warning("[".concat(t.clientId,"] Param channel should not be empty")),l(w.default.INVALID_PARAMETER);if(s&&!Object(B.isValidString)(s))return i.default.warning("[".concat(t.clientId,"] optionalInfo should be string")),l(w.default.INVALID_PARAMETER);if(a&&!Object(S.is32Uint)(a)&&!Object(B.isValidString)(a,1,255))return i.default.error("Invalid UID ".concat(a," ").concat(y()(a))),i.default.warning("[".concat(t.clientId,"] [String uid] Length of the string: [1,255]. ASCII characters only. [Number uid] The value range is 32Uint")),l(w.default.INVALID_PARAMETER);if("string"==typeof a&&0==a.length)return i.default.warning("[".concat(t.clientId,"] String uid should not be empty")),l(w.default.INVALID_PARAMETER);if("string"==typeof a&&a.length>256)return i.default.warning("[".concat(t.clientId,"] Length of string uid should be less than 255")),l(w.default.INVALID_PARAMETER);t.highStream=null,t.lowStream=null,t.lowStreamParameter=null,t.isDualStream=!1,t.highStreamState=2,t.lowStreamState=2;var d=Date.now(),h=setTimeout((function(){if(1!=t.gatewayClient.hasJoined){i.default.debug("[".concat(t.clientId,"] The time to join the channel is greater than 5 seconds "));var n=Date.now();o.report.joinChannelTimeOut({lts:n,sid:e.sessionId,cname:r,cid:f&&f.cid,uid:f.uid||("string"==typeof a?void 0:a),elapse:n-d,timeout:5})}}),5e3),f={clientId:t.clientId,appId:e.appId,sid:e.sessionId,cname:r,uid:a,turnServers:t.turnServers.concat(),proxyServer:t.proxyServer,token:n||e.appId,useProxyServer:t.useProxyServer,useLocalAccessPoint:t.useLocalAccessPoint,proxyServerType:t.proxyServerType,optionalInfo:s};if("string"==typeof a&&(f.stringUid=a,t.uintUid?(f.uid=t.uintUid,delete t.uintUid):f.uid=0),t.aespassword&&"none"!==t.aesmode&&E()(f,{aespassword:t.aespassword,aesmode:t.aesmode}),o.report.sessionInit(e.sessionId,{lts:(new Date).getTime(),cname:r,appid:e.appId,mode:e.mode,succ:!0}),t.onSuccess=function(e){clearTimeout(h),t.rtcStatsCollector.startNetworkQualityTimer(),t.onSuccess=null,l(null,e)},t.onFailure=function(e){return l(e)},t.channel=r,t.gatewayClient.state!==_.a.DISCONNECTED)return i.default.error("[".concat(t.clientId,"] Client already in connecting/connected state")),l(w.default.INVALID_OPERATION),void o.report.joinGateway(e.sessionId,{lts:Date.now(),succ:!1,ec:w.default.INVALID_OPERATION,addr:null});t.gatewayClient.state=_.a.CONNECTING;var p=function(o,a){i.default.info("[".concat(t.clientId,"] Joining channel: ").concat(r)),t.gatewayClient.dispatchEvent({type:"config-distribute",config:a,joinInfo:f}),t.key=n||e.appId,f.cid=o.cid,f.uid||(f.uid=o.uid),f.vid=o.vid,f.clientId=t.clientId,f.apResponse=o.res,o.uni_lbs_ip&&o.uni_lbs_ip[1]&&(f.uni_lbs_ip=o.uni_lbs_ip[1]),f.gatewayAddr=o.gateway_addr,t.joinInfo=f,t.gatewayClient.join(f,t.key,(function(e){i.default.info("[".concat(t.clientId,"] Join channel ").concat(r," success, join with uid: ").concat(e,".")),t.onSuccess=null,t.rtcStatsCollector.startNetworkQualityTimer(),l(null,e)}),(function(e){return l(e)}))};f.stringUid&&!f.uid?(t.userAccountReq&&!t.userAccountReq.isFinished()&&t.userAccountReq.cancel(),t.userAccountReq=Object(T.getUserAccount)(f,t.gatewayClient),t.userAccountReq.then((function(e){i.default.debug("getUserAccount Success ".concat(e.url," ").concat(f.stringUid," => ").concat(e.uid)),f.uid=e.uid,Object(T.getGatewayList)(f,p,(function(e){return l(e)}))})).catch((function(e){i.default.error("getUserAccount rejected",e),l(e)}))):Object(T.getGatewayList)(f,p,(function(e){return l(e)}))},t.renewChannelKey=function(n,r,a){var s=o.report.reportApiInvoke(e.sessionId,{callback:function(e,t){if(e)return a&&a(e);r&&r(t)},name:"Client.renewChannelKey",options:arguments,tag:"tracer"});Object(B.checkValidString)(n,"key",1,2047),void 0===t.key?(i.default.error("[".concat(t.clientId,"] renewChannelKey should not be called before user join")),s(w.default.INVALID_OPERATION)):(t.key=n,t.gatewayClient.joinInfo.token=n,t.gatewayClient.key=n,t.gatewayClient.recover(),s())},t.leave=function(n,a){t.gatewayClient.isFirstSuccess=!0,t.gatewayClient.hasInvokeLeave=!0;var s=!1,c=o.report.reportApiInvoke(e.sessionId,{callback:function(e,r){if(e)return a&&a(e);t.gatewayClient.reconnectingCS=!1,t.gatewayClient.state=_.a.DISCONNECTED,clearTimeout(Object(T._getReconnectCSTimer)(t.clientId)),t._renewSession(),t.rtcStatsCollector.clearNetworkQualityTimer(),n&&n(r)},name:"Client.leave",options:arguments,tag:"tracer"});i.default.info("[".concat(t.clientId,"] Leaving channel")),t.userAccountReq&&!t.userAccountReq.isFinished()&&(t.userAccountReq.cancel(),t.gatewayClient.state===_.a.CONNECTING&&(t.gatewayClient.state=_.a.DISCONNECTED)),t._terminateLiveStreaming(),t.gatewayClient.leave((function(e){s=!0,c(null,e)}),c),setTimeout((function(){s||(t.gatewayClient.socket&&(t.gatewayClient.socket.close(),t.gatewayClient.socket=null),t.gatewayClient.state=_.a.DISCONNECTED,c(null,"LEAVE_MSG_TIMEOUT"))}),Object(r.getParameter)("LEAVE_MSG_TIMEOUT"))},t._renewSession=function(){var n=Object(S.generateSessionId)();if(i.default.debug("renewSession ".concat(e.sessionId," => ").concat(n)),e.sessionId=n,t.gatewayClient.peerPublishDurationMap.clear(),t.joinInfo&&(t.joinInfo.sid=n),t.gatewayClient&&(t.gatewayClient.joinInfo&&(t.gatewayClient.joinInfo.sid=n),t.gatewayClient.localStreams))for(var r in t.gatewayClient.localStreams){var o=t.gatewayClient.localStreams[r];o&&(o.sid=n)}},t._publish=function(n,o,a,s){if(2!==t.highStreamState)return i.default.warning("[".concat(t.clientId,"] Can't publish stream when stream already publish ").concat(n.getId())),a&&a(w.default.STREAM_ALREADY_PUBLISHED);if(0===t.turnServers.length&&Object(r.getParameter)("FORCE_TURN")&&!Object(r.getParameter)("TURN_ENABLE_TCP")&&!Object(r.getParameter)("TURN_ENABLE_UDP"))throw new Error("force TURN With No TURN Configuration");i.default.info("[".concat(t.clientId,"] Publishing stream, uid ").concat(n.getId())),t.highStream=n,t.highStreamState=1,t.highStream.streamId=t.joinInfo.stringUid||t.joinInfo.uid,t.hasPublished=!1;var c=function(n,r,o){t.gatewayClient.publish(n,{streamType:0},(function(){n.sid=e.sessionId,t.highStreamState=0,i.default.info("[".concat(t.clientId,"] Publish success, uid: ").concat(n.getId())),t.highStream&&(t.highStream.isDualStream=t.isDualStream),t.isDualStream?t._publishLowStream((function(){r&&r()}),(function(e){i.default.warning("[".concat(t.clientId,"] "),e),k.a.replaceWithCanvasTrack(n).then((function(){r&&r()}))})):k.a.replaceWithCanvasTrack(n).then((function(){r&&r()}))}),o)};"audience"!==t.gatewayClient.role||"live"!==t.mode||s?c(n,o,a):t.gatewayClient.setClientRole(F,(function(e){if(e)return a&&a(e);c(n,o,a)}))},t._unpublish=function(e,n,r,o){if(0!==t.highStreamState)return i.default.warning("[".concat(t.clientId,"] Can't unpublish stream when stream not publish")),r&&r(w.default.STREAM_NOT_YET_PUBLISHED);i.default.info("[".concat(t.clientId,"] Unpublish stream, uid ").concat(e.getId()));var a=function(e,n,r){t.isDualStream&&t.lowStream&&t._unpublishLowStream(null,r),t.gatewayClient.unpublish(e,{streamType:0},(function(){t.highStreamState=2,i.default.info("[".concat(t.clientId,"] Unpublish stream success, uid: ").concat(e.getId())),t.gatewayClient.dispatchEvent({type:"stream-unpublished",stream:e}),n&&n()}),(function(n){i.default.info("[".concat(t.clientId,"] Unpublish stream fail, uid: ").concat(e.getId())),r&&r(n)}))};t.gatewayClient.role!==F||"live"!==t.mode||o?a(e,n,r):t.gatewayClient.setClientRole("audience",(function(t){if(t)return r&&r(t);a(e,n,r)}))},t.publish=function(n,r){var i=o.report.reportApiInvoke(e.sessionId,{callback:function(e,n){if(e)return 1===t.highStreamState&&"REQUEST_ABORT"!==e&&(t.highStreamState=2),r&&r(e)},name:"Client.publish",tag:"tracer",options:{stream:"too long to show",onFailure:!!r}});2===t.highStreamState?n._hasVideoTracks()||n._hasAudioTracks()?(t.gatewayClient.publishRequestId=Object(S.generateId)(),t._publish(n,(function(e){return i(null,e)}),(function(e){return i(e)}))):i(w.default.NO_TRACK_IN_STREAM):i(w.default.STREAM_ALREADY_PUBLISHED)},t.unpublish=function(n,r,i){var a=o.report.reportApiInvoke(e.sessionId,{callback:function(e,t){if(e)return r&&r(e);i&&i(t)},name:"Client.unpublish",tag:"tracer",options:{stream:"too long to show",onFailure:!!r}});0===t.highStreamState?(t.gatewayClient.publishRequestId=null,t._unpublish(n,(function(e){return a(null,e)}),(function(e){return a(e)}))):a(w.default.STREAM_NOT_YET_PUBLISHED)},t.subscribe=function(n,r,a){var c=o.report.reportApiInvoke(e.sessionId,{callback:function(e,t){if(e)return a&&a(e)},name:"Client.subscribe",tag:"tracer",options:{stream:"too long to show",options:r,onFailure:!!a}});"function"==typeof r&&(a=r,r=null),Object(B.checkValidObject)(n,"stream"),Object(B.isEmpty)(r)||(Object(B.checkValidObject)(r,"options"),Object(B.isEmpty)(r.video)||Object(B.checkValidBoolean)(r.video,"options.video"),Object(B.isEmpty)(r.audio)||Object(B.checkValidBoolean)(r.audio,"options.audio"));var u={video:!0,audio:!0};if(!Object(B.isEmpty)(r)){if(Object(s.isSafari)()&&(!r.video||!r.audio)){var l="SAFARI_NOT_SUPPORTED_FOR_TRACK_SUBSCRIPTION";return i.default.error("[".concat(t.clientId,"] "),l),void c(l)}if(!Object(B.isEmpty)(r.video)&&!Object(B.isValidBoolean)(r.video)||!Object(B.isEmpty)(r.audio)&&!Object(B.isValidBoolean)(r.audio)||!1===r.audio&&!1===r.video)return l="INVALID_PARAMETER ".concat(JSON.stringify(r)),i.default.error("[".concat(t.clientId,"] "),l),void c(l)}n.subscribeOptions?(E()(n.subscribeOptions,u,r),t.gatewayClient.subscribeChange(n,(function(e){return c(null,e)}),c)):(t.gatewayClient.subscribeRequestId.set(n.getId(),Object(S.generateId)()),n.subscribeOptions=E()({},u,r),t.gatewayClient.subscribe(n,(function(e){return c(null,e)}),c))},t.unsubscribe=function(n,r){var a=o.report.reportApiInvoke(e.sessionId,{callback:function(e,t){if(e)return r&&r(e)},name:"Client.unsubscribe",tag:"tracer",options:{stream:"too long to show",onFailure:!!r}});i.default.info("[".concat(t.clientId,"] Unsubscribe stream, uid: ").concat(n.getId())),t.gatewayClient.subscribeRequestId.delete(n.getId()),t.gatewayClient.unsubscribe(n,(function(e){return a(null,e)}),a)},t.setRemoteVideoStreamType=function(n,r){var i=o.report.reportApiInvoke(e.sessionId,{name:"Client.setRemoteVideoStreamType",tag:"tracer",options:{stream:"too long to show",streamType:r}});Object(B.checkValidEnum)(r,"streamType",[0,1]),t.gatewayClient.setRemoteVideoStreamType(n,r),i()},t.setStreamFallbackOption=function(n,r){var i=o.report.reportApiInvoke(e.sessionId,{name:"Client.setStreamFallbackOption",tag:"tracer",options:{stream:"too long to show",fallbackType:r}});Object(B.checkValidEnum)(r,"fallbackType",[0,1,2]),t.gatewayClient.setStreamFallbackOption(n,r),i()},t.enableAudioVolumeIndicator=function(n,r){var a=o.report.reportApiInvoke(e.sessionId,{name:"Client.enableAudioVolumeIndicator",options:arguments,tag:"tracer"});n=n||2e3,r=r||3,Object(B.checkValidNumber)(r,"smooth",1,100),Object(B.checkValidNumber)(n,"interval",50,1e5),t.audioVolumeIndication=t.audioVolumeIndication||{enabled:!0},t.audioVolumeIndication.interval=n,t.audioVolumeIndication.smooth=r,t.audioVolumeIndication={interval:n,smooth:r},i.default.info("[".concat(t.clientId,"] enableAudioVolumeIndicator interval ").concat(n," smooth ").concat(r)),t.gatewayClient.enableAudioVolumeIndicator(n,r),a()},t.getNetworkStats=function(e,n){return i.default.deprecate("[".concat(t.clientId,"] client.getNetworkStats is deprecated. Use client.getTransportStats instead.")),M.getStats(e,n)},t.getSystemStats=function(e,t){return u.getStats(e,t)},t.getRecordingDevices=function(e,t){return d.a.getRecordingDevices(e,t)},t.getPlayoutDevices=function(e,t){return d.a.getPlayoutDevices(e,t)},t.getCameras=function(e,t){return d.a.getCameras(e,t)},t.getRemoteAudioStats=function(e,n){return t.rtcStatsCollector.getRemoteAudioStats(e,n)},t.getLocalAudioStats=function(e,n){return t.rtcStatsCollector.getLocalAudioStats(e,n)},t.getRemoteVideoStats=function(e,n){return t.rtcStatsCollector.getRemoteVideoStats(e,n)},t.getLocalVideoStats=function(e,n){return t.rtcStatsCollector.getLocalVideoStats(e,n)},t._getRemoteVideoQualityStats=function(e,n){return t.rtcStatsCollector.getRemoteVideoQualityStats(e,n)},t._getRemoteAudioQualityStats=function(e,n){return t.rtcStatsCollector.getRemoteAudioQualityStats(e,n)},t.getTransportStats=function(e,n){return t.rtcStatsCollector.getTransportStats((function(t){return M.getStats((function(n){var r=E()({},t,n);e&&e(r)}),n)}),n)},t.getSessionStats=function(e,n){return t.rtcStatsCollector.getSessionStats(e,n)},t.onNetworkQuality=function(){return t.rtcStatsCollector.onNetworkQuality(onSuccess,onFailure)},t.sendMetadata=function(n,r){var i=o.report.reportApiInvoke(e.sessionId,{name:"Client.sendMetadata",tag:"tracer",callback:function(e){if(e)return r&&r(e);r&&r()}});t.gatewayClient.sendMetadata(n,i)},t.sendCustomReportMessage=function(n,a,s,c,u,l){Object(r.getParameter)("CR")?t.customReportCount>Object(r.getParameter)("CRL")?l&&l("REPORT_LIMITED"):(t.gatewayClient.hasJoined||(i.default.WARNING("Should invoke Client.sendCustomReportMessage after join"),l&&l("REPORT_BEFORE_JOINED")),t.customReportTimer||(t.customReportTimer=setInterval((function(){t.customReportCount=0}),Object(r.getParameter)("CRI"))),Object(B.checkValidString)(n,"reportId",0,100,!1),Object(B.checkValidString)(a,"category",0,100,!1),Object(B.checkValidString)(s,"event",0,100,!1),Object(B.checkValidString)(c,"label",0,100,!1),Object(B.checkValidNumber)(u,"value",Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER),t.customReportCount++,o.report.sendCustomReportMessage(e.sessionId,{reportId:n,category:a,event:s,label:c,value:u,lts:Date.now()},(function(e){e?l&&l("REPORT_FAILED"):l&&l()}))):l&&l("REPORT_FORBIDDEN")},t.setLocalAccessPoints=function(n,i){var a=o.report.reportApiInvoke(e.sessionId,{name:"Client.setLocalAccessPoints",tag:"tracer"});if(Object(B.checkValidArray)(n,"serverList"),Object(B.checkValidString)(i,"domain"),t.useProxyServer)throw new Error("You have already set the proxy");n=n.map((function(e){return"".concat(e.replace(/\./g,"-"),".").concat(i)})),t.useLocalAccessPoint=!0,Object(r.setParameter)("WEBCS_DOMAIN",n),Object(r.setParameter)("WEBCS_DOMAIN_BACKUP_LIST",n),Object(r.setParameter)("GATEWAY_DOMAINS",[i]),Object(r.setParameter)("EVENT_REPORT_DOMAIN",n[Math.floor(Math.random()*n.length)]),Object(r.setParameter)("EVENT_REPORT_BACKUP_DOMAIN",n[Math.floor(Math.random()*n.length)]),Object(r.setParameter)("LOG_UPLOAD_SERVER","".concat(n[Math.floor(Math.random()*n.length)],":6444")),a()},e.clientId=t.clientId,t.gatewayClient=Object(_.a)(e),t.listenerLoggerTimer=null,t.listenerLoggerCache=[],t.on=function(e,n){t.gatewayClient.on(e,n),t.listenerLoggerCache.push("".concat(e).concat(n.name?":"+n.name:"")),t.listenerLoggerTimer?clearTimeout(t.listenerLoggerTimer):i.default.info("[".concat(t.clientId,"] Adding event handler on ").concat(e)),t.listenerLoggerTimer=setTimeout((function(){t.listenerLoggerCache.length&&(t.listenerLoggerTimer=null,i.default.info("[".concat(t.clientId,"] Added event handler on ").concat(t.listenerLoggerCache.join(", "))),t.listenerLoggerCache=[])}),0)},t.off=function(e,n){i.default.info("remove event handler from [".concat(e,"]")),t.gatewayClient.removeEventListener(e,n)},t.rtcStatsCollector=function(e){var t=Object(a.b)();return t.gatewayClient=e,t.exceptionMonitor=new O(e),t.localStats={},t.remoteStats={},t.session={sendBytes:0,recvBytes:0,WSSendBytes:0,WSSendBytesDelta:0,WSRecvBytes:0,WSRecvBytesDelta:0,HTTPSendBytes:0,HTTPSendBytesDelta:0,HTTPRecvBytes:0,HTTPRecvBytesDelta:0},t.getRemoteAudioStats=function(e){var n=t.gatewayClient.traffic_stats,r={};for(var i in t.remoteStats){var o={},a=t.remoteStats[i];if(Object(R.b)(o,"End2EndDelay",a.peer_delay&&a.peer_delay.audio_delay),Object(R.b)(o,"TransportDelay",a.peer_delay&&a.peer_delay.e2e_delay),Object(R.b)(o,"PacketLossRate",a.peer_delay&&a.peer_delay.e2e_audio_lost_ratio_400ms),Object(R.b)(o,"RecvLevel",a.audioStats&&a.audioStats.audioOutputLevel),Object(R.b)(o,"RecvBitrate",a.audioRecvBitrate),Object(R.b)(o,"CodecType",a.audioStats&&a.audioStats.googCodecName),Object(R.b)(o,"MuteState",a.audioDisabled),Object(R.b)(o,"TotalFreezeTime",a.audioStats&&a.audioStats.audioTotalFreezeTime),Object(R.b)(o,"TotalPlayDuration",a.audioStats&&a.audioStats.audioTotalPlayDuration),n&&n.peer_delay){var s=n.peer_delay.find((function(e){return e.peer_uid==i}));if(s){var c=s.peer_publish_audio_duration+(Date.now()-n.timestamp);Object(R.b)(o,"AudioPublishDuration",c)}else Object(R.b)(o,"AudioPublishDuration",-1)}r[i]=o}e&&e(r)},t.getLocalAudioStats=function(e){var n={};for(var r in t.localStats){var i={},o=t.localStats[r];Object(R.b)(i,"RecordingLevel",o.audioStats&&o.audioStats.audioInputLevel),Object(R.b)(i,"SendLevel",o.audioStats&&o.audioStats.totalAudioEnergy),Object(R.b)(i,"SamplingRate",o.audioStats&&o.audioStats.totalSamplesDuration),Object(R.b)(i,"SendBitrate",o.audioSendBitrate),Object(R.b)(i,"CodecType",o.audioStats&&o.audioStats.googCodecName),Object(R.b)(i,"MuteState",o.audioDisabled),Object(R.b)(i,"audioSendPacketsLost",o.audioStats&&o.audioStats.packetsLost);var a=t.gatewayClient.localStreams[r];a&&a.isPlaying()&&Object(R.b)(i,"MuteState",a.userMuteAudio?"1":"0"),n[r]=i}e&&e(n)},t.getRemoteVideoStats=function(e){var n=t.gatewayClient.traffic_stats,r={};for(var i in t.remoteStats){var o={},a=t.remoteStats[i];if(Object(R.b)(o,"End2EndDelay",a.peer_delay&&a.peer_delay.video_delay),Object(R.b)(o,"TransportDelay",a.peer_delay&&a.peer_delay.e2e_delay),Object(R.b)(o,"PacketLossRate",a.peer_delay&&a.peer_delay.e2e_video_lost_ratio_400ms),Object(R.b)(o,"RecvBitrate",a.videoRecvBitrate),Object(R.b)(o,"RecvResolutionWidth",a.videoStats&&a.videoStats.googFrameWidthReceived),Object(R.b)(o,"RecvResolutionHeight",a.videoStats&&a.videoStats.googFrameHeightReceived),Object(R.b)(o,"RenderResolutionWidth",a.videoStats&&a.videoStats.renderRemoteWidth),Object(R.b)(o,"RenderResolutionHeight",a.videoStats&&a.videoStats.renderRemoteHeight),Object(R.b)(o,"RenderFrameRate",a.videoStats&&a.videoStats.googFrameRateOutput),Object(R.b)(o,"MuteState",a.videoDisabled),Object(R.b)(o,"TotalFreezeTime",a.videoStats&&a.videoStats.videoTotalFreezeTime),Object(R.b)(o,"TotalPlayDuration",a.videoStats&&a.videoStats.videoTotalPlayDuration),n&&n.peer_delay){var s=n.peer_delay.find((function(e){return e.peer_uid==i}));if(s){var c=s.peer_publish_video_duration+(Date.now()-n.timestamp);Object(R.b)(o,"VideoPublishDuration",c)}else Object(R.b)(o,"VideoPublishDuration",-1)}r[i]=o}e&&e(r)},t.getLocalVideoStats=function(e){var n={};for(var r in t.localStats){var i={},o=t.localStats[r];Object(R.b)(i,"TargetSendBitrate",o.videoTargetSendBitrate),Object(R.b)(i,"SendFrameRate",o.videoStats&&o.videoStats.googFrameRateSent),Object(R.b)(i,"SendBitrate",o.videoSendBitrate),Object(R.b)(i,"SendResolutionWidth",o.videoStats&&o.videoStats.googFrameWidthSent),Object(R.b)(i,"SendResolutionHeight",o.videoStats&&o.videoStats.googFrameHeightSent),Object(R.b)(i,"CaptureResolutionWidth",o.videoStats&&o.videoStats.googFrameWidthInput),Object(R.b)(i,"CaptureResolutionHeight",o.videoStats&&o.videoStats.googFrameHeightInput),Object(R.b)(i,"EncodeDelay",o.videoStats&&o.videoStats.googAvgEncodeMs),Object(R.b)(i,"MuteState",o.videoDisabled),Object(R.b)(i,"TotalFreezeTime",o.videoStats&&o.videoStats.videoTotalFreezeTime),Object(R.b)(i,"TotalDuration",o.videoStats&&o.videoStats.videoTotalPlayDuration),Object(R.b)(i,"CaptureFrameRate",o.videoStats&&o.videoStats.googFrameRateSent),Object(R.b)(i,"videoSendPacketsLost",o.videoStats&&o.videoStats.packetsLost),o.videoStats&&!o.videoStats.googFrameWidthInput&&Object(R.b)(i,"CaptureResolutionWidth",o.videoStats&&o.videoStats.renderLocalWidth),o.videoStats&&!o.videoStats.googFrameHeightInput&&Object(R.b)(i,"CaptureResolutionHeight",o.videoStats&&o.videoStats.renderLocalHeight),n[r]=i}e&&e(n)},t.getRemoteVideoQualityStats=function(e){var n={};for(var r in t.remoteStats){var i={},o=t.remoteStats[r];Object(R.b)(i,"videoReceiveDelay",o.videoStats&&o.videoStats.googCurrentDelayMs),Object(R.b)(i,"VideoFreezeRate",o.videoStats&&o.videoStats.videoFreezeRate),Object(R.b)(i,"FirstFrameTime",o.firstFrameTime),n[r]=i}e&&e(n)},t.getRemoteAudioQualityStats=function(e){var n={};for(var r in t.remoteStats){var i={},o=t.remoteStats[r];Object(R.b)(i,"audioReceiveDelay",o.audioStats&&o.audioStats.googCurrentDelayMs),Object(R.b)(i,"AudioFreezeRate",o.videoStats&&o.videoStats.videoFreezeRate),n[r]=i}e&&e(n)},t.getTransportStats=function(e){var n={},r={},i=t.gatewayClient.traffic_stats,o=i.peer_delay;if(Object(R.b)(n,"OutgoingAvailableBandwidth",t.gatewayClient.OutgoingAvailableBandwidth/1e3),Object(R.b)(n,"RTT",i&&2*i.access_delay),o){var a,s=function(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=function(e,t){if(e){if("string"==typeof e)return N(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?N(e,t):void 0}}(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i,o=!0,a=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return o=e.done,e},e:function(e){a=!0,i=e},f:function(){try{o||null==r.return||r.return()}finally{if(a)throw i}}}}(o);try{for(s.s();!(a=s.n()).done;){var c=a.value;c.downlink_estimate_bandwidth&&(r[c.peer_uid]=c.downlink_estimate_bandwidth/1e3+"")}}catch(e){s.e(e)}finally{s.f()}}n.IncomingAvailableBandwidth=r,e&&e(n)},t.getSessionStats=function(e){var n={},r=t.gatewayClient.traffic_stats,i=t.gatewayClient.socket,o=0,a=0;for(var s in t.remoteStats)(c=t.remoteStats[s])&&c.videoStats&&c.videoStats.videoRecvBytesDelta&&(a+=parseInt(c.videoStats.videoRecvBytesDelta)),c&&c.audioStats&&c.audioStats.audioRecvBytesDelta&&(a+=parseInt(c.audioStats.audioRecvBytesDelta));for(var s in t.localStats){var c;(c=t.localStats[s])&&c.videoStats&&c.videoStats.videoSendBytesDelta&&(o+=parseInt(c.videoStats.videoSendBytesDelta)),c&&c.audioStats&&c.audioStats.audioSendBytesDelta&&(o+=parseInt(c.audioStats.audioSendBytesDelta))}var u=o+t.session.WSSendBytesDelta+t.session.HTTPSendBytesDelta,l=a+t.session.WSRecvBytesDelta+t.session.HTTPRecvBytesDelta,d=t.session.sendBytes+Object(C.getHTTPSendBytes)(),h=t.session.recvBytes+Object(C.getHTTPRecvBytes)();t.gatewayClient.socket&&t.gatewayClient.socket.state===t.gatewayClient.CONNECTED&&(d+=i.getSendBytes(),h+=i.getRecvBytes());var f=1;r.peer_delay&&(f=r.peer_delay.length,f+=1),i?Object(R.b)(n,"Duration",i.getDuration()):Object(R.b)(n,"Duration",0),Object(R.b)(n,"UserCount",f),Object(R.b)(n,"SendBytes",d),Object(R.b)(n,"RecvBytes",h),Object(R.b)(n,"SendBitrate",8*u/1e3),Object(R.b)(n,"RecvBitrate",8*l/1e3),e&&e(n)},t.isLocalVideoFreeze=function(e,t){var n=0,r=0;if(!e||!t)return!1;if(Object(s.isChrome)()||Object(s.isOpera)())n=e.googFrameRateInput,r=e.googFrameRateSent;else if(Object(s.isSafari)())n=parseInt(e.framerateMean),r=parseInt(e.framesEncoded)-parseInt(t.framesEncoded);else{if(!Object(s.isFireFox)())return!1;n=parseInt(e.framerateMean),r=parseInt(e.framesEncoded)-parseInt(t.framesEncoded)}return n>5&&r<3},t.isRemoteVideoFreeze=function(e,t){var n=0,r=0;if(!e||!t)return!1;if(Object(s.isChrome)()||Object(s.isOpera)())n=e.googFrameRateReceived,r=e.googFrameRateDecoded;else if(Object(s.isSafari)())n=e.framerateMean,r=parseInt(e.framesDecoded)-parseInt(t.framesDecoded);else{if(!Object(s.isFireFox)())return!1;n=parseInt(e.framesReceived)-parseInt(t.framesReceived),r=parseInt(e.framesDecoded)-parseInt(t.framesDecoded)}return n>5&&n<10&&r<3||n>10&&n<20&&r<4||n>20&&r<5},t.isAudioFreeze=function(e){if(Object(s.isChrome)()&&e){if(e.googDecodingPLC&&e.googDecodingPLCCNG&&e.googDecodingCTN)return(parseInt(e.googDecodingPLC)+parseInt(e.googDecodingPLCCNG))/parseInt(e.googDecodingCTN)>.2}else if((Object(s.isSafari)()||Object(s.isFireFox)())&&e.packetsLost&&e.packetsReceived)return parseInt(e.packetsLost)/(parseInt(e.packetsLost)+parseInt(e.packetsReceived))>.2;return!1},t.isAudioDecodeFailed=function(e){return!!((Object(s.isChrome)()||Object(s.isOpera)())&&e&&parseInt(e.bytesReceived)>0&&0===parseInt(e.googDecodingNormal))},t.startNetworkQualityTimer=function(){t.clearNetworkQualityTimer(),t.networkQualityTimer=setInterval((function(){if(t.gatewayClient.state===_.a.CONNECTED&&navigator.onLine){var e=t.gatewayClient.traffic_stats;t.gatewayClient.dispatchEvent({type:"network-quality",uplinkNetworkQuality:t.networkQualityTrans(e.uplink_network_quality),downlinkNetworkQuality:t.networkQualityTrans(e.downlink_network_quality)})}else t.gatewayClient.dispatchEvent({type:"network-quality",uplinkNetworkQuality:0,downlinkNetworkQuality:0})}),2e3)},t.clearNetworkQualityTimer=function(){t.networkQualityTimer&&clearInterval(t.networkQualityTimer)},t.networkQualityTrans=function(e){return e>=0&&e<.17?1:e>=.17&&e<.36?2:e>=.36&&e<.59?3:e>=.59&&e<=1?4:e>1?5:0},t.getStatsTimer=setInterval((function(){var e=t.gatewayClient.traffic_stats,n=Date.now();t.gatewayClient.dispatchEvent({type:"_testException"}),Object.keys(t.localStats).length&&t.exceptionMonitor.setLocalStats(t.localStats),Object.keys(t.remoteStats).length&&t.exceptionMonitor.setRemoteStats(t.remoteStats);var r={};Object.keys(t.gatewayClient.remoteStreams).forEach((function(i){var o=t.gatewayClient.remoteStreams[i],a=t.remoteStats[i],s={id:i,updatedAt:n};r[i]=s,s.firstFrameTime=o.firstFrameTime,a?(s.audioTotalPlayDuration=a.audioTotalPlayDuration+1,s.audioTotalFreezeTime=a.audioTotalFreezeTime,s.isAudioFreeze=!1,s.isAudioDecodeFailed=!1,s.videoTotalPlayDuration=a.videoTotalPlayDuration+1,s.videoTotalFreezeTime=a.videoTotalFreezeTime,s.isVideoFreeze=!1):(s.audioTotalPlayDuration=1,s.audioTotalFreezeTime=0,s.videoTotalPlayDuration=1,s.videoTotalFreezeTime=0);var c=e&&e.peer_delay&&e.peer_delay.find((function(e){return e.peer_uid==i}));c&&(s.peer_delay=c),o&&(o.isPlaying()&&(s.audioDisabled=o.userMuteAudio||o.peerMuteAudio?"1":"0",s.videoDisabled=o.userMuteVideo||o.peerMuteVideo?"1":"0"),a&&a.peer_delay&&c&&a.peer_delay.stream_type!==c.stream_type&&t.gatewayClient.dispatchEvent({type:"streamTypeChange",uid:i,streamType:c.stream_type}),o.pc&&"established"==o.pc.state&&o.pc.getStats((function(e){if(s.pcStats=e,s.audioStats=e.find((function(e){return"audio"==e.mediaType&&(e.id.indexOf("_recv")>-1||e.id.toLowerCase().indexOf("inbound")>-1)})),s.videoStats=e.find((function(e){return"video"==e.mediaType&&(e.id.indexOf("_recv")>-1||e.id.toLowerCase().indexOf("inbound")>-1)})),a&&a.audioStats&&s.audioStats){var n=parseInt(s.audioStats.bytesReceived)-parseInt(a.audioStats.bytesReceived),r=parseInt(s.audioStats.googDecodingNormal)-parseInt(a.audioStats.googDecodingNormal);if(s.audioStats.audioRecvBytesDelta=n,s.audioStats.audioDecodingNormalDelta=r,t.session.recvBytes+=n,isFinite(n)&&s.audioStats.timestamp){var i=s.audioStats.timestamp.getTime()-a.audioStats.timestamp.getTime();s.audioRecvBitrate=Math.floor(8*n/i)}t.isAudioFreeze(s.audioStats)&&s.audioTotalPlayDuration>10&&(s.audioTotalFreezeTime++,s.isAudioFreeze=!0),t.isAudioDecodeFailed(s.audioStats)&&s.audioTotalPlayDuration>10&&(s.isAudioDecodeFailed=!0),s.audioStats.audioTotalFreezeTime=s.audioTotalFreezeTime,s.audioStats.audioTotalPlayDuration=s.audioTotalPlayDuration,s.audioStats.audioFreezeRate=Math.ceil(100*s.audioTotalFreezeTime/s.audioTotalPlayDuration)}if(a&&a.videoStats&&s.videoStats){var c=parseInt(s.videoStats.bytesReceived)-parseInt(a.videoStats.bytesReceived);s.videoStats.videoRecvBytesDelta=c,t.session.recvBytes+=c,isFinite(c)&&s.videoStats.timestamp&&(i=s.videoStats.timestamp.getTime()-a.videoStats.timestamp.getTime(),s.videoRecvBitrate=Math.floor(8*c/i)),t.isRemoteVideoFreeze(s.videoStats,a.videoStats)&&(s.videoTotalFreezeTime++,s.isVideoFreeze=!0),s.videoStats.videoTotalFreezeTime=s.videoTotalFreezeTime,s.videoStats.videoTotalPlayDuration=s.videoTotalPlayDuration,s.videoStats.videoFreezeRate=Math.ceil(100*s.videoTotalFreezeTime/s.videoTotalPlayDuration),o.player&&o.player.video&&o.player.video.videoWidth&&o.player.video.videoHeight?(s.videoStats.renderRemoteWidth=o.player.video.videoWidth,s.videoStats.renderRemoteHeight=o.player.video.videoHeight):(s.videoStats.renderRemoteWidth=o.videoWidth||s.videoStats.googFrameWidthReceived,s.videoStats.renderRemoteHeight=o.videoHeight||s.videoStats.googFrameHeightReceived)}})))})),t.remoteStats=r;var i={};if(Object.keys(t.gatewayClient.localStreams).forEach((function(e){var r=t.gatewayClient.localStreams[e],o=t.localStats[e],a={id:e,updatedAt:n};i[e]=a,o?(a.videoTotalPlayDuration=o.videoTotalPlayDuration+1,a.videoTotalFreezeTime=o.videoTotalFreezeTime,a.isVideoFreeze=!1):(a.videoTotalPlayDuration=1,a.videoTotalFreezeTime=0),r&&(r.isPlaying()&&(a.audioDisabled=r.userMuteAudio?"1":"0",a.videoDisabled=r.userMuteVideo?"1":"0"),r.video&&r.attributes.maxVideoBW?a.videoTargetSendBitrate=r.attributes.maxVideoBW:r.video&&r.screenAttributes&&(a.videoTargetSendBitrate=r.screenAttributes.maxVideoBW),r.pc&&"established"==r.pc.state&&r.pc.getStats((function(e){if(a.pcStats=e.reverse(),a.audioStats=e.find((function(e){return"audio"==e.mediaType&&(e.id.indexOf("_send")>-1||e.id.toLowerCase().indexOf("outbound")>-1)})),a.videoStats=e.find((function(e){return"video"==e.mediaType&&(e.id.indexOf("_send")>-1||e.id.toLowerCase().indexOf("outbound")>-1)})),a.audioStats&&o&&o.audioStats){var n=parseInt(a.audioStats.bytesSent)-parseInt(o.audioStats.bytesSent);if(a.audioStats.audioSendBytesDelta=n,t.session.sendBytes+=n,isFinite(n)&&a.audioStats.timestamp){var i=a.audioStats.timestamp.getTime()-o.audioStats.timestamp.getTime();a.audioSendBitrate=Math.floor(8*n/i)}}if(a.videoStats&&o&&o.videoStats){var s=parseInt(a.videoStats.bytesSent)-parseInt(o.videoStats.bytesSent);a.videoStats.videoSendBytesDelta=s,t.session.sendBytes+=s,isFinite(s)&&a.videoStats.timestamp&&(i=a.videoStats.timestamp.getTime()-o.videoStats.timestamp.getTime(),a.videoSendBitrate=Math.floor(8*s/i)),t.isLocalVideoFreeze(a.videoStats,o.videoStats)&&(a.videoTotalFreezeTime++,a.isVideoFreeze=!0),a.videoStats.videoTotalFreezeTime=a.videoTotalFreezeTime,a.videoStats.videoTotalPlayDuration=a.videoTotalPlayDuration,a.videoStats.videoFreezeRate=Math.ceil(100*a.videoTotalFreezeTime/a.videoTotalPlayDuration),a.videoStats.renderLocalWidth=r.videoWidth||a.videoStats.googFrameWidthSent,a.videoStats.renderLocalHeight=r.videoHeight||a.videoStats.googFrameHeightSent}})))})),t.localStats=i,t.session.HTTPSendBytesDelta=Object(C.getHTTPSendBytes)()-t.session.HTTPSendBytes,t.session.HTTPSendBytes=Object(C.getHTTPSendBytes)(),t.session.HTTPRecvBytesDelta=Object(C.getHTTPRecvBytes)()-t.session.HTTPRecvBytes,t.session.HTTPRecvBytes=Object(C.getHTTPRecvBytes)(),t.gatewayClient.socket&&t.gatewayClient.socket.state===t.gatewayClient.CONNECTED){var o=t.gatewayClient.socket;t.session.WSSendBytesDelta=o.getSendBytes()-t.session.WSSendBytes,t.session.WSSendBytes=o.getSendBytes(),t.session.WSRecvBytesDelta=o.getRecvBytes()-t.session.WSRecvBytes,t.session.WSRecvBytes=o.getRecvBytes()}}),1e3),t.gatewayClient.on("join",(function(){t.session={sendBytes:0,recvBytes:0,WSSendBytes:0,WSSendBytesDelta:0,WSRecvBytes:0,WSRecvBytesDelta:0,HTTPSendBytes:0,HTTPSendBytesDelta:0,HTTPRecvBytes:0,HTTPRecvBytesDelta:0}})),t}(t.gatewayClient),t.configDistributManager=function(e){var t={};return t.client=e,t.client.gatewayClient&&t.client.gatewayClient.on("config-distribute",(function(n){var a=n.joinInfo,s=n.config;if(s){Object(B.isEmpty)(s.uploadLog)||(Object(r.setParameter)("UPLOAD_LOG",s.uploadLog),o.report.reportApiInvoke(a.sid,{name:"_configDistribute",options:{feature:"uploadLog",value:s.uploadLog}})()),Object(B.isEmpty)(s.dualStream)||(e.isDualStream=s.dualStream,o.report.reportApiInvoke(a.sid,{name:"_configDistribute",options:{feature:"dualStream",value:s.dualStream}})()),Object(B.isEmpty)(s.streamFallbackOption)||t.client.gatewayClient&&t.client.gatewayClient.on("stream-subscribed",(function(e){var n=e.stream;n?(t.client.gatewayClient.setStreamFallbackOption(n,s.streamFallbackOption),o.report.reportApiInvoke(a.sid,{name:"_configDistribute",options:{feature:"streamFallbackOption",value:s.streamFallbackOption,streamId:n.getId()}})()):o.report.reportApiInvoke(a.sid,{name:"_configDistribute",options:{feature:"streamFallbackOption",value:s.streamFallbackOption,streamId:n.getId(),err:"invalid stream"}})()}));try{i.default.debug("[".concat(e.clientId,"] setParameter in distribution: ").concat(JSON.stringify(s))),Object.keys(s).map((function(e){return Object(r.setParameter)(e,s[e])}))}catch(t){i.default.debug("[".concat(e.clientId,"] setParameter in distribution failed: ").concat(JSON.stringify(s)))}}})),t}(t),Object(L.addLiveStreamingCapability)(t,e),e.areaCode){Object(r.setParameter)("AREA_SETTING",e.areaCode);var n=Object(P.getAreaDomainConfig)(e.areaCode);Object.keys(n).map((function(e){"LOG_UPLOAD_SERVER"==e||"EVENT_REPORT_DOMAIN"==e||"EVENT_REPORT_BACKUP_DOMAIN"==e||"NGINX"==e?Object(r.setParameter)(e,n[e][0]):Object(r.setParameter)(e,n[e])}))}return Object(B.isEmpty)(e.turnServer)||t.setTurnServer(e.turnServer),Object(B.isEmpty)(e.proxyServer)||t.setProxyServer(e.proxyServer),"live"===t.mode&&(t.gatewayClient.role="audience"),"rtc"===t.mode&&(t.gatewayClient.role=F),t.gatewayClient.on("onMultiIP",(function(e){t.gatewayClient.closeGateway(),t.gatewayClient.socket=void 0,t.gatewayClient.hasChangeBGPAddress=!0,t.joinInfo.multiIP=e.option,t.gatewayClient.state=_.a.CONNECTING;var n=function(e){i.default.info("[".concat(t.clientId,"] Joining channel: ").concat(t.channel)),t.joinInfo.cid=e.cid,t.joinInfo.uid||(t.joinInfo.uid=e.uid),t.joinInfo.uni_lbs_ip=e.uni_lbs_ip,t.joinInfo.gatewayAddr=e.gateway_addr,t.onSuccess?t.gatewayClient.join(t.joinInfo,t.key,(function(e){i.default.info("[".concat(t.clientId,"] Join channel ").concat(t.channel," success"));var n=t.onSuccess;t.onSuccess=null,t.onFailure=null,n(e)}),t.onFailure):(t.gatewayClient.joinInfo=E()({},t.joinInfo),t.gatewayClient.rejoin())};t.joinInfo.stringUid&&!t.joinInfo.uid?(t.userAccountReq&&!t.userAccountReq.isFinished()&&t.userAccountReq.cancel(),t.userAccountReq=Object(T.getUserAccount)(joinInfo,t.gatewayClient),t.userAccountReq.then((function(e){i.default.error("getUserAccount Success ".concat(e.url," ").concat(joinInfo.stringUid," => ").concat(e.uid)),t.joinInfo.uid=e.uid,Object(T.getGatewayList)(t.joinInfo,n,t.onFailure)})).catch((function(e){i.default.error("getUserAccount rejected",e),t.onFailure(e)}))):Object(T.getGatewayList)(t.joinInfo,n,t.onFailure)})),t.gatewayClient.on("rejoin-start",(function(){t._renewSession(),o.report.sessionInit(e.sessionId,{lts:(new Date).getTime(),extend:{rejoin:!0},cname:t.channel,appid:e.appId,mode:e.mode,succ:!0})})),t.gatewayClient.on("recover",(function(){t._renewSession(),console.log("recover",e.sessionId),o.report.sessionInit(e.sessionId,{lts:(new Date).getTime(),extend:{recover:!0},cname:t.channel,appid:e.appId,mode:e.mode,succ:!0})})),t.gatewayClient.on("rejoin",(function(){var e=t.highStreamState;if(i.default.debug("[".concat(t.clientId,"] Client local stream preState: ").concat(e)),t.onSuccess){var n=t.onSuccess;t.onSuccess=null,t.onFailure=null,n(t.joinInfo.uid)}!t.highStream||0!==e&&1!==e||(i.default.info("[".concat(t.clientId,"] publish after rejoin")),t.highStreamState=2,t.lowStreamState=2,t.publish(t.highStream,(function(e){e&&i.default.info("[".concat(t.clientId,"] "),e)})))})),t.gatewayClient.on("streamPublished",(function(e){t.hasPublished||(t.hasPublished=!0,t.gatewayClient.dispatchEvent({type:"stream-published",stream:e.stream,proxy:e.proxy}))})),t.gatewayClient.on("pubP2PLost",(function(e){i.default.debug("[".concat(t.clientId,"] Start reconnect local peerConnection: ").concat(t.highStream.getId())),t.gatewayClient.dispatchEvent({type:"stream-reconnect-start",uid:t.highStream.getId()}),1===t.highStreamState&&(t.highStreamState=0,t.lowStreamState=0),t._unpublish(t.highStream,(function(){t._publish(t.highStream,(function(){i.default.debug("[".concat(t.clientId,"] Reconnect local peerConnection success: ").concat(t.highStream.getId())),t.gatewayClient.dispatchEvent({type:"stream-reconnect-end",uid:t.highStream.getId(),success:!0,reason:""})}),(function(e){i.default.debug("[".concat(t.clientId,"] Reconnect local peerConnection failed: ").concat(e)),t.gatewayClient.dispatchEvent({type:"stream-reconnect-end",uid:t.highStream.getId(),success:!1,reason:e})}),!0)}),(function(e){i.default.debug("[".concat(t.clientId,"] Reconnect local peerConnection failed: ").concat(e)),t.gatewayClient.dispatchEvent({type:"stream-reconnect-end",uid:t.highStream.getId(),success:!1,reason:e})}),!0)})),t.gatewayClient.on("subP2PLost",(function(e){i.default.debug("[".concat(t.clientId,"] Start reconnect remote peerConnection: ").concat(e.stream.getId()," ").concat(e.stream.subscribeOptions)),t.gatewayClient.dispatchEvent({type:"stream-reconnect-start",uid:e.stream.getId()});var n=e.stream.subscribeOptions;console.log("Re-subscribe stream",n,e.stream),t.gatewayClient.unsubscribe(e.stream,(function(){e.stream.subscribeOptions=n,t.gatewayClient.subscribe(e.stream,(function(){i.default.debug("[".concat(t.clientId,"] Reconnect remote peerConnection success: ").concat(e.stream.getId())),t.gatewayClient.dispatchEvent({type:"stream-reconnect-end",uid:e.stream.getId(),success:!0,reason:""})}),(function(n){i.default.debug("[".concat(t.clientId,"] Reconnect remote peerConnection failed: "),n),t.gatewayClient.dispatchEvent({type:"stream-reconnect-end",uid:e.stream.getId(),success:!1,reason:n})}))}),(function(n){i.default.debug("[".concat(t.clientId,"] Reconnect remote peerConnection failed: "),n),t.gatewayClient.dispatchEvent({type:"stream-reconnect-end",uid:e.stream.getId(),success:!1,reason:n})}))})),M.on("networkTypeChanged",(function(e){t.gatewayClient&&t.gatewayClient.dispatchEvent(e);var n=E()({},e,{type:"network-type-changed"});t.gatewayClient.dispatchEvent(n)})),d.a.on("recordingDeviceChanged",(function(e){t.gatewayClient&&t.gatewayClient.dispatchEvent(e);var n=E()({},e,{type:"recording-device-changed"});t.gatewayClient.dispatchEvent(n)})),d.a.on("playoutDeviceChanged",(function(e){t.gatewayClient&&t.gatewayClient.dispatchEvent(e);var n=E()({},e,{type:"playout-device-changed"});t.gatewayClient.dispatchEvent(n)})),d.a.on("cameraChanged",(function(e){t.gatewayClient&&t.gatewayClient.dispatchEvent(e);var n=E()({},e,{type:"camera-changed"});t.gatewayClient.dispatchEvent(n)})),t.gatewayClient.on("streamTypeChange",(function(n){var r=E()({},n,{type:"stream-type-changed"});t.gatewayClient.dispatchEvent(r),o.report.reportApiInvoke(e.sessionId,{name:"streamTypeChange"})(null,JSON.stringify(n))})),t},j=function(e){switch(e){case"h264_interop":return"h264";default:return"vp8"}},V=function(e){return-1===A.indexOf(e.mode)?w.default.INVALID_CLIENT_MODE:-1===g.indexOf(e.codec)?w.default.INVALID_CLIENT_CODEC:"h264_interop"==e.mode&&"h264"!==e.codec&&w.default.CLIENT_MODE_CODEC_MISMATCH},Q=function(e){switch(e.mode){case"interop":case"h264_interop":e.mode="live";break;case"web-only":e.mode="rtc"}},G=d.a.getDevices,z=h.a.getScreenSources,K=JSON.parse(JSON.stringify(r.SUPPORT_RESOLUTION_LIST));t.default={TranscodingUser:{uid:0,x:0,y:0,width:0,height:0,zOrder:0,alpha:1},LiveTranscoding:{width:640,height:360,videoBitrate:400,videoFramerate:15,lowLatency:!1,audioSampleRate:48e3,audioBitrate:48,audioChannels:1,videoGop:30,videoCodecProfile:100,userCount:0,userConfigExtraInfo:{},backgroundColor:0,transcodingUsers:[]},createClient:function(e){var t=o.report.reportApiInvoke(null,{name:"createClient",options:arguments,tag:"tracer"});(e=E()({},e||{})).codec||(e.codec=j(e.mode));var n=V(e);if(n)throw i.default.error("Invalid parameter setting MODE: ".concat(e.mode," CODEC: ").concat(e.codec," ERROR ").concat(n)),t(n),new Error(n);return i.default.info("Creating client, MODE: ".concat(e.mode," CODEC: ").concat(e.codec)),Q(e),t(null,e),H(e)},createStream:l.b,Logger:i.default,report:o.report,getDevices:G,getScreenSources:z,getParameter:r.getParameter,setParameter:r.setParameter,checkSystemRequirements:function(){var e=o.report.reportApiInvoke(null,{name:"checkSystemRequirements",options:arguments,tag:"tracer"}),t=window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection,n=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.msGetUserMedia||navigator.mozGetUserMedia||navigator.mediaDevices&&navigator.mediaDevices.getUserMedia,r=window.WebSocket,a=!!t&&!!n&&!!r,c=!1;s.isChrome()&&s.getBrowserVersion()>=58&&"iOS"!==s.getBrowserOS()&&(c=!0),s.isFireFox()&&s.getBrowserVersion()>=56&&(c=!0),s.isOpera()&&s.getBrowserVersion()>=45&&(c=!0),s.isSafari()&&s.getBrowserVersion()>=11&&(c=!0),s.isEdge()&&(c=!0),(s.isWeChatBrowser()||s.isQQBrowser())&&"iOS"!==s.getBrowserOS()&&(c=!0),s.isSupportedPC()||s.isSupportedMobile()||(c=!1),i.default.debug(s.getBrowserInfo(),"isAPISupport: "+a+", isVendorAndVersionSupport: "+c);var u=a&&c;return e(null,u),u},getSupportedCodec:f.getSupportedCodec,ChannelMediaRelayConfiguration:p.ChannelMediaRelayConfiguration,VERSION:r.VERSION,BUILD:r.BUILD,PROFILE_TABLE:K,AUDIO_SAMPLE_RATE_32000:32e3,AUDIO_SAMPLE_RATE_44100:44100,AUDIO_SAMPLE_RATE_48000:48e3,VIDEO_CODEC_PROFILE_BASELINE:66,VIDEO_CODEC_PROFILE_MAIN:77,VIDEO_CODEC_PROFILE_HIGH:100,REMOTE_VIDEO_STREAM_HIGH:0,REMOTE_VIDEO_STREAM_LOW:1,REMOTE_VIDEO_STREAM_MEDIUM:2,AREAS:P.AREAS,AREA_VERSION:"global"}}]).default})),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).AgoraRTM=t()}(this,(function(){function R(e){return(R="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Pd(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,i)}function K(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){function o(e){Pd(s,r,i,o,a,"next",e)}function a(e){Pd(s,r,i,o,a,"throw",e)}var s=e.apply(t,n);o(void 0)}))}}function W(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function al(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ea(e,t,n){return t&&al(e.prototype,t),n&&al(e,n),e}function m(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function bl(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ja(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?bl(Object(n),!0).forEach((function(t){m(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):bl(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ka(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Qe(e,t)}function kd(e){return(kd=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Qe(e,t){return(Qe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function cl(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function Ch(e,t,n){return(Ch=cl()?Reflect.construct:function(e,t,n){var r=[null];return r.push.apply(r,t),e=new(Function.bind.apply(e,r)),n&&Qe(e,n.prototype),e}).apply(null,arguments)}function Re(e){var t="function"==typeof Map?new Map:void 0;return(Re=function(e){function n(){return Ch(e,arguments,kd(this).constructor)}if(null===e||-1===Function.toString.call(e).indexOf("[native code]"))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),Qe(n,e)})(e)}function Se(e,t){if(null==e)return{};if(null==e)var n={};else{n={};var r,i=Object.keys(e);for(r=0;r<i.length;r++){var o=i[r];0<=t.indexOf(o)||(n[o]=e[o])}}if(Object.getOwnPropertySymbols)for(r=Object.getOwnPropertySymbols(e),o=0;o<r.length;o++)i=r[o],0<=t.indexOf(i)||Object.prototype.propertyIsEnumerable.call(e,i)&&(n[i]=e[i]);return n}function n(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function la(e){var t=cl();return function(){var r=kd(e);if(t){var i=kd(this).constructor;r=Reflect.construct(r,arguments,i)}else r=r.apply(this,arguments);return!r||"object"!=typeof r&&"function"!=typeof r?n(this):r}}function Dh(e,t,n){return(Dh="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=kd(e)););if(e)return(t=Object.getOwnPropertyDescriptor(e,t)).get?t.get.call(n):t.value})(e,t,n||e)}function pa(e,t){var n=Array.isArray(e)?e:void 0;if(!n)if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){n=[];var r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}}else n=void 0;if(!(e=n||dl(e,t)))throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");return e}function I(e){var t=Array.isArray(e)?Eh(e):void 0;if(t||(t="undefined"!=typeof Symbol&&Symbol.iterator in Object(e)?Array.from(e):void 0),!(e=t||dl(e)))throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");return e}function dl(e,t){if(e){if("string"==typeof e)return Eh(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Eh(e,t)}}function Eh(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function da(e,t,n,r,i){var o={};return Object.keys(r).forEach((function(e){o[e]=r[e]})),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),o),i&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(i):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null),o}function Xa(e){var t={exports:{}};return e(t,t.exports),t.exports}function el(e,t){var n,r=3>arguments.length?e:arguments[2];return qa(e)===r?e[t]:(n=Db.f(e,t))?P(n,"value")?n.value:void 0===n.get?void 0:n.get.call(r):ea(n=Rb(e))?el(n,t,r):void 0}function Nr(e){var t=e.charCodeAt(0)<<24,n=0|Or(~t),r=0,i=0|e.length,o="";if(5>n&&i>=n){for(t=t<<n>>>24+n,r=1;r<n;r=r+1|0)t=t<<6|63&e.charCodeAt(r);65535>=t?o+=ld(t):1114111>=t?o+=ld(55296+((t=t-65536|0)>>10)|0,56320+(1023&t)|0):r=0}for(;r<i;r=r+1|0)o+="�";return o}function fl(){}function Pr(e){var t=0|e.charCodeAt(0);if(55296<=t&&56319>=t){var n=0|e.charCodeAt(1);if(!(n==n&&56320<=n&&57343>=n))return ld(239,191,189);if(65535<(t=(t-55296<<10)+n-56320+65536|0))return ld(240|t>>>18,128|t>>>12&63,128|t>>>6&63,128|63&t)}return 127>=t?e:2047>=t?ld(192|t>>>6,128|63&t):ld(224|t>>>12,128|t>>>6&63,128|63&t)}function gl(){}function aa(){aa.init.call(this)}function Zf(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+R(e))}function hl(e,t,n,r){Zf(n);var i=e._events;if(void 0===i)i=e._events=Object.create(null),e._eventsCount=0;else{void 0!==i.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),i=e._events);var o=i[t]}return void 0===o?(i[t]=n,++e._eventsCount):("function"==typeof o?o=i[t]=r?[n,o]:[o,n]:r?o.unshift(n):o.push(n),0<(n=void 0===e._maxListeners?aa.defaultMaxListeners:e._maxListeners)&&o.length>n&&!o.warned&&(o.warned=!0,(n=Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit")).name="MaxListenersExceededWarning",n.emitter=e,n.type=t,n.count=o.length,console&&console.warn&&console.warn(n))),e}function Qr(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function il(e,t,n){return e={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},(t=Qr.bind(e)).listener=n,e.wrapFn=t}function jl(e,t,n){if(void 0===(e=e._events))return[];if(void 0===(t=e[t]))return[];if("function"==typeof t)return n?[t.listener||t]:[t];if(n)for(n=Array(t.length),e=0;e<n.length;++e)n[e]=t[e].listener||t[e];else n=kl(t,t.length);return n}function ll(e){var t=this._events;if(void 0!==t){if("function"==typeof(e=t[e]))return 1;if(void 0!==e)return e.length}return 0}function kl(e,t){for(var n=Array(t),r=0;r<t;++r)n[r]=e[r];return n}function Rr(e){return e?I(e):Sr((function(){return[]}),(function(e,t){return e.push(t),e}))}function ml(e,t){var n,r,i,o;return w.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:n=nl(e)([Fh,Fh,function(e,t){return t}])[2],r=0;case 2:if(!(r<t.length)){a.next=17;break}if(i=t[r],!((o=n(Gh,i))instanceof $f)){a.next=11;break}if((o=Hh(o.deref()))===Gh){a.next=10;break}return a.next=10,o;case 10:return a.abrupt("return");case 11:if(o===Gh){a.next=14;break}return a.next=14,o;case 14:r++,a.next=2;break;case 17:case"end":return a.stop()}}),Tr)}function ag(e,t){return null!=t&&"function"==typeof t[Symbol.iterator]?ml(ag(e),t):function(t){var n=t[2];return Ur(t,(function(t,r){return n(t,e(r))}))}}function md(e){return"Object"===Object.prototype.toString.call(e).slice(8,-1)&&e.constructor===Object&&Object.getPrototypeOf(e)===Object.prototype}function nd(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Qd(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Rd(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Te(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new bg;++t<n;)this.add(e[t])}function Sd(e){this.size=(this.__data__=new cg(e)).size}function dg(e,t,n,r,i,o){var a,s=1&t,c=2&t,u=4&t;if(n&&(a=i?n(e,r,i,o):n(e)),void 0!==a)return a;if(!jb(e))return e;if(r=Ya(e)){if(a=Vr(e),!s)return Ih(e,a)}else{var l=Ue(e),d="[object Function]"==l||"[object GeneratorFunction]"==l;if(Ve(e))return ol(e,s);if("[object Object]"==l||"[object Arguments]"==l||d&&!i){if(a=c||d?{}:pl(e),!s)return c?Wr(e,Xr(a,e)):Yr(e,Zr(a,e))}else{if(!ra[l])return i?e:{};a=$r(e,l,s)}}if(o||(o=new Td),i=o.get(e))return i;o.set(e,a),as(e)?e.forEach((function(r){a.add(dg(r,t,n,r,e,o))})):bs(e)&&e.forEach((function(r,i){a.set(i,dg(r,t,n,i,e,o))})),c=u?c?ql:Jh:c?We:Rc;var h=r?void 0:c(e);return cs(h||e,(function(r,i){h&&(r=e[i=r]),rl(a,i,dg(r,t,n,i,e,o))})),a}function Kh(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError("Expected a function");var n=function n(){var r=arguments,i=t?t.apply(this,r):r[0],o=n.cache;return o.has(i)?o.get(i):(r=e.apply(this,r),n.cache=o.set(i,r)||o,r)};return n.cache=new(Kh.Cache||bg),n}function sl(e){if("string"==typeof e)return e;if(Ya(e))return Ud(e,sl)+"";if(Vd(e))return tl?tl.call(e):"";var t=e+"";return"0"==t&&1/e==-ds?"-0":t}function Lh(e,t,n,r,i){var o=-1,a=e.length;for(n||(n=es),i||(i=[]);++o<a;){var s=e[o];0<t&&n(s)?1<t?Lh(s,t-1,n,r,i):Mh(i,s):r||(i[i.length]=s)}return i}function Wd(e,t,n,r,i){if(e===t)t=!0;else if(null==e||null==t||!cc(e)&&!cc(t))t=e!=e&&t!=t;else e:{var o=Ya(e),a=Ya(t),s=o?"[object Array]":Ue(e),c=a?"[object Array]":Ue(t),u="[object Object]"==(s="[object Arguments]"==s?"[object Object]":s);if(a="[object Object]"==(c="[object Arguments]"==c?"[object Object]":c),(c=s==c)&&Ve(e)){if(!Ve(t)){t=!1;break e}o=!0,u=!1}if(c&&!u)i||(i=new Td),t=o||Nh(e)?ul(e,t,n,r,Wd,i):fs(e,t,s,n,r,Wd,i);else{if(!(1&n)&&(o=u&&vl.call(e,"__wrapped__"),s=a&&vl.call(t,"__wrapped__"),o||s)){e=o?e.value():e,t=s?t.value():t,i||(i=new Td),t=Wd(e,t,n,r,i);break e}if(c)t:if(i||(i=new Td),o=1&n,s=Jh(e),a=s.length,c=Jh(t).length,a==c||o){for(c=a;c--;){var l=s[c];if(!(o?l in t:gs.call(t,l))){t=!1;break t}}if(u=i.get(e),l=i.get(t),u&&l)t=u==t&&l==e;else{u=!0,i.set(e,t),i.set(t,e);for(var d=o;++c<a;){var h=e[l=s[c]],f=t[l];if(r)var p=o?r(f,h,l,t,e,i):r(h,f,l,e,t,i);if(void 0===p?h!==f&&!Wd(h,f,n,r,i):!p){u=!1;break}d||(d="constructor"==l)}u&&!d&&(n=e.constructor)!=(r=t.constructor)&&"constructor"in e&&"constructor"in t&&!("function"==typeof n&&n instanceof n&&"function"==typeof r&&r instanceof r)&&(u=!1),i.delete(e),i.delete(t),t=u}}else t=!1;else t=!1}}return t}function sa(e,t,n){this.low=0|e,this.high=0|t,this.unsigned=!!n}function kb(e){return!0===(e&&e.__isLong__)}function od(e,t){var n;if(t){if((t=0<=(e>>>=0)&&256>e)&&(n=wl[e]))return n;n=ta(e,0>(0|e)?-1:0,!0),t&&(wl[e]=n)}else{if((t=-128<=(e|=0)&&128>e)&&(n=xl[e]))return n;n=ta(e,0>e?-1:0,!1),t&&(xl[e]=n)}return n}function Eb(e,t){if(isNaN(e))return t?pd:Fb;if(t){if(0>e)return pd;if(e>=yl)return zl}else{if(e<=-Al)return lb;if(e+1>=Al)return Bl}return 0>e?Eb(-e,t).neg():ta(e%Xd|0,e/Xd|0,t)}function ta(e,t,n){return new sa(e,t,n)}function Oh(e,t,n){if(0===e.length)throw Error("empty string");if("NaN"===e||"Infinity"===e||"+Infinity"===e||"-Infinity"===e)return Fb;if("number"==typeof t?(n=t,t=!1):t=!!t,2>(n=n||10)||36<n)throw RangeError("radix");var r;if(0<(r=e.indexOf("-")))throw Error("interior hyphen");if(0===r)return Oh(e.substring(1),t,n).neg();r=Eb(eg(n,8));for(var i=Fb,o=0;o<e.length;o+=8){var a=Math.min(8,e.length-o),s=parseInt(e.substring(o,o+a),n);8>a?(a=Eb(eg(n,a)),i=i.mul(a).add(Eb(s))):i=(i=i.mul(r)).add(Eb(s))}return i.unsigned=t,i}function Sb(e,t){return"number"==typeof e?Eb(e,t):"string"==typeof e?Oh(e,t):ta(e.low,e.high,"boolean"==typeof t?t:e.unsigned)}function M(e,t){function n(){this.constructor=e}Ph(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}function Yd(e){return"function"==typeof e}function Zd(e){setTimeout((function(){throw e}),0)}function Qh(e){return null!==e&&"object"===R(e)}function Cl(e){return e.reduce((function(e,t){return e.concat(t instanceof Xe?t.errors:t)}),[])}function Rh(e){for(;e;){var t=e.destination,n=e.isStopped;if(e.closed||n)return!1;e=t&&t instanceof fa?t:null}return!0}function Sc(e){return e}function Sh(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Dl(e)}function Dl(e){return 0===e.length?Sc:1===e.length?e[0]:function(t){return e.reduce((function(e,t){return t(e)}),t)}}function El(e){if(e||(e=Gb.Promise||Promise),!e)throw Error("no Promise impl found");return e}function Fl(){return function(e){return e.lift(new hs(e))}}function Ye(e){return e?is(e):dc}function is(e){return new V((function(t){return e.schedule((function(){return t.complete()}))}))}function Tc(e){return e&&"function"==typeof e.schedule}function Th(e,t){return new V((function(n){var r=new Ka,i=0;return r.add(t.schedule((function(){i===e.length?n.complete():(n.next(e[i++]),n.closed||r.add(this.schedule()))}))),r}))}function Ze(e,t){return t?Th(e,t):new V(Gl(e))}function mb(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Tc(t=e[e.length-1])?(e.pop(),Th(e,t)):Ze(e)}function ba(e,t){return new V(t?function(n){return t.schedule(js,0,{error:e,subscriber:n})}:function(t){return t.error(e)})}function js(e){e.subscriber.error(e.error)}function ks(e,t){return void 0===t&&(t=0),function(n){return n.lift(new ls(e,t))}}function Hl(e){return e in Uh&&(delete Uh[e],!0)}function ec(){}function Z(e,t){return function(n){if("function"!=typeof e)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return n.lift(new ms(e,t))}}function Il(e,t,n){if(t){if(!Tc(t))return function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];return Il(e,n).apply(void 0,r).pipe(Z((function(e){return Hb(e)?t.apply(void 0,e):t(e)})))};n=t}return function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var i,o=this,a={context:o,subject:i,callbackFunc:e,scheduler:n};return new V((function(r){if(n)return n.schedule(ns,0,{args:t,subscriber:r,params:a});if(!i){i=new $e;try{e.apply(o,t.concat([function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];i.next(1>=e.length?e[0]:e),i.complete()}]))}catch(e){Rh(i)?i.error(e):console.warn(e)}}return i.subscribe(r)}))}}function ns(e){var t=this,n=e.args,r=e.subscriber,i=e.params;e=i.callbackFunc;var o=i.context,a=i.scheduler,s=i.subject;if(!s){s=i.subject=new $e,i=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];t.add(a.schedule(os,0,{value:1>=e.length?e[0]:e,subject:s}))};try{e.apply(o,n.concat([i]))}catch(e){s.error(e)}}this.add(s.subscribe(r))}function os(e){var t=e.subject;t.next(e.value),t.complete()}function Jl(e,t,n){if(t){if(!Tc(t))return function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];return Jl(e,n).apply(void 0,r).pipe(Z((function(e){return Hb(e)?t.apply(void 0,e):t(e)})))};n=t}return function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var i={subject:void 0,args:t,callbackFunc:e,scheduler:n,context:this};return new V((function(r){var o=i.context,a=i.subject;if(n)return n.schedule(ps,0,{params:i,subscriber:r,context:o});if(!a){a=i.subject=new $e;try{e.apply(o,t.concat([function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];(t=e.shift())?a.error(t):(a.next(1>=e.length?e[0]:e),a.complete())}]))}catch(e){Rh(a)?a.error(e):console.warn(e)}}return a.subscribe(r)}))}}function ps(e){var t=this,n=e.params,r=e.subscriber;e=e.context;var i=n.callbackFunc,o=n.args,a=n.scheduler,s=n.subject;if(!s){s=n.subject=new $e,n=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];(n=e.shift())?t.add(a.schedule(Kl,0,{err:n,subject:s})):t.add(a.schedule(qs,0,{value:1>=e.length?e[0]:e,subject:s}))};try{i.apply(e,o.concat([n]))}catch(e){this.add(a.schedule(Kl,0,{err:e,subject:s}))}}this.add(s.subscribe(r))}function qs(e){var t=e.subject;t.next(e.value),t.complete()}function Kl(e){e.subject.error(e.err)}function Ll(e){return!!e&&"function"!=typeof e.subscribe&&"function"==typeof e.then}function Vh(e,t,n,r,i){if(void 0===i&&(i=new rs(e,n,r)),!i.closed)return t instanceof V?t.subscribe(i):af(t)(i)}function ss(e,t){return new V((function(n){var r=new Ka;return r.add(t.schedule((function(){var i=e[$d]();r.add(i.subscribe({next:function(e){r.add(t.schedule((function(){return n.next(e)})))},error:function(e){r.add(t.schedule((function(){return n.error(e)})))},complete:function(){r.add(t.schedule((function(){return n.complete()})))}}))}))),r}))}function ts(e,t){return new V((function(n){var r=new Ka;return r.add(t.schedule((function(){return e.then((function(e){r.add(t.schedule((function(){n.next(e),r.add(t.schedule((function(){return n.complete()})))})))}),(function(e){r.add(t.schedule((function(){return n.error(e)})))}))}))),r}))}function us(e,t){if(!e)throw Error("Iterable cannot be null");return new V((function(n){var r,i=new Ka;return i.add((function(){r&&"function"==typeof r.return&&r.return()})),i.add(t.schedule((function(){r=e[Uc](),i.add(t.schedule((function(){if(!n.closed){try{var e=r.next(),t=e.value,i=e.done}catch(e){return void n.error(e)}i?n.complete():(n.next(t),this.schedule())}})))}))),i}))}function Ml(e,t){if(null!=e){if(e&&"function"==typeof e[$d])return ss(e,t);if(Ll(e))return ts(e,t);if(Nl(e))return Th(e,t);if(e&&"function"==typeof e[Uc]||"string"==typeof e)return us(e,t)}throw new TypeError((null!==e&&R(e)||e)+" is not observable")}function Ib(e,t){return t?Ml(e,t):e instanceof V?e:new V(af(e))}function fc(e,t){if(!t.closed)return e instanceof V?e.subscribe(t):af(e)(t)}function eb(e,t,n){return void 0===n&&(n=Number.POSITIVE_INFINITY),"function"==typeof t?function(r){return r.pipe(eb((function(n,r){return Ib(e(n,r)).pipe(Z((function(e,i){return t(n,e,r,i)})))}),n))}:("number"==typeof t&&(n=t),function(t){return t.lift(new vs(e,n))})}function Wh(e){return void 0===e&&(e=Number.POSITIVE_INFINITY),eb(Sc,e)}function Ol(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Wh(1)(mb.apply(void 0,e))}function qd(e){return new V((function(t){try{var n=e()}catch(e){return void t.error(e)}return(n?Ib(n):Ye()).subscribe(t)}))}function Pl(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(1===e.length){var n=e[0];if(Hb(n))return fg(n,null);if(Qh(n)&&Object.getPrototypeOf(n)===Object.prototype)return fg((e=Object.keys(n)).map((function(e){return n[e]})),e)}if("function"==typeof e[e.length-1]){var r=e.pop();return fg(e=1===e.length&&Hb(e[0])?e[0]:e,null).pipe(Z((function(e){return r.apply(void 0,e)})))}return fg(e,null)}function fg(e,t){return new V((function(n){var r=e.length;if(0===r)n.complete();else for(var i=Array(r),o=0,a=0,s=function(s){var c=Ib(e[s]),u=!1;n.add(c.subscribe({next:function(e){u||(u=!0,a++),i[s]=e},error:function(e){return n.error(e)},complete:function(){++o!==r&&u||(a===r&&n.next(t?t.reduce((function(e,t,n){return e[t]=i[n],e}),{}):i),n.complete())}}))},c=0;c<r;c++)s(c)}))}function fb(e,t,n,r){return Yd(n)&&(r=n,n=void 0),r?fb(e,t,n).pipe(Z((function(e){return Hb(e)?r.apply(void 0,e):r(e)}))):new V((function(r){Ql(e,t,(function(e){1<arguments.length?r.next(Array.prototype.slice.call(arguments)):r.next(e)}),r,n)}))}function Ql(e,t,n,r,i){if(e&&"function"==typeof e.addEventListener&&"function"==typeof e.removeEventListener){e.addEventListener(t,n,i);var o=function(){return e.removeEventListener(t,n,i)}}else if(e&&"function"==typeof e.on&&"function"==typeof e.off)e.on(t,n),o=function(){return e.off(t,n)};else if(e&&"function"==typeof e.addListener&&"function"==typeof e.removeListener)e.addListener(t,n),o=function(){return e.removeListener(t,n)};else{if(!e||!e.length)throw new TypeError("Invalid event target");for(var a=0,s=e.length;a<s;a++)Ql(e[a],t,n,r,i)}r.add(o)}function Rl(e,t,n){return n?Rl(e,t).pipe(Z((function(e){return Hb(e)?n.apply(void 0,e):n(e)}))):new V((function(n){var r=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return n.next(1===e.length?e[0]:e)};try{var i=e(r)}catch(e){return void n.error(e)}if(Yd(t))return function(){return t(r,i)}}))}function ws(e){var t=e.subscriber,n=e.condition;if(!t.closed){if(e.needIterate)try{e.state=e.iterate(e.state)}catch(e){return void t.error(e)}else e.needIterate=!0;if(n){var r=void 0;try{r=n(e.state)}catch(e){return void t.error(e)}if(!r)return void t.complete();if(t.closed)return}try{var i=e.resultSelector(e.state)}catch(e){return void t.error(e)}if(!t.closed&&(t.next(i),!t.closed))return this.schedule(e)}}function Xh(e){return!Hb(e)&&0<=e-parseFloat(e)+1}function Sl(e,t){return void 0===e&&(e=0),void 0===t&&(t=Vc),(!Xh(e)||0>e)&&(e=0),t&&"function"==typeof t.schedule||(t=Vc),new V((function(n){return n.add(t.schedule(xs,e,{subscriber:n,counter:0,period:e})),n}))}function xs(e){var t=e.subscriber,n=e.counter;e=e.period,t.next(n),this.schedule({subscriber:t,counter:n+1,period:e},e)}function Tb(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];t=Number.POSITIVE_INFINITY;var n=null,r=e[e.length-1];return Tc(r)?(n=e.pop(),1<e.length&&"number"==typeof e[e.length-1]&&(t=e.pop())):"number"==typeof r&&(t=e.pop()),null===n&&1===e.length&&e[0]instanceof V?e[0]:Wh(t)(Ze(e,n))}function Yh(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(0===e.length)return dc;var n=e[0],r=e.slice(1);return 1===e.length&&Hb(n)?Yh.apply(void 0,n):new V((function(e){var t=function(){return e.add(Yh.apply(void 0,r).subscribe(e))};return Ib(n).subscribe({next:function(t){e.next(t)},error:t,complete:t})}))}function ys(e){var t=e.keys,n=e.index,r=e.subscriber,i=e.subscription;if(e=e.obj,!r.closed)if(n<t.length){var o=t[n];r.next([o,e[o]]),i.add(this.schedule({keys:t,index:n+1,subscriber:r,subscription:i,obj:e}))}else r.complete()}function zs(e,t){function n(){return!n.pred.apply(n.thisArg,arguments)}return n.pred=e,n.thisArg=t,n}function nb(e,t){return function(n){return n.lift(new As(e,t))}}function ya(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(1===e.length){if(!Hb(e[0]))return e[0];e=e[0]}return Ze(e,void 0).lift(new Bs)}function Cs(e){var t=e.start,n=e.index,r=e.subscriber;n>=e.count?r.complete():(r.next(t),r.closed||(e.index=n+1,e.start=t+1,this.schedule(e)))}function uc(e,t,n){void 0===e&&(e=0);var r=-1;return Xh(t)?r=1>Number(t)?1:Number(t):Tc(t)&&(n=t),Tc(n)||(n=Vc),new V((function(t){var i=Xh(e)?e:+e-n.now();return n.schedule(Ds,i,{index:0,period:r,subscriber:t})}))}function Ds(e){var t=e.index,n=e.period,r=e.subscriber;if(r.next(t),!r.closed){if(-1===n)return r.complete();e.index=t+1,this.schedule(e,n)}}function Zh(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return"function"==typeof(t=e[e.length-1])&&e.pop(),Ze(e,void 0).lift(new Es(t))}function Ga(e){return function(t){var n=new Fs(e);return t=t.lift(n),n.caught=t}}function $h(e,t){return eb(e,t,1)}function Tl(e){return void 0===e&&(e=null),function(t){return t.lift(new Gs(e))}}function Wc(e,t){void 0===t&&(t=Vc);var n=e instanceof Date&&!isNaN(+e)?+e-t.now():Math.abs(e);return function(e){return e.lift(new Hs(n,t))}}function Ul(e,t){return function(n){return n.lift(new Is(e,t))}}function rd(e){return void 0===e&&(e=Js),function(t){return t.lift(new Ks(e))}}function Js(){return new gg}function Pa(e){return function(t){return 0===e?Ye():t.lift(new Ls(e))}}function Vl(e,t){return t?function(n){return n.pipe(Vl((function(n,r){return Ib(e(n,r)).pipe(Z((function(e,i){return t(n,e,r,i)})))})))}:function(t){return t.lift(new Ms(e))}}function hg(e){return function(t){return t.lift(new Ns(e))}}function X(e,t){var n=2<=arguments.length;return function(r){return r.pipe(e?nb((function(t,n){return e(t,n,r)})):Sc,Pa(1),n?Tl(t):rd((function(){return new gg})))}}function Os(){return function(e){return e.lift(new Ps)}}function Wl(e){return function(t){return 0===e?Ye():t.lift(new Qs(e))}}function bf(e){return function(t){return t.lift(new Rs(e))}}function ig(e,t){var n=!1;return 2<=arguments.length&&(n=!0),function(r){return r.lift(new Ss(e,t,n))}}function Xl(e,t){return 2<=arguments.length?function(n){return Sh(ig(e,t),Wl(1),Tl(t))(n)}:function(t){return Sh(ig((function(t,n,r){return e(t,n,r+1)})),Wl(1))(t)}}function Ts(e,t){return function(n){var r="function"==typeof e?e:function(){return e};if("function"==typeof t)return n.lift(new Us(r,t));var i=Object.create(n,Vs);return i.source=n,i.subjectFactory=r,i}}function ae(e){return function(t){return t.lift(new Ws(e,t))}}function Xs(){return new La}function be(){return function(e){return Fl()(Ts(Xs)(e))}}function Yl(e,t,n){var r=e&&"object"===R(e)?e:{bufferSize:e,windowTime:t,refCount:!1,scheduler:n};return function(e){return e.lift(Ys(r))}}function Ys(e){var t,n,r=e.bufferSize,i=void 0===r?Number.POSITIVE_INFINITY:r,o=void 0===(r=e.windowTime)?Number.POSITIVE_INFINITY:r,a=e.refCount,s=e.scheduler,c=0,u=!1,l=!1;return function(e){if(c++,!t||u){u=!1;var r=(t=new ce(i,o,s)).subscribe(this);n=e.subscribe({next:function(e){t.next(e)},error:function(e){u=!0,t.error(e)},complete:function(){l=!0,n=void 0,t.complete()}})}else r=t.subscribe(this);this.add((function(){c--,r.unsubscribe(),n&&!l&&a&&0===c&&(n.unsubscribe(),t=n=void 0)}))}}function vc(e,t){return"function"==typeof t?function(n){return n.pipe(vc((function(n,r){return Ib(e(n,r)).pipe(Z((function(e,i){return t(n,e,r,i)})))})))}:function(t){return t.lift(new Zs(e))}}function ob(e){return function(t){return t.lift(new $s(e))}}function at(e,t){return void 0===t&&(t=!1),function(n){return n.lift(new bt(e,t))}}function Y(e,t,n){return function(r){return r.lift(new ct(e,t,n))}}function dt(e,t,n){return void 0===t&&(t=Vc),void 0===n&&(n=et),function(r){return r.lift(new ft(e,t,n.leading,n.trailing))}}function gt(e){e.subscriber.clearThrottle()}function ht(e,t,n){return void 0===n&&(n=Vc),function(r){var i=e instanceof Date&&!isNaN(+e),o=i?+e-n.now():Math.abs(e);return r.lift(new it(o,i,t,n))}}function Za(e,t){return void 0===t&&(t=Vc),ht(e,ba(new pb),t)}function jt(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return function(t){var n;return"function"==typeof e[e.length-1]&&(n=e.pop()),t.lift(new kt(e,n))}}function Zl(e,t,n,r,i){e!==t&&$l(t,(function(o,a){if(i||(i=new Td),jb(o)){o=i;var s=ai(e,a),c=ai(t,a),u=o.get(c);if(u)bi(e,a,u);else{var l=void 0===(u=r?r(s,c,a+"",e,t,o):void 0);if(l){var d=Ya(c),h=!d&&Ve(c),f=!d&&!h&&Nh(c);u=c,d||h||f?Ya(s)?u=s:cc(s)&&sd(s)?u=Ih(s):h?(l=!1,u=ol(c,!0)):f?(l=!1,u=am(c,!0)):u=[]:bm(c)||cf(c)?(u=s,cf(s)?u=de(s,We(s)):jb(s)&&!ci(s)||(u=pl(c))):l=!1}l&&(o.set(c,u),Zl(u,c,n,r,o),o.delete(c)),bi(e,a,u)}}else void 0===(s=r?r(ai(e,a),o,a+"",e,t,i):void 0)&&(s=o),bi(e,a,s)}),We)}function lt(e){var t=1,n=di;1==(1>=arguments.length?0:arguments.length-1)?"number"==typeof(1>=arguments.length?void 0:arguments[1])?t=1>=arguments.length?void 0:arguments[1]:n=1>=arguments.length?void 0:arguments[1]:2==(1>=arguments.length?0:arguments.length-1)&&(t=1>=arguments.length?void 0:arguments[1],n=2>=arguments.length?void 0:arguments[2]);var r=t||1;return function(t){return t.pipe(ig((function(t,i){var o=n.now(),a=o-e;if((t=t.filter((function(e){return e.until>a}))).length>=r){var s=t[t.length-1],c=t[0].until+e*Math.floor(t.length/r);t.push({delay:s.until<o?c-o:c-s.until,until:c,value:i})}else t.push({delay:0,until:o,value:i});return t}),[]),Z((function(e){return e[e.length-1]})),$h((function(e){var t=mb(e.value);return e.delay?t.pipe(Wc(e.delay,n)):t})))}}function mt(e,t){var n=(t=void 0===t?{protocols:cm,makeWebSocket:dm}:t).protocols,r=void 0===n?cm:n,i=void 0===(t=t.makeWebSocket)?dm:t;return new V((function(t){var n,o=new La,a=i(e,r),s=!1,c=!1,u=function(e){if(n)throw s=!0,e=Error("Web socket message factory function called more than once"),t.error(e),e;return n=e.subscribe((function(e){a.send(e)})),o};return a.onopen=function(){c?(s=!0,a.close()):t.next(u)},a.onmessage=function(e){o.next(e.data)},a.onerror=function(e){s=!0,t.error(Error(e.message))},a.onclose=function(e){s||(s=!0,c?(t.complete(),o.complete()):t.error(Error(1e3===e.code?"Normal closure":e.reason)))},function(){c=!0,n&&n.unsubscribe(),s||(s=!0,a.close())}}))}function jg(){this._listeners={}}function em(e){return"undefined"!=typeof Float32Array?function(){function t(e,t,n){o[0]=e,t[n]=a[0],t[n+1]=a[1],t[n+2]=a[2],t[n+3]=a[3]}function n(e,t,n){o[0]=e,t[n]=a[3],t[n+1]=a[2],t[n+2]=a[1],t[n+3]=a[0]}function r(e,t){return a[0]=e[t],a[1]=e[t+1],a[2]=e[t+2],a[3]=e[t+3],o[0]}function i(e,t){return a[3]=e[t],a[2]=e[t+1],a[1]=e[t+2],a[0]=e[t+3],o[0]}var o=new Float32Array([-0]),a=new Uint8Array(o.buffer),s=128===a[3];e.writeFloatLE=s?t:n,e.writeFloatBE=s?n:t,e.readFloatLE=s?r:i,e.readFloatBE=s?i:r}():function(){function t(e,t,n,r){var i=0>t?1:0;if(i&&(t=-t),0===t)e(0<1/t?0:2147483648,n,r);else if(isNaN(t))e(2143289344,n,r);else if(34028234663852886e22<t)e((i<<31|2139095040)>>>0,n,r);else if(11754943508222875e-54>t)e((i<<31|Math.round(t/1401298464324817e-60))>>>0,n,r);else{var o=Math.floor(Math.log(t)/Math.LN2);e((i<<31|o+127<<23|8388607&Math.round(t*Math.pow(2,-o)*8388608))>>>0,n,r)}}function n(e,t,n){return n=e(t,n),e=2*(n>>31)+1,t=n>>>23&255,n&=8388607,255===t?n?NaN:1/0*e:0===t?1401298464324817e-60*e*n:e*Math.pow(2,t-150)*(n+8388608)}e.writeFloatLE=t.bind(null,fm),e.writeFloatBE=t.bind(null,gm),e.readFloatLE=n.bind(null,hm),e.readFloatBE=n.bind(null,im)}(),"undefined"!=typeof Float64Array?function(){function t(e,t,n){o[0]=e,t[n]=a[0],t[n+1]=a[1],t[n+2]=a[2],t[n+3]=a[3],t[n+4]=a[4],t[n+5]=a[5],t[n+6]=a[6],t[n+7]=a[7]}function n(e,t,n){o[0]=e,t[n]=a[7],t[n+1]=a[6],t[n+2]=a[5],t[n+3]=a[4],t[n+4]=a[3],t[n+5]=a[2],t[n+6]=a[1],t[n+7]=a[0]}function r(e,t){return a[0]=e[t],a[1]=e[t+1],a[2]=e[t+2],a[3]=e[t+3],a[4]=e[t+4],a[5]=e[t+5],a[6]=e[t+6],a[7]=e[t+7],o[0]}function i(e,t){return a[7]=e[t],a[6]=e[t+1],a[5]=e[t+2],a[4]=e[t+3],a[3]=e[t+4],a[2]=e[t+5],a[1]=e[t+6],a[0]=e[t+7],o[0]}var o=new Float64Array([-0]),a=new Uint8Array(o.buffer),s=128===a[7];e.writeDoubleLE=s?t:n,e.writeDoubleBE=s?n:t,e.readDoubleLE=s?r:i,e.readDoubleBE=s?i:r}():function(){function t(e,t,n,r,i,o){var a=0>r?1:0;if(a&&(r=-r),0===r)e(0,i,o+t),e(0<1/r?0:2147483648,i,o+n);else if(isNaN(r))e(0,i,o+t),e(2146959360,i,o+n);else if(17976931348623157e292<r)e(0,i,o+t),e((a<<31|2146435072)>>>0,i,o+n);else if(22250738585072014e-324>r)e((r/=5e-324)>>>0,i,o+t),e((a<<31|r/4294967296)>>>0,i,o+n);else{var s=Math.floor(Math.log(r)/Math.LN2);1024===s&&(s=1023),e(4503599627370496*(r*=Math.pow(2,-s))>>>0,i,o+t),e((a<<31|s+1023<<20|1048576*r&1048575)>>>0,i,o+n)}}function n(e,t,n,r,i){return t=e(r,i+t),r=e(r,i+n),e=2*(r>>31)+1,t=4294967296*(1048575&r)+t,2047==(n=r>>>20&2047)?t?NaN:1/0*e:0===n?5e-324*e*t:e*Math.pow(2,n-1075)*(t+4503599627370496)}e.writeDoubleLE=t.bind(null,fm,0,4),e.writeDoubleBE=t.bind(null,gm,4,0),e.readDoubleLE=n.bind(null,hm,0,4),e.readDoubleBE=n.bind(null,im,4,0)}(),e}function fm(e,t,n){t[n]=255&e,t[n+1]=e>>>8&255,t[n+2]=e>>>16&255,t[n+3]=e>>>24}function gm(e,t,n){t[n]=e>>>24,t[n+1]=e>>>16&255,t[n+2]=e>>>8&255,t[n+3]=255&e}function hm(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0}function im(e,t){return(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0}function Ra(e,t){this.lo=e>>>0,this.hi=t>>>0}function df(e,t,n){this.fn=e,this.len=t,this.next=void 0,this.val=n}function ei(){}function nt(e){this.head=e.head,this.tail=e.tail,this.len=e.len,this.next=e.states}function ha(){this.len=0,this.tail=this.head=new df(ei,0,0),this.states=null}function fi(e,t,n){t[n]=255&e}function gi(e,t){this.len=e,this.next=void 0,this.val=t}function hi(e,t,n){for(;e.hi;)t[n++]=127&e.lo|128,e.lo=(e.lo>>>7|e.hi<<25)>>>0,e.hi>>>=7;for(;127<e.lo;)t[n++]=127&e.lo|128,e.lo>>>=7;t[n++]=e.lo}function ii(e,t,n){t[n]=255&e,t[n+1]=e>>>8&255,t[n+2]=e>>>16&255,t[n+3]=e>>>24}function gc(){ji.call(this)}function ot(e,t,n){40>e.length?T.utf8.write(e,t,n):t.utf8Write?t.utf8Write(e,n):t.write(e,n)}function Ub(e,t){return RangeError("index out of range: "+e.pos+" + "+(t||1)+" > "+e.len)}function Ha(e){this.buf=e,this.pos=0,this.len=e.length}function ki(){var e=new jm(0,0),t=0;if(!(4<this.len-this.pos)){for(;3>t;++t){if(this.pos>=this.len)throw Ub(this);if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,128>this.buf[this.pos++])return e}return e.lo=(e.lo|(127&this.buf[this.pos++])<<7*t)>>>0,e}for(;4>t;++t)if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,128>this.buf[this.pos++])return e;if(e.lo=(e.lo|(127&this.buf[this.pos])<<28)>>>0,e.hi=(e.hi|(127&this.buf[this.pos])>>4)>>>0,128>this.buf[this.pos++])return e;if(t=0,4<this.len-this.pos){for(;5>t;++t)if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,128>this.buf[this.pos++])return e}else for(;5>t;++t){if(this.pos>=this.len)throw Ub(this);if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,128>this.buf[this.pos++])return e}throw Error("invalid varint encoding")}function kg(e,t){return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0}function km(){if(this.pos+8>this.len)throw Ub(this,8);return new jm(kg(this.buf,this.pos+=4),kg(this.buf,this.pos+=4))}function td(e){li.call(this,e)}function ef(e,t,n){if("function"!=typeof e)throw TypeError("rpcImpl must be a function");T.EventEmitter.call(this),this.rpcImpl=e,this.requestDelimited=!!t,this.responseDelimited=!!n}function ua(e){return"string"==typeof e&&/^[\s\w!#$%&()+,.:;<=>?@[\]^{|}~-]{1,64}$/.test(e)&&"null"!==e}function pt(e){try{var t=e.split(".").map((function(e){return Number(e)}))}catch(e){return!1}if(4!==t.length||0===t[0])return!1;for(e=0;e<t.length;e++){var n=t[e];if(!Number.isInteger(n)||0>n||255<n)return!1}return!0}function lm(e,t){if(!Array.isArray(t)||0===t.length||32<t.length||t.some((function(e){return 0===e.length||32<e.length})))throw new L("arguments is not valid",Fa);if(!ua(e))throw new L("ID is invalid",Fa)}function ff(e){var t=e.attributes,n=e.attrSizeMap,r=e.maxAttrsCount,i=e.maxAttrValueSize;if(e=e.maxTotalSize,!md(t))throw new L("attributes must be an object",Fa);if(Object.keys(t).length>r)throw new gb("Exceed the limit of ".concat(r," attributes"),ee);if(0===Object.keys(t).length)throw new L("The attributes is an empty object",Fa);var o=0,a=0;for(t=Object.entries(t);a<t.length;a++){var s=pa(t[a],2),c=s[1];s=new Blob([s[0]]).size;var u=new Blob([c]).size;if(0===s||32<s)throw new L("Invalid attribute key",Fa);if(u>i)throw new gb("Invalid attribute value, over the limit of ".concat(i," bytes"),ee);if("string"!=typeof c||0===c.length)throw new L("Invalid attribute value",Fa);o+=s,o+=u}if(o>e)throw new gb("The attributes size overflow",ee);if(void 0!==n){if(Object.keys(n).length>r)throw new gb("Exceed the limit of ".concat(r," attributes"),ee);for(o=r=0,n=Object.entries(n);o<n.length;o++){if(a=(t=pa(n[o],2))[1],0===(t=new Blob([t[0]]).size))throw new L("Invalid attribute key",Fa);if(a>i)throw new gb("Invalid attribute value, over the limit of ".concat(i," bytes"),ee);r+=t,r+=a}if(r>e)throw new gb("The attributes size overflow",ee)}}function mi(e,t){return Math.floor(Math.random()*(Math.floor(t)-Math.ceil(e)+1))+e}function lg(){var e=mi(0,4294967295),t=mi(1,4294967295);return new U(e,t,!0)}function Sa(e){return e.toString().padEnd(32,"0")}function mm(e,t){return new TypeError("Unexpected ".concat(e,": ").concat(t))}function nm(e,t){return e=e.split(".").map((function(e){return Number(e)})),t=t.split(".").map((function(e){return Number(e)})),Math.sqrt(1e3*Math.pow(e[0]-t[0],2)+100*Math.pow(e[1]-t[1],2)+10*Math.pow(e[2]-t[2],2)+1*Math.pow(e[3]-t[3],2))}function om(e){return e.lessThanOrEqual(Number.MAX_SAFE_INTEGER)?e.toNumber():e.toString()}function pm(e,t){t="".concat(e).concat(t||"");var n=qm.get(t)||1;return qm.set(t,n+1),"".concat(e).concat(n)}function rm(e,t){var n="number"==typeof t?t:void 0!==t&&"string"!=typeof t?t.code:void 0;return t="number"!=typeof t&&"string"!=typeof t&&void 0!==t&&void 0!==t.serverCode?t.serverCode:void 0,n="".concat(void 0!==n?" Error Code ".concat(n):"").concat(void 0!==t?", server Code ".concat(t):""),e="string"==typeof e&&e?mg(e):Array.isArray(e)&&"string"==typeof e[0]&&e[0]?mg(sm.apply(void 0,[e[0]].concat(I(e.slice(1))))):"","".concat(""===n?"":"".concat(n," - ")).concat(e)}function tm(e){return ni.apply(this,arguments)}function ni(){return(ni=K(w.mark((function e(t){return w.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){setTimeout((function(){e()}),t)})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function um(e){return e instanceof Blob||"[object Blob]"===Object.prototype.toString.call(e)}function ng(e){var t=255&e,n=e>>8&255,r=e>>16&255;return"".concat(e>>24&255,".").concat(r,".").concat(n,".").concat(t)}function gf(e,t,n){return oi.apply(this,arguments)}function oi(){return(oi=K(w.mark((function e(t,n,r){var i,o,a,s,c,u,l,d,h,f,p,A,g,v,m,y,b,E,_,S,T,R,C,I,x,O;return w.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=n.body,o=n.headers,a=void 0===o?{}:o,s=n.timeout,c=void 0===s?1e4:s,u=n.signal,l=n.withCredentials,d=void 0!==l&&l,h=(r||{}).useBinaryResponse,f=void 0!==h&&h,(p=new XMLHttpRequest).open("POST",t,!0),p.responseType=f?"arraybuffer":"text",p.withCredentials=d,p.timeout=c,A=i instanceof FormData,g=i instanceof Uint8Array,!(1<(v=Object.keys(a).filter((function(e){return"content-type"===e.toLowerCase()}))).length)){e.next=14;break}throw new RangeError("multiple content-type");case 14:0===v.length&&(g?a["Content-Type"]="application/octet-stream":A||(a["Content-Type"]="application/json"));case 15:if("setRequestHeader"in p){e.next=46;break}return p.abort(),e.next=19,fetch(t,{body:A||g?i:JSON.stringify(i),cache:"no-cache",credentials:d?"include":"same-origin",headers:a,method:"POST",mode:"cors",referrer:"no-referrer",signal:u});case 19:if(m=e.sent,!(200<=(y=m.status)&&300>y||304===y)){e.next=31;break}if(!f){e.next=27;break}return e.next=25,m.arrayBuffer();case 25:return b=e.sent,e.abrupt("return",{status:y,responseData:b});case 27:return e.next=29,m.text();case 29:return E=e.sent,e.abrupt("return",{status:y,responseText:E});case 31:return _=new ca(["Post XHR failure, status %d",y]),e.prev=32,e.next=35,m.text();case 35:throw S=e.sent,_.statusCode=y,_.message=S||"Request failed, status ".concat(y),_;case 41:throw e.prev=41,e.t0=e.catch(32),_.statusCode=y,_.message="Request failed, status ".concat(y),_;case 46:if(0!==Object.keys(a).length)for(T=0,R=Object.entries(a);T<R.length;T++)C=pa(R[T],2),I=C[0],x=C[1],p.setRequestHeader(I,x);return void 0!==u&&(O=function e(){p.abort(),u.removeEventListener("abort",e)},u.addEventListener("abort",O)),A||g?p.send(i):p.send(JSON.stringify(i)),e.abrupt("return",new Promise((function(e,t){p.onload=function(){var n=p.status;if(200<=n&&300>n||304===n)e(f?{status:n,responseData:p.response}:{status:n,responseText:p.responseText});else{var r=new ca(["Post XHR failure, status %d",n]);r.statusCode=n,r.message=p.response||"Request failed, status ".concat(p.status),t(r)}},p.ontimeout=function(e){t(new bb(["XHR request timed out after %d ms",c],{originalError:e}))},p.onerror=function(){var e=new ca(["Post XHR failure, status %d",p.status]);e.statusCode=p.status,e.message=p.response||"Request failed, status ".concat(p.status),t(e)},p.onabort=function(){try{t(new DOMException("The request aborted.","AbortError"))}catch(n){var e=Error("The request aborted.");e.name="AbortError",t(e)}}})));case 50:case"end":return e.stop()}}),e,null,[[32,41]])})))).apply(this,arguments)}function wm(e){return ui.apply(this,arguments)}function ui(){return(ui=K(w.mark((function e(t){var n;return w.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=new Image).src=t,e.abrupt("return",new Promise((function(e,t){n.onload=function(){e({width:n.width,height:n.height})},n.onerror=t})));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function st(e,t){return vi.apply(this,arguments)}function vi(){return(vi=K(w.mark((function e(t,n){var r,i,o,a,s,c,u,l,d,h;return w.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.thumbnailHeight,i=void 0===r?0:r,o=t.thumbnailWidth,a=void 0===o?0:o,s=t.width,c=void 0===s?0:s,u=t.height,l=void 0===u?0:u,d=t.thumbnail,h=[],"number"==typeof i&&"number"==typeof a&&"number"==typeof c&&"number"==typeof l){e.next=5;break}throw new L("Invalid message params",jf);case 5:return 0>=c&&0>=l&&h.push(wm(xm(n)).then((function(e){c=e.width,l=e.height}))),0>=a&&0>=i&&void 0!==d&&h.push(wi(d).then(function(){var e=K(w.mark((function e(t){var n;return w.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,wm(xm(t));case 2:n=e.sent,a=n.width,i=n.height;case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())),e.next=9,Promise.all(h).catch((function(){}));case 9:return e.abrupt("return",{width:c,height:l,thumbnailWidth:a,thumbnailHeight:i});case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ym(e,t){if(!md(e))throw new L("message object is not a plain object",t);if(void 0===e.messageType)if(e.rawMessage instanceof Uint8Array){if(e.messageType="RAW",void 0!==e.text)throw new L("Raw messages cannot have text property. Use description instead",t)}else{if("string"!=typeof e.text)throw new L("messageType is undefined",t);if(e.messageType="TEXT",void 0!==e.rawMessage)throw new L("Text messages cannot have rawMessage property",t)}}function pg(e){return xi.apply(this,arguments)}function xi(){return(xi=K(w.mark((function e(t){var n,r,i,o,a,s,c,u,l,d,h,f,p,A,g,v,m,y,b,E,_;return w.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.message,r=t.peerId,i=t.toPeer,o=t.session,a=t.errorCodes,s=t.diff,c=t.logger,u=t.options,void 0!==o){e.next=3;break}throw new H("The client is not logged in. Cannot do the operation",a.NOT_LOGGED_IN);case 3:if(l=!1,"TEXT"!==n.messageType||!n.text.startsWith("AgoraRTMLegacyEndcallCompatibleMessagePrefix")||!i){e.next=11;break}if(d=n.text.split("_"),h=pa(d,3),f=h[0],p=h[1],void 0!==h[2]&&ua(p)&&"AgoraRTMLegacyEndcallCompatibleMessagePrefix"===f){e.next=10;break}throw new L("Message is not valid",ge);case 10:l=!0;case 11:if(A=Date.now(),g=o.messageSentTimes.length-1,!((v=o.messageSentTimes[g])&&v+3e3<A)){e.next=18;break}o.messageSentTimes=[A],e.next=29;break;case 18:m=g;case 19:if(!(0<=m)){e.next=28;break}if(!(o.messageSentTimes[m]+3e3<A)){e.next=23;break}return o.messageSentTimes=o.messageSentTimes.slice(m+1,g+1),e.abrupt("break",28);case 23:if(!(180<=g-m+1)){e.next=25;break}throw new gb("Message sent failed, exceeded the 180 message in 3 seconds",a.TOO_OFTEN);case 25:m--,e.next=19;break;case 28:o.messageSentTimes.push(A);case 29:e.t0=n.messageType,e.next="TEXT"===e.t0?32:"RAW"===e.t0?37:"FILE"===e.t0||"IMAGE"===e.t0?39:40;break;case 32:if(!l){e.next=36;break}return y=n.text.split("_"),b=pa(y,3),E=b[1],_=b[2],c.info("[rtm-API] EndCall message send api is called"),e.abrupt("return",o.sendInvitationMessage({peerId:r,type:"CallCancel",extra:_,channelId:E,callId:"0"}));case 36:return e.abrupt("return",o.sendTextMessage(n.text,r,i,u,1e4-s));case 37:return void 0===n.description&&(n.description=""),e.abrupt("return",o.sendRawMessage(n.rawMessage,n.description,r,i,u,1e4-s));case 39:return e.abrupt("return",o.sendMediaMessage(n.messageType,n,r,i,u,1e4-s));case 40:throw new L("Invalid message type",ge);case 41:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function tt(e){var t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1],n=e.replace(/(https?:\/\/)?(www.)?/i,"");return t||(n=n.split(".").slice(e.length-2).join(".")),-1!==n.indexOf("/")?n.split("/")[0]:n}function qg(e,t){function n(n){if(void 0===e)return e;if(!Array.isArray(n)&&!md(n))return n;if(Array.isArray(n))return qg(n,t);var r={},i=0;for(n=Object.entries(n);i<n.length;i++){var o=pa(n[i],2),a=o[1];r[o[0]]=null==a?a:qg(a,t)}return rg(r,t)}return 2<arguments.length&&(t=Array.prototype.slice.call(arguments).slice(1)),Array.isArray(e)?e.map(n):n(e)}function zm(e){return Object.getOwnPropertyNames(e).forEach((function(t){"object"==R(t=e[t])&&null!==t&&zm(t)})),Object.freeze(e)}function na(e){return new TextDecoder("utf-8").decode(e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength))}function sg(e){return(new TextEncoder).encode(e).length}function Am(){for(var e=0,t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];for(t=0;t<n.length;t++)e+=n[t].length;for(e=new Uint8Array(e),r=t=0;r<n.length;r++){var i=n[r];e.set(i,t),t+=i.length}return e}function Bm(e,t,n){var r=e.match(/([^?#]+)(\?[^#]*)?(#.*)?/);if(e=null==r?void 0:r[1],r=null==r?void 0:r[2]){var i;for(r=r.substr(1).split("&"),i=0;i<r.length;i++)if(r[i].split("=")[0]==t){r[i]=t+"="+encodeURIComponent(n);break}return i==r.length&&r.push(t+"="+encodeURIComponent(n)),e+"?"+r.join("&")}return e+"?"+t+"="+encodeURIComponent(n)}function wi(e){return new Promise((function(t,n){var r=new FileReader;r.onloadend=function(){var e=r.result||new ArrayBuffer(0);t(e)},r.onerror=n,r.readAsArrayBuffer(e)}))}function ut(e,t){e=e=[e],"string"==typeof(t=t||{})&&(t={type:t});try{var n=new Blob(e,t)}catch(i){if("TypeError"!==i.name)throw i;n=new("undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder);for(var r=0;r<e.length;r+=1)n.append(e[r]);n=n.getBlob(t.type)}return n}function Cm(e){var t=[];return function e(n){if(null===n||"object"!==R(n))return n;if(-1!==t.indexOf(n))return"[Circular]";if(t.push(n),"function"==typeof n.toJSON)try{var r=e(n.toJSON());return t.pop(),r}catch(e){return"[Throws: "+(e?e.message:"?")+"]"}return Array.isArray(n)?(r=n.map(e),t.pop(),r):(r=Object.keys(n).reduce((function(t,r){e:{if(vt.call(n,r))try{var i=n[r];break e}catch(e){i="[Throws: "+(e?e.message:"?")+"]";break e}i=n[r]}return t[r]=e(i),t}),{}),t.pop(),r)}(e)}function wt(e){if(!(100<(e=String(e)).length)&&(e=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e))){var t=parseFloat(e[1]);switch((e[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*t;case"weeks":case"week":case"w":return 6048e5*t;case"days":case"day":case"d":return 864e5*t;case"hours":case"hour":case"hrs":case"hr":case"h":return 36e5*t;case"minutes":case"minute":case"mins":case"min":case"m":return 6e4*t;case"seconds":case"second":case"secs":case"sec":case"s":return 1e3*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return t}}}function tg(e,t,n,r){return Math.round(e/n)+" "+r+(t>=1.5*n?"s":"")}function ia(e,t,n){void 0===n&&(n=Object.getOwnPropertyDescriptor(e,t));var r=n.value;return n.value=function(){for(var e=this,n=arguments.length,i=Array(n),o=0;o<n;o++)i[o]=arguments[o];this.invokeTracker.apply(this,["%s: ".concat(0<i.length?"%s with args: ".concat(i.map((function(){return"%o"}))):"%s"),this.name,t].concat(i));try{var a=r.apply(this,i)}catch(e){throw this.logError.apply(this,["".concat(void 0!==e.code?"Error Code ".concat(e.code,": "):"","%s failed").concat(0<i.length?" with args: ".concat(i.map((function(){return"%o"}))):""),t].concat(i)),e.originalError&&this.logError(e.originalError),this.errorTracker(e),e}var s=Date.now();return K(w.mark((function n(){var r,o;return w.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,a;case 3:r=n.sent,n.next=12;break;case 6:return n.prev=6,n.t0=n.catch(0),e.logError.apply(e,["".concat(void 0!==n.t0.code?"Error Code ".concat(n.t0.code,": "):"","%s failed").concat(0<i.length?" with args: ".concat(i.map((function(){return"%o"}))):""),t].concat(i)),n.t0.originalError&&e.logError(n.t0.originalError),e.errorTracker(n.t0),n.abrupt("return");case 12:r!==a?void 0===r?e.resultTracker("%s promise resolves after %dms",t,Date.now()-s):e.resultTracker("%s promise resolves after %dms, result is %o",t,Date.now()-s,r):"Object"!==Object.prototype.toString.call(r).slice(8,-1)||md(r)?e.resultTracker("%s result is %o",t,r):e.resultTracker("%s result is %s",t,r.name||(null===(o=r.constructor)||void 0===o?void 0:o.name));case 13:case"end":return n.stop()}}),n,null,[[0,6]])})))(),a},n}function xt(e,t){var n="".concat(e,"Uri");if("number"!=typeof(n=yi[n])||0===n)throw new TypeError("Got Unknown URI Name");return t=new(e=Dm[e])(t),t=e.encode(t).finish(),new yt({uri:n,data:t})}function cb(e,t,n,r){return zi.apply(this,arguments)}function zi(){return(zi=K(w.mark((function e(t,n,r,i){var o,a;return w.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.next=2;break;case 2:return o=zt[t].encode(n).finish(),a=function(){var e=K(w.mark((function e(n){var r,i,s=arguments;return w.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(2<(r=1<s.length&&void 0!==s[1]?s[1]:0))){e.next=3;break}return e.abrupt("return");case 3:return i=Bm(i="https://".concat(n,":6443/events/proto-raw"),"sentTs",Math.ceil(Date.now()/1e3).toString()),i=Bm(i,"id",At[t].toString()),e.next=8,gf(i,{body:o,timeout:2e4,headers:{"Content-Type":"application/octet-stream"}}).catch((function(e){return a(n,r+1)}));case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),e.prev=4,e.next=7,a(r||"webcollector-rtm.agora.io");case 7:e.next=13;break;case 9:return e.prev=9,e.t0=e.catch(4),e.next=13,a(i||"webcollector-rtm.agoraio.cn");case 13:case"end":return e.stop()}}),e,null,[[4,9]])})))).apply(this,arguments)}function db(e){return void 0===e?U.fromNumber(0):U.fromNumber(Date.now()-e)}function Bt(e){return btoa(String.fromCharCode.apply({},e.replace(/\r|\n/g,"").replace(/([\dA-Fa-f]{2}) ?/g,"0x$1 ").replace(/ +$/,"").split(" ").map((function(e){return parseInt(e,16)})))).replace(/={1,2}$/,"")}function ug(e,t){return U.fromValue(e).eq(t)}function vg(e,t){var n=void 0===t?e.val:t,r=e.isBoolean;t=e.isNumber;var i=e.oneof,o=e.len;if(2!==[r,t,i].filter((function(e){return!e})).length)throw new TypeError("invalid field type");if(void 0!==n&&(e=!1,void 0!==i&&(i=null==i?[]:Em(i,Rc(i)),Ct(i,ug).length===i.length&&void 0!==Dt(i,(function(e){return ug(n,e)}))&&(e=!0)),r=void 0!==r&&(0===n||1===n)&&1===o,t=void 0!==t&&n.toString(2).length<=o,!(e||r||t)))throw Error("invalid field value")}function Fm(e){return function(){var t=e();if(!t)throw new H("Client is not logged in. Cannot do the operation");return t}}var Ta="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},wg=function(e){return e&&e.Math==Math&&e},B=wg("object"==typeof globalThis&&globalThis)||wg("object"==typeof window&&window)||wg("object"==typeof self&&self)||wg("object"==typeof Ta&&Ta)||function(){return this}()||Function("return this")(),O=function(e){try{return!!e()}catch(e){return!0}},ja=!O((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]})),Gm={}.propertyIsEnumerable,Hm=Object.getOwnPropertyDescriptor,kf=Hm&&!Gm.call({1:2},1)?function(e){return!!(e=Hm(this,e))&&e.enumerable}:Gm,Xc=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}},Et={}.toString,Vb=function(e){return Et.call(e).slice(8,-1)},Ft="".split,lf=O((function(){return!Object("z").propertyIsEnumerable(0)}))?function(e){return"String"==Vb(e)?Ft.call(e,""):Object(e)}:Object,hb=function(e){if(null==e)throw TypeError("Can't call method on "+e);return e},rb=function(e){return lf(hb(e))},ea=function(e){return"object"==typeof e?null!==e:"function"==typeof e},hc=function(e,t){if(!ea(e))return e;var n,r;if(t&&"function"==typeof(n=e.toString)&&!ea(r=n.call(e))||"function"==typeof(n=e.valueOf)&&!ea(r=n.call(e))||!t&&"function"==typeof(n=e.toString)&&!ea(r=n.call(e)))return r;throw TypeError("Can't convert object to primitive value")},Gt={}.hasOwnProperty,P=function(e,t){return Gt.call(e,t)},he=B.document,xg=ea(he)&&ea(he.createElement),Im=!ja&&!O((function(){return 7!=Object.defineProperty(xg?he.createElement("div"):{},"a",{get:function(){return 7}}).a})),Jm=Object.getOwnPropertyDescriptor,Db={f:ja?Jm:function(e,t){if(e=rb(e),t=hc(t,!0),Im)try{return Jm(e,t)}catch(e){}if(P(e,t))return Xc(!kf.call(e,t),e[t])}},qa=function(e){if(!ea(e))throw TypeError(String(e)+" is not an object");return e},Km=Object.defineProperty,Ma={f:ja?Km:function(e,t,n){if(qa(e),t=hc(t,!0),qa(n),Im)try{return Km(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported");return"value"in n&&(e[t]=n.value),e}},Ia=ja?function(e,t,n){return Ma.f(e,t,Xc(1,n))}:function(e,t,n){return e[t]=n,e},Ai=function(e,t){try{Ia(B,e,t)}catch(n){B[e]=t}return t},ud=B["__core-js_shared__"]||Ai("__core-js_shared__",{}),Ht=Function.toString;"function"!=typeof ud.inspectSource&&(ud.inspectSource=function(e){return Ht.call(e)});var Bi=ud.inspectSource,Lm=B.WeakMap,It="function"==typeof Lm&&/native code/.test(Bi(Lm)),vd=Xa((function(e){(e.exports=function(e,t){return ud[e]||(ud[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.9.0",mode:"global",copyright:"© 2021 Denis Pushkarev (zloirock.ru)"})})),Jt=0,Kt=Math.random(),ie=function(e){return"Symbol("+String(void 0===e?"":e)+")_"+(++Jt+Kt).toString(36)},Mm=vd("keys"),yg=function(e){return Mm[e]||(Mm[e]=ie(e))},je={},Lt=B.WeakMap;if(It)var ke=ud.state||(ud.state=new Lt),Mt=ke.get,Nt=ke.has,Ot=ke.set,Ci=function(e,t){return t.facade=e,Ot.call(ke,e,t),t},zg=function(e){return Mt.call(ke,e)||{}},Di=function(e){return Nt.call(ke,e)};else{var mf=yg("state");je[mf]=!0,Ci=function(e,t){return t.facade=e,Ia(e,mf,t),t},zg=function(e){return P(e,mf)?e[mf]:{}},Di=function(e){return P(e,mf)}}var Ua={set:Ci,get:zg,has:Di,enforce:function(e){return Di(e)?zg(e):Ci(e,{})},getterFor:function(e){return function(t){var n;if(!ea(t)||(n=zg(t)).type!==e)throw TypeError("Incompatible receiver, "+e+" required");return n}}},Va=Xa((function(e){var t=Ua.get,n=Ua.enforce,r=String(String).split("String");(e.exports=function(e,t,i,o){var a=!!o&&!!o.unsafe,s=!!o&&!!o.enumerable;if(o=!!o&&!!o.noTargetGet,"function"==typeof i){"string"!=typeof t||P(i,"name")||Ia(i,"name",t);var c=n(i);c.source||(c.source=r.join("string"==typeof t?t:""))}e===B?s?e[t]=i:Ai(t,i):(a?!o&&e[t]&&(s=!0):delete e[t],s?e[t]=i:Ia(e,t,i))})(Function.prototype,"toString",(function(){return"function"==typeof this&&t(this).source||Bi(this)}))})),Nm=function(e){return"function"==typeof e?e:void 0},Wb=function(e,t){return 2>arguments.length?Nm(B[e])||Nm(B[e]):B[e]&&B[e][t]||B[e]&&B[e][t]},Pt=Math.ceil,Qt=Math.floor,ic=function(e){return isNaN(e=+e)?0:(0<e?Qt:Pt)(e)},Rt=Math.min,za=function(e){return 0<e?Rt(ic(e),9007199254740991):0},St=Math.max,Tt=Math.min,xb=function(e,t){return 0>(e=ic(e))?St(e+t,0):Tt(e,t)},Om=function(e){return function(t,n,r){t=rb(t);var i=za(t.length);if(r=xb(r,i),e&&n!=n){for(;i>r;)if((n=t[r++])!=n)return!0}else for(;i>r;r++)if((e||r in t)&&t[r]===n)return e||r||0;return!e&&-1}},Pm=Om(!0),Ei=Om(!1),Qm=function(e,t){e=rb(e);var n,r=0,i=[];for(n in e)!P(je,n)&&P(e,n)&&i.push(n);for(;t.length>r;)P(e,n=t[r++])&&(~Ei(i,n)||i.push(n));return i},Ag="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" "),Ut=Ag.concat("length","prototype"),wd={f:Object.getOwnPropertyNames||function(e){return Qm(e,Ut)}},nf={f:Object.getOwnPropertySymbols},Rm=Wb("Reflect","ownKeys")||function(e){var t=wd.f(qa(e)),n=nf.f;return n?t.concat(n(e)):t},Sm=function(e,t){for(var n=Rm(t),r=Ma.f,i=Db.f,o=0;o<n.length;o++){var a=n[o];P(e,a)||r(e,a,i(t,a))}},Vt=/#|\.prototype\./,jc=function(e,t){return(e=Wt[Xt(e)])==Yt||e!=Zt&&("function"==typeof t?O(t):!!t)},Xt=jc.normalize=function(e){return String(e).replace(Vt,".").toLowerCase()},Wt=jc.data={},Zt=jc.NATIVE="N",Yt=jc.POLYFILL="P",$t=Db.f,N=function(e,t){var n,r,i,o=e.target,a=e.global,s=e.stat;if(r=a?B:s?B[o]||Ai(o,{}):(B[o]||{}).prototype)for(i in t){var c=t[i],u=e.noTargetGet?(n=$t(r,i))&&n.value:r[i];if(!(n=jc(a?i:o+(s?".":"#")+i,e.forced))&&void 0!==u){if(typeof c==typeof u)continue;Sm(c,u)}(e.sham||u&&u.sham)&&Ia(c,"sham",!0);try{Va(r,i,c,e)}catch(e){}}},le=function(e,t){var n=[][e];return!!n&&O((function(){n.call(null,t||function(){throw 1},1)}))},au=[].join,bu=lf!=Object,cu=le("join",",");N({target:"Array",proto:!0,forced:bu||!cu},{join:function(e){return au.call(rb(this),void 0===e?",":e)}}),N({target:"Number",stat:!0},{MAX_SAFE_INTEGER:9007199254740991}),N({target:"Number",stat:!0},{isNaN:function(e){return e!=e}}),B.Number.isNaN;var wc=B.Promise,of=function(e,t,n){for(var r in t)Va(e,r,t[r],n);return e},xc=!!Object.getOwnPropertySymbols&&!O((function(){return!String(Symbol())})),Tm=xc&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,Bg=vd("wks"),pf=B.Symbol,du=Tm?pf:pf&&pf.withoutSetter||ie,oa=function(e){return P(Bg,e)||(xc&&P(pf,e)?Bg[e]=pf[e]:Bg[e]=du("Symbol."+e)),Bg[e]},eu=Ma.f,Um=oa("toStringTag"),yc=function(e,t,n){e&&!P(e=n?e:e.prototype,Um)&&eu(e,Um,{configurable:!0,value:t})},Vm=oa("species"),qf=function(e){e=Wb(e);var t=Ma.f;ja&&e&&!e[Vm]&&t(e,Vm,{configurable:!0,get:function(){return this}})},yb=function(e){if("function"!=typeof e)throw TypeError(String(e)+" is not a function");return e},zc=function(e,t,n){if(!(e instanceof t))throw TypeError("Incorrect "+(n?n+" ":"")+"invocation");return e},me={},fu=oa("iterator"),gu=Array.prototype,Fi=function(e){return void 0!==e&&(me.Array===e||gu[fu]===e)},ne=function(e,t,n){if(yb(e),void 0===t)return e;switch(n){case 0:return function(){return e.call(t)};case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,i){return e.call(t,n,r,i)}}return function(){return e.apply(t,arguments)}},hu=oa("toStringTag"),Wm={};Wm[hu]="z";var Gi="[object z]"===String(Wm),iu=oa("toStringTag"),ju="Arguments"==Vb(function(){return arguments}()),rf=Gi?Vb:function(e){var t;if(void 0===e)var n="Undefined";else{if(null===e)var r="Null";else{e:{var i=e=Object(e);try{r=i[iu];break e}catch(e){}r=void 0}r="string"==typeof(n=r)?n:ju?Vb(e):"Object"==(t=Vb(e))&&"function"==typeof e.callee?"Arguments":t}n=r}return n},ku=oa("iterator"),Hi=function(e){if(null!=e)return e[ku]||e["@@iterator"]||me[rf(e)]},Ii=function(e){var t=e.return;if(void 0!==t)return qa(t.call(e)).value},sf=function(e,t){this.stopped=e,this.result=t},Cg=function(e,t,n){var r,i=!(!n||!n.AS_ENTRIES),o=!(!n||!n.IS_ITERATOR),a=!(!n||!n.INTERRUPTED),s=ne(t,n&&n.that,1+i+a),c=function(e){return u&&Ii(u),new sf(!0,e)};if(t=function(e){return i?(qa(e),a?s(e[0],e[1],c):s(e[0],e[1])):a?s(e,c):s(e)},o)var u=e;else{if("function"!=typeof(o=Hi(e)))throw TypeError("Target is not iterable");if(Fi(o)){for(o=0,n=za(e.length);n>o;o++)if((r=t(e[o]))&&r instanceof sf)return r;return new sf(!1)}u=o.call(e)}for(e=u.next;!(o=e.call(u)).done;){try{r=t(o.value)}catch(e){throw Ii(u),e}if("object"==typeof r&&r&&r instanceof sf)return r}return new sf(!1)},Xm=oa("iterator"),Ym=!1;try{var lu=0,Zm={next:function(){return{done:!!lu++}},return:function(){Ym=!0}};Zm[Xm]=function(){return this},Array.from(Zm,(function(){throw 2}))}catch(c){}var Dg=function(e,t){if(!t&&!Ym)return!1;var n=!1;try{(t={})[Xm]=function(){return{next:function(){return{done:n=!0}}}},e(t)}catch(e){}return n},mu=oa("species"),Yc=function(e,t){var n;return void 0===(e=qa(e).constructor)||null==(n=qa(e)[mu])?t:yb(n)},Ji=Wb("document","documentElement"),oe=Wb("navigator","userAgent")||"",$m=/(iphone|ipod|ipad).*applewebkit/i.test(oe),kc="process"==Vb(B.process),Eg=B.location,Ki=B.setImmediate,an=B.clearImmediate,nu=B.process,bn=B.MessageChannel,Li=B.Dispatch,Mi=0,tf={},Ni=function(e){if(tf.hasOwnProperty(e)){var t=tf[e];delete tf[e],t()}},Oi=function(e){return function(){Ni(e)}},cn=function(e){Ni(e.data)},dn=function(e){B.postMessage(e+"",Eg.protocol+"//"+Eg.host)};if(!Ki||!an)if(Ki=function(e){for(var t=[],n=1;arguments.length>n;)t.push(arguments[n++]);return tf[++Mi]=function(){("function"==typeof e?e:Function(e)).apply(void 0,t)},uf(Mi),Mi},an=function(e){delete tf[e]},kc)var uf=function(e){nu.nextTick(Oi(e))};else if(Li&&Li.now)uf=function(e){Li.now(Oi(e))};else if(bn&&!$m){var en=new bn,fn=en.port2;en.port1.onmessage=cn,uf=ne(fn.postMessage,fn,1)}else B.addEventListener&&"function"==typeof postMessage&&!B.importScripts&&Eg&&"file:"!==Eg.protocol&&!O(dn)?(uf=dn,B.addEventListener("message",cn,!1)):uf="onreadystatechange"in(xg?he.createElement("script"):{})?function(e){Ji.appendChild(xg?he.createElement("script"):{}).onreadystatechange=function(){Ji.removeChild(this),Ni(e)}}:function(e){setTimeout(Oi(e),0)};var Pi=Ki,ou=/web0s(?!.*chrome)/i.test(oe),pu=Db.f,gn=B.MutationObserver||B.WebKitMutationObserver,hn=B.document,jn=B.process,Qi=B.Promise,kn=pu(B,"queueMicrotask"),ln=kn&&kn.value,xd,vf;if(!ln){var Gg=function(){var e;for(kc&&(e=jn.domain)&&e.exit();xd;){var t=xd.fn;xd=xd.next;try{t()}catch(e){throw xd?Fg():vf=void 0,e}}vf=void 0,e&&e.enter()};if($m||kc||ou||!gn||!hn)if(Qi&&Qi.resolve)var mn=Qi.resolve(void 0),qu=mn.then,Fg=function(){qu.call(mn,Gg)};else Fg=kc?function(){jn.nextTick(Gg)}:function(){Pi.call(B,Gg)};else{var nn=!0,on=hn.createTextNode("");new gn(Gg).observe(on,{characterData:!0}),Fg=function(){on.data=nn=!nn}}}var pn=ln||function(e){e={fn:e,next:void 0},vf&&(vf.next=e),xd||(xd=e,Fg()),vf=e},ru=function(e){var t,n;this.promise=new e((function(e,r){if(void 0!==t||void 0!==n)throw TypeError("Bad Promise constructor");t=e,n=r})),this.resolve=yb(t),this.reject=yb(n)},Ri={f:function(e){return new ru(e)}},Hg=function(e,t){return qa(e),ea(t)&&t.constructor===e?t:((0,(e=Ri.f(e)).resolve)(t),e.promise)},su=function(e,t){var n=B.console;n&&n.error&&(1===arguments.length?n.error(e):n.error(e,t))},Si=function(e){try{return{error:!1,value:e()}}catch(e){return{error:!0,value:e}}},qn=B.process,rn=qn&&qn.versions,sn=rn&&rn.v8;if(sn)var yd=sn.split("."),Ti=yd[0]+yd[1];else oe&&(yd=oe.match(/Edge\/(\d+)/),(!yd||74<=yd[1])&&(yd=oe.match(/Chrome\/(\d+)/))&&(Ti=yd[1]));var pe=Ti&&+Ti,tu=oa("species"),tn=Ua.get,uu=Ua.set,vu=Ua.getterFor("Promise"),sb=wc,un=B.TypeError,Ui=B.document,Vi=B.process,vn=Wb("fetch"),qe=Ri.f,wu=qe,xu=!!(Ui&&Ui.createEvent&&B.dispatchEvent),wn="function"==typeof PromiseRejectionEvent,wf=jc("Promise",(function(){if(Bi(sb)===String(sb)&&(66===pe||!kc&&!wn))return!0;if(51<=pe&&/native code/.test(sb))return!1;var e=sb.resolve(1),t=function(e){e((function(){}),(function(){}))};return(e.constructor={})[tu]=t,!(e.then((function(){}))instanceof t)})),yu=wf||!Dg((function(e){sb.all(e).catch((function(){}))})),xn=function(e){var t;return!(!ea(e)||"function"!=typeof(t=e.then))&&t},Wi=function(e,t){if(!e.notified){e.notified=!0;var n=e.reactions;pn((function(){for(var r=e.value,i=1==e.state,o=0;n.length>o;){var a,s=n[o++],c=i?s.ok:s.fail,u=s.resolve,l=s.reject,d=s.domain;try{if(c){if(i||(2===e.rejection&&zu(e),e.rejection=1),!0===c)var h=r;else if(d&&d.enter(),h=c(r),d){d.exit();var f=!0}h===s.promise?l(un("Promise-chain cycle")):(a=xn(h))?a.call(h,u,l):u(h)}else l(r)}catch(e){d&&!f&&d.exit(),l(e)}}e.reactions=[],e.notified=!1,t&&!e.rejection&&Au(e)}))}},yn=function(e,t,n){var r;if(xu){var i=Ui.createEvent("Event");i.promise=t,i.reason=n,i.initEvent(e,!1,!0),B.dispatchEvent(i)}else i={promise:t,reason:n};!wn&&(r=B["on"+e])?r(i):"unhandledrejection"===e&&su("Unhandled promise rejection",n)},Au=function(e){Pi.call(B,(function(){var t=e.facade,n=e.value;if(1!==e.rejection&&!e.parent){var r=Si((function(){kc?Vi.emit("unhandledRejection",n,t):yn("unhandledrejection",t,n)}));if(e.rejection=kc||1!==e.rejection&&!e.parent?2:1,r.error)throw r.value}}))},zu=function(e){Pi.call(B,(function(){var t=e.facade;kc?Vi.emit("rejectionHandled",t):yn("rejectionhandled",t,e.value)}))},re=function(e,t,n){return function(r){e(t,r,n)}},se=function(e,t,n){e.done||(e.done=!0,n&&(e=n),e.value=t,e.state=2,Wi(e,!0))},Xi=function(e,t,n){if(!e.done){e.done=!0,n&&(e=n);try{if(e.facade===t)throw un("Promise can't be resolved itself");var r=xn(t);r?pn((function(){var n={done:!1};try{r.call(t,re(Xi,n,e),re(se,n,e))}catch(t){se(n,t,e)}})):(e.value=t,e.state=1,Wi(e,!1))}catch(t){se({done:!1},t,e)}}};if(wf){sb=function(e){zc(this,sb,"Promise"),yb(e),Yi.call(this);var t=tn(this);try{e(re(Xi,t),re(se,t))}catch(e){se(t,e)}};var Yi=function(e){uu(this,{type:"Promise",done:!1,notified:!1,parent:!1,reactions:[],rejection:!1,state:0,value:void 0})};Yi.prototype=of(sb.prototype,{then:function(e,t){var n=vu(this),r=qe(Yc(this,sb));return r.ok="function"!=typeof e||e,r.fail="function"==typeof t&&t,r.domain=kc?Vi.domain:void 0,n.parent=!0,n.reactions.push(r),0!=n.state&&Wi(n,!1),r.promise},catch:function(e){return this.then(void 0,e)}});var Bu=function(){var e=new Yi,t=tn(e);this.promise=e,this.resolve=re(Xi,t),this.reject=re(se,t)};if(Ri.f=qe=function(e){return e===sb||e===Cu?new Bu(e):wu(e)},"function"==typeof wc){var Du=wc.prototype.then;Va(wc.prototype,"then",(function(e,t){var n=this;return new sb((function(e,t){Du.call(n,e,t)})).then(e,t)}),{unsafe:!0}),"function"==typeof vn&&N({global:!0,enumerable:!0,forced:!0},{fetch:function(e){return Hg(sb,vn.apply(B,arguments))}})}}N({global:!0,wrap:!0,forced:wf},{Promise:sb}),yc(sb,"Promise",!1),qf("Promise");var Cu=Wb("Promise");N({target:"Promise",stat:!0,forced:wf},{reject:function(e){var t=qe(this);return t.reject.call(void 0,e),t.promise}}),N({target:"Promise",stat:!0,forced:wf},{resolve:function(e){return Hg(this,e)}}),N({target:"Promise",stat:!0,forced:yu},{all:function(e){var t=this,n=qe(t),r=n.resolve,i=n.reject,o=Si((function(){var n=yb(t.resolve),o=[],a=0,s=1;Cg(e,(function(e){var c=a++,u=!1;o.push(void 0),s++,n.call(t,e).then((function(e){u||(u=!0,o[c]=e,--s||r(o))}),i)})),--s||r(o)}));return o.error&&i(o.value),n.promise},race:function(e){var t=this,n=qe(t),r=n.reject,i=Si((function(){var i=yb(t.resolve);Cg(e,(function(e){i.call(t,e).then(n.resolve,r)}))}));return i.error&&r(i.value),n.promise}});var Eu=Gi?{}.toString:function(){return"[object "+rf(this)+"]"};Gi||Va(Object.prototype,"toString",Eu,{unsafe:!0});var zn=[].indexOf,An=!!zn&&0>1/[1].indexOf(1,-0),Fu=le("indexOf");N({target:"Array",proto:!0,forced:An||!Fu},{indexOf:function(e){return An?zn.apply(this,arguments)||0:Ei(this,e,1<arguments.length?arguments[1]:void 0)}});var Zi=function(){var e=qa(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t},Ig=O((function(){var e=RegExp("a","y");return e.lastIndex=2,null!=e.exec("abcd")})),Gu=O((function(){var e=RegExp("^r","gy");return e.lastIndex=2,null!=e.exec("str")})),Jg=RegExp.prototype.exec,Hu=String.prototype.replace,Bn=Jg,$i=(c=/a/,a=/b*/g,Jg.call(c,"a"),Jg.call(a,"a"),0!==c.lastIndex||0!==a.lastIndex),Cn=Ig||Gu,aj=void 0!==/()??/.exec("")[1],c,a;($i||aj||Cn)&&(Bn=function(e){var t,n=Cn&&this.sticky,r=Zi.call(this),i=this.source,o=0,a=e;if(n){-1===(r=r.replace("y","")).indexOf("g")&&(r+="g"),a=String(e).slice(this.lastIndex),0<this.lastIndex&&(!this.multiline||this.multiline&&"\n"!==e[this.lastIndex-1])&&(i="(?: "+i+")",a=" "+a,o++);var s=new RegExp("^(?:"+i+")",r)}if(aj&&(s=new RegExp("^"+i+"$(?!\\s)",r)),$i)var c=this.lastIndex;var u=Jg.call(n?s:this,a);return n?u?(u.input=u.input.slice(o),u[0]=u[0].slice(o),u.index=this.lastIndex,this.lastIndex+=u[0].length):this.lastIndex=0:$i&&u&&(this.lastIndex=this.global?u.index+u[0].length:c),aj&&u&&1<u.length&&Hu.call(u[0],s,(function(){for(t=1;t<arguments.length-2;t++)void 0===arguments[t]&&(u[t]=void 0)})),u});var xf=Bn;N({target:"RegExp",proto:!0,forced:/./.exec!==xf},{exec:xf});var Iu=oa("species"),Ju=!O((function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")})),Dn="$0"==="a".replace(/./,"$0"),En=oa("replace"),Fn=!!/./[En]&&""===/./[En]("a","$0"),Ku=!O((function(){var e=/(?:)/,t=e.exec;return e.exec=function(){return t.apply(this,arguments)},2!==(e="ab".split(e)).length||"a"!==e[0]||"b"!==e[1]})),Kg=function(e,t,n,r){var i=oa(e),o=!O((function(){var t={};return t[i]=function(){return 7},7!=""[e](t)})),a=o&&!O((function(){var t=!1,n=/a/;return"split"===e&&((n={constructor:{}}).constructor[Iu]=function(){return n},n.flags="",n[i]=/./[i]),n.exec=function(){return t=!0,null},n[i](""),!t}));if(!o||!a||"replace"===e&&(!Ju||!Dn||Fn)||"split"===e&&!Ku){var s=/./[i],c=(n=n(i,""[e],(function(e,t,n,r,i){return t.exec===xf?o&&!i?{done:!0,value:s.call(t,n,r)}:{done:!0,value:e.call(n,t,r)}:{done:!1}}),{REPLACE_KEEPS_$0:Dn,REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE:Fn}))[1];Va(String.prototype,e,n[0]),Va(RegExp.prototype,i,2==t?function(e,t){return c.call(e,this,t)}:function(e){return c.call(e,this)})}r&&Ia(RegExp.prototype[i],"sham",!0)},Gn=function(e){return function(t,n){t=String(hb(t)),n=ic(n);var r,i=t.length;if(0>n||n>=i)return e?"":void 0;var o=t.charCodeAt(n);return 55296>o||56319<o||n+1===i||56320>(r=t.charCodeAt(n+1))||57343<r?e?t.charAt(n):o:e?t.slice(n,n+2):r-56320+(o-55296<<10)+65536}};Gn(!1);var Hn=Gn(!0),bj=function(e,t,n){return t+(n?Hn(e,t).length:1)},Wa=function(e){return Object(hb(e))},Lu=Math.floor,Mu="".replace,Nu=/\$([$&'`]|\d\d?|<[^>]*>)/g,Ou=/\$([$&'`]|\d\d?)/g,Pu=function(e,t,n,r,i,o){var a=n+e.length,s=r.length,c=Ou;return void 0!==i&&(i=Wa(i),c=Nu),Mu.call(o,c,(function(o,c){switch(c.charAt(0)){case"$":return"$";case"&":return e;case"`":return t.slice(0,n);case"'":return t.slice(a);case"<":o=i[c.slice(1,-1)];break;default:var u=+c;if(0===u)return o;if(u>s)return 0===(u=Lu(u/10))?o:u<=s?void 0===r[u-1]?c.charAt(1):r[u-1]+c.charAt(1):o;o=r[u-1]}return void 0===o?"":o}))},te=function(e,t){var n=e.exec;if("function"==typeof n){if("object"!=typeof(e=n.call(e,t)))throw TypeError("RegExp exec method returned something other than an Object or null");return e}if("RegExp"!==Vb(e))throw TypeError("RegExp#exec called on incompatible receiver");return xf.call(e,t)},Qu=Math.max,Ru=Math.min,Su=function(e){return void 0===e?e:String(e)};Kg("replace",2,(function(e,t,n,r){var i=r.REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE,o=r.REPLACE_KEEPS_$0,a=i?"$":"$0";return[function(n,r){var i=hb(this),o=null==n?void 0:n[e];return void 0!==o?o.call(n,i,r):t.call(String(i),n,r)},function(e,r){if(!i&&o||"string"==typeof r&&-1===r.indexOf(a)){var s=n(t,e,this,r);if(s.done)return s.value}var c=qa(e);e=String(this),(s="function"==typeof r)||(r=String(r));var u=c.global;if(u){var l=c.unicode;c.lastIndex=0}for(var d=[];;){var h=te(c,e);if(null===h)break;if(d.push(h),!u)break;""===String(h[0])&&(c.lastIndex=bj(e,za(c.lastIndex),l))}for(l="",u=c=0;u<d.length;u++){h=d[u];for(var f=String(h[0]),p=Qu(Ru(ic(h.index),e.length),0),A=[],g=1;g<h.length;g++)A.push(Su(h[g]));h=h.groups,s?(A=[f].concat(A,p,e),void 0!==h&&A.push(h),h=String(r.apply(void 0,A))):h=Pu(f,e,p,A,h,r),p>=c&&(l+=e.slice(c,p)+h,c=p+f.length)}return l+e.slice(c)}]}));var zd=Array.isArray||function(e){return"Array"==Vb(e)},ue=function(e,t,n){(t=hc(t))in e?Ma.f(e,t,Xc(0,n)):e[t]=n},Tu=oa("species"),yf=function(e){return 51<=pe||!O((function(){var t=[];return(t.constructor={})[Tu]=function(){return{foo:1}},1!==t[e](Boolean).foo}))},Uu=yf("slice"),Vu=oa("species"),Wu=[].slice,Xu=Math.max;N({target:"Array",proto:!0,forced:!Uu},{slice:function(e,t){var n=rb(this),r=za(n.length);if(e=xb(e,r),t=xb(void 0===t?r:t,r),zd(n)){var i=n.constructor;if("function"!=typeof i||i!==Array&&!zd(i.prototype)?ea(i)&&null===(i=i[Vu])&&(i=void 0):i=void 0,i===Array||void 0===i)return Wu.call(n,e,t)}for(i=new(void 0===i?Array:i)(Xu(t-e,0)),r=0;e<t;e++,r++)e in n&&ue(i,r,n[e]);return i.length=r,i}});var In="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView,Jn=!O((function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype})),Kn=yg("IE_PROTO"),Yu=Object.prototype,Rb=Jn?Object.getPrototypeOf:function(e){return e=Wa(e),P(e,Kn)?e[Kn]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?Yu:null},$a=Object.setPrototypeOf||("__proto__"in{}?function(){var e=!1,t={};try{var n=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set;n.call(t,[]),e=t instanceof Array}catch(e){}return function(t,r){if(qa(t),!ea(r)&&null!==r)throw TypeError("Can't set "+String(r)+" as a prototype");return e?n.call(t,r):t.__proto__=r,t}}():void 0),Zu=Ma.f,zf=B.Int8Array,cj=zf&&zf.prototype,Ln=B.Uint8ClampedArray,Mn=Ln&&Ln.prototype,Ac=zf&&Rb(zf),Xb=cj&&Rb(cj),Nn=Object.prototype,On=Nn.isPrototypeOf,Pn=oa("toStringTag"),dj=ie("TYPED_ARRAY_TAG"),Bc=In&&!!$a&&"Opera"!==rf(B.opera),Qn=!1,zb,lc={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},$u={BigInt64Array:8,BigUint64Array:8},Lg=function(e){return!!ea(e)&&(e=rf(e),P(lc,e)||P($u,e))};for(zb in lc)B[zb]||(Bc=!1);if((!Bc||"function"!=typeof Ac||Ac===Function.prototype)&&(Ac=function(){throw TypeError("Incorrect invocation")},Bc))for(zb in lc)B[zb]&&$a(B[zb],Ac);if((!Bc||!Xb||Xb===Nn)&&(Xb=Ac.prototype,Bc))for(zb in lc)B[zb]&&$a(B[zb].prototype,Xb);if(Bc&&Rb(Mn)!==Xb&&$a(Mn,Xb),ja&&!P(Xb,Pn))for(zb in Qn=!0,Zu(Xb,Pn,{get:function(){return ea(this)?this[dj]:void 0}}),lc)B[zb]&&Ia(B[zb],dj,zb);var Af=Bc,Rn=Qn&&dj,Aa=function(e){if(Lg(e))return e;throw TypeError("Target is not a typed array")},ve=function(e){if($a){if(On.call(Ac,e))return e}else for(var t in lc)if(P(lc,zb)){var n=B[t];if(n&&(e===n||On.call(n,e)))return e}throw TypeError("Target is not a typed array constructor")},va=function(e,t,n){if(ja){if(n)for(var r in lc){var i=B[r];i&&P(i.prototype,e)&&delete i.prototype[e]}Xb[e]&&!n||Va(Xb,e,n?t:Bc&&cj[e]||t)}},Sn=function(e,t,n){var r,i;if(ja){if($a){if(n)for(r in lc)(i=B[r])&&P(i,e)&&delete i[e];if(Ac[e]&&!n)return;try{return Va(Ac,e,n?t:Bc&&zf[e]||t)}catch(e){}}for(r in lc)!(i=B[r])||i[e]&&!n||Va(i,e,t)}},Tn=Ac,Bf=Xb,av=B.ArrayBuffer,Ad=B.Int8Array,ej=!Af||!O((function(){Ad(1)}))||!O((function(){new Ad(-1)}))||!Dg((function(e){new Ad,new Ad(null),new Ad(1.5),new Ad(e)}),!0)||O((function(){return 1!==new Ad(new av(2),1,void 0).length})),we=function(e){if(void 0===e)return 0;e=ic(e);var t=za(e);if(e!==t)throw RangeError("Wrong length or index");return t},bv=Math.abs,Cc=Math.pow,cv=Math.floor,dv=Math.log,ev=Math.LN2,fj=function(e){var t=Wa(this),n=za(t.length),r=arguments.length,i=xb(1<r?arguments[1]:void 0,n);for(n=void 0===(r=2<r?arguments[2]:void 0)?n:xb(r,n);n>i;)t[i++]=e;return t},fv=wd.f,gv=Ma.f,xe=Ua.get,Un=Ua.set,Yb=B.ArrayBuffer,Ab=Yb,Zb=B.DataView,Mg=Zb&&Zb.prototype,Vn=Object.prototype,Ng=B.RangeError,Wn=function(e,t,n){var r,i=Array(n),o=(1<<(n=8*n-t-1))-1,a=o>>1,s=23===t?Cc(2,-24)-Cc(2,-77):0,c=0>e||0===e&&0>1/e?1:0,u=0;if((e=bv(e))!=e||1/0===e){e=e!=e?1:0;var l=o}else l=cv(dv(e)/ev),1>e*(r=Cc(2,-l))&&(l--,r*=2),2<=(e=1<=l+a?e+s/r:e+s*Cc(2,1-a))*r&&(l++,r/=2),l+a>=o?(e=0,l=o):1<=l+a?(e=(e*r-1)*Cc(2,t),l+=a):(e=e*Cc(2,a-1)*Cc(2,t),l=0);for(;8<=t;i[u++]=255&e,e/=256,t-=8);for(l=l<<t|e,n+=t;0<n;i[u++]=255&l,l/=256,n-=8);return i[--u]|=128*c,i},Xn=function(e,t){var n=e.length,r=8*n-t-1,i=(1<<r)-1,o=i>>1;r-=7,--n;var a=e[n--],s=127&a;for(a>>=7;0<r;s=256*s+e[n],n--,r-=8);var c=s&(1<<-r)-1;for(s>>=-r,r+=t;0<r;c=256*c+e[n],n--,r-=8);if(0===s)s=1-o;else{if(s===i)return c?NaN:a?-1/0:1/0;c+=Cc(2,t),s-=o}return(a?-1:1)*c*Cc(2,s-t)},Yn=function(e){return[255&e]},Zn=function(e){return[255&e,e>>8&255]},$n=function(e){return[255&e,e>>8&255,e>>16&255,e>>24&255]},ao=function(e){return e[3]<<24|e[2]<<16|e[1]<<8|e[0]},hv=function(e){return Wn(e,23,4)},iv=function(e){return Wn(e,52,8)},Og=function(e,t){gv(e.prototype,t,{get:function(){return xe(this)[t]}})},Zc=function(e,t,n,r){n=we(n);var i=xe(e);if(n+t>i.byteLength)throw Ng("Wrong index");return e=xe(i.buffer).bytes,n+=i.byteOffset,t=e.slice(n,n+t),r?t:t.reverse()},$c=function(e,t,n,r,i,o){n=we(n);var a=xe(e);if(n+t>a.byteLength)throw Ng("Wrong index");for(e=xe(a.buffer).bytes,n+=a.byteOffset,r=r(+i),i=0;i<t;i++)e[n+i]=r[o?i:t-i-1]};if(In){if(!O((function(){Yb(1)}))||!O((function(){new Yb(-1)}))||O((function(){return new Yb,new Yb(1.5),new Yb(NaN),"ArrayBuffer"!=Yb.name}))){Ab=function(e){return zc(this,Ab),new Yb(we(e))};for(var jv=Ab.prototype=Yb.prototype,bo=fv(Yb),co=0,gj;bo.length>co;)(gj=bo[co++])in Ab||Ia(Ab,gj,Yb[gj]);jv.constructor=Ab}$a&&Rb(Mg)!==Vn&&$a(Mg,Vn);var Pg=new Zb(new Ab(2)),eo=Mg.setInt8;Pg.setInt8(0,2147483648),Pg.setInt8(1,2147483649),!Pg.getInt8(0)&&Pg.getInt8(1)||of(Mg,{setInt8:function(e,t){eo.call(this,e,t<<24>>24)},setUint8:function(e,t){eo.call(this,e,t<<24>>24)}},{unsafe:!0})}else Ab=function(e){zc(this,Ab,"ArrayBuffer"),e=we(e),Un(this,{bytes:fj.call(Array(e),0),byteLength:e}),ja||(this.byteLength=e)},Zb=function(e,t,n){zc(this,Zb,"DataView"),zc(e,Ab,"DataView");var r=xe(e).byteLength;if(0>(t=ic(t))||t>r)throw Ng("Wrong offset");if(t+(n=void 0===n?r-t:za(n))>r)throw Ng("Wrong length");Un(this,{buffer:e,byteLength:n,byteOffset:t}),ja||(this.buffer=e,this.byteLength=n,this.byteOffset=t)},ja&&(Og(Ab,"byteLength"),Og(Zb,"buffer"),Og(Zb,"byteLength"),Og(Zb,"byteOffset")),of(Zb.prototype,{getInt8:function(e){return Zc(this,1,e)[0]<<24>>24},getUint8:function(e){return Zc(this,1,e)[0]},getInt16:function(e){var t=Zc(this,2,e,1<arguments.length?arguments[1]:void 0);return(t[1]<<8|t[0])<<16>>16},getUint16:function(e){var t=Zc(this,2,e,1<arguments.length?arguments[1]:void 0);return t[1]<<8|t[0]},getInt32:function(e){return ao(Zc(this,4,e,1<arguments.length?arguments[1]:void 0))},getUint32:function(e){return ao(Zc(this,4,e,1<arguments.length?arguments[1]:void 0))>>>0},getFloat32:function(e){return Xn(Zc(this,4,e,1<arguments.length?arguments[1]:void 0),23)},getFloat64:function(e){return Xn(Zc(this,8,e,1<arguments.length?arguments[1]:void 0),52)},setInt8:function(e,t){$c(this,1,e,Yn,t)},setUint8:function(e,t){$c(this,1,e,Yn,t)},setInt16:function(e,t){$c(this,2,e,Zn,t,2<arguments.length?arguments[2]:void 0)},setUint16:function(e,t){$c(this,2,e,Zn,t,2<arguments.length?arguments[2]:void 0)},setInt32:function(e,t){$c(this,4,e,$n,t,2<arguments.length?arguments[2]:void 0)},setUint32:function(e,t){$c(this,4,e,$n,t,2<arguments.length?arguments[2]:void 0)},setFloat32:function(e,t){$c(this,4,e,hv,t,2<arguments.length?arguments[2]:void 0)},setFloat64:function(e,t){$c(this,8,e,iv,t,2<arguments.length?arguments[2]:void 0)}});yc(Ab,"ArrayBuffer"),yc(Zb,"DataView");var Cf={ArrayBuffer:Ab,DataView:Zb},Qg=function(e,t){if(0>(e=ic(e)))throw RangeError("The argument can't be less than 0");if(e%t)throw RangeError("Wrong offset");return e},Dc=Object.keys||function(e){return Qm(e,Ag)},kv=ja?Object.defineProperties:function(e,t){qa(e);for(var n,r=Dc(t),i=r.length,o=0;i>o;)Ma.f(e,n=r[o++],t[n]);return e},fo=yg("IE_PROTO"),hj=function(){},ij,Rg=function(){try{ij=document.domain&&new ActiveXObject("htmlfile")}catch(e){}if(ij){var e=ij;e.write("<script><\/script>"),e.close(),e=e.parentWindow.Object}else(e=xg?he.createElement("iframe"):{}).style.display="none",Ji.appendChild(e),e.src="javascript:",(e=e.contentWindow.document).open(),e.write("<script>document.F=Object<\/script>"),e.close(),e=e.F;for(Rg=e,e=Ag.length;e--;)delete Rg.prototype[Ag[e]];return Rg()};je[fo]=!0;var $b=Object.create||function(e,t){if(null!==e){hj.prototype=qa(e);var n=new hj;hj.prototype=null,n[fo]=e}else n=Rg();return void 0===t?n:kv(n,t)},jj=function(e){var t=Wa(e),n=arguments.length,r=1<n?arguments[1]:void 0,i=void 0!==r,o=Hi(t);if(null!=o&&!Fi(o)){var a=o.call(t),s=a.next;for(t=[];!(o=s.call(a)).done;)t.push(o.value)}for(i&&2<n&&(r=ne(r,arguments[2],2)),o=za(t.length),a=new(ve(this))(o),n=0;o>n;n++)a[n]=i?r(t[n],n):t[n];return a},lv=oa("species"),kj=function(e,t){if(zd(e)){var n=e.constructor;"function"!=typeof n||n!==Array&&!zd(n.prototype)?ea(n)&&null===(n=n[lv])&&(n=void 0):n=void 0}return new(void 0===n?Array:n)(0===t?0:t)},go=[].push,ad=function(e){var t=1==e,n=2==e,r=3==e,i=4==e,o=6==e,a=7==e,s=5==e||o;return function(c,u,l,d){var h=Wa(c),f=lf(h);u=ne(u,l,3),l=za(f.length);var p,A=0;for(d=d||kj,c=t?d(c,l):n||a?d(c,0):void 0;l>A;A++)if((s||A in f)&&(p=u(d=f[A],A,h),e))if(t)c[A]=p;else if(p)switch(e){case 3:return!0;case 5:return d;case 6:return A;case 2:go.call(c,d)}else switch(e){case 4:return!1;case 7:go.call(c,d)}return o?-1:r||i?i:c}},Bd=ad(0),ho=ad(1),io=ad(2),mv=ad(3),nv=ad(4),ov=ad(5),jo=ad(6);ad(7);var Sg=function(e,t,n){var r,i;return $a&&"function"==typeof(r=t.constructor)&&r!==n&&ea(i=r.prototype)&&i!==n.prototype&&$a(e,i),e},Df=Xa((function(e){var t=wd.f,n=Ua.get,r=Ua.set,i=Ma.f,o=Db.f,a=Math.round,s=B.RangeError,c=Cf.ArrayBuffer,u=Cf.DataView,l=function(e,t){var n=0,r=t.length;for(e=new(ve(e))(r);r>n;)e[n]=t[n++];return e},d=function(e,t){i(e,t,{get:function(){return n(this)[t]}})},h=function(e){var t;return e instanceof c||"ArrayBuffer"==(t=rf(e))||"SharedArrayBuffer"==t},f=function(e,t){return Lg(e)&&"symbol"!=typeof t&&t in e&&String(+t)==String(t)},p=function(e,t){return f(e,t=hc(t,!0))?Xc(2,e[t]):o(e,t)},A=function(e,t,n){return!(f(e,t=hc(t,!0))&&ea(n)&&P(n,"value"))||P(n,"get")||P(n,"set")||n.configurable||P(n,"writable")&&!n.writable||P(n,"enumerable")&&!n.enumerable?i(e,t,n):(e[t]=n.value,e)};ja?(Af||(Db.f=p,Ma.f=A,d(Bf,"buffer"),d(Bf,"byteOffset"),d(Bf,"byteLength"),d(Bf,"length")),N({target:"Object",stat:!0,forced:!Af},{getOwnPropertyDescriptor:p,defineProperty:A}),e.exports=function(e,o,d){var f=e.match(/\d+$/)[0]/8,p=e+(d?"Clamped":"")+"Array",A="get"+e,g="set"+e,v=B[p],m=v;e=m&&m.prototype;var y={},b=function(e,t){i(e,t,{get:function(){var e=n(this);return e.view[A](t*f+e.byteOffset,!0)},set:function(e){var r=n(this);d&&(e=0>(e=a(e))?0:255<e?255:255&e),r.view[g](t*f+r.byteOffset,e,!0)},enumerable:!0})};Af?ej&&(m=o((function(e,t,n,r){return zc(e,m,p),Sg(ea(t)?h(t)?void 0!==r?new v(t,Qg(n,f),r):void 0!==n?new v(t,Qg(n,f)):new v(t):Lg(t)?l(m,t):jj.call(m,t):new v(we(t)),e,m)})),$a&&$a(m,Tn),Bd(t(v),(function(e){e in m||Ia(m,e,v[e])})),m.prototype=e):(m=o((function(e,t,n,i){zc(e,m,p);var o=0,a=0;if(ea(t)){if(!h(t))return Lg(t)?l(m,t):jj.call(m,t);var d=t;if(a=Qg(n,f),t=t.byteLength,void 0===i){if(t%f)throw s("Wrong length");if(0>(i=t-a))throw s("Wrong length")}else if((i=za(i)*f)+a>t)throw s("Wrong length");t=i/f}else t=we(t),d=new c(i=t*f);for(r(e,{buffer:d,byteOffset:a,byteLength:i,length:t,view:new u(d)});o<t;)b(e,o++)})),$a&&$a(m,Tn),e=m.prototype=$b(Bf)),e.constructor!==m&&Ia(e,"constructor",m),Rn&&Ia(e,Rn,p),y[p]=m,N({global:!0,forced:m!=v,sham:!Af},y),"BYTES_PER_ELEMENT"in m||Ia(m,"BYTES_PER_ELEMENT",f),"BYTES_PER_ELEMENT"in e||Ia(e,"BYTES_PER_ELEMENT",f),qf(p)}):e.exports=function(){}}));Df("Uint8",(function(e){return function(t,n,r){return e(this,t,n,r)}}));var pv=Math.min,qv=[].copyWithin||function(e,t){var n=Wa(this),r=za(n.length),i=xb(e,r),o=xb(t,r),a=2<arguments.length?arguments[2]:void 0;for(r=pv((void 0===a?r:xb(a,r))-o,r-i),a=1,o<i&&i<o+r&&(a=-1,o+=r-1,i+=r-1);0<r--;)o in n?n[i]=n[o]:delete n[i],i+=a,o+=a;return n};va("copyWithin",(function(e,t){return qv.call(Aa(this),e,t,2<arguments.length?arguments[2]:void 0)})),va("every",(function(e){return nv(Aa(this),e,1<arguments.length?arguments[1]:void 0)})),va("fill",(function(e){return fj.apply(Aa(this),arguments)})),va("filter",(function(e){var t=io(Aa(this),e,1<arguments.length?arguments[1]:void 0),n=Yc(this,this.constructor),r=0,i=t.length;for(n=new(ve(n))(i);i>r;)n[r]=t[r++];return n})),va("find",(function(e){return ov(Aa(this),e,1<arguments.length?arguments[1]:void 0)})),va("findIndex",(function(e){return jo(Aa(this),e,1<arguments.length?arguments[1]:void 0)})),va("forEach",(function(e){Bd(Aa(this),e,1<arguments.length?arguments[1]:void 0)})),va("includes",(function(e){return Pm(Aa(this),e,1<arguments.length?arguments[1]:void 0)})),va("indexOf",(function(e){return Ei(Aa(this),e,1<arguments.length?arguments[1]:void 0)}));var lj=oa("unscopables"),mj=Array.prototype;null==mj[lj]&&Ma.f(mj,lj,{configurable:!0,value:$b(null)});var ye=function(e){mj[lj][e]=!0},nj=oa("iterator"),ko=!1,rv=function(){return this},Cd;if([].keys){var lo=[].keys();if("next"in lo){var mo=Rb(Rb(lo));mo!==Object.prototype&&(Cd=mo)}else ko=!0}(null==Cd||O((function(){var e={};return Cd[nj].call(e)!==e})))&&(Cd={}),P(Cd,nj)||Ia(Cd,nj,rv);var Tg=Cd,sv=function(){return this},tv=function(e,t,n){return t+=" Iterator",e.prototype=$b(Tg,{next:Xc(1,n)}),yc(e,t,!1),me[t]=sv,e},Ug=ko,Ef=oa("iterator"),uv=function(){return this},oj=function(e,t,n,r,i,o,a){tv(n,t,r),r=function(e){if(e===i&&h)return h;if(!Ug&&e in l)return l[e];switch(e){case"keys":case"values":case"entries":return function(){return new n(this,e)}}return function(){return new n(this)}};var s,c=t+" Iterator",u=!1,l=e.prototype,d=l[Ef]||l["@@iterator"]||i&&l[i],h=!Ug&&d||r(i),f="Array"==t&&l.entries||d;if(f&&(e=Rb(f.call(new e)),Tg!==Object.prototype&&e.next&&(Rb(e)!==Tg&&($a?$a(e,Tg):"function"!=typeof e[Ef]&&Ia(e,Ef,uv)),yc(e,c,!0))),"values"==i&&d&&"values"!==d.name&&(u=!0,h=function(){return d.call(this)}),l[Ef]!==h&&Ia(l,Ef,h),me[t]=h,i){var p={values:r("values"),keys:o?h:r("keys"),entries:r("entries")};if(a)for(s in p)!Ug&&!u&&s in l||Va(l,s,p[s]);else N({target:t,proto:!0,forced:Ug||u},p)}return p},vv=Ua.set,wv=Ua.getterFor("Array Iterator"),bd=oj(Array,"Array",(function(e,t){vv(this,{type:"Array Iterator",target:rb(e),index:0,kind:t})}),(function(){var e=wv(this),t=e.target,n=e.kind,r=e.index++;return!t||r>=t.length?(e.target=void 0,{value:void 0,done:!0}):"keys"==n?{value:r,done:!1}:"values"==n?{value:t[r],done:!1}:{value:[r,t[r]],done:!1}}),"values");me.Arguments=me.Array,ye("keys"),ye("values"),ye("entries");var no=oa("iterator"),oo=B.Uint8Array,xv=bd.values,yv=bd.keys,zv=bd.entries,pj=oo&&oo.prototype[no],po=!!pj&&("values"==pj.name||null==pj.name),qo=function(){return xv.call(Aa(this))};va("entries",(function(){return zv.call(Aa(this))})),va("keys",(function(){return yv.call(Aa(this))})),va("values",qo,!po),va(no,qo,!po);var Av=[].join;va("join",(function(e){return Av.apply(Aa(this),arguments)}));var Bv=Math.min,qj=[].lastIndexOf,ro=!!qj&&0>1/[1].lastIndexOf(1,-0),Cv=le("lastIndexOf"),Dv=ro||!Cv?function(e){if(ro)return qj.apply(this,arguments)||0;var t=rb(this),n=za(t.length),r=n-1;for(1<arguments.length&&(r=Bv(r,ic(arguments[1]))),0>r&&(r=n+r);0<=r;r--)if(r in t&&t[r]===e)return r||0;return-1}:qj;va("lastIndexOf",(function(e){return Dv.apply(Aa(this),arguments)})),va("map",(function(e){return ho(Aa(this),e,1<arguments.length?arguments[1]:void 0,(function(e,t){return new(ve(Yc(e,e.constructor)))(t)}))}));var so=function(e){return function(t,n,r,i){yb(n),t=Wa(t);var o=lf(t),a=za(t.length),s=e?a-1:0,c=e?-1:1;if(2>r)for(;;){if(s in o){i=o[s],s+=c;break}if(s+=c,e?0>s:a<=s)throw TypeError("Reduce of empty array with no initial value")}for(;e?0<=s:a>s;s+=c)s in o&&(i=n(i,o[s],s,t));return i}},to=so(!1),Ev=so(!0);va("reduce",(function(e){return to(Aa(this),e,arguments.length,1<arguments.length?arguments[1]:void 0)})),va("reduceRight",(function(e){return Ev(Aa(this),e,arguments.length,1<arguments.length?arguments[1]:void 0)}));var Fv=Math.floor;va("reverse",(function(){for(var e,t=Aa(this).length,n=Fv(t/2),r=0;r<n;)e=this[r],this[r++]=this[--t],this[t]=e;return this}));var Gv=O((function(){new Int8Array(1).set({})}));va("set",(function(e){Aa(this);var t=Qg(1<arguments.length?arguments[1]:void 0,1),n=this.length,r=Wa(e),i=za(r.length),o=0;if(i+t>n)throw RangeError("Wrong length");for(;o<i;)this[t+o]=r[o++]}),Gv);var Hv=[].slice,Iv=O((function(){new Int8Array(1).slice()}));va("slice",(function(e,t){e=Hv.call(Aa(this),e,t);var n=Yc(this,this.constructor);t=0;var r=e.length;for(n=new(ve(n))(r);r>t;)n[t]=e[t++];return n}),Iv),va("some",(function(e){return mv(Aa(this),e,1<arguments.length?arguments[1]:void 0)}));var Jv=[].sort;va("sort",(function(e){return Jv.call(Aa(this),e)})),va("subarray",(function(e,t){var n=Aa(this),r=n.length;return e=xb(e,r),new(Yc(n,n.constructor))(n.buffer,n.byteOffset+e*n.BYTES_PER_ELEMENT,za((void 0===t?r:xb(t,r))-e))}));var Vg=B.Int8Array,uo=[].toLocaleString,Kv=[].slice,Lv=!!Vg&&O((function(){uo.call(new Vg(1))})),Mv=O((function(){return[1,2].toLocaleString()!=new Vg([1,2]).toLocaleString()}))||!O((function(){Vg.prototype.toLocaleString.call([1,2])}));va("toLocaleString",(function(){return uo.apply(Lv?Kv.call(Aa(this)):Aa(this),arguments)}),Mv);var vo=B.Uint8Array,Nv=vo&&vo.prototype||{},Wg=[].toString,Ov=[].join;O((function(){Wg.call({})}))&&(Wg=function(){return Ov.call(this)}),va("toString",Wg,Nv.toString!=Wg);var rj=Cf.ArrayBuffer,wo=Cf.DataView,xo=rj.prototype.slice,Pv=O((function(){return!new rj(2).slice(1,void 0).byteLength}));N({target:"ArrayBuffer",proto:!0,unsafe:!0,forced:Pv},{slice:function(e,t){if(void 0!==xo&&void 0===t)return xo.call(qa(this),e);var n=qa(this).byteLength;e=xb(e,n),t=xb(void 0===t?n:t,n),n=new(Yc(this,rj))(za(t-e));for(var r=new wo(this),i=new wo(n),o=0;e<t;)i.setUint8(o++,r.getUint8(e++));return n}});var yo=Cf.ArrayBuffer;N({global:!0,forced:B.ArrayBuffer!==yo},{ArrayBuffer:yo}),qf("ArrayBuffer");var Qv=Ma.f,sj=Function.prototype,Rv=sj.toString,Sv=/^\s*function ([^ (]*)/;!ja||"name"in sj||Qv(sj,"name",{configurable:!0,get:function(){try{return Rv.call(this).match(Sv)[1]}catch(e){return""}}});var zo=RegExp.prototype,Ao=zo.toString,Tv=O((function(){return"/a/b"!=Ao.call({source:"a",flags:"b"})})),Uv="toString"!=Ao.name;(Tv||Uv)&&Va(RegExp.prototype,"toString",(function(){var e=qa(this),t=String(e.source),n=e.flags;return"/"+t+"/"+String(void 0===n&&e instanceof RegExp&&!("flags"in zo)?Zi.call(e):n)}),{unsafe:!0});var Vv=yf("splice"),Wv=Math.max,Xv=Math.min;N({target:"Array",proto:!0,forced:!Vv},{splice:function(e,t){var n,r,i=Wa(this),o=za(i.length),a=xb(e,o),s=arguments.length;if(0===s?s=n=0:1===s?(s=0,n=o-a):(s-=2,n=Xv(Wv(ic(t),0),o-a)),9007199254740991<o+s-n)throw TypeError("Maximum allowed length exceeded");var c=kj(i,n);for(r=0;r<n;r++){var u=a+r;u in i&&ue(c,r,i[u])}if(c.length=n,s<n){for(r=a;r<o-n;r++){var l=r+s;(u=r+n)in i?i[l]=i[u]:delete i[l]}for(r=o;r>o-n+s;r--)delete i[r-1]}else if(s>n)for(r=o-n;r>a;r--)l=r+s-1,(u=r+n-1)in i?i[l]=i[u]:delete i[l];for(r=0;r<s;r++)i[r+a]=arguments[r+2];return i.length=o-n+s,c}});var Yv=yf("filter");N({target:"Array",proto:!0,forced:!Yv},{filter:function(e){return io(this,e,1<arguments.length?arguments[1]:void 0)}});var Zv=Ua.set,$v=Ua.getterFor("String Iterator");oj(String,"String",(function(e){Zv(this,{type:"String Iterator",string:String(e),index:0})}),(function(){var e=$v(this),t=e.string,n=e.index;return n>=t.length?{value:void 0,done:!0}:(t=Hn(t,n),e.index+=t.length,{value:t,done:!1})}));var tj={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},uj=oa("iterator"),Bo=oa("toStringTag"),vj=bd.values,Xg;for(Xg in tj){var Co=B[Xg],Ec=Co&&Co.prototype;if(Ec){if(Ec[uj]!==vj)try{Ia(Ec,uj,vj)}catch(c){Ec[uj]=vj}if(Ec[Bo]||Ia(Ec,Bo,Xg),tj[Xg])for(var ze in bd)if(Ec[ze]!==bd[ze])try{Ia(Ec,ze,bd[ze])}catch(c){Ec[ze]=bd[ze]}}}var Do=Object.is||function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t};Kg("search",1,(function(e,t,n){return[function(t){var n=hb(this),r=null==t?void 0:t[e];return void 0!==r?r.call(t,n):new RegExp(t)[e](String(n))},function(e){var r=n(t,e,this);if(r.done)return r.value;e=qa(e);var i=String(this);return r=e.lastIndex,Do(r,0)||(e.lastIndex=0),i=te(e,i),Do(e.lastIndex,r)||(e.lastIndex=r),null===i?-1:i.index}]})),Xa((function(e){!function(t,n){e.exports?e.exports=n(t):n(t)}("undefined"!=typeof self?self:Ta,(function(e){function t(e){return btoa(e).replace(/=+$/,"").replace(/\+/g,"-").replace(/\//g,"_")}function n(e){return e=(e+="===").slice(0,-e.length%4),atob(e.replace(/-/g,"+").replace(/_/g,"/"))}function r(e){for(var t=new Uint8Array(e.length),n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}function i(e){return e instanceof ArrayBuffer&&(e=new Uint8Array(e)),String.fromCharCode.apply(String,e)}function o(e){var t={name:(e.name||e||"").toUpperCase().replace("V","v")};switch(t.name){case"SHA-1":case"SHA-256":case"SHA-384":case"SHA-512":break;case"AES-CBC":case"AES-GCM":case"AES-KW":e.length&&(t.length=e.length);break;case"HMAC":e.hash&&(t.hash=o(e.hash)),e.length&&(t.length=e.length);break;case"RSAES-PKCS1-v1_5":e.publicExponent&&(t.publicExponent=new Uint8Array(e.publicExponent)),e.modulusLength&&(t.modulusLength=e.modulusLength);break;case"RSASSA-PKCS1-v1_5":case"RSA-OAEP":e.hash&&(t.hash=o(e.hash)),e.publicExponent&&(t.publicExponent=new Uint8Array(e.publicExponent)),e.modulusLength&&(t.modulusLength=e.modulusLength);break;default:throw new SyntaxError("Bad algorithm name")}return t}function a(e){return{HMAC:{"SHA-1":"HS1","SHA-256":"HS256","SHA-384":"HS384","SHA-512":"HS512"},"RSASSA-PKCS1-v1_5":{"SHA-1":"RS1","SHA-256":"RS256","SHA-384":"RS384","SHA-512":"RS512"},"RSAES-PKCS1-v1_5":{"":"RSA1_5"},"RSA-OAEP":{"SHA-1":"RSA-OAEP","SHA-256":"RSA-OAEP-256"},"AES-KW":{128:"A128KW",192:"A192KW",256:"A256KW"},"AES-GCM":{128:"A128GCM",192:"A192GCM",256:"A256GCM"},"AES-CBC":{128:"A128CBC",192:"A192CBC",256:"A256CBC"}}[e.name][(e.hash||{}).name||e.length||""]}function s(e){(e instanceof ArrayBuffer||e instanceof Uint8Array)&&(e=JSON.parse(decodeURIComponent(escape(i(e)))));var t={kty:e.kty,alg:e.alg,ext:e.ext||e.extractable};switch(t.kty){case"oct":t.k=e.k;case"RSA":"n e d p q dp dq qi oth".split(" ").forEach((function(n){n in e&&(t[n]=e[n])}));break;default:throw new TypeError("Unsupported key type")}return t}function c(e){return e=s(e),b&&(e.extractable=e.ext,delete e.ext),r(unescape(encodeURIComponent(JSON.stringify(e)))).buffer}function u(e){var n=l(e),r=!1;switch(2<n.length&&(r=!0,n.shift()),e={ext:!0},n[0][0]){case"1.2.840.113549.1.1.1":var o="n e d p q dp dq qi".split(" ");for(n=l(n[1]),r&&n.shift(),r=0;r<n.length;r++)n[r][0]||(n[r]=n[r].subarray(1)),e[o[r]]=t(i(n[r]));e.kty="RSA";break;default:throw new TypeError("Unsupported key type")}return e}function l(e,t){if(e instanceof ArrayBuffer&&(e=new Uint8Array(e)),t||(t={pos:0,end:e.length}),2>t.end-t.pos||t.end>e.length)throw new RangeError("Malformed DER");var n=e[t.pos++],r=e[t.pos++];if(128<=r){if(r&=127,t.end-t.pos<r)throw new RangeError("Malformed DER");for(var o=0;r--;)o<<=8,o|=e[t.pos++];r=o}if(t.end-t.pos<r)throw new RangeError("Malformed DER");switch(n){case 2:n=e.subarray(t.pos,t.pos+=r);break;case 3:if(e[t.pos++])throw Error("Unsupported bit string");r--;case 4:n=new Uint8Array(e.subarray(t.pos,t.pos+=r)).buffer;break;case 5:n=null;break;case 6:if(!((e=btoa(i(e.subarray(t.pos,t.pos+=r))))in _))throw Error("Unsupported OBJECT ID "+e);n=_[e];break;case 48:for(n=[],r=t.pos+r;t.pos<r;)n.push(l(e,t));break;default:throw Error("Unsupported DER tag 0x"+n.toString(16))}return n}function d(e,t){t||(t=[]);var n=t.length+2;if(t.push(0,0),e instanceof Uint8Array)for(var i=2,o=e.length,a=0;a<o;a++)t.push(e[a]);else if(e instanceof ArrayBuffer)for(i=4,o=e.byteLength,e=new Uint8Array(e),a=0;a<o;a++)t.push(e[a]);else if(null===e)i=5,o=0;else if("string"==typeof e&&e in w)for(i=6,o=(e=r(atob(w[e]))).length,a=0;a<o;a++)t.push(e[a]);else if(e instanceof Array){for(a=0;a<e.length;a++)d(e[a],t);i=48,o=t.length-n}else{if(!("object"===R(e)&&3===e.tag&&e.value instanceof ArrayBuffer))throw Error("Unsupported DER value "+e);for(i=3,o=(e=new Uint8Array(e.value)).byteLength,t.push(0),a=0;a<o;a++)t.push(e[a]);o++}if(128<=o){for(a=o,o=4,t.splice(n,0,a>>24&255,a>>16&255,a>>8&255,255&a);1<o&&!(a>>24);)a<<=8,o--;4>o&&t.splice(n,4-o),o|=128}return t.splice(n-2,2,i,o),t}function h(e,t,n,r){Object.defineProperties(this,{_key:{value:e},type:{value:e.type,enumerable:!0},extractable:{value:void 0===n?e.extractable:n,enumerable:!0},algorithm:{value:void 0===t?e.algorithm:t,enumerable:!0},usages:{value:void 0===r?e.usages:r,enumerable:!0}})}function f(e){return"verify"===e||"encrypt"===e||"wrapKey"===e}function p(e){return"sign"===e||"decrypt"===e||"unwrapKey"===e}if("function"!=typeof Promise)throw"Promise support required";var A=e.crypto||e.msCrypto;if(A){var g=A.subtle||A.webkitSubtle;if(g){var v=e.Crypto||A.constructor||Object,m=e.SubtleCrypto||g.constructor||Object;e.CryptoKey||e.Key;var y=-1<e.navigator.userAgent.indexOf("Edge/"),b=!!e.msCrypto&&!y,E=!A.subtle&&!!A.webkitSubtle;if(b||E){var _={KoZIhvcNAQEB:"1.2.840.113549.1.1.1"},w={"1.2.840.113549.1.1.1":"KoZIhvcNAQEB"};if(["generateKey","importKey","unwrapKey"].forEach((function(e){var t=g[e];g[e]=function(i,l,d){var v=[].slice.call(arguments);switch(e){case"generateKey":var m=o(i),y=l,_=d;break;case"importKey":m=o(d),y=v[3],_=v[4],"jwk"===i&&((l=s(l)).alg||(l.alg=a(m)),l.key_ops||(l.key_ops="oct"!==l.kty?"d"in l?_.filter(p):_.filter(f):_.slice()),v[1]=c(l));break;case"unwrapKey":m=v[4],y=v[5],_=v[6],v[2]=d._key}if("generateKey"===e&&"HMAC"===m.name&&m.hash)return m.length=m.length||{"SHA-1":512,"SHA-256":512,"SHA-384":1024,"SHA-512":1024}[m.hash.name],g.importKey("raw",A.getRandomValues(new Uint8Array(m.length+7>>3)),m,y,_);if(E&&"generateKey"===e&&"RSASSA-PKCS1-v1_5"===m.name&&(!m.modulusLength||2048<=m.modulusLength))return(i=o(i)).name="RSAES-PKCS1-v1_5",delete i.hash,g.generateKey(i,!0,["encrypt","decrypt"]).then((function(e){return Promise.all([g.exportKey("jwk",e.publicKey),g.exportKey("jwk",e.privateKey)])})).then((function(e){return e[0].alg=e[1].alg=a(m),e[0].key_ops=_.filter(f),e[1].key_ops=_.filter(p),Promise.all([g.importKey("jwk",e[0],m,!0,e[0].key_ops),g.importKey("jwk",e[1],m,y,e[1].key_ops)])})).then((function(e){return{publicKey:e[0],privateKey:e[1]}}));if((E||b&&"SHA-1"===(m.hash||{}).name)&&"importKey"===e&&"jwk"===i&&"HMAC"===m.name&&"oct"===l.kty)return g.importKey("raw",r(n(l.k)),d,v[3],v[4]);if(E&&"importKey"===e&&("spki"===i||"pkcs8"===i))return g.importKey("jwk",u(l),d,v[3],v[4]);if(b&&"unwrapKey"===e)return g.decrypt(v[3],d,l).then((function(e){return g.importKey(i,e,v[4],v[5],v[6])}));try{var w=t.apply(g,v)}catch(e){return Promise.reject(e)}return b&&(w=new Promise((function(e,t){w.onabort=w.onerror=function(e){t(e)},w.oncomplete=function(t){e(t.target.result)}}))),w=w.then((function(e){return"HMAC"!==m.name||m.length||(m.length=8*e.algorithm.length),0==m.name.search("RSA")&&(m.modulusLength||(m.modulusLength=(e.publicKey||e).algorithm.modulusLength),m.publicExponent||(m.publicExponent=(e.publicKey||e).algorithm.publicExponent)),e.publicKey&&e.privateKey?{publicKey:new h(e.publicKey,m,y,_.filter(f)),privateKey:new h(e.privateKey,m,y,_.filter(p))}:new h(e,m,y,_)}))}})),["exportKey","wrapKey"].forEach((function(e){var o=g[e];g[e]=function(c,u,l){var h=[].slice.call(arguments);switch(e){case"exportKey":h[1]=u._key;break;case"wrapKey":h[1]=u._key,h[2]=l._key}if((E||b&&"SHA-1"===(u.algorithm.hash||{}).name)&&"exportKey"===e&&"jwk"===c&&"HMAC"===u.algorithm.name&&(h[0]="raw"),!E||"exportKey"!==e||"spki"!==c&&"pkcs8"!==c||(h[0]="jwk"),b&&"wrapKey"===e)return g.exportKey(c,u).then((function(e){return"jwk"===c&&(e=r(unescape(encodeURIComponent(JSON.stringify(s(e)))))),g.encrypt(h[3],l,e)}));try{var A=o.apply(g,h)}catch(e){return Promise.reject(e)}return b&&(A=new Promise((function(e,t){A.onabort=A.onerror=function(e){t(e)},A.oncomplete=function(t){e(t.target.result)}}))),"exportKey"===e&&"jwk"===c&&(A=A.then((function(e){return(E||b&&"SHA-1"===(u.algorithm.hash||{}).name)&&"HMAC"===u.algorithm.name?{kty:"oct",alg:a(u.algorithm),key_ops:u.usages.slice(),ext:!0,k:t(i(e))}:((e=s(e)).alg||(e.alg=a(u.algorithm)),e.key_ops||(e.key_ops="public"===u.type?u.usages.filter(f):"private"===u.type?u.usages.filter(p):u.usages.slice()),e)}))),!E||"exportKey"!==e||"spki"!==c&&"pkcs8"!==c||(A=A.then((function(e){var t=[["",null]],i=!1;switch((e=s(e)).kty){case"RSA":for(var o="n e d p q dp dq qi".split(" "),a=[],c=0;c<o.length&&o[c]in e;c++){var u=a[c]=r(n(e[o[c]]));128&u[0]&&(a[c]=new Uint8Array(u.length+1),a[c].set(u,1))}2<a.length&&(i=!0,a.unshift(new Uint8Array([0]))),t[0][0]="1.2.840.113549.1.1.1";break;default:throw new TypeError("Unsupported key type")}return t.push(new Uint8Array(d(a)).buffer),i?t.unshift(new Uint8Array([0])):t[1]={tag:3,value:t[1]},new Uint8Array(d(t)).buffer}))),A}})),["encrypt","decrypt","sign","verify"].forEach((function(e){var t=g[e];g[e]=function(n,r,i,a){if(b&&(!i.byteLength||a&&!a.byteLength))throw Error("Empy input is not allowed");var s=[].slice.call(arguments),c=o(n);!b||"sign"!==e&&"verify"!==e||"RSASSA-PKCS1-v1_5"!==n&&"HMAC"!==n||(s[0]={name:n}),b&&r.algorithm.hash&&(s[0].hash=s[0].hash||r.algorithm.hash),b&&"decrypt"===e&&"AES-GCM"===c.name&&(c=n.tagLength>>3,s[2]=(i.buffer||i).slice(0,i.byteLength-c),n.tag=(i.buffer||i).slice(i.byteLength-c)),s[1]=r._key;try{var u=t.apply(g,s)}catch(e){return Promise.reject(e)}return b&&(u=new Promise((function(t,n){u.onabort=u.onerror=function(e){n(e)},u.oncomplete=function(n){if(n=n.target.result,"encrypt"===e&&n instanceof AesGcmEncryptResult){var r=n.ciphertext,i=n.tag;(n=new Uint8Array(r.byteLength+i.byteLength)).set(new Uint8Array(r),0),n.set(new Uint8Array(i),r.byteLength),n=n.buffer}t(n)}}))),u}})),b){var S=g.digest;g.digest=function(e,t){if(!t.byteLength)throw Error("Empy input is not allowed");try{var n=S.call(g,e,t)}catch(e){return Promise.reject(e)}return n=new Promise((function(e,t){n.onabort=n.onerror=function(e){t(e)},n.oncomplete=function(t){e(t.target.result)}}))},e.crypto=Object.create(A,{getRandomValues:{value:function(e){return A.getRandomValues(e)}},subtle:{value:g}}),e.CryptoKey=h}E&&(A.subtle=g,e.Crypto=v,e.SubtleCrypto=m,e.CryptoKey=h)}}}}))}));var aw=oa("match"),wj=function(e){var t;return ea(e)&&(void 0!==(t=e[aw])?!!t:"RegExp"==Vb(e))},bw=[].push,cw=Math.min,Ae=!O((function(){return!RegExp(4294967295,"y")}));Kg("split",2,(function(e,t,n){var r="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||1<".".split(/()()/).length||"".split(/.?/).length?function(e,n){var r=String(hb(this));if(0==(n=void 0===n?4294967295:n>>>0))return[];if(void 0===e)return[r];if(!wj(e))return t.call(r,e,n);var i,o,a,s=[],c=0;for(e=new RegExp(e.source,(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":"")+"g");(i=xf.call(e,r))&&!((o=e.lastIndex)>c&&(s.push(r.slice(c,i.index)),1<i.length&&i.index<r.length&&bw.apply(s,i.slice(1)),a=i[0].length,c=o,s.length>=n));)e.lastIndex===i.index&&e.lastIndex++;return c===r.length?(a||!e.test(""))&&s.push(""):s.push(r.slice(c)),s.length>n?s.slice(0,n):s}:"0".split(void 0,0).length?function(e,n){return void 0===e&&0===n?[]:t.call(this,e,n)}:t;return[function(t,n){var i=hb(this),o=null==t?void 0:t[e];return void 0!==o?o.call(t,i,n):r.call(String(i),t,n)},function(e,i){var o=n(r,e,this,i,r!==t);if(o.done)return o.value;var a=qa(e);e=String(this);var s=Yc(a,RegExp);if(o=a.unicode,a=new s(Ae?a:"^(?:"+a.source+")",(a.ignoreCase?"i":"")+(a.multiline?"m":"")+(a.unicode?"u":"")+(Ae?"y":"g")),0==(i=void 0===i?4294967295:i>>>0))return[];if(0===e.length)return null===te(a,e)?[e]:[];var c=0,u=0;for(s=[];u<e.length;){a.lastIndex=Ae?u:0;var l,d=te(a,Ae?e:e.slice(u));if(null===d||(l=cw(za(a.lastIndex+(Ae?0:u)),e.length))===c)u=bj(e,u,o);else{if(s.push(e.slice(c,u)),s.length===i)return s;for(c=1;c<=d.length-1;c++)if(s.push(d[c]),s.length===i)return s;u=c=l}}return s.push(e.slice(c)),s}]}),!Ae),function(e){e.console||(e.console={}),e=e.console;for(var t,n=function(){},r=["memory"],i="assert clear count debug dir dirxml error exception group groupCollapsed groupEnd info log markTimeline profile profiles profileEnd show table time timeEnd timeline timelineEnd timeStamp trace warn".split(" ");t=r.pop();)e[t]||(e[t]={});for(;t=i.pop();)e[t]||(e[t]=n)}("undefined"==typeof window?Ta:window),N({target:"Object",stat:!0},{setPrototypeOf:$a});var dw=O((function(){Rb(1)}));N({target:"Object",stat:!0,forced:dw,sham:!Jn},{getPrototypeOf:function(e){return Rb(Wa(e))}});var Eo=[].slice,xj={},ew=Function.bind||function(e){var t=yb(this),n=Eo.call(arguments,1),r=function(){var i=n.concat(Eo.call(arguments));if(this instanceof r){var o=i.length;if(!(o in xj)){for(var a=[],s=0;s<o;s++)a[s]="a["+s+"]";xj[o]=Function("C,a","return new C("+a.join(",")+")")}i=xj[o](t,i)}else i=t.apply(e,i);return i};return ea(t.prototype)&&(r.prototype=t.prototype),r},yj=Wb("Reflect","construct"),Fo=O((function(){function e(){}return!(yj((function(){}),[],e)instanceof e)})),Go=!O((function(){yj((function(){}))})),Ho=Fo||Go;N({target:"Reflect",stat:!0,forced:Ho,sham:Ho},{construct:function(e,t){yb(e),qa(t);var n=3>arguments.length?e:yb(arguments[2]);if(Go&&!Fo)return yj(e,t,n);if(e==n){switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3])}return(n=[null]).push.apply(n,t),new(ew.apply(e,n))}n=n.prototype,n=$b(ea(n)?n:Object.prototype);var r=Function.apply.call(e,n,t);return ea(r)?r:n}}),N({target:"Reflect",stat:!0},{get:el});var Io=Db.f,fw=O((function(){Io(1)}));N({target:"Object",stat:!0,forced:!ja||fw,sham:!ja},{getOwnPropertyDescriptor:function(e,t){return Io(rb(e),t)}});var Jo=wd.f,gw={}.toString,Ko="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],zj=function(e){if(Ko&&"[object Window]"==gw.call(e))try{var t=Jo(e)}catch(e){t=Ko.slice()}else t=Jo(rb(e));return t},Lo={f:oa},hw=Ma.f,Yg=function(e){var t=B.Symbol||(B.Symbol={});P(t,e)||hw(t,e,{value:Lo.f(e)})},tb=yg("hidden"),Mo=oa("toPrimitive"),iw=Ua.set,No=Ua.getterFor("Symbol"),Kb=Object.prototype,ub=B.Symbol,Ff=Wb("JSON","stringify"),Oo=Db.f,cd=Ma.f,Po=zj,jw=kf,Fc=vd("symbols"),Gf=vd("op-symbols"),Aj=vd("string-to-symbol-registry"),Bj=vd("symbol-to-string-registry"),kw=vd("wks"),Cj=B.QObject,Dj=!Cj||!Cj.prototype||!Cj.prototype.findChild,Ej=ja&&O((function(){return 7!=$b(cd({},"a",{get:function(){return cd(this,"a",{value:7}).a}})).a}))?function(e,t,n){var r=Oo(Kb,t);r&&delete Kb[t],cd(e,t,n),r&&e!==Kb&&cd(Kb,t,r)}:cd,Fj=function(e,t){var n=Fc[e]=$b(ub.prototype);return iw(n,{type:"Symbol",tag:e,description:t}),ja||(n.description=t),n},Gj=Tm?function(e){return"symbol"==typeof e}:function(e){return Object(e)instanceof ub},Zg=function(e,t,n){return e===Kb&&Zg(Gf,t,n),qa(e),t=hc(t,!0),qa(n),P(Fc,t)?(n.enumerable?(P(e,tb)&&e[tb][t]&&(e[tb][t]=!1),n=$b(n,{enumerable:Xc(0,!1)})):(P(e,tb)||cd(e,tb,Xc(1,{})),e[tb][t]=!0),Ej(e,t,n)):cd(e,t,n)},Qo=function(e,t){qa(e);var n=rb(t);return t=Dc(n).concat(Hj(n)),Bd(t,(function(t){ja&&!Ij.call(n,t)||Zg(e,t,n[t])})),e},Ij=function(e){e=hc(e,!0);var t=jw.call(this,e);return!(this===Kb&&P(Fc,e)&&!P(Gf,e))&&(!(t||!P(this,e)||!P(Fc,e)||P(this,tb)&&this[tb][e])||t)},Ro=function(e,t){if(e=rb(e),t=hc(t,!0),e!==Kb||!P(Fc,t)||P(Gf,t)){var n=Oo(e,t);return!n||!P(Fc,t)||P(e,tb)&&e[tb][t]||(n.enumerable=!0),n}},So=function(e){e=Po(rb(e));var t=[];return Bd(e,(function(e){P(Fc,e)||P(je,e)||t.push(e)})),t},Hj=function(e){var t=e===Kb;e=Po(t?Gf:rb(e));var n=[];return Bd(e,(function(e){!P(Fc,e)||t&&!P(Kb,e)||n.push(Fc[e])})),n};if(xc||(ub=function(){if(this instanceof ub)throw TypeError("Symbol is not a constructor");var e=arguments.length&&void 0!==arguments[0]?String(arguments[0]):void 0,t=ie(e),n=function(e){this===Kb&&n.call(Gf,e),P(this,tb)&&P(this[tb],t)&&(this[tb][t]=!1),Ej(this,t,Xc(1,e))};return ja&&Dj&&Ej(Kb,t,{configurable:!0,set:n}),Fj(t,e)},Va(ub.prototype,"toString",(function(){return No(this).tag})),Va(ub,"withoutSetter",(function(e){return Fj(ie(e),e)})),kf=Ij,Ma.f=Zg,Db.f=Ro,wd.f=zj=So,nf.f=Hj,Lo.f=function(e){return Fj(oa(e),e)},ja&&(cd(ub.prototype,"description",{configurable:!0,get:function(){return No(this).description}}),Va(Kb,"propertyIsEnumerable",Ij,{unsafe:!0}))),N({global:!0,wrap:!0,forced:!xc,sham:!xc},{Symbol:ub}),Bd(Dc(kw),(function(e){Yg(e)})),N({target:"Symbol",stat:!0,forced:!xc},{for:function(e){if(e=String(e),P(Aj,e))return Aj[e];var t=ub(e);return Aj[e]=t,Bj[t]=e,t},keyFor:function(e){if(!Gj(e))throw TypeError(e+" is not a symbol");if(P(Bj,e))return Bj[e]},useSetter:function(){Dj=!0},useSimple:function(){Dj=!1}}),N({target:"Object",stat:!0,forced:!xc,sham:!ja},{create:function(e,t){return void 0===t?$b(e):Qo($b(e),t)},defineProperty:Zg,defineProperties:Qo,getOwnPropertyDescriptor:Ro}),N({target:"Object",stat:!0,forced:!xc},{getOwnPropertyNames:So,getOwnPropertySymbols:Hj}),N({target:"Object",stat:!0,forced:O((function(){nf.f(1)}))},{getOwnPropertySymbols:function(e){return nf.f(Wa(e))}}),Ff){var lw=!xc||O((function(){var e=ub();return"[null]"!=Ff([e])||"{}"!=Ff({a:e})||"{}"!=Ff(Object(e))}));N({target:"JSON",stat:!0,forced:lw},{stringify:function(e,t,n){for(var r,i=[e],o=1;arguments.length>o;)i.push(arguments[o++]);if(r=t,(ea(t)||void 0!==e)&&!Gj(e))return zd(t)||(t=function(e,t){if("function"==typeof r&&(t=r.call(this,e,t)),!Gj(t))return t}),i[1]=t,Ff.apply(null,i)}})}ub.prototype[Mo]||Ia(ub.prototype,Mo,ub.prototype.valueOf),yc(ub,"Symbol"),je[tb]=!0;var mw=Ma.f,Gc=B.Symbol;if(ja&&"function"==typeof Gc&&(!("description"in Gc.prototype)||void 0!==Gc().description)){var To={},Hf=function(){var e=1>arguments.length||void 0===arguments[0]?void 0:String(arguments[0]),t=this instanceof Hf?new Gc(e):void 0===e?Gc():Gc(e);return""===e&&(To[t]=!0),t};Sm(Hf,Gc);var Jj=Hf.prototype=Gc.prototype;Jj.constructor=Hf;var nw=Jj.toString,ow="Symbol(test)"==String(Gc("test")),pw=/^Symbol\((.*)\)[^)]+$/;mw(Jj,"description",{configurable:!0,get:function(){var e=ea(this)?this.valueOf():this,t=nw.call(e);return P(To,e)?"":""===(e=ow?t.slice(7,-1):t.replace(pw,"$1"))?void 0:e}}),N({global:!0,forced:!0},{Symbol:Hf})}Yg("toStringTag"),yc(Math,"Math",!0),yc(B.JSON,"JSON",!0),function(){function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function n(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&o(e,t)}function i(e){return(i=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function o(e,t){return(o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function a(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function s(e,t,n){return(s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=i(e)););if(e)return(t=Object.getOwnPropertyDescriptor(e,t)).get?t.get.call(n):t.value})(e,t,n||e)}var c=function(){function t(){e(this,t),Object.defineProperty(this,"listeners",{value:{},writable:!0,configurable:!0})}return n(t,[{key:"addEventListener",value:function(e,t,n){e in this.listeners||(this.listeners[e]=[]),this.listeners[e].push({callback:t,options:n})}},{key:"removeEventListener",value:function(e,t){if(e in this.listeners)for(var n=0,r=(e=this.listeners[e]).length;n<r;n++)if(e[n].callback===t){e.splice(n,1);break}}},{key:"dispatchEvent",value:function(e){if(e.type in this.listeners){for(var t=this.listeners[e.type].slice(),n=0,r=t.length;n<r;n++){var i=t[n];try{i.callback.call(this,e)}catch(e){Promise.resolve().then((function(){throw e}))}i.options&&i.options.once&&this.removeEventListener(e.type,i.callback)}return!e.defaultPrevented}}}]),t}(),u=function(t){function o(){e(this,o);var t=u.call(this);return t.listeners||c.call(a(t)),Object.defineProperty(a(t),"aborted",{value:!1,writable:!0,configurable:!0}),Object.defineProperty(a(t),"onabort",{value:null,writable:!0,configurable:!0}),t}r(o,t);var u=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n=i(e);if(t){var r=i(this).constructor;n=Reflect.construct(n,arguments,r)}else n=n.apply(this,arguments);return!n||"object"!==R(n)&&"function"!=typeof n?a(this):n}}(o);return n(o,[{key:"toString",value:function(){return"[object AbortSignal]"}},{key:"dispatchEvent",value:function(e){"abort"===e.type&&(this.aborted=!0,"function"==typeof this.onabort&&this.onabort.call(this,e)),s(i(o.prototype),"dispatchEvent",this).call(this,e)}}]),o}(c),l=function(){function t(){e(this,t),Object.defineProperty(this,"signal",{value:new u,writable:!0,configurable:!0})}return n(t,[{key:"abort",value:function(){try{var e=new Event("abort")}catch(t){"undefined"!=typeof document?document.createEvent?(e=document.createEvent("Event")).initEvent("abort",!1,!1):(e=document.createEventObject()).type="abort":e={type:"abort",bubbles:!1,cancelable:!1}}this.signal.dispatchEvent(e)}},{key:"toString",value:function(){return"[object AbortController]"}}]),t}();"undefined"!=typeof Symbol&&Symbol.toStringTag&&(l.prototype[Symbol.toStringTag]="AbortController",u.prototype[Symbol.toStringTag]="AbortSignal"),function(e){if(e.__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL){console.log("__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL=true is set, will force install polyfill");var t=!0}else t="function"==typeof e.Request&&!e.Request.prototype.hasOwnProperty("signal")||!e.AbortController;t&&(e.AbortController=l,e.AbortSignal=u)}("undefined"!=typeof self?self:Ta)}();var qw=Math.floor,rw=Math.log,sw=Math.LOG2E;N({target:"Math",stat:!0},{clz32:function(e){return(e>>>=0)?31-qw(rw(e+.5)*sw):32}});var tw=Math.log,uw=Math.LN2,Or=Math.clz32||function(e){return 31-tw(e>>>0)/uw|0},ld=String.fromCharCode,Uo={}.toString,Kj=window.Uint8Array,Lj=Kj||Array,vw=Uo.call((window.ArrayBuffer||Lj).prototype),Mj;fl.prototype.decode=function(e){if(e=e&&e.buffer||e,Uo.call(e)!==vw)throw Error("Failed to execute 'decode' on 'TextDecoder': The provided value is not of type '(ArrayBuffer or ArrayBufferView)'");for(var t="",n=0,r=0|(e=Kj?new Lj(e):e).length;n<r;n=n+32768|0)t+=ld.apply(0,e[Kj?"slice":"subarray"](n,n+32768|0));return t.replace(/[\xc0-\xff][\x80-\xbf]*/g,Nr)},window.TextDecoder||(window.TextDecoder=fl),gl.prototype.encode=function(e){for(var t=0|(e=void 0===e?"":(""+e).replace(/[\x80-\uD7ff\uDC00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]?/g,Pr)).length,n=new Lj(t),r=0;r<t;r=r+1|0)n[r]=e.charCodeAt(r);return n},window.TextEncoder||(window.TextEncoder=gl),function(e){var t,n,r,i,o,a,s,c,u,l;!function(e){e.LOGIN="LOGIN",e.LOGIN_SUCCESS="LOGIN_SUCCESS",e.LOGIN_FAILURE="LOGIN_FAILURE",e.LOGIN_TIMEOUT="LOGIN_TIMEOUT",e.INTERRUPTED="INTERRUPTED",e.LOGOUT="LOGOUT",e.BANNED_BY_SERVER="BANNED_BY_SERVER",e.REMOTE_LOGIN="REMOTE_LOGIN"}(t||(t={})),e.ConnectionChangeReason=t,function(e){e.DISCONNECTED="DISCONNECTED",e.CONNECTING="CONNECTING",e.CONNECTED="CONNECTED",e.RECONNECTING="RECONNECTING",e.ABORTED="ABORTED"}(n||(n={})),e.ConnectionState=n,function(e){e.IDLE="IDLE",e.SENT_TO_REMOTE="SENT_TO_REMOTE",e.RECEIVED_BY_REMOTE="RECEIVED_BY_REMOTE",e.ACCEPTED_BY_REMOTE="ACCEPTED_BY_REMOTE",e.REFUSED_BY_REMOTE="REFUSED_BY_REMOTE",e.CANCELED="CANCELED",e.FAILURE="FAILURE"}(r||(r={})),e.LocalInvitationState=r,function(e){e.INVITATION_RECEIVED="INVITATION_RECEIVED",e.ACCEPT_SENT_TO_LOCAL="ACCEPT_SENT_TO_LOCAL",e.REFUSED="REFUSED",e.ACCEPTED="ACCEPTED",e.CANCELED="CANCELED",e.FAILURE="FAILURE"}(i||(i={})),e.RemoteInvitationState=i,function(e){e.UNKNOWN="UNKNOWN",e.PEER_NO_RESPONSE="PEER_NO_RESPONSE",e.INVITATION_EXPIRE="INVITATION_EXPIRE",e.PEER_OFFLINE="PEER_OFFLINE",e.NOT_LOGGEDIN="NOT_LOGGEDIN"}(o||(o={})),e.LocalInvitationFailureReason=o,function(e){e.UNKNOWN="UNKNOWN",e.PEER_OFFLINE="PEER_OFFLINE",e.ACCEPT_FAILURE="ACCEPT_FAILURE",e.INVITATION_EXPIRE="INVITATION_EXPIRE"}(a||(a={})),e.RemoteInvitationFailureReason=a,function(e){e.ONLINE="ONLINE",e.UNREACHABLE="UNREACHABLE",e.OFFLINE="OFFLINE"}(s||(s={})),e.PeerOnlineState=s,(c||(c={})).ONLINE_STATUS="ONLINE_STATUS",e.PeerSubscriptionOption=c,function(e){e.TEXT="TEXT",e.RAW="RAW",e.IMAGE="IMAGE",e.FILE="FILE"}(u||(u={})),e.MessageType=u,function(e){e.CN="CN",e.NA="NA",e.EU="EU",e.AS="AS",e.JP="JP",e.IN="IN",e.GLOB="GLOB",e.OC="OC",e.SA="SA",e.AF="AF",e.OVS="OVS"}(l||(l={})),e.AreaCode=l}(Mj||(Mj={}));var S=Mj;N({target:"Array",proto:!0},{includes:function(e){return Pm(this,e,1<arguments.length?arguments[1]:void 0)}}),ye("includes");var Nj=function(e){if(wj(e))throw TypeError("The method doesn't accept regular expressions");return e},ww=oa("match"),Oj=function(e){var t=/./;try{"/./"[e](t)}catch(n){try{return t[ww]=!1,"/./"[e](t)}catch(e){}}return!1};N({target:"String",proto:!0,forced:!Oj("includes")},{includes:function(e){return!!~String(hb(this)).indexOf(Nj(e),1<arguments.length?arguments[1]:void 0)}});var xw=O((function(){Dc(1)}));N({target:"Object",stat:!0,forced:xw},{keys:function(e){return Dc(Wa(e))}});var dd={RECONNECTING_AP_INTERVAL:2e3,RECONNECTING_AP_NUM:2,DISABLE_MESSAGE_COMPRESSION:!1,LOG_UPLOAD_INTERVAL:3e3,LOG_HANDLER:void 0};Yg("iterator"),Yg("asyncIterator");var Pj=le("forEach")?[].forEach:function(e){return Bd(this,e,1<arguments.length?arguments[1]:void 0)},Vo;for(Vo in tj){var Wo=B[Vo],$g=Wo&&Wo.prototype;if($g&&$g.forEach!==Pj)try{Ia($g,"forEach",Pj)}catch(c){$g.forEach=Pj}}var yw=[].reverse,Xo=[1,2];N({target:"Array",proto:!0,forced:String(Xo)===String(Xo.reverse())},{reverse:function(){return zd(this)&&(this.length=this.length),yw.call(this)}});var w=Xa((function(e){e=function(e){function t(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}function n(e,t,n,o){return t=Object.create((t&&t.prototype instanceof i?t:i).prototype),o=new h(o||[]),t._invoke=function(e,t,n){var i=_;return function(o,a){if(i===S)throw Error("Generator is already running");if(i===T){if("throw"===o)throw a;return p()}for(n.method=o,n.arg=a;;){if((o=n.delegate)&&(o=u(o,n))){if(o===C)continue;return o}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===_)throw i=T,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);if(i=S,"normal"===(o=r(e,t,n)).type){if(i=n.done?T:w,o.arg===C)continue;return{value:o.arg,done:n.done}}"throw"===o.type&&(i=T,n.method="throw",n.arg=o.arg)}}}(e,n,o),t}function r(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}function i(){}function o(){}function a(){}function s(e){["next","throw","return"].forEach((function(n){t(e,n,(function(e){return this._invoke(n,e)}))}))}function c(e,t){function n(i,o,a,s){if("throw"!==(i=r(e[i],e,o)).type){var c=i.arg;return(i=c.value)&&"object"===R(i)&&v.call(i,"__await")?t.resolve(i.__await).then((function(e){n("next",e,a,s)}),(function(e){n("throw",e,a,s)})):t.resolve(i).then((function(e){c.value=e,a(c)}),(function(e){return n("throw",e,a,s)}))}s(i.arg)}var i;this._invoke=function(e,r){function o(){return new t((function(t,i){n(e,r,t,i)}))}return i=i?i.then(o,o):o()}}function u(e,t){var n=e.iterator[t.method];if(n===A){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=A,u(e,t),"throw"===t.method))return C;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return C}return"throw"===(n=r(n,e.iterator,t.arg)).type?(t.method="throw",t.arg=n.arg,t.delegate=null,C):(n=n.arg)?n.done?(t[e.resultName]=n.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=A),t.delegate=null,C):n:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,C)}function l(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function d(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function h(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(l,this),this.reset(!0)}function f(e){if(e){var t=e[y];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1;return(t=function t(){for(;++n<e.length;)if(v.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=A,t.done=!0,t}).next=t}}return{next:p}}function p(){return{value:A,done:!0}}var A,g=Object.prototype,v=g.hasOwnProperty,m="function"==typeof Symbol?Symbol:{},y=m.iterator||"@@iterator",b=m.asyncIterator||"@@asyncIterator",E=m.toStringTag||"@@toStringTag";try{t({},"")}catch(e){t=function(e,t,n){return e[t]=n}}e.wrap=n;var _="suspendedStart",w="suspendedYield",S="executing",T="completed",C={};(m={})[y]=function(){return this};var I=Object.getPrototypeOf;(I=I&&I(I(f([]))))&&I!==g&&v.call(I,y)&&(m=I);var x=a.prototype=i.prototype=Object.create(m);return o.prototype=x.constructor=a,a.constructor=o,o.displayName=t(a,E,"GeneratorFunction"),e.isGeneratorFunction=function(e){return!!(e="function"==typeof e&&e.constructor)&&(e===o||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,a):(e.__proto__=a,t(e,E,"GeneratorFunction")),e.prototype=Object.create(x),e},e.awrap=function(e){return{__await:e}},s(c.prototype),c.prototype[b]=function(){return this},e.AsyncIterator=c,e.async=function(t,r,i,o,a){void 0===a&&(a=Promise);var s=new c(n(t,r,i,o),a);return e.isGeneratorFunction(r)?s:s.next().then((function(e){return e.done?e.value:s.next()}))},s(x),t(x,E,"Generator"),x[y]=function(){return this},x.toString=function(){return"[object Generator]"},e.keys=function(e){var t,n=[];for(t in e)n.push(t);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},e.values=f,h.prototype={constructor:h,reset:function(e){if(this.next=this.prev=0,this.sent=this._sent=A,this.done=!1,this.delegate=null,this.method="next",this.arg=A,this.tryEntries.forEach(d),!e)for(var t in this)"t"===t.charAt(0)&&v.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=A)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){function t(t,r){return o.type="throw",o.arg=e,n.next=t,r&&(n.method="next",n.arg=A),!!r}if(this.done)throw e;for(var n=this,r=this.tryEntries.length-1;0<=r;--r){var i=this.tryEntries[r],o=i.completion;if("root"===i.tryLoc)return t("end");if(i.tryLoc<=this.prev){var a=v.call(i,"catchLoc"),s=v.call(i,"finallyLoc");if(a&&s){if(this.prev<i.catchLoc)return t(i.catchLoc,!0);if(this.prev<i.finallyLoc)return t(i.finallyLoc)}else if(a){if(this.prev<i.catchLoc)return t(i.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return t(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;0<=n;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&v.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var i=r;break}}return i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null),(n=i?i.completion:{}).type=e,n.arg=t,i?(this.method="next",this.next=i.finallyLoc,C):this.complete(n)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),C},finish:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),d(n),C}},catch:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var n=this.tryEntries[t];if(n.tryLoc===e){if("throw"===(e=n.completion).type){var r=e.arg;d(n)}return r}}throw Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:f(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=A),C}},e}(e.exports);try{regeneratorRuntime=e}catch(t){Function("r","regeneratorRuntime = r")(e)}})),Yo=!O((function(){return Object.isExtensible(Object.preventExtensions({}))})),Qj=Xa((function(e){var t=Ma.f,n=ie("meta"),r=0,i=Object.isExtensible||function(){return!0},o=function(e){t(e,n,{value:{objectID:"O"+ ++r,weakData:{}}})},a=e.exports={REQUIRED:!1,fastKey:function(e,t){if(!ea(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!P(e,n)){if(!i(e))return"F";if(!t)return"E";o(e)}return e[n].objectID},getWeakData:function(e,t){if(!P(e,n)){if(!i(e))return!0;if(!t)return!1;o(e)}return e[n].weakData},onFreeze:function(e){return Yo&&a.REQUIRED&&i(e)&&!P(e,n)&&o(e),e}};je[n]=!0})),Zo=function(e,t,n){var r=-1!==e.indexOf("Map"),i=-1!==e.indexOf("Weak"),o=r?"set":"add",a=B[e],s=a&&a.prototype,c=a,u={},l=function(e){var t=s[e];Va(s,e,"add"==e?function(e){return t.call(this,0===e?0:e),this}:"delete"==e?function(e){return!(i&&!ea(e))&&t.call(this,0===e?0:e)}:"get"==e?function(e){return i&&!ea(e)?void 0:t.call(this,0===e?0:e)}:"has"==e?function(e){return!(i&&!ea(e))&&t.call(this,0===e?0:e)}:function(e,n){return t.call(this,0===e?0:e,n),this})};if(jc(e,"function"!=typeof a||!(i||s.forEach&&!O((function(){(new a).entries().next()})))))c=n.getConstructor(t,e,r,o),Qj.REQUIRED=!0;else if(jc(e,!0)){var d=new c,h=d[o](i?{}:-0,1)!=d,f=O((function(){d.has(1)})),p=Dg((function(e){new a(e)})),A=!i&&O((function(){for(var e=new a,t=5;t--;)e[o](t,t);return!e.has(-0)}));p||((c=t((function(t,n){return zc(t,c,e),t=Sg(new a,t,c),null!=n&&Cg(n,t[o],{that:t,AS_ENTRIES:r}),t}))).prototype=s,s.constructor=c),(f||A)&&(l("delete"),l("has"),r&&l("get")),(A||h)&&l(o),i&&s.clear&&delete s.clear}return u[e]=c,N({global:!0,forced:c!=a},u),yc(c,e),i||n.setStrong(c,e,r),c},zw=Ma.f,$o=Qj.fastKey,ap=Ua.set,Rj=Ua.getterFor,bp={getConstructor:function(e,t,n,r){var i=e((function(e,o){zc(e,i,t),ap(e,{type:t,index:$b(null),first:void 0,last:void 0,size:0}),ja||(e.size=0),null!=o&&Cg(o,e[r],{that:e,AS_ENTRIES:n})})),o=Rj(t),a=function(e,t,n){var r,i=o(e),a=s(e,t);return a?a.value=n:(i.last=a={index:r=$o(t,!0),key:t,value:n,previous:t=i.last,next:void 0,removed:!1},i.first||(i.first=a),t&&(t.next=a),ja?i.size++:e.size++,"F"!==r&&(i.index[r]=a)),e},s=function(e,t){e=o(e);var n=$o(t);if("F"!==n)return e.index[n];for(e=e.first;e;e=e.next)if(e.key==t)return e};return of(i.prototype,{clear:function(){for(var e=o(this),t=e.index,n=e.first;n;)n.removed=!0,n.previous&&(n.previous=n.previous.next=void 0),delete t[n.index],n=n.next;e.first=e.last=void 0,ja?e.size=0:this.size=0},delete:function(e){var t=o(this);if(e=s(this,e)){var n=e.next,r=e.previous;delete t.index[e.index],e.removed=!0,r&&(r.next=n),n&&(n.previous=r),t.first==e&&(t.first=n),t.last==e&&(t.last=r),ja?t.size--:this.size--}return!!e},forEach:function(e){for(var t,n=o(this),r=ne(e,1<arguments.length?arguments[1]:void 0,3);t=t?t.next:n.first;)for(r(t.value,t.key,this);t&&t.removed;)t=t.previous},has:function(e){return!!s(this,e)}}),of(i.prototype,n?{get:function(e){return(e=s(this,e))&&e.value},set:function(e,t){return a(this,0===e?0:e,t)}}:{add:function(e){return a(this,e=0===e?0:e,e)}}),ja&&zw(i.prototype,"size",{get:function(){return o(this).size}}),i},setStrong:function(e,t,n){var r=t+" Iterator",i=Rj(t),o=Rj(r);oj(e,t,(function(e,t){ap(this,{type:r,target:e,state:i(e),kind:t,last:void 0})}),(function(){for(var e=o(this),t=e.kind,n=e.last;n&&n.removed;)n=n.previous;return e.target&&(e.last=n=n?n.next:e.state.first)?"keys"==t?{value:n.key,done:!1}:"values"==t?{value:n.value,done:!1}:{value:[n.key,n.value],done:!1}:(e.target=void 0,{value:void 0,done:!0})}),n?"entries":"values",!n,!0),qf(t)}};Zo("Set",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),bp);var Aw=yf("map");N({target:"Array",proto:!0,forced:!Aw},{map:function(e){return ho(this,e,1<arguments.length?arguments[1]:void 0)}});var Bw=/^[\t\n\x0B\f\r \u00a0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029\ufeff][\t\n\x0B\f\r \u00a0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029\ufeff]*/,Cw=/[\t\n\x0B\f\r \u00a0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029\ufeff][\t\n\x0B\f\r \u00a0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029\ufeff]*$/,Sj=function(e){return function(t){return t=String(hb(t)),1&e&&(t=t.replace(Bw,"")),2&e&&(t=t.replace(Cw,"")),t}};Sj(1),Sj(2);var Tj=Sj(3),ah=B.parseInt,Dw=/^[+-]?0[Xx]/,cp=8!==ah("\t\n\v\f\r                　\u2028\u2029\ufeff08")||22!==ah("\t\n\v\f\r                　\u2028\u2029\ufeff0x16")?function(e,t){return e=Tj(String(e)),ah(e,t>>>0||(Dw.test(e)?16:10))}:ah;N({global:!0,forced:parseInt!=cp},{parseInt:cp});var Ew=Math.floor,dp=function(e){return!ea(e)&&isFinite(e)&&Ew(e)===e},Fw=Math.abs;N({target:"Number",stat:!0},{isSafeInteger:function(e){return dp(e)&&9007199254740991>=Fw(e)}});var Gw=wd.f,Hw=Db.f,Iw=Ma.f,ed=B.Number,bh=ed.prototype,Jw="Number"==Vb($b(bh)),ep=function(e){var t,n=hc(e,!1);if("string"==typeof n&&2<n.length)if(43===(e=(n=Tj(n)).charCodeAt(0))||45===e){if(88===(e=n.charCodeAt(2))||120===e)return NaN}else if(48===e){switch(n.charCodeAt(1)){case 66:case 98:e=2;var r=49;break;case 79:case 111:e=8,r=55;break;default:return+n}var i=(n=n.slice(2)).length;for(t=0;t<i;t++){var o=n.charCodeAt(t);if(48>o||o>r)return NaN}return parseInt(n,e)}return+n};if(jc("Number",!ed(" 0o1")||!ed("0b1")||ed("+0x1"))){for(var Dd=function(e){var t=1>arguments.length?0:e,n=this;return n instanceof Dd&&(Jw?O((function(){bh.valueOf.call(n)})):"Number"!=Vb(n))?Sg(new ed(ep(t)),n,Dd):ep(t)},fp=ja?Gw(ed):"MAX_VALUE MIN_VALUE NaN NEGATIVE_INFINITY POSITIVE_INFINITY EPSILON isFinite isInteger isNaN isSafeInteger MAX_SAFE_INTEGER MIN_SAFE_INTEGER parseFloat parseInt isInteger fromString range".split(" "),Uj=0,ch;fp.length>Uj;Uj++)P(ed,ch=fp[Uj])&&!P(Dd,ch)&&Iw(Dd,ch,Hw(ed,ch));Dd.prototype=bh,bh.constructor=Dd,Va(B,"Number",Dd)}var gp=oa("isConcatSpreadable"),Kw=51<=pe||!O((function(){var e=[];return e[gp]=!1,e.concat()[0]!==e})),Lw=yf("concat");N({target:"Array",proto:!0,forced:!Kw||!Lw},{concat:function(e){var t,n=Wa(this),r=kj(n,0),i=0,o=-1;for(t=arguments.length;o<t;o++){var a=-1===o?n:arguments[o],s=a;if(ea(s)){var c=s[gp];s=void 0!==c?!!c:zd(s)}else s=!1;if(s){if(9007199254740991<i+(c=za(a.length)))throw TypeError("Maximum allowed index exceeded");for(s=0;s<c;s++,i++)s in a&&ue(r,i,a[s])}else{if(9007199254740991<=i)throw TypeError("Maximum allowed index exceeded");ue(r,i++,a)}}return r.length=i,r}});var Mw=!Dg((function(e){Array.from(e)}));N({target:"Array",stat:!0,forced:Mw},{from:function(e){var t,n=Wa(e),r="function"==typeof this?this:Array,i=arguments.length,o=1<i?arguments[1]:void 0,a=void 0!==o,s=Hi(n),c=0;if(a&&(o=ne(o,2<i?arguments[2]:void 0,2)),null==s||r==Array&&Fi(s)){var u=za(n.length);for(r=new r(u);u>c;c++)s=a?o(n[c],c):n[c],ue(r,c,s)}else for(i=(n=s.call(n)).next,r=new r;!(t=i.call(n)).done;c++){if(a){s=n;var l=o;t=[t.value,c];try{u=l(qa(t)[0],t[1])}catch(e){throw Ii(s),e}}else u=t.value;ue(r,c,s=u)}return r.length=c,r}});var Vj=Wb("Reflect","apply"),Nw=Function.apply,Ow=!O((function(){Vj((function(){}))}));N({target:"Reflect",stat:!0,forced:Ow},{apply:function(e,t,n){return yb(e),qa(n),Vj?Vj(e,t,n):Nw.call(e,t,n)}}),N({target:"Reflect",stat:!0},{ownKeys:Rm});var Pw=zj,Qw=O((function(){return!Object.getOwnPropertyNames(1)}));N({target:"Object",stat:!0,forced:Qw},{getOwnPropertyNames:Pw});var Be="object"===("undefined"==typeof Reflect?"undefined":R(Reflect))?Reflect:null,hp=Be&&"function"==typeof Be.apply?Be.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)},Rw=Be&&"function"==typeof Be.ownKeys?Be.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)},ip=Number.isNaN||function(e){return e!=e};aa.EventEmitter=aa,aa.prototype._events=void 0,aa.prototype._eventsCount=0,aa.prototype._maxListeners=void 0;var jp=10;Object.defineProperty(aa,"defaultMaxListeners",{enumerable:!0,get:function(){return jp},set:function(e){if("number"!=typeof e||0>e||ip(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");jp=e}}),aa.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},aa.prototype.setMaxListeners=function(e){if("number"!=typeof e||0>e||ip(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},aa.prototype.getMaxListeners=function(){return void 0===this._maxListeners?aa.defaultMaxListeners:this._maxListeners},aa.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);n="error"===e;var r=this._events;if(void 0!==r)n=n&&void 0===r.error;else if(!n)return!1;if(n){var i;if(0<t.length&&(i=t[0]),i instanceof Error)throw i;throw(t=Error("Unhandled error."+(i?" ("+i.message+")":""))).context=i,t}if(void 0===(n=r[e]))return!1;if("function"==typeof n)hp(n,this,t);else for(r=kl(n,i=n.length),n=0;n<i;++n)hp(r[n],this,t);return!0},aa.prototype.addListener=function(e,t){return hl(this,e,t,!1)},aa.prototype.on=aa.prototype.addListener,aa.prototype.prependListener=function(e,t){return hl(this,e,t,!0)},aa.prototype.once=function(e,t){return Zf(t),this.on(e,il(this,e,t)),this},aa.prototype.prependOnceListener=function(e,t){return Zf(t),this.prependListener(e,il(this,e,t)),this},aa.prototype.removeListener=function(e,t){var n;Zf(t);var r=this._events;if(void 0===r)return this;var i=r[e];if(void 0===i)return this;if(i===t||i.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,i.listener||t));else if("function"!=typeof i){var o=-1;for(n=i.length-1;0<=n;n--)if(i[n]===t||i[n].listener===t){var a=i[n].listener;o=n;break}if(0>o)return this;if(0===o)i.shift();else{for(;o+1<i.length;o++)i[o]=i[o+1];i.pop()}1===i.length&&(r[e]=i[0]),void 0!==r.removeListener&&this.emit("removeListener",e,a||t)}return this},aa.prototype.off=aa.prototype.removeListener,aa.prototype.removeAllListeners=function(e){var t=this._events;if(void 0===t)return this;if(void 0===t.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==t[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete t[e]),this;if(0===arguments.length){var n=Object.keys(t);for(t=0;t<n.length;++t){var r=n[t];"removeListener"!==r&&this.removeAllListeners(r)}return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(n=t[e]))this.removeListener(e,n);else if(void 0!==n)for(t=n.length-1;0<=t;t--)this.removeListener(e,n[t]);return this},aa.prototype.listeners=function(e){return jl(this,e,!0)},aa.prototype.rawListeners=function(e){return jl(this,e,!1)},aa.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):ll.call(e,t)},aa.prototype.listenerCount=ll,aa.prototype.eventNames=function(){return 0<this._eventsCount?Rw(this._events):[]},aa.once=function(e,t){return new Promise((function(n,r){function i(){void 0!==o&&e.removeListener("error",o),n([].slice.call(arguments))}if("error"!==t){var o=function(n){e.removeListener(t,i),r(n)};e.once("error",o)}e.once(t,i)}))};var Ce=Object.assign,kp=Object.defineProperty,lp=!Ce||O((function(){if(ja&&1!==Ce({b:1},Ce(kp({},"a",{enumerable:!0,get:function(){kp(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var e={},t={},n=Symbol();return e[n]=7,"abcdefghijklmnopqrst".split("").forEach((function(e){t[e]=e})),7!=Ce({},e)[n]||"abcdefghijklmnopqrst"!=Dc(Ce({},t)).join("")}))?function(e,t){for(var n=Wa(e),r=arguments.length,i=1,o=nf.f,a=kf;r>i;)for(var s,c=lf(arguments[i++]),u=o?Dc(c).concat(o(c)):Dc(c),l=u.length,d=0;l>d;)s=u[d++],(!ja||a.call(c,s))&&(n[s]=c[s]);return n}:Ce;N({target:"Object",stat:!0,forced:Object.assign!==lp},{assign:lp}),Zo("Map",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),bp);var Sw=Math.log,Tw=Math.LN2;N({target:"Math",stat:!0},{log2:function(e){return Sw(e)/Tw}}),Df("Float32",(function(e){return function(t,n,r){return e(this,t,n,r)}})),Df("Float64",(function(e){return function(t,n,r){return e(this,t,n,r)}})),Df("Uint16",(function(e){return function(t,n,r){return e(this,t,n,r)}})),Df("Uint32",(function(e){return function(t,n,r){return e(this,t,n,r)}}));var Gh=Symbol(),Fh=function(){};e:{try{var mp="1"===process.env.UMBRELLA_ASSERTS;break e}catch(c){}mp=!1}var Uw=mp?function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"assertion failed";if("function"==typeof e&&!e()||!e)throw Error("function"==typeof t?t():t)}:Fh,Vw=Qj.onFreeze,Wj=Object.freeze,Ww=O((function(){Wj(1)}));N({target:"Object",stat:!0,forced:Ww,sham:!Yo},{freeze:function(e){return Wj&&ea(e)?Wj(Vw(e)):e}});var Xw=Ma.f,Yw=wd.f,Zw=Ua.set,$w=oa("match"),mc=B.RegExp,Xj=mc.prototype,If=/a/g,Yj=/a/g,Zj=new mc(If)!==If;if(ja&&jc("RegExp",!Zj||Ig||O((function(){return Yj[$w]=!1,mc(If)!=If||mc(Yj)==Yj||"/a/i"!=mc(If,"i")})))){for(var Hc=function(e,t){var n,r=this instanceof Hc,i=wj(e),o=void 0===t;return!r&&i&&e.constructor===Hc&&o||(Zj?i&&!o&&(e=e.source):e instanceof Hc&&(o&&(t=Zi.call(e)),e=e.source),Ig&&(n=!!t&&-1<t.indexOf("y"))&&(t=t.replace(/y/g,"")),e=Sg(Zj?new mc(e,t):mc(e,t),r?this:Xj,Hc),Ig&&n&&Zw(e,{sticky:n})),e},ax=function(e){e in Hc||Xw(Hc,e,{configurable:!0,get:function(){return mc[e]},set:function(t){mc[e]=t}})},np=Yw(mc),op=0;np.length>op;)ax(np[op++]);Xj.constructor=Hc,Hc.prototype=Xj,Va(B,"RegExp",Hc)}qf("RegExp");var ak=function(e,t){return e===t?0:null==e?null==t?0:-1:null==t?null==e?0:1:"function"==typeof e.compare?e.compare(t):"function"==typeof t.compare?-t.compare(e):e<t?-1:e>t?1:0},bk=[],pp=bk.sort,bx=O((function(){bk.sort(void 0)})),cx=O((function(){bk.sort(null)})),dx=le("sort");N({target:"Array",proto:!0,forced:bx||!cx||!dx},{sort:function(e){return void 0===e?pp.call(Wa(this)):pp.call(Wa(this),yb(e))}});var qp=Object.getPrototypeOf({}),Jf=function(e,t){var n;return e===t||(null==e?e==t:"function"===R(e.equiv)?e.equiv(t):null==t?e==t:"function"===R(t.equiv)?t.equiv(e):"string"!==R(e)&&"string"!==R(t)&&(null!=(n=Object.getPrototypeOf(e))&&n!==qp||null!=(n=Object.getPrototypeOf(t))&&n!==qp?"function"!==R(e)&&void 0!==e.length&&"function"!==R(t)&&void 0!==t.length?fx(e,t):e instanceof Set&&t instanceof Set?gx(e,t):e instanceof Map&&t instanceof Map?hx(e,t):e instanceof Date&&t instanceof Date?e.getTime()===t.getTime():e instanceof RegExp&&t instanceof RegExp?e.toString()===t.toString():e!=e&&t!=t:ex(e,t)))},fx=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:Jf,r=e.length;if(r===t.length)for(;0<=--r&&n(e[r],t[r]););return 0>r},gx=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:Jf;return e.size===t.size&&n(I(e.keys()).sort(),I(t.keys()).sort())},hx=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:Jf;return e.size===t.size&&n(I(e).sort(),I(t).sort())},ex=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:Jf;if(Object.keys(e).length!==Object.keys(t).length)return!1;for(var r in e)if(!t.hasOwnProperty(r)||!n(e[r],t[r]))return!1;return!0},ix=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:function(e){return void 0!==e?": "+e:""};return function(n){function r(n){return W(this,r),i.call(this,e(n)+t(n))}ka(r,n);var i=la(r);return r}(Re(Error))}((function(){return"illegal argument(s)"})),dh=function(e){throw new ix(e)},rp=1/4294967295,jx=function(){function e(){W(this,e)}return Ea(e,[{key:"float",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1;return this.int()*rp*e}},{key:"norm",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1;return 2*(this.int()*rp-.5)*e}},{key:"minmax",value:function(e,t){return this.float()*(t-e)+e}}]),e}(),ck=Math.random,kx=new(function(e){function t(){return W(this,t),n.apply(this,arguments)}ka(t,e);var n=la(t);return Ea(t,[{key:"int",value:function(){return 4294967296*ck()>>>0}},{key:"float",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1;return ck()*e}},{key:"norm",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1;return 2*(ck()-.5)*e}}]),t}(jx)),lx=le("reduce"),mx=!kc&&79<pe&&83>pe;N({target:"Array",proto:!0,forced:!lx||mx},{reduce:function(e){return to(this,e,arguments.length,1<arguments.length?arguments[1]:void 0)}});var nl=function(e){return null!=e&&"function"==typeof e.xform?e.xform():e},$f=function(){function e(t){W(this,e),this.value=t}return Ea(e,[{key:"deref",value:function(){return this.value}}]),e}(),Hh=function(e){return e instanceof $f?e.deref():e},Sr=function(e,t){return[e,function(e){return e},t]},nx=w.mark((function(e,t){var n,r,i,o,a,s;return w.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:n=nl(e)(Rr()),r=n[1],i=n[2],o=0;case 4:if(!(o<t.length)){c.next=15;break}if(a=t[o],!((s=i([],a))instanceof $f)){c.next=10;break}return c.delegateYield(Hh(r(s.deref())),"t0",9);case 9:return c.abrupt("return");case 10:if(!s.length){c.next=12;break}return c.delegateYield(s,"t1",12);case 12:o++,c.next=4;break;case 15:return c.delegateYield(Hh(r([])),"t2",16);case 16:case"end":return c.stop()}}),nx)})),Tr=w.mark(ml),Ur=function(e,t){return[e[0],e[1],t]},sp=!0;"findIndex"in[]&&Array(1).findIndex((function(){sp=!1})),N({target:"Array",proto:!0,forced:sp},{findIndex:function(e){return jo(this,e,1<arguments.length?arguments[1]:void 0)}}),ye("findIndex"),N({target:"Array",proto:!0},{fill:fj}),ye("fill");var ox=function(){function e(t){W(this,e),this._length=0,t&&this.into(t)}return Ea(e,[{key:"length",get:function(){return this._length}},{key:"copy",value:function(){return new e(this)}},{key:"empty",value:function(){return new e}},{key:"clear",value:function(){this.release()}},{key:"release",value:function(){for(var e,t=this.head;t;)e=t.next,delete t.value,delete t.prev,delete t.next,t=e;return delete this.head,delete this.tail,this._length=0,!0}},{key:"compare",value:function(e){var t=this._length;if(t<e._length)return-1;if(t>e._length)return 1;if(0===t)return 0;t=this.head,e=e.head;for(var n=0;t&&0==n;)n=ak(t.value,e.value),t=t.next,e=e.next;return n}},{key:"equiv",value:function(t){if(!(t instanceof e||null!=t&&"function"!=typeof t&&void 0!==t.length)||this._length!==t.length)return!1;if(!this._length||this===t)return!0;for(var n=this.head,r=0;r<t.length;r++){if(!Jf(n.value,t[r]))return!1;n=n.next}return!0}},{key:Symbol.iterator,value:w.mark((function e(){var t;return w.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.head;case 1:if(!t){e.next=7;break}return e.next=4,t.value;case 4:t=t.next,e.next=1;break;case 7:case"end":return e.stop()}}),e,this)}))},{key:"seq",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:this.length;if(!(e>=t||0>e)){e=this.nthCell(e);var n=this.nthCell(t-1);return t=function e(t){return{first:function(){return t.value},next:function(){return t!==n&&t.next?e(t.next):void 0}}},e?t(e):void 0}}},{key:"cycle",value:w.mark((function e(){return w.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(this,"t0",2);case 2:e.next=0;break;case 4:case"end":return e.stop()}}),e,this)}))},{key:"$reduce",value:function(e,t){for(var n=this.head;n&&!(t instanceof $f);)t=e(t,n.value),n=n.next;return t}},{key:"drop",value:function(){var e=this.head;if(e)return(this.head=e.next)?delete this.head.prev:delete this.tail,this._length--,e.value}},{key:"cons",value:function(e){return e={value:e,next:this.head},this.head?this.head.prev=e:this.tail=e,this.head=e,this._length++,this}},{key:"insertBefore",value:function(e,t){return e||dh("cell is undefined"),t={value:t,next:e,prev:e.prev},e.prev?e.prev.next=t:this.head=t,e.prev=t,this._length++,this}},{key:"insertAfter",value:function(e,t){return e||dh("cell is undefined"),t={value:t,next:e.next,prev:e},e.next?e.next.prev=t:this.tail=t,e.next=t,this._length++,this}},{key:"insertBeforeNth",value:function(e,t){return 0>e&&(e+=this._length),0>=e?this.cons(t):(this.ensureIndex(e),this.insertBefore(this.nthCellUnsafe(e),t))}},{key:"insertAfterNth",value:function(e,t){return 0>e&&(e+=this._length),e>=this._length-1?this.push(t):(this.ensureIndex(e),this.insertAfter(this.nthCellUnsafe(e),t))}},{key:"insertSorted",value:function(e,t){t=t||ak;for(var n=this.head;n;){if(0>=t(e,n.value))return this.insertBefore(n,e);n=n.next}return this.push(e)}},{key:"find",value:function(e){for(var t=this.head;t;){if(t.value===e)return t;t=t.next}}},{key:"findWith",value:function(e){for(var t=this.head;t;){if(e(t.value))return t;t=t.next}}},{key:"concat",value:function(){for(var e=this.copy(),t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];for(t=0;t<n.length;t++)e.into(n[t]);return e}},{key:"into",value:function(e){for(var t=0;t<e.length;t++)this.push(e[t])}},{key:"slice",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:this.length;t=0>t?t+this._length:t,n=0>n?n+this._length:n,(0>t||0>n)&&dh("invalid indices: ${from} / ${to}");for(var r=new e,i=this.nthCell(t);i&&++t<=n;)r.push(i.value),i=i.next;return r}},{key:"splice",value:function(t){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,r=2<arguments.length?arguments[2]:void 0;if("number"==typeof t){0>t&&(t+=this._length),this.ensureIndex(t);var i=this.nthCellUnsafe(t)}else i=t;var o=new e;if(0<n)for(;i&&0<n--;)this.remove(i),o.push(i.value),i=i.next;else i&&(i=i.next);if(r)if(i)for(n=0;n<r.length;n++)this.insertBefore(i,r[n]);else for(i=0;i<r.length;i++)this.push(r[i]);return o}},{key:"remove",value:function(e){return e.prev?e.prev.next=e.next:this.head=e.next,e.next?e.next.prev=e.prev:this.tail=e.prev,this._length--,this}},{key:"swap",value:function(e,t){if(e!==t){var n=e.value;e.value=t.value,t.value=n}return this}},{key:"push",value:function(e){return this.tail?(e={value:e,prev:this.tail},this.tail=this.tail.next=e,this._length++,this):this.cons(e)}},{key:"pop",value:function(){var e=this.tail;if(e)return(this.tail=e.prev)?delete this.tail.next:delete this.head,this._length--,e.value}},{key:"first",value:function(){return this.head&&this.head.value}},{key:"peek",value:function(){return this.tail&&this.tail.value}},{key:"setHead",value:function(e){return this.head?(this.head.value=e,this):this.cons(e)}},{key:"setTail",value:function(e){return this.tail?(this.tail.value=e,this):this.push(e)}},{key:"setNth",value:function(e,t){var n=this.nthCell(e);return!n&&dh("index out of bounds: ".concat(e)),n.value=t,this}},{key:"nth",value:function(e,t){return(e=this.nthCell(e))?e.value:t}},{key:"nthCell",value:function(e){if(0>e&&(e+=this._length),!(0>e||e>=this._length))return this.nthCellUnsafe(e)}},{key:"rotateLeft",value:function(){switch(this._length){case 0:case 1:return this;case 2:return this.swap(this.head,this.tail);default:return this.push(this.drop())}}},{key:"rotateRight",value:function(){switch(this._length){case 0:case 1:return this;case 2:return this.swap(this.head,this.tail);default:var e=this.peek();return this.pop(),this.cons(e)}}},{key:"map",value:function(t){for(var n=new e,r=this.head;r;)n.push(t(r.value)),r=r.next;return n}},{key:"filter",value:function(t){for(var n=new e,r=this.head;r;)t(r.value)&&n.push(r.value),r=r.next;return n}},{key:"reduce",value:function(e,t){for(var n=this.head;n;)t=e(t,n.value),n=n.next;return t}},{key:"shuffle",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:kx;if(2>this._length)return this;for(e=null!=e?e:Math.ceil(1.5*Math.log2(this._length));0<e;e--)for(var n=this.head;n;){var r=n.next;.5>t.float()?this.asHead(n):this.asTail(n),n=r}return this}},{key:"sort",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:ak;if(!this._length)return this;for(var t=1;;){var n=this.head;this.tail=this.head=void 0;for(var r=0;n;){r++;for(var i=n,o=0,a=0;a<t&&(o++,i=i.next);a++);for(a=t;0<o||0<a&&i;){if(0===o){var s=i;i=i.next,a--}else i&&0!==a?0>=e(n.value,i.value)?(s=n,n=n.next,o--):(s=i,i=i.next,a--):(s=n,n=n.next,o--);this.tail?this.tail.next=s:this.head=s,s.prev=this.tail,this.tail=s}n=i}if(this.tail.next=void 0,1>=r)return this;t*=2}}},{key:"reverse",value:function(){for(var e=this.head,t=this.tail,n=(this._length>>>1)+(1&this._length);e&&t&&0<n;){var r=e.value;e.value=t.value,t.value=r,e=e.next,t=t.prev,n--}return this}},{key:"asHead",value:function(e){return e===this.head||(this.remove(e),this.head.prev=e,e.next=this.head,e.prev=void 0,this.head=e,this._length++),this}},{key:"asTail",value:function(e){return e===this.tail||(this.remove(e),this.tail.next=e,e.prev=this.tail,e.next=void 0,this.tail=e,this._length++),this}},{key:"toString",value:function(){for(var e=[],t=this.head;t;)e.push(String(t.value)),t=t.next;return e.join(", ")}},{key:"toJSON",value:function(){return I(this)}},{key:"ensureIndex",value:function(e){Uw(0<=e&&e<this._length,"index out of range: ".concat(e))}},{key:"nthCellUnsafe",value:function(e){if(e<=this._length>>1)var t=this.head,n="next";else t=this.tail,n="prev",e=this._length-e-1;for(;0<e--&&t;)t=t[n];return t}}]),e}(),nc=function(){function e(t,n){W(this,e),n=Object.assign({maxlen:1/0,maxsize:1/0,map:function(){return new Map},ksize:function(){return 0},vsize:function(){return 0}},n),this.map=n.map(),this.items=new ox,this._size=0,this.opts=n,t&&this.into(t)}return Ea(e,[{key:"length",get:function(){return this.items.length}},{key:"size",get:function(){return this._size}},{key:Symbol.iterator,value:function(){return this.entries()}},{key:"entries",value:function(){return ag((function(e){return[e.k,e]}),this.items)}},{key:"keys",value:function(){return ag((function(e){return e.k}),this.items)}},{key:"values",value:function(){return ag((function(e){return e.v}),this.items)}},{key:"copy",value:function(){var e=this.empty();e.items=this.items.copy();for(var t=e.items.head;t;)e.map.set(t.value.k,t),t=t.next;return e}},{key:"empty",value:function(){return new e(null,this.opts)}},{key:"release",value:function(){this._size=0,this.map.clear();var e=this.opts.release;if(e){for(var t;t=this.items.drop();)e(t.k,t.v);return!0}return this.items.release()}},{key:"has",value:function(e){return this.map.has(e)}},{key:"get",value:function(e,t){return(e=this.map.get(e))?this.resetEntry(e):t}},{key:"set",value:function(e,t){var n=this.opts.ksize(e)+this.opts.vsize(t),r=this.map.get(e);return this._size+=Math.max(0,n-(r?r.value.s:0)),this.ensureSize()&&this.doSetEntry(r,e,t,n),t}},{key:"into",value:function(e){for(var t=0;t<e.length;t++){var n=e[t];this.set(n[0],n[1])}return this}},{key:"getSet",value:function(e,t){var n=this,r=this.map.get(e);return r?Promise.resolve(this.resetEntry(r)):t().then((function(t){return n.set(e,t)}))}},{key:"delete",value:function(e){return!!(e=this.map.get(e))&&(this.removeEntry(e),!0)}},{key:"resetEntry",value:function(e){return this.items.asTail(e),e.value.v}},{key:"ensureSize",value:function(){for(var e=this.opts.release,t=this.opts.maxsize,n=this.opts.maxlen;this._size>t||this.length>=n;){var r=this.items.drop();if(!r)return!1;this.map.delete(r.k),e&&e(r.k,r.v),this._size-=r.s}return!0}},{key:"removeEntry",value:function(e){var t=e.value;this.map.delete(t.k),this.items.remove(e),this.opts.release&&this.opts.release(t.k,t.v),this._size-=t.s}},{key:"doSetEntry",value:function(e,t,n,r){e?(e.value.v=n,e.value.s=r,this.items.asTail(e)):(this.items.push({k:t,v:n,s:r}),this.map.set(t,this.items.tail))}}]),e}(),px=function(e){function t(e,r){return W(this,t),r=Object.assign({ttl:36e5},r),n.call(this,e,r)}ka(t,e);var n=la(t);return Ea(t,[{key:"empty",value:function(){return new t(null,this.opts)}},{key:"has",value:function(e){return void 0!==this.get(e)}},{key:"get",value:function(e,t){if(e=this.map.get(e)){if(e.value.t>=Date.now())return this.resetEntry(e);this.removeEntry(e)}return t}},{key:"set",value:function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:this.opts.ttl,r=this.opts.ksize(e)+this.opts.vsize(t),i=this.map.get(e);return this._size+=Math.max(0,r-(i?i.value.s:0)),this.ensureSize()&&(n=Date.now()+n,i?(i.value.v=t,i.value.s=r,i.value.t=n,this.items.asTail(i)):(this.items.push({k:e,v:t,s:r,t:n}),this.map.set(e,this.items.tail))),t}},{key:"getSet",value:function(e,t){var n=this,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:this.opts.ttl,i=this.get(e);return i?Promise.resolve(i):t().then((function(t){return n.set(e,t,r)}))}},{key:"prune",value:function(){for(var e=Date.now(),t=this.items.head;t;)t.value.t<e&&this.removeEntry(t),t=t.next}},{key:"ensureSize",value:function(){for(var e=this.opts.maxsize,n=this.opts.maxlen,r=Date.now(),i=this.items.head;i&&(this._size>e||this.length>=n);)i.value.t<r&&this.removeEntry(i),i=i.next;return Dh(kd(t.prototype),"ensureSize",this).call(this)}}]),t}(nc),tp="object"==R(Ta)&&Ta&&Ta.Object===Object&&Ta,qx="object"==("undefined"==typeof self?"undefined":R(self))&&self&&self.Object===Object&&self,Bb=tp||qx||Function("return this")(),Lb=Bb.Symbol,up=Object.prototype,rx=up.hasOwnProperty,sx=up.toString,Kf=Lb?Lb.toStringTag:void 0,tx=Object.prototype.toString,vp=Lb?Lb.toStringTag:void 0,Ed=function(e){if(null==e)e=void 0===e?"[object Undefined]":"[object Null]";else if(vp&&vp in Object(e)){var t=rx.call(e,Kf),n=e[Kf];try{e[Kf]=void 0;var r=!0}catch(e){}var i=sx.call(e);r&&(t?e[Kf]=n:delete e[Kf]),e=i}else e=tx.call(e);return e},jb=function(e){var t=R(e);return null!=e&&("object"==t||"function"==t)},ci=function(e){return!!jb(e)&&("[object Function]"==(e=Ed(e))||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e)},dk=Bb["__core-js_shared__"],wp=function(){var e=/[^.]+$/.exec(dk&&dk.keys&&dk.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),ux=Function.prototype.toString,Fd=function(e){if(null!=e){try{return ux.call(e)}catch(e){}return e+""}return""},vx=/^\[object .+?Constructor\]$/,wx=RegExp("^"+Function.prototype.toString.call(Object.prototype.hasOwnProperty).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Gd=function(e,t){return e=null==e?void 0:e[t],!jb(e)||wp&&wp in e||!(ci(e)?wx:vx).test(Fd(e))?void 0:e},Lf=Gd(Object,"create"),xx=Object.prototype.hasOwnProperty,yx=Object.prototype.hasOwnProperty;nd.prototype.clear=function(){this.__data__=Lf?Lf(null):{},this.size=0},nd.prototype.delete=function(e){return e=this.has(e)&&delete this.__data__[e],this.size-=e?1:0,e},nd.prototype.get=function(e){var t=this.__data__;return Lf?"__lodash_hash_undefined__"===(e=t[e])?void 0:e:xx.call(t,e)?t[e]:void 0},nd.prototype.has=function(e){var t=this.__data__;return Lf?void 0!==t[e]:yx.call(t,e)},nd.prototype.set=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=Lf&&void 0===t?"__lodash_hash_undefined__":t,this};var Mf=function(e,t){return e===t||e!=e&&t!=t},eh=function(e,t){for(var n=e.length;n--;)if(Mf(e[n][0],t))return n;return-1},zx=Array.prototype.splice;Qd.prototype.clear=function(){this.__data__=[],this.size=0},Qd.prototype.delete=function(e){var t=this.__data__;return!(0>(e=eh(t,e))||(e==t.length-1?t.pop():zx.call(t,e,1),--this.size,0))},Qd.prototype.get=function(e){var t=this.__data__;return 0>(e=eh(t,e))?void 0:t[e][1]},Qd.prototype.has=function(e){return-1<eh(this.__data__,e)},Qd.prototype.set=function(e,t){var n=this.__data__,r=eh(n,e);return 0>r?(++this.size,n.push([e,t])):n[r][1]=t,this};var cg=Qd,Nf=Gd(Bb,"Map"),fh=function(e,t){e=e.__data__;var n=R(t);return("string"==n||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==t:null===t)?e["string"==typeof t?"string":"hash"]:e.map};Rd.prototype.clear=function(){this.size=0,this.__data__={hash:new nd,map:new(Nf||cg),string:new nd}},Rd.prototype.delete=function(e){return e=fh(this,e).delete(e),this.size-=e?1:0,e},Rd.prototype.get=function(e){return fh(this,e).get(e)},Rd.prototype.has=function(e){return fh(this,e).has(e)},Rd.prototype.set=function(e,t){var n=fh(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this};var bg=Rd;Te.prototype.add=Te.prototype.push=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},Te.prototype.has=function(e){return this.__data__.has(e)};var xp=function(e,t,n,r){var i=e.length;for(n+=r?1:-1;r?n--:++n<i;)if(t(e[n],n,e))return n;return-1},Ax=function(e){return e!=e},Bx=function(e,t){var n;if(n=!(null==e||!e.length)){if(t==t)e:{n=-1;for(var r=e.length;++n<r;)if(e[n]===t){e=n;break e}e=-1}else e=xp(e,Ax,0);n=-1<e}return n},Cx=function(e,t,n){for(var r=-1,i=null==e?0:e.length;++r<i;)if(n(t,e[r]))return!0;return!1},Dx=function(e,t){return e.has(t)},De=Gd(Bb,"Set"),Ex=function(){},ek=function(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n},Fx=1/0,Gx=De&&1/ek(new De([,-0]))[1]==Fx?function(e){return new De(e)}:Ex,fk=function(e,t,n){var r=-1,i=Bx,o=e.length,a=!0,s=[],c=s;if(n)a=!1,i=Cx;else if(200<=o){if(i=t?null:Gx(e))return ek(i);a=!1,i=Dx,c=new Te}else c=t?[]:s;e:for(;++r<o;){var u=e[r],l=t?t(u):u;if(u=n||0!==u?u:0,a&&l==l){for(var d=c.length;d--;)if(c[d]===l)continue e;t&&c.push(l),s.push(u)}else i(c,l,n)||(c!==s&&c.push(l),s.push(u))}return s},yp=function(e){for(var t=-1,n=null==e?0:e.length,r={};++t<n;){var i=e[t];r[i[0]]=i[1]}return r},Ud=function(e,t){for(var n=-1,r=null==e?0:e.length,i=Array(r);++n<r;)i[n]=t(e[n],n,e);return i};Sd.prototype.clear=function(){this.__data__=new cg,this.size=0},Sd.prototype.delete=function(e){var t=this.__data__;return e=t.delete(e),this.size=t.size,e},Sd.prototype.get=function(e){return this.__data__.get(e)},Sd.prototype.has=function(e){return this.__data__.has(e)},Sd.prototype.set=function(e,t){var n=this.__data__;if(n instanceof cg){var r=n.__data__;if(!Nf||199>r.length)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new bg(r)}return n.set(e,t),this.size=n.size,this};var Td=Sd,cs=function(e,t){for(var n=-1,r=null==e?0:e.length;++n<r&&!1!==t(e[n],n,e););return e},gh=function(){try{var e=Gd(Object,"defineProperty");return e({},"",{}),e}catch(e){}}(),Of=function(e,t,n){"__proto__"==t&&gh?gh(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n},Hx=Object.prototype.hasOwnProperty,rl=function(e,t,n){var r=e[t];Hx.call(e,t)&&Mf(r,n)&&(void 0!==n||t in e)||Of(e,t,n)},de=function(e,t,n,r){var i=!n;n||(n={});for(var o=-1,a=t.length;++o<a;){var s=t[o],c=r?r(n[s],e[s],s,n,e):void 0;void 0===c&&(c=e[s]),i?Of(n,s,c):rl(n,s,c)}return n},cc=function(e){return null!=e&&"object"==R(e)},zp=function(e){return cc(e)&&"[object Arguments]"==Ed(e)},Ap=Object.prototype,Ix=Ap.hasOwnProperty,Jx=Ap.propertyIsEnumerable,cf=zp(function(){return arguments}())?zp:function(e){return cc(e)&&Ix.call(e,"callee")&&!Jx.call(e,"callee")},Ya=Array.isArray,Kx=function(){return!1},Ve=Xa((function(e,t){var n=(t=t&&!t.nodeType&&t)&&e&&!e.nodeType&&e;t=n&&n.exports===t?Bb.Buffer:void 0,e.exports=(t?t.isBuffer:void 0)||Kx})),Lx=/^(?:0|[1-9]\d*)$/,gk=function(e,t){var n=R(e);return!!(t=null==t?9007199254740991:t)&&("number"==n||"symbol"!=n&&Lx.test(e))&&-1<e&&0==e%1&&e<t},hk=function(e){return"number"==typeof e&&-1<e&&0==e%1&&9007199254740991>=e},Ba={};Ba["[object Float32Array]"]=Ba["[object Float64Array]"]=Ba["[object Int8Array]"]=Ba["[object Int16Array]"]=Ba["[object Int32Array]"]=Ba["[object Uint8Array]"]=Ba["[object Uint8ClampedArray]"]=Ba["[object Uint16Array]"]=Ba["[object Uint32Array]"]=!0,Ba["[object Arguments]"]=Ba["[object Array]"]=Ba["[object ArrayBuffer]"]=Ba["[object Boolean]"]=Ba["[object DataView]"]=Ba["[object Date]"]=Ba["[object Error]"]=Ba["[object Function]"]=Ba["[object Map]"]=Ba["[object Number]"]=Ba["[object Object]"]=Ba["[object RegExp]"]=Ba["[object Set]"]=Ba["[object String]"]=Ba["[object WeakMap]"]=!1;var Mx=function(e){return cc(e)&&hk(e.length)&&!!Ba[Ed(e)]},hh=function(e){return function(t){return e(t)}},Ee=Xa((function(e,t){var n=t&&!t.nodeType&&t;n=(t=n&&e&&!e.nodeType&&e)&&t.exports===n&&tp.process;e:{try{var r=t&&t.require&&t.require("util").types;if(r){var i=r;break e}i=n&&n.binding&&n.binding("util");break e}catch(e){}i=void 0}e.exports=i})),Bp=Ee&&Ee.isTypedArray,Nh=Bp?hh(Bp):Mx,Nx=Object.prototype.hasOwnProperty,Cp=function(e,t){var n=Ya(e),r=!n&&cf(e),i=!n&&!r&&Ve(e),o=!n&&!r&&!i&&Nh(e);if(n=n||r||i||o){r=e.length;for(var a=String,s=-1,c=Array(r);++s<r;)c[s]=a(s);r=c}else r=[];for(var u in a=r.length,e)!t&&!Nx.call(e,u)||n&&("length"==u||i&&("offset"==u||"parent"==u)||o&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||gk(u,a))||r.push(u);return r},Ox=Object.prototype,ik=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||Ox)},Dp=function(e,t){return function(n){return e(t(n))}},Px=Dp(Object.keys,Object),Qx=Object.prototype.hasOwnProperty,sd=function(e){return null!=e&&hk(e.length)&&!ci(e)},Rc=function(e){if(sd(e))e=Cp(e);else if(ik(e)){var t,n=[];for(t in Object(e))Qx.call(e,t)&&"constructor"!=t&&n.push(t);e=n}else e=Px(e);return e},Zr=function(e,t){return e&&de(t,Rc(t),e)},Rx=Object.prototype.hasOwnProperty,We=function(e){if(sd(e))e=Cp(e,!0);else if(jb(e)){var t=ik(e),n=[];for(r in e)("constructor"!=r||!t&&Rx.call(e,r))&&n.push(r);e=n}else{var r=[];if(null!=e)for(t in Object(e))r.push(t);e=r}return e},Xr=function(e,t){return e&&de(t,We(t),e)},ol=Xa((function(e,t){var n=(t=t&&!t.nodeType&&t)&&e&&!e.nodeType&&e,r=(t=n&&n.exports===t?Bb.Buffer:void 0)?t.allocUnsafe:void 0;e.exports=function(e,t){return t?e.slice():(t=e.length,t=r?r(t):new e.constructor(t),e.copy(t),t)}})),Ih=function(e,t){var n=-1,r=e.length;for(t||(t=Array(r));++n<r;)t[n]=e[n];return t},Sx=function(e,t){for(var n=-1,r=null==e?0:e.length,i=0,o=[];++n<r;){var a=e[n];t(a,n,e)&&(o[i++]=a)}return o},Ep=function(){return[]},Tx=Object.prototype.propertyIsEnumerable,Fp=Object.getOwnPropertySymbols,jk=Fp?function(e){return null==e?[]:(e=Object(e),Sx(Fp(e),(function(t){return Tx.call(e,t)})))}:Ep,Yr=function(e,t){return de(e,jk(e),t)},Mh=function(e,t){for(var n=-1,r=t.length,i=e.length;++n<r;)e[i+n]=t[n];return e},kk=Dp(Object.getPrototypeOf,Object),Gp=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)Mh(t,jk(e)),e=kk(e);return t}:Ep,Wr=function(e,t){return de(e,Gp(e),t)},Hp=function(e,t,n){return t=t(e),Ya(e)?t:Mh(t,n(e))},Jh=function(e){return Hp(e,Rc,jk)},ql=function(e){return Hp(e,We,Gp)},lk=Gd(Bb,"DataView"),mk=Gd(Bb,"Promise"),nk=Gd(Bb,"WeakMap"),Ux=Fd(lk),Vx=Fd(Nf),Wx=Fd(mk),Xx=Fd(De),Yx=Fd(nk),Hd=Ed;(lk&&"[object DataView]"!=Hd(new lk(new ArrayBuffer(1)))||Nf&&"[object Map]"!=Hd(new Nf)||mk&&"[object Promise]"!=Hd(mk.resolve())||De&&"[object Set]"!=Hd(new De)||nk&&"[object WeakMap]"!=Hd(new nk))&&(Hd=function(e){var t=Ed(e);if(e=(e="[object Object]"==t?e.constructor:void 0)?Fd(e):"")switch(e){case Ux:return"[object DataView]";case Vx:return"[object Map]";case Wx:return"[object Promise]";case Xx:return"[object Set]";case Yx:return"[object WeakMap]"}return t});var Ue=Hd,Zx=Object.prototype.hasOwnProperty,Vr=function(e){var t=e.length,n=new e.constructor(t);return t&&"string"==typeof e[0]&&Zx.call(e,"index")&&(n.index=e.index,n.input=e.input),n},ih=Bb.Uint8Array,ok=function(e){var t=new e.constructor(e.byteLength);return new ih(t).set(new ih(e)),t},$x=/\w*$/,Ip=Lb?Lb.prototype:void 0,Jp=Ip?Ip.valueOf:void 0,am=function(e,t){return t=t?ok(e.buffer):e.buffer,new e.constructor(t,e.byteOffset,e.length)},$r=function(e,t,n){var r=e.constructor;switch(t){case"[object ArrayBuffer]":return ok(e);case"[object Boolean]":case"[object Date]":return new r(+e);case"[object DataView]":return t=n?ok(e.buffer):e.buffer,new e.constructor(t,e.byteOffset,e.byteLength);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return am(e,n);case"[object Map]":return new r;case"[object Number]":case"[object String]":return new r(e);case"[object RegExp]":return(t=new e.constructor(e.source,$x.exec(e))).lastIndex=e.lastIndex,t;case"[object Set]":return new r;case"[object Symbol]":return Jp?Object(Jp.call(e)):{}}},Kp=Object.create,ay=function(){function e(){}return function(t){return jb(t)?Kp?Kp(t):(e.prototype=t,t=new e,e.prototype=void 0,t):{}}}(),pl=function(e){return"function"!=typeof e.constructor||ik(e)?{}:ay(kk(e))},by=function(e){return cc(e)&&"[object Map]"==Ue(e)},Lp=Ee&&Ee.isMap,bs=Lp?hh(Lp):by,cy=function(e){return cc(e)&&"[object Set]"==Ue(e)},Mp=Ee&&Ee.isSet,as=Mp?hh(Mp):cy,ra={};ra["[object Arguments]"]=ra["[object Array]"]=ra["[object ArrayBuffer]"]=ra["[object DataView]"]=ra["[object Boolean]"]=ra["[object Date]"]=ra["[object Float32Array]"]=ra["[object Float64Array]"]=ra["[object Int8Array]"]=ra["[object Int16Array]"]=ra["[object Int32Array]"]=ra["[object Map]"]=ra["[object Number]"]=ra["[object Object]"]=ra["[object RegExp]"]=ra["[object Set]"]=ra["[object String]"]=ra["[object Symbol]"]=ra["[object Uint8Array]"]=ra["[object Uint8ClampedArray]"]=ra["[object Uint16Array]"]=ra["[object Uint32Array]"]=!0,ra["[object Error]"]=ra["[object Function]"]=ra["[object WeakMap]"]=!1;var Vd=function(e){return"symbol"==R(e)||cc(e)&&"[object Symbol]"==Ed(e)},dy=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,ey=/^\w*$/,pk=function(e,t){if(Ya(e))return!1;var n=R(e);return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!Vd(e))||ey.test(e)||!dy.test(e)||null!=t&&e in Object(t)};Kh.Cache=bg;var fy=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,gy=/\\(\\)?/g,hy=function(e){var t=(e=Kh(e,(function(e){return 500===t.size&&t.clear(),e}))).cache;return e}((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(fy,(function(e,n,r,i){t.push(r?i.replace(gy,"$1"):n||e)})),t})),ds=1/0,Np=Lb?Lb.prototype:void 0,tl=Np?Np.toString:void 0,jh=function(e,t){return Ya(e)?e:pk(e,t)?[e]:hy(null==e?"":sl(e))},iy=1/0,Pf=function(e){if("string"==typeof e||Vd(e))return e;var t=e+"";return"0"==t&&1/e==-iy?"-0":t},kh=function(e,t){for(var n=0,r=(t=jh(t,e)).length;null!=e&&n<r;)e=e[Pf(t[n++])];return n&&n==r?e:void 0},jy=function(e,t){if(!(2>(t=jh(t,e)).length)){var n=t,r=0,i=-1,o=-1,a=n.length;for(0>r&&(r=-r>a?0:a+r),0>(i=i>a?a:i)&&(i+=a),a=r>i?0:i-r>>>0,r>>>=0,i=Array(a);++o<a;)i[o]=n[o+r];e=kh(e,i)}return(n=null==e)||(n=null==t?0:t.length,n=delete e[Pf(n?t[n-1]:void 0)]),n},Op=Function.prototype.toString,ky=Object.prototype.hasOwnProperty,ly=Op.call(Object),bm=function(e){return!(!cc(e)||"[object Object]"!=Ed(e))&&(null===(e=kk(e))||"function"==typeof(e=ky.call(e,"constructor")&&e.constructor)&&e instanceof e&&Op.call(e)==ly)},my=function(e){return bm(e)?void 0:e},Pp=Lb?Lb.isConcatSpreadable:void 0,es=function(e){return Ya(e)||cf(e)||!!(Pp&&e&&e[Pp])},ny=function(e){return null!=e&&e.length?Lh(e,1):[]},oy=function(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)},Qp=Math.max,Rp=function(e,t,n){return t=Qp(void 0===t?e.length-1:t,0),function(){for(var r=arguments,i=-1,o=Qp(r.length-t,0),a=Array(o);++i<o;)a[i]=r[t+i];for(i=-1,o=Array(t+1);++i<t;)o[i]=r[i];return o[t]=n(a),oy(e,this,o)}},py=function(e){return function(){return e}},lh=function(e){return e},qy=Date.now,Sp=function(e){var t=0,n=0;return function(){var r=qy(),i=16-(r-n);if(n=r,0<i){if(800<=++t)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}(gh?function(e,t){return gh(e,"toString",{configurable:!0,enumerable:!1,value:py(t),writable:!0})}:lh),rg=function(e){return Sp(Rp(e,void 0,ny),e+"")}((function(e,t){var n={};if(null==e)return n;var r=!1;t=Ud(t,(function(t){return t=jh(t,e),r||(r=1<t.length),t})),de(e,ql(e),n),r&&(n=dg(n,7,my));for(var i=t.length;i--;)jy(n,t[i]);return n})),ry=function(e,t,n,r){for(var i=-1,o=null==e?0:e.length;++i<o;){var a=e[i];t(r,a,n(a),e)}return r},$l=function(e,t,n){for(var r=-1,i=Object(e),o=(n=n(e)).length;o--;){var a=n[++r];if(!1===t(i[a],a,i))break}return e},Tp=function(e,t){return e&&$l(e,t,Rc)},qk=function(e,t){return function(t,n){if(null==t)return t;if(!sd(t))return e(t,n);for(var r=t.length,i=-1,o=Object(t);++i<r&&!1!==n(o[i],i,o););return t}}(Tp),sy=function(e,t,n,r){return qk(e,(function(e,i,o){t(r,e,n(e),o)})),r},Up=function(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1},ul=function(e,t,n,r,i,o){var a=1&n,s=e.length,c=t.length;if(s!=c&&!(a&&c>s))return!1;c=o.get(e);var u=o.get(t);if(c&&u)return c==t&&u==e;c=-1,u=!0;var l=2&n?new Te:void 0;for(o.set(e,t),o.set(t,e);++c<s;){var d=e[c],h=t[c];if(r)var f=a?r(h,d,c,t,e,o):r(d,h,c,e,t,o);if(void 0!==f){if(f)continue;u=!1;break}if(l){if(!Up(t,(function(e,t){if(!l.has(t)&&(d===e||i(d,e,n,r,o)))return l.push(t)}))){u=!1;break}}else if(d!==h&&!i(d,h,n,r,o)){u=!1;break}}return o.delete(e),o.delete(t),u},ty=function(e){var t=-1,n=Array(e.size);return e.forEach((function(e,r){n[++t]=[r,e]})),n},Vp=Lb?Lb.prototype:void 0,rk=Vp?Vp.valueOf:void 0,fs=function(e,t,n,r,i,o,a){switch(n){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)break;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":if(e.byteLength!=t.byteLength||!o(new ih(e),new ih(t)))break;return!0;case"[object Boolean]":case"[object Date]":case"[object Number]":return Mf(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var s=ty;case"[object Set]":if(s||(s=ek),e.size!=t.size&&!(1&r))break;return(n=a.get(e))?n==t:(r|=2,a.set(e,t),t=ul(s(e),s(t),r,i,o,a),a.delete(e),t);case"[object Symbol]":if(rk)return rk.call(e)==rk.call(t)}return!1},gs=Object.prototype.hasOwnProperty,vl=Object.prototype.hasOwnProperty,uy=function(e,t,n,r){var i=n.length,o=i,a=!r;if(null==e)return!o;for(e=Object(e);i--;){var s=n[i];if(a&&s[2]?s[1]!==e[s[0]]:!(s[0]in e))return!1}for(;++i<o;){var c=(s=n[i])[0],u=e[c],l=s[1];if(a&&s[2]){if(void 0===u&&!(c in e))return!1}else{if(s=new Td,r)var d=r(u,l,c,e,t,s);if(void 0===d?!Wd(l,u,3,r,s):!d)return!1}}return!0},vy=function(e){for(var t=Rc(e),n=t.length;n--;){var r=t[n],i=e[r];t[n]=[r,i,i==i&&!jb(i)]}return t},Wp=function(e,t){return function(n){return null!=n&&n[e]===t&&(void 0!==t||e in Object(n))}},wy=function(e){var t=vy(e);return 1==t.length&&t[0][2]?Wp(t[0][0],t[0][1]):function(n){return n===e||uy(n,e,t)}},xy=function(e,t){return pk(e)&&t==t&&!jb(t)?Wp(Pf(e),t):function(n){var r=null==n?void 0:kh(n,e);if(void 0===(r=void 0===r?void 0:r)&&r===t){if(r=null!=n){for(var i=-1,o=(r=jh(r=e,n)).length,a=!1;++i<o;){var s=Pf(r[i]);if(!(a=null!=n&&null!=n&&s in Object(n)))break;n=n[s]}r=a||++i!=o?a:!!(o=null==n?0:n.length)&&hk(o)&&gk(s,o)&&(Ya(n)||cf(n))}s=r}else s=Wd(t,r,3);return s}},yy=function(e){return function(t){return null==t?void 0:t[e]}},zy=function(e){return function(t){return kh(t,e)}},Fe=function(e){return"function"==typeof e?e:null==e?lh:"object"==R(e)?Ya(e)?xy(e[0],e[1]):wy(e):pk(e)?yy(Pf(e)):zy(e)},sk=function(e,t){return function(t,n){return(Ya(t)?ry:sy)(t,e,Fe(n),{})}}((function(e,t,n){Of(e,n,t)})),oc=function(e,t){var n={};return t=Fe(t),Tp(e,(function(e,r,i){Of(n,r,t(e,r,i))})),n};N({target:"String",proto:!0,forced:O((function(){var e="".sub('"');return e!==e.toLowerCase()||3<e.split('"').length}))},{sub:function(){return"<sub>"+String(hb(this))+"</sub>"}});var U=sa,Mb=null;try{Mb=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(c){}sa.prototype.__isLong__,Object.defineProperty(sa.prototype,"__isLong__",{value:!0}),sa.isLong=kb;var xl={},wl={};sa.fromInt=od,sa.fromNumber=Eb,sa.fromBits=ta;var eg=Math.pow;sa.fromString=Oh,sa.fromValue=Sb;var Xd=4294967296,yl=Xd*Xd,Al=yl/2,Xp=od(16777216),Fb=od(0);sa.ZERO=Fb;var pd=od(0,!0);sa.UZERO=pd;var Ge=od(1);sa.ONE=Ge;var Yp=od(1,!0);sa.UONE=Yp;var tk=od(-1);sa.NEG_ONE=tk;var Bl=ta(-1,2147483647,!1);sa.MAX_VALUE=Bl;var zl=ta(-1,-1,!0);sa.MAX_UNSIGNED_VALUE=zl;var lb=ta(0,-2147483648,!1);sa.MIN_VALUE=lb;var E=sa.prototype;E.toInt=function(){return this.unsigned?this.low>>>0:this.low},E.toNumber=function(){return this.unsigned?(this.high>>>0)*Xd+(this.low>>>0):this.high*Xd+(this.low>>>0)},E.toString=function(e){if(2>(e=e||10)||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(lb)){var t=Eb(e),n=this.div(t);return t=n.mul(t).sub(this),n.toString(e)+t.toInt().toString(e)}return"-"+this.neg().toString(e)}n=Eb(eg(e,6),this.unsigned),t=this;for(var r="";;){var i=t.div(n),o=(t.sub(i.mul(n)).toInt()>>>0).toString(e);if((t=i).isZero())return o+r;for(;6>o.length;)o="0"+o;r=""+o+r}},E.getHighBits=function(){return this.high},E.getHighBitsUnsigned=function(){return this.high>>>0},E.getLowBits=function(){return this.low},E.getLowBitsUnsigned=function(){return this.low>>>0},E.getNumBitsAbs=function(){if(this.isNegative())return this.eq(lb)?64:this.neg().getNumBitsAbs();for(var e=0!=this.high?this.high:this.low,t=31;0<t&&0==(e&1<<t);t--);return 0!=this.high?t+33:t+1},E.isZero=function(){return 0===this.high&&0===this.low},E.eqz=E.isZero,E.isNegative=function(){return!this.unsigned&&0>this.high},E.isPositive=function(){return this.unsigned||0<=this.high},E.isOdd=function(){return 1==(1&this.low)},E.isEven=function(){return 0==(1&this.low)},E.equals=function(e){return kb(e)||(e=Sb(e)),(this.unsigned===e.unsigned||1!=this.high>>>31||1!=e.high>>>31)&&this.high===e.high&&this.low===e.low},E.eq=E.equals,E.notEquals=function(e){return!this.eq(e)},E.neq=E.notEquals,E.ne=E.notEquals,E.lessThan=function(e){return 0>this.comp(e)},E.lt=E.lessThan,E.lessThanOrEqual=function(e){return 0>=this.comp(e)},E.lte=E.lessThanOrEqual,E.le=E.lessThanOrEqual,E.greaterThan=function(e){return 0<this.comp(e)},E.gt=E.greaterThan,E.greaterThanOrEqual=function(e){return 0<=this.comp(e)},E.gte=E.greaterThanOrEqual,E.ge=E.greaterThanOrEqual,E.compare=function(e){if(kb(e)||(e=Sb(e)),this.eq(e))return 0;var t=this.isNegative(),n=e.isNegative();return t&&!n?-1:!t&&n?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1},E.comp=E.compare,E.negate=function(){return!this.unsigned&&this.eq(lb)?lb:this.not().add(Ge)},E.neg=E.negate,E.add=function(e){kb(e)||(e=Sb(e));var t=this.high>>>16,n=65535&this.high,r=this.low>>>16,i=e.high>>>16,o=65535&e.high,a=e.low>>>16;return r=(a=((e=(65535&this.low)+(65535&e.low))>>>16)+(r+a))>>>16,ta((65535&a)<<16|65535&e,(t=((r+=n+o)>>>16)+(t+i)&65535)<<16|65535&r,this.unsigned)},E.subtract=function(e){return kb(e)||(e=Sb(e)),this.add(e.neg())},E.sub=E.subtract,E.multiply=function(e){if(this.isZero())return Fb;if(kb(e)||(e=Sb(e)),Mb){var t=Mb.mul(this.low,this.high,e.low,e.high);return ta(t,Mb.get_high(),this.unsigned)}if(e.isZero())return Fb;if(this.eq(lb))return e.isOdd()?lb:Fb;if(e.eq(lb))return this.isOdd()?lb:Fb;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(Xp)&&e.lt(Xp))return Eb(this.toNumber()*e.toNumber(),this.unsigned);t=this.high>>>16;var n=65535&this.high,r=this.low>>>16,i=65535&this.low,o=e.high>>>16,a=65535&e.high,s=e.low>>>16,c=i*(e=65535&e.low),u=(c>>>16)+r*e,l=u>>>16;l+=(u=(65535&u)+i*s)>>>16;var d=(l+=n*e)>>>16;return ta((65535&u)<<16|65535&c,(d=(d+=(l=(65535&l)+r*s)>>>16)+((l=(65535&l)+i*a)>>>16)+(t*e+n*s+r*a+i*o)&65535)<<16|65535&l,this.unsigned)},E.mul=E.multiply,E.divide=function(e){if(kb(e)||(e=Sb(e)),e.isZero())throw Error("division by zero");if(Mb)return this.unsigned||-2147483648!==this.high||-1!==e.low||-1!==e.high?ta(e=(this.unsigned?Mb.div_u:Mb.div_s)(this.low,this.high,e.low,e.high),Mb.get_high(),this.unsigned):this;if(this.isZero())return this.unsigned?pd:Fb;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return pd;if(e.gt(this.shru(1)))return Yp;var t=pd}else{if(this.eq(lb)){if(e.eq(Ge)||e.eq(tk))return lb;if(e.eq(lb))return Ge;var n=this.shr(1).div(e).shl(1);if(n.eq(Fb))return e.isNegative()?Ge:tk;var r=this.sub(e.mul(n));return n.add(r.div(e))}if(e.eq(lb))return this.unsigned?pd:Fb;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();t=Fb}for(r=this;r.gte(e);){n=Math.max(1,Math.floor(r.toNumber()/e.toNumber()));var i=Math.ceil(Math.log(n)/Math.LN2);i=48>=i?1:eg(2,i-48);for(var o=Eb(n),a=o.mul(e);a.isNegative()||a.gt(r);)a=(o=Eb(n-=i,this.unsigned)).mul(e);o.isZero()&&(o=Ge),t=t.add(o),r=r.sub(a)}return t},E.div=E.divide,E.modulo=function(e){return kb(e)||(e=Sb(e)),Mb?ta(e=(this.unsigned?Mb.rem_u:Mb.rem_s)(this.low,this.high,e.low,e.high),Mb.get_high(),this.unsigned):this.sub(this.div(e).mul(e))},E.mod=E.modulo,E.rem=E.modulo,E.not=function(){return ta(~this.low,~this.high,this.unsigned)},E.and=function(e){return kb(e)||(e=Sb(e)),ta(this.low&e.low,this.high&e.high,this.unsigned)},E.or=function(e){return kb(e)||(e=Sb(e)),ta(this.low|e.low,this.high|e.high,this.unsigned)},E.xor=function(e){return kb(e)||(e=Sb(e)),ta(this.low^e.low,this.high^e.high,this.unsigned)},E.shiftLeft=function(e){return kb(e)&&(e=e.toInt()),0==(e&=63)?this:32>e?ta(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):ta(0,this.low<<e-32,this.unsigned)},E.shl=E.shiftLeft,E.shiftRight=function(e){return kb(e)&&(e=e.toInt()),0==(e&=63)?this:32>e?ta(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):ta(this.high>>e-32,0<=this.high?0:-1,this.unsigned)},E.shr=E.shiftRight,E.shiftRightUnsigned=function(e){if(kb(e)&&(e=e.toInt()),0==(e&=63))return this;var t=this.high;return 32>e?ta(this.low>>>e|t<<32-e,t>>>e,this.unsigned):ta(32===e?t:t>>>e-32,0,this.unsigned)},E.shru=E.shiftRightUnsigned,E.shr_u=E.shiftRightUnsigned,E.toSigned=function(){return this.unsigned?ta(this.low,this.high,!1):this},E.toUnsigned=function(){return this.unsigned?this:ta(this.low,this.high,!0)},E.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()},E.toBytesLE=function(){var e=this.high,t=this.low;return[255&t,t>>>8&255,t>>>16&255,t>>>24,255&e,e>>>8&255,e>>>16&255,e>>>24]},E.toBytesBE=function(){var e=this.high,t=this.low;return[e>>>24,e>>>16&255,e>>>8&255,255&e,t>>>24,t>>>16&255,t>>>8&255,255&t]},sa.fromBytes=function(e,t,n){return n?sa.fromBytesLE(e,t):sa.fromBytesBE(e,t)},sa.fromBytesLE=function(e,t){return new sa(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,t)},sa.fromBytesBE=function(e,t){return new sa(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],t)};var Ph=function(e,t){return(Ph=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},uk=!1,Gb={Promise:void 0,set useDeprecatedSynchronousErrorHandling(e){e?console.warn("DEPRECATED! RxJS was set to use deprecated synchronous error handling behavior by code at: \n"+Error().stack):uk&&console.log("RxJS: Back to a better error behavior. Thank you. <3"),uk=e},get useDeprecatedSynchronousErrorHandling(){return uk}},mh={closed:!0,next:function(e){},error:function(e){if(Gb.useDeprecatedSynchronousErrorHandling)throw e;Zd(e)},complete:function(){}},Hb=Array.isArray||function(e){return e&&"number"==typeof e.length},Xe=function(){function e(e){return Error.call(this),this.message=e?e.length+" errors occurred during unsubscription:\n"+e.map((function(e,t){return t+1+") "+e.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=e,this}return e.prototype=Object.create(Error.prototype),e}(),Ka=function(){function e(e){this.closed=!1,this._subscriptions=this._parentOrParents=null,e&&(this._ctorUnsubscribe=!0,this._unsubscribe=e)}return e.prototype.unsubscribe=function(){if(!this.closed){var t=this._parentOrParents,n=this._ctorUnsubscribe,r=this._unsubscribe,i=this._subscriptions;if(this.closed=!0,this._subscriptions=this._parentOrParents=null,t instanceof e)t.remove(this);else if(null!==t)for(var o=0;o<t.length;++o)t[o].remove(this);if(Yd(r)){n&&(this._unsubscribe=void 0);try{r.call(this)}catch(e){var a=e instanceof Xe?Cl(e.errors):[e]}}if(Hb(i))for(o=-1,t=i.length;++o<t;)if(Qh(n=i[o]))try{n.unsubscribe()}catch(e){a=a||[],e instanceof Xe?a=a.concat(Cl(e.errors)):a.push(e)}if(a)throw new Xe(a)}},e.prototype.add=function(t){var n=t;if(!t)return e.EMPTY;switch(R(t)){case"function":n=new e(t);case"object":if(n===this||n.closed||"function"!=typeof n.unsubscribe)return n;if(this.closed)return n.unsubscribe(),n;n instanceof e||(t=n,(n=new e)._subscriptions=[t]);break;default:throw Error("unrecognized teardown "+t+" added to Subscription.")}if(null===(t=n._parentOrParents))n._parentOrParents=this;else if(t instanceof e){if(t===this)return n;n._parentOrParents=[t,this]}else{if(-1!==t.indexOf(this))return n;t.push(this)}return null===(t=this._subscriptions)?this._subscriptions=[n]:t.push(n),n},e.prototype.remove=function(e){var t=this._subscriptions;t&&-1!==(e=t.indexOf(e))&&t.splice(e,1)},e.EMPTY=function(e){return e.closed=!0,e}(new e),e}(),nh="function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random(),fa=function(e){function t(n,r,i){var o=e.call(this)||this;switch(o.syncErrorValue=null,o.syncErrorThrown=!1,o.syncErrorThrowable=!1,o.isStopped=!1,arguments.length){case 0:o.destination=mh;break;case 1:if(!n){o.destination=mh;break}if("object"===R(n)){n instanceof t?(o.syncErrorThrowable=n.syncErrorThrowable,o.destination=n,n.add(o)):(o.syncErrorThrowable=!0,o.destination=new Zp(o,n));break}default:o.syncErrorThrowable=!0,o.destination=new Zp(o,n,r,i)}return o}return M(t,e),t.prototype[nh]=function(){return this},t.create=function(e,n,r){return(e=new t(e,n,r)).syncErrorThrowable=!1,e},t.prototype.next=function(e){this.isStopped||this._next(e)},t.prototype.error=function(e){this.isStopped||(this.isStopped=!0,this._error(e))},t.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this))},t.prototype._next=function(e){this.destination.next(e)},t.prototype._error=function(e){this.destination.error(e),this.unsubscribe()},t.prototype._complete=function(){this.destination.complete(),this.unsubscribe()},t.prototype._unsubscribeAndRecycle=function(){var e=this._parentOrParents;return this._parentOrParents=null,this.unsubscribe(),this.isStopped=this.closed=!1,this._parentOrParents=e,this},t}(Ka),Zp=function(e){function t(t,n,r,i){var o=e.call(this)||this;if(o._parentSubscriber=t,t=o,Yd(n))var a=n;else n&&(a=n.next,r=n.error,i=n.complete,n!==mh&&(Yd((t=Object.create(n)).unsubscribe)&&o.add(t.unsubscribe.bind(t)),t.unsubscribe=o.unsubscribe.bind(o)));return o._context=t,o._next=a,o._error=r,o._complete=i,o}return M(t,e),t.prototype.next=function(e){if(!this.isStopped&&this._next){var t=this._parentSubscriber;Gb.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?this.__tryOrSetError(t,this._next,e)&&this.unsubscribe():this.__tryOrUnsub(this._next,e)}},t.prototype.error=function(e){if(!this.isStopped){var t=this._parentSubscriber,n=Gb.useDeprecatedSynchronousErrorHandling;if(this._error)n&&t.syncErrorThrowable?this.__tryOrSetError(t,this._error,e):this.__tryOrUnsub(this._error,e),this.unsubscribe();else if(t.syncErrorThrowable)n?(t.syncErrorValue=e,t.syncErrorThrown=!0):Zd(e),this.unsubscribe();else{if(this.unsubscribe(),n)throw e;Zd(e)}}},t.prototype.complete=function(){var e=this;if(!this.isStopped){var t=this._parentSubscriber;if(this._complete){var n=function(){return e._complete.call(e._context)};Gb.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?this.__tryOrSetError(t,n):this.__tryOrUnsub(n)}this.unsubscribe()}},t.prototype.__tryOrUnsub=function(e,t){try{e.call(this._context,t)}catch(e){if(this.unsubscribe(),Gb.useDeprecatedSynchronousErrorHandling)throw e;Zd(e)}},t.prototype.__tryOrSetError=function(e,t,n){if(!Gb.useDeprecatedSynchronousErrorHandling)throw Error("bad call");try{t.call(this._context,n)}catch(t){return Gb.useDeprecatedSynchronousErrorHandling?(e.syncErrorValue=t,e.syncErrorThrown=!0):Zd(t),!0}return!1},t.prototype._unsubscribe=function(){var e=this._parentSubscriber;this._parentSubscriber=this._context=null,e.unsubscribe()},t}(fa),$d="function"==typeof Symbol&&Symbol.observable||"@@observable",V=function(){function e(e){this._isScalar=!1,e&&(this._subscribe=e)}return e.prototype.lift=function(t){var n=new e;return n.source=this,n.operator=t,n},e.prototype.subscribe=function(e,t,n){var r=this.operator;e:{if(e){if(e instanceof fa)break e;if(e[nh]){e=e[nh]();break e}}e=e||t||n?new fa(e,t,n):new fa(mh)}if(r?e.add(r.call(e,this.source)):e.add(this.source||Gb.useDeprecatedSynchronousErrorHandling&&!e.syncErrorThrowable?this._subscribe(e):this._trySubscribe(e)),Gb.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable&&(e.syncErrorThrowable=!1,e.syncErrorThrown))throw e.syncErrorValue;return e},e.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){Gb.useDeprecatedSynchronousErrorHandling&&(e.syncErrorThrown=!0,e.syncErrorValue=t),Rh(e)?e.error(t):console.warn(t)}},e.prototype.forEach=function(e,t){var n=this;return new(t=El(t))((function(t,r){var i=n.subscribe((function(t){try{e(t)}catch(e){r(e),i&&i.unsubscribe()}}),r,t)}))},e.prototype._subscribe=function(e){var t=this.source;return t&&t.subscribe(e)},e.prototype[$d]=function(){return this},e.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return 0===e.length?this:Dl(e)(this)},e.prototype.toPromise=function(e){var t=this;return new(e=El(e))((function(e,n){var r;t.subscribe((function(e){return r=e}),(function(e){return n(e)}),(function(){return e(r)}))}))},e.create=function(t){return new e(t)},e}(),fd=function(){function e(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return e.prototype=Object.create(Error.prototype),e}(),$p=function(e){function t(t,n){var r=e.call(this)||this;return r.subject=t,r.subscriber=n,r.closed=!1,r}return M(t,e),t.prototype.unsubscribe=function(){if(!this.closed){this.closed=!0;var e=this.subject,t=e.observers;this.subject=null,!t||0===t.length||e.isStopped||e.closed||-1!==(e=t.indexOf(this.subscriber))&&t.splice(e,1)}},t}(Ka),aq=function(e){function t(t){var n=e.call(this,t)||this;return n.destination=t,n}return M(t,e),t}(fa),La=function(e){function t(){var t=e.call(this)||this;return t.observers=[],t.closed=!1,t.isStopped=!1,t.hasError=!1,t.thrownError=null,t}return M(t,e),t.prototype[nh]=function(){return new aq(this)},t.prototype.lift=function(e){var t=new bq(this,this);return t.operator=e,t},t.prototype.next=function(e){if(this.closed)throw new fd;if(!this.isStopped){var t=this.observers,n=t.length;t=t.slice();for(var r=0;r<n;r++)t[r].next(e)}},t.prototype.error=function(e){if(this.closed)throw new fd;this.hasError=!0,this.thrownError=e,this.isStopped=!0;var t=this.observers,n=t.length;t=t.slice();for(var r=0;r<n;r++)t[r].error(e);this.observers.length=0},t.prototype.complete=function(){if(this.closed)throw new fd;this.isStopped=!0;var e=this.observers,t=e.length;e=e.slice();for(var n=0;n<t;n++)e[n].complete();this.observers.length=0},t.prototype.unsubscribe=function(){this.closed=this.isStopped=!0,this.observers=null},t.prototype._trySubscribe=function(t){if(this.closed)throw new fd;return e.prototype._trySubscribe.call(this,t)},t.prototype._subscribe=function(e){if(this.closed)throw new fd;return this.hasError?(e.error(this.thrownError),Ka.EMPTY):this.isStopped?(e.complete(),Ka.EMPTY):(this.observers.push(e),new $p(this,e))},t.prototype.asObservable=function(){var e=new V;return e.source=this,e},t.create=function(e,t){return new bq(e,t)},t}(V),bq=function(e){function t(t,n){var r=e.call(this)||this;return r.destination=t,r.source=n,r}return M(t,e),t.prototype.next=function(e){var t=this.destination;t&&t.next&&t.next(e)},t.prototype.error=function(e){var t=this.destination;t&&t.error&&this.destination.error(e)},t.prototype.complete=function(){var e=this.destination;e&&e.complete&&this.destination.complete()},t.prototype._subscribe=function(e){return this.source?this.source.subscribe(e):Ka.EMPTY},t}(La),hs=function(){function e(e){this.connectable=e}return e.prototype.call=function(e,t){var n=this.connectable;return n._refCount++,e=new Ay(e,n),t=t.subscribe(e),e.closed||(e.connection=n.connect()),t},e}(),Ay=function(e){function t(t,n){return(t=e.call(this,t)||this).connectable=n,t}return M(t,e),t.prototype._unsubscribe=function(){var e=this.connectable;if(e){this.connectable=null;var t=e._refCount;0>=t?this.connection=null:(e._refCount=t-1,1<t?this.connection=null:(t=this.connection,e=e._connection,this.connection=null,!e||t&&e!==t||e.unsubscribe()))}else this.connection=null},t}(fa),cq=function(e){function t(t,n){var r=e.call(this)||this;return r.source=t,r.subjectFactory=n,r._refCount=0,r._isComplete=!1,r}return M(t,e),t.prototype._subscribe=function(e){return this.getSubject().subscribe(e)},t.prototype.getSubject=function(){var e=this._subject;return e&&!e.isStopped||(this._subject=this.subjectFactory()),this._subject},t.prototype.connect=function(){var e=this._connection;return e||(this._isComplete=!1,(e=this._connection=new Ka).add(this.source.subscribe(new By(this.getSubject(),this))),e.closed&&(this._connection=null,e=Ka.EMPTY)),e},t.prototype.refCount=function(){return Fl()(this)},t}(V),Vs=function(){var e=cq.prototype;return{operator:{value:null},_refCount:{value:0,writable:!0},_subject:{value:null,writable:!0},_connection:{value:null,writable:!0},_subscribe:{value:e._subscribe},_isComplete:{value:e._isComplete,writable:!0},getSubject:{value:e.getSubject},connect:{value:e.connect},refCount:{value:e.refCount}}}(),By=function(e){function t(t,n){return(t=e.call(this,t)||this).connectable=n,t}return M(t,e),t.prototype._error=function(t){this._unsubscribe(),e.prototype._error.call(this,t)},t.prototype._complete=function(){this.connectable._isComplete=!0,this._unsubscribe(),e.prototype._complete.call(this)},t.prototype._unsubscribe=function(){var e=this.connectable;if(e){this.connectable=null;var t=e._connection;e._refCount=0,e._subject=null,e._connection=null,t&&t.unsubscribe()}},t}(aq);!function(e){function t(t,n){return(t=e.call(this,t)||this).connectable=n,t}M(t,e),t.prototype._unsubscribe=function(){var e=this.connectable;if(e){this.connectable=null;var t=e._refCount;0>=t?this.connection=null:(e._refCount=t-1,1<t?this.connection=null:(t=this.connection,e=e._connection,this.connection=null,!e||t&&e!==t||e.unsubscribe()))}else this.connection=null}}(fa),function(e){function t(t,n,r,i,o){return(t=e.call(this,t)||this).keySelector=n,t.elementSelector=r,t.durationSelector=i,t.subjectSelector=o,t.groups=null,t.attemptedToUnsubscribe=!1,t.count=0,t}M(t,e),t.prototype._next=function(e){try{var t=this.keySelector(e)}catch(e){return void this.error(e)}this._group(e,t)},t.prototype._group=function(e,t){var n=this.groups;n||(n=this.groups=new Map);var r=n.get(t);if(this.elementSelector)try{var i=this.elementSelector(e)}catch(e){this.error(e)}else i=e;if(!r&&(r=this.subjectSelector?this.subjectSelector():new La,n.set(t,r),e=new vk(t,r,this),this.destination.next(e),this.durationSelector)){e=void 0;try{e=this.durationSelector(new vk(t,r))}catch(e){return void this.error(e)}this.add(e.subscribe(new Cy(t,r,this)))}r.closed||r.next(i)},t.prototype._error=function(e){var t=this.groups;t&&(t.forEach((function(t,n){t.error(e)})),t.clear()),this.destination.error(e)},t.prototype._complete=function(){var e=this.groups;e&&(e.forEach((function(e,t){e.complete()})),e.clear()),this.destination.complete()},t.prototype.removeGroup=function(e){this.groups.delete(e)},t.prototype.unsubscribe=function(){this.closed||(this.attemptedToUnsubscribe=!0,0===this.count&&e.prototype.unsubscribe.call(this))}}(fa);var Cy=function(e){function t(t,n,r){var i=e.call(this,n)||this;return i.key=t,i.group=n,i.parent=r,i}return M(t,e),t.prototype._next=function(e){this.complete()},t.prototype._unsubscribe=function(){var e=this.parent,t=this.key;this.key=this.parent=null,e&&e.removeGroup(t)},t}(fa),vk=function(e){function t(t,n,r){var i=e.call(this)||this;return i.key=t,i.groupSubject=n,i.refCountSubscription=r,i}return M(t,e),t.prototype._subscribe=function(e){var t=new Ka,n=this.refCountSubscription,r=this.groupSubject;return n&&!n.closed&&t.add(new Dy(n)),t.add(r.subscribe(e)),t},t}(V),Dy=function(e){function t(t){var n=e.call(this)||this;return n.parent=t,t.count++,n}return M(t,e),t.prototype.unsubscribe=function(){var t=this.parent;t.closed||this.closed||(e.prototype.unsubscribe.call(this),--t.count,0===t.count&&t.attemptedToUnsubscribe&&t.unsubscribe())},t}(Ka),Ey=function(e){function t(t){var n=e.call(this)||this;return n._value=t,n}return M(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this.getValue()},enumerable:!0,configurable:!0}),t.prototype._subscribe=function(t){var n=e.prototype._subscribe.call(this,t);return n&&!n.closed&&t.next(this._value),n},t.prototype.getValue=function(){if(this.hasError)throw this.thrownError;if(this.closed)throw new fd;return this._value},t.prototype.next=function(t){e.prototype.next.call(this,this._value=t)},t}(La),Qf=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.scheduler=t,r.work=n,r.pending=!1,r}return M(t,e),t.prototype.schedule=function(e,t){if(void 0===t&&(t=0),this.closed)return this;this.state=e,e=this.id;var n=this.scheduler;return null!=e&&(this.id=this.recycleAsyncId(n,e,t)),this.pending=!0,this.delay=t,this.id=this.id||this.requestAsyncId(n,this.id,t),this},t.prototype.requestAsyncId=function(e,t,n){return void 0===n&&(n=0),setInterval(e.flush.bind(e,this),n)},t.prototype.recycleAsyncId=function(e,t,n){if(void 0===n&&(n=0),null!==n&&this.delay===n&&!1===this.pending)return t;clearInterval(t)},t.prototype.execute=function(e,t){return this.closed?Error("executing a cancelled action"):(this.pending=!1,(e=this._execute(e,t))?e:void(!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))))},t.prototype._execute=function(e,t){t=!1;var n=void 0;try{this.work(e)}catch(e){t=!0,n=!!e&&e||Error(e)}if(t)return this.unsubscribe(),n},t.prototype._unsubscribe=function(){var e=this.id,t=this.scheduler,n=t.actions,r=n.indexOf(this);this.state=this.work=null,this.pending=!1,this.scheduler=null,-1!==r&&n.splice(r,1),null!=e&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null},t}(function(e){function t(t,n){return e.call(this)||this}return M(t,e),t.prototype.schedule=function(e,t){return this},t}(Ka)),Fy=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.scheduler=t,r.work=n,r}return M(t,e),t.prototype.schedule=function(t,n){return void 0===n&&(n=0),0<n?e.prototype.schedule.call(this,t,n):(this.delay=n,this.state=t,this.scheduler.flush(this),this)},t.prototype.execute=function(t,n){return 0<n||this.closed?e.prototype.execute.call(this,t,n):this._execute(t,n)},t.prototype.requestAsyncId=function(t,n,r){return void 0===r&&(r=0),null!==r&&0<r||null===r&&0<this.delay?e.prototype.requestAsyncId.call(this,t,n,r):t.flush(this)},t}(Qf),wk=function(){function e(t,n){void 0===n&&(n=e.now),this.SchedulerAction=t,this.now=n}return e.prototype.schedule=function(e,t,n){return void 0===t&&(t=0),new this.SchedulerAction(this,e).schedule(n,t)},e.now=function(){return Date.now()},e}(),Rf=function(e){function t(n,r){void 0===r&&(r=wk.now);var i=e.call(this,n,(function(){return t.delegate&&t.delegate!==i?t.delegate.now():r()}))||this;return i.actions=[],i.active=!1,i.scheduled=void 0,i}return M(t,e),t.prototype.schedule=function(n,r,i){return void 0===r&&(r=0),t.delegate&&t.delegate!==this?t.delegate.schedule(n,r,i):e.prototype.schedule.call(this,n,r,i)},t.prototype.flush=function(e){var t=this.actions;if(this.active)t.push(e);else{var n;this.active=!0;do{if(n=e.execute(e.state,e.delay))break}while(e=t.shift());if(this.active=!1,n){for(;e=t.shift();)e.unsubscribe();throw n}}},t}(wk),oh=new(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return M(t,e),t}(Rf))(Fy),dc=new V((function(e){return e.complete()})),Gl=function(e){return function(t){for(var n=0,r=e.length;n<r&&!t.closed;n++)t.next(e[n]);t.complete()}},xk;!function(e){e.NEXT="N",e.ERROR="E",e.COMPLETE="C"}(xk||(xk={}));var He=function(){function e(e,t,n){this.kind=e,this.value=t,this.error=n,this.hasValue="N"===e}return e.prototype.observe=function(e){switch(this.kind){case"N":return e.next&&e.next(this.value);case"E":return e.error&&e.error(this.error);case"C":return e.complete&&e.complete()}},e.prototype.do=function(e,t,n){switch(this.kind){case"N":return e&&e(this.value);case"E":return t&&t(this.error);case"C":return n&&n()}},e.prototype.accept=function(e,t,n){return e&&"function"==typeof e.next?this.observe(e):this.do(e,t,n)},e.prototype.toObservable=function(){switch(this.kind){case"N":return mb(this.value);case"E":return ba(this.error);case"C":return Ye()}throw Error("unexpected notification kind value")},e.createNext=function(t){return void 0!==t?new e("N",t):e.undefinedValueNotification},e.createError=function(t){return new e("E",void 0,t)},e.createComplete=function(){return e.completeNotification},e.completeNotification=new e("C"),e.undefinedValueNotification=new e("N",void 0),e}(),ls=function(){function e(e,t){void 0===t&&(t=0),this.scheduler=e,this.delay=t}return e.prototype.call=function(e,t){return t.subscribe(new dq(e,this.scheduler,this.delay))},e}(),dq=function(e){function t(t,n,r){return void 0===r&&(r=0),(t=e.call(this,t)||this).scheduler=n,t.delay=r,t}return M(t,e),t.dispatch=function(e){e.notification.observe(e.destination),this.unsubscribe()},t.prototype.scheduleMessage=function(e){this.destination.add(this.scheduler.schedule(t.dispatch,this.delay,new Gy(e,this.destination)))},t.prototype._next=function(e){this.scheduleMessage(He.createNext(e))},t.prototype._error=function(e){this.scheduleMessage(He.createError(e)),this.unsubscribe()},t.prototype._complete=function(){this.scheduleMessage(He.createComplete()),this.unsubscribe()},t}(fa),Gy=function(e,t){this.notification=e,this.destination=t},ce=function(e){function t(t,n,r){void 0===t&&(t=Number.POSITIVE_INFINITY),void 0===n&&(n=Number.POSITIVE_INFINITY);var i=e.call(this)||this;return i.scheduler=r,i._events=[],i._infiniteTimeWindow=!1,i._bufferSize=1>t?1:t,i._windowTime=1>n?1:n,n===Number.POSITIVE_INFINITY?(i._infiniteTimeWindow=!0,i.next=i.nextInfiniteTimeWindow):i.next=i.nextTimeWindow,i}return M(t,e),t.prototype.nextInfiniteTimeWindow=function(t){if(!this.isStopped){var n=this._events;n.push(t),n.length>this._bufferSize&&n.shift()}e.prototype.next.call(this,t)},t.prototype.nextTimeWindow=function(t){this.isStopped||(this._events.push(new Hy(this._getNow(),t)),this._trimBufferThenGetEvents()),e.prototype.next.call(this,t)},t.prototype._subscribe=function(e){var t=this._infiniteTimeWindow,n=t?this._events:this._trimBufferThenGetEvents(),r=this.scheduler,i=n.length;if(this.closed)throw new fd;if(this.isStopped||this.hasError)var o=Ka.EMPTY;else this.observers.push(e),o=new $p(this,e);if(r&&e.add(e=new dq(e,r)),t)for(t=0;t<i&&!e.closed;t++)e.next(n[t]);else for(t=0;t<i&&!e.closed;t++)e.next(n[t].value);return this.hasError?e.error(this.thrownError):this.isStopped&&e.complete(),o},t.prototype._getNow=function(){return(this.scheduler||oh).now()},t.prototype._trimBufferThenGetEvents=function(){for(var e=this._getNow(),t=this._bufferSize,n=this._windowTime,r=this._events,i=r.length,o=0;o<i&&!(e-r[o].time<n);)o++;return i>t&&(o=Math.max(o,i-t)),0<o&&r.splice(0,o),r},t}(La),Hy=function(e,t){this.time=e,this.value=t},$e=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.value=null,t.hasNext=!1,t.hasCompleted=!1,t}return M(t,e),t.prototype._subscribe=function(t){return this.hasError?(t.error(this.thrownError),Ka.EMPTY):this.hasCompleted&&this.hasNext?(t.next(this.value),t.complete(),Ka.EMPTY):e.prototype._subscribe.call(this,t)},t.prototype.next=function(e){this.hasCompleted||(this.value=e,this.hasNext=!0)},t.prototype.error=function(t){this.hasCompleted||e.prototype.error.call(this,t)},t.prototype.complete=function(){this.hasCompleted=!0,this.hasNext&&e.prototype.next.call(this,this.value),e.prototype.complete.call(this)},t}(La),Iy=1,Jy=Promise.resolve(),Uh={},eq={setImmediate:function(e){var t=Iy++;return Uh[t]=!0,Jy.then((function(){return Hl(t)&&e()})),t},clearImmediate:function(e){Hl(e)}},Ky=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.scheduler=t,r.work=n,r}return M(t,e),t.prototype.requestAsyncId=function(t,n,r){return void 0===r&&(r=0),null!==r&&0<r?e.prototype.requestAsyncId.call(this,t,n,r):(t.actions.push(this),t.scheduled||(t.scheduled=eq.setImmediate(t.flush.bind(t,null))))},t.prototype.recycleAsyncId=function(t,n,r){if(void 0===r&&(r=0),null!==r&&0<r||null===r&&0<this.delay)return e.prototype.recycleAsyncId.call(this,t,n,r);0===t.actions.length&&(eq.clearImmediate(n),t.scheduled=void 0)},t}(Qf),di=new(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return M(t,e),t.prototype.flush=function(e){this.active=!0,this.scheduled=void 0;var t,n=this.actions,r=-1,i=n.length;e=e||n.shift();do{if(t=e.execute(e.state,e.delay))break}while(++r<i&&(e=n.shift()));if(this.active=!1,t){for(;++r<i&&(e=n.shift());)e.unsubscribe();throw t}},t}(Rf))(Ky),Ly=di,yk=new Rf(Qf),Vc=yk,My=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.scheduler=t,r.work=n,r}return M(t,e),t.prototype.requestAsyncId=function(t,n,r){return void 0===r&&(r=0),null!==r&&0<r?e.prototype.requestAsyncId.call(this,t,n,r):(t.actions.push(this),t.scheduled||(t.scheduled=requestAnimationFrame((function(){return t.flush(null)}))))},t.prototype.recycleAsyncId=function(t,n,r){if(void 0===r&&(r=0),null!==r&&0<r||null===r&&0<this.delay)return e.prototype.recycleAsyncId.call(this,t,n,r);0===t.actions.length&&(cancelAnimationFrame(n),t.scheduled=void 0)},t}(Qf),fq=new(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return M(t,e),t.prototype.flush=function(e){this.active=!0,this.scheduled=void 0;var t,n=this.actions,r=-1,i=n.length;e=e||n.shift();do{if(t=e.execute(e.state,e.delay))break}while(++r<i&&(e=n.shift()));if(this.active=!1,t){for(;++r<i&&(e=n.shift());)e.unsubscribe();throw t}},t}(Rf))(My),Ny=function(e){function t(t,n){void 0===t&&(t=gq),void 0===n&&(n=Number.POSITIVE_INFINITY);var r=e.call(this,t,(function(){return r.frame}))||this;return r.maxFrames=n,r.frame=0,r.index=-1,r}return M(t,e),t.prototype.flush=function(){for(var e,t,n=this.actions,r=this.maxFrames;(t=n[0])&&t.delay<=r&&(n.shift(),this.frame=t.delay,!(e=t.execute(t.state,t.delay))););if(e){for(;t=n.shift();)t.unsubscribe();throw e}},t.frameTimeFactor=10,t}(Rf),gq=function(e){function t(t,n,r){void 0===r&&(r=t.index+=1);var i=e.call(this,t,n)||this;return i.scheduler=t,i.work=n,i.index=r,i.active=!0,i.index=t.index=r,i}return M(t,e),t.prototype.schedule=function(n,r){if(void 0===r&&(r=0),!this.id)return e.prototype.schedule.call(this,n,r);this.active=!1;var i=new t(this.scheduler,this.work);return this.add(i),i.schedule(n,r)},t.prototype.requestAsyncId=function(e,n,r){return void 0===r&&(r=0),this.delay=e.frame+r,(e=e.actions).push(this),e.sort(t.sortActions),!0},t.prototype.recycleAsyncId=function(e,t,n){},t.prototype._execute=function(t,n){if(!0===this.active)return e.prototype._execute.call(this,t,n)},t.sortActions=function(e,t){return e.delay===t.delay?e.index===t.index?0:e.index>t.index?1:-1:e.delay>t.delay?1:-1},t}(Qf),zk=function(){function e(){return Error.call(this),this.message="argument out of range",this.name="ArgumentOutOfRangeError",this}return e.prototype=Object.create(Error.prototype),e}(),gg=function(){function e(){return Error.call(this),this.message="no elements in sequence",this.name="EmptyError",this}return e.prototype=Object.create(Error.prototype),e}(),pb=function(){function e(){return Error.call(this),this.message="Timeout has occurred",this.name="TimeoutError",this}return e.prototype=Object.create(Error.prototype),e}(),ms=function(){function e(e,t){this.project=e,this.thisArg=t}return e.prototype.call=function(e,t){return t.subscribe(new Oy(e,this.project,this.thisArg))},e}(),Oy=function(e){function t(t,n,r){return(t=e.call(this,t)||this).project=n,t.count=0,t.thisArg=r||t,t}return M(t,e),t.prototype._next=function(e){try{var t=this.project.call(this.thisArg,e,this.count++)}catch(e){return void this.destination.error(e)}this.destination.next(t)},t}(fa),Ak=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return M(t,e),t.prototype.notifyNext=function(e,t,n,r,i){this.destination.next(t)},t.prototype.notifyError=function(e,t){this.destination.error(e)},t.prototype.notifyComplete=function(e){this.destination.complete()},t}(fa),rs=function(e){function t(t,n,r){var i=e.call(this)||this;return i.parent=t,i.outerValue=n,i.outerIndex=r,i.index=0,i}return M(t,e),t.prototype._next=function(e){this.parent.notifyNext(this.outerValue,e,this.outerIndex,this.index++,this)},t.prototype._error=function(e){this.parent.notifyError(e,this),this.unsubscribe()},t.prototype._complete=function(){this.parent.notifyComplete(this),this.unsubscribe()},t}(fa),Py=function(e){return function(t){return e.then((function(e){t.closed||(t.next(e),t.complete())}),(function(e){return t.error(e)})).then(null,Zd),t}},Uc="function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator",Qy=function(e){return function(t){for(var n=e[Uc]();;){var r=void 0;try{r=n.next()}catch(e){return t.error(e),t}if(r.done){t.complete();break}if(t.next(r.value),t.closed)break}return"function"==typeof n.return&&t.add((function(){n.return&&n.return()})),t}},Ry=function(e){return function(t){var n=e[$d]();if("function"!=typeof n.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return n.subscribe(t)}},Nl=function(e){return e&&"number"==typeof e.length&&"function"!=typeof e},af=function(e){if(e&&"function"==typeof e[$d])return Ry(e);if(Nl(e))return Gl(e);if(Ll(e))return Py(e);if(e&&"function"==typeof e[Uc])return Qy(e);throw e=Qh(e)?"an invalid object":"'"+e+"'",new TypeError("You provided "+e+" where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.")},hq={},Ty=function(){function e(e){this.resultSelector=e}return e.prototype.call=function(e,t){return t.subscribe(new Sy(e,this.resultSelector))},e}(),Sy=function(e){function t(t,n){return(t=e.call(this,t)||this).resultSelector=n,t.active=0,t.values=[],t.observables=[],t}return M(t,e),t.prototype._next=function(e){this.values.push(hq),this.observables.push(e)},t.prototype._complete=function(){var e=this.observables,t=e.length;if(0===t)this.destination.complete();else{this.toRespond=this.active=t;for(var n=0;n<t;n++)this.add(Vh(this,e[n],void 0,n))}},t.prototype.notifyComplete=function(e){0==--this.active&&this.destination.complete()},t.prototype.notifyNext=function(e,t,n){var r=(e=this.values)[n];r=this.toRespond?r===hq?--this.toRespond:this.toRespond:0,e[n]=t,0===r&&(this.resultSelector?this._tryResultSelector(e):this.destination.next(e.slice()))},t.prototype._tryResultSelector=function(e){try{var t=this.resultSelector.apply(this,e)}catch(e){return void this.destination.error(e)}this.destination.next(t)},t}(Ak),pc=function(e){function t(t){var n=e.call(this)||this;return n.parent=t,n}return M(t,e),t.prototype._next=function(e){this.parent.notifyNext(e)},t.prototype._error=function(e){this.parent.notifyError(e),this.unsubscribe()},t.prototype._complete=function(){this.parent.notifyComplete(),this.unsubscribe()},t}(fa);!function(e){function t(t,n,r){var i=e.call(this)||this;return i.parent=t,i.outerValue=n,i.outerIndex=r,i}M(t,e),t.prototype._next=function(e){this.parent.notifyNext(this.outerValue,e,this.outerIndex,this)},t.prototype._error=function(e){this.parent.notifyError(e),this.unsubscribe()},t.prototype._complete=function(){this.parent.notifyComplete(this),this.unsubscribe()}}(fa);var qc=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return M(t,e),t.prototype.notifyNext=function(e){this.destination.next(e)},t.prototype.notifyError=function(e){this.destination.error(e)},t.prototype.notifyComplete=function(){this.destination.complete()},t}(fa);!function(e){function t(){return null!==e&&e.apply(this,arguments)||this}M(t,e),t.prototype.notifyNext=function(e,t,n,r){this.destination.next(t)},t.prototype.notifyError=function(e){this.destination.error(e)},t.prototype.notifyComplete=function(e){this.destination.complete()}}(fa);var vs=function(){function e(e,t){void 0===t&&(t=Number.POSITIVE_INFINITY),this.project=e,this.concurrent=t}return e.prototype.call=function(e,t){return t.subscribe(new Uy(e,this.project,this.concurrent))},e}(),Uy=function(e){function t(t,n,r){return void 0===r&&(r=Number.POSITIVE_INFINITY),(t=e.call(this,t)||this).project=n,t.concurrent=r,t.hasCompleted=!1,t.buffer=[],t.active=0,t.index=0,t}return M(t,e),t.prototype._next=function(e){this.active<this.concurrent?this._tryNext(e):this.buffer.push(e)},t.prototype._tryNext=function(e){var t=this.index++;try{var n=this.project(e,t)}catch(e){return void this.destination.error(e)}this.active++,this._innerSub(n)},t.prototype._innerSub=function(e){var t=new pc(this),n=this.destination;n.add(t),(e=fc(e,t))!==t&&n.add(e)},t.prototype._complete=function(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete(),this.unsubscribe()},t.prototype.notifyNext=function(e){this.destination.next(e)},t.prototype.notifyComplete=function(){var e=this.buffer;this.active--,0<e.length?this._next(e.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()},t}(qc),Bk=B.parseFloat,iq=-1/0!=1/Bk("\t\n\v\f\r                　\u2028\u2029\ufeff-0")?function(e){e=Tj(String(e));var t=Bk(e);return 0===t&&"-"==e.charAt(0)?-0:t}:Bk;N({global:!0,forced:parseFloat!=iq},{parseFloat:iq});var Ck=new V(ec),As=function(){function e(e,t){this.predicate=e,this.thisArg=t}return e.prototype.call=function(e,t){return t.subscribe(new Vy(e,this.predicate,this.thisArg))},e}(),Vy=function(e){function t(t,n,r){return(t=e.call(this,t)||this).predicate=n,t.thisArg=r,t.count=0,t}return M(t,e),t.prototype._next=function(e){try{var t=this.predicate.call(this.thisArg,e,this.count++)}catch(e){return void this.destination.error(e)}t&&this.destination.next(e)},t}(fa),Bs=function(){function e(){}return e.prototype.call=function(e,t){return t.subscribe(new Wy(e))},e}(),Wy=function(e){function t(t){return(t=e.call(this,t)||this).hasFirst=!1,t.observables=[],t.subscriptions=[],t}return M(t,e),t.prototype._next=function(e){this.observables.push(e)},t.prototype._complete=function(){var e=this.observables,t=e.length;if(0===t)this.destination.complete();else{for(var n=0;n<t&&!this.hasFirst;n++){var r=Vh(this,e[n],void 0,n);this.subscriptions&&this.subscriptions.push(r),this.add(r)}this.observables=null}},t.prototype.notifyNext=function(e,t,n){if(!this.hasFirst){for(this.hasFirst=!0,e=0;e<this.subscriptions.length;e++)if(e!==n){var r=this.subscriptions[e];r.unsubscribe(),this.remove(r)}this.subscriptions=null}this.destination.next(t)},t}(Ak),Es=function(){function e(e){this.resultSelector=e}return e.prototype.call=function(e,t){return t.subscribe(new Xy(e,this.resultSelector))},e}(),Xy=function(e){function t(t,n,r){return(t=e.call(this,t)||this).resultSelector=n,t.iterators=[],t.active=0,t.resultSelector="function"==typeof n?n:void 0,t}return M(t,e),t.prototype._next=function(e){var t=this.iterators;Hb(e)?t.push(new Yy(e)):"function"==typeof e[Uc]?t.push(new Zy(e[Uc]())):t.push(new $y(this.destination,this,e))},t.prototype._complete=function(){var e=this.iterators,t=e.length;if(this.unsubscribe(),0===t)this.destination.complete();else{this.active=t;for(var n=0;n<t;n++){var r=e[n];r.stillUnsubscribed?this.destination.add(r.subscribe()):this.active--}}},t.prototype.notifyInactive=function(){this.active--,0===this.active&&this.destination.complete()},t.prototype.checkIterators=function(){for(var e=this.iterators,t=e.length,n=this.destination,r=0;r<t;r++){var i=e[r];if("function"==typeof i.hasValue&&!i.hasValue())return}var o=!1,a=[];for(r=0;r<t;r++){var s=(i=e[r]).next();if(i.hasCompleted()&&(o=!0),s.done)return void n.complete();a.push(s.value)}this.resultSelector?this._tryresultSelector(a):n.next(a),o&&n.complete()},t.prototype._tryresultSelector=function(e){try{var t=this.resultSelector.apply(this,e)}catch(e){return void this.destination.error(e)}this.destination.next(t)},t}(fa),Zy=function(){function e(e){this.iterator=e,this.nextResult=e.next()}return e.prototype.hasValue=function(){return!0},e.prototype.next=function(){var e=this.nextResult;return this.nextResult=this.iterator.next(),e},e.prototype.hasCompleted=function(){var e=this.nextResult;return!(!e||!e.done)},e}(),Yy=function(){function e(e){this.array=e,this.length=this.index=0,this.length=e.length}return e.prototype[Uc]=function(){return this},e.prototype.next=function(e){e=this.index++;var t=this.array;return e<this.length?{value:t[e],done:!1}:{value:null,done:!0}},e.prototype.hasValue=function(){return this.array.length>this.index},e.prototype.hasCompleted=function(){return this.array.length===this.index},e}(),$y=function(e){function t(t,n,r){return(t=e.call(this,t)||this).parent=n,t.observable=r,t.stillUnsubscribed=!0,t.buffer=[],t.isComplete=!1,t}return M(t,e),t.prototype[Uc]=function(){return this},t.prototype.next=function(){var e=this.buffer;return 0===e.length&&this.isComplete?{value:null,done:!0}:{value:e.shift(),done:!1}},t.prototype.hasValue=function(){return 0<this.buffer.length},t.prototype.hasCompleted=function(){return 0===this.buffer.length&&this.isComplete},t.prototype.notifyComplete=function(){0<this.buffer.length?(this.isComplete=!0,this.parent.notifyInactive()):this.destination.complete()},t.prototype.notifyNext=function(e){this.buffer.push(e),this.parent.checkIterators()},t.prototype.subscribe=function(){return fc(this.observable,new pc(this))},t}(qc),az=Object.freeze({__proto__:null,Observable:V,ConnectableObservable:cq,GroupedObservable:vk,observable:$d,Subject:La,BehaviorSubject:Ey,ReplaySubject:ce,AsyncSubject:$e,asap:Ly,asapScheduler:di,async:Vc,asyncScheduler:yk,queue:oh,queueScheduler:oh,animationFrame:fq,animationFrameScheduler:fq,VirtualTimeScheduler:Ny,VirtualAction:gq,Scheduler:wk,Subscription:Ka,Subscriber:fa,Notification:He,get NotificationKind(){return xk},pipe:Sh,noop:ec,identity:Sc,isObservable:function(e){return!!e&&(e instanceof V||"function"==typeof e.lift&&"function"==typeof e.subscribe)},ArgumentOutOfRangeError:zk,EmptyError:gg,ObjectUnsubscribedError:fd,UnsubscriptionError:Xe,TimeoutError:pb,bindCallback:Il,bindNodeCallback:Jl,combineLatest:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=t=void 0;return Tc(e[e.length-1])&&(n=e.pop()),"function"==typeof e[e.length-1]&&(t=e.pop()),1===e.length&&Hb(e[0])&&(e=e[0]),Ze(e,n).lift(new Ty(t))},concat:Ol,defer:qd,empty:Ye,forkJoin:Pl,from:Ib,fromEvent:fb,fromEventPattern:Rl,generate:function(e,t,n,r,i){if(1==arguments.length){var o=e.initialState;t=e.condition,n=e.iterate;var a=e.resultSelector||Sc;i=e.scheduler}else void 0===r||Tc(r)?(o=e,a=Sc,i=r):(o=e,a=r);return new V((function(e){var r=o;if(i)return i.schedule(ws,0,{subscriber:e,iterate:n,condition:t,resultSelector:a,state:r});for(;;){if(t){var s=void 0;try{s=t(r)}catch(t){e.error(t);break}if(!s){e.complete();break}}s=void 0;try{s=a(r)}catch(t){e.error(t);break}if(e.next(s),e.closed)break;try{r=n(r)}catch(t){e.error(t);break}}}))},iif:function(e,t,n){return void 0===t&&(t=dc),void 0===n&&(n=dc),qd((function(){return e()?t:n}))},interval:Sl,merge:Tb,never:function(){return Ck},of:mb,onErrorResumeNext:Yh,pairs:function(e,t){return new V(t?function(n){var r=Object.keys(e),i=new Ka;return i.add(t.schedule(ys,0,{keys:r,index:0,subscriber:n,subscription:i,obj:e})),i}:function(t){for(var n=Object.keys(e),r=0;r<n.length&&!t.closed;r++){var i=n[r];e.hasOwnProperty(i)&&t.next([i,e[i]])}t.complete()})},partition:function(e,t,n){return[nb(t,n)(new V(af(e))),nb(zs(t,n))(new V(af(e)))]},race:ya,range:function(e,t,n){return void 0===e&&(e=0),new V((function(r){void 0===t&&(t=e,e=0);var i=0,o=e;if(n)return n.schedule(Cs,0,{index:i,count:t,start:e,subscriber:r});for(;;){if(i++>=t){r.complete();break}if(r.next(o++),r.closed)break}}))},throwError:ba,timer:uc,using:function(e,t){return new V((function(n){try{var r=e()}catch(e){return void n.error(e)}try{var i=t(r)}catch(e){return void n.error(e)}var o=(i?Ib(i):dc).subscribe(n);return function(){o.unsubscribe(),r&&r.unsubscribe()}}))},zip:Zh,scheduled:Ml,EMPTY:dc,NEVER:Ck,config:Gb}),Fs=function(){function e(e){this.selector=e}return e.prototype.call=function(e,t){return t.subscribe(new bz(e,this.selector,this.caught))},e}(),bz=function(e){function t(t,n,r){return(t=e.call(this,t)||this).selector=n,t.caught=r,t}return M(t,e),t.prototype.error=function(t){if(!this.isStopped){var n=void 0;try{n=this.selector(t,this.caught)}catch(t){return void e.prototype.error.call(this,t)}this._unsubscribeAndRecycle(),t=new pc(this),this.add(t),(n=fc(n,t))!==t&&this.add(n)}},t}(qc),Gs=function(){function e(e){this.defaultValue=e}return e.prototype.call=function(e,t){return t.subscribe(new cz(e,this.defaultValue))},e}(),cz=function(e){function t(t,n){return(t=e.call(this,t)||this).defaultValue=n,t.isEmpty=!0,t}return M(t,e),t.prototype._next=function(e){this.isEmpty=!1,this.destination.next(e)},t.prototype._complete=function(){this.isEmpty&&this.destination.next(this.defaultValue),this.destination.complete()},t}(fa),Hs=function(){function e(e,t){this.delay=e,this.scheduler=t}return e.prototype.call=function(e,t){return t.subscribe(new dz(e,this.delay,this.scheduler))},e}(),dz=function(e){function t(t,n,r){return(t=e.call(this,t)||this).delay=n,t.scheduler=r,t.queue=[],t.active=!1,t.errored=!1,t}return M(t,e),t.dispatch=function(e){for(var t=e.source,n=t.queue,r=e.scheduler,i=e.destination;0<n.length&&0>=n[0].time-r.now();)n.shift().notification.observe(i);0<n.length?(t=Math.max(0,n[0].time-r.now()),this.schedule(e,t)):(this.unsubscribe(),t.active=!1)},t.prototype._schedule=function(e){this.active=!0,this.destination.add(e.schedule(t.dispatch,this.delay,{source:this,destination:this.destination,scheduler:e}))},t.prototype.scheduleNotification=function(e){if(!0!==this.errored){var t=this.scheduler;e=new ez(t.now()+this.delay,e),this.queue.push(e),!1===this.active&&this._schedule(t)}},t.prototype._next=function(e){this.scheduleNotification(He.createNext(e))},t.prototype._error=function(e){this.errored=!0,this.queue=[],this.destination.error(e),this.unsubscribe()},t.prototype._complete=function(){this.scheduleNotification(He.createComplete()),this.unsubscribe()},t}(fa),ez=function(e,t){this.time=e,this.notification=t},Is=function(){function e(e,t){this.keySelector=e,this.flushes=t}return e.prototype.call=function(e,t){return t.subscribe(new fz(e,this.keySelector,this.flushes))},e}(),fz=function(e){function t(t,n,r){return(t=e.call(this,t)||this).keySelector=n,t.values=new Set,r&&t.add(fc(r,new pc(t))),t}return M(t,e),t.prototype.notifyNext=function(){this.values.clear()},t.prototype.notifyError=function(e){this._error(e)},t.prototype._next=function(e){this.keySelector?this._useKeySelector(e):this._finalizeNext(e,e)},t.prototype._useKeySelector=function(e){var t=this.destination;try{var n=this.keySelector(e)}catch(e){return void t.error(e)}this._finalizeNext(n,e)},t.prototype._finalizeNext=function(e,t){var n=this.values;n.has(e)||(n.add(e),this.destination.next(t))},t}(qc),Ks=function(){function e(e){this.errorFactory=e}return e.prototype.call=function(e,t){return t.subscribe(new gz(e,this.errorFactory))},e}(),gz=function(e){function t(t,n){return(t=e.call(this,t)||this).errorFactory=n,t.hasValue=!1,t}return M(t,e),t.prototype._next=function(e){this.hasValue=!0,this.destination.next(e)},t.prototype._complete=function(){if(this.hasValue)return this.destination.complete();var e=void 0;try{e=this.errorFactory()}catch(t){e=t}this.destination.error(e)},t}(fa),Ls=function(){function e(e){if(this.total=e,0>this.total)throw new zk}return e.prototype.call=function(e,t){return t.subscribe(new hz(e,this.total))},e}(),hz=function(e){function t(t,n){return(t=e.call(this,t)||this).total=n,t.count=0,t}return M(t,e),t.prototype._next=function(e){var t=this.total,n=++this.count;n<=t&&(this.destination.next(e),n===t&&(this.destination.complete(),this.unsubscribe()))},t}(fa),Ms=function(){function e(e){this.project=e}return e.prototype.call=function(e,t){return t.subscribe(new iz(e,this.project))},e}(),iz=function(e){function t(t,n){return(t=e.call(this,t)||this).project=n,t.hasSubscription=!1,t.hasCompleted=!1,t.index=0,t}return M(t,e),t.prototype._next=function(e){this.hasSubscription||this.tryNext(e)},t.prototype.tryNext=function(e){var t=this.index++;try{var n=this.project(e,t)}catch(e){return void this.destination.error(e)}this.hasSubscription=!0,this._innerSub(n)},t.prototype._innerSub=function(e){var t=new pc(this),n=this.destination;n.add(t),(e=fc(e,t))!==t&&n.add(e)},t.prototype._complete=function(){this.hasCompleted=!0,this.hasSubscription||this.destination.complete(),this.unsubscribe()},t.prototype.notifyNext=function(e){this.destination.next(e)},t.prototype.notifyError=function(e){this.destination.error(e)},t.prototype.notifyComplete=function(){this.hasSubscription=!1,this.hasCompleted&&this.destination.complete()},t}(qc),Ns=function(){function e(e){this.callback=e}return e.prototype.call=function(e,t){return t.subscribe(new jz(e,this.callback))},e}(),jz=function(e){function t(t,n){return(t=e.call(this,t)||this).add(new Ka(n)),t}return M(t,e),t}(fa),Ps=function(){function e(){}return e.prototype.call=function(e,t){return t.subscribe(new kz(e))},e}(),kz=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return M(t,e),t.prototype._next=function(e){},t}(fa),Qs=function(){function e(e){if(this.total=e,0>this.total)throw new zk}return e.prototype.call=function(e,t){return t.subscribe(new lz(e,this.total))},e}(),lz=function(e){function t(t,n){return(t=e.call(this,t)||this).total=n,t.ring=[],t.count=0,t}return M(t,e),t.prototype._next=function(e){var t=this.ring,n=this.total,r=this.count++;t.length<n?t.push(e):t[r%n]=e},t.prototype._complete=function(){var e=this.destination,t=this.count;if(0<t)for(var n=this.count>=this.total?this.total:this.count,r=this.ring,i=0;i<n;i++){var o=t++%n;e.next(r[o])}e.complete()},t}(fa),Rs=function(){function e(e){this.value=e}return e.prototype.call=function(e,t){return t.subscribe(new mz(e,this.value))},e}(),mz=function(e){function t(t,n){return(t=e.call(this,t)||this).value=n,t}return M(t,e),t.prototype._next=function(e){this.destination.next(this.value)},t}(fa),Ss=function(){function e(e,t,n){void 0===n&&(n=!1),this.accumulator=e,this.seed=t,this.hasSeed=n}return e.prototype.call=function(e,t){return t.subscribe(new nz(e,this.accumulator,this.seed,this.hasSeed))},e}(),nz=function(e){function t(t,n,r,i){return(t=e.call(this,t)||this).accumulator=n,t._seed=r,t.hasSeed=i,t.index=0,t}return M(t,e),Object.defineProperty(t.prototype,"seed",{get:function(){return this._seed},set:function(e){this.hasSeed=!0,this._seed=e},enumerable:!0,configurable:!0}),t.prototype._next=function(e){if(this.hasSeed)return this._tryNext(e);this.seed=e,this.destination.next(e)},t.prototype._tryNext=function(e){var t=this.index++;try{var n=this.accumulator(this.seed,e,t)}catch(e){this.destination.error(e)}this.seed=n,this.destination.next(n)},t}(fa),Us=function(){function e(e,t){this.subjectFactory=e,this.selector=t}return e.prototype.call=function(e,t){var n=this.selector,r=this.subjectFactory();return(e=n(r).subscribe(e)).add(t.subscribe(r)),e},e}(),Ws=function(){function e(e,t){this.notifier=e,this.source=t}return e.prototype.call=function(e,t){return t.subscribe(new oz(e,this.notifier,this.source))},e}(),oz=function(e){function t(t,n,r){return(t=e.call(this,t)||this).notifier=n,t.source=r,t}return M(t,e),t.prototype.error=function(t){if(!this.isStopped){var n=this.errors,r=this.retries,i=this.retriesSubscription;if(r)this.retriesSubscription=this.errors=void 0;else{n=new La;try{r=(0,this.notifier)(n)}catch(t){return e.prototype.error.call(this,t)}i=fc(r,new pc(this))}this._unsubscribeAndRecycle(),this.errors=n,this.retries=r,this.retriesSubscription=i,n.next(t)}},t.prototype._unsubscribe=function(){var e=this.errors,t=this.retriesSubscription;e&&(e.unsubscribe(),this.errors=void 0),t&&(t.unsubscribe(),this.retriesSubscription=void 0),this.retries=void 0},t.prototype.notifyNext=function(){var e=this._unsubscribe;this._unsubscribe=null,this._unsubscribeAndRecycle(),this._unsubscribe=e,this.source.subscribe(this)},t}(qc),Zs=function(){function e(e){this.project=e}return e.prototype.call=function(e,t){return t.subscribe(new pz(e,this.project))},e}(),pz=function(e){function t(t,n){return(t=e.call(this,t)||this).project=n,t.index=0,t}return M(t,e),t.prototype._next=function(e){var t=this.index++;try{var n=this.project(e,t)}catch(e){return void this.destination.error(e)}this._innerSub(n)},t.prototype._innerSub=function(e){var t=this.innerSubscription;t&&t.unsubscribe(),t=new pc(this);var n=this.destination;n.add(t),this.innerSubscription=fc(e,t),this.innerSubscription!==t&&n.add(this.innerSubscription)},t.prototype._complete=function(){var t=this.innerSubscription;t&&!t.closed||e.prototype._complete.call(this),this.unsubscribe()},t.prototype._unsubscribe=function(){this.innerSubscription=void 0},t.prototype.notifyComplete=function(){this.innerSubscription=void 0,this.isStopped&&e.prototype._complete.call(this)},t.prototype.notifyNext=function(e){this.destination.next(e)},t}(qc),$s=function(){function e(e){this.notifier=e}return e.prototype.call=function(e,t){e=new qz(e);var n=fc(this.notifier,new pc(e));return n&&!e.seenValue?(e.add(n),t.subscribe(e)):e},e}(),qz=function(e){function t(t){return(t=e.call(this,t)||this).seenValue=!1,t}return M(t,e),t.prototype.notifyNext=function(){this.seenValue=!0,this.complete()},t.prototype.notifyComplete=function(){},t}(qc),bt=function(){function e(e,t){this.predicate=e,this.inclusive=t}return e.prototype.call=function(e,t){return t.subscribe(new rz(e,this.predicate,this.inclusive))},e}(),rz=function(e){function t(t,n,r){return(t=e.call(this,t)||this).predicate=n,t.inclusive=r,t.index=0,t}return M(t,e),t.prototype._next=function(e){var t=this.destination;try{var n=this.predicate(e,this.index++)}catch(e){return void t.error(e)}this.nextOrComplete(e,n)},t.prototype.nextOrComplete=function(e,t){var n=this.destination;t?n.next(e):(this.inclusive&&n.next(e),n.complete())},t}(fa),ct=function(){function e(e,t,n){this.nextOrObserver=e,this.error=t,this.complete=n}return e.prototype.call=function(e,t){return t.subscribe(new sz(e,this.nextOrObserver,this.error,this.complete))},e}(),sz=function(e){function t(t,n,r,i){return(t=e.call(this,t)||this)._tapNext=ec,t._tapError=ec,t._tapComplete=ec,t._tapError=r||ec,t._tapComplete=i||ec,Yd(n)?(t._context=t,t._tapNext=n):n&&(t._context=n,t._tapNext=n.next||ec,t._tapError=n.error||ec,t._tapComplete=n.complete||ec),t}return M(t,e),t.prototype._next=function(e){try{this._tapNext.call(this._context,e)}catch(e){return void this.destination.error(e)}this.destination.next(e)},t.prototype._error=function(e){try{this._tapError.call(this._context,e)}catch(e){return void this.destination.error(e)}this.destination.error(e)},t.prototype._complete=function(){try{this._tapComplete.call(this._context)}catch(e){return void this.destination.error(e)}return this.destination.complete()},t}(fa),et={leading:!0,trailing:!1};!function(e){function t(t,n,r,i){var o=e.call(this,t)||this;return o.destination=t,o.durationSelector=n,o._leading=r,o._trailing=i,o._hasValue=!1,o}M(t,e),t.prototype._next=function(e){this._hasValue=!0,this._sendValue=e,this._throttled||(this._leading?this.send():this.throttle(e))},t.prototype.send=function(){var e=this._sendValue;this._hasValue&&(this.destination.next(e),this.throttle(e)),this._hasValue=!1,this._sendValue=void 0},t.prototype.throttle=function(e){(e=this.tryDurationSelector(e))&&this.add(this._throttled=fc(e,new pc(this)))},t.prototype.tryDurationSelector=function(e){try{return this.durationSelector(e)}catch(e){return this.destination.error(e),null}},t.prototype.throttlingDone=function(){var e=this._throttled,t=this._trailing;e&&e.unsubscribe(),this._throttled=void 0,t&&this.send()},t.prototype.notifyNext=function(){this.throttlingDone()},t.prototype.notifyComplete=function(){this.throttlingDone()}}(qc);for(var ft=function(){function e(e,t,n,r){this.duration=e,this.scheduler=t,this.leading=n,this.trailing=r}return e.prototype.call=function(e,t){return t.subscribe(new tz(e,this.duration,this.scheduler,this.leading,this.trailing))},e}(),tz=function(e){function t(t,n,r,i,o){return(t=e.call(this,t)||this).duration=n,t.scheduler=r,t.leading=i,t.trailing=o,t._hasTrailingValue=!1,t._trailingValue=null,t}return M(t,e),t.prototype._next=function(e){this.throttled?this.trailing&&(this._trailingValue=e,this._hasTrailingValue=!0):(this.add(this.throttled=this.scheduler.schedule(gt,this.duration,{subscriber:this})),this.leading?this.destination.next(e):this.trailing&&(this._trailingValue=e,this._hasTrailingValue=!0))},t.prototype._complete=function(){this._hasTrailingValue&&this.destination.next(this._trailingValue),this.destination.complete()},t.prototype.clearThrottle=function(){var e=this.throttled;e&&(this.trailing&&this._hasTrailingValue&&(this.destination.next(this._trailingValue),this._trailingValue=null,this._hasTrailingValue=!1),e.unsubscribe(),this.remove(e),this.throttled=null)},t}(fa),it=function(){function e(e,t,n,r){this.waitFor=e,this.absoluteTimeout=t,this.withObservable=n,this.scheduler=r}return e.prototype.call=function(e,t){return t.subscribe(new uz(e,this.absoluteTimeout,this.waitFor,this.withObservable,this.scheduler))},e}(),uz=function(e){function t(t,n,r,i,o){return(t=e.call(this,t)||this).absoluteTimeout=n,t.waitFor=r,t.withObservable=i,t.scheduler=o,t.scheduleTimeout(),t}return M(t,e),t.dispatchTimeout=function(e){var t=e.withObservable;e._unsubscribeAndRecycle(),e.add(fc(t,new pc(e)))},t.prototype.scheduleTimeout=function(){var e=this.action;e?this.action=e.schedule(this,this.waitFor):this.add(this.action=this.scheduler.schedule(t.dispatchTimeout,this.waitFor,this))},t.prototype._next=function(t){this.absoluteTimeout||this.scheduleTimeout(),e.prototype._next.call(this,t)},t.prototype._unsubscribe=function(){this.action=void 0,this.withObservable=this.scheduler=null},t}(qc),kt=function(){function e(e,t){this.observables=e,this.project=t}return e.prototype.call=function(e,t){return t.subscribe(new vz(e,this.observables,this.project))},e}(),vz=function(e){function t(t,n,r){(t=e.call(this,t)||this).observables=n,t.project=r,t.toRespond=[],r=n.length,t.values=Array(r);for(var i=0;i<r;i++)t.toRespond.push(i);for(i=0;i<r;i++)t.add(Vh(t,n[i],void 0,i));return t}return M(t,e),t.prototype.notifyNext=function(e,t,n){this.values[n]=t,0<(e=this.toRespond).length&&-1!==(n=e.indexOf(n))&&e.splice(n,1)},t.prototype.notifyComplete=function(){},t.prototype._next=function(e){0===this.toRespond.length&&(e=[e].concat(this.values),this.project?this._tryProject(e):this.destination.next(e))},t.prototype._tryProject=function(e){try{var t=this.project.apply(this,e)}catch(e){return void this.destination.error(e)}this.destination.next(t)},t}(Ak),jq=Xa((function(e){var t="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(t){var n=new Uint8Array(16);e.exports=function(){return t(n),n}}else{var r=Array(16);e.exports=function(){for(var e,t=0;16>t;t++)0==(3&t)&&(e=4294967296*Math.random()),r[t]=e>>>((3&t)<<3)&255;return r}}})),ab=[],ph=0;256>ph;++ph)ab[ph]=(ph+256).toString(16).substr(1);var kq=function(e,t){return t=t||0,[ab[e[t++]],ab[e[t++]],ab[e[t++]],ab[e[t++]],"-",ab[e[t++]],ab[e[t++]],"-",ab[e[t++]],ab[e[t++]],"-",ab[e[t++]],ab[e[t++]],"-",ab[e[t++]],ab[e[t++]],ab[e[t++]],ab[e[t++]],ab[e[t++]],ab[e[t++]]].join("")},Id=function(e,t,n){if(n=t&&n||0,"string"==typeof e&&(t="binary"===e?Array(16):null,e=null),(e=(e=e||{}).random||(e.rng||jq)())[6]=15&e[6]|64,e[8]=63&e[8]|128,t)for(var r=0;16>r;++r)t[n+r]=e[r];return t||kq(e)},Sf=Id(),Ic,gd,Dk,Ek,hd,Jd,ac,Ie,Nb,Fk,Jc,Kd,Kc,Lc,Mc,Je,Nc,Oc;!function(e){e[e.ATTRIBUTE_OPERATION_ERR_FAILURE=2]="ATTRIBUTE_OPERATION_ERR_FAILURE",e[e.ATTRIBUTE_OPERATION_ERR_INVALID_ARGUMENT=3]="ATTRIBUTE_OPERATION_ERR_INVALID_ARGUMENT",e[e.ATTRIBUTE_OPERATION_ERR_SIZE_OVERFLOW=4]="ATTRIBUTE_OPERATION_ERR_SIZE_OVERFLOW",e[e.ATTRIBUTE_OPERATION_ERR_TOO_OFTEN=5]="ATTRIBUTE_OPERATION_ERR_TOO_OFTEN",e[e.ATTRIBUTE_OPERATION_ERR_USER_NOT_FOUND=6]="ATTRIBUTE_OPERATION_ERR_USER_NOT_FOUND",e[e.ATTRIBUTE_OPERATION_ERR_TIMEOUT=7]="ATTRIBUTE_OPERATION_ERR_TIMEOUT",e[e.ATTRIBUTE_OPERATION_ERR_USER_NOT_LOGGED_IN=102]="ATTRIBUTE_OPERATION_ERR_USER_NOT_LOGGED_IN"}(Ic||(Ic={})),function(e){e[e.CHANNEL_MESSAGE_ERR_FAILURE=1]="CHANNEL_MESSAGE_ERR_FAILURE",e[e.CHANNEL_MESSAGE_ERR_TIMEOUT=2]="CHANNEL_MESSAGE_ERR_TIMEOUT",e[e.CHANNEL_MESSAGE_ERR_TOO_OFTEN=3]="CHANNEL_MESSAGE_ERR_TOO_OFTEN",e[e.CHANNEL_MESSAGE_ERR_INVALID_MESSAGE=4]="CHANNEL_MESSAGE_ERR_INVALID_MESSAGE",e[e.CHANNEL_MESSAGE_ERR_NOT_IN_CHANNEL=5]="CHANNEL_MESSAGE_ERR_NOT_IN_CHANNEL",e[e.CHANNEL_MESSAGE_ERR_USER_NOT_LOGGED_IN=102]="CHANNEL_MESSAGE_ERR_USER_NOT_LOGGED_IN"}(gd||(gd={})),function(e){e[e.CREATE_CHANNEL_ERR_INVALID_ARGUMENT=1]="CREATE_CHANNEL_ERR_INVALID_ARGUMENT"}(Dk||(Dk={})),function(e){e[e.CREATE_INSTANCE_ERR_INVALID_ARGUMENT=1]="CREATE_INSTANCE_ERR_INVALID_ARGUMENT"}(Ek||(Ek={})),function(e){e[e.GET_MEMBERS_ERR_FAILURE=1]="GET_MEMBERS_ERR_FAILURE",e[e.GET_MEMBERS_ERR_REJECTED=2]="GET_MEMBERS_ERR_REJECTED",e[e.GET_MEMBERS_ERR_TIMEOUT=3]="GET_MEMBERS_ERR_TIMEOUT",e[e.GET_MEMBERS_ERR_TOO_OFTEN=4]="GET_MEMBERS_ERR_TOO_OFTEN",e[e.GET_MEMBERS_ERR_NOT_IN_CHANNEL=5]="GET_MEMBERS_ERR_NOT_IN_CHANNEL",e[e.GET_MEMBERS_ERR_USER_NOT_LOGGED_IN=102]="GET_MEMBERS_ERR_USER_NOT_LOGGED_IN"}(hd||(hd={})),function(e){e[e.INVITATION_API_CALL_ERR_INVALID_ARGUMENT=1]="INVITATION_API_CALL_ERR_INVALID_ARGUMENT",e[e.INVITATION_API_CALL_ERR_NOT_STARTED=2]="INVITATION_API_CALL_ERR_NOT_STARTED",e[e.INVITATION_API_CALL_ERR_ALREADY_END=3]="INVITATION_API_CALL_ERR_ALREADY_END",e[e.INVITATION_API_CALL_ERR_ALREADY_ACCEPT=4]="INVITATION_API_CALL_ERR_ALREADY_ACCEPT",e[e.INVITATION_API_CALL_ERR_ALREADY_SENT=5]="INVITATION_API_CALL_ERR_ALREADY_SENT"}(Jd||(Jd={})),function(e){e[e.JOIN_CHANNEL_ERR_FAILURE=1]="JOIN_CHANNEL_ERR_FAILURE",e[e.JOIN_CHANNEL_ERR_REJECTED=2]="JOIN_CHANNEL_ERR_REJECTED",e[e.JOIN_CHANNEL_ERR_INVALID_ARGUMENT=3]="JOIN_CHANNEL_ERR_INVALID_ARGUMENT",e[e.JOIN_CHANNEL_TIMEOUT=4]="JOIN_CHANNEL_TIMEOUT",e[e.JOIN_CHANNEL_ERR_EXCEED_LIMIT=5]="JOIN_CHANNEL_ERR_EXCEED_LIMIT",e[e.JOIN_CHANNEL_ERR_ALREADY_JOINED=6]="JOIN_CHANNEL_ERR_ALREADY_JOINED",e[e.JOIN_CHANNEL_ERR_TOO_OFTEN=7]="JOIN_CHANNEL_ERR_TOO_OFTEN",e[e.JOIN_CHANNEL_ERR_JOIN_SAME_CHANNEL_TOO_OFTEN=8]="JOIN_CHANNEL_ERR_JOIN_SAME_CHANNEL_TOO_OFTEN",e[e.JOIN_CHANNEL_ERR_USER_NOT_LOGGED_IN=102]="JOIN_CHANNEL_ERR_USER_NOT_LOGGED_IN",e[e.JOIN_CHANNEL_ERR_ABORTED_BY_LEAVE=201]="JOIN_CHANNEL_ERR_ABORTED_BY_LEAVE",e[e.JOIN_CHANNEL_ERR_ALREADY_JOINED_CHANNEL_OF_SAME_ID=202]="JOIN_CHANNEL_ERR_ALREADY_JOINED_CHANNEL_OF_SAME_ID"}(ac||(ac={})),function(e){e[e.LEAVE_CHANNEL_ERR_FAILURE=1]="LEAVE_CHANNEL_ERR_FAILURE",e[e.LEAVE_CHANNEL_ERR_REJECTED=2]="LEAVE_CHANNEL_ERR_REJECTED",e[e.LEAVE_CHANNEL_ERR_NOT_IN_CHANNEL=3]="LEAVE_CHANNEL_ERR_NOT_IN_CHANNEL",e[e.LEAVE_CHANNEL_ERR_USER_NOT_LOGGED_IN=102]="LEAVE_CHANNEL_ERR_USER_NOT_LOGGED_IN"}(Ie||(Ie={})),function(e){e[e.LOGIN_ERR_UNKNOWN=1]="LOGIN_ERR_UNKNOWN",e[e.LOGIN_ERR_REJECTED=2]="LOGIN_ERR_REJECTED",e[e.LOGIN_ERR_INVALID_ARGUMENT=3]="LOGIN_ERR_INVALID_ARGUMENT",e[e.LOGIN_ERR_INVALID_APP_ID=4]="LOGIN_ERR_INVALID_APP_ID",e[e.LOGIN_ERR_INVALID_TOKEN=5]="LOGIN_ERR_INVALID_TOKEN",e[e.LOGIN_ERR_TOKEN_EXPIRED=6]="LOGIN_ERR_TOKEN_EXPIRED",e[e.LOGIN_ERR_NOT_AUTHORIZED=7]="LOGIN_ERR_NOT_AUTHORIZED",e[e.LOGIN_ERR_ALREADY_LOGIN=8]="LOGIN_ERR_ALREADY_LOGIN",e[e.LOGIN_ERR_TIMEOUT=9]="LOGIN_ERR_TIMEOUT",e[e.LOGIN_ERR_TOO_OFTEN=10]="LOGIN_ERR_TOO_OFTEN",e[e.LOGIN_ERR_ABORTED_BY_LOGOUT=201]="LOGIN_ERR_ABORTED_BY_LOGOUT"}(Nb||(Nb={})),function(e){e[e.LOGOUT_ERR_USER_NOT_LOGGED_IN=102]="LOGOUT_ERR_USER_NOT_LOGGED_IN"}(Fk||(Fk={})),function(e){e[e.PEER_MESSAGE_ERR_FAILURE=1]="PEER_MESSAGE_ERR_FAILURE",e[e.PEER_MESSAGE_ERR_TIMEOUT=2]="PEER_MESSAGE_ERR_TIMEOUT",e[e.PEER_MESSAGE_ERR_TOO_OFTEN=5]="PEER_MESSAGE_ERR_TOO_OFTEN",e[e.PEER_MESSAGE_ERR_INVALID_USERID=6]="PEER_MESSAGE_ERR_INVALID_USERID",e[e.PEER_MESSAGE_ERR_INVALID_MESSAGE=7]="PEER_MESSAGE_ERR_INVALID_MESSAGE",e[e.PEER_MESSAGE_ERR_INCOMPATIBLE_MESSAGE=8]="PEER_MESSAGE_ERR_INCOMPATIBLE_MESSAGE",e[e.PEER_MESSAGE_ERR_USER_NOT_LOGGED_IN=102]="PEER_MESSAGE_ERR_USER_NOT_LOGGED_IN"}(Jc||(Jc={})),function(e){e[e.QUERY_PEERS_ONLINE_STATUS_ERR_INVALID_ARGUMENT=2]="QUERY_PEERS_ONLINE_STATUS_ERR_INVALID_ARGUMENT",e[e.QUERY_PEERS_ONLINE_STATUS_ERR_REJECTED=3]="QUERY_PEERS_ONLINE_STATUS_ERR_REJECTED",e[e.QUERY_PEERS_ONLINE_STATUS_ERR_TIMEOUT=4]="QUERY_PEERS_ONLINE_STATUS_ERR_TIMEOUT",e[e.QUERY_PEERS_ONLINE_STATUS_ERR_TOO_OFTEN=5]="QUERY_PEERS_ONLINE_STATUS_ERR_TOO_OFTEN",e[e.QUERY_PEERS_ONLINE_STATUS_ERR_USER_NOT_LOGGED_IN=102]="QUERY_PEERS_ONLINE_STATUS_ERR_USER_NOT_LOGGED_IN"}(Kd||(Kd={})),function(e){e[e.RENEW_TOKEN_ERR_FAILURE=1]="RENEW_TOKEN_ERR_FAILURE",e[e.RENEW_TOKEN_ERR_INVALID_ARGUMENT=2]="RENEW_TOKEN_ERR_INVALID_ARGUMENT",e[e.RENEW_TOKEN_ERR_REJECTED=3]="RENEW_TOKEN_ERR_REJECTED",e[e.RENEW_TOKEN_ERR_TOO_OFTEN=4]="RENEW_TOKEN_ERR_TOO_OFTEN",e[e.RENEW_TOKEN_ERR_TOKEN_EXPIRED=5]="RENEW_TOKEN_ERR_TOKEN_EXPIRED",e[e.RENEW_TOKEN_ERR_INVALID_TOKEN=6]="RENEW_TOKEN_ERR_INVALID_TOKEN",e[e.RENEW_TOKEN_ERR_USER_NOT_LOGGED_IN=102]="RENEW_TOKEN_ERR_USER_NOT_LOGGED_IN",e[e.RENEW_TOKEN_ERR_ABORTED_BY_LOGOUT=201]="RENEW_TOKEN_ERR_ABORTED_BY_LOGOUT"}(Kc||(Kc={})),function(e){e[e.GET_CHANNEL_MEMBER_COUNT_ERR_FAILURE=1]="GET_CHANNEL_MEMBER_COUNT_ERR_FAILURE",e[e.GET_CHANNEL_MEMBER_COUNT_ERR_INVALID_ARGUMENT=2]="GET_CHANNEL_MEMBER_COUNT_ERR_INVALID_ARGUMENT",e[e.GET_CHANNEL_MEMBER_COUNT_ERR_TOO_OFTEN=3]="GET_CHANNEL_MEMBER_COUNT_ERR_TOO_OFTEN",e[e.GET_CHANNEL_MEMBER_COUNT_ERR_TIMEOUT=4]="GET_CHANNEL_MEMBER_COUNT_ERR_TIMEOUT",e[e.GET_CHANNEL_MEMBER_COUNT_ERR_EXCEED_LIMIT=5]="GET_CHANNEL_MEMBER_COUNT_ERR_EXCEED_LIMIT",e[e.GET_CHANNEL_MEMBER_COUNT_ERR_NOT_INITIALIZED=101]="GET_CHANNEL_MEMBER_COUNT_ERR_NOT_INITIALIZED",e[e.GET_CHANNEL_MEMBER_COUNT_ERR_USER_NOT_LOGGED_IN=102]="GET_CHANNEL_MEMBER_COUNT_ERR_USER_NOT_LOGGED_IN"}(Lc||(Lc={})),function(e){e[e.PEER_SUBSCRIPTION_STATUS_ERR_FAILURE=1]="PEER_SUBSCRIPTION_STATUS_ERR_FAILURE",e[e.PEER_SUBSCRIPTION_STATUS_ERR_INVALID_ARGUMENT=2]="PEER_SUBSCRIPTION_STATUS_ERR_INVALID_ARGUMENT",e[e.PEER_SUBSCRIPTION_STATUS_ERR_REJECTED=3]="PEER_SUBSCRIPTION_STATUS_ERR_REJECTED",e[e.PEER_SUBSCRIPTION_STATUS_ERR_TIMEOUT=4]="PEER_SUBSCRIPTION_STATUS_ERR_TIMEOUT",e[e.PEER_SUBSCRIPTION_STATUS_ERR_TOO_OFTEN=5]="PEER_SUBSCRIPTION_STATUS_ERR_TOO_OFTEN",e[e.PEER_SUBSCRIPTION_STATUS_ERR_OVERFLOW=6]="PEER_SUBSCRIPTION_STATUS_ERR_OVERFLOW",e[e.PEER_SUBSCRIPTION_STATUS_ERR_USER_NOT_LOGGED_IN=102]="PEER_SUBSCRIPTION_STATUS_ERR_USER_NOT_LOGGED_IN"}(Mc||(Mc={})),function(e){e[e.QUERY_PEERS_BY_SUBSCRIPTION_OPTION_ERR_FAILURE=1]="QUERY_PEERS_BY_SUBSCRIPTION_OPTION_ERR_FAILURE",e[e.QUERY_PEERS_BY_SUBSCRIPTION_OPTION_ERR_TIMEOUT=2]="QUERY_PEERS_BY_SUBSCRIPTION_OPTION_ERR_TIMEOUT",e[e.QUERY_PEERS_BY_SUBSCRIPTION_OPTION_ERR_TOO_OFTEN=3]="QUERY_PEERS_BY_SUBSCRIPTION_OPTION_ERR_TOO_OFTEN",e[e.QUERY_PEERS_BY_SUBSCRIPTION_OPTION_ERR_USER_NOT_LOGGED_IN=102]="QUERY_PEERS_BY_SUBSCRIPTION_OPTION_ERR_USER_NOT_LOGGED_IN"}(Je||(Je={})),function(e){e[e.UPLOAD_MEDIA_ERR_FAILURE=1]="UPLOAD_MEDIA_ERR_FAILURE",e[e.UPLOAD_MEDIA_ERR_INVALID_ARGUMENT=2]="UPLOAD_MEDIA_ERR_INVALID_ARGUMENT",e[e.UPLOAD_MEDIA_ERR_TIMEOUT=3]="UPLOAD_MEDIA_ERR_TIMEOUT",e[e.UPLOAD_MEDIA_ERR_SIZE_OVERFLOW=4]="UPLOAD_MEDIA_ERR_SIZE_OVERFLOW",e[e.UPLOAD_MEDIA_ERR_CONCURRENCY_LIMIT_EXCEEDED=5]="UPLOAD_MEDIA_ERR_CONCURRENCY_LIMIT_EXCEEDED",e[e.UPLOAD_MEDIA_ERR_INTERRUPTED=6]="UPLOAD_MEDIA_ERR_INTERRUPTED",e[e.UPLOAD_MEDIA_ERR_NOT_LOGGED_IN=102]="UPLOAD_MEDIA_ERR_NOT_LOGGED_IN"}(Nc||(Nc={})),function(e){e[e.DOWNLOAD_MEDIA_ERR_FAILURE=1]="DOWNLOAD_MEDIA_ERR_FAILURE",e[e.DOWNLOAD_MEDIA_ERR_INVALID_ARGUMENT=2]="DOWNLOAD_MEDIA_ERR_INVALID_ARGUMENT",e[e.DOWNLOAD_MEDIA_ERR_TIMEOUT=3]="DOWNLOAD_MEDIA_ERR_TIMEOUT",e[e.DOWNLOAD_MEDIA_ERR_NOT_EXIST=4]="DOWNLOAD_MEDIA_ERR_NOT_EXIST",e[e.DOWNLOAD_MEDIA_ERR_CONCURRENCY_LIMIT_EXCEEDED=5]="DOWNLOAD_MEDIA_ERR_CONCURRENCY_LIMIT_EXCEEDED",e[e.DOWNLOAD_MEDIA_ERR_INTERRUPTED=6]="DOWNLOAD_MEDIA_ERR_INTERRUPTED",e[e.DOWNLOAD_MEDIA_ERR_NOT_LOGGED_IN=102]="DOWNLOAD_MEDIA_ERR_NOT_LOGGED_IN"}(Oc||(Oc={}));var Ob=Ic.ATTRIBUTE_OPERATION_ERR_FAILURE,Fa=Ic.ATTRIBUTE_OPERATION_ERR_INVALID_ARGUMENT,ee=Ic.ATTRIBUTE_OPERATION_ERR_SIZE_OVERFLOW;Ic.ATTRIBUTE_OPERATION_ERR_TOO_OFTEN;var lq=Ic.ATTRIBUTE_OPERATION_ERR_USER_NOT_FOUND,Pb=Ic.ATTRIBUTE_OPERATION_ERR_TIMEOUT,Qb=Ic.ATTRIBUTE_OPERATION_ERR_USER_NOT_LOGGED_IN,Tf=gd.CHANNEL_MESSAGE_ERR_FAILURE,Gk=gd.CHANNEL_MESSAGE_ERR_TIMEOUT,mq=gd.CHANNEL_MESSAGE_ERR_TOO_OFTEN,qh=gd.CHANNEL_MESSAGE_ERR_INVALID_MESSAGE;gd.CHANNEL_MESSAGE_ERR_NOT_IN_CHANNEL;var Uf=gd.CHANNEL_MESSAGE_ERR_USER_NOT_LOGGED_IN,wz=Dk.CREATE_CHANNEL_ERR_INVALID_ARGUMENT,xz=Ek.CREATE_INSTANCE_ERR_INVALID_ARGUMENT;Lc.GET_CHANNEL_MEMBER_COUNT_ERR_FAILURE;var nq=Lc.GET_CHANNEL_MEMBER_COUNT_ERR_INVALID_ARGUMENT;Lc.GET_CHANNEL_MEMBER_COUNT_ERR_TOO_OFTEN;var oq=Lc.GET_CHANNEL_MEMBER_COUNT_ERR_TIMEOUT,yz=Lc.GET_CHANNEL_MEMBER_COUNT_ERR_EXCEED_LIMIT;Lc.GET_CHANNEL_MEMBER_COUNT_ERR_NOT_INITIALIZED;var zz=Lc.GET_CHANNEL_MEMBER_COUNT_ERR_USER_NOT_LOGGED_IN,Az=hd.GET_MEMBERS_ERR_FAILURE,Bz=hd.GET_MEMBERS_ERR_REJECTED;hd.GET_MEMBERS_ERR_TIMEOUT,hd.GET_MEMBERS_ERR_TOO_OFTEN;var Cz=hd.GET_MEMBERS_ERR_NOT_IN_CHANNEL,Dz=hd.GET_MEMBERS_ERR_USER_NOT_LOGGED_IN,rc=Jd.INVITATION_API_CALL_ERR_INVALID_ARGUMENT,Ez=Jd.INVITATION_API_CALL_ERR_NOT_STARTED,rh=Jd.INVITATION_API_CALL_ERR_ALREADY_END,pq=Jd.INVITATION_API_CALL_ERR_ALREADY_ACCEPT,Fz=Jd.INVITATION_API_CALL_ERR_ALREADY_SENT,qq=ac.JOIN_CHANNEL_ERR_FAILURE;ac.JOIN_CHANNEL_ERR_REJECTED;var Gz=ac.JOIN_CHANNEL_ERR_INVALID_ARGUMENT,rq=ac.JOIN_CHANNEL_TIMEOUT,sq=ac.JOIN_CHANNEL_ERR_EXCEED_LIMIT,tq=ac.JOIN_CHANNEL_ERR_ALREADY_JOINED;ac.JOIN_CHANNEL_ERR_TOO_OFTEN;var uq=ac.JOIN_CHANNEL_ERR_USER_NOT_LOGGED_IN,vq=ac.JOIN_CHANNEL_ERR_ALREADY_JOINED_CHANNEL_OF_SAME_ID,wq=Ie.LEAVE_CHANNEL_ERR_FAILURE,xq=Ie.LEAVE_CHANNEL_ERR_REJECTED,Hz=Ie.LEAVE_CHANNEL_ERR_NOT_IN_CHANNEL,Iz=Ie.LEAVE_CHANNEL_ERR_USER_NOT_LOGGED_IN,yq=Nb.LOGIN_ERR_UNKNOWN,sh=Nb.LOGIN_ERR_REJECTED,th=Nb.LOGIN_ERR_INVALID_ARGUMENT,zq=Nb.LOGIN_ERR_INVALID_APP_ID,Aq=Nb.LOGIN_ERR_INVALID_TOKEN,uh=Nb.LOGIN_ERR_TOKEN_EXPIRED;Nb.LOGIN_ERR_NOT_AUTHORIZED;var Jz=Nb.LOGIN_ERR_ALREADY_LOGIN,Kz=Nb.LOGIN_ERR_TIMEOUT,Lz=Nb.LOGIN_ERR_TOO_OFTEN,Bq=Fk.LOGOUT_ERR_USER_NOT_LOGGED_IN,Cq=Jc.PEER_MESSAGE_ERR_FAILURE,Hk=Jc.PEER_MESSAGE_ERR_TIMEOUT,Dq=Jc.PEER_MESSAGE_ERR_TOO_OFTEN,Ik=Jc.PEER_MESSAGE_ERR_INVALID_USERID,ge=Jc.PEER_MESSAGE_ERR_INVALID_MESSAGE,Jk=Jc.PEER_MESSAGE_ERR_USER_NOT_LOGGED_IN,Mz=Jc.PEER_MESSAGE_ERR_INCOMPATIBLE_MESSAGE,Eq=Kd.QUERY_PEERS_ONLINE_STATUS_ERR_INVALID_ARGUMENT;Kd.QUERY_PEERS_ONLINE_STATUS_ERR_REJECTED;var Nz=Kd.QUERY_PEERS_ONLINE_STATUS_ERR_TIMEOUT;Kd.QUERY_PEERS_ONLINE_STATUS_ERR_TOO_OFTEN;var Oz=Kd.QUERY_PEERS_ONLINE_STATUS_ERR_USER_NOT_LOGGED_IN,Pz=Kc.RENEW_TOKEN_ERR_FAILURE,Qz=Kc.RENEW_TOKEN_ERR_INVALID_ARGUMENT;Kc.RENEW_TOKEN_ERR_REJECTED,Kc.RENEW_TOKEN_ERR_TOO_OFTEN;var Rz=Kc.RENEW_TOKEN_ERR_TOKEN_EXPIRED,Sz=Kc.RENEW_TOKEN_ERR_INVALID_TOKEN,Tz=Kc.RENEW_TOKEN_ERR_USER_NOT_LOGGED_IN,Fq=Mc.PEER_SUBSCRIPTION_STATUS_ERR_FAILURE,Vf=Mc.PEER_SUBSCRIPTION_STATUS_ERR_INVALID_ARGUMENT;Mc.PEER_SUBSCRIPTION_STATUS_ERR_REJECTED;var Uz=Mc.PEER_SUBSCRIPTION_STATUS_ERR_TIMEOUT;Mc.PEER_SUBSCRIPTION_STATUS_ERR_TOO_OFTEN;var Gq=Mc.PEER_SUBSCRIPTION_STATUS_ERR_OVERFLOW,Kk=Mc.PEER_SUBSCRIPTION_STATUS_ERR_USER_NOT_LOGGED_IN;Je.QUERY_PEERS_BY_SUBSCRIPTION_OPTION_ERR_FAILURE,Je.QUERY_PEERS_BY_SUBSCRIPTION_OPTION_ERR_TIMEOUT,Je.QUERY_PEERS_BY_SUBSCRIPTION_OPTION_ERR_TOO_OFTEN,Je.QUERY_PEERS_BY_SUBSCRIPTION_OPTION_ERR_USER_NOT_LOGGED_IN;var Wf=Nc.UPLOAD_MEDIA_ERR_FAILURE,jf=Nc.UPLOAD_MEDIA_ERR_INVALID_ARGUMENT,vh=Nc.UPLOAD_MEDIA_ERR_TIMEOUT,Vz=Nc.UPLOAD_MEDIA_ERR_SIZE_OVERFLOW,Wz=Nc.UPLOAD_MEDIA_ERR_CONCURRENCY_LIMIT_EXCEEDED,Hq=Nc.UPLOAD_MEDIA_ERR_INTERRUPTED,Xz=Nc.UPLOAD_MEDIA_ERR_NOT_LOGGED_IN,Xf=Oc.DOWNLOAD_MEDIA_ERR_FAILURE,Lk=Oc.DOWNLOAD_MEDIA_ERR_INVALID_ARGUMENT,Yz=Oc.DOWNLOAD_MEDIA_ERR_TIMEOUT,Zz=Oc.DOWNLOAD_MEDIA_ERR_NOT_EXIST,$z=Oc.DOWNLOAD_MEDIA_ERR_CONCURRENCY_LIMIT_EXCEEDED,Iq=Oc.DOWNLOAD_MEDIA_ERR_INTERRUPTED,aA=Oc.DOWNLOAD_MEDIA_ERR_NOT_LOGGED_IN,bA=function(e,t){var n;return qk(e,(function(e,r,i){return!(n=t(e,r,i))})),!!n},wh=function(e,t,n){if(!jb(n))return!1;var r=R(t);return!!("number"==r?sd(n)&&gk(t,n.length):"string"==r&&t in n)&&Mf(n[t],e)},Mk=function(e,t,n){var r=Ya(e)?Up:bA;return n&&wh(e,t,n)&&(t=void 0),r(e,Fe(t))},cA=function(e,t){var n=-1,r=sd(e)?Array(e.length):[];return qk(e,(function(e,i,o){r[++n]=t(e,i,o)})),r},dA=function(e,t){var n=e.length;for(e.sort(t);n--;)e[n]=e[n].value;return e},eA=function(e,t,n){t=t.length?Ud(t,(function(e){return Ya(e)?function(t){return kh(t,1===e.length?e[0]:e)}:e})):[lh];var r=-1;return t=Ud(t,hh(Fe)),e=cA(e,(function(e,n,i){return{criteria:Ud(t,(function(t){return t(e)})),index:++r,value:e}})),dA(e,(function(e,t){e:{for(var r=-1,i=e.criteria,o=t.criteria,a=i.length,s=n.length;++r<a;){t:{var c=i[r],u=o[r];if(c!==u){var l=void 0!==c,d=null===c,h=c==c,f=Vd(c),p=void 0!==u,A=null===u,g=u==u,v=Vd(u);if(!A&&!v&&!f&&c>u||f&&p&&g&&!A&&!v||d&&p&&g||!l&&g||!h){c=1;break t}if(!d&&!f&&!v&&c<u||v&&l&&h&&!d&&!f||A&&l&&h||!p&&h||!g){c=-1;break t}}c=0}if(c){e=r>=s?c:c*("desc"==n[r]?-1:1);break e}}e=e.index-t.index}return e}))},Jq=function(e,t){return Sp(Rp(e,t,lh),e+"")},Kq=Jq((function(e,t){if(null==e)return[];var n=t.length;return 1<n&&wh(e,t[0],t[1])?t=[]:2<n&&wh(t[0],t[1],t[2])&&(t=[t[0]]),eA(e,Lh(t,1),[])})),Lq=function(e){if(e.__esModule)return e;var t=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(e).forEach((function(n){var r=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,r.get?r:{enumerable:!0,get:function(){return e[n]}})})),t}(az),Mq=Xa((function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=[],r=function(e,t){return new WebSocket(e,t)};t.normalClosureMessage="Normal closure",t.default=function(e,i){var o=(i=void 0===i?{protocols:n,makeWebSocket:r}:i).protocols,a=void 0===o?n:o,s=void 0===(i=i.makeWebSocket)?r:i;return new Lq.Observable((function(n){var r,i=new Lq.Subject,o=s(e,a),c=!1,u=!1,l=function(e){if(r)throw c=!0,e=Error("Web socket message factory function called more than once"),n.error(e),e;return r=e.subscribe((function(e){o.send(e)})),i};return o.onopen=function(){u?(c=!0,o.close()):n.next(l)},o.onmessage=function(e){i.next(e.data)},o.onerror=function(e){c=!0,n.error(Error(e.message))},o.onclose=function(e){c||(c=!0,u?(n.complete(),i.complete()):n.error(Error(1e3===e.code?t.normalClosureMessage:e.reason)))},function(){u=!0,r&&r.unsubscribe(),c||(c=!0,o.close())}}))}}));!function(e){e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")&&e.default}(Mq);var bi=function(e,t,n){(void 0===n||Mf(e[t],n))&&(void 0!==n||t in e)||Of(e,t,n)},ai=function(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]},fA=function(e){return Jq((function(t,n){var r=-1,i=n.length,o=1<i?n[i-1]:void 0,a=2<i?n[2]:void 0;for(o=3<e.length&&"function"==typeof o?(i--,o):void 0,a&&wh(n[0],n[1],a)&&(o=3>i?void 0:o,i=1),t=Object(t);++r<i;)(a=n[r])&&e(t,a,r,o);return t}))}((function(e,t,n,r){Zl(e,t,n,r)})),cm=[],dm=function(e,t){return new WebSocket(e,t)};N({target:"Number",stat:!0},{isInteger:dp}),Sn("from",jj,ej);var gA=function(e,t){for(var n=Array(arguments.length-1),r=0,i=2,o=!0;i<arguments.length;)n[r++]=arguments[i++];return new Promise((function(i,a){n[r]=function(e){if(o)if(o=!1,e)a(e);else{for(var t=Array(arguments.length-1),n=0;n<t.length;)t[n++]=arguments[n];i.apply(null,t)}};try{e.apply(t||null,n)}catch(e){o&&(o=!1,a(e))}}))},hA=Xa((function(e,t){t.length=function(e){var t=e.length;if(!t)return 0;for(var n=0;1<--t%4&&"="===e.charAt(t);)++n;return Math.ceil(3*e.length)/4-n};var n=Array(64),r=Array(123);for(e=0;64>e;)r[n[e]=26>e?e+65:52>e?e+71:62>e?e-4:e-59|43]=e++;t.encode=function(e,t,r){for(var i,o=null,a=[],s=0,c=0;t<r;){var u=e[t++];switch(c){case 0:a[s++]=n[u>>2],i=(3&u)<<4,c=1;break;case 1:a[s++]=n[i|u>>4],i=(15&u)<<2,c=2;break;case 2:a[s++]=n[i|u>>6],a[s++]=n[63&u],c=0}8191<s&&((o||(o=[])).push(String.fromCharCode.apply(String,a)),s=0)}return c&&(a[s++]=n[i],a[s++]=61,1===c&&(a[s++]=61)),o?(s&&o.push(String.fromCharCode.apply(String,a.slice(0,s))),o.join("")):String.fromCharCode.apply(String,a.slice(0,s))},t.decode=function(e,t,n){for(var i,o=n,a=0,s=0;s<e.length;){var c=e.charCodeAt(s++);if(61===c&&1<a)break;if(void 0===(c=r[c]))throw Error("invalid encoding");switch(a){case 0:i=c,a=1;break;case 1:t[n++]=i<<2|(48&c)>>4,i=c,a=2;break;case 2:t[n++]=(15&i)<<4|(60&c)>>2,i=c,a=3;break;case 3:t[n++]=(3&i)<<6|c,a=0}}if(1===a)throw Error("invalid encoding");return n-o},t.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}}));jg.prototype.on=function(e,t,n){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:t,ctx:n||this}),this},jg.prototype.off=function(e,t){if(void 0===e)this._listeners={};else if(void 0===t)this._listeners[e]=[];else{e=this._listeners[e];for(var n=0;n<e.length;)e[n].fn===t?e.splice(n,1):++n}return this},jg.prototype.emit=function(e){var t=this._listeners[e];if(t){for(var n=[],r=1;r<arguments.length;)n.push(arguments[r++]);for(r=0;r<t.length;)t[r].fn.apply(t[r++].ctx,n)}return this};var iA=em(em),jA=function(c){try{var a=eval("quire".replace(/^/,"re"))(c);if(a&&(a.length||Object.keys(a).length))return a}catch(e){}return null},kA=Xa((function(e,t){t.length=function(e){for(var t,n=0,r=0;r<e.length;++r)128>(t=e.charCodeAt(r))?n+=1:2048>t?n+=2:55296==(64512&t)&&56320==(64512&e.charCodeAt(r+1))?(++r,n+=4):n+=3;return n},t.read=function(e,t,n){if(1>n-t)return"";for(var r,i=null,o=[],a=0;t<n;)128>(r=e[t++])?o[a++]=r:191<r&&224>r?o[a++]=(31&r)<<6|63&e[t++]:239<r&&365>r?(r=((7&r)<<18|(63&e[t++])<<12|(63&e[t++])<<6|63&e[t++])-65536,o[a++]=55296+(r>>10),o[a++]=56320+(1023&r)):o[a++]=(15&r)<<12|(63&e[t++])<<6|63&e[t++],8191<a&&((i||(i=[])).push(String.fromCharCode.apply(String,o)),a=0);return i?(a&&i.push(String.fromCharCode.apply(String,o.slice(0,a))),i.join("")):String.fromCharCode.apply(String,o.slice(0,a))},t.write=function(e,t,n){for(var r,i,o=n,a=0;a<e.length;++a)128>(r=e.charCodeAt(a))?t[n++]=r:(2048>r?t[n++]=r>>6|192:(55296==(64512&r)&&56320==(64512&(i=e.charCodeAt(a+1)))?(r=65536+((1023&r)<<10)+(1023&i),++a,t[n++]=r>>18|240,t[n++]=r>>12&63|128):t[n++]=r>>12|224,t[n++]=r>>6&63|128),t[n++]=63&r|128);return n-o}})),lA=function(e,t,n){var r=n||8192,i=r>>>1,o=null,a=r;return function(n){return 1>n||n>i?e(n):(a+n>r&&(o=e(r),a=0),n=t.call(o,a,a+=n),7&a&&(a=1+(7|a)),n)}},Ld=Ra.zero=new Ra(0,0);Ld.toNumber=function(){return 0},Ld.zzEncode=Ld.zzDecode=function(){return this},Ld.length=function(){return 1};var mA=Ra.zeroHash="\0\0\0\0\0\0\0\0";Ra.fromNumber=function(e){if(0===e)return Ld;var t=0>e;t&&(e=-e);var n=e>>>0;return e=(e-n)/4294967296>>>0,t&&(e=~e>>>0,n=~n>>>0,4294967295<++n&&(n=0,4294967295<++e&&(e=0))),new Ra(n,e)},Ra.from=function(e){if("number"==typeof e)return Ra.fromNumber(e);if(T.isString(e)){if(!T.Long)return Ra.fromNumber(parseInt(e,10));e=T.Long.fromString(e)}return e.low||e.high?new Ra(e.low>>>0,e.high>>>0):Ld},Ra.prototype.toNumber=function(e){if(!e&&this.hi>>>31){e=1+~this.lo>>>0;var t=~this.hi>>>0;return e||(t=t+1>>>0),-(e+4294967296*t)}return this.lo+4294967296*this.hi},Ra.prototype.toLong=function(e){return T.Long?new T.Long(0|this.lo,0|this.hi,!!e):{low:0|this.lo,high:0|this.hi,unsigned:!!e}};var id=String.prototype.charCodeAt;Ra.fromHash=function(e){return e===mA?Ld:new Ra((id.call(e,0)|id.call(e,1)<<8|id.call(e,2)<<16|id.call(e,3)<<24)>>>0,(id.call(e,4)|id.call(e,5)<<8|id.call(e,6)<<16|id.call(e,7)<<24)>>>0)},Ra.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},Ra.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this},Ra.prototype.zzDecode=function(){var e=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this},Ra.prototype.length=function(){var e=this.lo,t=(this.lo>>>28|this.hi<<4)>>>0,n=this.hi>>>24;return 0===n?0===t?16384>e?128>e?1:2:2097152>e?3:4:16384>t?128>t?5:6:2097152>t?7:8:128>n?9:10};var T=Xa((function(e,t){function n(e,t,n){for(var r=Object.keys(t),i=0;i<r.length;++i)void 0!==e[r[i]]&&n||(e[r[i]]=t[r[i]]);return e}function r(e){function t(e,r){if(!(this instanceof t))return new t(e,r);Object.defineProperty(this,"message",{get:function(){return e}}),Error.captureStackTrace?Error.captureStackTrace(this,t):Object.defineProperty(this,"stack",{value:Error().stack||""}),r&&n(this,r)}return(t.prototype=Object.create(Error.prototype)).constructor=t,Object.defineProperty(t.prototype,"name",{get:function(){return e}}),t.prototype.toString=function(){return this.name+": "+this.message},t}t.asPromise=gA,t.base64=hA,t.EventEmitter=jg,t.float=iA,t.inquire=jA,t.utf8=kA,t.pool=lA,t.LongBits=Ra,t.isNode=!!(void 0!==Ta&&Ta&&Ta.process&&Ta.process.versions&&Ta.process.versions.node),t.global=t.isNode&&Ta||"undefined"!=typeof window&&window||"undefined"!=typeof self&&self||Ta,t.emptyArray=Object.freeze?Object.freeze([]):[],t.emptyObject=Object.freeze?Object.freeze({}):{},t.isInteger=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},t.isString=function(e){return"string"==typeof e||e instanceof String},t.isObject=function(e){return e&&"object"===R(e)},t.isset=t.isSet=function(e,t){var n=e[t];return!(null==n||!e.hasOwnProperty(t))&&("object"!==R(n)||0<(Array.isArray(n)?n.length:Object.keys(n).length))},t.Buffer=function(){try{var e=t.inquire("buffer").Buffer;return e.prototype.utf8Write?e:null}catch(e){return null}}(),t._Buffer_from=null,t._Buffer_allocUnsafe=null,t.newBuffer=function(e){return"number"==typeof e?t.Buffer?t._Buffer_allocUnsafe(e):new t.Array(e):t.Buffer?t._Buffer_from(e):"undefined"==typeof Uint8Array?e:new Uint8Array(e)},t.Array="undefined"!=typeof Uint8Array?Uint8Array:Array,t.Long=t.global.dcodeIO&&t.global.dcodeIO.Long||t.global.Long||t.inquire("long"),t.key2Re=/^true|false|0|1$/,t.key32Re=/^-?(?:0|[1-9][0-9]*)$/,t.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,t.longToHash=function(e){return e?t.LongBits.from(e).toHash():t.LongBits.zeroHash},t.longFromHash=function(e,n){return e=t.LongBits.fromHash(e),t.Long?t.Long.fromBits(e.lo,e.hi,n):e.toNumber(!!n)},t.merge=n,t.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)},t.newError=r,t.ProtocolError=r("ProtocolError"),t.oneOfGetter=function(e){for(var t={},n=0;n<e.length;++n)t[e[n]]=1;return function(){for(var e=Object.keys(this),n=e.length-1;-1<n;--n)if(1===t[e[n]]&&void 0!==this[e[n]]&&null!==this[e[n]])return e[n]}},t.oneOfSetter=function(e){return function(t){for(var n=0;n<e.length;++n)e[n]!==t&&delete this[e[n]]}},t.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},t._configure=function(){var e=t.Buffer;e?(t._Buffer_from=e.from!==Uint8Array.from&&e.from||function(t,n){return new e(t,n)},t._Buffer_allocUnsafe=e.allocUnsafe||function(t){return new e(t)}):t._Buffer_from=t._Buffer_allocUnsafe=null}})),ji=ha,Nk,xh=T.LongBits,Nq=T.base64,Oq=T.utf8,Pq=function(){return T.Buffer?function(){return(ha.create=function(){return new Nk})()}:function(){return new ha}};ha.create=Pq(),ha.alloc=function(e){return new T.Array(e)},T.Array!==Array&&(ha.alloc=T.pool(ha.alloc,T.Array.prototype.subarray)),ha.prototype._push=function(e,t,n){return this.tail=this.tail.next=new df(e,t,n),this.len+=t,this},gi.prototype=Object.create(df.prototype),gi.prototype.fn=function(e,t,n){for(;127<e;)t[n++]=127&e|128,e>>>=7;t[n]=e},ha.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new gi(128>(e>>>=0)?1:16384>e?2:2097152>e?3:268435456>e?4:5,e)).len,this},ha.prototype.int32=function(e){return 0>e?this._push(hi,10,xh.fromNumber(e)):this.uint32(e)},ha.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)},ha.prototype.uint64=function(e){return e=xh.from(e),this._push(hi,e.length(),e)},ha.prototype.int64=ha.prototype.uint64,ha.prototype.sint64=function(e){return e=xh.from(e).zzEncode(),this._push(hi,e.length(),e)},ha.prototype.bool=function(e){return this._push(fi,1,e?1:0)},ha.prototype.fixed32=function(e){return this._push(ii,4,e>>>0)},ha.prototype.sfixed32=ha.prototype.fixed32,ha.prototype.fixed64=function(e){return e=xh.from(e),this._push(ii,4,e.lo)._push(ii,4,e.hi)},ha.prototype.sfixed64=ha.prototype.fixed64,ha.prototype.float=function(e){return this._push(T.float.writeFloatLE,4,e)},ha.prototype.double=function(e){return this._push(T.float.writeDoubleLE,8,e)};var nA=T.Array.prototype.set?function(e,t,n){t.set(e,n)}:function(e,t,n){for(var r=0;r<e.length;++r)t[n+r]=e[r]};ha.prototype.bytes=function(e){var t=e.length>>>0;if(!t)return this._push(fi,1,0);if(T.isString(e)){var n=ha.alloc(t=Nq.length(e));Nq.decode(e,n,0),e=n}return this.uint32(t)._push(nA,t,e)},ha.prototype.string=function(e){var t=Oq.length(e);return t?this.uint32(t)._push(Oq.write,t,e):this._push(fi,1,0)},ha.prototype.fork=function(){return this.states=new nt(this),this.head=this.tail=new df(ei,0,0),this.len=0,this},ha.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new df(ei,0,0),this.len=0),this},ha.prototype.ldelim=function(){var e=this.head,t=this.tail,n=this.len;return this.reset().uint32(n),n&&(this.tail.next=e.next,this.tail=t,this.len+=n),this},ha.prototype.finish=function(){for(var e=this.head.next,t=this.constructor.alloc(this.len),n=0;e;)e.fn(e.val,t,n),n+=e.len,e=e.next;return t},ha._configure=function(e){Nk=e,ha.create=Pq(),Nk._configure()},(gc.prototype=Object.create(ji.prototype)).constructor=gc,gc._configure=function(){gc.alloc=T._Buffer_allocUnsafe,gc.writeBytesBuffer=T.Buffer&&T.Buffer.prototype instanceof Uint8Array&&"set"===T.Buffer.prototype.set.name?function(e,t,n){t.set(e,n)}:function(e,t,n){if(e.copy)e.copy(t,n,0,e.length);else for(var r=0;r<e.length;)t[n++]=e[r++]}},gc.prototype.bytes=function(e){T.isString(e)&&(e=T._Buffer_from(e,"base64"));var t=e.length>>>0;return this.uint32(t),t&&this._push(gc.writeBytesBuffer,t,e),this},gc.prototype.string=function(e){var t=T.Buffer.byteLength(e);return this.uint32(t),t&&this._push(ot,t,e),this},gc._configure();var li=Ha,Ok,jm=T.LongBits,oA=T.utf8,Qq="undefined"!=typeof Uint8Array?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new Ha(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new Ha(e);throw Error("illegal buffer")},Rq=function(){return T.Buffer?function(e){return(Ha.create=function(e){return T.Buffer.isBuffer(e)?new Ok(e):Qq(e)})(e)}:Qq};Ha.create=Rq(),Ha.prototype._slice=T.Array.prototype.subarray||T.Array.prototype.slice,Ha.prototype.uint32=function(){var e=4294967295;return function(){if(e=(127&this.buf[this.pos])>>>0,128>this.buf[this.pos++])return e;if(e=(e|(127&this.buf[this.pos])<<7)>>>0,128>this.buf[this.pos++])return e;if(e=(e|(127&this.buf[this.pos])<<14)>>>0,128>this.buf[this.pos++])return e;if(e=(e|(127&this.buf[this.pos])<<21)>>>0,128>this.buf[this.pos++])return e;if(e=(e|(15&this.buf[this.pos])<<28)>>>0,128>this.buf[this.pos++])return e;if((this.pos+=5)>this.len)throw this.pos=this.len,Ub(this,10);return e}}(),Ha.prototype.int32=function(){return 0|this.uint32()},Ha.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(1&e)|0},Ha.prototype.bool=function(){return 0!==this.uint32()},Ha.prototype.fixed32=function(){if(this.pos+4>this.len)throw Ub(this,4);return kg(this.buf,this.pos+=4)},Ha.prototype.sfixed32=function(){if(this.pos+4>this.len)throw Ub(this,4);return 0|kg(this.buf,this.pos+=4)},Ha.prototype.float=function(){if(this.pos+4>this.len)throw Ub(this,4);var e=T.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e},Ha.prototype.double=function(){if(this.pos+8>this.len)throw Ub(this,4);var e=T.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e},Ha.prototype.bytes=function(){var e=this.uint32(),t=this.pos,n=this.pos+e;if(n>this.len)throw Ub(this,e);return this.pos+=e,Array.isArray(this.buf)?this.buf.slice(t,n):t===n?new this.buf.constructor(0):this._slice.call(this.buf,t,n)},Ha.prototype.string=function(){var e=this.bytes();return oA.read(e,0,e.length)},Ha.prototype.skip=function(e){if("number"==typeof e){if(this.pos+e>this.len)throw Ub(this,e);this.pos+=e}else do{if(this.pos>=this.len)throw Ub(this)}while(128&this.buf[this.pos++]);return this},Ha.prototype.skipType=function(e){switch(e){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;4!=(e=7&this.uint32());)this.skipType(e);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+e+" at offset "+this.pos)}return this},Ha._configure=function(e){Ok=e,Ha.create=Rq(),Ok._configure();var t=T.Long?"toLong":"toNumber";T.merge(Ha.prototype,{int64:function(){return ki.call(this)[t](!1)},uint64:function(){return ki.call(this)[t](!0)},sint64:function(){return ki.call(this).zzDecode()[t](!1)},fixed64:function(){return km.call(this)[t](!0)},sfixed64:function(){return km.call(this)[t](!1)}})},(td.prototype=Object.create(li.prototype)).constructor=td,td._configure=function(){T.Buffer&&(td.prototype._slice=T.Buffer.prototype.slice)},td.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))},td._configure(),(ef.prototype=Object.create(T.EventEmitter.prototype)).constructor=ef,ef.prototype.rpcCall=function e(t,n,r,i,o){if(!i)throw TypeError("request must be specified");var a=this;if(!o)return T.asPromise(e,a,t,n,r,i);if(a.rpcImpl)try{return a.rpcImpl(t,n[a.requestDelimited?"encodeDelimited":"encode"](i).finish(),(function(e,n){if(e)return a.emit("error",e,t),o(e);if(null!==n){if(!(n instanceof r))try{n=r[a.responseDelimited?"decodeDelimited":"decode"](n)}catch(e){return a.emit("error",e,t),o(e)}return a.emit("data",n,t),o(null,n)}a.end(!0)}))}catch(e){a.emit("error",e,t),setTimeout((function(){o(e)}),0)}else setTimeout((function(){o(Error("already ended"))}),0)},ef.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this};var pA=Xa((function(e,t){t.Service=ef})),qA={},bc=Xa((function(e,t){function n(){r.util._configure(),r.Writer._configure(r.BufferWriter),r.Reader._configure(r.BufferReader)}var r=t;r.build="minimal",r.Writer=ji,r.BufferWriter=gc,r.Reader=li,r.BufferReader=td,r.util=T,r.rpc=pA,r.roots=qA,r.configure=n,n()}));bc.util.Long=U,bc.configure();var y=bc.Reader,J=bc.Writer,q=bc.util,t=bc.roots.default||(bc.roots.default={}),rA=t.URI=function(){var e={},t=Object.create(e);return t[e[0]="Unknown"]=0,t[e[1]="PingUri"]=1,t[e[2]="PongUri"]=2,t[e[11]="UserJoinUri"]=11,t[e[12]="UserRespUri"]=12,t[e[21]="UserQuitUri"]=21,t[e[22]="UserDropUri"]=22,t[e[31]="GroupEnterUri"]=31,t[e[32]="GroupLeaveUri"]=32,t[e[33]="GroupReplyUri"]=33,t[e[36]="GroupEnterNoticeUri"]=36,t[e[37]="GroupLeaveNoticeUri"]=37,t[e[38]="GroupEventNoticeUri"]=38,t[e[39]="GroupCountNoticeUri"]=39,t[e[41]="UserStatusListUri"]=41,t[e[42]="UserStatusResultUri"]=42,t[e[51]="GroupStatusListUri"]=51,t[e[52]="GroupStatusResultUri"]=52,t[e[55]="GroupAllUsersListUri"]=55,t[e[56]="GroupAllUsersResultUri"]=56,t[e[100]="MessageUri"]=100,t[e[101]="AckUri"]=101,t[e[115]="FileUploadIndexGetUri"]=115,t[e[116]="FileUploadIndexRetUri"]=116,t[e[117]="FileUploadIndexSetUri"]=117,t[e[118]="FileUploadIndexFinUri"]=118,t[e[119]="FileUploadIndexErrUri"]=119,t[e[125]="FileDownloadIndexGetUri"]=125,t[e[126]="FileDownloadIndexRetUri"]=126,t[e[127]="FileDownloadIndexErrUri"]=127,t[e[201]="UserJoinNoticeUri"]=201,t[e[202]="UserQuitNoticeUri"]=202,t[e[203]="UserWaitNoticeUri"]=203,t[e[301]="UserAttributeGetUri"]=301,t[e[302]="UserAttributeRetUri"]=302,t[e[303]="UserAttributeSetUri"]=303,t[e[304]="UserAttributeModUri"]=304,t[e[305]="UserAttributeDelUri"]=305,t[e[307]="UserAttributeRspUri"]=307,t[e[308]="UserAttributeErrUri"]=308,t[e[311]="UserAttributeKeysGetUri"]=311,t[e[312]="UserAttributeKeysRetUri"]=312,t[e[351]="GroupAttributeGetUri"]=351,t[e[352]="GroupAttributeRetUri"]=352,t[e[353]="GroupAttributeSetUri"]=353,t[e[354]="GroupAttributeModUri"]=354,t[e[355]="GroupAttributeDelUri"]=355,t[e[356]="GroupAttributeAltUri"]=356,t[e[357]="GroupAttributeRspUri"]=357,t[e[358]="GroupAttributeErrUri"]=358,t[e[361]="GroupAttributeKeysGetUri"]=361,t[e[362]="GroupAttributeKeysRetUri"]=362,t[e[401]="SubscribeUserStatusUri"]=401,t[e[402]="UnsubscribeUserStatusUri"]=402,t[e[499]="SubscribeResponseUri"]=499,t}(),yh=t.Wrapper=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.uri=0,e.prototype.data=q.newBuffer([]),e.encode=function(e,t){return t||(t=J.create()),null!=e.uri&&Object.hasOwnProperty.call(e,"uri")&&t.uint32(8).int32(e.uri),null!=e.data&&Object.hasOwnProperty.call(e,"data")&&t.uint32(18).bytes(e.data),t},e.decode=function(e,n){e instanceof y||(e=y.create(e)),n=void 0===n?e.len:e.pos+n;for(var r=new t.Wrapper;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.uri=e.int32();break;case 2:r.data=e.bytes();break;default:e.skipType(7&i)}}return r},e}(),sA=t.Ping=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,e.prototype.ms=q.Long?q.Long.fromBits(0,0,!0):0,e.encode=function(e,t){return t||(t=J.create()),null!=e.seq&&Object.hasOwnProperty.call(e,"seq")&&t.uint32(8).uint64(e.seq),null!=e.ms&&Object.hasOwnProperty.call(e,"ms")&&t.uint32(16).uint64(e.ms),t},e.decode=function(e,n){e instanceof y||(e=y.create(e)),n=void 0===n?e.len:e.pos+n;for(var r=new t.Ping;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.seq=e.uint64();break;case 2:r.ms=e.uint64();break;default:e.skipType(7&i)}}return r},e}(),tA=t.Pong=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,e.prototype.ms=q.Long?q.Long.fromBits(0,0,!0):0,e.encode=function(e,t){return t||(t=J.create()),null!=e.seq&&Object.hasOwnProperty.call(e,"seq")&&t.uint32(8).uint64(e.seq),null!=e.ms&&Object.hasOwnProperty.call(e,"ms")&&t.uint32(16).uint64(e.ms),t},e.decode=function(e,n){e instanceof y||(e=y.create(e)),n=void 0===n?e.len:e.pos+n;for(var r=new t.Pong;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.seq=e.uint64();break;case 2:r.ms=e.uint64();break;default:e.skipType(7&i)}}return r},e}(),uA=t.UserJoin=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,e.prototype.opt=q.Long?q.Long.fromBits(0,0,!0):0,e.prototype.instance=q.Long?q.Long.fromBits(0,0,!0):0,e.prototype.account="",e.prototype.ticket="",e.encode=function(e,t){return t||(t=J.create()),null!=e.seq&&Object.hasOwnProperty.call(e,"seq")&&t.uint32(8).uint64(e.seq),null!=e.opt&&Object.hasOwnProperty.call(e,"opt")&&t.uint32(16).uint64(e.opt),null!=e.instance&&Object.hasOwnProperty.call(e,"instance")&&t.uint32(24).uint64(e.instance),null!=e.account&&Object.hasOwnProperty.call(e,"account")&&t.uint32(34).string(e.account),null!=e.ticket&&Object.hasOwnProperty.call(e,"ticket")&&t.uint32(42).string(e.ticket),t},e.decode=function(e,n){e instanceof y||(e=y.create(e)),n=void 0===n?e.len:e.pos+n;for(var r=new t.UserJoin;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.seq=e.uint64();break;case 2:r.opt=e.uint64();break;case 3:r.instance=e.uint64();break;case 4:r.account=e.string();break;case 5:r.ticket=e.string();break;default:e.skipType(7&i)}}return r},e}(),vA=t.UserResp=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,e.prototype.account="",e.prototype.code=0,e.encode=function(e,t){return t||(t=J.create()),null!=e.seq&&Object.hasOwnProperty.call(e,"seq")&&t.uint32(8).uint64(e.seq),null!=e.account&&Object.hasOwnProperty.call(e,"account")&&t.uint32(18).string(e.account),null!=e.code&&Object.hasOwnProperty.call(e,"code")&&t.uint32(24).uint32(e.code),t},e.decode=function(e,n){e instanceof y||(e=y.create(e)),n=void 0===n?e.len:e.pos+n;for(var r=new t.UserResp;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.seq=e.uint64();break;case 2:r.account=e.string();break;case 3:r.code=e.uint32();break;default:e.skipType(7&i)}}return r},e}(),wA=t.UserQuit=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.encode=function(e,t){return t||(t=J.create()),t},e.decode=function(e,n){e instanceof y||(e=y.create(e)),n=void 0===n?e.len:e.pos+n;for(var r=new t.UserQuit;e.pos<n;){var i=e.uint32();e.skipType(7&i)}return r},e}(),xA=t.UserDrop=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.code=0,e.encode=function(e,t){return t||(t=J.create()),null!=e.code&&Object.hasOwnProperty.call(e,"code")&&t.uint32(8).uint32(e.code),t},e.decode=function(e,n){e instanceof y||(e=y.create(e)),n=void 0===n?e.len:e.pos+n;for(var r=new t.UserDrop;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.code=e.uint32();break;default:e.skipType(7&i)}}return r},e}(),yA=t.GroupEnter=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,e.prototype.account="",e.encode=function(e,t){return t||(t=J.create()),null!=e.seq&&Object.hasOwnProperty.call(e,"seq")&&t.uint32(8).uint64(e.seq),null!=e.account&&Object.hasOwnProperty.call(e,"account")&&t.uint32(18).string(e.account),t},e.decode=function(e,n){e instanceof y||(e=y.create(e)),n=void 0===n?e.len:e.pos+n;for(var r=new t.GroupEnter;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.seq=e.uint64();break;case 2:r.account=e.string();break;default:e.skipType(7&i)}}return r},e}(),zA=t.GroupLeave=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.account="",e.encode=function(e,t){return t||(t=J.create()),null!=e.account&&Object.hasOwnProperty.call(e,"account")&&t.uint32(10).string(e.account),t},e.decode=function(e,n){e instanceof y||(e=y.create(e)),n=void 0===n?e.len:e.pos+n;for(var r=new t.GroupLeave;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.account=e.string();break;default:e.skipType(7&i)}}return r},e}(),AA=t.GroupReply=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,e.prototype.account="",e.prototype.code=0,e.encode=function(e,t){return t||(t=J.create()),null!=e.seq&&Object.hasOwnProperty.call(e,"seq")&&t.uint32(8).uint64(e.seq),null!=e.account&&Object.hasOwnProperty.call(e,"account")&&t.uint32(18).string(e.account),null!=e.code&&Object.hasOwnProperty.call(e,"code")&&t.uint32(24).uint32(e.code),t},e.decode=function(e,n){e instanceof y||(e=y.create(e)),n=void 0===n?e.len:e.pos+n;for(var r=new t.GroupReply;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.seq=e.uint64();break;case 2:r.account=e.string();break;case 3:r.code=e.uint32();break;default:e.skipType(7&i)}}return r},e}(),Sq=t.GroupLeaveNotice=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,e.prototype.user="",e.prototype.group="",e.prototype.instance=q.Long?q.Long.fromBits(0,0,!0):0,e.prototype.size=0,e.encode=function(e,t){return t||(t=J.create()),null!=e.seq&&Object.hasOwnProperty.call(e,"seq")&&t.uint32(8).uint64(e.seq),null!=e.user&&Object.hasOwnProperty.call(e,"user")&&t.uint32(18).string(e.user),null!=e.group&&Object.hasOwnProperty.call(e,"group")&&t.uint32(26).string(e.group),null!=e.instance&&Object.hasOwnProperty.call(e,"instance")&&t.uint32(32).uint64(e.instance),null!=e.size&&Object.hasOwnProperty.call(e,"size")&&t.uint32(40).uint32(e.size),t},e.decode=function(e,n){e instanceof y||(e=y.create(e)),n=void 0===n?e.len:e.pos+n;for(var r=new t.GroupLeaveNotice;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.seq=e.uint64();break;case 2:r.user=e.string();break;case 3:r.group=e.string();break;case 4:r.instance=e.uint64();break;case 5:r.size=e.uint32();break;default:e.skipType(7&i)}}return r},e}(),Tq=t.GroupEnterNotice=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,e.prototype.user="",e.prototype.group="",e.prototype.instance=q.Long?q.Long.fromBits(0,0,!0):0,e.prototype.size=0,e.encode=function(e,t){return t||(t=J.create()),null!=e.seq&&Object.hasOwnProperty.call(e,"seq")&&t.uint32(8).uint64(e.seq),null!=e.user&&Object.hasOwnProperty.call(e,"user")&&t.uint32(18).string(e.user),null!=e.group&&Object.hasOwnProperty.call(e,"group")&&t.uint32(26).string(e.group),null!=e.instance&&Object.hasOwnProperty.call(e,"instance")&&t.uint32(32).uint64(e.instance),null!=e.size&&Object.hasOwnProperty.call(e,"size")&&t.uint32(40).uint32(e.size),t},e.decode=function(e,n){e instanceof y||(e=y.create(e)),n=void 0===n?e.len:e.pos+n;for(var r=new t.GroupEnterNotice;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.seq=e.uint64();break;case 2:r.user=e.string();break;case 3:r.group=e.string();break;case 4:r.instance=e.uint64();break;case 5:r.size=e.uint32();break;default:e.skipType(7&i)}}return r},e}(),Uq=t.Message=function(){function e(e){if(this.MiscMap={},e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.instance=q.Long?q.Long.fromBits(0,0,!0):0,e.prototype.dialogue=q.Long?q.Long.fromBits(0,0,!0):0,e.prototype.sequence=q.Long?q.Long.fromBits(0,0,!0):0,e.prototype.options=q.Long?q.Long.fromBits(0,0,!0):0,e.prototype.src="",e.prototype.dst="",e.prototype.payload=q.newBuffer([]),e.prototype.MiscMap=q.emptyObject,e.prototype.ms=q.Long?q.Long.fromBits(0,0,!0):0,e.encode=function(e,t){if(t||(t=J.create()),null!=e.instance&&Object.hasOwnProperty.call(e,"instance")&&t.uint32(8).uint64(e.instance),null!=e.dialogue&&Object.hasOwnProperty.call(e,"dialogue")&&t.uint32(16).uint64(e.dialogue),null!=e.sequence&&Object.hasOwnProperty.call(e,"sequence")&&t.uint32(24).uint64(e.sequence),null!=e.options&&Object.hasOwnProperty.call(e,"options")&&t.uint32(32).uint64(e.options),null!=e.src&&Object.hasOwnProperty.call(e,"src")&&t.uint32(42).string(e.src),null!=e.dst&&Object.hasOwnProperty.call(e,"dst")&&t.uint32(50).string(e.dst),null!=e.payload&&Object.hasOwnProperty.call(e,"payload")&&t.uint32(58).bytes(e.payload),null!=e.MiscMap&&Object.hasOwnProperty.call(e,"MiscMap"))for(var n=Object.keys(e.MiscMap),r=0;r<n.length;++r)t.uint32(66).fork().uint32(10).string(n[r]).uint32(18).bytes(e.MiscMap[n[r]]).ldelim();return null!=e.ms&&Object.hasOwnProperty.call(e,"ms")&&t.uint32(72).uint64(e.ms),t},e.decode=function(e,n){e instanceof y||(e=y.create(e)),n=void 0===n?e.len:e.pos+n;for(var r,i,o=new t.Message;e.pos<n;)switch(r=e.uint32(),r>>>3){case 1:o.instance=e.uint64();break;case 2:o.dialogue=e.uint64();break;case 3:o.sequence=e.uint64();break;case 4:o.options=e.uint64();break;case 5:o.src=e.string();break;case 6:o.dst=e.string();break;case 7:o.payload=e.bytes();break;case 8:o.MiscMap===q.emptyObject&&(o.MiscMap={});var a=e.uint32()+e.pos;for(r="",i=[];e.pos<a;){var s=e.uint32();switch(s>>>3){case 1:r=e.string();break;case 2:i=e.bytes();break;default:e.skipType(7&s)}}o.MiscMap[r]=i;break;case 9:o.ms=e.uint64();break;default:e.skipType(7&r)}return o},e}(),Vq=t.Ack=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.instance=q.Long?q.Long.fromBits(0,0,!0):0,e.prototype.dialogue=q.Long?q.Long.fromBits(0,0,!0):0,e.prototype.sequence=q.Long?q.Long.fromBits(0,0,!0):0,e.prototype.code=0,e.encode=function(e,t){return t||(t=J.create()),null!=e.instance&&Object.hasOwnProperty.call(e,"instance")&&t.uint32(8).uint64(e.instance),null!=e.dialogue&&Object.hasOwnProperty.call(e,"dialogue")&&t.uint32(16).uint64(e.dialogue),null!=e.sequence&&Object.hasOwnProperty.call(e,"sequence")&&t.uint32(24).uint64(e.sequence),null!=e.code&&Object.hasOwnProperty.call(e,"code")&&t.uint32(32).uint32(e.code),t},e.decode=function(e,n){e instanceof y||(e=y.create(e)),n=void 0===n?e.len:e.pos+n;for(var r=new t.Ack;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.instance=e.uint64();break;case 2:r.dialogue=e.uint64();break;case 3:r.sequence=e.uint64();break;case 4:r.code=e.uint32();break;default:e.skipType(7&i)}}return r},e}(),BA=t.FileUploadIndexGet=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,e.prototype.hash=q.newBuffer([]),e.prototype.size=0,e.encode=function(e,t){return t||(t=J.create()),null!=e.seq&&Object.hasOwnProperty.call(e,"seq")&&t.uint32(8).uint64(e.seq),null!=e.hash&&Object.hasOwnProperty.call(e,"hash")&&t.uint32(18).bytes(e.hash),null!=e.size&&Object.hasOwnProperty.call(e,"size")&&t.uint32(24).uint32(e.size),t},e.decode=function(e,n){e instanceof y||(e=y.create(e)),n=void 0===n?e.len:e.pos+n;for(var r=new t.FileUploadIndexGet;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.seq=e.uint64();break;case 2:r.hash=e.bytes();break;case 3:r.size=e.uint32();break;default:e.skipType(7&i)}}return r},e}(),CA=t.FileUploadIndexRet=function(){function e(e){if(this.servers=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,e.prototype.unit=0,e.prototype.servers=q.emptyArray,e.encode=function(e,t){if(t||(t=J.create()),null!=e.seq&&Object.hasOwnProperty.call(e,"seq")&&t.uint32(8).uint64(e.seq),null!=e.unit&&Object.hasOwnProperty.call(e,"unit")&&t.uint32(16).uint32(e.unit),null!=e.servers&&e.servers.length){t.uint32(26).fork();for(var n=0;n<e.servers.length;++n)t.uint32(e.servers[n]);t.ldelim()}return t},e.decode=function(e,n){e instanceof y||(e=y.create(e)),n=void 0===n?e.len:e.pos+n;for(var r=new t.FileUploadIndexRet;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.seq=e.uint64();break;case 2:r.unit=e.uint32();break;case 3:if(r.servers&&r.servers.length||(r.servers=[]),2==(7&i))for(i=e.uint32()+e.pos;e.pos<i;)r.servers.push(e.uint32());else r.servers.push(e.uint32());break;default:e.skipType(7&i)}}return r},e}(),DA=t.FileUploadIndexSet=function(){function e(e){if(this.servers=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,e.prototype.hash=q.newBuffer([]),e.prototype.unit=0,e.prototype.servers=q.emptyArray,e.encode=function(e,t){if(t||(t=J.create()),null!=e.seq&&Object.hasOwnProperty.call(e,"seq")&&t.uint32(8).uint64(e.seq),null!=e.hash&&Object.hasOwnProperty.call(e,"hash")&&t.uint32(18).bytes(e.hash),null!=e.unit&&Object.hasOwnProperty.call(e,"unit")&&t.uint32(24).uint32(e.unit),null!=e.servers&&e.servers.length){t.uint32(34).fork();for(var n=0;n<e.servers.length;++n)t.uint32(e.servers[n]);t.ldelim()}return t},e.decode=function(e,n){e instanceof y||(e=y.create(e)),n=void 0===n?e.len:e.pos+n;for(var r=new t.FileUploadIndexSet;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.seq=e.uint64();break;case 2:r.hash=e.bytes();break;case 3:r.unit=e.uint32();break;case 4:if(r.servers&&r.servers.length||(r.servers=[]),2==(7&i))for(i=e.uint32()+e.pos;e.pos<i;)r.servers.push(e.uint32());else r.servers.push(e.uint32());break;default:e.skipType(7&i)}}return r},e}(),EA=t.FileUploadIndexFin=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,e.prototype.zone=0,e.prototype.unit=0,e.encode=function(e,t){return t||(t=J.create()),null!=e.seq&&Object.hasOwnProperty.call(e,"seq")&&t.uint32(8).uint64(e.seq),null!=e.zone&&Object.hasOwnProperty.call(e,"zone")&&t.uint32(16).uint32(e.zone),null!=e.unit&&Object.hasOwnProperty.call(e,"unit")&&t.uint32(24).uint32(e.unit),t},e.decode=function(e,n){e instanceof y||(e=y.create(e)),n=void 0===n?e.len:e.pos+n;for(var r=new t.FileUploadIndexFin;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.seq=e.uint64();break;case 2:r.zone=e.uint32();break;case 3:r.unit=e.uint32();break;default:e.skipType(7&i)}}return r},e}(),FA=t.FileUploadIndexErr=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,e.prototype.code=0,e.encode=function(e,t){return t||(t=J.create()),null!=e.seq&&Object.hasOwnProperty.call(e,"seq")&&t.uint32(8).uint64(e.seq),null!=e.code&&Object.hasOwnProperty.call(e,"code")&&t.uint32(16).uint32(e.code),t},e.decode=function(e,n){e instanceof y||(e=y.create(e)),n=void 0===n?e.len:e.pos+n;for(var r=new t.FileUploadIndexErr;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.seq=e.uint64();break;case 2:r.code=e.uint32();break;default:e.skipType(7&i)}}return r},e}(),GA=t.FileDownloadIndexGet=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,e.prototype.zone=0,e.prototype.hash=q.newBuffer([]),e.prototype.size=0,e.prototype.unit=0,e.encode=function(e,t){return t||(t=J.create()),null!=e.seq&&Object.hasOwnProperty.call(e,"seq")&&t.uint32(8).uint64(e.seq),null!=e.zone&&Object.hasOwnProperty.call(e,"zone")&&t.uint32(16).uint32(e.zone),null!=e.hash&&Object.hasOwnProperty.call(e,"hash")&&t.uint32(26).bytes(e.hash),null!=e.size&&Object.hasOwnProperty.call(e,"size")&&t.uint32(32).uint32(e.size),null!=e.unit&&Object.hasOwnProperty.call(e,"unit")&&t.uint32(40).uint32(e.unit),t},e.decode=function(e,n){e instanceof y||(e=y.create(e)),n=void 0===n?e.len:e.pos+n;for(var r=new t.FileDownloadIndexGet;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.seq=e.uint64();break;case 2:r.zone=e.uint32();break;case 3:r.hash=e.bytes();break;case 4:r.size=e.uint32();break;case 5:r.unit=e.uint32();break;default:e.skipType(7&i)}}return r},e}(),HA=t.FileDownloadIndexRet=function(){function e(e){if(this.servers=[],this.backups=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,e.prototype.unit=0,e.prototype.zone=0,e.prototype.servers=q.emptyArray,e.prototype.backups=q.emptyArray,e.encode=function(e,t){if(t||(t=J.create()),null!=e.seq&&Object.hasOwnProperty.call(e,"seq")&&t.uint32(8).uint64(e.seq),null!=e.unit&&Object.hasOwnProperty.call(e,"unit")&&t.uint32(16).uint32(e.unit),null!=e.zone&&Object.hasOwnProperty.call(e,"zone")&&t.uint32(24).uint32(e.zone),null!=e.servers&&e.servers.length){t.uint32(34).fork();for(var n=0;n<e.servers.length;++n)t.uint32(e.servers[n]);t.ldelim()}if(null!=e.backups&&e.backups.length){for(t.uint32(42).fork(),n=0;n<e.backups.length;++n)t.uint32(e.backups[n]);t.ldelim()}return t},e.decode=function(e,n){e instanceof y||(e=y.create(e)),n=void 0===n?e.len:e.pos+n;for(var r=new t.FileDownloadIndexRet;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.seq=e.uint64();break;case 2:r.unit=e.uint32();break;case 3:r.zone=e.uint32();break;case 4:if(r.servers&&r.servers.length||(r.servers=[]),2==(7&i))for(i=e.uint32()+e.pos;e.pos<i;)r.servers.push(e.uint32());else r.servers.push(e.uint32());break;case 5:if(r.backups&&r.backups.length||(r.backups=[]),2==(7&i))for(i=e.uint32()+e.pos;e.pos<i;)r.backups.push(e.uint32());else r.backups.push(e.uint32());break;default:e.skipType(7&i)}}return r},e}(),IA=t.FileDownloadIndexErr=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,e.prototype.code=0,e.encode=function(e,t){return t||(t=J.create()),null!=e.seq&&Object.hasOwnProperty.call(e,"seq")&&t.uint32(8).uint64(e.seq),null!=e.code&&Object.hasOwnProperty.call(e,"code")&&t.uint32(16).uint32(e.code),t},e.decode=function(e,n){e instanceof y||(e=y.create(e)),n=void 0===n?e.len:e.pos+n;for(var r=new t.FileDownloadIndexErr;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.seq=e.uint64();break;case 2:r.code=e.uint32();break;default:e.skipType(7&i)}}return r},e}(),JA=t.GroupAllUsersList=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,e.prototype.group="",e.prototype.pageSize=0,e.prototype.pageNumber=0,e.encode=function(e,t){return t||(t=J.create()),null!=e.seq&&Object.hasOwnProperty.call(e,"seq")&&t.uint32(8).uint64(e.seq),null!=e.group&&Object.hasOwnProperty.call(e,"group")&&t.uint32(18).string(e.group),null!=e.pageSize&&Object.hasOwnProperty.call(e,"pageSize")&&t.uint32(24).uint32(e.pageSize),null!=e.pageNumber&&Object.hasOwnProperty.call(e,"pageNumber")&&t.uint32(32).uint32(e.pageNumber),t},e.decode=function(e,n){e instanceof y||(e=y.create(e)),n=void 0===n?e.len:e.pos+n;for(var r=new t.GroupAllUsersList;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.seq=e.uint64();break;case 2:r.group=e.string();break;case 3:r.pageSize=e.uint32();break;case 4:r.pageNumber=e.uint32();break;default:e.skipType(7&i)}}return r},e}(),KA=t.GroupAllUsersResult=function(){function e(e){if(this.memberInfos=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,e.prototype.group="",e.prototype.totalSize=0,e.prototype.pageSize=0,e.prototype.pageNumber=0,e.prototype.memberInfos=q.emptyArray,e.encode=function(e,n){if(n||(n=J.create()),null!=e.seq&&Object.hasOwnProperty.call(e,"seq")&&n.uint32(8).uint64(e.seq),null!=e.group&&Object.hasOwnProperty.call(e,"group")&&n.uint32(18).string(e.group),null!=e.totalSize&&Object.hasOwnProperty.call(e,"totalSize")&&n.uint32(24).uint32(e.totalSize),null!=e.pageSize&&Object.hasOwnProperty.call(e,"pageSize")&&n.uint32(32).uint32(e.pageSize),null!=e.pageNumber&&Object.hasOwnProperty.call(e,"pageNumber")&&n.uint32(40).uint32(e.pageNumber),null!=e.memberInfos&&e.memberInfos.length)for(var r=0;r<e.memberInfos.length;++r)t.GroupAllUsersResult.MemberInfo.encode(e.memberInfos[r],n.uint32(50).fork()).ldelim();return n},e.decode=function(e,n){e instanceof y||(e=y.create(e)),n=void 0===n?e.len:e.pos+n;for(var r=new t.GroupAllUsersResult;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.seq=e.uint64();break;case 2:r.group=e.string();break;case 3:r.totalSize=e.uint32();break;case 4:r.pageSize=e.uint32();break;case 5:r.pageNumber=e.uint32();break;case 6:r.memberInfos&&r.memberInfos.length||(r.memberInfos=[]),r.memberInfos.push(t.GroupAllUsersResult.MemberInfo.decode(e,e.uint32()));break;default:e.skipType(7&i)}}return r},e.MemberInfo=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.account="",e.prototype.ts=0,e.encode=function(e,t){return t||(t=J.create()),null!=e.account&&Object.hasOwnProperty.call(e,"account")&&t.uint32(10).string(e.account),null!=e.ts&&Object.hasOwnProperty.call(e,"ts")&&t.uint32(16).uint32(e.ts),t},e.decode=function(e,n){e instanceof y||(e=y.create(e)),n=void 0===n?e.len:e.pos+n;for(var r=new t.GroupAllUsersResult.MemberInfo;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.account=e.string();break;case 2:r.ts=e.uint32();break;default:e.skipType(7&i)}}return r},e}(),e}(),LA=t.UserStatusList=function(){function e(e){if(this.users=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,e.prototype.users=q.emptyArray,e.encode=function(e,t){if(t||(t=J.create()),null!=e.seq&&Object.hasOwnProperty.call(e,"seq")&&t.uint32(8).uint64(e.seq),null!=e.users&&e.users.length)for(var n=0;n<e.users.length;++n)t.uint32(18).string(e.users[n]);return t},e.decode=function(e,n){e instanceof y||(e=y.create(e)),n=void 0===n?e.len:e.pos+n;for(var r=new t.UserStatusList;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.seq=e.uint64();break;case 2:r.users&&r.users.length||(r.users=[]),r.users.push(e.string());break;default:e.skipType(7&i)}}return r},e}(),MA=t.UserStatusResult=function(){function e(e){if(this.userInfos=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,e.prototype.userInfos=q.emptyArray,e.encode=function(e,n){if(n||(n=J.create()),null!=e.seq&&Object.hasOwnProperty.call(e,"seq")&&n.uint32(8).uint64(e.seq),null!=e.userInfos&&e.userInfos.length)for(var r=0;r<e.userInfos.length;++r)t.UserStatusResult.UserStatusInfo.encode(e.userInfos[r],n.uint32(18).fork()).ldelim();return n},e.decode=function(e,n){e instanceof y||(e=y.create(e)),n=void 0===n?e.len:e.pos+n;for(var r=new t.UserStatusResult;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.seq=e.uint64();break;case 2:r.userInfos&&r.userInfos.length||(r.userInfos=[]),r.userInfos.push(t.UserStatusResult.UserStatusInfo.decode(e,e.uint32()));break;default:e.skipType(7&i)}}return r},e.UserStatusInfo=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.account="",e.prototype.ts=0,e.encode=function(e,t){return t||(t=J.create()),null!=e.account&&Object.hasOwnProperty.call(e,"account")&&t.uint32(10).string(e.account),null!=e.ts&&Object.hasOwnProperty.call(e,"ts")&&t.uint32(16).uint32(e.ts),t},e.decode=function(e,n){e instanceof y||(e=y.create(e)),n=void 0===n?e.len:e.pos+n;for(var r=new t.UserStatusResult.UserStatusInfo;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.account=e.string();break;case 2:r.ts=e.uint32();break;default:e.skipType(7&i)}}return r},e}(),e}(),NA=t.UserAttributeGet=function(){function e(e){if(this.attributes=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,e.prototype.account="",e.prototype.attributes=q.emptyArray,e.encode=function(e,t){if(t||(t=J.create()),null!=e.seq&&Object.hasOwnProperty.call(e,"seq")&&t.uint32(8).uint64(e.seq),null!=e.account&&Object.hasOwnProperty.call(e,"account")&&t.uint32(18).string(e.account),null!=e.attributes&&e.attributes.length)for(var n=0;n<e.attributes.length;++n)t.uint32(26).string(e.attributes[n]);return t},e.decode=function(e,n){e instanceof y||(e=y.create(e)),n=void 0===n?e.len:e.pos+n;for(var r=new t.UserAttributeGet;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.seq=e.uint64();break;case 2:r.account=e.string();break;case 3:r.attributes&&r.attributes.length||(r.attributes=[]),r.attributes.push(e.string());break;default:e.skipType(7&i)}}return r},e}(),OA=t.UserAttributeRet=function(){function e(e){if(this.attributeInfos=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,e.prototype.attributeInfos=q.emptyArray,e.encode=function(e,n){if(n||(n=J.create()),null!=e.seq&&Object.hasOwnProperty.call(e,"seq")&&n.uint32(8).uint64(e.seq),null!=e.attributeInfos&&e.attributeInfos.length)for(var r=0;r<e.attributeInfos.length;++r)t.UserAttributeRet.AttributeInfo.encode(e.attributeInfos[r],n.uint32(18).fork()).ldelim();return n},e.decode=function(e,n){e instanceof y||(e=y.create(e)),n=void 0===n?e.len:e.pos+n;for(var r=new t.UserAttributeRet;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.seq=e.uint64();break;case 2:r.attributeInfos&&r.attributeInfos.length||(r.attributeInfos=[]),r.attributeInfos.push(t.UserAttributeRet.AttributeInfo.decode(e,e.uint32()));break;default:e.skipType(7&i)}}return r},e.AttributeInfo=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.key="",e.prototype.value="",e.encode=function(e,t){return t||(t=J.create()),null!=e.key&&Object.hasOwnProperty.call(e,"key")&&t.uint32(10).string(e.key),null!=e.value&&Object.hasOwnProperty.call(e,"value")&&t.uint32(18).string(e.value),t},e.decode=function(e,n){e instanceof y||(e=y.create(e)),n=void 0===n?e.len:e.pos+n;for(var r=new t.UserAttributeRet.AttributeInfo;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.key=e.string();break;case 2:r.value=e.string();break;default:e.skipType(7&i)}}return r},e}(),e}(),PA=t.UserAttributeSet=function(){function e(e){if(this.attributeInfos=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,e.prototype.account="",e.prototype.attributeInfos=q.emptyArray,e.encode=function(e,n){if(n||(n=J.create()),null!=e.seq&&Object.hasOwnProperty.call(e,"seq")&&n.uint32(8).uint64(e.seq),null!=e.account&&Object.hasOwnProperty.call(e,"account")&&n.uint32(18).string(e.account),null!=e.attributeInfos&&e.attributeInfos.length)for(var r=0;r<e.attributeInfos.length;++r)t.UserAttributeSet.AttributeInfo.encode(e.attributeInfos[r],n.uint32(26).fork()).ldelim();return n},e.decode=function(e,n){e instanceof y||(e=y.create(e)),n=void 0===n?e.len:e.pos+n;for(var r=new t.UserAttributeSet;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.seq=e.uint64();break;case 2:r.account=e.string();break;case 3:r.attributeInfos&&r.attributeInfos.length||(r.attributeInfos=[]),r.attributeInfos.push(t.UserAttributeSet.AttributeInfo.decode(e,e.uint32()));break;default:e.skipType(7&i)}}return r},e.AttributeInfo=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.key="",e.prototype.value="",e.encode=function(e,t){return t||(t=J.create()),null!=e.key&&Object.hasOwnProperty.call(e,"key")&&t.uint32(10).string(e.key),null!=e.value&&Object.hasOwnProperty.call(e,"value")&&t.uint32(18).string(e.value),t},e.decode=function(e,n){e instanceof y||(e=y.create(e)),n=void 0===n?e.len:e.pos+n;for(var r=new t.UserAttributeSet.AttributeInfo;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.key=e.string();break;case 2:r.value=e.string();break;default:e.skipType(7&i)}}return r},e}(),e}(),QA=t.UserAttributeMod=function(){function e(e){if(this.attributeInfos=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,e.prototype.account="",e.prototype.attributeInfos=q.emptyArray,e.encode=function(e,n){if(n||(n=J.create()),null!=e.seq&&Object.hasOwnProperty.call(e,"seq")&&n.uint32(8).uint64(e.seq),null!=e.account&&Object.hasOwnProperty.call(e,"account")&&n.uint32(18).string(e.account),null!=e.attributeInfos&&e.attributeInfos.length)for(var r=0;r<e.attributeInfos.length;++r)t.UserAttributeMod.AttributeInfo.encode(e.attributeInfos[r],n.uint32(26).fork()).ldelim();return n},e.decode=function(e,n){e instanceof y||(e=y.create(e)),n=void 0===n?e.len:e.pos+n;for(var r=new t.UserAttributeMod;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.seq=e.uint64();break;case 2:r.account=e.string();break;case 3:r.attributeInfos&&r.attributeInfos.length||(r.attributeInfos=[]),r.attributeInfos.push(t.UserAttributeMod.AttributeInfo.decode(e,e.uint32()));break;default:e.skipType(7&i)}}return r},e.AttributeInfo=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.key="",e.prototype.value="",e.encode=function(e,t){return t||(t=J.create()),null!=e.key&&Object.hasOwnProperty.call(e,"key")&&t.uint32(10).string(e.key),null!=e.value&&Object.hasOwnProperty.call(e,"value")&&t.uint32(18).string(e.value),t},e.decode=function(e,n){e instanceof y||(e=y.create(e)),n=void 0===n?e.len:e.pos+n;for(var r=new t.UserAttributeMod.AttributeInfo;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.key=e.string();break;case 2:r.value=e.string();break;default:e.skipType(7&i)}}return r},e}(),e}(),RA=t.UserAttributeDel=function(){function e(e){if(this.attributes=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,e.prototype.account="",e.prototype.attributes=q.emptyArray,e.encode=function(e,t){if(t||(t=J.create()),null!=e.seq&&Object.hasOwnProperty.call(e,"seq")&&t.uint32(8).uint64(e.seq),null!=e.account&&Object.hasOwnProperty.call(e,"account")&&t.uint32(18).string(e.account),null!=e.attributes&&e.attributes.length)for(var n=0;n<e.attributes.length;++n)t.uint32(26).string(e.attributes[n]);return t},e.decode=function(e,n){e instanceof y||(e=y.create(e)),n=void 0===n?e.len:e.pos+n;for(var r=new t.UserAttributeDel;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.seq=e.uint64();break;case 2:r.account=e.string();break;case 3:r.attributes&&r.attributes.length||(r.attributes=[]),r.attributes.push(e.string());break;default:e.skipType(7&i)}}return r},e}(),SA=t.UserAttributeErr=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,e.prototype.code=0,e.encode=function(e,t){return t||(t=J.create()),null!=e.seq&&Object.hasOwnProperty.call(e,"seq")&&t.uint32(8).uint64(e.seq),null!=e.code&&Object.hasOwnProperty.call(e,"code")&&t.uint32(16).uint32(e.code),t},e.decode=function(e,n){e instanceof y||(e=y.create(e)),n=void 0===n?e.len:e.pos+n;for(var r=new t.UserAttributeErr;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.seq=e.uint64();break;case 2:r.code=e.uint32();break;default:e.skipType(7&i)}}return r},e}(),TA=t.UserAttributeKeysGet=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,e.prototype.account="",e.encode=function(e,t){return t||(t=J.create()),null!=e.seq&&Object.hasOwnProperty.call(e,"seq")&&t.uint32(8).uint64(e.seq),null!=e.account&&Object.hasOwnProperty.call(e,"account")&&t.uint32(18).string(e.account),t},e.decode=function(e,n){e instanceof y||(e=y.create(e)),n=void 0===n?e.len:e.pos+n;for(var r=new t.UserAttributeKeysGet;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.seq=e.uint64();break;case 2:r.account=e.string();break;default:e.skipType(7&i)}}return r},e}(),UA=t.UserAttributeKeysRet=function(){function e(e){if(this.keys=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,e.prototype.keys=q.emptyArray,e.encode=function(e,t){if(t||(t=J.create()),null!=e.seq&&Object.hasOwnProperty.call(e,"seq")&&t.uint32(8).uint64(e.seq),null!=e.keys&&e.keys.length)for(var n=0;n<e.keys.length;++n)t.uint32(18).string(e.keys[n]);return t},e.decode=function(e,n){e instanceof y||(e=y.create(e)),n=void 0===n?e.len:e.pos+n;for(var r=new t.UserAttributeKeysRet;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.seq=e.uint64();break;case 2:r.keys&&r.keys.length||(r.keys=[]),r.keys.push(e.string());break;default:e.skipType(7&i)}}return r},e}(),VA=t.UserAttributeRsp=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,e.encode=function(e,t){return t||(t=J.create()),null!=e.seq&&Object.hasOwnProperty.call(e,"seq")&&t.uint32(8).uint64(e.seq),t},e.decode=function(e,n){e instanceof y||(e=y.create(e)),n=void 0===n?e.len:e.pos+n;for(var r=new t.UserAttributeRsp;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.seq=e.uint64();break;default:e.skipType(7&i)}}return r},e}(),WA=t.GroupStatusList=function(){function e(e){if(this.groups=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,e.prototype.groups=q.emptyArray,e.encode=function(e,t){if(t||(t=J.create()),null!=e.seq&&Object.hasOwnProperty.call(e,"seq")&&t.uint32(8).uint64(e.seq),null!=e.groups&&e.groups.length)for(var n=0;n<e.groups.length;++n)t.uint32(18).string(e.groups[n]);return t},e.decode=function(e,n){e instanceof y||(e=y.create(e)),n=void 0===n?e.len:e.pos+n;for(var r=new t.GroupStatusList;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.seq=e.uint64();break;case 2:r.groups&&r.groups.length||(r.groups=[]),r.groups.push(e.string());break;default:e.skipType(7&i)}}return r},e}(),XA=t.GroupStatusResult=function(){function e(e){if(this.groupInfos=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,e.prototype.groupInfos=q.emptyArray,e.encode=function(e,n){if(n||(n=J.create()),null!=e.seq&&Object.hasOwnProperty.call(e,"seq")&&n.uint32(8).uint64(e.seq),null!=e.groupInfos&&e.groupInfos.length)for(var r=0;r<e.groupInfos.length;++r)t.GroupStatusResult.GroupInfo.encode(e.groupInfos[r],n.uint32(18).fork()).ldelim();return n},e.decode=function(e,n){e instanceof y||(e=y.create(e)),n=void 0===n?e.len:e.pos+n;for(var r=new t.GroupStatusResult;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.seq=e.uint64();break;case 2:r.groupInfos&&r.groupInfos.length||(r.groupInfos=[]),r.groupInfos.push(t.GroupStatusResult.GroupInfo.decode(e,e.uint32()));break;default:e.skipType(7&i)}}return r},e.GroupInfo=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.group="",e.prototype.memberCount=0,e.encode=function(e,t){return t||(t=J.create()),null!=e.group&&Object.hasOwnProperty.call(e,"group")&&t.uint32(10).string(e.group),null!=e.memberCount&&Object.hasOwnProperty.call(e,"memberCount")&&t.uint32(16).uint32(e.memberCount),t},e.decode=function(e,n){e instanceof y||(e=y.create(e)),n=void 0===n?e.len:e.pos+n;for(var r=new t.GroupStatusResult.GroupInfo;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.group=e.string();break;case 2:r.memberCount=e.uint32();break;default:e.skipType(7&i)}}return r},e}(),e}(),YA=t.GroupCountNotice=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.instance=q.Long?q.Long.fromBits(0,0,!0):0,e.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,e.prototype.group="",e.prototype.size=0,e.encode=function(e,t){return t||(t=J.create()),null!=e.instance&&Object.hasOwnProperty.call(e,"instance")&&t.uint32(8).uint64(e.instance),null!=e.seq&&Object.hasOwnProperty.call(e,"seq")&&t.uint32(16).uint64(e.seq),null!=e.group&&Object.hasOwnProperty.call(e,"group")&&t.uint32(26).string(e.group),null!=e.size&&Object.hasOwnProperty.call(e,"size")&&t.uint32(32).uint32(e.size),t},e.decode=function(e,n){e instanceof y||(e=y.create(e)),n=void 0===n?e.len:e.pos+n;for(var r=new t.GroupCountNotice;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.instance=e.uint64();break;case 2:r.seq=e.uint64();break;case 3:r.group=e.string();break;case 4:r.size=e.uint32();break;default:e.skipType(7&i)}}return r},e}(),ZA=t.GroupAttributeGet=function(){function e(e){if(this.attributes=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,e.prototype.group="",e.prototype.attributes=q.emptyArray,e.encode=function(e,t){if(t||(t=J.create()),null!=e.seq&&Object.hasOwnProperty.call(e,"seq")&&t.uint32(8).uint64(e.seq),null!=e.group&&Object.hasOwnProperty.call(e,"group")&&t.uint32(18).string(e.group),null!=e.attributes&&e.attributes.length)for(var n=0;n<e.attributes.length;++n)t.uint32(26).string(e.attributes[n]);return t},e.decode=function(e,n){e instanceof y||(e=y.create(e)),n=void 0===n?e.len:e.pos+n;for(var r=new t.GroupAttributeGet;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.seq=e.uint64();break;case 2:r.group=e.string();break;case 3:r.attributes&&r.attributes.length||(r.attributes=[]),r.attributes.push(e.string());break;default:e.skipType(7&i)}}return r},e}(),$A=t.GroupAttributeRet=function(){function e(e){if(this.attributeMaps=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,e.prototype.attributeMaps=q.emptyArray,e.encode=function(e,n){if(n||(n=J.create()),null!=e.seq&&Object.hasOwnProperty.call(e,"seq")&&n.uint32(8).uint64(e.seq),null!=e.attributeMaps&&e.attributeMaps.length)for(var r=0;r<e.attributeMaps.length;++r)t.GroupAttributeRet.AttributeMap.encode(e.attributeMaps[r],n.uint32(18).fork()).ldelim();return n},e.decode=function(e,n){e instanceof y||(e=y.create(e)),n=void 0===n?e.len:e.pos+n;for(var r=new t.GroupAttributeRet;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.seq=e.uint64();break;case 2:r.attributeMaps&&r.attributeMaps.length||(r.attributeMaps=[]),r.attributeMaps.push(t.GroupAttributeRet.AttributeMap.decode(e,e.uint32()));break;default:e.skipType(7&i)}}return r},e.AttributeMap=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.key="",e.prototype.value="",e.prototype.origin="",e.prototype.ms=q.Long?q.Long.fromBits(0,0,!0):0,e.encode=function(e,t){return t||(t=J.create()),null!=e.key&&Object.hasOwnProperty.call(e,"key")&&t.uint32(10).string(e.key),null!=e.value&&Object.hasOwnProperty.call(e,"value")&&t.uint32(18).string(e.value),null!=e.origin&&Object.hasOwnProperty.call(e,"origin")&&t.uint32(26).string(e.origin),null!=e.ms&&Object.hasOwnProperty.call(e,"ms")&&t.uint32(32).uint64(e.ms),t},e.decode=function(e,n){e instanceof y||(e=y.create(e)),n=void 0===n?e.len:e.pos+n;for(var r=new t.GroupAttributeRet.AttributeMap;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.key=e.string();break;case 2:r.value=e.string();break;case 3:r.origin=e.string();break;case 4:r.ms=e.uint64();break;default:e.skipType(7&i)}}return r},e}(),e}(),aB=t.GroupAttributeSet=function(){function e(e){if(this.attributeInfos=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,e.prototype.group="",e.prototype.broadcast=!1,e.prototype.attributeInfos=q.emptyArray,e.encode=function(e,n){if(n||(n=J.create()),null!=e.seq&&Object.hasOwnProperty.call(e,"seq")&&n.uint32(8).uint64(e.seq),null!=e.group&&Object.hasOwnProperty.call(e,"group")&&n.uint32(18).string(e.group),null!=e.broadcast&&Object.hasOwnProperty.call(e,"broadcast")&&n.uint32(24).bool(e.broadcast),null!=e.attributeInfos&&e.attributeInfos.length)for(var r=0;r<e.attributeInfos.length;++r)t.GroupAttributeSet.AttributeInfo.encode(e.attributeInfos[r],n.uint32(34).fork()).ldelim();return n},e.decode=function(e,n){e instanceof y||(e=y.create(e)),n=void 0===n?e.len:e.pos+n;for(var r=new t.GroupAttributeSet;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.seq=e.uint64();break;case 2:r.group=e.string();break;case 3:r.broadcast=e.bool();break;case 4:r.attributeInfos&&r.attributeInfos.length||(r.attributeInfos=[]),r.attributeInfos.push(t.GroupAttributeSet.AttributeInfo.decode(e,e.uint32()));break;default:e.skipType(7&i)}}return r},e.AttributeInfo=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.key="",e.prototype.value="",e.encode=function(e,t){return t||(t=J.create()),null!=e.key&&Object.hasOwnProperty.call(e,"key")&&t.uint32(10).string(e.key),null!=e.value&&Object.hasOwnProperty.call(e,"value")&&t.uint32(18).string(e.value),t},e.decode=function(e,n){e instanceof y||(e=y.create(e)),n=void 0===n?e.len:e.pos+n;for(var r=new t.GroupAttributeSet.AttributeInfo;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.key=e.string();break;case 2:r.value=e.string();break;default:e.skipType(7&i)}}return r},e}(),e}(),bB=t.GroupAttributeMod=function(){function e(e){if(this.attributeInfos=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,e.prototype.group="",e.prototype.broadcast=!1,e.prototype.attributeInfos=q.emptyArray,e.encode=function(e,n){if(n||(n=J.create()),null!=e.seq&&Object.hasOwnProperty.call(e,"seq")&&n.uint32(8).uint64(e.seq),null!=e.group&&Object.hasOwnProperty.call(e,"group")&&n.uint32(18).string(e.group),null!=e.broadcast&&Object.hasOwnProperty.call(e,"broadcast")&&n.uint32(24).bool(e.broadcast),null!=e.attributeInfos&&e.attributeInfos.length)for(var r=0;r<e.attributeInfos.length;++r)t.GroupAttributeMod.AttributeInfo.encode(e.attributeInfos[r],n.uint32(34).fork()).ldelim();return n},e.decode=function(e,n){e instanceof y||(e=y.create(e)),n=void 0===n?e.len:e.pos+n;for(var r=new t.GroupAttributeMod;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.seq=e.uint64();break;case 2:r.group=e.string();break;case 3:r.broadcast=e.bool();break;case 4:r.attributeInfos&&r.attributeInfos.length||(r.attributeInfos=[]),r.attributeInfos.push(t.GroupAttributeMod.AttributeInfo.decode(e,e.uint32()));break;default:e.skipType(7&i)}}return r},e.AttributeInfo=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.key="",e.prototype.value="",e.encode=function(e,t){return t||(t=J.create()),null!=e.key&&Object.hasOwnProperty.call(e,"key")&&t.uint32(10).string(e.key),null!=e.value&&Object.hasOwnProperty.call(e,"value")&&t.uint32(18).string(e.value),t},e.decode=function(e,n){e instanceof y||(e=y.create(e)),n=void 0===n?e.len:e.pos+n;for(var r=new t.GroupAttributeMod.AttributeInfo;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.key=e.string();break;case 2:r.value=e.string();break;default:e.skipType(7&i)}}return r},e}(),e}(),cB=t.GroupAttributeDel=function(){function e(e){if(this.attributes=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,e.prototype.group="",e.prototype.broadcast=!1,e.prototype.attributes=q.emptyArray,e.encode=function(e,t){if(t||(t=J.create()),null!=e.seq&&Object.hasOwnProperty.call(e,"seq")&&t.uint32(8).uint64(e.seq),null!=e.group&&Object.hasOwnProperty.call(e,"group")&&t.uint32(18).string(e.group),null!=e.broadcast&&Object.hasOwnProperty.call(e,"broadcast")&&t.uint32(24).bool(e.broadcast),null!=e.attributes&&e.attributes.length)for(var n=0;n<e.attributes.length;++n)t.uint32(34).string(e.attributes[n]);return t},e.decode=function(e,n){e instanceof y||(e=y.create(e)),n=void 0===n?e.len:e.pos+n;for(var r=new t.GroupAttributeDel;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.seq=e.uint64();break;case 2:r.group=e.string();break;case 3:r.broadcast=e.bool();break;case 4:r.attributes&&r.attributes.length||(r.attributes=[]),r.attributes.push(e.string());break;default:e.skipType(7&i)}}return r},e}(),dB=t.GroupAttributeAlt=function(){function e(e){if(this.attributeMaps=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,e.prototype.group="",e.prototype.instance=q.Long?q.Long.fromBits(0,0,!0):0,e.prototype.attributeMaps=q.emptyArray,e.encode=function(e,n){if(n||(n=J.create()),null!=e.seq&&Object.hasOwnProperty.call(e,"seq")&&n.uint32(8).uint64(e.seq),null!=e.group&&Object.hasOwnProperty.call(e,"group")&&n.uint32(18).string(e.group),null!=e.instance&&Object.hasOwnProperty.call(e,"instance")&&n.uint32(24).uint64(e.instance),null!=e.attributeMaps&&e.attributeMaps.length)for(var r=0;r<e.attributeMaps.length;++r)t.GroupAttributeAlt.AttributeMap.encode(e.attributeMaps[r],n.uint32(34).fork()).ldelim();return n},e.decode=function(e,n){e instanceof y||(e=y.create(e)),n=void 0===n?e.len:e.pos+n;for(var r=new t.GroupAttributeAlt;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.seq=e.uint64();break;case 2:r.group=e.string();break;case 3:r.instance=e.uint64();break;case 4:r.attributeMaps&&r.attributeMaps.length||(r.attributeMaps=[]),r.attributeMaps.push(t.GroupAttributeAlt.AttributeMap.decode(e,e.uint32()));break;default:e.skipType(7&i)}}return r},e.AttributeMap=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.key="",e.prototype.value="",e.prototype.origin="",e.prototype.ms=q.Long?q.Long.fromBits(0,0,!0):0,e.encode=function(e,t){return t||(t=J.create()),null!=e.key&&Object.hasOwnProperty.call(e,"key")&&t.uint32(10).string(e.key),null!=e.value&&Object.hasOwnProperty.call(e,"value")&&t.uint32(18).string(e.value),null!=e.origin&&Object.hasOwnProperty.call(e,"origin")&&t.uint32(26).string(e.origin),null!=e.ms&&Object.hasOwnProperty.call(e,"ms")&&t.uint32(32).uint64(e.ms),t},e.decode=function(e,n){e instanceof y||(e=y.create(e)),n=void 0===n?e.len:e.pos+n;for(var r=new t.GroupAttributeAlt.AttributeMap;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.key=e.string();break;case 2:r.value=e.string();break;case 3:r.origin=e.string();break;case 4:r.ms=e.uint64();break;default:e.skipType(7&i)}}return r},e}(),e}(),eB=t.GroupAttributeRsp=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,e.encode=function(e,t){return t||(t=J.create()),null!=e.seq&&Object.hasOwnProperty.call(e,"seq")&&t.uint32(8).uint64(e.seq),t},e.decode=function(e,n){e instanceof y||(e=y.create(e)),n=void 0===n?e.len:e.pos+n;for(var r=new t.GroupAttributeRsp;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.seq=e.uint64();break;default:e.skipType(7&i)}}return r},e}(),fB=t.GroupAttributeErr=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,e.prototype.code=0,e.encode=function(e,t){return t||(t=J.create()),null!=e.seq&&Object.hasOwnProperty.call(e,"seq")&&t.uint32(8).uint64(e.seq),null!=e.code&&Object.hasOwnProperty.call(e,"code")&&t.uint32(16).uint32(e.code),t},e.decode=function(e,n){e instanceof y||(e=y.create(e)),n=void 0===n?e.len:e.pos+n;for(var r=new t.GroupAttributeErr;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.seq=e.uint64();break;case 2:r.code=e.uint32();break;default:e.skipType(7&i)}}return r},e}(),gB=t.GroupAttributeKeysGet=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,e.prototype.group="",e.encode=function(e,t){return t||(t=J.create()),null!=e.seq&&Object.hasOwnProperty.call(e,"seq")&&t.uint32(8).uint64(e.seq),null!=e.group&&Object.hasOwnProperty.call(e,"group")&&t.uint32(18).string(e.group),t},e.decode=function(e,n){e instanceof y||(e=y.create(e)),n=void 0===n?e.len:e.pos+n;for(var r=new t.GroupAttributeKeysGet;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.seq=e.uint64();break;case 2:r.group=e.string();break;default:e.skipType(7&i)}}return r},e}(),hB=t.GroupAttributeKeysRet=function(){function e(e){if(this.keys=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,e.prototype.keys=q.emptyArray,e.encode=function(e,t){if(t||(t=J.create()),null!=e.seq&&Object.hasOwnProperty.call(e,"seq")&&t.uint32(8).uint64(e.seq),null!=e.keys&&e.keys.length)for(var n=0;n<e.keys.length;++n)t.uint32(18).string(e.keys[n]);return t},e.decode=function(e,n){e instanceof y||(e=y.create(e)),n=void 0===n?e.len:e.pos+n;for(var r=new t.GroupAttributeKeysRet;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.seq=e.uint64();break;case 2:r.keys&&r.keys.length||(r.keys=[]),r.keys.push(e.string());break;default:e.skipType(7&i)}}return r},e}(),iB=t.SubscribeUserStatus=function(){function e(e){if(this.users=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,e.prototype.users=q.emptyArray,e.encode=function(e,t){if(t||(t=J.create()),null!=e.seq&&Object.hasOwnProperty.call(e,"seq")&&t.uint32(8).uint64(e.seq),null!=e.users&&e.users.length)for(var n=0;n<e.users.length;++n)t.uint32(18).string(e.users[n]);return t},e.decode=function(e,n){e instanceof y||(e=y.create(e)),n=void 0===n?e.len:e.pos+n;for(var r=new t.SubscribeUserStatus;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.seq=e.uint64();break;case 2:r.users&&r.users.length||(r.users=[]),r.users.push(e.string());break;default:e.skipType(7&i)}}return r},e}(),jB=t.UnsubscribeUserStatus=function(){function e(e){if(this.users=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,e.prototype.users=q.emptyArray,e.encode=function(e,t){if(t||(t=J.create()),null!=e.seq&&Object.hasOwnProperty.call(e,"seq")&&t.uint32(8).uint64(e.seq),null!=e.users&&e.users.length)for(var n=0;n<e.users.length;++n)t.uint32(18).string(e.users[n]);return t},e.decode=function(e,n){e instanceof y||(e=y.create(e)),n=void 0===n?e.len:e.pos+n;for(var r=new t.UnsubscribeUserStatus;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.seq=e.uint64();break;case 2:r.users&&r.users.length||(r.users=[]),r.users.push(e.string());break;default:e.skipType(7&i)}}return r},e}(),kB=t.UserJoinNotice=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.instance=q.Long?q.Long.fromBits(0,0,!0):0,e.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,e.prototype.user="",e.encode=function(e,t){return t||(t=J.create()),null!=e.instance&&Object.hasOwnProperty.call(e,"instance")&&t.uint32(8).uint64(e.instance),null!=e.seq&&Object.hasOwnProperty.call(e,"seq")&&t.uint32(16).uint64(e.seq),null!=e.user&&Object.hasOwnProperty.call(e,"user")&&t.uint32(26).string(e.user),t},e.decode=function(e,n){e instanceof y||(e=y.create(e)),n=void 0===n?e.len:e.pos+n;for(var r=new t.UserJoinNotice;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.instance=e.uint64();break;case 2:r.seq=e.uint64();break;case 3:r.user=e.string();break;default:e.skipType(7&i)}}return r},e}(),lB=t.UserQuitNotice=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.instance=q.Long?q.Long.fromBits(0,0,!0):0,e.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,e.prototype.user="",e.encode=function(e,t){return t||(t=J.create()),null!=e.instance&&Object.hasOwnProperty.call(e,"instance")&&t.uint32(8).uint64(e.instance),null!=e.seq&&Object.hasOwnProperty.call(e,"seq")&&t.uint32(16).uint64(e.seq),null!=e.user&&Object.hasOwnProperty.call(e,"user")&&t.uint32(26).string(e.user),t},e.decode=function(e,n){e instanceof y||(e=y.create(e)),n=void 0===n?e.len:e.pos+n;for(var r=new t.UserQuitNotice;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.instance=e.uint64();break;case 2:r.seq=e.uint64();break;case 3:r.user=e.string();break;default:e.skipType(7&i)}}return r},e}(),mB=t.UserWaitNotice=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.instance=q.Long?q.Long.fromBits(0,0,!0):0,e.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,e.prototype.user="",e.encode=function(e,t){return t||(t=J.create()),null!=e.instance&&Object.hasOwnProperty.call(e,"instance")&&t.uint32(8).uint64(e.instance),null!=e.seq&&Object.hasOwnProperty.call(e,"seq")&&t.uint32(16).uint64(e.seq),null!=e.user&&Object.hasOwnProperty.call(e,"user")&&t.uint32(26).string(e.user),t},e.decode=function(e,n){e instanceof y||(e=y.create(e)),n=void 0===n?e.len:e.pos+n;for(var r=new t.UserWaitNotice;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.instance=e.uint64();break;case 2:r.seq=e.uint64();break;case 3:r.user=e.string();break;default:e.skipType(7&i)}}return r},e}(),nB=t.SubscribeResponse=function(){function e(e){if(this.errors=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,e.prototype.errors=q.emptyArray,e.encode=function(e,n){if(n||(n=J.create()),null!=e.seq&&Object.hasOwnProperty.call(e,"seq")&&n.uint32(8).uint64(e.seq),null!=e.errors&&e.errors.length)for(var r=0;r<e.errors.length;++r)t.SubscribeResponse.SubscribeErrorsType.encode(e.errors[r],n.uint32(18).fork()).ldelim();return n},e.decode=function(e,n){e instanceof y||(e=y.create(e)),n=void 0===n?e.len:e.pos+n;for(var r=new t.SubscribeResponse;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.seq=e.uint64();break;case 2:r.errors&&r.errors.length||(r.errors=[]),r.errors.push(t.SubscribeResponse.SubscribeErrorsType.decode(e,e.uint32()));break;default:e.skipType(7&i)}}return r},e.SubscribeErrorsType=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.account="",e.prototype.code=0,e.encode=function(e,t){return t||(t=J.create()),null!=e.account&&Object.hasOwnProperty.call(e,"account")&&t.uint32(10).string(e.account),null!=e.code&&Object.hasOwnProperty.call(e,"code")&&t.uint32(16).uint32(e.code),t},e.decode=function(e,n){e instanceof y||(e=y.create(e)),n=void 0===n?e.len:e.pos+n;for(var r=new t.SubscribeResponse.SubscribeErrorsType;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.account=e.string();break;case 2:r.code=e.uint32();break;default:e.skipType(7&i)}}return r},e}(),e}(),oB=Object.freeze({__proto__:null,URI:rA,Wrapper:yh,Ping:sA,Pong:tA,UserJoin:uA,UserResp:vA,UserQuit:wA,UserDrop:xA,GroupEnter:yA,GroupLeave:zA,GroupReply:AA,GroupLeaveNotice:Sq,GroupEnterNotice:Tq,Message:Uq,Ack:Vq,FileUploadIndexGet:BA,FileUploadIndexRet:CA,FileUploadIndexSet:DA,FileUploadIndexFin:EA,FileUploadIndexErr:FA,FileDownloadIndexGet:GA,FileDownloadIndexRet:HA,FileDownloadIndexErr:IA,GroupAllUsersList:JA,GroupAllUsersResult:KA,UserStatusList:LA,UserStatusResult:MA,UserAttributeGet:NA,UserAttributeRet:OA,UserAttributeSet:PA,UserAttributeMod:QA,UserAttributeDel:RA,UserAttributeErr:SA,UserAttributeKeysGet:TA,UserAttributeKeysRet:UA,UserAttributeRsp:VA,GroupStatusList:WA,GroupStatusResult:XA,GroupCountNotice:YA,GroupAttributeGet:ZA,GroupAttributeRet:$A,GroupAttributeSet:aB,GroupAttributeMod:bB,GroupAttributeDel:cB,GroupAttributeAlt:dB,GroupAttributeRsp:eB,GroupAttributeErr:fB,GroupAttributeKeysGet:gB,GroupAttributeKeysRet:hB,SubscribeUserStatus:iB,UnsubscribeUserStatus:jB,UserJoinNotice:kB,UserQuitNotice:lB,UserWaitNotice:mB,SubscribeResponse:nB,default:t}),pB="".repeat||function(e){var t=String(hb(this)),n="";if(0>(e=ic(e))||1/0==e)throw RangeError("Wrong number of repetitions");for(;0<e;(e>>>=1)&&(t+=t))1&e&&(n+=t);return n},qB=Math.ceil,Wq=function(e){return function(t,n,r){var i=(t=String(hb(t))).length;return r=void 0===r?" ":String(r),(n=za(n))<=i||""==r?t:(n-=i,(i=pB.call(r,qB(n/r.length))).length>n&&(i=i.slice(0,n)),e?t+i:i+t)}},rB=Wq(!1),sB=Wq(!0),Xq=/Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(oe);N({target:"String",proto:!0,forced:Xq},{padEnd:function(e){return sB(this,e,1<arguments.length?arguments[1]:void 0)}}),N({target:"Number",stat:!0},{MIN_SAFE_INTEGER:-9007199254740991});var tB=kf,Yq=function(e){return function(t){t=rb(t);for(var n,r=Dc(t),i=r.length,o=0,a=[];i>o;)n=r[o++],ja&&!tB.call(t,n)||a.push(e?[n,t[n]]:t[n]);return a}},uB=[Yq(!0),Yq(!1)][0];N({target:"Object",stat:!0},{entries:function(e){return uB(e)}});var vB=Db.f,Zq="".endsWith,wB=Math.min,$q=Oj("endsWith"),xB=!$q&&!!function(){var e=vB(String.prototype,"endsWith");return e&&!e.writable}();N({target:"String",proto:!0,forced:!xB&&!$q},{endsWith:function(e){var t=String(hb(this));Nj(e);var n=1<arguments.length?arguments[1]:void 0,r=za(t.length);return n=void 0===n?r:wB(za(n),r),r=String(e),Zq?Zq.call(t,r,n):t.slice(n-r.length,n)===r}}),Kg("match",1,(function(e,t,n){return[function(t){var n=hb(this),r=null==t?void 0:t[e];return void 0!==r?r.call(t,n):new RegExp(t)[e](String(n))},function(e){var r=n(t,e,this);if(r.done)return r.value;if(e=qa(e),r=String(this),!e.global)return te(e,r);var i=e.unicode;e.lastIndex=0;for(var o,a=[],s=0;null!==(o=te(e,r));)o=String(o[0]),a[s]=o,""===o&&(e.lastIndex=bj(r,za(e.lastIndex),i)),s++;return 0===s?null:a}]}));var yB=Db.f,ar="".startsWith,zB=Math.min,br=Oj("startsWith"),AB=!br&&!!function(){var e=yB(String.prototype,"startsWith");return e&&!e.writable}();N({target:"String",proto:!0,forced:!AB&&!br},{startsWith:function(e){var t=String(hb(this));Nj(e);var n=za(zB(1<arguments.length?arguments[1]:void 0,t.length)),r=String(e);return ar?ar.call(t,r,n):t.slice(n,n+r.length)===r}});var sm=function(e){var t=/(%?)(%([jds]))/g,n=Array.prototype.slice.call(arguments,1);return n.length&&(e=e.replace(t,(function(e,t,r,i){switch(r=n.shift(),i){case"s":r=""+r;break;case"d":r=Number(r);break;case"j":r=JSON.stringify(r)}return t?(n.unshift(r),e):r}))),n.length&&(e+=" "+n.join(" ")),""+e.replace(/%{2,2}/g,"%")},BB=/\s/,CB=function(e){for(var t=e.length;t--&&BB.test(e.charAt(t)););return t},DB=/^\s+/,cr=NaN,EB=/^[-+]0x[0-9a-f]+$/i,FB=/^0b[01]+$/i,GB=/^0o[0-7]+$/i,HB=parseInt,Pk=function(e){if("number"==typeof e)return e;if(Vd(e))return cr;if(jb(e)&&(e="function"==typeof e.valueOf?e.valueOf():e,e=jb(e)?e+"":e),"string"!=typeof e)return 0===e?e:+e;e=e?e.slice(0,CB(e)+1).replace(DB,""):e;var t=FB.test(e);return t||GB.test(e)?HB(e.slice(2),t?2:8):EB.test(e)?cr:+e},IB=Math.max,JB=Math.min,KB=function(e,t,n){function r(t){var n=c,r=u;return c=u=void 0,f=t,l=e.apply(r,n)}function i(e){var n=e-h;return e-=f,void 0===h||n>=t||0>n||A&&e>=v}function o(){var e=Bb.Date.now();if(i(e))return a(e);var n=setTimeout,r=e-f;e=t-(e-h),r=A?JB(e,v-r):e,d=n(o,r)}function a(e){return d=void 0,g&&c?r(e):(c=u=void 0,l)}function s(){var e=Bb.Date.now(),n=i(e);if(c=arguments,u=this,h=e,n){if(void 0===d)return f=e=h,d=setTimeout(o,t),p?r(e):l;if(A)return clearTimeout(d),d=setTimeout(o,t),r(h)}return void 0===d&&(d=setTimeout(o,t)),l}var c,u,l,d,h,f=0,p=!1,A=!1,g=!0;if("function"!=typeof e)throw new TypeError("Expected a function");if(t=Pk(t)||0,jb(n)){p=!!n.leading;var v=(A="maxWait"in n)?IB(Pk(n.maxWait)||0,t):v;g="trailing"in n?!!n.trailing:g}return s.cancel=function(){void 0!==d&&clearTimeout(d),f=0,c=h=u=d=void 0},s.flush=function(){return void 0===d?l:a(Bb.Date.now())},s},sc=function(e){function t(e,i){return W(this,t),m(n(e=r.call(this,rm(e,i))),"originalError",void 0),m(n(e),"code",void 0),m(n(e),"serverCode",void 0),"number"==typeof i?e.code=i:"string"==typeof i?e.name=i:void 0!==i&&(i.originalError&&(e.originalError=i.originalError),void 0!==i.code&&(e.code=i.code),void 0!==i.serverCode&&(e.serverCode=i.serverCode)),e}ka(t,e);var r=la(t);return t}(Re(Error)),Da=function(e){function t(e,i){return W(this,t),m(n(e=r.call(this,rm(e,i))),"name","RtmInternalError"),m(n(e),"code",void 0),e.code=i,e}ka(t,e);var r=la(t);return t}(Re(Error)),zh=function(){return function(e){function t(e){W(this,t);var r=Object.keys(e);return n.call(this,e[r[0]],r[0])}ka(t,e);var n=la(t);return t}(Da)},Ca=zh(),bb=function(e){function t(){W(this,t);for(var e=arguments.length,i=Array(e),o=0;o<e;o++)i[o]=arguments[o];return m(n(e=r.call.apply(r,[this].concat(i))),"name","RtmTimeoutError"),e}ka(t,e);var r=la(t);return t}(sc),L=function(e){function t(){W(this,t);for(var e=arguments.length,i=Array(e),o=0;o<e;o++)i[o]=arguments[o];return m(n(e=r.call.apply(r,[this].concat(i))),"name","RtmInvalidArgumentError"),e}ka(t,e);var r=la(t);return t}(sc),H=function(e){function t(){W(this,t);for(var e=arguments.length,i=Array(e),o=0;o<e;o++)i[o]=arguments[o];return m(n(e=r.call.apply(r,[this].concat(i))),"name","RtmInvalidStatusError"),e}ka(t,e);var r=la(t);return t}(sc),Qk=function(e){function t(){W(this,t);for(var e=arguments.length,i=Array(e),o=0;o<e;o++)i[o]=arguments[o];return m(n(e=r.call.apply(r,[this].concat(i))),"name","RtmInterruptedError"),e}ka(t,e);var r=la(t);return t}(sc),gb=function(e){function t(){W(this,t);for(var e=arguments.length,i=Array(e),o=0;o<e;o++)i[o]=arguments[o];return m(n(e=r.call.apply(r,[this].concat(i))),"name","RtmLimitExceededError"),e}ka(t,e);var r=la(t);return t}(sc),LB=function(e){function t(){W(this,t);for(var e=arguments.length,i=Array(e),o=0;o<e;o++)i[o]=arguments[o];return m(n(e=r.call.apply(r,[this].concat(i))),"name","RtmInvokeTooOftenError"),e}ka(t,e);var r=la(t);return t}(sc),ca=function(e){function t(){W(this,t);for(var e=arguments.length,i=Array(e),o=0;o<e;o++)i[o]=arguments[o];return m(n(e=r.call.apply(r,[this].concat(i))),"name","RtmUnavailableError"),m(n(e),"serverCode",void 0),m(n(e),"statusCode",void 0),e}ka(t,e);var r=la(t);return t}(sc),Ke=function(e){function t(){W(this,t);for(var e=arguments.length,i=Array(e),o=0;o<e;o++)i[o]=arguments[o];return m(n(e=r.call.apply(r,[this].concat(i))),"name","RtmUnauthenticatedError"),m(n(e),"serverCode",void 0),e}ka(t,e);var r=la(t);return t}(sc),Pc=function(e){function t(){W(this,t);for(var e=arguments.length,i=Array(e),o=0;o<e;o++)i[o]=arguments[o];return m(n(e=r.call.apply(r,[this].concat(i))),"name","RtmUnknownError"),e}ka(t,e);var r=la(t);return t}(sc),Na=function(e){return e instanceof bb||e instanceof pb},wa=function(e){return e instanceof sc},Md=function(e,t,n){return['Executing "%s.%s" timed out after %ds',e,t,n/1e3]},qm=new Map,MB=function(){var e=new Date;return"".concat(e.toISOString().split("T")[1].replace(/\..+/,""),".").concat(e.getMilliseconds())},Rk=Object.keys,dr=Object.entries.bind(Object),mg=function(e){return"string"==typeof e?e.endsWith(".")?e:"".concat(e,"."):e},xm=function(e){for(var t="",n=(e=new Uint8Array(e)).byteLength,r=-1;++r<n;)t+=String.fromCharCode(e[r]);return t=btoa(t),"data:;base64,".concat(t)},NB=O((function(){return null!==new Date(NaN).toJSON()||1!==Date.prototype.toJSON.call({toISOString:function(){return 1}})}));N({target:"Date",proto:!0,forced:NB},{toJSON:function(e){e=Wa(this);var t=hc(e);return"number"!=typeof t||isFinite(t)?e.toISOString():null}}),N({target:"URL",proto:!0,enumerable:!0},{toJSON:function(){return URL.prototype.toString.call(this)}});var vt=Object.prototype.hasOwnProperty,er=function(e,t,n){return JSON.stringify(Cm(e),t,n)};er.ensureProperties=Cm;var OB=function(e,t){t=t||{};var n=R(e);if("string"===n&&0<e.length)return wt(e);if("number"===n&&isFinite(e))return e=t.long?864e5<=(t=Math.abs(e))?tg(e,t,864e5,"day"):36e5<=t?tg(e,t,36e5,"hour"):6e4<=t?tg(e,t,6e4,"minute"):1e3<=t?tg(e,t,1e3,"second"):e+" ms":864e5<=(t=Math.abs(e))?Math.round(e/864e5)+"d":36e5<=t?Math.round(e/36e5)+"h":6e4<=t?Math.round(e/6e4)+"m":1e3<=t?Math.round(e/1e3)+"s":e+"ms";throw Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))},PB=function(e){function t(e){function r(){for(var e=arguments.length,n=Array(e),o=0;o<e;o++)n[o]=arguments[o];if(r.enabled){e=Number(new Date),r.diff=e-(i||e),r.prev=i,i=r.curr=e,n[0]=t.coerce(n[0]),"string"!=typeof n[0]&&n.unshift("%O");var a=0;n[0]=n[0].replace(/%([a-zA-Z%])/g,(function(e,i){return"%%"===e?"%":(a++,"function"==typeof(i=t.formatters[i])&&(e=i.call(r,n[a]),n.splice(a,1),a--),e)})),t.formatArgs.call(r,n),(r.log||t.log).apply(r,n)}}var i,o=null;return r.namespace=e,r.useColors=t.useColors(),r.color=t.selectColor(e),r.extend=n,r.destroy=t.destroy,Object.defineProperty(r,"enabled",{enumerable:!0,configurable:!1,get:function(){return null===o?t.enabled(e):o},set:function(e){o=e}}),"function"==typeof t.init&&t.init(r),r}function n(e,n){return(e=t(this.namespace+(void 0===n?":":n)+e)).log=this.log,e}function r(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return t.debug=t,t.default=t,t.coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){var e=[].concat(I(t.names.map(r)),I(t.skips.map(r).map((function(e){return"-"+e})))).join(",");return t.enable(""),e},t.enable=function(e){t.save(e),t.names=[],t.skips=[];var n,r=("string"==typeof e?e:"").split(/[\s,]+/),i=r.length;for(n=0;n<i;n++)r[n]&&("-"===(e=r[n].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")))},t.enabled=function(e){if("*"===e[e.length-1])return!0;var n,r=0;for(n=t.skips.length;r<n;r++)if(t.skips[r].test(e))return!1;for(r=0,n=t.names.length;r<n;r++)if(t.names[r].test(e))return!0;return!1},t.humanize=OB,t.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(e).forEach((function(n){t[n]=e[n]})),t.names=[],t.skips=[],t.formatters={},t.selectColor=function(e){for(var n=0,r=0;r<e.length;r++)n=(n<<5)-n+e.charCodeAt(r),n|=0;return t.colors[Math.abs(n)%t.colors.length]},t.enable(t.load()),t},fr=Xa((function(e,t){t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),this.useColors){var n="color: "+this.color;t.splice(1,0,n,"color: inherit");var r=0,i=0;t[0].replace(/%[a-zA-Z%]/g,(function(e){"%%"!==e&&(r++,"%c"===e&&(i=r))})),t.splice(i,0,n)}},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(e){}},t.load=function(){try{var e=t.storage.getItem("debug")}catch(e){}return!e&&"undefined"!=typeof process&&"env"in process&&(e=process.env.DEBUG),e},t.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type&&!window.process.__nwjs)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&31<=parseInt(RegExp.$1,10)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))};e:{try{var n=localStorage;break e}catch(e){}n=void 0}t.storage=n,t.destroy=function(){var e=!1;return function(){e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}}(),t.colors="#0000CC #0000FF #0033CC #0033FF #0066CC #0066FF #0099CC #0099FF #00CC00 #00CC33 #00CC66 #00CC99 #00CCCC #00CCFF #3300CC #3300FF #3333CC #3333FF #3366CC #3366FF #3399CC #3399FF #33CC00 #33CC33 #33CC66 #33CC99 #33CCCC #33CCFF #6600CC #6600FF #6633CC #6633FF #66CC00 #66CC33 #9900CC #9900FF #9933CC #9933FF #99CC00 #99CC33 #CC0000 #CC0033 #CC0066 #CC0099 #CC00CC #CC00FF #CC3300 #CC3333 #CC3366 #CC3399 #CC33CC #CC33FF #CC6600 #CC6633 #CC9900 #CC9933 #CCCC00 #CCCC33 #FF0000 #FF0033 #FF0066 #FF0099 #FF00CC #FF00FF #FF3300 #FF3333 #FF3366 #FF3399 #FF33CC #FF33FF #FF6600 #FF6633 #FF9900 #FF9933 #FFCC00 #FFCC33".split(" "),t.log=console.debug||console.log||function(){},e.exports=PB(t),e.exports.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}})),gr=fr("RTM:DEBUG"),Le;gr.enabled=!1,function(e){e[e.Uploading=0]="Uploading",e[e.Free=1]="Free"}(Le||(Le={}));var QB=function(){function e(t){W(this,e),m(this,"uploadRequest",void 0),m(this,"uploadState",void 0),m(this,"uploadResendCount",void 0),m(this,"LogCache",void 0),m(this,"LogsToPost",void 0),m(this,"processId",void 0),m(this,"sdkVersion",void 0),m(this,"logId",void 0),this.processId=t.processId,this.sdkVersion=t.sdkVersion,this.uploadRequest=t.uploadRequest,this.uploadState=Le.Free,this.uploadResendCount=0,this.LogCache=[],this.LogsToPost=[],this.logId=0}return Ea(e,[{key:"upload",value:function(e,t){this.LogCache.push(e),this.uploadState===Le.Free&&(this.LogsToPost=40>this.LogCache.length?this.LogCache.splice(0,this.LogCache.length):this.LogCache.splice(0,40),this.postLog(this.LogsToPost,t))}},{key:"postLog",value:function(e,t){var n=this;this.uploadState=Le.Uploading,setTimeout(K(w.mark((function r(){var i,o;return w.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return i={sdk_version:n.sdkVersion,process_id:n.processId,payload:JSON.stringify(e)},r.prev=1,r.next=4,n.uploadRequest(i,t);case 4:r.next=11;break;case 6:return r.prev=6,r.t0=r.catch(1),o=2>n.uploadResendCount++?2e3:1e4,setTimeout((function(){return n.postLog(n.LogsToPost,t)}),o),r.abrupt("return");case 11:if(gr('The logs uploaded for "process-'.concat(Sf,'"')),0!==n.LogCache.length){r.next=15;break}return n.uploadState=Le.Free,r.abrupt("return");case 15:n.uploadResendCount=0,n.LogsToPost=40>n.LogCache.length?n.LogCache.splice(0,n.LogCache.length):n.LogCache.splice(0,40),n.postLog(n.LogsToPost,t);case 18:case"end":return r.stop()}}),r,null,[[1,6]])}))),Nd.getParameter("LOG_UPLOAD_INTERVAL"))}}]),e}(),hr=function(){var e=K(w.mark((function e(t,n){var r,i,o,a=arguments;return w.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(2<(r=2<a.length&&void 0!==a[2]?a[2]:0))){e.next=3;break}return e.abrupt("return");case 3:return i={withCredentials:!0,body:t,timeout:2e4},o="https://".concat(0<r?(null==n?void 0:n.LOG_UPLOAD_SERVER[0])||"logservice-rtm.agoraio.cn":(null==n?void 0:n.LOG_UPLOAD_SERVER[0])||"logservice-rtm.agora.io","/upload/v1"),e.next=7,gf(o,i).catch((function(e){return hr(t,n,r+1)}));case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),RB=new QB({processId:"process-".concat(Sf),sdkVersion:"Agora_RTM_SDK_for_Web_".concat("v1.4.2-0-gcddbca54"),uploadRequest:hr}),ir="text payload rawMessage thumbnail token detail ticket attributeInfos".split(" "),jr=function(e){return"object"===R(e)?md(e)?qg(e,ir):e.constructor&&e.constructor.name:e},kr=function(e,t){return e instanceof Error?e.message:"string"!=typeof e?JSON.stringify(qg(e,ir)):(t=t.map((function(e){return e instanceof Error?e.message:"object"===R(e)?er(Array.isArray(e)?e.map(jr):jr(e)):e})),sm.apply(void 0,[e.replace(/%[%Oo]/g,(function(e){return"%%"===e?"%":"%o"===e||"%O"===e?"%s":e}))].concat(I(t))))},SB=1,lr=function(e,t,n){var r=fr(e);return r.enabled=!0,r.log=n,r.useColors=!1,function(n){for(var i=arguments.length,o=Array(1<i?i-1:0),a=1;a<i;a++)o[a-1]=arguments[a];if(t.enableLogUpload){i=mg(n);var s=kr(i,o);RB.upload({log_item_id:"".concat(SB++),log_level:e,payload_str:"[".concat(MB(),"] ").concat(e," - ").concat(256<s.length?s.slice(0,256):s)},t._areaConfig)}switch(i=function(e){var t=s||kr(mg(n),o),i=dd.LOG_HANDLER;"function"==typeof i&&i({level:e,message:t}),r(t)},e){case"RTM:INFO":t.logFilter.info&&i("log");break;case"RTM:WARN":t.logFilter.warn&&i("warning");break;case"RTM:ERROR":t.logFilter.error&&i("error");break;case"RTM:TRACK":t.logFilter.track&&i("log");break;case"RTM:MSG:RECV":case"RTM:MSG:SEND":t.logFilter.debug&&i("debug");break;case"RTM:DEBUG":t.logFilter.debug&&i("debug")}}},Sk,mr=function(e){return function(t){var n=1===Sk||void 0===e?"":"Ins#".concat(e," ");return"".concat(n).concat(t)}},Tk=function(e,t,n){var r=mr(Sk);return lr("RTM:".concat(t),n,(function(t){return e(r(t))}))},vb=function(){return function(e){function t(e,i){var o=2<arguments.length&&void 0!==arguments[2]&&arguments[2];W(this,t);var a=r.call(this);if(m(n(a),"logError",void 0),m(n(a),"invokeTracker",void 0),m(n(a),"resultTracker",void 0),m(n(a),"errorTracker",void 0),m(n(a),"eventTracker",void 0),m(n(a),"info",void 0),m(n(a),"warn",void 0),m(n(a),"log",void 0),m(n(a),"genLogger",void 0),m(n(a),"loggerId",void 0),m(n(a),"logger",void 0),m(n(a),"name",void 0),a.logger=e,a.name=i,a.loggerId=e.loggerId,a.info=e.info,a.warn=e.warn,a.logError=e.logError,a.genLogger=e.genLogger,a.log=e.genLogger("RTM:DEBUG","<".concat(i,"> ")),a.invokeTracker=e.genTracker("Invoke"),a.eventTracker=e.genTracker("Event"),a.resultTracker=e.genTracker("Result"),a.errorTracker=e.genTracker("Error"),o){var s=a.emit.bind(n(a));a.emit=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];e=t[0],n=t.slice(1),a.eventTracker.apply(a,["%s: ".concat(0<n.length?"%s emitted with args: ".concat(n.map((function(){return"%o"}))):"%s emitted"),i,e].concat(I(n)));try{s.apply(void 0,t)}catch(t){a.logError("Caught in the callback function of the event %s",e,t)}}}return a}ka(t,e);var r=la(t);return t}(aa)},TB=function(e){return Tk(console.log.bind(console),"INFO",e)},UB=function(e){return Tk(console.warn.bind(console),"WARN",e)},VB=function(e){return Tk(console.error.bind(console),"ERROR",e)},nr=function(e,t){return function(n){var r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"",i=mr(e),o=console.debug.bind(console),a=lr(n,t,(function(e){return o(i(e))}));return function(e){for(var t=arguments.length,n=Array(1<t?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return a.apply(void 0,[r+e].concat(n))}}},WB=function(e,t){return function(n){return nr(e,t)("RTM:TRACK","[".concat(n,"] "))}},yi=t.URI,yt=yh,XB=Se(oB,["Wrapper"]),Dm=rg(XB,"URI"),YB=Math.floor,ZB=Math.random,or=function(e,t){var n=-1,r=e.length,i=r-1;for(t=void 0===t?r:t;++n<t;){r=n;var o=i;o=e[r+=YB(ZB()*(o-r+1))],e[r]=e[n],e[n]=o}return e.length=t,e},$B=function(e){return or(Ih(e))},Em=function(e,t){return Ud(t,(function(t){return e[t]}))},aC=function(e){return or(null==e?[]:Em(e,Rc(e)))},Ah=function(e){return(Ya(e)?$B:aC)(e)},Me={0:9591,1:9593},Ne=function(e){return"https://".concat(e,"/api/v1")},bC=mb.apply(void 0,I(Ah(["ap-web-1.agoraio.cn","ap-web-2.agoraio.cn"].map(Ne)))),cC=mb.apply(void 0,I(Ah(["ap-web-1.agora.io","ap-web-2.agora.io"].map(Ne)))),dC=mb.apply(void 0,I(Ah(["ap-web-3.agoraio.cn","ap-web-4.agoraio.cn"].map(Ne)))),eC=mb.apply(void 0,I(Ah(["ap-web-3.agora.io","ap-web-4.agora.io"].map(Ne)))),Uk=zh(),Vk=function(e){function t(e,i,o,a,s,c){W(this,t);var u=r.call(this,s,pm("Socket-",s.loggerId));if(m(n(u),"isActiveClose",!1),m(n(u),"loggedIn",!1),m(n(u),"useCnDomain",void 0),m(n(u),"receivedPacket",new La),m(n(u),"open$",void 0),m(n(u),"input$",new La),m(n(u),"userJoin$",new La),m(n(u),"attemptsSinceLastError",0),m(n(u),"message$",new La),m(n(u),"socket$",void 0),m(n(u),"toClose",new La),m(n(u),"toReconnect",new La),m(n(u),"sendLogger",void 0),m(n(u),"receiveLogger",void 0),m(n(u),"ip",void 0),m(n(u),"env",void 0),m(n(u),"ticket",void 0),m(n(u),"context",void 0),m(n(u),"getDomain",(function(){var e=u.useCnDomain?"agoraio.cn":"agora.io";return"".concat(u.ip.split(".").join("-"),".edge.").concat(e)})),m(n(u),"socketReconnector",(function(e){var t=function(e){return u.attemptsSinceLastError+=1,u.warn("The %s of Env %d reconnecting %s",u.name,u.env,e.message),uc(1500)};return e.pipe(Ga((function(e){return u.log("socket connection closed"),u.loggedIn=!1,2<=u.attemptsSinceLastError?(u.warn("socket connection failure"),u.emit("connectionFailure"),u.close(),ba(e)):u.isActiveClose?dc:(u.emit("reconnect"),u.useCnDomain=!u.useCnDomain,ba(e))})),ae((function(e){return e.pipe(vc(t))})))})),u.ip=e,u.env=i,u.ticket=o,u.context=a,u.useCnDomain="CN"===u.context.area,u.sendLogger=u.genLogger("RTM:MSG:SEND"),u.receiveLogger=u.genLogger("RTM:MSG:RECV"),0!==i&&1!==i)throw new Uk({ILLEGAL_RTM_ENV:"The env number is out of rtm env count"});if(!pt(e))throw new Uk({IP_NOT_VALID:"The ip from ap is not valid"});void 0!==c&&(u.useCnDomain=c);var l=Me[i];u.log("Opening websocket address %s for the Env %d",u.ip,u.env);var d=Tb(u.input$,u.userJoin$.pipe(lt(2)),u.message$).pipe(Z((function(e){return yh.encode(e).finish()})));return e=Tb(mt("",{protocols:[],makeWebSocket:function(){var e=new WebSocket("wss://".concat(u.getDomain(),":").concat(l));return e.binaryType="arraybuffer",e}}),u.toReconnect),u.socket$=ya(e,Ck.pipe(Za(5e3),Ga((function(e){return Na(e)&&u.warn("socket open timed out"),ba(e)})))).pipe(Z((function(e){if(e instanceof Error)throw u.warn("Env_%d: Force reconnect the socket",u.env),e;return e(d).pipe(Z((function(e){return yh.decode(new Uint8Array(e))})))})),u.socketReconnector),u.open$=u.socket$.pipe(Y((function(e){u.log("Websocket opened",u.name),e.subscribe((function(e){var t=e.data;e=yi[e.uri].slice(0,-3),t=Dm[e].decode(t);var n=fA({},rg(t,"toJSON"),(function(e,t){return t instanceof U?om(t):t})),r=!1;if((t instanceof Tq||t instanceof Sq)&&t.instance.lessThanOrEqual(4294967295)&&(r=!0),t instanceof Uq||t instanceof Vq){var i=t.instance,o=t.sequence;(t.dialogue.lessThanOrEqual(4294967295)||i.lessThanOrEqual(4294967295)||o.lessThan(1))&&(r=!0)}r?u.warn("Env_%d: Illegal %s, abandoned %o",u.env,e,n):("Pong"!==e&&u.receiveLogger("Env_%d: %s %o",u.env,e,n),u.receivedPacket.next([e,t]))}),(function(){}))})),bf(void 0),ob(u.toClose),be()),u}ka(t,e);var r=la(t);return Ea(t,[{key:"address",get:function(){return"".concat(this.ip,":").concat(Me[this.env])}},{key:"sendPacket",value:function(e,t){if("Ping"!==e){var n=oc(t,(function(e){return e instanceof U?om(e):e}));this.sendLogger("Env_%d: %s %o",this.env,e,n)}t=xt(e,t),"UserJoin"===e?this.userJoin$.next(t):"Message"===e?this.message$.next(t):this.input$.next(t)}},{key:"close",value:function(){this.isActiveClose=!0,this.loggedIn=!1,this.toClose.next()}},{key:"fromReceived",value:function(e){var t=this;return this.receivedPacket.pipe(Y((function(e){var n=pa(e,2);e=n[0],n=n[1],"UserResp"===e&&(t.attemptsSinceLastError=0,t.loggedIn=!0),"UserDrop"===e&&t.emit("socketUserDrop",n)})),nb((function(t){return pa(t,1)[0]===e})),Z((function(e){return pa(e,2)[1]})))}},{key:"forceReconnect",value:function(){this.toReconnect.next(new Uk({FORCE_RECONNECTING:"Connection seems broken, try force reconnecting"}))}}]),t}(vb()),Oa;N({target:"String",proto:!0,forced:Xq},{padStart:function(e){return rB(this,e,1<arguments.length?arguments[1]:void 0)}}),function(e){e.CN="CN",e.NA="NA",e.EU="EU",e.AS="AS",e.JP="JP",e.IN="IN",e.GLOBAL="GLOBAL",e.OC="OC",e.SA="SA",e.AF="AF",e.OVS="OVS"}(Oa||(Oa={}));var Yf=Ja({AS:{CODE:Oa.AS,AP_DOMAINS:["ap-web-1-asia.agora.io"],AP_BACKUP_DOMAINS:["ap-web-2-asia.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-asia.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-asia.agora.io"],LOG_UPLOAD_SERVER:["logservice-asia.agora.io"]},NA:{CODE:Oa.NA,AP_DOMAINS:["ap-web-1-north-america.agora.io"],AP_BACKUP_DOMAINS:["ap-web-2-north-america.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-north-america.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-north-america.agora.io"],LOG_UPLOAD_SERVER:["logservice-north-america.agora.io"]},EU:{CODE:Oa.EU,AP_DOMAINS:["ap-web-1-europe.agora.io"],AP_BACKUP_DOMAINS:["ap-web-2-europe.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-europe.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-europe.agora.io"],LOG_UPLOAD_SERVER:["logservice-europe.agora.io"]},JP:{CODE:Oa.JP,AP_DOMAINS:["ap-web-1-japan.agora.io"],AP_BACKUP_DOMAINS:["ap-web-2-japan.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-japan.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-japan.agora.io"],LOG_UPLOAD_SERVER:["logservice-japan.agora.io"]},IN:{CODE:Oa.IN,AP_DOMAINS:["ap-web-1-india.agora.io"],AP_BACKUP_DOMAINS:["ap-web-2-india.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-india.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-india.agora.io"],LOG_UPLOAD_SERVER:["logservice-india.agora.io"]},OVS:{CODE:Oa.OVS,AP_DOMAINS:["ap-web-1-oversea.agora.io"],AP_BACKUP_DOMAINS:["ap-web-2-oversea.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-oversea.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-oversea.agora.io"],LOG_UPLOAD_SERVER:["logservice-oversea.agora.io"]},GLOB:{CODE:Oa.GLOBAL,AP_DOMAINS:["ap-web-1.agora.io","ap-web-2.agora.io"],AP_BACKUP_DOMAINS:["ap-web-3.agora.io","ap-web-4.agora.io"],EVENT_REPORT_DOMAIN:["webcollector-rtm.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["webcollector-1.agora.io"],LOG_UPLOAD_SERVER:["logservice-rtm.agora.io"]},OC:{CODE:Oa.OC,AP_DOMAINS:["ap-web-1-oceania.agora.io"],AP_BACKUP_DOMAINS:["ap-web-2-oceania.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-oceania.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-oceania.agora.io"],LOG_UPLOAD_SERVER:["logservice-oceania.agora.io"]},SA:{CODE:Oa.SA,AP_DOMAINS:["ap-web-1-south-america.agora.io"],AP_BACKUP_DOMAINS:["ap-web-2-south-america.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-south-america.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-south-america.agora.io"],LOG_UPLOAD_SERVER:["logservice-south-america.agora.io"]},AF:{CODE:Oa.AF,AP_DOMAINS:["ap-web-1-africa.agora.io"],AP_BACKUP_DOMAINS:["ap-web-2-africa.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-africa.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-africa.agora.io"],LOG_UPLOAD_SERVER:["logservice-south-africa.agora.io"]}},{CN:{CODE:Oa.CN,AP_DOMAINS:["ap-web-1.agoraio.cn","ap-web-2.agoraio.cn"],AP_BACKUP_DOMAINS:["ap-web-3.agoraio.cn","ap-web-4.agoraio.cn"],EVENT_REPORT_DOMAIN:["webcollector-rtm.agoraio.cn"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-4.agoraio.cn"],LOG_UPLOAD_SERVER:["logservice-rtm.agoraio.cn"]}});Yf=zm(Yf);var fC=function(e){var t=new Set;if(0===(e=e.map((function(e){var n=Yf[e];if(void 0===n)throw new Da("invalid area key");return e=n.CODE,n=Se(n,["CODE"]),t.add(e),n}))).length)throw new Da("areas cannot be empty");return Ja({CODES:t},e.reduce((function(e,t){for(var n=0,r=dr(e);n<r.length;n++){var i=pa(r[n],2),o=i[0];i=i[1],e[o]=Array.from(new Set([].concat(I(t[o]),I(i))))}return e})))},gC={INVALID_APP_ID:"Illegal App ID",NO_AUTHORIZED:"Signature verification failed",TOKEN_TIMEOUT:"Dynamic key expired",INVALID_TOKEN_UID:"UID in the security key(token) is not valid",APP_ID_NO_ACTIVATED:"The vendor is not activated",DYNAMIC_KEY_NOT_ENABLED:"The vendor did not enable the dynamic key, but uses the dynamic key",DYNAMIC_ENABLED_BUT_STATIC_KEY:"The vendor enabled the dynamic key, but uses the static key",TOKEN_EXPIRED:"The token has expired",INVALID_USER_ID:"The user ID to login does not match the token",FORBIDDEN_REGION:"Forbidden to access the request in this area",CANNOT_MEET_AREA_DEMAND:"Cannot allocate to meet the requirements of the given area limit"},pr={5:"INVALID_APP_ID",7:"INVALID_USER_ID",9:"NO_AUTHORIZED",10:"TOKEN_TIMEOUT",11:"APP_ID_NO_ACTIVATED",12:"INVALID_TOKEN_UID",13:"TOKEN_EXPIRED",14:"DYNAMIC_KEY_NOT_ENABLED",15:"DYNAMIC_ENABLED_BUT_STATIC_KEY",18:"FORBIDDEN_REGION",19:"CANNOT_MEET_AREA_DEMAND"},hC=[100,101,102],qr=function(e){function t(e,i){var o=2<arguments.length&&void 0!==arguments[2]&&arguments[2];W(this,t);var a=r.call(this,i,"AccessPoint");m(n(a),"getApEdgeInfo$",void 0),m(n(a),"getApEdgeInfoEndFirst$",void 0),m(n(a),"apFinish$",new La),m(n(a),"usedUrl",[]),m(n(a),"failedAreas",new Set),m(n(a),"cnDomainUsed",!1),m(n(a),"backupCnDomainUsed",!1),m(n(a),"genUrl",(function(){return void 0===a.context.areaConfig?Zh(bC,cC).pipe($h((function(e){return mb.apply(void 0,I(e))}))):mb.apply(void 0,I(a.context.areaConfig.AP_DOMAINS.map(Ne)))})),m(n(a),"genBackupUrl",(function(){return void 0===a.context.areaConfig?Zh(dC,eC).pipe($h((function(e){return mb.apply(void 0,I(e))}))):mb.apply(void 0,I(a.context.areaConfig.AP_BACKUP_DOMAINS.map(Ne)))})),m(n(a),"getUrl$",(function(e){return a.genUrl().pipe(nb((function(e){return!(a.cnDomainUsed&&e.includes("agoraio.cn")||(e.includes("agoraio.cn")&&(a.cnDomainUsed=!0),Mk(a.usedUrl,(function(t){return e[15]===t}))))})),Y((function(e){void 0===a.context.areaConfig&&a.usedUrl.push(e[15])})),Pa(e?dd.RECONNECTING_AP_NUM:2),rd((function(){return t.runOutOfUrlSymbol})),Ga((function(e,n){return a.cnDomainUsed=!1,e===t.runOutOfUrlSymbol?(a.usedUrl=[],n):ba(e)})))})),m(n(a),"getBackupUrl$",(function(e){return a.genBackupUrl().pipe(nb((function(e){return!(a.backupCnDomainUsed&&e.includes("agoraio.cn")||(e.includes("agoraio.cn")&&(a.backupCnDomainUsed=!0),Mk(a.usedUrl,(function(t){return e[15]===t}))))})),Y((function(e){void 0===a.context.areaConfig&&a.usedUrl.push(e[15])})),Pa(e?dd.RECONNECTING_AP_NUM:2),rd((function(){return t.runOutOfUrlSymbol})),Ga((function(e,n){return a.backupCnDomainUsed=!1,e===t.runOutOfUrlSymbol?(a.usedUrl=[],n):ba(e)})))})),m(n(a),"context",void 0),m(n(a),"fetchAp",(function(e,t){var n=pm("AP-",a.loggerId);a.log("The AccessPoint requests %s(%s)",e,n);var r=new AbortController;return a.apFinish$.pipe(Pa(1)).subscribe((function(){return r.abort()})),qd(K(w.mark((function i(){var o;return w.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return o=mi(0,Number.MAX_SAFE_INTEGER),a.log("The %s request uid param is %d",n,o),i.abrupt("return",gf(e,{headers:{"X-Packet-Service-Type":"0","X-Packet-URI":"69","Content-Type":"application/json"},body:{flag:128,opid:1,key:t||a.context.key,cname:a.context.uid,detail:Ja({},void 0===a.context.areaConfig?{11:"GLOBAL"}:{11:I(a.context.areaConfig.CODES).join(",")}),uid:o,sid:a.context.sid},signal:r.signal}));case 3:case"end":return i.stop()}}),i)})))).pipe(Ga((function(t){return"AbortError"!==t.name&&(a.logError(t),a.warn("The AP server %s request failure",e)),dc})),eb(function(){var t=K(w.mark((function t(r){var i,o,s,c,u,l,d,h,f,p,A,g,v,m,y,b,E,_,S,T,R,C,x;return w.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=r.responseText,o=JSON.parse(i),a.log("The %s response is %o",n,o),c=(s=o).code,u=s.addresses,l=s.detail,0===c){t.next=51;break}if(d=c,!(4<c.toString().length)){t.next=16;break}if(h=c.toString().padStart(8,"0"),f=parseInt(h.slice(0,4),10),p=parseInt(h.slice(4,8),10),201!==f){t.next=14;break}d=p,t.next=16;break;case 14:if(101!==f||hC.includes(p)){t.next=16;break}return t.abrupt("return",ba(Error("service is currently unavailable")));case 16:if(A=d.toString(),Object.keys(pr).includes(A)){t.next=22;break}return(g=new ca(["Login is rejected by the server. The response code is %d",c],sh)).serverCode=d,t.abrupt("return",ba(g));case 22:v=pr[A],m=gC[v],t.t0=v,t.next="INVALID_APP_ID"===t.t0||"APP_ID_NO_ACTIVATED"===t.t0?27:"INVALID_USER_ID"===t.t0?30:"TOKEN_EXPIRED"===t.t0||"TOKEN_TIMEOUT"===t.t0?33:"NO_AUTHORIZED"===t.t0||"INVALID_TOKEN_UID"===t.t0||"DYNAMIC_KEY_NOT_ENABLED"===t.t0||"DYNAMIC_ENABLED_BUT_STATIC_KEY"===t.t0?36:"CANNOT_MEET_AREA_DEMAND"===t.t0?39:"FORBIDDEN_REGION"===t.t0?47:50;break;case 27:return(y=new Ke(m,zq)).serverCode=c,t.abrupt("return",ba(y));case 30:return(b=new Ke(m,th)).serverCode=c,t.abrupt("return",ba(b));case 33:return(E=new Ke(m,uh)).serverCode=c,t.abrupt("return",ba(E));case 36:return(_=new Ke(m,Aq)).serverCode=c,t.abrupt("return",ba(_));case 39:e:{var w=e,O=Rk(Yf);w=tt(w);for(var N=0;N<O.length;N++){var B=Yf[O[N]];if(null!=B&&B.AP_DOMAINS.includes(w)||null!=B&&B.AP_BACKUP_DOMAINS.includes(w)){S=B.CODE===Oa.OVS?"".concat(Oa.AS,",").concat(Oa.EU,",").concat(Oa.AF,",").concat(Oa.NA,",").concat(Oa.SA,",").concat(Oa.OC):B.CODE;break e}}S="GLOBAL,CN"}if(a.failedAreas.add(S),T=void 0===a.context.areaConfig?2:a.context.areaConfig.CODES.size,a.failedAreas.size!==T){t.next=46;break}return(R=new L(m,sh)).serverCode=c,t.abrupt("return",ba(R));case 46:return t.abrupt("break",51);case 47:return(C=new ca(m,sh)).serverCode=c,t.abrupt("return",ba(C));case 50:return t.abrupt("return",ba(mm("ApResErrType",v)));case 51:return x=u,a.context.area=null==l?void 0:l[9],t.abrupt("return",mb.apply(void 0,I(x).concat([oh])));case 56:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),Wh(),nb((function(e){return void 0!==e&&"string"==typeof e.ip&&"string"==typeof e.ticket})))})),a.context=e;var s=0;return a.getApEdgeInfoEndFirst$=function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0];return uc(0,e||o?dd.RECONNECTING_AP_INTERVAL:2e3).pipe(Pa(1),Y((function(){s+=1})),eb((function(){return 2>=s?a.getUrl$(e||o):a.getBackupUrl$(e||o)})),eb((function(e){return a.fetchAp(e)})),Za(1e4),Ga((function(e){return e instanceof pb&&a.warn("AP request timeout"),ba(e)})),Ul((function(e){return e.ip})),hg((function(){s=0,a.failedAreas.clear()})),ob(a.apFinish$))},a.getApEdgeInfo$=function(e){return uc(0,e||o?dd.RECONNECTING_AP_INTERVAL:2e3).pipe(Pa(4),Y((function(){s+=1})),eb((function(){return 2>=s?a.getUrl$(e||o):a.getBackupUrl$(e||o)})),eb((function(e){return a.fetchAp(e)})),Za(1e4),Ga((function(e){return e instanceof pb&&a.warn("AP request timeout"),ba(e)})),Ul((function(e){return e.ip})),hg((function(){s=0,a.failedAreas.clear()})),ob(a.apFinish$))},a}ka(t,e);var r=la(t);return t}(vb());m(qr,"runOutOfUrlSymbol",Symbol("AP urls are used up"));var rr=zh(),sr=function(e){function t(e,i,o){W(this,t);var a=r.call(this,i,"Connection");m(n(a),"apClient",void 0),m(n(a),"lastOpenSockets",[new ce(1),new ce(1)]),m(n(a),"curOpenSockets",[void 0,void 0]),m(n(a),"ipIterator",0),m(n(a),"firstEnv",.5<=Math.random()?1:0),m(n(a),"firstSocketOpener",void 0),m(n(a),"secondSocketOpener",void 0),m(n(a),"firstOpenKeeperSubject",new La),m(n(a),"secondOpenKeeperSubject",new La),m(n(a),"edgeInfoReplayed",void 0),m(n(a),"firstEnvOpenSocket",void 0),m(n(a),"firstOpenKeeperSub",void 0),m(n(a),"secondOpenKeeperSub",void 0),m(n(a),"context",void 0),m(n(a),"logger",void 0),a.context=e,a.logger=i,a.apClient=new qr(a.context,i),a.apClient.apFinish$.subscribe((function(){a.log("Ap client fetch finished")}));var s,c=[];return a.edgeInfoReplayed=a.apClient.getApEdgeInfo$(o).pipe(nb((function(e){return void 0!==e&&"string"==typeof e.ip&&"string"==typeof e.ticket})),rd((function(){return new rr({AP_NO_AVAILABLE_EDGE:"No available edge address to connect"})})),ae((function(e){return e.pipe(Y((function(e){if(wa(e))throw e})),Wc(o?Nd.getParameter("RECONNECTING_AP_INTERVAL"):750),ob(uc(7e3)))})),nb((function(e){return!Mk(c,e)})),Y((function(e){c.push(e),a.log("An edge info got %o",e)})),Y({error:function(e){a.emit("connectionInitFailure",e)}}),Yl()),a.firstEnvOpenSocket=a.edgeInfoReplayed.pipe(eb((function(e){if(void 0===e)return ba(Error("Invalid edge info"));var t=new Vk(e.ip,a.firstEnv,e.ticket,a.context,i,s);return a.firstEnv=1===a.firstEnv?0:1,t.on("connectionFailure",(function(){return a.onSocketConnectionFailure(t)})),s=!t.useCnDomain,t.open$.pipe(bf(t))})),Y((function(e){a.log("The websocket of ENV_%d opened to %s:%d",e.env,e.ip,Me[e.env]),a.curOpenSockets[e.env]=e,a.lastOpenSockets[e.env].next(e),a.firstEnv=e.env,a.openSecondSocket(e.env,e.ip,e.useCnDomain)})),Pa(1),be()),a.firstSocketOpener=a.firstEnvOpenSocket.pipe(eb((function(e){return e.open$.pipe(Y((function(){a.log("The websocket of first ENV_%d re-opened to %s:%d",e.env,e.ip,Me[e.env]),a.curOpenSockets[e.env]=e,a.lastOpenSockets[e.env].next(e)})))}))),e=a.firstOpenKeeperSubject.pipe(vc(Sc)),a.firstOpenKeeperSub=e.subscribe({error:a.logError}),a}ka(t,e);var r=la(t);return Ea(t,[{key:"initConnection",value:function(){this.firstOpenKeeperSubject.next(this.firstSocketOpener)}},{key:"closeSocket",value:function(e,t){if(![0,1].includes(e))throw new Ca({INVALID_ENV:"The env argument is not 0 or 1"});var n=e===this.firstEnv?this.firstOpenKeeperSub:this.secondOpenKeeperSub;this.firstOpenKeeperSub=void 0;var r=this.curOpenSockets[e];this.curOpenSockets[e]=void 0,r&&(r.isActiveClose=!0,setTimeout((function(){r.close()}),t)),void 0!==n&&setTimeout((function(){null==n||n.unsubscribe()}),t)}},{key:"waitClosing",value:function(e){var t=this;return e.isActiveClose=!0,e.open$.pipe(Os(),Ga((function(e){return e.message===Mq.normalClosureMessage?dc:ba(e)})),Za(5e3),Ga((function(n){return n instanceof pb?(t.warn("Force closing the ENV_%d connection",e.env),dc):ba(n)})))}},{key:"onSocketConnectionFailure",value:function(e){var t=[0,1].filter((function(t){return t!==e.env}))[0];(t=this.curOpenSockets[t])&&t.loggedIn?this.reopenSocketWithApRequest(e.env):this.emit("socketsFailure")}},{key:"openSecondSocket",value:function(e,t,n){var r=this,i=1===e?0:1;this.secondSocketOpener=this.edgeInfoReplayed.pipe(Xl((function(e,t){return[].concat(I(e),[t])}),[]),Z((function(e){return Kq(e,(function(e){return nm(t,e.ip)})).slice(-1)[0]})),Pa(1),eb((function(e){if(void 0===e)return ba(Error("Invalid edge info"));var t=new Vk(e.ip,i,e.ticket,r.context,r.logger,n);return t.on("connectionFailure",(function(){return r.onSocketConnectionFailure(t)})),t.open$.pipe(Y((function(){r.lastOpenSockets[i].next(t),r.curOpenSockets[i]=t})))})),be()),this.secondOpenKeeperSub=this.secondOpenKeeperSubject.pipe(vc(Sc)).subscribe({error:this.logError}),this.secondOpenKeeperSubject.next(this.secondSocketOpener)}},{key:"reopenSocketWithApRequest",value:function(e){var t=this,n=[0,1].filter((function(t){return t!==e}))[0];if(void 0!==(n=this.curOpenSockets[n])){var r,i=n.ip;n=this.apClient.getApEdgeInfoEndFirst$(!0).pipe(nb((function(e){return void 0!==e&&"string"==typeof e.ip&&"string"==typeof e.ticket})),rd((function(){return new rr({AP_NO_AVAILABLE_EDGE:"No available edge address to connect"})})),ae((function(e){return e.pipe(Y((function(e){if(e.code===uh)t.emit("tokenExpired"),t.apClient.apFinish$.next(void 0);else if(wa(e))throw e})),Wc(Nd.getParameter("RECONNECTING_AP_INTERVAL")),ob(uc(7e3)))})),Y((function(e){t.log("An edge info got %o",e)}))).pipe(Xl((function(e,t){return[].concat(I(e),[t])}),[]),Z((function(e){return(e=Kq(e,(function(e){return nm(i,e.ip)}))).length-1>=t.ipIterator?e.slice(-t.ipIterator++-1)[0]:(t.ipIterator=0,e.slice(-1)[0])})),rd(),eb((function(n){if(void 0===n)return ba(Error("Invalid edge info"));var i=new Vk(n.ip,e,n.ticket,t.context,t.logger,r);return i.on("connectionFailure",(function(){return t.onSocketConnectionFailure(i)})),r=!i.useCnDomain,i.open$.pipe(bf(i))})),Y((function(n){t.log("The websocket of ENV_%d re-opened to %s:%d using ap",n.env,n.ip,Me[n.env]),t.curOpenSockets[e]=n,t.lastOpenSockets[e].next(n)})),eb((function(n){return n.open$.pipe(Y((function(){t.log("The websocket of ENV_%d re-opened to %s:%d",n.env,n.ip,Me[n.env]),t.curOpenSockets[e]=n,t.lastOpenSockets[e].next(n)})))})),be()),e===this.firstEnv?this.firstOpenKeeperSubject.next(n):this.secondOpenKeeperSubject.next(n)}}}]),t}(vb()),Qc=bc.Writer,ma=bc.util,tc=bc.roots.default||(bc.roots.default={}),iC=tc.Session=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.sid="",e.prototype.userId="",e.prototype.lts=ma.Long?ma.Long.fromBits(0,0,!1):0,e.prototype.elapse=ma.Long?ma.Long.fromBits(0,0,!1):0,e.prototype.appId="",e.prototype.ver="",e.prototype.buildno=0,e.prototype.installId="",e.prototype.os=0,e.prototype.did="",e.prototype.index=null,e.prototype.token="",e.prototype.version=0,e.prototype.subVersion=0,e.encode=function(e,t){return t||(t=Qc.create()),null!=e.sid&&Object.hasOwnProperty.call(e,"sid")&&t.uint32(10).string(e.sid),null!=e.userId&&Object.hasOwnProperty.call(e,"userId")&&t.uint32(18).string(e.userId),null!=e.lts&&Object.hasOwnProperty.call(e,"lts")&&t.uint32(24).int64(e.lts),null!=e.elapse&&Object.hasOwnProperty.call(e,"elapse")&&t.uint32(32).int64(e.elapse),null!=e.appId&&Object.hasOwnProperty.call(e,"appId")&&t.uint32(42).string(e.appId),null!=e.ver&&Object.hasOwnProperty.call(e,"ver")&&t.uint32(50).string(e.ver),null!=e.buildno&&Object.hasOwnProperty.call(e,"buildno")&&t.uint32(56).int32(e.buildno),null!=e.installId&&Object.hasOwnProperty.call(e,"installId")&&t.uint32(66).string(e.installId),null!=e.os&&Object.hasOwnProperty.call(e,"os")&&t.uint32(128).int32(e.os),null!=e.did&&Object.hasOwnProperty.call(e,"did")&&t.uint32(138).string(e.did),null!=e.index&&Object.hasOwnProperty.call(e,"index")&&tc.Session.CommonIndex.encode(e.index,t.uint32(162).fork()).ldelim(),null!=e.token&&Object.hasOwnProperty.call(e,"token")&&t.uint32(170).string(e.token),null!=e.version&&Object.hasOwnProperty.call(e,"version")&&t.uint32(176).int32(e.version),null!=e.subVersion&&Object.hasOwnProperty.call(e,"subVersion")&&t.uint32(184).int32(e.subVersion),t},e.CommonIndex=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.index1="",e.prototype.index2="",e.prototype.index3="",e.encode=function(e,t){return t||(t=Qc.create()),null!=e.index1&&Object.hasOwnProperty.call(e,"index1")&&t.uint32(10).string(e.index1),null!=e.index2&&Object.hasOwnProperty.call(e,"index2")&&t.uint32(18).string(e.index2),null!=e.index3&&Object.hasOwnProperty.call(e,"index3")&&t.uint32(26).string(e.index3),t},e}(),e}(),jC=tc.Link=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.sid="",e.prototype.userId="",e.prototype.lts=ma.Long?ma.Long.fromBits(0,0,!1):0,e.prototype.elapse=ma.Long?ma.Long.fromBits(0,0,!1):0,e.prototype.ec=0,e.prototype.sc=0,e.prototype.destServerIp="",e.prototype.ackedServerIp="",e.prototype.responseTime=0,e.encode=function(e,t){return t||(t=Qc.create()),null!=e.sid&&Object.hasOwnProperty.call(e,"sid")&&t.uint32(10).string(e.sid),null!=e.userId&&Object.hasOwnProperty.call(e,"userId")&&t.uint32(18).string(e.userId),null!=e.lts&&Object.hasOwnProperty.call(e,"lts")&&t.uint32(24).int64(e.lts),null!=e.elapse&&Object.hasOwnProperty.call(e,"elapse")&&t.uint32(32).int64(e.elapse),null!=e.ec&&Object.hasOwnProperty.call(e,"ec")&&t.uint32(40).int32(e.ec),null!=e.sc&&Object.hasOwnProperty.call(e,"sc")&&t.uint32(48).int32(e.sc),null!=e.destServerIp&&Object.hasOwnProperty.call(e,"destServerIp")&&t.uint32(58).string(e.destServerIp),null!=e.ackedServerIp&&Object.hasOwnProperty.call(e,"ackedServerIp")&&t.uint32(66).string(e.ackedServerIp),null!=e.responseTime&&Object.hasOwnProperty.call(e,"responseTime")&&t.uint32(72).int32(e.responseTime),t},e}(),kC=tc.Logout=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.sid="",e.prototype.userId="",e.prototype.lts=ma.Long?ma.Long.fromBits(0,0,!1):0,e.prototype.elapse=ma.Long?ma.Long.fromBits(0,0,!1):0,e.encode=function(e,t){return t||(t=Qc.create()),null!=e.sid&&Object.hasOwnProperty.call(e,"sid")&&t.uint32(10).string(e.sid),null!=e.userId&&Object.hasOwnProperty.call(e,"userId")&&t.uint32(18).string(e.userId),null!=e.lts&&Object.hasOwnProperty.call(e,"lts")&&t.uint32(24).int64(e.lts),null!=e.elapse&&Object.hasOwnProperty.call(e,"elapse")&&t.uint32(32).int64(e.elapse),t},e}(),lC=tc.KickedOff=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.sid="",e.prototype.userId="",e.prototype.lts=ma.Long?ma.Long.fromBits(0,0,!1):0,e.prototype.elapse=ma.Long?ma.Long.fromBits(0,0,!1):0,e.prototype.linkId=0,e.prototype.code=0,e.prototype.server="",e.prototype.serverCode=0,e.encode=function(e,t){return t||(t=Qc.create()),null!=e.sid&&Object.hasOwnProperty.call(e,"sid")&&t.uint32(10).string(e.sid),null!=e.userId&&Object.hasOwnProperty.call(e,"userId")&&t.uint32(18).string(e.userId),null!=e.lts&&Object.hasOwnProperty.call(e,"lts")&&t.uint32(24).int64(e.lts),null!=e.elapse&&Object.hasOwnProperty.call(e,"elapse")&&t.uint32(32).int64(e.elapse),null!=e.linkId&&Object.hasOwnProperty.call(e,"linkId")&&t.uint32(48).int32(e.linkId),null!=e.code&&Object.hasOwnProperty.call(e,"code")&&t.uint32(56).int32(e.code),null!=e.server&&Object.hasOwnProperty.call(e,"server")&&t.uint32(66).string(e.server),null!=e.serverCode&&Object.hasOwnProperty.call(e,"serverCode")&&t.uint32(72).int32(e.serverCode),t},e}(),mC=tc.ChnJoin=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.sid="",e.prototype.userId="",e.prototype.lts=ma.Long?ma.Long.fromBits(0,0,!1):0,e.prototype.elapse=ma.Long?ma.Long.fromBits(0,0,!1):0,e.prototype.cname="",e.prototype.errCode=0,e.encode=function(e,t){return t||(t=Qc.create()),null!=e.sid&&Object.hasOwnProperty.call(e,"sid")&&t.uint32(10).string(e.sid),null!=e.userId&&Object.hasOwnProperty.call(e,"userId")&&t.uint32(18).string(e.userId),null!=e.lts&&Object.hasOwnProperty.call(e,"lts")&&t.uint32(24).int64(e.lts),null!=e.elapse&&Object.hasOwnProperty.call(e,"elapse")&&t.uint32(32).int64(e.elapse),null!=e.cname&&Object.hasOwnProperty.call(e,"cname")&&t.uint32(50).string(e.cname),null!=e.errCode&&Object.hasOwnProperty.call(e,"errCode")&&t.uint32(56).int32(e.errCode),t},e}(),nC=tc.ChnJoinRes=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.sid="",e.prototype.userId="",e.prototype.lts=ma.Long?ma.Long.fromBits(0,0,!1):0,e.prototype.elapse=ma.Long?ma.Long.fromBits(0,0,!1):0,e.prototype.cname="",e.prototype.errCode=0,e.prototype.serverErrCode=0,e.encode=function(e,t){return t||(t=Qc.create()),null!=e.sid&&Object.hasOwnProperty.call(e,"sid")&&t.uint32(10).string(e.sid),null!=e.userId&&Object.hasOwnProperty.call(e,"userId")&&t.uint32(18).string(e.userId),null!=e.lts&&Object.hasOwnProperty.call(e,"lts")&&t.uint32(24).int64(e.lts),null!=e.elapse&&Object.hasOwnProperty.call(e,"elapse")&&t.uint32(32).int64(e.elapse),null!=e.cname&&Object.hasOwnProperty.call(e,"cname")&&t.uint32(50).string(e.cname),null!=e.errCode&&Object.hasOwnProperty.call(e,"errCode")&&t.uint32(56).int32(e.errCode),null!=e.serverErrCode&&Object.hasOwnProperty.call(e,"serverErrCode")&&t.uint32(64).int32(e.serverErrCode),t},e}(),oC=tc.ChnLeave=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.sid="",e.prototype.userId="",e.prototype.lts=ma.Long?ma.Long.fromBits(0,0,!1):0,e.prototype.elapse=ma.Long?ma.Long.fromBits(0,0,!1):0,e.prototype.cname="",e.prototype.errCode=0,e.encode=function(e,t){return t||(t=Qc.create()),null!=e.sid&&Object.hasOwnProperty.call(e,"sid")&&t.uint32(10).string(e.sid),null!=e.userId&&Object.hasOwnProperty.call(e,"userId")&&t.uint32(18).string(e.userId),null!=e.lts&&Object.hasOwnProperty.call(e,"lts")&&t.uint32(24).int64(e.lts),null!=e.elapse&&Object.hasOwnProperty.call(e,"elapse")&&t.uint32(32).int64(e.elapse),null!=e.cname&&Object.hasOwnProperty.call(e,"cname")&&t.uint32(50).string(e.cname),null!=e.errCode&&Object.hasOwnProperty.call(e,"errCode")&&t.uint32(56).int32(e.errCode),t},e}(),pC=tc.ConnectionStateChange=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.sid="",e.prototype.userId="",e.prototype.lts=ma.Long?ma.Long.fromBits(0,0,!1):0,e.prototype.elapse=ma.Long?ma.Long.fromBits(0,0,!1):0,e.prototype.oldState=0,e.prototype.newState=0,e.prototype.reason=0,e.prototype.reconnId=0,e.encode=function(e,t){return t||(t=Qc.create()),null!=e.sid&&Object.hasOwnProperty.call(e,"sid")&&t.uint32(10).string(e.sid),null!=e.userId&&Object.hasOwnProperty.call(e,"userId")&&t.uint32(18).string(e.userId),null!=e.lts&&Object.hasOwnProperty.call(e,"lts")&&t.uint32(24).int64(e.lts),null!=e.elapse&&Object.hasOwnProperty.call(e,"elapse")&&t.uint32(32).int64(e.elapse),null!=e.oldState&&Object.hasOwnProperty.call(e,"oldState")&&t.uint32(40).int32(e.oldState),null!=e.newState&&Object.hasOwnProperty.call(e,"newState")&&t.uint32(48).int32(e.newState),null!=e.reason&&Object.hasOwnProperty.call(e,"reason")&&t.uint32(56).int32(e.reason),null!=e.reconnId&&Object.hasOwnProperty.call(e,"reconnId")&&t.uint32(64).int32(e.reconnId),t},e}(),zt=Object.freeze({__proto__:null,Session:iC,Link:jC,Logout:kC,KickedOff:lC,ChnJoin:mC,ChnJoinRes:nC,ChnLeave:oC,ConnectionStateChange:pC,default:tc}),At=Object.freeze({__proto__:null,Counter:1,ApiExec:154,Session:164,ApEvent:165,Link:166,Logout:167,TxMessage:168,RxMessage:169,KickedOff:170,TxMessageRes:171,ChnJoin:172,ChnJoinRes:173,ChnLeave:174,ChnGetMembers:175,ChnGetMembersRes:176,ChnMemberJoined:177,ChnMemberLeft:178,QueryPeersOnlineStatus:179,QueryPeersOnlineStatusRes:180,RenewToken:181,OperateAttribute:186,OperateAttributeRes:187,ApRequest:188,LinkTcpEvent:189,LinkLoginRequest:190,ConnectionStateChange:191,default:{Counter:1,ApiExec:154,Session:164,ApEvent:165,Link:166,Logout:167,TxMessage:168,RxMessage:169,KickedOff:170,TxMessageRes:171,ChnJoin:172,ChnJoinRes:173,ChnLeave:174,ChnGetMembers:175,ChnGetMembersRes:176,ChnMemberJoined:177,ChnMemberLeft:178,QueryPeersOnlineStatus:179,QueryPeersOnlineStatusRes:180,RenewToken:181,OperateAttribute:186,OperateAttributeRes:187,ApRequest:188,LinkTcpEvent:189,LinkLoginRequest:190,ConnectionStateChange:191}}),qC=function(e){function t(e,i){return W(this,t),m(n(i=r.call(this,i,"Context")),"_token",void 0),m(n(i),"areaConfig",void 0),m(n(i),"_uid",void 0),m(n(i),"_sid",void 0),m(n(i),"_area",void 0),m(n(i),"appId",void 0),i.appId=e,i}ka(t,e);var r=la(t);return Ea(t,[{key:"token",set:function(e){this._token="string"==typeof e&&e?e:void 0}},{key:"uid",get:function(){if("string"==typeof this._uid&&this._uid)return this._uid;throw new Da("Cannot get illegal uid")},set:function(e){if(this.log("The user ID is set to %s",e),!ua(e))throw new Da;this._uid=e}},{key:"key",get:function(){if("string"==typeof this._token&&this._token)return this._token;if("string"==typeof this.appId&&this.appId)return this.appId;throw new Da("Cannot get illegal key")}},{key:"sid",get:function(){if("string"==typeof this._sid&&this._sid)return this._sid;throw new Da("Cannot get illegal sid")},set:function(e){if(this.log("sid is set to %s",e),"string"!=typeof e||!e)throw new Da;this._sid=e}},{key:"area",get:function(){if("string"==typeof this._area&&this._area)return this._area;throw new Da("Cannot get illegal area")},set:function(e){this.log("area is set to %s",e),"string"==typeof e&&e?this._area=e:this.warn("set area failed")}},{key:"setAreaConfig",value:function(e){if(0===e.CODES.size)throw new Da("Cannot set illegal areas");this.log("areas set to %s",I(e.CODES).join(", ")),this.areaConfig=e}}]),t}(vb()),rC=!!wc&&O((function(){wc.prototype.finally.call({then:function(){}},(function(){}))}));N({target:"Promise",proto:!0,real:!0,forced:rC},{finally:function(e){var t=Yc(this,Wb("Promise")),n="function"==typeof e;return this.then(n?function(n){return Hg(t,e()).then((function(){return n}))}:e,n?function(n){return Hg(t,e()).then((function(){throw n}))}:e)}}),"function"!=typeof wc||wc.prototype.finally||Va(wc.prototype,"finally",Wb("Promise").prototype.finally);var sC=function(){var e=K(w.mark((function e(t){return w.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=Uint8Array,e.next=3,crypto.subtle.digest("SHA-256",t);case 3:return e.t1=e.sent,e.abrupt("return",new e.t0(e.t1));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),tr=function(e){return Array.from(e).map((function(e){return e.toString(16).padStart(2,"0")})).join("")},tC=function(e){if("string"!=typeof e)throw new TypeError("Expected input to be a string");if(0!=e.length%2)throw new RangeError("Expected string to be an even number of characters");for(var t=new Uint8Array(e.length/2),n=0;n<e.length;n+=2)t[n/2]=parseInt(e.substring(n,n+2),16);return t},ur=function(e){return btoa(String.fromCharCode.apply(String,I(e))).replace(/={1,2}$/,"")},vr=function(){var e=K(w.mark((function e(t){var n;return w.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,crypto.subtle.digest("SHA-1",t);case 3:n=e.sent,e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),n=sha1.arrayBuffer(t);case 9:return e.abrupt("return",ur(new Uint8Array(n)));case 10:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t){return e.apply(this,arguments)}}(),wr=function(e,t,n,r){r[t]=!0,n.has(e)?n.get(e).add(t):n.set(e,new Set([t]))},uC=function(e){switch(e){case"89504E47":return"image/png";case"47494638":return"image/gif";case"25504446":return"application/pdf";case"FFD8FFDB":case"FFD8FFE0":case"FFD8FFE1":return"image/jpeg";case"504B0304":return"application/zip";default:return"application/octet-stream"}},xr=function(e){function t(e,i,o,a){W(this,t);var s=r.call(this,o,"ChunkDownloadManager");if(m(n(s),"abortController",new AbortController),m(n(s),"downloadedSize",0),m(n(s),"successCount",0),m(n(s),"timer",void 0),m(n(s),"chunks",[]),m(n(s),"retUnit",void 0),m(n(s),"singleThread",!1),m(n(s),"initialized",!1),m(n(s),"ee",void 0),m(n(s),"chunkCount",void 0),m(n(s),"aborted",!1),m(n(s),"serverToIndices",new Map),m(n(s),"backupToIndices",new Map),m(n(s),"indexToBackupServers",[]),m(n(s),"busyBackupServers",new Map),m(n(s),"downloadingChunks",new Set),m(n(s),"metaInfo",void 0),m(n(s),"transHandler",void 0),s.metaInfo=e,s.transHandler=i,s.ee=void 0===a?new aa:a,o=e.size,e=e.unit,0===o)throw new Da("size cannot be 0");return void 0!==i.cancelSignal&&i.cancelSignal.addEventListener("abort",(function(){s.abortController.abort()}),{once:!0}),s.abortController.signal.addEventListener("abort",(function(){s.aborted=!0}),{once:!0}),s.chunkCount=Math.ceil(o/(32768*e)),s}ka(t,e);var r=la(t);return Ea(t,[{key:"setInfoByResponse",value:function(e){var t=this,n=e.serverList,r=e.backupList;if(e=e.unit,n.length<this.chunkCount&&r.length<this.chunkCount)throw new Da("servers is not enough");this.updateProgress(0),this.initialized=!0;var i=Array(this.chunkCount).fill(!1);if(n.forEach((function(e,n){return e.forEach((function(e){return wr(e,n,t.serverToIndices,i)}))})),r.forEach((function(e,n){return e.forEach((function(e){return wr(e,n,t.backupToIndices,i)}))})),i.some((function(){return!1})))throw new ca("Not enough servers to download",Xf);this.indexToBackupServers=r.map((function(e){return new Set(e)})),this.retUnit=e}},{key:"downloadChunks",value:function(){this.aborted?this.warn("downloadChunks after abort, ignored"):1===this.serverToIndices.size&&0===Array.from(this.serverToIndices.keys())[0]?this.serversDownload(this.backupToIndices):1<=this.serverToIndices.size?this.serversDownload(this.serverToIndices,!0):this.ee.emit("error",new ca("not enough servers to download",Xf))}},{key:"updateProgress",value:function(e){var t=this,n=this.downloadedSize+e;this.downloadedSize>this.metaInfo.size?(this.warn("Invalid download size, overflowed"),this.ee.emit("error",new Pc("Invalid download size",Xf))):(this.downloadedSize=n,void 0!==this.timer&&0!==e&&(clearTimeout(this.timer),this.timer=void 0),void 0===this.timer&&this.successCount!==this.chunkCount&&(this.timer=setTimeout((function(){t.ee.emit("timedOut"),t.abortController.abort()}),12e4)),this.initialized&&0===e||void 0===this.transHandler.onOperationProgress||this.transHandler.onOperationProgress({totalSize:this.metaInfo.size,currentSize:this.downloadedSize}))}},{key:"getPayload",value:function(){for(var e=0,t=0,n=this.chunks;t<n.length;t++)e+=n[t].byteLength;if(e!==this.metaInfo.size)throw new Da("invalid chunks total size");e=new Uint8Array(e),n=t=0;for(var r=this.chunks;n<r.length;n++){var i=r[n];e.set(new Uint8Array(i),t),t+=i.byteLength}return t=Array.from(e.subarray(0,4)).map((function(e){return e.toString(16)})).join("").toUpperCase(),ut(e.buffer,uC(t))}},{key:"getDownloadUrl",value:function(e){var t=this.metaInfo.isAreaCN?"agoraio.cn":"agora.io";return"https://".concat(ng(e).split(".").join("-"),".edge.").concat(t,":9601/api/v1/chuck/download")}},{key:"serversDownload",value:function(){var e=K(w.mark((function e(t){var n,r=this,i=arguments;return w.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=1<i.length&&void 0!==i[1]&&i[1],e.next=3,Promise.all(Array.from(t.entries()).map((function(e){return e=pa(e,2),r.postDownloadRequest(e[0],Array.from(e[1]),n).catch((function(e){404===e.statusCode?(r.ee.emit("notExist"),r.abortController.abort()):"AbortError"!==e.name&&(Na(e)?r.singleThread?(r.abortController.abort(),r.ee.emit("timedOut")):(r.warn("%d download timed out after %d, retrying use single thread",e.index,r.singleThread?6e4:3e4),r.abortController.abort(),r.singleThread=!0,r.ee.emit("multiTimeOut")):(r.ee.emit("error",e),r.abortController.abort()))}))})));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"postDownloadRequest",value:function(){var e=K(w.mark((function e(t,n,r){var i,o,a,s,c,u,l,d,h,f=this;return w.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(h=function(){return(h=K(w.mark((function e(o){var a,h,f,p,A,g,v,m,y;return w.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,void 0!==o||0!==t){e.next=5;break}throw new Da("Invalid serverIp");case 5:a=void 0===o?l.getDownloadUrl(t):o;case 6:return l.downloadingChunks.add(i),e.next=9,u(a);case 9:return h=e.sent,f=h.responseData,l.downloadingChunks.delete(i),e.abrupt("return",f);case 15:if(e.prev=15,e.t0=e.catch(0),l.downloadingChunks.delete(i),n.unshift(i),l.metaInfo.isAreaCN=!1,"AbortError"!==e.t0.name){e.next=22;break}throw e.t0;case 22:if(!Na(e.t0)){e.next=25;break}throw e.t0.index=i,e.t0;case 25:if(p=s,s+=1,!(2>p)){e.next=30;break}return e.t0 instanceof Da||l.warn("%o, %d download failed, retrying",e.t0,i),e.abrupt("return",d());case 30:if(504!==e.t0.statusCode){e.next=34;break}throw(A=new bb("download server timed out",{originalError:e.t0,serverCode:504})).index=i,A;case 34:if(!r||2!==p||0===c[0]){e.next=45;break}return e.t0 instanceof Da||l.warn("%d download failed, using backup: %d, %o",i,c[0],e.t0),e.next=38,l.busyBackupServers.get(c[0]);case 38:return g=d(l.getDownloadUrl(c[0])),l.busyBackupServers.set(c[0],g),e.next=42,g;case 42:return v=e.sent,l.busyBackupServers.delete(c[0]),e.abrupt("return",v);case 45:if(!(r&&2<p&&void 0!==c[1]&&0!==c[1])){e.next=56;break}return l.warn("%d download failed, using backup 1: %d",i,c[1]),e.next=49,l.busyBackupServers.get(c[1]);case 49:return m=d(l.getDownloadUrl(c[1])),l.busyBackupServers.set(c[1],m),e.next=53,m;case 53:return y=e.sent,l.busyBackupServers.delete(c[1]),e.abrupt("return",y);case 56:throw e.t0.index=i,e.t0;case 58:case"end":return e.stop()}}),e,null,[[0,15]])})))).apply(this,arguments)},d=function(e){return h.apply(this,arguments)},!this.aborted){e.next=4;break}throw new Da("download already aborted");case 4:if(void 0!==(i=n.shift())){e.next=8;break}return this.log("%s download finished",t),e.abrupt("return");case 8:if(!(this.singleThread&&0<this.downloadingChunks.size)){e.next=10;break}return e.abrupt("return");case 10:if(!this.downloadingChunks.has(i)){e.next=13;break}return this.log("%s already downloading, return",i),e.abrupt("return");case 13:if(void 0===this.chunks[i]){e.next=19;break}return this.successCount===this.chunkCount&&(this.log("chunks all download"),this.ee.emit("finished")),this.log("%s already downloaded, do next",i),e.next=18,this.postDownloadRequest(t,n,r);case 18:return e.abrupt("return");case 19:return o=new FormData,a={hash:Bt(this.metaInfo.hashHexStr),unit:void 0===this.retUnit?this.metaInfo.unit:this.retUnit,instance:this.metaInfo.instance,loginOpt:this.metaInfo.loginOpt,ticket:this.metaInfo.ticket,index:i},o.append("parameter",JSON.stringify(a)),s=0,c=Array.from(this.indexToBackupServers[i]),u=function(e){return gf(e,{body:o,signal:f.abortController.signal,timeout:f.singleThread?12e4:3e4},{useBinaryResponse:!0})},l=this,e.next=28,d().then((function(e){return void 0!==f.chunks[i]?f.log("chunk %d download duplicated",i):(f.chunks[i]=e,f.log("chunk %d downloaded",i),f.successCount+=1,f.updateProgress(f.chunks[i].byteLength)),f.successCount===f.chunkCount&&(f.log("chunks all download"),f.ee.emit("finished")),f.singleThread?(f.downloadChunks(),Promise.resolve()):f.postDownloadRequest(t,n,r)}));case 28:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()}]),t}(vb()),yr=function(e){function t(e,i,o,a){W(this,t);var s=r.call(this,o,"ChunkUploadManager");if(m(n(s),"chunkCount",0),m(n(s),"chunks",[]),m(n(s),"uploadedChunks",[]),m(n(s),"totalFailures",0),m(n(s),"timer",void 0),m(n(s),"initState","uninitialized"),m(n(s),"ee",void 0),m(n(s),"unit",0),m(n(s),"uploadedSize",0),m(n(s),"singleThread",!1),m(n(s),"abortController",new AbortController),m(n(s),"servers",[]),m(n(s),"aborted",!1),m(n(s),"metaInfo",void 0),m(n(s),"transHandler",void 0),s.metaInfo=e,s.transHandler=i,s.ee=void 0===a?new aa:a,0===e.file.length)throw new L("file not found or is empty",jf);return void 0!==i.cancelSignal&&i.cancelSignal.addEventListener("abort",(function(){s.abortController.abort()}),{once:!0}),s.abortController.signal.addEventListener("abort",(function(){s.aborted=!0}),{once:!0}),s}ka(t,e);var r=la(t);return Ea(t,[{key:"initChunks",value:function(){var e=K(w.mark((function e(t){var n,r,i,o,a,s=this;return w.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("initialized"!==this.initState&&"initializing"!==this.initState){e.next=2;break}throw new Da("cannot re-initialize");case 2:for(this.initState="initializing",this.unit=t,n=this.sliceFile(t,this.metaInfo.file),this.chunkCount=n.length,r=[],i=function(e,t){var n=(e=pa(t[e],2))[0],i=e[1];e=vr(i).then((function(e){s.chunks[n]={payload:i,sha1:e,uploadedTo:void 0,index:n,processed:!1}})),r.push(e)},o=0,a=Array.from(n.entries());o<a.length;o++)i(o,a);return e.next=11,Promise.all(r);case 11:this.updateProgress(0),this.initState="initialized",this.log("upload chunks initialized");case 14:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"uploadToServers",value:function(){var e=this;if(!this.aborted){for(var t=this.chunks.filter((function(e){return!e.processed})),n=function(n){var r=t[n],i=e.servers.filter((function(e){return!e.isUploading})).sort((function(e,t){return e.successCount-t.successCount})).sort((function(e,t){return e.failureCount-t.failureCount}))[0];if(void 0===i||1<i.failureCount)return e.log("Upload server not available, waiting"),e.ee.emit("serverUsedUp"),tm(1e3).then((function(){e.totalFailures>2*e.chunkCount&&e.ee.emit("error"),e.totalFailures+=1,void 0!==i&&(i.failureCount=0),e.uploadToServers()})).catch((function(){})),"break";r.processed=!0,i.isUploading=!0,e.log("uploading chunk %d to server %s",r.index,ng(i.ip));var o=e.getUploadUrl(i.ip);return K(w.mark((function t(){var n;return w.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.postChunk(r.payload,o,r.index);case 3:n=e.chunks.findIndex((function(e){return e===r})),r.uploadedTo=i.ip,e.chunks.splice(n,1),e.uploadedChunks.push(r),i.successCount+=1,i.isUploading=!1,e.updateProgress(r.payload.byteLength),e.log("upload chunk %d successfully",r.index),t.next=31;break;case 13:if(t.prev=13,t.t0=t.catch(0),i.isUploading=!1,r.processed=!1,504!==t.t0.statusCode&&!Na(t.t0)){t.next=27;break}if(e.singleThread){t.next=24;break}return e.warn("%d upload timed out after %d, retrying use single thread",r.index,e.singleThread?12e4:3e4),e.abortController.abort(),e.singleThread=!0,e.ee.emit("multiTimeOut"),t.abrupt("return");case 24:return e.ee.emit("timedOut"),e.abortController.abort(),t.abrupt("return");case 27:return e.metaInfo.isAreaCN=!1,i.failureCount+=1,t.next=31,tm(1e3);case 31:e.uploadedChunks.length===e.chunkCount?(e.log("chunks uploaded"),e.ee.emit("finished")):(e.singleThread||1===e.chunks.filter((function(e){return!e.processed})).length)&&e.uploadToServers();case 32:case"end":return t.stop()}}),t,null,[[0,13]])})))(),e.singleThread?"break":void 0},r=0;r<t.length&&"break"!==n(r);r++);0===t.length&&this.uploadedChunks.length!==this.chunkCount&&this.log("%d chunks left uploading",this.chunkCount-this.uploadedChunks.length)}}},{key:"getUploadServerIPs",value:function(){var e=!0,t=[],n=this.uploadedChunks.sort((function(e,t){return e.index-t.index})),r=0;for(n=Array.from(n.values());r<n.length;r++){var i=n[r].uploadedTo;if(void 0===i){e=!1;break}t.push(i)}if(!e)throw new Da("some chunks not uploaded, cannot get upload server ips");return t}},{key:"addServers",value:function(e){var t=this;e.forEach((function(e){var n=t.servers.findIndex((function(t){return t.ip===e}));-1!==n?t.servers[n].failureCount=0:(t.log("server %s added",ng(e)),t.servers.push({successCount:0,isUploading:!1,ip:e,failureCount:0}))}))}},{key:"updateProgress",value:function(e){var t=this,n=void 0!==e?this.uploadedSize+e:this.metaInfo.file.length;n>this.metaInfo.file.length?(this.warn("Invalid upload size, overflowed"),this.ee.emit("error",new Pc("Invalid upload size",Wf))):(this.uploadedSize=n,void 0!==this.timer&&0!==e&&(clearTimeout(this.timer),this.timer=void 0),void 0===this.timer&&void 0!==e&&this.uploadedChunks.length!==this.chunkCount&&(this.timer=setTimeout((function(){t.ee.emit("timedOut"),t.abortController.abort()}),12e4)),"initialized"===this.initState&&0===e||void 0===this.transHandler.onOperationProgress||this.transHandler.onOperationProgress({totalSize:this.metaInfo.file.length,currentSize:this.uploadedSize}))}},{key:"sliceFile",value:function(e,t){var n=0,r=[],i=t.length;for(e*=32768;n<i;)r.push(t.slice(n,n+e)),n+=e;return this.log("chunks split into %d",r.length),r}},{key:"postChunk",value:function(){var e=K(w.mark((function e(t,n,r){var i,o,a,s,c,u,l;return w.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.aborted){e.next=2;break}throw new Da("upload already aborted");case 2:if(void 0!==this.unit){e.next=4;break}throw new Da("unit is undefined");case 4:return i=this.metaInfo,o=i.ticket,a=i.instance,s=i.loginOpt,c=i.hashStr,e.t0=r,e.t1=c,e.next=9,vr(t);case 9:return e.t2=e.sent,e.t3=this.unit,e.t4=o,e.t5=a,e.t6=s,u={index:e.t0,hash:e.t1,sha1:e.t2,unit:e.t3,ticket:e.t4,instance:e.t5,loginOpt:e.t6},(l=new FormData).append("parameter",JSON.stringify(u)),l.append("payload",new Blob([t])),e.next=20,gf(n,{headers:{Accept:"application/json"},body:l,timeout:this.singleThread?12e4:3e4,signal:this.abortController.signal});case 20:if(201===e.sent.status){e.next=24;break}throw new ca("uploading chunk ".concat(r," failed"));case 24:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"getUploadUrl",value:function(e){var t=this.metaInfo.isAreaCN?"agoraio.cn":"agora.io";return"https://".concat(ng(e).split(".").join("-"),".edge.").concat(t,":9601/api/v1/chuck/upload")}}]),t}(vb()),zr=function(e){function t(e){W(this,t);var i=r.call(this,e,"MediaTaskManager");return m(n(i),"isProcessing",!1),m(n(i),"authInfo",void 0),m(n(i),"taskFinishers",{}),m(n(i),"mediaTasks",new Map),m(n(i),"ongoingTask",void 0),i.on("connectionStateChanged",(function(e){if(e===S.ConnectionState.ABORTED||e===S.ConnectionState.DISCONNECTED){void 0!==i.ongoingTask&&i.cancelTask(i.ongoingTask),e=0;for(var t=Array.from(i.mediaTasks.entries());e<t.length;e++){var n=pa(t[e],2)[1];i.cancelTask(n)}i.mediaTasks.clear(),i.taskFinishers={}}else e===S.ConnectionState.RECONNECTING?void 0!==i.ongoingTask&&i.ongoingTask.manager.abortController.abort():e===S.ConnectionState.CONNECTED&&void 0!==i.ongoingTask&&i.ongoingTask.manager.ee.emit("reconnected")})),i}ka(t,e);var r=la(t);return Ea(t,[{key:"setAuthInfo",value:function(e){this.authInfo=e}},{key:"waitMediaTask",value:function(e){var t=this;return new Promise((function(n,r){t.taskFinishers[e]={resolve:n,reject:r},t.isProcessing||t.processMediaTask()})).finally((function(){void 0!==t.ongoingTask&&void 0!==t.ongoingTask.manager.timer&&clearTimeout(t.ongoingTask.manager.timer),delete t.taskFinishers[e],0!==t.mediaTasks.size?t.processMediaTask():t.isProcessing=!1}))}},{key:"addUploadTask",value:function(e,n,r,i){var o=e.file;if(e=e.hash,void 0===this.authInfo)throw new Da("session not found");if(this.mediaTasks.size>=t.MAX_PENDING_TASK_COUNT-1)throw new gb("Upload media failed, exceed max pending jobs",Wz);return i=new yr({hashStr:ur(e),file:o,ticket:this.authInfo.ticket,instance:this.authInfo.instance.toString(),loginOpt:this.authInfo.loginOpt.toString(),isAreaCN:this.authInfo.isAreaCN},i,this.logger),o=Id(),this.mediaTasks.set(o,{type:"UPLOAD",manager:i,hash:e,setter:r,fetcher:n,taskId:o}),o}},{key:"addDownloadTask",value:function(e,n,r){var i=e.hashHexStr,o=e.size,a=e.unit;if(e=e.zone,void 0===this.authInfo)throw new Da("session not found");if(this.mediaTasks.size>=t.MAX_PENDING_TASK_COUNT-1)throw new gb("Download media failed, exceed max pending jobs",$z);return r=new xr({hashHexStr:i,ticket:this.authInfo.ticket,isAreaCN:this.authInfo.isAreaCN,instance:this.authInfo.instance.toString(),loginOpt:this.authInfo.loginOpt.toString(),size:o,zone:e,unit:a},r,this.logger),i=Id(),this.mediaTasks.set(i,{type:"DOWNLOAD",manager:r,fetcher:n,taskId:i}),i}},{key:"doDownloadTaskImpl",value:function(){var e=K(w.mark((function e(t,n){var r,i,o,a,s,c,u,l,d=this,h=arguments;return w.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=2<h.length&&void 0!==h[2]&&h[2],o=i=t.manager,r&&(i=new xr(o.metaInfo,o.transHandler,this.logger,o.ee)),a=t.fetcher,e.next=7,a();case 7:if(s=e.sent,c=s.serverList,u=s.backupList,l=s.unit,!r||l===o.retUnit){e.next=13;break}throw new ca("download unit is different, reject to continue",Xf);case 13:r&&(t.manager=i,i.downloadedSize=o.downloadedSize,i.successCount=o.successCount,i.timer=o.timer,i.chunks=o.chunks,i.initialized=o.initialized,i.singleThread=o.singleThread,i.updateProgress(0)),i.ee.once("reconnected",(function(){i.ee.removeAllListeners(),d.doDownloadTaskImpl(t,n,!0).catch((function(e){n.reject(e)}))})),i.ee.once("multiTimeOut",(function(){i.ee.removeAllListeners(),d.doDownloadTaskImpl(t,n,!0).catch((function(e){n.reject(e)}))})),i.ee.once("error",(function(e){i.ee.removeAllListeners(),n.reject(new ca(["download file file, index %d",e.index],{code:Xf,originalError:e}))})),i.ee.once("notExist",(function(){i.abortController.abort(),i.ee.removeAllListeners(),n.reject(new ca("download file not found",Zz))})),i.ee.once("timedOut",(function(){i.ee.removeAllListeners(),i.abortController.abort(),n.reject(new bb("download timed out",Yz))})),void 0!==i.transHandler.cancelSignal&&i.transHandler.cancelSignal.addEventListener("abort",(function(){n.reject(new Qk("Downloading canceled",Iq))}),{once:!0}),i.ee.once("finished",(function(){n.resolve({type:"DOWNLOAD",payload:i.getPayload()})})),i.setInfoByResponse({serverList:c,backupList:u,unit:l}),i.downloadChunks();case 23:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"doDownloadTask",value:function(e,t){var n=this,r=2<arguments.length&&void 0!==arguments[2]&&arguments[2],i=e.taskId;return r||(this.mediaTasks.delete(i),this.ongoingTask=e),new Promise((function(i,o){n.doDownloadTaskImpl(e,t,r).then(i).catch(o)}))}},{key:"doUploadTaskImpl",value:function(){var e=K(w.mark((function e(t,n){var r,i,o,a,s,c,u,l,d=this,h=arguments;return w.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=2<h.length&&void 0!==h[2]&&h[2],o=i=t.manager,r&&(i=new yr(o.metaInfo,o.transHandler,this.logger,o.ee)),a=t.fetcher,s=new La,u=new Promise((function(e,u){var l=a(),d=l.ret,h=l.err,f=l.timeout;l.fin.pipe(ob(s)).subscribe({next:function(e){n.resolve({type:"UPLOAD",retUnit:e.unit,zone:e.zone})},complete:function(){e({hasExist:!0}),s.next(),s.complete()}}),d.pipe(ob(s),eb(function(){var e=K(w.mark((function e(a){var s,u;return w.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=a.servers,u=a.unit,r&&o.unit!==u?n.reject(new ca("upload unit is different, reject to continue",Wf)):r&&(t.manager=i,i.chunkCount=o.chunkCount,i.chunks=o.chunks,i.totalFailures=o.totalFailures,i.uploadedChunks=o.uploadedChunks,i.timer=o.timer,i.initState=o.initState,i.unit=o.unit,i.uploadedSize=o.uploadedSize,i.singleThread=o.singleThread,i.updateProgress(0)),i.addServers(s),"uninitialized"!==i.initState){e.next=7;break}return c=i.initChunks(u),e.next=7,c;case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())).subscribe({complete:function(){return e({hasExist:!1})},error:u}),l=function(t){"uninitialized"!==i.initState&&c?e(c.then((function(){return{hasExist:!1}}))):u(t)},h.pipe(ob(s)).subscribe({error:l}),f.pipe(ob(s)).subscribe({error:l})})),e.next=9,u;case 9:if(!e.sent.hasExist){e.next=15;break}return i.updateProgress(),this.log("file already exists, skipping upload"),e.abrupt("return");case 15:s.next(),s.complete(),this.log("chunks initialization promise resolved"),l=fb(i.ee,"serverUsedUp").pipe(at((function(){return i.chunkCount!==i.uploadedChunks.length})),dt(5e3,void 0,{leading:!1}),Vl((function(){return a().ret}))).subscribe((function(e){i.addServers(e.servers)})),i.ee.once("reconnected",(function(){i.ee.removeAllListeners(),d.doUploadTask(t,n,!0).catch((function(e){n.reject(e)}))})),i.ee.once("multiTimeOut",(function(){i.ee.removeAllListeners(),d.doUploadTask(t,n,!0).catch((function(e){n.reject(e)}))})),i.ee.once("timedOut",(function(){l.unsubscribe(),i.ee.removeAllListeners(),i.abortController.abort(),n.reject(new bb("upload timed out",vh))})),i.ee.once("error",(function(e){l.unsubscribe(),i.ee.removeAllListeners(),i.abortController.abort(),n.reject(e||new ca("upload error",Wf))})),void 0!==i.transHandler.cancelSignal&&i.transHandler.cancelSignal.addEventListener("abort",(function(){n.reject(new Qk("Uploading canceled",Hq))}),{once:!0}),i.ee.once("finished",K(w.mark((function e(){var r,o,a;return w.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l.unsubscribe(),e.next=3,t.setter(i.unit,i.getUploadServerIPs());case 3:r=e.sent,o=r.zone,a=r.unit,i.ee.removeAllListeners(),n.resolve({type:"UPLOAD",retUnit:a,zone:o});case 8:case"end":return e.stop()}}),e)})))),i.uploadToServers();case 26:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"doUploadTask",value:function(e,t){var n=this,r=2<arguments.length&&void 0!==arguments[2]&&arguments[2],i=e.taskId;return r||(this.mediaTasks.delete(i),this.ongoingTask=e),new Promise((function(i,o){n.doUploadTaskImpl(e,t,r).then(i).catch(o)}))}},{key:"processMediaTask",value:function(){var e=K(w.mark((function e(){var t,n,r;return w.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==this.mediaTasks.size){e.next=2;break}throw Error("no upload tasks");case 2:if(this.isProcessing=!0,t=this.mediaTasks.keys().next().value,void 0!==(n=this.taskFinishers[t])){e.next=7;break}throw Error("top task not found");case 7:if(void 0!==(r=this.mediaTasks.get(t))){e.next=10;break}throw new Da("task invalid");case 10:if("UPLOAD"!==r.type){e.next=15;break}return e.next=13,this.doUploadTask(r,n).catch((function(e){r.manager.ee.removeAllListeners(),n.reject(e)}));case 13:e.next=18;break;case 15:if("DOWNLOAD"!==r.type){e.next=18;break}return e.next=18,this.doDownloadTask(r,n).catch((function(e){r.manager.ee.removeAllListeners(),n.reject(e)}));case 18:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"cancelTask",value:function(e){var t="DOWNLOAD"===e.type?Iq:Hq;e.manager.ee.removeAllListeners(),e.manager.abortController.abort(),void 0!==this.taskFinishers[e.taskId]&&this.taskFinishers[e.taskId].reject(new Qk("User logged out or kicked off, media task canceled",t))}}]),t}(vb());m(zr,"MAX_PENDING_TASK_COUNT",9),Sn("of",(function(){for(var e=0,t=arguments.length,n=new(ve(this))(t);t>e;)n[e]=arguments[e++];return n}),ej);var Ar=1/0,vC=Math.max,Dt=function(e,t,n){var r=Object(e);if(!sd(e)){var i=Fe(t);e=Rc(e),t=function(e){return i(r[e],e,r)}}return-1<(t=function(e,t,n){var r=null==e?0:e.length;if(!r)return-1;if(null==n)n=0;else{var i=(n=n?(n=Pk(n))===Ar||n===-Ar?17976931348623157e292*(0>n?-1:1):n==n?n:0:0===n?n:0)%1;n=n==n?i?n-i:n:0}return 0>n&&(n=vC(r+n,0)),xp(e,Fe(t),n)}(e,t,n))?r[i?e[t]:t]:void 0},Ct=function(e,t){return e&&e.length?fk(e,void 0,"function"==typeof t?t:void 0):[]},Br=function(){function e(){W(this,e),m(this,"size",0),m(this,"fields",new Map)}return Ea(e,[{key:"define",value:function(e,t,n){if(this.size+=n,64<this.size)throw new RangeError("the struct over 64 bits is not supported");vg(t={val:0,isNumber:"number"===t,isBoolean:"boolean"===t,oneof:"number"===t||"boolean"===t?void 0:t,len:n}),this.fields.set(e,t)}},{key:"set",value:function(e,t){if(!(e=this.fields.get(e)))throw Error("field not found");var n=e.oneof;if(!U.isLong(t)&&"number"!=typeof t)if("boolean"==typeof t)t=t?1:0;else{if(void 0===n)throw Error("invalid field type");if(void 0===(t=n[t]))throw Error("field type not found")}vg(e,t),e.val=t}},{key:"toNumber",value:function(){for(var e=0,t=0,n=0,r=Array.from(this.fields);n<r.length;n++){var i=pa(r[n],2)[1],o=i.len;void 0!==(i=i.val)&&(e+=U.fromValue(i).shiftLeft(t).toNumber(),t+=o)}return e}},{key:"toLong",value:function(){for(var e=U.fromNumber(0,!0),t=0,n=0,r=Array.from(this.fields);n<r.length;n++){var i=pa(r[n],2)[1],o=i.len;void 0!==(i=i.val)&&(e=U.fromValue(i).shiftLeft(t).add(e),t+=o)}return e}},{key:"assert",value:function(e,t){function n(e){if(!U.isLong(e)&&"number"!=typeof e)if("boolean"==typeof e)e=e?1:0;else{if(void 0===i)throw Error("invalid field type");if(void 0===(e=i[e]))throw Error("field type not found")}return vg(r,e),ug(e,r.val)}var r=this.fields.get(e);if(!r)throw Error("field not found");var i=r.oneof;if(!Array.isArray(t))return n(t);if(1===t.length)return n(t[0]);if(t.every((function(e){return"string"==typeof e}))&&void 0!==i)return t.some((function(e){return n(e)}));throw Error("invalid valueTypes")}},{key:"from",value:function(e){e=U.fromValue(e);for(var t=0,n=0,r=Array.from(this.fields);n<r.length;n++){var i=pa(r[n],2)[1],o=i.len,a=U.fromNumber(Math.pow(2,o)-1,!0).shiftLeft(t);vg(i,a=e.and(a).shiftRightUnsigned(t)),i.val=a,t+=o}}},{key:"typeOf",value:function(e){if(void 0!==(e=this.fields.get(e))){var t=e.oneof;if(e=e.val,void 0!==t){var n=0;for(t=Object.entries(t);n<t.length;n++){var r=pa(t[n],2),i=r[0];if(ug(e,r[1]))return i}}}throw new TypeError("can only get type of oneof type")}}]),e}(),Cr=function(e){function t(e){W(this,t);var r=n.call(this);return r.define("Rejoin","boolean",1),r.define("Unused","number",31),r.define("Platform","number",8),r.define("Version","number",12),r.define("Subversion","number",12),r.set("Platform",7),r.set("Version",5),r.set("Subversion",301),r.set("Rejoin",e),r}ka(t,e);var n=la(t);return t}(Br),wC=Ja(Ja(Ja(Ja({},{PeerTextMessage:0,ChannelTextMessage:1,VendorTextMessage:2}),{PeerRawMessage:3,ChannelRawMessage:4,VendorRawMessage:5}),{PeerImageMessage:6,ChannelImageMessage:7,VendorImageMessage:8}),{PeerFileMessage:15,ChannelFileMessage:16,VendorFileMessage:17}),Dr={CallInvite:101,CallAccept:102,CallReject:103,CallCancel:104},xC=Ja(Ja({},wC),Dr),yC={Uncompressed:0,Zlib:1},Od=function(e){function t(e){W(this,t);var r=n.call(this);if(r.define("MessageType",xC,8),r.define("BroadcastJumps","number",2),r.define("ToCache","boolean",1),r.define("FromCache","boolean",1),r.define("CompressionMethod",yC,2),r.define("IterationNumber","number",4),r.define("BufferedMessage","boolean",1),r.define("ToArchive","boolean",1),r.define("FromArchive","boolean",1),"number"==typeof e||U.isLong(e))r.from(e);else if(void 0!==e){var i=0;for(e=dr(e);i<e.length;i++){var o=pa(e[i],2);r.set(o[0],o[1])}}return r}ka(t,e);var n=la(t);return Ea(t,[{key:"isTextMessage",value:function(){return this.assert("MessageType",["PeerTextMessage","ChannelTextMessage","VendorTextMessage"])}},{key:"isRawMessage",value:function(){return this.assert("MessageType",["ChannelRawMessage","PeerRawMessage","VendorRawMessage"])}},{key:"isRawPeerMessage",value:function(){return this.assert("MessageType","PeerRawMessage")}},{key:"isRawChannelMessage",value:function(){return this.assert("MessageType","ChannelRawMessage")}},{key:"isPeerTextMessage",value:function(){return this.assert("MessageType","PeerTextMessage")}},{key:"isChannelTextMessage",value:function(){return this.assert("MessageType","ChannelTextMessage")}},{key:"isInvitation",value:function(e){var t=this;return void 0!==e?this.assert("MessageType",e):Rk(Dr).some((function(e){return t.assert("MessageType",e)}))}},{key:"isFileMessage",value:function(){return this.assert("MessageType",["PeerFileMessage","ChannelFileMessage","VendorFileMessage"])}},{key:"isImageMessage",value:function(){return this.assert("MessageType",["PeerImageMessage","ChannelImageMessage","VendorImageMessage"])}},{key:"isPeerMessage",value:function(){return this.assert("MessageType",["PeerFileMessage","PeerTextMessage","PeerImageMessage","PeerRawMessage"])}},{key:"isZlibCompressed",value:function(){return this.assert("CompressionMethod","Zlib")}},{key:"isFromCache",value:function(){return this.assert("FromCache",!0)}},{key:"isBufferedMessage",value:function(){return this.assert("BufferedMessage",!0)}},{key:"getInvitationType",value:function(){if(!this.isInvitation())throw new TypeError("cannot get InvitationType of a normal message type");return this.typeOf("MessageType")}}]),t}(Br),zC=function(e){function t(e){return W(this,t),m(n(e=r.call(this,e,"ChatManager")),"dialogueLru",new px(void 0,{maxlen:1e4,ttl:1e4})),e}ka(t,e);var r=la(t);return Ea(t,[{key:"getChatInfo",value:function(e){var t=this.dialogueLru.get(e);if(this.dialogueLru.prune(),t){var n=t.dialogue,r={dialogue:n,sequence:t=t.sequence.add(1)};return this.dialogueLru.set(e,{dialogue:n,sequence:t}),r}return n={dialogue:lg(),sequence:U.fromNumber(1,!0)},this.dialogueLru.set(e,n),n}}]),t}(vb()),u={};"object"==("undefined"==typeof module?"undefined":R(module))&&(module.exports=u),u.parse=function(e,t){var n,r=u.bin.readUshort,i=u.bin.readUint,o={};for(n=(e=new Uint8Array(e)).length-4;101010256!=i(e,n);)n--;var a=r(e,n=n+4+4);r(e,n+=2),i(e,n+=2),n=i(e,n+=4);for(var s=0;s<a;s++){i(e,n),n+=4,n+=4,n+=4,i(e,n+=4);var c=i(e,n+=4),l=i(e,n+=4),d=r(e,n+=4),h=r(e,n+2),f=r(e,n+4);n+=6;var p=i(e,n+=8);n+=4,n+=d+h+f,u._readLocal(e,p,o,c,l,t)}return o},u._readLocal=function(e,t,n,r,i,o){var a=u.bin.readUshort,s=u.bin.readUint;s(e,t),a(e,t+=4),a(e,t+=2);var c=a(e,t+=2);s(e,t+=2),s(e,t+=4),s=a(e,t=t+4+8);var l=a(e,t+=2);if(t+=2,a=u.bin.readUTF8(e,t,s),t=t+s+l,o)n[a]={size:i,csize:r};else if(e=new Uint8Array(e.buffer,t),0==c)n[a]=new Uint8Array(e.buffer.slice(t,t+r));else{if(8!=c)throw"unknown compression method: "+c;t=new Uint8Array(i),u.inflateRaw(e,t),n[a]=t}},u.inflateRaw=function(e,t){return u.F.inflate(e,t)},u.inflate=function(e,t){return e[0],e[1],u.inflateRaw(new Uint8Array(e.buffer,e.byteOffset+2,e.length-2),t)},u.deflate=function(e,t){null==t&&(t={level:6});var n=0,r=new Uint8Array(50+Math.floor(1.1*e.length));return r[n]=120,r[n+1]=156,n=u.F.deflateRaw(e,r,n+2,t.level),e=u.adler(e,0,e.length),r[n+0]=e>>>24&255,r[n+1]=e>>>16&255,r[n+2]=e>>>8&255,r[n+3]=e>>>0&255,new Uint8Array(r.buffer,0,n+4)},u.deflateRaw=function(e,t){null==t&&(t={level:6});var n=new Uint8Array(50+Math.floor(1.1*e.length)),r=u.F.deflateRaw(e,n,r,t.level);return new Uint8Array(n.buffer,0,r)},u.encode=function(e,t){null==t&&(t=!1);var n,r=0,i=u.bin.writeUint,o=u.bin.writeUshort,a={};for(n in e){var s=!u._noNeed(n)&&!t,c=e[n],l=u.crc.crc(c,0,c.length);a[n]={cpr:s,usize:c.length,crc:l,file:s?u.deflateRaw(c):c}}for(n in a)r+=a[n].file.length+30+46+2*u.bin.sizeUTF8(n);for(n in e=new Uint8Array(r+22),t=0,c=[],a)l=a[n],c.push(t),t=u._writeHeader(e,t,n,l,0);for(n in r=0,s=t,a)l=a[n],c.push(t),t=u._writeHeader(e,t,n,l,1,c[r++]);return a=t-s,i(e,t,101010256),o(e,t=t+4+4,r),o(e,t+=2,r),i(e,t+=2,a),i(e,t+4,s),e.buffer},u._noNeed=function(e){return e=e.split(".").pop().toLowerCase(),-1!="png,jpg,jpeg,zip".indexOf(e)},u._writeHeader=function(e,t,n,r,i,o){var a=u.bin.writeUint,s=u.bin.writeUshort,c=r.file;return a(e,t,0==i?67324752:33639248),t+=4,1==i&&(t+=2),s(e,t,20),s(e,t+=2,0),s(e,t+=2,r.cpr?8:0),a(e,t+=2,0),a(e,t+=4,r.crc),a(e,t+=4,c.length),a(e,t+=4,r.usize),s(e,t+=4,u.bin.sizeUTF8(n)),s(e,t+=2,0),t+=2,1==i&&(a(e,t=t+2+2+6,o),t+=4),t+=n=u.bin.writeUTF8(e,t,n),0==i&&(e.set(c,t),t+=c.length),t},u.crc={table:function(){for(var e=new Uint32Array(256),t=0;256>t;t++){for(var n=t,r=0;8>r;r++)n=1&n?3988292384^n>>>1:n>>>1;e[t]=n}return e}(),update:function(e,t,n,r){for(var i=0;i<r;i++)e=u.crc.table[255&(e^t[n+i])]^e>>>8;return e},crc:function(e,t,n){return 4294967295^u.crc.update(4294967295,e,t,n)}},u.adler=function(e,t,n){var r=1,i=0,o=t;for(t+=n;o<t;){for(n=Math.min(o+5552,t);o<n;)i+=r+=e[o++];r%=65521,i%=65521}return i<<16|r},u.bin={readUshort:function(e,t){return e[t]|e[t+1]<<8},writeUshort:function(e,t,n){e[t]=255&n,e[t+1]=n>>8&255},readUint:function(e,t){return 16777216*e[t+3]+(e[t+2]<<16|e[t+1]<<8|e[t])},writeUint:function(e,t,n){e[t]=255&n,e[t+1]=n>>8&255,e[t+2]=n>>16&255,e[t+3]=n>>24&255},readASCII:function(e,t,n){for(var r="",i=0;i<n;i++)r+=String.fromCharCode(e[t+i]);return r},writeASCII:function(e,t,n){for(var r=0;r<n.length;r++)e[t+r]=n.charCodeAt(r)},pad:function(e){return 2>e.length?"0"+e:e},readUTF8:function(e,t,n){for(var r,i="",o=0;o<n;o++)i+="%"+u.bin.pad(e[t+o].toString(16));try{r=decodeURIComponent(i)}catch(r){return u.bin.readASCII(e,t,n)}return r},writeUTF8:function(e,t,n){for(var r=n.length,i=0,o=0;o<r;o++){var a=n.charCodeAt(o);if(0==(4294967168&a))e[t+i]=a,i++;else if(0==(4294965248&a))e[t+i]=192|a>>6,e[t+i+1]=128|a>>0&63,i+=2;else if(0==(4294901760&a))e[t+i]=224|a>>12,e[t+i+1]=128|a>>6&63,e[t+i+2]=128|a>>0&63,i+=3;else{if(0!=(4292870144&a))throw"e";e[t+i]=240|a>>18,e[t+i+1]=128|a>>12&63,e[t+i+2]=128|a>>6&63,e[t+i+3]=128|a>>0&63,i+=4}}return i},sizeUTF8:function(e){for(var t=e.length,n=0,r=0;r<t;r++){var i=e.charCodeAt(r);if(0==(4294967168&i))n++;else if(0==(4294965248&i))n+=2;else if(0==(4294901760&i))n+=3;else{if(0!=(4292870144&i))throw"e";n+=4}}return n}},u.F={},u.F.deflateRaw=function(e,t,n,r){var i=[[0,0,0,0,0],[4,4,8,4,0],[4,5,16,8,0],[4,6,16,16,0],[4,10,16,32,0],[8,16,32,32,0],[8,16,128,128,0],[8,32,128,256,0],[32,128,258,1024,1],[32,258,258,4096,1]][r],o=u.F.U,a=u.F._goodIndex;u.F._hash;var s=u.F._putsE,c=0;n<<=3;var l=0,d=e.length;if(0==r){for(;c<d;){var h=Math.min(65535,d-c);s(t,n,c+h==d?1:0),n=u.F._copyExact(e,c,h,t,n+8),c+=h}return n>>>3}s=o.lits,r=o.strt;var f=o.prev,p=0,A=0,g=0,v=0,m=0;for(2<d&&(r[m=u.F._hash(e,0)]=0),c=0;c<d;c++){if(h=m,c+1<d-2){m=u.F._hash(e,c+1);var y=c+1&32767;f[y]=r[m],r[m]=y}if(l<=c){if((14e3<p||26697<A)&&100<d-c&&(l<c&&(s[p]=c-l,p+=2,l=c),n=u.F._writeBlock(c==d-1||l==d?1:0,s,p,v,e,g,c-g,t,n),p=A=v=0,g=c),y=0,c<d-2&&(y=u.F._bestMatch(e,c,f,h,Math.min(i[2],d-c),i[3])),0!=y){h=y>>>16,y&=65535;var b=a(h,o.of0);o.lhst[257+b]++;var E=a(y,o.df0);o.dhst[E]++,v+=o.exb[b]+o.dxb[E],s[p]=h<<23|c-l,s[p+1]=y<<16|b<<8|E,p+=2,l=c+h}else o.lhst[e[c]]++;A++}}for(g==c&&0!=e.length||(l<c&&(s[p]=c-l,p+=2),n=u.F._writeBlock(1,s,p,v,e,g,c-g,t,n));0!=(7&n);)n++;return n>>>3},u.F._bestMatch=function(e,t,n,r,i,o){var a=32767&t,s=n[a],c=a-s+32768&32767;if(s==a||r!=u.F._hash(e,t-c))return 0;for(var l=r=0,d=Math.min(32767,t);c<=d&&0!=--o&&s!=a;){if((0==r||e[t+r]==e[t+r-c])&&(a=u.F._howLong(e,t,c))>r){if(l=c,(r=a)>=i)break;c+2<a&&(a=c+2);for(var h=0,f=0;f<a-2;f++){var p=t-c+f+32768&32767,A=p-n[p]+32768&32767;A>h&&(h=A,s=p)}}c+=(a=s)-(s=n[a])+32768&32767}return r<<16|l},u.F._howLong=function(e,t,n){if(e[t]!=e[t-n]||e[t+1]!=e[t+1-n]||e[t+2]!=e[t+2-n])return 0;var r=t,i=Math.min(e.length,t+258);for(t+=3;t<i&&e[t]==e[t-n];)t++;return t-r},u.F._hash=function(e,t){return(e[t]<<8|e[t+1])+(e[t+2]<<4)&65535},u.saved=0,u.F._writeBlock=function(e,t,n,r,i,o,a,s,c){var l=u.F.U,d=u.F._putsF,h=u.F._putsE;l.lhst[256]++;var f=u.F.getTrees(),p=f[0],A=f[1],g=f[2],v=f[3],m=f[4],y=f[5],b=f[6];f=f[7];var E=32+(0==(c+3&7)?0:8-(c+3&7))+(a<<3),_=r+u.F.contSize(l.fltree,l.lhst)+u.F.contSize(l.fdtree,l.dhst);r=r+u.F.contSize(l.ltree,l.lhst)+u.F.contSize(l.dtree,l.dhst),r+=14+3*y+u.F.contSize(l.itree,l.ihst)+(2*l.ihst[16]+3*l.ihst[17]+7*l.ihst[18]);for(var w=0;286>w;w++)l.lhst[w]=0;for(w=0;30>w;w++)l.dhst[w]=0;for(w=0;19>w;w++)l.ihst[w]=0;if(E=E<_&&E<r?0:_<r?1:2,d(s,c,e),d(s,c+1,E),c+=3,0==E){for(;0!=(7&c);)c++;c=u.F._copyExact(i,o,a,s,c)}else{if(1==E)var S=l.fltree,T=l.fdtree;if(2==E){for(u.F.makeCodes(l.ltree,p),u.F.revCodes(l.ltree,p),u.F.makeCodes(l.dtree,A),u.F.revCodes(l.dtree,A),u.F.makeCodes(l.itree,g),u.F.revCodes(l.itree,g),S=l.ltree,T=l.dtree,h(s,c,v-257),h(s,c+=5,m-1),h(s,c+=5,y-4),c+=4,e=0;e<y;e++)h(s,c+3*e,l.itree[1+(l.ordr[e]<<1)]);c=u.F._codeTiny(b,l.itree,s,c+3*y),c=u.F._codeTiny(f,l.itree,s,c)}for(y=0;y<n;y+=2){for(b=(e=t[y])>>>23,e=o+(8388607&e);o<e;)c=u.F._writeLit(i[o++],S,s,c);0!=b&&(e=(p=t[y+1])>>16,a=p>>8&255,p&=255,h(s,c=u.F._writeLit(257+a,S,s,c),b-l.of0[a]),c+=l.exb[a],d(s,c=u.F._writeLit(p,T,s,c),e-l.df0[p]),c+=l.dxb[p],o+=b)}c=u.F._writeLit(256,S,s,c)}return c},u.F._copyExact=function(e,t,n,r,i){var o=i>>>3;return r[o]=n,r[o+1]=n>>>8,r[o+2]=255-r[o],r[o+3]=255-r[o+1],o+=4,r.set(new Uint8Array(e.buffer,t,n),o),i+(n+4<<3)},u.F.getTrees=function(){for(var e=u.F.U,t=u.F._hufTree(e.lhst,e.ltree,15),n=u.F._hufTree(e.dhst,e.dtree,15),r=[],i=u.F._lenCodes(e.ltree,r),o=[],a=u.F._lenCodes(e.dtree,o),s=0;s<r.length;s+=2)e.ihst[r[s]]++;for(s=0;s<o.length;s+=2)e.ihst[o[s]]++;s=u.F._hufTree(e.ihst,e.itree,7);for(var c=19;4<c&&0==e.itree[1+(e.ordr[c-1]<<1)];)c--;return[t,n,s,i,a,c,r,o]},u.F.getSecond=function(e){for(var t=[],n=0;n<e.length;n+=2)t.push(e[n+1]);return t},u.F.nonZero=function(e){for(var t="",n=0;n<e.length;n+=2)0!=e[n+1]&&(t+=(n>>1)+",");return t},u.F.contSize=function(e,t){for(var n=0,r=0;r<t.length;r++)n+=t[r]*e[1+(r<<1)];return n},u.F._codeTiny=function(e,t,n,r){for(var i=0;i<e.length;i+=2){var o=e[i],a=e[i+1];r=u.F._writeLit(o,t,n,r);var s=16==o?2:17==o?3:7;15<o&&(u.F._putsE(n,r,a,s),r+=s)}return r},u.F._lenCodes=function(e,t){for(var n=e.length;2!=n&&0==e[n-1];)n-=2;for(var r=0;r<n;r+=2){var i=e[r+1],o=r+3<n?e[r+3]:-1,a=r+5<n?e[r+5]:-1,s=0==r?-1:e[r-1];if(0==i&&o==i&&a==i){for(o=r+5;o+2<n&&e[o+2]==i;)o+=2;11>(i=Math.min(o+1-r>>>1,138))?t.push(17,i-3):t.push(18,i-11),r+=2*i-2}else if(i==s&&o==i&&a==i){for(o=r+5;o+2<n&&e[o+2]==i;)o+=2;i=Math.min(o+1-r>>>1,6),t.push(16,i-3),r+=2*i-2}else t.push(i,0)}return n>>>1},u.F._hufTree=function(e,t,n){var r=[],i=e.length,o=t.length,a=0;for(a=0;a<o;a+=2)t[a]=0,t[a+1]=0;for(a=0;a<i;a++)0!=e[a]&&r.push({lit:a,f:e[a]});if(e=r.length,i=r.slice(0),0==e)return 0;if(1==e)return t[1+((n=r[0].lit)<<1)]=1,t[1+((0==n?1:0)<<1)]=1;r.sort((function(e,t){return e.f-t.f})),a=r[0],o=r[1];var s=0,c=1,l=2;for(r[0]={lit:-1,f:a.f+o.f,l:a,r:o,d:0};c!=e-1;)a=s!=c&&(l==e||r[s].f<r[l].f)?r[s++]:r[l++],o=s!=c&&(l==e||r[s].f<r[l].f)?r[s++]:r[l++],r[c++]={lit:-1,f:a.f+o.f,l:a,r:o};for((r=u.F.setDepth(r[c-1],0))>n&&(u.F.restrictDepth(i,n,r),r=n),a=0;a<e;a++)t[1+(i[a].lit<<1)]=i[a].d;return r},u.F.setDepth=function(e,t){return-1!=e.lit?e.d=t:Math.max(u.F.setDepth(e.l,t+1),u.F.setDepth(e.r,t+1))},u.F.restrictDepth=function(e,t,n){var r=0,i=1<<n-t,o=0;for(e.sort((function(e,t){return t.d==e.d?e.f-t.f:t.d-e.d})),r=0;r<e.length&&e[r].d>t;r++){var a=e[r].d;e[r].d=t,o+=i-(1<<n-a)}for(o>>>=n-t;0<o;)(a=e[r].d)<t?(e[r].d++,o-=1<<t-a-1):r++;for(;0<=r;r--)e[r].d==t&&0>o&&(e[r].d--,o++);0!=o&&console.log("debt left")},u.F._goodIndex=function(e,t){var n=0;return t[16|n]<=e&&(n|=16),t[8|n]<=e&&(n|=8),t[4|n]<=e&&(n|=4),t[2|n]<=e&&(n|=2),t[1|n]<=e&&(n|=1),n},u.F._writeLit=function(e,t,n,r){return u.F._putsF(n,r,t[e<<1]),r+t[1+(e<<1)]},u.F.inflate=function(e,t){var n=Uint8Array;if(3==e[0]&&0==e[1])return t||new n(0);var r=u.F,i=r._bitsF,o=r._bitsE,a=r._decodeTiny,s=r.makeCodes,c=r.codes2map,l=r._get17,d=r.U,h=null==t;h&&(t=new n(e.length>>>2<<3));for(var f,p,A,g,v=0,m=0,y=p=0,b=0;0==v;)if(v=i(e,b,1),f=i(e,b+1,2),b+=3,0==f)0!=(7&b)&&(b+=8-(7&b)),f=e[(b=4+(b>>>3))-4]|e[b-3]<<8,h&&(t=u.F._check(t,y+f)),t.set(new n(e.buffer,e.byteOffset+b,f),y),b=b+f<<3,y+=f;else{if(h&&(t=u.F._check(t,y+131072)),1==f&&(A=d.flmap,g=d.fdmap,m=511,p=31),2==f){for(p=o(e,b,5)+257,f=o(e,b+5,5)+1,A=o(e,b+10,4)+4,b+=14,g=0;38>g;g+=2)d.itree[g]=0,d.itree[g+1]=0;for(m=1,g=0;g<A;g++){var E=o(e,b+3*g,3);d.itree[1+(d.ordr[g]<<1)]=E,E>m&&(m=E)}b+=3*A,s(d.itree,m),c(d.itree,m,d.imap),A=d.lmap,g=d.dmap,b=a(d.imap,(1<<m)-1,p+f,e,b,d.ttree),m=(1<<(E=r._copyOut(d.ttree,0,p,d.ltree)))-1,p=(1<<(f=r._copyOut(d.ttree,p,f,d.dtree)))-1,s(d.ltree,E),c(d.ltree,E,A),s(d.dtree,f),c(d.dtree,f,g)}for(;;)if(b+=15&(f=A[l(e,b)&m]),0==(E=f>>>4)>>>8)t[y++]=E;else{if(256==E)break;f=y+E-254,264<E&&(f=y+((E=d.ldef[E-257])>>>3)+o(e,b,7&E),b+=7&E),b+=15&(E=g[l(e,b)&p]);var _=((E=d.ddef[E>>>4])>>>4)+i(e,b,15&E);for(b+=15&E,h&&(t=u.F._check(t,y+131072));y<f;)t[y]=t[y++-_],t[y]=t[y++-_],t[y]=t[y++-_],t[y]=t[y++-_];y=f}}return t.length==y?t:t.slice(0,y)},u.F._check=function(e,t){var n=e.length;return t<=n?e:((t=new Uint8Array(Math.max(n<<1,t))).set(e,0),t)},u.F._decodeTiny=function(e,t,n,r,i,o){for(var a=u.F._bitsE,s=u.F._get17,c=0;c<n;){var l=e[s(r,i)&t];i+=15&l;var d=l>>>4;if(15>=d)o[c]=d,c++;else{var h=l=0;for(16==d?(h=3+a(r,i,2),i+=2,l=o[c-1]):17==d?(h=3+a(r,i,3),i+=3):18==d&&(h=11+a(r,i,7),i+=7),d=c+h;c<d;)o[c]=l,c++}}return i},u.F._copyOut=function(e,t,n,r){for(var i=0,o=0,a=r.length>>>1;o<n;){var s=e[o+t];r[o<<1]=0,r[1+(o<<1)]=s,s>i&&(i=s),o++}for(;o<a;)r[o<<1]=0,r[1+(o<<1)]=0,o++;return i},u.F.makeCodes=function(e,t){var n,r,i=u.F.U,o=e.length,a=i.bl_count;for(n=0;n<=t;n++)a[n]=0;for(n=1;n<o;n+=2)a[e[n]]++;for(i=i.next_code,n=0,a[0]=0,r=1;r<=t;r++)n=n+a[r-1]<<1,i[r]=n;for(t=0;t<o;t+=2)0!=(a=e[t+1])&&(e[t]=i[a],i[a]++)},u.F.codes2map=function(e,t,n){for(var r=e.length,i=u.F.U.rev15,o=0;o<r;o+=2)if(0!=e[o+1]){var a=e[o+1],s=o>>1<<4|a,c=t-a;for(c=(a=e[o]<<c)+(1<<c);a!=c;)n[i[a]>>>15-t]=s,a++}},u.F.revCodes=function(e,t){for(var n=u.F.U.rev15,r=15-t,i=0;i<e.length;i+=2)e[i]=n[e[i]<<t-e[i+1]]>>>r},u.F._putsE=function(e,t,n){n<<=7&t,e[t>>>=3]|=n,e[t+1]|=n>>>8},u.F._putsF=function(e,t,n){n<<=7&t,e[t>>>=3]|=n,e[t+1]|=n>>>8,e[t+2]|=n>>>16},u.F._bitsE=function(e,t,n){return(e[t>>>3]|e[1+(t>>>3)]<<8)>>>(7&t)&(1<<n)-1},u.F._bitsF=function(e,t,n){return(e[t>>>3]|e[1+(t>>>3)]<<8|e[2+(t>>>3)]<<16)>>>(7&t)&(1<<n)-1},u.F._get17=function(e,t){return(e[t>>>3]|e[1+(t>>>3)]<<8|e[2+(t>>>3)]<<16)>>>(7&t)},u.F._get25=function(e,t){return(e[t>>>3]|e[1+(t>>>3)]<<8|e[2+(t>>>3)]<<16|e[3+(t>>>3)]<<24)>>>(7&t)},u.F.U=function(){var e=Uint16Array,t=Uint32Array;return{next_code:new e(16),bl_count:new e(16),ordr:[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],of0:[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,999,999,999],exb:[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0],ldef:new e(32),df0:[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,65535,65535],dxb:[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0],ddef:new t(32),flmap:new e(512),fltree:[],fdmap:new e(32),fdtree:[],lmap:new e(32768),ltree:[],ttree:[],dmap:new e(32768),dtree:[],imap:new e(512),itree:[],rev15:new e(32768),lhst:new t(286),dhst:new t(30),ihst:new t(19),lits:new t(15e3),strt:new e(65536),prev:new e(32768)}}(),function(){function e(e,t,n){for(;0!=t--;)e.push(0,n)}for(var t=u.F.U,n=0;32768>n;n++){var r=n;r=(4278255360&(r=(4042322160&(r=(3435973836&(r=(2863311530&r)>>>1|(1431655765&r)<<1))>>>2|(858993459&r)<<2))>>>4|(252645135&r)<<4))>>>8|(16711935&r)<<8,t.rev15[n]=(r>>>16|r<<16)>>>17}for(n=0;32>n;n++)t.ldef[n]=t.of0[n]<<3|t.exb[n],t.ddef[n]=t.df0[n]<<4|t.dxb[n];e(t.fltree,144,8),e(t.fltree,112,9),e(t.fltree,24,7),e(t.fltree,8,8),u.F.makeCodes(t.fltree,9),u.F.codes2map(t.fltree,9,t.flmap),u.F.revCodes(t.fltree,9),e(t.fdtree,32,5),u.F.makeCodes(t.fdtree,5),u.F.codes2map(t.fdtree,5,t.fdmap),u.F.revCodes(t.fdtree,5),e(t.itree,19,0),e(t.ltree,286,0),e(t.dtree,30,0),e(t.ttree,320,0)}();var Wk=u.inflate,Er=u.deflate,Fr=function(e){function t(e,i,o,a){W(this,t);var s=r.call(this,a,"Session");return m(n(s),"chatManager",void 0),m(n(s),"joinedChannels",new Set),m(n(s),"msgDedupLru",new nc(void 0,{maxlen:200})),m(n(s),"startTime",Date.now()),m(n(s),"seq",U.fromNumber(1,!0)),m(n(s),"userJoinOptions",new Cr(!1)),m(n(s),"seqSentStatuses",[!1,!1]),m(n(s),"dialogueSequenceLru",new nc(void 0,{maxlen:1e4})),m(n(s),"loggedOut",!1),m(n(s),"messageSentTimes",[]),m(n(s),"curLoginSockets",[void 0,void 0]),m(n(s),"loginSocketSubs",[{channels:new Map,receivers:[]},{channels:new Map,receivers:[]}]),m(n(s),"lastLoginSockets",[new ce(1),new ce(1)]),m(n(s),"dialPendingMsgSubjectMaps",[new Map,new Map]),m(n(s),"context",void 0),m(n(s),"connection",void 0),m(n(s),"instanceId",void 0),m(n(s),"registerSocketsFailureListener",(function(){s.connection.once("socketsFailure",(function(){s.log("socketsFailure, creating a new connection"),qd((function(){return s.connection.removeAllListeners(),s.connection=new sr(s.context,s.logger,!0),s.loginHandler(6e3,!0)})).pipe(ae((function(e){return e.pipe(Wc(Nd.getParameter("RECONNECTING_AP_INTERVAL")))})),ob(s.connection.apClient.apFinish$)).subscribe((function(){s.log("new connection connected")}))})),0===s.connection.listenerCount("tokenExpired")&&s.connection.on("tokenExpired",(function(){s.emit("tokenExpired")}))})),s.context=e,s.connection=i,s.instanceId=o,s.chatManager=new zC(a),s.log("The instanceId is %s",s.instanceId.toString()),s}ka(t,e);var r=la(t);return Ea(t,[{key:"fetchFileUploadIndexGet",value:function(e){var n=e.hash,r=e.size;if(0===(e=this.getLoginSockets()).length)throw new H("Client is not logged in");var i=this.incGetSeq();return e.forEach((function(e){e.sendPacket("FileUploadIndexGet",{seq:i,hash:n,size:r})})),{ret:ya.apply(void 0,I(e.map((function(e){return e.fromReceived("FileUploadIndexRet").pipe(X((function(e){return i.eq(e.seq)})))})))),fin:ya.apply(void 0,I(e.map((function(e){return e.fromReceived("FileUploadIndexFin").pipe(X((function(e){return i.eq(e.seq)})))})))),err:Tb.apply(void 0,I(e.map((function(e){return e.fromReceived("FileUploadIndexErr").pipe(X((function(e){return i.eq(e.seq)})),Z((function(e){throw new ca(["The media message upload failure, code %d",e.code],Wf)})))})))),timeout:t.genTimeoutError(vh)}}},{key:"requestFileUploadIndexSet",value:function(e){var n=e.hash,r=e.unit,i=e.servers;if(0===(e=this.getLoginSockets()).length)throw new H("Client is not logged in");var o=this.incGetSeq();return e.forEach((function(e){e.sendPacket("FileUploadIndexSet",{seq:o,servers:i,hash:n,unit:r})})),ya.apply(void 0,[t.genTimeoutError(vh)].concat(I(e.map((function(e){return e.fromReceived("FileUploadIndexErr").pipe(X((function(e){return o.eq(e.seq)})),Z((function(e){throw new ca(["FileUploadIndexSet failure, code %d",e.code],Wf)})))}))),I(e.map((function(e){return e.fromReceived("FileUploadIndexFin").pipe(X((function(e){return o.eq(e.seq)})))})))))}},{key:"requestFileDownloadIndexGet",value:function(e){var n=e.size,r=e.zone,i=e.unit,o=e.hash,a=this.getLoginSockets();if(0===a.length)throw new H("Client is not logged in");var s=this.incGetSeq();return a.forEach((function(e){e.sendPacket("FileDownloadIndexGet",{seq:s,size:n,zone:r,unit:i,hash:o})})),e=ya.apply(void 0,I(a.map((function(e){return e.fromReceived("FileDownloadIndexRet").pipe(X((function(e){return s.eq(e.seq)})))})))).pipe(Z((function(e){var t=e.backups,n=e.servers;return e=Se(e,["backups","servers"]),Ja({backupList:t.map((function(e){return[e]})),serverList:n.map((function(e){return[e]}))},e)})),Wc(500)),a=Pl(a.map((function(e){return e.fromReceived("FileDownloadIndexRet").pipe(X((function(e){return s.eq(e.seq)})))}))),ya(e,a.pipe(Z((function(e){return e.reduce((function(e,t){var n=e.backupList,r=e.serverList;e=t.backups;var i=t.servers;return t=Se(t,["backups","servers"]),Ja({backupList:e.map((function(e,t){return[e].concat(I(void 0!==n&&Array.isArray(n[t])?n[t]:[]))})),serverList:i.map((function(e,t){return[e].concat(I(void 0!==n&&Array.isArray(r[t])?r[t]:[]))}))},t)}),{})}))),t.genTimeoutError(vh))}},{key:"loginHandler",value:function(){var e=this,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1e4,n=1<arguments.length&&void 0!==arguments[1]&&arguments[1];if(this.loggedOut&&n)throw new H("Already logged out, request ignored");n&&this.registerSocketsFailureListener(),this.connection.initConnection();var r=this.getSocketLoginObservables(this.connection.lastOpenSockets,this.seq),i=Date.now();return r.forEach((function(t,r){var o=e.loginSocketSubs[r].login;void 0!==o&&o.unsubscribe(),e.loginSocketSubs[r].login=t.pipe(Y((function(t){var o,a;e.curLoginSockets[r]=t;var s=Date.now();cb("Link",{ackedServerIp:t.address,destServerIp:t.ip,ec:0,sc:0,elapse:db(e.startTime),lts:U.fromNumber(s),responseTime:i-s,sid:Sa(e.instanceId),userId:e.context.uid},null===(o=e.context.areaConfig)||void 0===o?void 0:o.EVENT_REPORT_DOMAIN[0],null===(a=e.context.areaConfig)||void 0===a?void 0:a.EVENT_REPORT_BACKUP_DOMAIN[0]),e.emit("userJoined",t.env),n&&e.connection.apClient.apFinish$.next(void 0)}))).subscribe(e.lastLoginSockets[r])})),this.initKeepAliveSender(),this.initKeepAliveReconnector(),this.initLoginReceiver(),Tb.apply(void 0,I(r).concat([fb(this.connection,"connectionInitFailure").pipe(Y((function(e){if(wa(e)||Na(e))throw e;throw new ca("Login failure",{code:yq,originalError:e})})))])).pipe(Pa(1),Za(t),Ga((function(t){return t instanceof pb&&e.warn("Client login timeout"),t&&t.code===uh&&(e.connection.emit("tokenExpired"),e.connection.apClient.apFinish$.next(void 0)),e.clearSockets(0,n),ba(t)})),Y((function(){n||e.registerSocketsFailureListener()})),hg((function(){n||e.connection.apClient.apFinish$.next(void 0)})))}},{key:"logoutHandler",value:function(){var e=K(w.mark((function e(){var t,n,r,i=this;return w.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.loggedOut=!0,this.connection.apClient.apFinish$.next(void 0),t=this.getLoginSockets(),n=t.map((function(e){return e.sendPacket("UserQuit",{}),i.connection.waitClosing(e)})),this.clearSockets(5e3),r=t.map((function(e){return e.env})),[0,1].filter((function(e){return!r.includes(e)})).forEach((function(e){i.connection.closeSocket(e,0)})),e.abrupt("return",Tb.apply(void 0,I(n)).toPromise());case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"requestChannelJoin",value:function(){var e=K(w.mark((function e(t,n){var r,i,o,a=this;return w.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==this.getLoginSockets().length){e.next=2;break}throw new H("Client is not logged in. Cannot join the channel",uq);case 2:return r=fb(this,"channelLeft").pipe(nb((function(e){return e===t})),Pa(1)),i=this.incGetSeq(),(o=this.lastLoginSockets.map((function(e){return e.pipe(vc((function(e,t){0!==t&&a.incSeqIfNeeded(e.env);var r=0===t?i:a.seq;return e.sendPacket("GroupEnter",{account:n,seq:r}),e.fromReceived("GroupReply").pipe(X((function(e){return r.eq(e.seq)})),Y((function(e){if(0!==(e=e.code))throw new ca(["Channel join failure. The response code is %d",e],qq)})))})),ob(r),be())}))).forEach((function(e,n){var r=function(){return a.loginSocketSubs[n].channels.delete(t.channelId)};a.loginSocketSubs[n].channels.set(t.channelId,e.subscribe({error:r,complete:r}))})),e.next=8,Tb.apply(void 0,I(o)).pipe(Pa(1),Za(1e4),Ga((function(e){return e instanceof pb&&a.warn("Channel join timeout"),ba(e)}))).toPromise();case 8:this.joinedChannels.add(t);case 9:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"requestChannelLeave",value:function(e,t){this.emit("channelLeft",e),this.joinedChannels.delete(e),this.getLoginSockets().forEach((function(e){e.sendPacket("GroupLeave",{account:t})}))}},{key:"requestChannelMemberList",value:function(e){var n=this.getLoginSockets();if(0===n.length)throw new H("Client is not logged in. Cannot get the channel members",Bz);var r=this.incGetSeq();return n.forEach((function(t){t.sendPacket("GroupAllUsersList",{group:e,pageNumber:0,pageSize:200,seq:r})})),ya.apply(void 0,[t.genTimeoutError(oq)].concat(I(n.map((function(t){return t.fromReceived("GroupAllUsersResult").pipe(X((function(t){var n=t.seq;return t.group===e&&r.eq(n)})))})))))}},{key:"requestPeersOnlineStatus",value:function(e){var n=this.getLoginSockets();if(0===n.length)throw new H("Client is not logged in");var r=this.incGetSeq();return n.forEach((function(t){t.sendPacket("UserStatusList",{users:e,seq:r})})),ya.apply(void 0,[t.genTimeoutError(Nz)].concat(I(n.map((function(e){return e.fromReceived("UserStatusResult").pipe(X((function(e){return r.eq(e.seq)})))})))))}},{key:"requestSetLocalUserAttributes",value:function(e,n){var r=this,i=this.getLoginSockets();if(0===i.length)throw new H("Client is not logged in");var o=this.incGetSeq();return i.forEach((function(t,i){void 0!==n&&i!==n||t.sendPacket("UserAttributeSet",{account:r.context.uid,attributeInfos:Object.entries(e).map((function(e){return{key:(e=pa(e,2))[0],value:e[1]}})),seq:o})})),ya.apply(void 0,I(i.map((function(e){return e.fromReceived("UserAttributeErr").pipe(X((function(e){return o.eq(e.seq)})),Z((function(e){throw new ca(["The user attributes set failure, code %d",e.code],Ob)})))}))).concat([t.genTimeoutError(Pb)],I(i.map((function(e){return e.fromReceived("UserAttributeRsp").pipe(X((function(e){return o.eq(e.seq)})))})))))}},{key:"requestSetChannelAttributes",value:function(e,n,r){var i=this.getLoginSockets();if(0===i.length)throw new H("Client is not logged in");var o=this.incGetSeq();return i.forEach((function(t){t.sendPacket("GroupAttributeSet",{broadcast:r,group:e,attributeInfos:Object.entries(n).map((function(e){return{key:(e=pa(e,2))[0],value:e[1]}})),seq:o})})),ya.apply(void 0,I(i.map((function(e){return e.fromReceived("GroupAttributeErr").pipe(X((function(e){return o.eq(e.seq)})),Z((function(e){throw new ca(["The group attributes set failure, code %d",e.code],Ob)})))}))).concat([t.genTimeoutError(Pb)],I(i.map((function(e){return e.fromReceived("GroupAttributeRsp").pipe(X((function(e){return o.eq(e.seq)})))})))))}},{key:"requestAddOrUpdateLocalUserAttributes",value:function(e){var n=this,r=this.getLoginSockets();if(0===r.length)throw new H("Client is not logged in");var i=this.incGetSeq();return r.forEach((function(t){t.sendPacket("UserAttributeMod",{account:n.context.uid,attributeInfos:Object.entries(e).map((function(e){return{key:(e=pa(e,2))[0],value:e[1]}})),seq:i})})),ya.apply(void 0,I(r.map((function(e){return e.fromReceived("UserAttributeErr").pipe(X((function(e){return i.eq(e.seq)})),Z((function(e){throw new ca(["The user attributes add or update failure, code %d",e.code],Ob)})))}))).concat([t.genTimeoutError(Pb)],I(r.map((function(e){return e.fromReceived("UserAttributeRsp").pipe(X((function(e){return i.eq(e.seq)})))})))))}},{key:"requestAddOrUpdateChannelAttributes",value:function(e,n,r){var i=this.getLoginSockets();if(0===i.length)throw new H("Client is not logged in");var o=this.incGetSeq();return i.forEach((function(t){t.sendPacket("GroupAttributeMod",{broadcast:r,group:e,attributeInfos:Object.entries(n).map((function(e){return{key:(e=pa(e,2))[0],value:e[1]}})),seq:o})})),ya.apply(void 0,I(i.map((function(e){return e.fromReceived("GroupAttributeErr").pipe(X((function(e){return o.eq(e.seq)})),Z((function(e){throw new ca(["The group attributes add or update failure, code %d",e.code],Ob)})))}))).concat([t.genTimeoutError(Pb)],I(i.map((function(e){return e.fromReceived("GroupAttributeRsp").pipe(X((function(e){return o.eq(e.seq)})))})))))}},{key:"requestDeleteLocalUserAttributesByKeys",value:function(e){var n=this,r=this.getLoginSockets();if(0===r.length)throw new H("Client is not logged in");var i=this.incGetSeq();return r.forEach((function(t){t.sendPacket("UserAttributeDel",{account:n.context.uid,attributes:e,seq:i})})),ya.apply(void 0,I(r.map((function(e){return e.fromReceived("UserAttributeErr").pipe(X((function(e){return i.eq(e.seq)})),Z((function(e){throw new ca(["The user attributes delete failure, code %d",e.code],Ob)})))}))).concat([t.genTimeoutError(Pb)],I(r.map((function(e){return e.fromReceived("UserAttributeRsp").pipe(X((function(e){return i.eq(e.seq)})))})))))}},{key:"requestDeleteChannelAttributesByKeys",value:function(e,n,r){var i=this.getLoginSockets();if(0===i.length)throw new H("Client is not logged in");var o=this.incGetSeq();return i.forEach((function(t){t.sendPacket("GroupAttributeDel",{group:e,broadcast:r,attributes:n,seq:o})})),ya.apply(void 0,I(i.map((function(e){return e.fromReceived("GroupAttributeErr").pipe(X((function(e){return o.eq(e.seq)})),Z((function(e){throw new ca(["The channel attributes delete failure, code %d",e.code],Ob)})))}))).concat([t.genTimeoutError(Pb)],I(i.map((function(e){return e.fromReceived("GroupAttributeRsp").pipe(X((function(e){return o.eq(e.seq)})))})))))}},{key:"requestClearLocalUserAttributes",value:function(){var e=this,n=this.getLoginSockets();if(0===n.length)throw new H("Client is not logged in");var r=this.incGetSeq();return n.forEach((function(t){t.sendPacket("UserAttributeSet",{account:e.context.uid,seq:r,attributeInfos:[]})})),ya.apply(void 0,I(n.map((function(e){return e.fromReceived("UserAttributeErr").pipe(X((function(e){return r.eq(e.seq)})),Z((function(e){throw new ca(["The user attributes clear failure, code %d",e.code],Ob)})))}))).concat([t.genTimeoutError(Pb)],I(n.map((function(e){return e.fromReceived("UserAttributeRsp").pipe(X((function(e){return r.eq(e.seq)})))})))))}},{key:"requestClearChannelAttributes",value:function(e,n){var r=this.getLoginSockets();if(0===r.length)throw new H("Client is not logged in");var i=this.incGetSeq();return r.forEach((function(t){t.sendPacket("GroupAttributeSet",{group:e,seq:i,attributeInfos:[],broadcast:n})})),ya.apply(void 0,I(r.map((function(e){return e.fromReceived("GroupAttributeErr").pipe(X((function(e){return i.eq(e.seq)})),Z((function(e){throw new ca(["The channel attributes clear failure, code %d",e.code],Ob)})))}))).concat([t.genTimeoutError(Pb)],I(r.map((function(e){return e.fromReceived("GroupAttributeRsp").pipe(X((function(e){return i.eq(e.seq)})))})))))}},{key:"requestGetUserAttributesByKeys",value:function(e,n){var r=this.getLoginSockets();if(0===r.length)throw new H("Client is not logged in");var i=this.incGetSeq();return r.forEach((function(t){t.sendPacket("UserAttributeGet",{account:e,seq:i,attributes:n})})),ya.apply(void 0,[t.genTimeoutError(Pb)].concat(I(r.map((function(e){return e.fromReceived("UserAttributeErr").pipe(X((function(e){return i.eq(e.seq)})),Z((function(e){if(10008===(e=e.code))throw new ca("The user requested is not online",lq);throw new Pc(["User attribute operation unknown error code: %d",e],Ob)})))}))),I(r.map((function(e){return e.fromReceived("UserAttributeRet").pipe(X((function(e){return i.eq(e.seq)})))})))))}},{key:"requestGetChannelAttributesByKeys",value:function(e,n){var r=this.getLoginSockets();if(0===r.length)throw new H("Client is not logged in");var i=this.incGetSeq();return r.forEach((function(t){t.sendPacket("GroupAttributeGet",{group:e,seq:i,attributes:n})})),ya.apply(void 0,[t.genTimeoutError(Pb)].concat(I(r.map((function(e){return e.fromReceived("GroupAttributeErr").pipe(X((function(e){return i.eq(e.seq)})),Z((function(e){throw new ca(["The channel attributes get failure, code %d",e.code],Ob)})))}))),I(r.map((function(e){return e.fromReceived("GroupAttributeRet").pipe(X((function(e){return i.eq(e.seq)})))})))))}},{key:"requestGetUserAttributeKeys",value:function(e){var n=this.getLoginSockets();if(0===n.length)throw new H("Client is not logged in");var r=this.incGetSeq();return n.forEach((function(t){t.sendPacket("UserAttributeKeysGet",{account:e,seq:r})})),ya.apply(void 0,[t.genTimeoutError(Pb)].concat(I(n.map((function(e){return e.fromReceived("UserAttributeErr").pipe(X((function(e){return r.eq(e.seq)})),Z((function(e){if(10008===(e=e.code))throw new ca("The user requested is not online",lq);throw new Pc(["User attribute operation unknown error code: %d",e],Ob)})))}))),I(n.map((function(e){return e.fromReceived("UserAttributeKeysRet").pipe(X((function(e){return r.eq(e.seq)})))})))))}},{key:"requestGetChannelAttributesKeys",value:function(e){var n=this.getLoginSockets();if(0===n.length)throw new H("Client is not logged in");var r=this.incGetSeq();return n.forEach((function(t){t.sendPacket("GroupAttributeKeysGet",{group:e,seq:r})})),ya.apply(void 0,[t.genTimeoutError(Pb)].concat(I(n.map((function(e){return e.fromReceived("GroupAttributeErr").pipe(X((function(e){return r.eq(e.seq)})),Z((function(e){throw new Pc(["Channel attribute operation unknown error code: %d",e.code],Ob)})))}))),I(n.map((function(e){return e.fromReceived("GroupAttributeKeysRet").pipe(X((function(e){return r.eq(e.seq)})))})))))}},{key:"requestGetChannelMemberCount",value:function(e){var n=this.getLoginSockets();if(0===n.length)throw new H("Client is not logged in");var r=this.incGetSeq();return n.forEach((function(t){t.sendPacket("GroupStatusList",{groups:e,seq:r})})),ya.apply(void 0,[t.genTimeoutError(oq)].concat(I(n.map((function(e){return e.fromReceived("GroupStatusResult").pipe(X((function(e){return r.eq(e.seq)})))})))))}},{key:"requestSubscribePeersOnlineStatus",value:function(e){var n=this.getLoginSockets();if(0===n.length)throw new H("Client is not logged in");var r=this.incGetSeq();return n.forEach((function(t){t.sendPacket("SubscribeUserStatus",{seq:r,users:e})})),ya.apply(void 0,[t.genTimeoutError(Uz)].concat(I(n.map((function(e){return e.fromReceived("SubscribeResponse").pipe(X((function(e){return r.eq(e.seq)})))})))))}},{key:"requestUnsubscribePeersOnlineStatus",value:function(e){var t=this.getLoginSockets();if(0===t.length)throw new H("Client is not logged in");var n=this.incGetSeq();t.forEach((function(t){t.sendPacket("UnsubscribeUserStatus",{seq:n,users:e})}))}},{key:"sendInvitationMessage",value:function(){var e=K(w.mark((function e(t){var n,r,i,o,a,s,c,u,l,d,h,f,p=this;return w.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.peerId,r=t.callId,i=t.extra,o=t.isAcceptAck,a=t.channelId,s=t.type,c={callId:r},void 0===o){e.next=6;break}if("CallAccept"===s){e.next=5;break}throw Error("invalid invitation type");case 5:c.type=o?"ack":"request";case 6:return c.channel=a,("CallInvite"===s||"CallCancel"===s||"CallReject"===s||"CallAccept"===s&&!1===o)&&void 0!==i&&(c.extra=i),u=lg(),this.log("The sent invitation body is %o",c),l=function(e){return{MiscMap:{},sequence:U.fromNumber(1),dialogue:u,instance:p.instanceId,dst:n,ms:U.fromNumber(Date.now(),!0),options:new Od({IterationNumber:e,MessageType:s}).toLong(),payload:(new TextEncoder).encode(JSON.stringify(c)),src:p.context.uid}},e.next=14,Ib(this.sendMessageToRetry(l,!0)).pipe(Za(1e4),Ga((function(e){return e instanceof pb&&p.warn("Send invitation timeout"),ba(e)}))).toPromise();case 14:return d=e.sent,h=d.code,f=d.retryTimes,e.abrupt("return",{hasPeerReceived:0===h,hasReSent:0!==f});case 18:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"sendMediaMessage",value:function(){var e=K(w.mark((function e(t,n,r,i,o,a){var s,c,u,l,d,h,f,p,A,g,v,y,b,E,_,S,T,R,C,I,x,O,N,B,M,k,D,P,F,H=this;return w.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c=n.width,u=void 0===c?0:c,l=n.height,d=void 0===l?0:l,h=n.fileName,f=void 0===h?"":h,p=n.description,A=void 0===p?"":p,g=n.thumbnail,v=void 0===g?new Blob:g,y=n.thumbnailHeight,b=void 0===y?0:y,E=n.thumbnailWidth,_=void 0===E?0:E,S=n.size,T=void 0===S?0:S,R=n.mediaId,C=o.enableOfflineMessaging,I=o.enableHistoricalMessaging,ua(r)){e.next=4;break}throw new L("The send message arguments are not valid",i?Ik:Tf);case 4:if(!(32768<new Blob([f,v,A]).size)){e.next=6;break}throw new L("The size of message overflowed ",i?ge:qh);case 6:return x=this.chatManager.getChatInfo(r),O=x.dialogue,N=x.sequence,B=this.instanceId,this.log('A%s media message is sending to %s: "'.concat(B,"-").concat(O,"#").concat(N,'"'),i?" peer":" channel",r),m(s={},"media_description",A),m(s,"media_width",u),m(s,"media_height",d),m(s,"media_thumbnailwidth",_),m(s,"media_thumbnailheight",b),m(s,"media_size",T),m(s,"media_id",R),m(s,"media_filename",f),M=oc(s,(function(e){return(new TextEncoder).encode(e.toString())})),e.t0=Uint8Array,e.next=14,wi(v);case 14:return e.t1=e.sent,M.media_thumbnail=new e.t0(e.t1),k=i&&"IMAGE"===t?"PeerImageMessage":i&&"FILE"===t?"PeerFileMessage":i||"IMAGE"!==t?"ChannelFileMessage":"ChannelImageMessage",D=function(e){return{MiscMap:M,sequence:N,dialogue:O,instance:B,dst:r,ms:U.fromNumber(Date.now(),!0),options:new Od({IterationNumber:e,CompressionMethod:"Uncompressed",MessageType:k,ToCache:C,ToArchive:I}).toLong(),payload:new Uint8Array,src:H.context.uid}},e.next=20,Ib(this.sendMessageToRetry(D,!0)).pipe(Za(void 0===a?1e4:a),Ga((function(e){return e instanceof pb&&H.warn("Send message timeout"),ba(e)}))).toPromise();case 20:if(P=e.sent,2!==(F=P.code)){e.next=24;break}throw new ca("The peer does not support this type of message",Mz);case 24:return e.abrupt("return",{hasPeerReceived:0===F});case 25:case"end":return e.stop()}}),e,this)})));return function(t,n,r,i,o,a){return e.apply(this,arguments)}}()},{key:"sendRawMessage",value:function(){var e=K(w.mark((function e(t,n,r,i,o,a){var s,c,u,l,d,h,f,p,A,g,v=this;return w.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=o.enableOfflineMessaging,c=o.enableHistoricalMessaging,ua(r)&&t instanceof Uint8Array&&"string"==typeof n){e.next=3;break}throw new L("The send message arguments are not valid",i?Ik:Tf);case 3:if(!(32768<t.byteLength+new Blob([n]).size)){e.next=5;break}throw new gb("The message size is over the 32KB limit",i?ge:qh);case 5:return u=!Nd.getParameter("DISABLE_MESSAGE_COMPRESSION")&&128<=t.byteLength,l=this.chatManager.getChatInfo(r),d=l.dialogue,h=l.sequence,f=this.instanceId,this.log('A%s %s raw message is sending to %s: "'.concat(f,"-").concat(d,"#").concat(h,'"'),u?" compressed":"",i?"peer":"channel",r),p=function(e){return{MiscMap:{description:(new TextEncoder).encode(n)},sequence:h,dialogue:d,instance:f,dst:r,ms:U.fromNumber(Date.now(),!0),options:new Od({IterationNumber:e,CompressionMethod:u?"Zlib":"Uncompressed",MessageType:i?"PeerRawMessage":"ChannelRawMessage",ToCache:s,ToArchive:c}).toLong(),payload:u?Er(t):t,src:v.context.uid}},e.next=12,Ib(this.sendMessageToRetry(p,!0)).pipe(Za(void 0===a?1e4:a),Ga((function(e){return e instanceof pb&&v.warn("Send message timeout"),ba(e)}))).toPromise();case 12:return A=e.sent,g=A.code,e.abrupt("return",{hasPeerReceived:0===g});case 15:case"end":return e.stop()}}),e,this)})));return function(t,n,r,i,o,a){return e.apply(this,arguments)}}()},{key:"sendTextMessage",value:function(){var e=K(w.mark((function e(t,n,r,i,o){var a,s,c,u,l,d,h,f,p,A,g,v=this;return w.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=i.enableOfflineMessaging,s=i.enableHistoricalMessaging,ua(n)){e.next=3;break}throw new L("The send message arguments are not valid",r?Ik:Tf);case 3:if(!(32768<new Blob([t]).size)){e.next=5;break}throw new gb("The message size is over the 32KB limit",r?ge:qh);case 5:return c=!Nd.getParameter("DISABLE_MESSAGE_COMPRESSION")&&128<=new Blob([t]).size,u=this.chatManager.getChatInfo(n),l=u.dialogue,d=u.sequence,h=this.instanceId,this.log('A%s %s message is sending to %s: "'.concat(h,"-").concat(l,"#").concat(d,'"'),c?" compressed":"",r?"peer":"channel",n),f=(new TextEncoder).encode(t),p=function(e){return{MiscMap:{},sequence:d,dialogue:l,instance:h,dst:n,ms:U.fromNumber(Date.now(),!0),options:new Od({IterationNumber:e,CompressionMethod:c?"Zlib":"Uncompressed",MessageType:r?"PeerTextMessage":"ChannelTextMessage",ToCache:a,ToArchive:s}).toLong(),payload:c?Er(f):f,src:v.context.uid}},e.next=13,Ib(this.sendMessageToRetry(p,!0)).pipe(Za(void 0===o?1e4:o),Ga((function(e){return e instanceof pb&&v.warn("Send message timeout"),ba(e)}))).toPromise();case 13:return A=e.sent,g=A.code,e.abrupt("return",{hasPeerReceived:0===g});case 16:case"end":return e.stop()}}),e,this)})));return function(t,n,r,i,o){return e.apply(this,arguments)}}()},{key:"cleanLoginSubs",value:function(e,t){Object.entries(this.loginSocketSubs[e]).forEach((function(e){var n=(e=pa(e,2))[1];"channels"===e[0]&&t||(Array.isArray(n)||n instanceof Map?n.forEach((function(e){return e.unsubscribe()})):n&&n.unsubscribe())})),this.loginSocketSubs[e]={channels:t?this.loginSocketSubs[e].channels:new Map,receivers:[]}}},{key:"sendMessageToRetry",value:function(){var e=K(w.mark((function e(t,n){var r,i,o,a,s,c,u,l,d,h=this,f=arguments;return w.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=2<f.length&&void 0!==f[2]?f[2]:0,this.log("Attempt to send the message ".concat(n?" with retrying, %o":"without retrying"),{retryTimes:r}),0!==(i=this.getLoginSockets()).length){e.next=5;break}throw Error("no logged-in sockets");case 5:return o=t(r),i.forEach((function(e){e.sendPacket("Message",o)})),a=o.dialogue,s=o.sequence,c=o.instance,u=i.map((function(e){return e.fromReceived("Ack").pipe(nb((function(e){return a.eq(e.dialogue)&&s.eq(e.sequence)&&c.eq(e.instance)})))})),e.prev=9,e.next=12,Tb.apply(void 0,I(u)).pipe(Za(6e3),Ga((function(e){return Na(e)&&h.warn("Message send timeout, retry times %d",r),ba(e)})),Pa(1)).toPromise();case 12:return l=e.sent,d=l.code,this.log("The message has been acked, %o",{code:d}),e.abrupt("return",{code:d,retryTimes:r});case 18:if(e.prev=18,e.t0=e.catch(9),!(e.t0 instanceof pb&&n)){e.next=22;break}return e.abrupt("return",this.sendMessageToRetry(t,!1,r+1));case 22:throw e.t0;case 23:case"end":return e.stop()}}),e,this,[[9,18]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"initKeepAliveSender",value:function(){var e=this;this.lastLoginSockets.map((function(t){return t.pipe(vc((function(t){return uc(0,1e3).pipe(Y((function(){e.incSeqIfNeeded(t.env),t.sendPacket("Ping",{ms:U.fromNumber(Date.now(),!0),seq:e.seq})})))})))})).forEach((function(t,n){var r=e.loginSocketSubs[n].keepAlive;void 0!==r&&r.unsubscribe(),e.loginSocketSubs[n].keepAlive=t.subscribe({error:function(){}})}))}},{key:"initKeepAliveReconnector",value:function(){var e=this;this.lastLoginSockets.map((function(e){return e.pipe(vc((function(e){var t,n=!1,r=e.userJoin$.pipe(Y((function(){n=!0}))),i=e.input$.pipe(Y((function(e){"Ping"!==yi[e.uri].slice(0,-3)&&(n=!1)})));return Tb(uc(5e3,4500).pipe(jt(e.receivedPacket),Y((function(r){r=pa(r,2),r=pa(r[1],2)[1],t!==r||n||e.forceReconnect(),t=r}))),r,i)})))})).forEach((function(t,n){var r=e.loginSocketSubs[n].keepAliveReconnector;void 0!==r&&r.unsubscribe(),e.loginSocketSubs[n].keepAliveReconnector=t.subscribe({error:function(){}})}))}},{key:"initLoginReceiver",value:function(){var e=this;this.lastLoginSockets.map((function(t){return t.pipe(vc((function(t){return Tb(fb(t,"reconnect").pipe(Y(e.onSocketReconnect(t))),t.fromReceived("Message").pipe(Y(e.onMessage(t))),t.fromReceived("GroupEnterNotice").pipe(Y(e.onGroupEnterNotice())),t.fromReceived("GroupLeaveNotice").pipe(Y(e.onGroupLeaveNotice())),t.fromReceived("GroupCountNotice").pipe(Y(e.onGroupCountNotice())),t.fromReceived("GroupAttributeAlt").pipe(Y(e.onGroupAttributeAlt())),t.fromReceived("UserJoinNotice").pipe(Y(e.onUserNotice(S.PeerOnlineState.ONLINE))),t.fromReceived("UserQuitNotice").pipe(Y(e.onUserNotice(S.PeerOnlineState.OFFLINE))),t.fromReceived("UserWaitNotice").pipe(Y(e.onUserNotice(S.PeerOnlineState.UNREACHABLE)))).pipe(bf(void 0))})))})).forEach((function(t,n){e.loginSocketSubs[n].receivers.push(t.subscribe({error:function(){}}))}))}},{key:"requestSocketLogin",value:function(e,t,n){var r=this;return Ol(qd((function(){r.userJoinOptions=new Cr(t),e.sendPacket("UserJoin",{account:r.context.uid,instance:r.instanceId,opt:r.userJoinOptions.toLong(),seq:n,ticket:e.ticket})})),e.fromReceived("UserResp").pipe(X((function(e){return n.eq(e.seq)})),Y((function(t){if(0!==(t=t.code))throw r.clearSockets(),r.logError("Connected to gateway success but the Rtm server rejected login"),new ca(["Login failure. The response code from the RTM service is %d",t],sh);r.log("ENV_%d logged in",e.env)})),bf(e),Za(5e3))).pipe(nb((function(e){return void 0!==e})),Ga((function(e){return e instanceof pb&&r.warn("Login response timeout, rejoin: %s",t),ba(e)})))}},{key:"getSocketLoginObservables",value:function(e,t){var n=this;return e.map((function(e){return e.pipe(Y((function(e){0===e.listenerCount("socketUserDrop")&&e.on("socketUserDrop",(function(t){return n.onUserDrop(t,e)}))})),vc((function(e,r){return n.incSeqIfNeeded(e.env),n.requestSocketLogin(e,0!==r,0===r?t:n.seq)})),be())}))}},{key:"incSeqIfNeeded",value:function(e){if(![0,1].includes(e))throw new Ca({INVALID_ENV:"The env argument is not 0 or 1"});this.seqSentStatuses[e]&&(this.seq=this.seq.add(1),this.seqSentStatuses=[!1,!1]),this.seqSentStatuses[e]=!0}},{key:"incGetSeq",value:function(){return this.seq=this.seq.add(1),this.seqSentStatuses=[!0,!0],this.seq}},{key:"getLoginSockets",value:function(){for(var e=this.curLoginSockets,t=-1,n=null==e?0:e.length,r=0,i=[];++t<n;){var o=e[t];o&&(i[r++]=o)}return i}},{key:"emitMessage",value:function(e,n){var r=e.options,i=e.payload,o=e.src,a=e.dst,s=e.instance,c=e.dialogue,u=e.sequence,l=e.ms,d=e.MiscMap;this.dialogueSequenceLru.set(c.toString(),u),s="".concat(s,"-").concat(c,"#").concat(u),this.msgDedupLru.has(s)?this.warn("Env_%d: Messages out-of-order or not start with 1: %s",n,s):(this.msgDedupLru.set(s,void 0),n=new Od(r),this.lastLoginSockets.forEach(function(){var n=K(w.mark((function n(r){var i;return w.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,r.pipe(Pa(1)).toPromise();case 2:i=n.sent,t.sendMessageAck(e,i);case 4:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()),r=n.isZlibCompressed(),n.isInvitation()?(a=na(r?Wk(Am(i,Uint8Array.of(0,0,0,0))):i),a=JSON.parse(a),this.log("The received invitation body is %o",a),this.emit("invitationMessage",{body:a,type:n.getInvitationType(),peerId:o,serverReceivedTs:l.toNumber()})):n.isTextMessage()?(d=n.isPeerTextMessage(),i=na(r?Wk(Am(i,Uint8Array.of(0,0,0,0))):i),this.info("Received a%s %s text message from %s to %s, %s",r?" compressed":"",d?"peer":"channel",o,a,s),d?(o={text:i,peerId:o,properties:{serverReceivedTs:l.toNumber(),isOfflineMessage:n.isFromCache()}},this.emit("peerTextMessage",o)):this.emit("channelTextMessage",{channelId:a,memberId:o,text:i,properties:{serverReceivedTs:l.toNumber(),isOfflineMessage:!1}})):n.isRawMessage()?(c=n.isRawPeerMessage(),d=void 0===(d=d.description)?"":na(d),i=r?Wk(i):i,this.info("Received a%s %s raw message from %s to %s, %s",r?" compressed":"",c?"peer":"channel",o,a,s),c?(o={desc:d,raw:i,peerId:o,properties:{serverReceivedTs:l.toNumber(),isOfflineMessage:n.isFromCache()}},this.emit("peerRawMessage",o)):this.emit("channelRawMessage",{desc:d,raw:i,channelId:a,memberId:o,properties:{serverReceivedTs:l.toNumber(),isOfflineMessage:!1}})):(n.isImageMessage()||n.isFileMessage())&&(i=n.isPeerMessage(),this.info("Received a %s media message from %s to %s, %s",i?"peer":"channel",o,a,s),i?this.emit("peerMediaMessage",{messageType:n.isImageMessage()?"IMAGE":"FILE",details:d,peerId:o,properties:{serverReceivedTs:l.toNumber(),isOfflineMessage:n.isFromCache()}}):this.emit("channelMediaMessage",{messageType:n.isImageMessage()?"IMAGE":"FILE",details:d,memberId:o,channelId:a,properties:{serverReceivedTs:l.toNumber(),isOfflineMessage:n.isFromCache()}})))}},{key:"onSocketReconnect",value:function(e){var t=this;return function(){var n=[0,1].filter((function(t){return t!==e.env}))[0];(n=t.connection.curOpenSockets[n])&&!n.loggedIn&&t.emit("connectionLost")}}},{key:"onUserDrop",value:function(e,t){var n,r;e=e.code,cb("KickedOff",{code:0,elapse:db(this.startTime),linkId:parseInt(t.name.split("-")[1],10),lts:U.fromNumber(Date.now()),server:t.address,serverCode:e,sid:Sa(this.instanceId),userId:this.context.uid},null===(n=this.context.areaConfig)||void 0===n?void 0:n.EVENT_REPORT_DOMAIN[0],null===(r=this.context.areaConfig)||void 0===r?void 0:r.EVENT_REPORT_BACKUP_DOMAIN[0]),10006===e||10001===e?this.warn("Login too often and kicked off, reconnect and login"):10009===e?(this.warn("The instance ID conflicts, reconnecting"),this.instanceId=lg(),this.context.sid=Sa(this.instanceId),this.emit("instanceChanged",this.instanceId)):[11,14,15,16].includes(e)&&(this.emit("userDrop",e),this.clearSockets())}},{key:"clearSockets",value:function(){var e=this,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,n=1<arguments.length&&void 0!==arguments[1]&&arguments[1];[0,1].forEach((function(r){e.cleanLoginSubs(r,n),e.connection.closeSocket(r,t)}))}},{key:"onMessage",value:function(e){var t=this;return function(n){var r=n.dialogue,i=n.instance,o=n.sequence,a=n.options;if(n.src===t.context.uid)t.log("The message is from the local account, ignored");else{var s=r.toString(),c=t.dialPendingMsgSubjectMaps[e.env].get(s);if(r="".concat(i,"-").concat(r,"#").concat(o),c)c.next(n),t.log("Env_%d: The dialogue has pending messages, next: %s",e.env,r);else{var u=t.dialogueSequenceLru.get(s);if(c=!u&&o.eq(1),i=void 0!==u&&o.sub(u).eq(1),c||i)t.emitMessage(n,e.env);else{if(u){if(o.lte(u))return;t.log("Env_%d: The message pended, the sequence is not continuous with the last: %s",e.env,r)}else t.log("Env_%d: The message pended, the first sequence is not equal to 1: %s",e.env,r);o=new La,t.dialPendingMsgSubjectMaps[e.env].set(s,o);var l=o.pipe(ks(yk),ig((function(e,t){return[].concat(I(e),[t])}),[]),Z((function(e){return e.sort((function(e,t){return e=e.sequence,t=t.sequence,e.eq(t)?0:e.gt(t)?1:-1}))})),Yl(1));a=!(a=new Od(a)).isFromCache()&&!a.isBufferedMessage(),l.pipe(ob(uc(a?750:1500)),X((function(e){if(2>e.length)return!1;for(var t=void 0===u?U.fromNumber(1,!0):u.add(1),n=0;n<e.length;t=t.add(1),n++)if(!e[n].sequence.eq(t))return!1;return!0})),hg((function(){t.dialPendingMsgSubjectMaps[e.env].delete(s)}))).subscribe((function(n){n.forEach((function(n){t.emitMessage(n,e.env),t.log("Env_%d: The message queue has fully ordered, emitting: %s",e.env,"".concat(n.instance,"-").concat(n.dialogue,"#").concat(n.sequence))}))}),(function(n){n instanceof gg&&l.pipe(Pa(1)).subscribe((function(n){return n.forEach((function(n){t.log("Env_%d: The message pending queue expired, emitting: %s",e.env,"".concat(n.instance,"-").concat(n.dialogue,"#").concat(n.sequence)),t.emitMessage(n,e.env)}))}))})),o.next(n)}}}}}},{key:"onGroupEnterNotice",value:function(){var e=this;return function(t){e.emit("memberNotice",{channelId:t.group,seq:t.seq,instance:t.instance,memberId:t.user,type:"MemberJoined",size:t.size})}}},{key:"onGroupLeaveNotice",value:function(){var e=this;return function(t){e.emit("memberNotice",{channelId:t.group,seq:t.seq,instance:t.instance,memberId:t.user,type:"MemberLeft",size:t.size})}}},{key:"onGroupCountNotice",value:function(){var e=this;return function(t){e.emit("memberNotice",{channelId:t.group,seq:t.seq,instance:t.instance,type:"MemberCountUpdated",size:t.size})}}},{key:"onGroupAttributeAlt",value:function(){var e=this;return function(t){var n=t.group;t=Se(t,["group"]),e.emit("channelAttributesUpdated",Ja({channelId:n},t))}}},{key:"onUserNotice",value:function(e){var t=this;return function(n){t.emit("peerOnlineStatusChanged",{peerId:n.user,instance:n.instance,seq:n.seq,state:e})}}}],[{key:"sendMessageAck",value:function(e,t){var n=new Od(e.options);(n.isInvitation()||n.isPeerMessage())&&t.sendPacket("Ack",{code:0,dialogue:e.dialogue,instance:e.instance,sequence:e.sequence})}}]),t}(vb());m(Fr,"genTimeoutError",(function(e,t){return mb(void 0).pipe(Wc(void 0===t?1e4:t),Z((function(){throw new bb(["Request timed out after %ds",void 0===t?1e4:t],e)})))}));var Gr,Xk,Yk=0,Zk=0;Id.v1=function(e,t,n){n=t&&n||0;var r=t||[],i=(e=e||{}).node||Gr,o=void 0!==e.clockseq?e.clockseq:Xk;if(null==i||null==o){var a=jq();null==i&&(i=Gr=[1|a[0],a[1],a[2],a[3],a[4],a[5]]),null==o&&(o=Xk=16383&(a[6]<<8|a[7]))}a=void 0!==e.msecs?e.msecs:(new Date).getTime();var s=void 0!==e.nsecs?e.nsecs:Zk+1,c=a-Yk+(s-Zk)/1e4;if(0>c&&void 0===e.clockseq&&(o=o+1&16383),(0>c||a>Yk)&&void 0===e.nsecs&&(s=0),1e4<=s)throw Error("uuid.v1(): Can't create more than 10M uuids/sec");for(Yk=a,Zk=s,Xk=o,e=(1e4*(268435455&(a+=122192928e5))+s)%4294967296,r[n++]=e>>>24&255,r[n++]=e>>>16&255,r[n++]=e>>>8&255,r[n++]=255&e,e=a/4294967296*1e4&268435455,r[n++]=e>>>8&255,r[n++]=255&e,r[n++]=e>>>24&15|16,r[n++]=e>>>16&255,r[n++]=o>>>8|128,r[n++]=255&o,o=0;6>o;++o)r[n+o]=i[o];return t||kq(r)},Id.v4=Id;var $k=zh(),jd,Hr,Oe=S.LocalInvitationFailureReason,xa=S.LocalInvitationState,AC=(Hr=function(e){function t(e,i,o){W(this,t);var a=r.call(this,o,"RtmLocalInvitation",!0);return m(n(a),"state",xa.IDLE),m(n(a),"localInvitationEnd$",ya(fb(n(a),"LocalInvitationAccepted"),fb(n(a),"LocalInvitationRefused"),fb(n(a),"LocalInvitationFailure"),fb(n(a),"LocalInvitationCanceled")).pipe(Pa(1))),m(n(a),"callId",Id.v4()),m(n(a),"_content",""),m(n(a),"_channelId",""),m(n(a),"_response",""),m(n(a),"calleeId",void 0),m(n(a),"logger",void 0),m(n(a),"getSession",void 0),a.calleeId=e,a.getSession=i,a.logger=o,a}ka(t,e);var r=la(t);return Ea(t,[{key:"channelId",get:function(){return this._channelId},set:function(e){this.state!==xa.IDLE?this.info("set channelId only allow before invitation sent to remote"):(this.log("set channelId for %s",this.callId),this._channelId=e)}},{key:"content",get:function(){return this._content},set:function(e){this.log("set content for %s",this.callId),this._content=e}},{key:"response",get:function(){return this._response},set:function(e){throw new L('Cannot set the "response" of the LocalInvitation instance.',rc)}},{key:"send",value:function(){var e,t=this;if(this.state===xa.SENT_TO_REMOTE||this.state===xa.RECEIVED_BY_REMOTE)throw new H("The local invitation send failure. The call invitation has already been sent.",Fz);if(this.isLocalInvitationEnd())throw new H("The local invitation send failure. The call invitation has ended.",rh);if(0<this._channelId.length&&!ua(this._channelId))throw new L("Illegal invitation channel ID",rc);if(!ua(this.calleeId))throw new L("Illegal invitation callee user ID",rc);if(8192<sg(this._content))throw new L('The length of the "content" overflows. The number of bytes representing content must not exceed 8 × 1024 if encoded in UTF-8.',rc);this.state=xa.SENT_TO_REMOTE,qd(K(w.mark((function n(){var r,i,o;return w.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.getSession().sendInvitationMessage({peerId:t.calleeId,callId:t.callId,extra:t._content,type:"CallInvite",channelId:t._channelId});case 2:if(r=n.sent,i=r.hasPeerReceived,o=r.hasReSent,!t.isLocalInvitationEnd()){n.next=7;break}throw new bb("send invitation timeout");case 7:if(t.log("The local invitation has sent to the callee"),i||o){n.next=11;break}throw e=new $k({PEER_NOT_ONLINE:"The peer of the invitation is not online"});case 11:if(i){n.next=14;break}throw e=new $k({RESENT_AND_OFFLINE:"Resent and the peer of the invitation is not online"});case 14:case"end":return n.stop()}}),n)})))).pipe(ae((function(e){return e.pipe(Y((function(e){if(!(e instanceof $k))throw e})),Wc(2e3))})),Za(3e4),Ga((function(e){return Na(e)&&t.warn("local invitation ack timed out"),ba(e)})),ob(this.localInvitationEnd$)).subscribe({next:function(){t.state===xa.RECEIVED_BY_REMOTE?t.log('The local invitation state is already "RECEIVED_BY_REMOTE", skipped emitting "LocalInvitationReceivedByPeer"'):t.state!==xa.SENT_TO_REMOTE?t.log("The invitation has ended, skipped emitting the %s event","LocalInvitationReceivedByPeer"):(t.info("The peer received the local invitation %s.",t.callId),t.state=xa.RECEIVED_BY_REMOTE,t.emit("LocalInvitationReceivedByPeer"),t.localInvitationEnd$.pipe(Za(6e4),Ga((function(e){return Na(e)&&t.warn("local invitation expired"),ba(e)}))).subscribe({error:function(){t.state=xa.FAILURE,t.emit("LocalInvitationFailure",Oe.INVITATION_EXPIRE)}}))},error:function(n){t.isLocalInvitationEnd()?t.log("The invitation has ended, skipped emitting the %s event","LocalInvitationFailure"):(t.state=xa.FAILURE,Na(n)&&e?"PEER_NOT_ONLINE"===e.code?t.emit("LocalInvitationFailure",Oe.PEER_OFFLINE):"RESENT_AND_OFFLINE"===e.code&&t.emit("LocalInvitationFailure",Oe.PEER_NO_RESPONSE):Na(n)?t.emit("LocalInvitationFailure",Oe.PEER_NO_RESPONSE):"RtmInvalidStatusError"===n.name?t.emit("LocalInvitationFailure",Oe.NOT_LOGGEDIN):t.emit("LocalInvitationFailure",Oe.UNKNOWN))}})}},{key:"cancel",value:function(){if(this.isLocalInvitationEnd())throw new H("The local invitation cancel failure",rh);if(this.state===xa.IDLE)throw new H("The local invitation has not been sent",Ez);if(8192<sg(this._content))throw new L('The length of the "content" overflows. The number of bytes representing content must not exceed 8 × 1024 if encoded in UTF-8.',rc);this.getSession().sendInvitationMessage({callId:this.callId,peerId:this.calleeId,type:"CallCancel",channelId:this._channelId,extra:this._content}),this.state=xa.CANCELED,this.emit("LocalInvitationCanceled")}},{key:"onAcceptReceived",value:function(e){if(this.isLocalInvitationEnd()&&this.state!==xa.ACCEPTED_BY_REMOTE)this.log("The invitation has ended, skipped emitting the %s event","LocalInvitationAccepted");else{if(this.state===xa.IDLE)throw new H("the local have not sent the invitation, how can remote accept it?");this.getSession().sendInvitationMessage({callId:this.callId,isAcceptAck:!0,type:"CallAccept",peerId:this.calleeId,channelId:this.channelId}),this.state===xa.ACCEPTED_BY_REMOTE?this.log("already in ACCEPTED_BY_REMOTE state, ignore emit ACCEPTED_BY_REMOTE"):(this.state===xa.SENT_TO_REMOTE&&(this.log("receive LocalInvitationAccepted before remote response to the invitation"),this.state=xa.RECEIVED_BY_REMOTE,this.emit("LocalInvitationReceivedByPeer")),this.state=xa.ACCEPTED_BY_REMOTE,this._response=e,this.emit("LocalInvitationAccepted",e))}}},{key:"onRefuseReceived",value:function(e){if(this.isLocalInvitationEnd())this.log("The invitation has ended, skipped emitting the %s event","LocalInvitationRefused");else{if(this.state===xa.IDLE)throw new H("the local have not sent the invitation, how can remote refuse it?");this.state===xa.SENT_TO_REMOTE&&(this.log("receive LocalInvitationRefused before remote response to the invitation"),this.state=xa.RECEIVED_BY_REMOTE,this.emit("LocalInvitationReceivedByPeer")),this._response=e,this.state=xa.REFUSED_BY_REMOTE,this.emit("LocalInvitationRefused",e)}}},{key:"isLocalInvitationEnd",value:function(){return[xa.CANCELED,xa.FAILURE,xa.ACCEPTED_BY_REMOTE,xa.REFUSED_BY_REMOTE].includes(this.state)}}]),t}(vb()),jd=Hr,da(jd.prototype,"send",[ia],Object.getOwnPropertyDescriptor(jd.prototype,"send"),jd.prototype),da(jd.prototype,"cancel",[ia],Object.getOwnPropertyDescriptor(jd.prototype,"cancel"),jd.prototype),jd),Bh=S.RemoteInvitationFailureReason,ib=S.RemoteInvitationState,BC=function(e){function t(e){var i=e.invitationChannel,o=e.extraContent,a=e.callId,s=e.callerId,c=e.logger;e=e.getSession,W(this,t);var u=r.call(this,c,"RtmRemoteInvitation",!0);return m(n(u),"state",ib.INVITATION_RECEIVED),m(n(u),"remoteInvitationEnd$",ya(fb(n(u),"RemoteInvitationCanceled"),fb(n(u),"RemoteInvitationRefused"),fb(n(u),"RemoteInvitationAccepted"),fb(n(u),"RemoteInvitationFailure")).pipe(Pa(1))),m(n(u),"callerId",void 0),m(n(u),"callId",void 0),m(n(u),"_getSession",void 0),m(n(u),"logger",void 0),m(n(u),"_content",void 0),m(n(u),"_channelId",void 0),m(n(u),"_response",""),u._channelId=i,u._content=o,u.callId=a,u.callerId=s,u._getSession=e,u.logger=c,u.remoteInvitationEnd$.pipe(Za(6e4),Ga((function(e){return Na(e)&&u.warn("Remote invitation expired"),ba(e)}))).subscribe({error:function(){u.state=ib.FAILURE,u.emit("RemoteInvitationFailure",Bh.INVITATION_EXPIRE)}}),u}ka(t,e);var r=la(t);return Ea(t,[{key:"channelId",get:function(){return this._channelId},set:function(e){throw new L('Cannot set the "response" of the RemoteInvitation instance.',rc)}},{key:"content",get:function(){return this._content},set:function(e){throw new L('Cannot set the "content" of the RemoteInvitation instance.',rc)}},{key:"response",get:function(){return this._response},set:function(e){this._response=e}},{key:"accept",value:function(){var e,t=this;if(this.isRemoteInvitationEnd())throw new H("The local invitation has ended. Cannot accept.",rh);if(this.state===ib.ACCEPT_SENT_TO_LOCAL)throw new H("The remote invitation is accepting. Cannot do the operation.",pq);if(8192<sg(this._response))throw new L('The length of the "response" overflows. The number of bytes representing content must not exceed 8 × 1024 if encoded in UTF-8.',rc);this.state=ib.ACCEPT_SENT_TO_LOCAL,Tb(Sl(1e3).pipe(eb((function(){return qd(K(w.mark((function e(){return w.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t._getSession().sendInvitationMessage({peerId:t.callerId,callId:t.callId,extra:t.response,type:"CallAccept",isAcceptAck:!1,channelId:t.channelId}));case 1:case"end":return e.stop()}}),e)}))))})),nb((function(t){return e=t.hasPeerReceived})),Pa(1)),fb(this,"RemoteInvitationAccepted")).pipe(Za(5e3),ob(this.remoteInvitationEnd$)).subscribe({error:function(n){if(t.logError(n),t.state=ib.FAILURE,Na(n))switch(e){case void 0:case!0:return void t.emit("RemoteInvitationFailure",Bh.ACCEPT_FAILURE);case!1:return void t.emit("RemoteInvitationFailure",Bh.PEER_OFFLINE)}t.emit("RemoteInvitationFailure",Bh.UNKNOWN)}})}},{key:"refuse",value:function(){if(this.state===ib.ACCEPT_SENT_TO_LOCAL)throw new H("The remote invitation is accepting. Cannot do the operation.",pq);if(this.isRemoteInvitationEnd())throw new H("The invitation is end. Cannot refuse",rh);if(8192<sg(this._response))throw new L('The length of the "response" overflows. The number of bytes representing content must not exceed 8 × 1024 if encoded in UTF-8.',rc);this._getSession().sendInvitationMessage({peerId:this.callerId,callId:this.callId,extra:this.response,type:"CallReject",channelId:this.channelId}),this.state=ib.REFUSED,this.emit("RemoteInvitationRefused")}},{key:"onCancelReceived",value:function(e){this.isRemoteInvitationEnd()?this.log("The invitation has ended, skipped emitting the %s event","RemoteInvitationCanceled"):(this.state===ib.ACCEPT_SENT_TO_LOCAL&&this.log("caller canceled before receive accept"),this._content=e,this.state=ib.CANCELED,this.emit("RemoteInvitationCanceled",e))}},{key:"onAcceptAckReceived",value:function(){this.state!==ib.ACCEPT_SENT_TO_LOCAL?this.log("The invitation has ended, skipped emitting the %s event","ori:".concat(this.state,", to: RemoteInvitationAccepted")):(this.state=ib.ACCEPTED,this.emit("RemoteInvitationAccepted"))}},{key:"isRemoteInvitationEnd",value:function(){return[ib.ACCEPTED,ib.REFUSED,ib.CANCELED,ib.FAILURE].includes(this.state)}}]),t}(vb()),CC=function(e){function t(e,i){W(this,t);var o=r.call(this,i,"InvitationManager");return m(n(o),"getSession",void 0),m(n(o),"invitationDispatcher",new aa.EventEmitter),m(n(o),"outgoingLocalInvitations",new Map),m(n(o),"receivedRemoteInvitations",new nc(void 0,{maxlen:1e4})),m(n(o),"logger",void 0),o.getSession=Fm(e),o.logger=i,o.invitationDispatcher.on("remoteInvitationToManager",(function(e){var t=e.callId,n=e.extra,r=e.callerId;e=e.channelId,o.receivedRemoteInvitations.has(t)||((n=new BC({callerId:r,callId:t,getSession:o.getSession,logger:i,extraContent:n,invitationChannel:e})).remoteInvitationEnd$.subscribe((function(){o.receivedRemoteInvitations.delete(t)})),o.receivedRemoteInvitations.set(t,n),o.emit("remoteInvitationInstance",n))})),o.invitationDispatcher.on("acceptAckToRemoteInvitation",(function(e){(e=o.receivedRemoteInvitations.get(e.callId))&&e.onAcceptAckReceived()})),o.invitationDispatcher.on("cancelToRemoteInvitation",(function(e){var t=e.extra;(e=o.receivedRemoteInvitations.get(e.callId))&&e.onCancelReceived(t)})),o.invitationDispatcher.on("acceptToLocalInvitation",(function(e){var t=e.extra;(e=o.outgoingLocalInvitations.get(e.callId))&&e.onAcceptReceived(t)})),o.invitationDispatcher.on("refuseToLocalInvitation",(function(e){var t=e.extra;(e=o.outgoingLocalInvitations.get(e.callId))&&e.onRefuseReceived(t)})),o}ka(t,e);var r=la(t);return Ea(t,[{key:"invitationMessageHandler",value:function(e){var t=e.body,n=t.callId,r=t.extra;r=void 0===r?"":r;var i=t.type,o=void 0===(t=t.channel)?"":t,a=e.type;switch(t=e.peerId,e=e.serverReceivedTs,a){case"CallAccept":"ack"===i?this.invitationDispatcher.emit("acceptAckToRemoteInvitation",{callId:n}):"request"===i&&this.invitationDispatcher.emit("acceptToLocalInvitation",{callId:n,extra:r});break;case"CallInvite":this.invitationDispatcher.emit("remoteInvitationToManager",{callId:n,callerId:t,extra:r,channelId:o});break;case"CallCancel":if("0"===n){n="".concat("AgoraRTMLegacyEndcallCompatibleMessagePrefix","_").concat(o,"_").concat(r),this.getSession().emit("peerTextMessage",{peerId:t,properties:{serverReceivedTs:e,isOfflineMessage:!1},text:n});break}this.invitationDispatcher.emit("cancelToRemoteInvitation",{callId:n,extra:r});break;case"CallReject":this.invitationDispatcher.emit("refuseToLocalInvitation",{callId:n,extra:r});break;default:throw mm("invitationType",a)}}},{key:"genLocalInvitation",value:function(e){var t=this,n=new AC(e,this.getSession,this.logger);return n.localInvitationEnd$.subscribe((function(){t.outgoingLocalInvitations.delete(n.callId)})),this.outgoingLocalInvitations.set(n.callId,n),n}}]),t}(vb()),DC=function(e,t,n){var r=!0,i=!0;if("function"!=typeof e)throw new TypeError("Expected a function");return jb(n)&&(r="leading"in n?!!n.leading:r,i="trailing"in n?!!n.trailing:i),KB(e,t,{leading:r,maxWait:t,trailing:i})},wb,Ir,Pe;!function(e){e[e.JOINED=0]="JOINED",e[e.LEFT=1]="LEFT"}(Pe||(Pe={}));var Jr=S.ConnectionState,EC=(Ir=function(e){function t(e,i,o,a){W(this,t);var s=r.call(this,a,"RtmChannel",!0);return m(n(s),"onMemberCountUpdated",DC((function(e){e!==s.memberCount&&(s.memberCount=e,s.emit("MemberCountUpdated",e))}),1e3)),m(n(s),"getSession",void 0),m(n(s),"memberCount",0),m(n(s),"memberJoinedLru",new nc(void 0,{maxlen:1e4})),m(n(s),"memberLeftLru",new nc(void 0,{maxlen:1e4})),m(n(s),"memberJoinStateLru",new nc(void 0,{maxlen:1e4})),m(n(s),"attributesSeqLru",new nc(void 0,{maxlen:1e4})),m(n(s),"channelId",void 0),m(n(s),"client",void 0),m(n(s),"onAttributesUpdated",(function(e){var t=e.channelId,n=e.attributeMaps,r=e.seq;e=e.instance.toString();var i=s.attributesSeqLru.get(e);if((!i||r.greaterThan(i))&&(s.attributesSeqLru.set(e,r),t===s.channelId)){for(t={},r=0;r<n.length;r++){var o=n[r];e=o.key,i=o.ms;var a=o.value;if(o=o.origin,"string"!=typeof e||!U.isLong(i)||"string"!=typeof a||!ua(o))break;t[e]={value:a,lastUpdateUserId:o,lastUpdateTs:i.toNumber()}}s.emit("AttributesUpdated",t)}})),m(n(s),"onChannelTextMessage",(function(e){var t=e.memberId,n=e.text,r=e.properties;e.channelId===s.channelId&&s.emit("ChannelMessage",{text:n,messageType:S.MessageType.TEXT},t,r)})),m(n(s),"onChannelMediaMessage",(function(e){var t=e.memberId,n=e.properties,r=e.details,i=e.messageType;e.channelId===s.channelId&&("FILE"===i?s.emit("ChannelMessage",{messageType:S.MessageType.FILE,size:parseInt(na(r.media_size),10),description:na(r.media_description),fileName:na(r.media_filename),mediaId:na(r.media_id),thumbnail:new Blob([r.media_thumbnail])},t,n):"IMAGE"===i&&s.emit("ChannelMessage",{messageType:S.MessageType.IMAGE,size:parseInt(na(r.media_size),10),description:na(r.media_description),fileName:na(r.media_filename),mediaId:na(r.media_id),thumbnail:new Blob([r.media_thumbnail]),height:parseInt(na(r.media_height),10),width:parseInt(na(r.media_width),10),thumbnailHeight:parseInt(na(r.media_thumbnailheight),10),thumbnailWidth:parseInt(na(r.media_thumbnailwidth),10)},t,n))})),m(n(s),"onChannelRawMessage",(function(e){var t=e.desc,n=e.raw,r=e.memberId,i=e.properties;e.channelId===s.channelId&&s.emit("ChannelMessage",{messageType:S.MessageType.RAW,rawMessage:n,description:t},r,i)})),m(n(s),"onMemberNotice",(function(e){var t=e.memberId,n=e.type,r=e.size;if(e.channelId===s.channelId){var i=e.instance.toString();e=e.seq.toString();var o={MemberLeft:s.memberLeftLru,MemberJoined:s.memberJoinedLru,MemberCountUpdated:void 0}[n];if(o){if(o.has(i+e))return void s.log("received duplicated %s notice (seq: %s), channel '%s', member '%s'",n,e,s.channelId,t);if(o.set(i+e,void 0),"string"!=typeof t)return;if(t!==s.getSession().context.uid){if((i=s.memberJoinStateLru.get(t))===Pe.JOINED&&"MemberJoined"===n)return void s.log("received duplicated %s state (seq: %s), channel '%s', member '%s'",n,e,s.channelId,t);if(i===Pe.LEFT&&"MemberLeft"===n)return void s.log("received duplicated %s state (seq: %s), channel '%s', member '%s'",n,e,s.channelId,t)}s.memberJoinStateLru.set(t,"MemberJoined"===n?Pe.JOINED:Pe.LEFT)}s.info("Channel %s - %s, memberId: %s",n,s.channelId,"MemberCountUpdated"===n?"[unknown]":t),i=t===s.getSession().context.uid,"MemberLeft"===n&&ua(t)||"MemberJoined"===n&&ua(t)?(i||s.emit(n,t),s.onMemberCountUpdated(r)):"MemberCountUpdated"===n&&"number"==typeof r&&s.onMemberCountUpdated(r)}})),s.getSession=Fm(i),s.channelId=e,s.client=o,s.info("A channel created, id %s",e),s}ka(t,e);var r=la(t);return Ea(t,[{key:"join",value:function(){var e=K(w.mark((function e(){var t,n,r,i,o,a,s,c,u,l,d,h,f;return w.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(ua(this.channelId)){e.next=2;break}throw new L(["The %s in the arguments is invalid","channelId"],Gz);case 2:e.prev=2,t=this.getSession(),e.next=9;break;case 6:throw e.prev=6,e.t0=e.catch(2),new H("The client is not logged in. Cannot do the operation",uq);case 9:if(!t.joinedChannels.has(this)){e.next=12;break}throw cb("ChnJoin",{cname:this.channelId,lts:U.fromNumber(Date.now()),userId:t.context.uid,elapse:db(t.startTime),errCode:tq,sid:Sa(t.instanceId)},null===(n=t.context.areaConfig)||void 0===n?void 0:n.EVENT_REPORT_DOMAIN[0],null===(r=t.context.areaConfig)||void 0===r?void 0:r.EVENT_REPORT_BACKUP_DOMAIN[0]),new H("The channel has joined. Cannot rejoin",tq);case 12:if(e.prev=12,this.log("Joining the channel %s",this.channelId),!this.hasOtherChannelJoined()){e.next=17;break}throw cb("ChnJoin",{cname:this.channelId,lts:U.fromNumber(Date.now()),userId:t.context.uid,elapse:db(t.startTime),errCode:vq,sid:Sa(t.instanceId)},null===(c=t.context.areaConfig)||void 0===c?void 0:c.EVENT_REPORT_DOMAIN[0],null===(u=t.context.areaConfig)||void 0===u?void 0:u.EVENT_REPORT_BACKUP_DOMAIN[0]),new H("A channel of the same channel ID has already joined. Cannot rejoin",vq);case 17:if(20!==t.joinedChannels.size){e.next=20;break}throw cb("ChnJoin",{cname:this.channelId,lts:U.fromNumber(Date.now()),userId:t.context.uid,elapse:db(t.startTime),errCode:sq,sid:Sa(t.instanceId)},null===(l=t.context.areaConfig)||void 0===l?void 0:l.EVENT_REPORT_DOMAIN[0],null===(d=t.context.areaConfig)||void 0===d?void 0:d.EVENT_REPORT_BACKUP_DOMAIN[0]),new gb("The joined channels has exceeded the limit of 20",sq);case 20:return cb("ChnJoin",{cname:this.channelId,lts:U.fromNumber(Date.now()),userId:t.context.uid,elapse:db(t.startTime),errCode:0,sid:Sa(t.instanceId)},null===(i=t.context.areaConfig)||void 0===i?void 0:i.EVENT_REPORT_DOMAIN[0],null===(o=t.context.areaConfig)||void 0===o?void 0:o.EVENT_REPORT_BACKUP_DOMAIN[0]),e.next=23,t.requestChannelJoin(this,this.channelId);case 23:cb("ChnJoinRes",{cname:this.channelId,lts:U.fromNumber(Date.now()),elapse:db(t.startTime),errCode:0,sid:Sa(t.instanceId),serverErrCode:0,userId:t.context.uid},null===(a=t.context.areaConfig)||void 0===a?void 0:a.EVENT_REPORT_DOMAIN[0],null===(s=t.context.areaConfig)||void 0===s?void 0:s.EVENT_REPORT_BACKUP_DOMAIN[0]),this.info("The channel %s joined successfully",this.channelId),t.on("channelTextMessage",this.onChannelTextMessage),t.on("channelRawMessage",this.onChannelRawMessage),t.on("channelMediaMessage",this.onChannelMediaMessage),t.on("memberNotice",this.onMemberNotice),t.on("channelAttributesUpdated",this.onAttributesUpdated),e.next=41;break;case 32:if(e.prev=32,e.t1=e.catch(12),this.logError(e.t1),!wa(e.t1)){e.next=37;break}throw e.t1;case 37:if(!Na(e.t1)){e.next=40;break}throw cb("ChnJoinRes",{cname:this.channelId,lts:U.fromNumber(Date.now()),elapse:db(t.startTime),errCode:rq,sid:Sa(t.instanceId),serverErrCode:0,userId:t.context.uid},null===(h=t.context.areaConfig)||void 0===h?void 0:h.EVENT_REPORT_DOMAIN[0],null===(f=t.context.areaConfig)||void 0===f?void 0:f.EVENT_REPORT_BACKUP_DOMAIN[0]),new bb(["Join channel %s timed out",this.channelId],rq);case 40:throw new Pc(["The channel %s join failure",this.channelId],{code:qq,originalError:e.t1});case 41:case"end":return e.stop()}}),e,this,[[2,6],[12,32]])})));return function(){return e.apply(this,arguments)}}()},{key:"leave",value:function(){var e=K(w.mark((function e(){var t,n,r,i,o,a,s;return w.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,r=this.getSession(),e.next=7;break;case 4:throw e.prev=4,e.t0=e.catch(0),new H("The client is not logged in. Cannot do the operation",Iz);case 7:if(r.joinedChannels.has(this)){e.next=9;break}throw new H("The channel does not join. Cannot do the operation",Hz);case 9:e.prev=9,r.requestChannelLeave(this,this.channelId),this.memberLeftLru.empty(),this.memberJoinedLru.empty(),this.attributesSeqLru.empty(),this.memberJoinStateLru.empty(),this.memberCount=0,r.removeListener("channelTextMessage",this.onChannelTextMessage),r.removeListener("channelRawMessage",this.onChannelRawMessage),r.removeListener("channelMediaMessage",this.onChannelMediaMessage),r.removeListener("memberNotice",this.onMemberNotice),r.removeListener("channelAttributesUpdated",this.onAttributesUpdated),e.next=32;break;case 23:if(e.prev=23,e.t1=e.catch(9),this.logError(e.t1),!wa(e.t1)){e.next=30;break}throw void 0===e.t1.code&&(e.t1.code=xq),cb("ChnLeave",{cname:this.channelId,lts:U.fromNumber(Date.now()),elapse:db(r.startTime),errCode:xq,sid:Sa(r.instanceId),userId:r.context.uid},null===(a=r.context.areaConfig)||void 0===a?void 0:a.EVENT_REPORT_DOMAIN[0],null===(s=r.context.areaConfig)||void 0===s?void 0:s.EVENT_REPORT_BACKUP_DOMAIN[0]),e.t1;case 30:throw cb("ChnLeave",{cname:this.channelId,lts:U.fromNumber(Date.now()),elapse:db(r.startTime),errCode:wq,sid:Sa(r.instanceId),userId:r.context.uid},null===(i=r.context.areaConfig)||void 0===i?void 0:i.EVENT_REPORT_DOMAIN[0],null===(o=r.context.areaConfig)||void 0===o?void 0:o.EVENT_REPORT_BACKUP_DOMAIN[0]),new Pc("The channel leave failure",{code:wq,originalError:e.t1});case 32:cb("ChnLeave",{cname:this.channelId,lts:U.fromNumber(Date.now()),elapse:db(r.startTime),errCode:0,sid:Sa(r.instanceId),userId:r.context.uid},null===(t=r.context.areaConfig)||void 0===t?void 0:t.EVENT_REPORT_DOMAIN[0],null===(n=r.context.areaConfig)||void 0===n?void 0:n.EVENT_REPORT_BACKUP_DOMAIN[0]);case 33:case"end":return e.stop()}}),e,this,[[0,4],[9,23]])})));return function(){return e.apply(this,arguments)}}()},{key:"sendMessage",value:function(){var e=K(w.mark((function e(t){var n,r,i,o,a,s=this,c=arguments;return w.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=1<c.length&&void 0!==c[1]?c[1]:{},r=n.enableHistoricalMessaging,i=void 0!==r&&r,ym(t,qh),e.prev=2,o=this.getSession(),e.next=9;break;case 6:throw e.prev=6,e.t0=e.catch(2),new H("The client is not logged in. Cannot do the operation",Uf);case 9:if(o.joinedChannels.has(this)){e.next=11;break}throw new H("The channel does not join. Cannot do the operation",Uf);case 11:if(this.client.connectionState!==Jr.RECONNECTING){e.next=16;break}return a=Date.now(),e.next=15,new Promise((function(e,n){var r=function(){var r=K(w.mark((function r(){var c;return w.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return c=Date.now()-a,r.prev=1,r.next=4,pg({message:t,peerId:s.channelId,toPeer:!1,session:s.getSession(),errorCodes:{NOT_LOGGED_IN:Uf,TOO_OFTEN:mq},diff:c,logger:s.logger,options:{enableHistoricalMessaging:i,enableOfflineMessaging:!1}});case 4:e(),r.next=12;break;case 7:r.prev=7,r.t0=r.catch(1),Na(r.t0)&&n(new bb(Md(s.name,"sendMessageToPeer",1e4),Gk)),wa(r.t0)&&n(r.t0),n(new ca("Channel message send failure",{code:Tf,originalError:r.t0}));case 12:return r.prev=12,clearTimeout(o),r.finish(12);case 15:case"end":return r.stop()}}),r,null,[[1,7,12,15]])})));return function(){return r.apply(this,arguments)}}();s.client.internalEmitter.once("RECONNECTED",r);var o=setTimeout((function(){s.client.internalEmitter.off("RECONNECTED",r),n(new bb(Md(s.name,"sendMessageToPeer",1e4),Gk))}),9e3)}));case 15:return e.abrupt("return");case 16:if(this.client.connectionState===Jr.CONNECTED){e.next=18;break}throw new H("The client is not logged in. Cannot do the operation",Uf);case 18:return e.prev=18,e.next=21,pg({message:t,peerId:this.channelId,toPeer:!1,session:this.getSession(),errorCodes:{NOT_LOGGED_IN:Uf,TOO_OFTEN:mq},diff:0,logger:this.logger,options:{enableHistoricalMessaging:i,enableOfflineMessaging:!1}});case 21:e.next=31;break;case 23:if(e.prev=23,e.t1=e.catch(18),!Na(e.t1)){e.next=27;break}throw new bb(Md(this.name,"sendMessage",1e4),Gk);case 27:if(!wa(e.t1)){e.next=30;break}throw this.logError(e.t1),e.t1;case 30:throw new Pc("The channel message send failure",Tf);case 31:case"end":return e.stop()}}),e,this,[[2,6],[18,23]])})));return function(t){return e.apply(this,arguments)}}()},{key:"getMembers",value:function(){var e=K(w.mark((function e(){var t,n,r;return w.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,e.prev=1,t=this.getSession(),e.next=8;break;case 5:throw e.prev=5,e.t0=e.catch(1),new H("The client is not logged in. Cannot do the operation",Dz);case 8:if(t.joinedChannels.has(this)){e.next=10;break}throw new H("The channel does not join. Cannot do the operation",Cz);case 10:return n=this.getSession().requestChannelMemberList(this.channelId),e.next=13,n.pipe(Z((function(e){return e.memberInfos.map((function(e){return e.account}))}))).toPromise();case 13:return r=e.sent,this.info("Channel %s - get members success, %o",this.channelId,r),e.abrupt("return",r);case 18:if(e.prev=18,e.t1=e.catch(0),!wa(e.t1)){e.next=23;break}throw this.logError(e.t1),e.t1;case 23:throw new Pc("The channel members get failure",Az);case 24:case"end":return e.stop()}}),e,this,[[0,18],[1,5]])})));return function(){return e.apply(this,arguments)}}()},{key:"hasOtherChannelJoined",value:function(){var e=this;return!this.getSession().joinedChannels.has(this)&&Array.from(this.getSession().joinedChannels).some((function(t){return t.channelId===e.channelId}))}}]),t}(vb()),wb=Ir,da(wb.prototype,"join",[ia],Object.getOwnPropertyDescriptor(wb.prototype,"join"),wb.prototype),da(wb.prototype,"leave",[ia],Object.getOwnPropertyDescriptor(wb.prototype,"leave"),wb.prototype),da(wb.prototype,"sendMessage",[ia],Object.getOwnPropertyDescriptor(wb.prototype,"sendMessage"),wb.prototype),da(wb.prototype,"getMembers",[ia],Object.getOwnPropertyDescriptor(wb.prototype,"getMembers"),wb.prototype),wb),C,Kr,Cb=S.ConnectionChangeReason,Q=S.ConnectionState,Lr={DISCONNECTED:1,CONNECTING:2,CONNECTED:3,RECONNECTING:4,ABORTED:5},FC={LOGIN:1,LOGIN_SUCCESS:2,LOGIN_FAILURE:3,LOGIN_TIMEOUT:4,INTERRUPTED:5,LOGOUT:6,BANNED_BY_SERVER:7,REMOTE_LOGIN:8},GC=(Kr=function(e){function t(e,i,o,a,s){W(this,t);var c=r.call(this,i,"RtmClient",!0);return m(n(c),"connectionState",Q.DISCONNECTED),m(n(c),"internalEmitter",new aa),m(n(c),"context",void 0),m(n(c),"attributes",{}),m(n(c),"loginPromise",void 0),m(n(c),"attributeDrafts",new Set),m(n(c),"session",void 0),m(n(c),"lastLoginTime",void 0),m(n(c),"reconnId",0),m(n(c),"channelAttributesCacheLru",new nc(void 0,{maxlen:1e4})),m(n(c),"invitationManager",void 0),m(n(c),"subscribedPeerStatusCache",{}),m(n(c),"peerStatusSeqLru",new nc(void 0,{maxlen:1e4})),m(n(c),"peerUnreachableTimers",{}),m(n(c),"mediaTaskManager",void 0),m(n(c),"config",void 0),m(n(c),"setParameters",void 0),m(n(c),"updateConfig",void 0),m(n(c),"userDropHandler",(function(e){if(c.connectionState!==Q.ABORTED)switch(e){case 11:c.logError("Kicked off by remote session"),c.onConnectionStateChanged(Q.ABORTED,Cb.REMOTE_LOGIN);break;case 14:case 15:case 16:c.logError("Server banned because of illegal ".concat({14:"User ID",15:"IP",16:"Channel Name"}[e])),c.onConnectionStateChanged(Q.ABORTED,Cb.BANNED_BY_SERVER);break;default:c.logError("User kicked off for unknown code: ".concat(e)),c.onConnectionStateChanged(Q.ABORTED,Cb.INTERRUPTED)}})),c.context=new qC(e,i),c.mediaTaskManager=new zr(i),c.config=o,c.internalEmitter.setMaxListeners(512),c.setParameters=a.bind(n(c)),c.updateConfig=a.bind(n(c)),void 0!==s&&c.context.setAreaConfig(s),c.invitationManager=new CC((function(){return c.session}),i),c.invitationManager.on("remoteInvitationInstance",(function(e){c.emit("RemoteInvitationReceived",e)})),c}ka(t,e);var r=la(t);return Ea(t,[{key:"renewToken",value:function(){var e=K(w.mark((function e(t){var n,r,i,o=this;return w.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("string"==typeof t&&0!==t.length){e.next=2;break}throw new L("Invalid argument",Qz);case 2:if(this.connectionState!==Q.ABORTED){e.next=5;break}return e.next=5,new Promise((function(){}));case 5:if(this.connectionState===Q.CONNECTED||this.connectionState===Q.RECONNECTING){e.next=7;break}throw new H("The client is not logged in",Tz);case 7:if(void 0!==this.session){e.next=9;break}throw new Ca({SESSION_NOT_FOUND:"Failed to get session of the client"});case 9:return e.prev=9,n=this.context.token,this.context.token=t,e.next=14,this.session.connection.apClient.getApEdgeInfo$(!1).pipe(rd((function(){return Error("No available edge address to connect")})),ae((function(e){return e.pipe(Y((function(e){if(wa(e))throw e})),Wc(1500),Pa(4))})),Pa(1),Za(1e4),Ga((function(e){return Na(e)&&o.warn("renewToken timed out"),ba(e)}))).toPromise();case 14:r=e.sent,i=r.ticket,e.next=27;break;case 18:if(e.prev=18,e.t0=e.catch(9),this.context.token=n,e.t0.code!==zq&&e.t0.code!==Aq){e.next=23;break}throw new Ke("Invalid token",Sz);case 23:if(e.t0.code!==uh){e.next=25;break}throw new Ke("The token expired",Rz);case 25:if(!Na(e.t0)){e.next=27;break}throw new bb("Renew token timed out",Pz);case 27:this.session.curLoginSockets.filter((function(e){return void 0!==e})).forEach((function(e){return e.ticket=i}));case 28:case"end":return e.stop()}}),e,this,[[9,18]])})));return function(t){return e.apply(this,arguments)}}()},{key:"queryPeersOnlineStatus",value:function(){var e=K(w.mark((function e(t){var n,r,i=this;return w.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.connectionState===Q.CONNECTED){e.next=2;break}throw new H("The client is not logged in",Oz);case 2:if(void 0!==this.session){e.next=4;break}throw new Ca({SESSION_NOT_FOUND:"Failed to get session of the client"});case 4:if(!(!Array.isArray(t)||0===t.length||t.some((function(e){return!ua(e)}))||256<t.length)){e.next=6;break}throw new L("invalid arguments",Eq);case 6:return e.next=8,this.session.requestPeersOnlineStatus(t).toPromise();case 8:return n=e.sent,r=oc(sk(n.userInfos,"account"),(function(e){return!!e.ts})),Object.keys(r).forEach((function(e){if(e in i.subscribedPeerStatusCache&&i.subscribedPeerStatusCache[e]!==S.PeerOnlineState.UNREACHABLE){var t=r[e]?S.PeerOnlineState.ONLINE:S.PeerOnlineState.OFFLINE;i.emit("PeersOnlineStatusChanged",m({},e,t)),i.subscribedPeerStatusCache[e]=t}})),e.abrupt("return",r);case 12:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getChannelMemberCount",value:function(){var e=K(w.mark((function e(t){var n,r,i,o,a,s,c,u=this;return w.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.connectionState===Q.CONNECTED){e.next=2;break}throw new H("The client is not logged in",zz);case 2:if(void 0!==this.session){e.next=4;break}throw new Ca({SESSION_NOT_FOUND:"Failed to get session of the client"});case 4:if(Array.isArray(t)&&t.every((function(e){return"string"==typeof e}))&&0!==t.length){e.next=6;break}throw new L("Invalid arguments: channelIds",nq);case 6:if(!(32<t.length)){e.next=8;break}throw new L("getChannelMemberCount exceed limit of 32 channelIds",yz);case 8:n=0;case 9:if(!(n<t.length)){e.next=16;break}if(ua(r=t[n])){e.next=13;break}throw new L(["getChannelMemberCount channel id %s is invalid",r],nq);case 13:n++,e.next=9;break;case 16:return e.next=18,this.session.requestGetChannelMemberCount(t).toPromise();case 18:for(i=e.sent,o=i.groupInfos,a={},s=function(e){var t=(e=o[e]).group,n=e.memberCount;ua(t)&&"number"==typeof n&&(u.session.joinedChannels.forEach((function(e){e.channelId===t&&e.onMemberCountUpdated(n)})),a[t]=n)},c=0;c<o.length;c++)s(c);return e.abrupt("return",a);case 24:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"setLocalUserAttributes",value:function(){var e=K(w.mark((function e(t){var n,r;return w.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(ff({attributes:t,maxAttrValueSize:8192,maxAttrsCount:32,maxTotalSize:16384}),this.connectionState===Q.CONNECTED){e.next=3;break}throw new H("The client is not logged in",Qb);case 3:if(void 0!==this.session){e.next=5;break}throw new Ca({SESSION_NOT_FOUND:"Failed to get session of the client"});case 5:return n=this.session.requestSetLocalUserAttributes(t).toPromise(),r={attribute:t,promise:n},this.attributeDrafts.add(r),e.prev=8,e.next=11,n;case 11:this.attributes=t,e.next=19;break;case 14:if(e.prev=14,e.t0=e.catch(8),!wa(e.t0)){e.next=18;break}throw e.t0;case 18:throw new L("arguments is not valid",Fa);case 19:return e.prev=19,this.attributeDrafts.delete(r),e.finish(19);case 22:case"end":return e.stop()}}),e,this,[[8,14,19,22]])})));return function(t){return e.apply(this,arguments)}}()},{key:"setChannelAttributes",value:function(){var e=K(w.mark((function e(t,n){var r,i,o,a,s,c=arguments;return w.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=2<c.length&&void 0!==c[2]?c[2]:{},i=r.enableNotificationToChannelMembers,o=void 0!==i&&i,ff({attributes:n,maxAttrValueSize:8192,maxAttrsCount:32,maxTotalSize:32768}),this.connectionState===Q.CONNECTED){e.next=4;break}throw new H("The client is not logged in",Qb);case 4:if(void 0!==this.session){e.next=6;break}throw new Ca({SESSION_NOT_FOUND:"Failed to get session of the client"});case 6:return a=this.session.requestSetChannelAttributes(t,n,o).toPromise(),e.prev=7,e.next=10,a;case 10:s=oc(n,(function(e){return new Blob([e]).size})),this.channelAttributesCacheLru.set(t,s),e.next=19;break;case 14:if(e.prev=14,e.t0=e.catch(7),!wa(e.t0)){e.next=18;break}throw e.t0;case 18:throw new L("arguments is not valid",Fa);case 19:case"end":return e.stop()}}),e,this,[[7,14]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"addOrUpdateLocalUserAttributes",value:function(){var e=K(w.mark((function e(t){var n,r,i;return w.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=Ja(Ja({},this.attributes),t),ff({attributes:t,maxAttrValueSize:8192,maxAttrsCount:32,maxTotalSize:16384}),ff({attributes:n,maxAttrValueSize:8192,maxAttrsCount:32,maxTotalSize:16384}),this.connectionState===Q.CONNECTED){e.next=5;break}throw new H("The client is not logged in",Qb);case 5:if(void 0!==this.session){e.next=7;break}throw new Ca({SESSION_NOT_FOUND:"Failed to get session of the client"});case 7:return r=this.session.requestAddOrUpdateLocalUserAttributes(t).toPromise(),i={attribute:n,promise:r},this.attributeDrafts.add(i),e.prev=10,e.next=13,r;case 13:this.attributes=n,e.next=21;break;case 16:if(e.prev=16,e.t0=e.catch(10),!wa(e.t0)){e.next=20;break}throw e.t0;case 20:throw new L("arguments is not valid",Eq);case 21:return e.prev=21,this.attributeDrafts.delete(i),e.finish(21);case 24:case"end":return e.stop()}}),e,this,[[10,16,21,24]])})));return function(t){return e.apply(this,arguments)}}()},{key:"addOrUpdateChannelAttributes",value:function(){var e=K(w.mark((function e(t,n){var r,i,o,a,s,c,u,l=arguments;return w.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=2<l.length&&void 0!==l[2]?l[2]:{},i=r.enableNotificationToChannelMembers,o=void 0!==i&&i,a=this.channelAttributesCacheLru.get(t,{}),s=oc(n,(function(e){return new Blob([e]).size})),c=Ja(Ja({},a),s),ff({attributes:n,attrSizeMap:c,maxAttrValueSize:8192,maxAttrsCount:32,maxTotalSize:32768}),this.connectionState===Q.CONNECTED){e.next=7;break}throw new H("The client is not logged in",Qb);case 7:if(void 0!==this.session){e.next=9;break}throw new Ca({SESSION_NOT_FOUND:"Failed to get session of the client"});case 9:return u=this.session.requestAddOrUpdateChannelAttributes(t,n,o).toPromise(),e.prev=10,e.next=13,u;case 13:this.channelAttributesCacheLru.set(t,c),e.next=21;break;case 16:if(e.prev=16,e.t0=e.catch(10),!wa(e.t0)){e.next=20;break}throw e.t0;case 20:throw new L("arguments is not valid",Fa);case 21:case"end":return e.stop()}}),e,this,[[10,16]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"deleteLocalUserAttributesByKeys",value:function(){var e=K(w.mark((function e(t){var n,r,i,o;return w.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Array.isArray(t)&&0!==t.length&&!t.some((function(e){return 0===e.length}))){e.next=2;break}throw new H("arguments is not valid",Fa);case 2:if(this.connectionState===Q.CONNECTED){e.next=4;break}throw new H("The client is not logged in",Qb);case 4:if(void 0!==this.session){e.next=6;break}throw new Ca({SESSION_NOT_FOUND:"Failed to get session of the client"});case 6:return n=this.session.requestDeleteLocalUserAttributesByKeys(t).toPromise(),r={attribute:rg(this.attributes,t),promise:n},this.attributeDrafts.add(r),e.prev=9,e.next=12,n;case 12:for(i=0;i<t.length;i++)o=t[i],delete this.attributes[o];e.next=20;break;case 15:if(e.prev=15,e.t0=e.catch(9),!wa(e.t0)){e.next=19;break}throw e.t0;case 19:throw new L("arguments is not valid",Fa);case 20:return e.prev=20,this.attributeDrafts.delete(r),e.finish(20);case 23:case"end":return e.stop()}}),e,this,[[9,15,20,23]])})));return function(t){return e.apply(this,arguments)}}()},{key:"deleteChannelAttributesByKeys",value:function(){var e=K(w.mark((function e(t,n){var r,i,o,a,s,c,u,l=arguments;return w.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=2<l.length&&void 0!==l[2]?l[2]:{},i=r.enableNotificationToChannelMembers,o=void 0!==i&&i,Array.isArray(n)&&0!==n.length&&ua(t)&&!n.some((function(e){return 0===e.length||512<e.length}))){e.next=3;break}throw new H("arguments is not valid",Fa);case 3:if(this.connectionState===Q.CONNECTED){e.next=5;break}throw new H("The client is not logged in",Qb);case 5:if(void 0!==this.session){e.next=7;break}throw new Ca({SESSION_NOT_FOUND:"Failed to get session of the client"});case 7:return a=this.session.requestDeleteChannelAttributesByKeys(t,n,o).toPromise(),e.prev=8,e.next=11,a;case 11:if(s=this.channelAttributesCacheLru.get(t))for(c=0;c<n.length;c++)u=n[c],delete s[u];e.next=20;break;case 15:if(e.prev=15,e.t0=e.catch(8),!wa(e.t0)){e.next=19;break}throw e.t0;case 19:throw new L("arguments is not valid",Fa);case 20:case"end":return e.stop()}}),e,this,[[8,15]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"clearLocalUserAttributes",value:function(){var e=K(w.mark((function e(){var t,n;return w.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.connectionState===Q.CONNECTED){e.next=2;break}throw new H("The client is not logged in",Qb);case 2:if(void 0!==this.session){e.next=4;break}throw new Ca({SESSION_NOT_FOUND:"Failed to get session of the client"});case 4:return t=this.session.requestClearLocalUserAttributes().toPromise(),n={attribute:{},promise:t},this.attributeDrafts.add(n),e.prev=7,e.next=10,t;case 10:this.attributes={},e.next=18;break;case 13:if(e.prev=13,e.t0=e.catch(7),!wa(e.t0)){e.next=17;break}throw e.t0;case 17:throw new L("arguments is not valid",Fa);case 18:return e.prev=18,this.attributeDrafts.delete(n),e.finish(18);case 21:case"end":return e.stop()}}),e,this,[[7,13,18,21]])})));return function(){return e.apply(this,arguments)}}()},{key:"clearChannelAttributes",value:function(){var e=K(w.mark((function e(t){var n,r,i,o,a=arguments;return w.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=1<a.length&&void 0!==a[1]?a[1]:{},r=n.enableNotificationToChannelMembers,i=void 0!==r&&r,this.connectionState===Q.CONNECTED){e.next=3;break}throw new H("The client is not logged in",Qb);case 3:if(void 0!==this.session){e.next=5;break}throw new Ca({SESSION_NOT_FOUND:"Failed to get session of the client"});case 5:return o=this.session.requestClearChannelAttributes(t,i).toPromise(),e.prev=6,e.next=9,o;case 9:this.channelAttributesCacheLru.delete(t),e.next=17;break;case 12:if(e.prev=12,e.t0=e.catch(6),!wa(e.t0)){e.next=16;break}throw e.t0;case 16:throw new L("arguments is not valid",Fa);case 17:case"end":return e.stop()}}),e,this,[[6,12]])})));return function(t){return e.apply(this,arguments)}}()},{key:"getUserAttributes",value:function(){var e=K(w.mark((function e(t){var n,r,i;return w.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(ua(t)){e.next=2;break}throw new L("Not a valid user ID",Fa);case 2:if(this.connectionState===Q.CONNECTED){e.next=4;break}throw new H("The client is not logged in",Qb);case 4:if(void 0!==this.session){e.next=6;break}throw new Ca({SESSION_NOT_FOUND:"Failed to get session of the client"});case 6:return e.prev=6,e.next=9,this.session.requestGetUserAttributeKeys(t).toPromise();case 9:return n=e.sent,r=n.keys,e.next=13,this.session.requestGetUserAttributesByKeys(t,r.slice(0,512)).toPromise();case 13:i=e.sent,e.next=21;break;case 16:if(e.prev=16,e.t0=e.catch(6),!wa(e.t0)){e.next=20;break}throw e.t0;case 20:throw new L("arguments is not valid",Fa);case 21:return e.abrupt("return",yp(i.attributeInfos.map((function(e){return[e.key,e.value]}))));case 22:case"end":return e.stop()}}),e,this,[[6,16]])})));return function(t){return e.apply(this,arguments)}}()},{key:"getChannelAttributes",value:function(){var e=K(w.mark((function e(t){var n,r,i,o,a,s,c,u,l,d,h;return w.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(ua(t)){e.next=2;break}throw new L("Not a valid channel ID",Fa);case 2:if(this.connectionState===Q.CONNECTED){e.next=4;break}throw new H("The client is not logged in",Qb);case 4:if(void 0!==this.session){e.next=6;break}throw new Ca({SESSION_NOT_FOUND:"Failed to get session of the client"});case 6:return e.prev=6,e.next=9,this.session.requestGetChannelAttributesKeys(t).toPromise();case 9:return n=e.sent,r=n.keys,e.next=13,this.session.requestGetChannelAttributesByKeys(t,r).toPromise();case 13:i=e.sent,o=i.attributeMaps,e.next=22;break;case 17:if(e.prev=17,e.t0=e.catch(6),!wa(e.t0)){e.next=21;break}throw e.t0;case 21:throw new L("arguments is not valid",Fa);case 22:a={},s=0;case 24:if(!(s<o.length)){e.next=32;break}if(c=o[s],u=c.key,l=c.ms,d=c.value,h=c.origin,"string"==typeof u&&U.isLong(l)&&"string"==typeof d&&ua(h)){e.next=28;break}return e.abrupt("break",32);case 28:a[u]={value:d,lastUpdateUserId:h,lastUpdateTs:l.toNumber()};case 29:s++,e.next=24;break;case 32:return this.channelAttributesCacheLru.set(t,oc(a,(function(e){return new Blob([e.value]).size}))),e.abrupt("return",a);case 34:case"end":return e.stop()}}),e,this,[[6,17]])})));return function(t){return e.apply(this,arguments)}}()},{key:"getChannelAttributesByKeys",value:function(){var e=K(w.mark((function e(t,n){var r,i,o,a,s,c,u,l,d,h;return w.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.connectionState===Q.CONNECTED){e.next=2;break}throw new H("The client is not logged in",Qb);case 2:if(void 0!==this.session){e.next=4;break}throw new Ca({SESSION_NOT_FOUND:"Failed to get session of the client"});case 4:return lm(t,n),e.prev=5,e.next=8,this.session.requestGetChannelAttributesByKeys(t,n).toPromise();case 8:r=e.sent,i=r.attributeMaps,e.next=17;break;case 12:if(e.prev=12,e.t0=e.catch(5),!wa(e.t0)){e.next=16;break}throw e.t0;case 16:throw new L("arguments is not valid",Fa);case 17:o={},a=this.channelAttributesCacheLru.get(t,{}),s=0;case 20:if(!(s<i.length)){e.next=29;break}if(c=i[s],u=c.key,l=c.ms,d=c.value,h=c.origin,"string"==typeof u&&U.isLong(l)&&"string"==typeof d&&ua(h)){e.next=24;break}return e.abrupt("break",29);case 24:a[u]=new Blob([d]).size,o[u]={value:d,lastUpdateUserId:h,lastUpdateTs:l.toNumber()};case 26:s++,e.next=20;break;case 29:return this.channelAttributesCacheLru.set(t,a),e.abrupt("return",o);case 31:case"end":return e.stop()}}),e,this,[[5,12]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"getUserAttributesByKeys",value:function(){var e=K(w.mark((function e(t,n){var r;return w.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.connectionState===Q.CONNECTED){e.next=2;break}throw new H("The client is not logged in",Qb);case 2:if(void 0!==this.session){e.next=4;break}throw new Ca({SESSION_NOT_FOUND:"Failed to get session of the client"});case 4:return lm(t,n),e.prev=5,e.next=8,this.session.requestGetUserAttributesByKeys(t,n).toPromise();case 8:r=e.sent,e.next=16;break;case 11:if(e.prev=11,e.t0=e.catch(5),!wa(e.t0)){e.next=15;break}throw e.t0;case 15:throw new L("arguments is not valid",Fa);case 16:return e.abrupt("return",yp(r.attributeInfos.map((function(e){return[e.key,e.value]}))));case 17:case"end":return e.stop()}}),e,this,[[5,11]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"login",value:function(){var e=K(w.mark((function e(t){var n,r,i,o,a,s,c;return w.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=lg(),o=t.token,t.token===this.context.appId&&(o=void 0),cb("Session",{appId:this.context.appId,did:navigator.userAgent,elapse:db(this.session&&this.session.startTime),index:{index1:t.uid,index2:this.context.appId,index3:"enableLogUpload=".concat(this.config.enableLogUpload)},installId:Sf,lts:U.fromNumber(Date.now()),os:7,sid:Sa(i),token:o||"",userId:t.uid,ver:"1.4.2",buildno:801,subVersion:301,version:5},null===(n=this.context.areaConfig)||void 0===n?void 0:n.EVENT_REPORT_DOMAIN[0],null===(r=this.context.areaConfig)||void 0===r?void 0:r.EVENT_REPORT_BACKUP_DOMAIN[0]),md(t)&&ua(t.uid)){e.next=6;break}throw new L("not a valid user id",th);case 6:if("string"!=typeof o||!o){e.next=10;break}this.context.token=o,e.next=12;break;case 10:if("string"==typeof o||null==o){e.next=12;break}throw new L('The "token" is not a valid string.',th);case 12:return a=Date.now(),this.context.sid=Sa(i),this.loginPromise=this.loginImpl({uid:t.uid,instanceId:i}),this.info("RTM Client logging in as ".concat(t.uid)),e.prev=16,e.next=19,this.loginPromise;case 19:e.next=26;break;case 21:throw e.prev=21,e.t0=e.catch(16),wa(e.t0)&&cb("Link",{ackedServerIp:"",destServerIp:"",ec:e.t0.code||1,sc:e.t0.serverCode,elapse:db(this.session&&this.session.startTime),lts:U.fromNumber(Date.now()),responseTime:Date.now()-a,sid:Sa(i),userId:t.uid},null===(s=this.context.areaConfig)||void 0===s?void 0:s.EVENT_REPORT_DOMAIN[0],null===(c=this.context.areaConfig)||void 0===c?void 0:c.EVENT_REPORT_BACKUP_DOMAIN[0]),this.context.token=void 0,e.t0;case 26:return e.prev=26,this.loginPromise=void 0,e.finish(26);case 29:case"end":return e.stop()}}),e,this,[[16,21,26,29]])})));return function(t){return e.apply(this,arguments)}}()},{key:"logout",value:function(){var e=K(w.mark((function e(){var t,n;return w.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.loginPromise){e.next=3;break}return e.next=3,this.loginPromise;case 3:if(this.connectionState!==Q.DISCONNECTED){e.next=6;break}throw this.logError("Already in logout state"),new H("Logout failure. The client has already been logged out",Bq);case 6:if(this.connectionState!==Q.ABORTED){e.next=10;break}return this.info('Reset connection state from "ABORTED" to "DISCONNECTED"'),this.onConnectionStateChanged(Q.DISCONNECTED,Cb.LOGOUT),e.abrupt("return");case 10:if(void 0!==this.session){e.next=13;break}return this.onConnectionStateChanged(Q.DISCONNECTED,Cb.LOGOUT),e.abrupt("return");case 13:return cb("Logout",{elapse:db(this.session.startTime),lts:U.fromNumber(Date.now()),sid:Sa(this.session.instanceId),userId:this.context.uid},null===(t=this.context.areaConfig)||void 0===t?void 0:t.EVENT_REPORT_DOMAIN[0],null===(n=this.context.areaConfig)||void 0===n?void 0:n.EVENT_REPORT_BACKUP_DOMAIN[0]),e.next=16,this.session.logoutHandler();case 16:this.onConnectionStateChanged(Q.DISCONNECTED,Cb.LOGOUT),this.log("Log out success");case 18:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"logoutSync",value:function(){var e,t,n=this;if(this.connectionState===Q.DISCONNECTED)throw this.logError("Already in logout state"),new H("Logout failure. The client has already been logged out",Bq);this.connectionState===Q.ABORTED?this.info('Reset connection state from "ABORTED" to "DISCONNECTED"'):void 0!==this.session&&(cb("Logout",{elapse:db(this.session.startTime),lts:U.fromNumber(Date.now()),sid:Sa(this.session.instanceId),userId:this.context.uid},null===(e=this.context.areaConfig)||void 0===e?void 0:e.EVENT_REPORT_DOMAIN[0],null===(t=this.context.areaConfig)||void 0===t?void 0:t.EVENT_REPORT_BACKUP_DOMAIN[0]),this.session.logoutHandler().then((function(){n.log("Log out success")}))),this.onConnectionStateChanged(Q.DISCONNECTED,Cb.LOGOUT)}},{key:"sendMessageToPeer",value:function(){var e=K(w.mark((function e(t,n){var r,i,o,a,s,c,u=this,l=arguments;return w.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=2<l.length&&void 0!==l[2]?l[2]:{},i=r.enableOfflineMessaging,o=void 0!==i&&i,a=r.enableHistoricalMessaging,s=void 0!==a&&a,ym(t,ge),this.connectionState!==Q.RECONNECTING){e.next=5;break}return c=Date.now(),e.abrupt("return",new Promise((function(e,r){var i=function(){var i=K(w.mark((function i(){var l;return w.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(void 0!==u.session){i.next=2;break}throw new Ca({SESSION_NOT_FOUND:"Failed to get session of the client"});case 2:return l=Date.now()-c,i.prev=3,i.t0=e,i.next=7,pg({message:t,peerId:n,toPeer:!0,session:u.session,errorCodes:{NOT_LOGGED_IN:Jk,TOO_OFTEN:Dq},diff:l,logger:u.logger,options:{enableHistoricalMessaging:s,enableOfflineMessaging:o}});case 7:i.t1=i.sent,(0,i.t0)(i.t1),i.next=16;break;case 11:i.prev=11,i.t2=i.catch(3),Na(i.t2)&&r(new bb(Md(u.name,"sendMessageToPeer",1e4),Hk)),wa(i.t2)&&r(i.t2),r(new ca("Peer-to-peer message send failure",{code:Cq,originalError:i.t2}));case 16:return i.prev=16,clearTimeout(a),i.finish(16);case 19:case"end":return i.stop()}}),i,null,[[3,11,16,19]])})));return function(){return i.apply(this,arguments)}}();u.internalEmitter.once("RECONNECTED",i);var a=setTimeout((function(){u.internalEmitter.off("RECONNECTED",i),r(new bb(Md(u.name,"sendMessageToPeer",1e4),Hk))}),9e3)})));case 5:if(this.connectionState===Q.CONNECTED){e.next=7;break}throw new H("Failed to send the peer-to-peer message. The client is not logged in",Jk);case 7:if(void 0!==this.session){e.next=9;break}throw new Ca({SESSION_NOT_FOUND:"Failed to get session of the client"});case 9:return e.prev=9,e.next=12,pg({message:t,peerId:n,toPeer:!0,session:this.session,errorCodes:{NOT_LOGGED_IN:Jk,TOO_OFTEN:Dq},diff:0,logger:this.logger,options:{enableHistoricalMessaging:s,enableOfflineMessaging:o}});case 12:return e.abrupt("return",e.sent);case 15:if(e.prev=15,e.t0=e.catch(9),!Na(e.t0)){e.next=19;break}throw new bb(Md(this.name,"sendMessageToPeer",1e4),Hk);case 19:if(!wa(e.t0)){e.next=21;break}throw e.t0;case 21:throw new ca("Peer-to-peer message send failure",{code:Cq,originalError:e.t0});case 22:case"end":return e.stop()}}),e,this,[[9,15]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"createChannel",value:function(e){var t=this;if(!ua(e))throw new L(["The %s in the arguments is invalid",Object.keys({channelId:e})[0]],wz);return new EC(e,(function(){return t.session}),this,this.logger)}},{key:"createLocalInvitation",value:function(e){if(!ua(e))throw new L(["The %s in the arguments is invalid",Object.keys({calleeId:e})[0]],rc);return this.invitationManager.genLocalInvitation(e)}},{key:"subscribePeersOnlineStatus",value:function(){var e=K(w.mark((function e(t){var n,r,i,o,a,s,c,u,l,d,h,f,p,A=this;return w.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.connectionState===Q.CONNECTED){e.next=2;break}throw new H("The client is not logged in",Kk);case 2:if(void 0!==this.session){e.next=4;break}throw new Ca({SESSION_NOT_FOUND:"Failed to get session of the client"});case 4:if(Array.isArray(t)&&0!==t.length){e.next=6;break}throw new L("Invalid arguments: peerIds",Vf);case 6:n=0;case 7:if(!(n<t.length)){e.next=14;break}if(ua(r=t[n])){e.next=11;break}throw new L(["subscribePeersOnlineStatus peer id %s is invalid",r],Vf);case 11:n++,e.next=7;break;case 14:if(!(512<(i=t&&t.length?fk(t):[]).length+Object.keys(this.subscribedPeerStatusCache).length)){e.next=17;break}throw new gb("Subscribed peers overflows",Gq);case 17:return e.next=19,this.session.requestSubscribePeersOnlineStatus(i).toPromise();case 19:o=e.sent,a=o.errors,s=[],c=[],u=0;case 24:if(!(u<a.length)){e.next=32;break}if(l=a[u],d=l.code,"string"==typeof(h=l.account)){e.next=28;break}throw new ca("Returned account is invalid",Fq);case 28:0!==d&&s.push(h);case 29:u++,e.next=24;break;case 32:for(f=0;f<i.length;f++)p=i[f],s.includes(p)||(c.push(p),this.subscribedPeerStatusCache[p]=void 0);if(this.session.requestPeersOnlineStatus(c).pipe(Z((function(e){return oc(sk(e.userInfos,"account"),(function(e){return!!e.ts}))}))).subscribe((function(e){e=oc(e,(function(e,t){return e=e?S.PeerOnlineState.ONLINE:S.PeerOnlineState.OFFLINE,A.subscribedPeerStatusCache[t]=e})),A.emit("PeersOnlineStatusChanged",e)})),0===s.length){e.next=36;break}throw new ca("Subscription failed",Fq);case 36:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"unsubscribePeersOnlineStatus",value:function(){var e=K(w.mark((function e(t){var n,r,i,o,a;return w.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.connectionState===Q.CONNECTED){e.next=2;break}throw new H("The client is not logged in",Kk);case 2:if(void 0!==this.session){e.next=4;break}throw new Ca({SESSION_NOT_FOUND:"Failed to get session of the client"});case 4:if(Array.isArray(t)&&0!==t.length){e.next=6;break}throw new L("Invalid arguments: peerIds",Vf);case 6:n=0;case 7:if(!(n<t.length)){e.next=14;break}if(ua(r=t[n])){e.next=11;break}throw new L(["subscribePeersOnlineStatus peer id %s is invalid",r],Vf);case 11:n++,e.next=7;break;case 14:if(!(512<t.length)){e.next=16;break}throw new gb("Unsubscribed peers overflows",Gq);case 16:for(i=t&&t.length?fk(t):[],this.session.requestUnsubscribePeersOnlineStatus(i),o=0;o<i.length;o++)a=i[o],delete this.subscribedPeerStatusCache[a];case 19:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"queryPeersBySubscriptionOption",value:function(){var e=K(w.mark((function e(t){return w.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.connectionState===Q.CONNECTED){e.next=2;break}throw new H("The client is not logged in",Kk);case 2:if(t!==S.PeerSubscriptionOption.ONLINE_STATUS){e.next=4;break}return e.abrupt("return",Object.keys(this.subscribedPeerStatusCache));case 4:throw new L("Subscription option not supported",Vf);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"createMessage",value:function(e){return"IMAGE"===e.messageType?Ja({width:0,height:0,fileName:"",description:"",thumbnail:new Blob,thumbnailWidth:0,thumbnailHeight:0,size:0},e):"FILE"===e.messageType?Ja({fileName:"",description:"",thumbnail:new Blob,size:0},e):e}},{key:"downloadMedia",value:function(){var e=K(w.mark((function e(t){var n,r,i,o,a,s,c,u,l,d,h,f,p,A,g=this,v=arguments;return w.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=1<v.length&&void 0!==v[1]?v[1]:{},"string"==typeof t){e.next=3;break}throw new L("invalid mediaId format",Lk);case 3:if(e.prev=3,r=t.split("z"),i=pa(r,3),o=i[0],a=i[1],s=i[2],c=o.slice(1,65),u=tC(c),l=parseInt(o.slice(65),10),d=parseInt(a,10),h=parseInt(s,10),!(Number.isNaN(l)||Number.isNaN(d)||Number.isNaN(h))){e.next=12;break}throw new L("Invalid mediaId content",Lk);case 12:e.next=19;break;case 14:if(e.prev=14,e.t0=e.catch(3),!wa(e.t0)){e.next=18;break}throw e.t0;case 18:throw new L("parse mediaId failure",{code:Lk,originalError:e.t0});case 19:if(this.connectionState===Q.CONNECTED){e.next=21;break}throw new H("The client is not logged in, cannot download",aA);case 21:if(void 0!==this.session){e.next=23;break}throw new Ca({SESSION_NOT_FOUND:"Failed to get session of the client"});case 23:return f=this.mediaTaskManager.addDownloadTask({unit:d,zone:l,hashHexStr:c,size:h},(function(){if(void 0===g.session)throw new Ca({SESSION_NOT_FOUND:"Failed to get session of the client"});return g.session.requestFileDownloadIndexGet({hash:u,zone:l,unit:d,size:h}).toPromise()}),n),e.next=26,this.mediaTaskManager.waitMediaTask(f);case 26:return p=e.sent,A=p.payload,e.abrupt("return",A);case 29:case"end":return e.stop()}}),e,this,[[3,14]])})));return function(t){return e.apply(this,arguments)}}()},{key:"createMediaMessageByUploading",value:function(){var e=K(w.mark((function e(t){var n,r,i,o,a,s,c,u,l,d,h,f,p,A,g,v,m,y,b,E,_,S,T,R,C=this,I=arguments;return w.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=1<I.length&&void 0!==I[1]?I[1]:{},r=2<I.length&&void 0!==I[2]?I[2]:{},md(n)){e.next=4;break}throw new L("Invalid params",jf);case 4:if(i="thumbnailWidth"in n||"thumbnailHeight"in n||"width"in n||"height"in n,o=n.messageType,a=void 0===o?i?"IMAGE":"FILE":o,s=n.description,c=void 0===s?"":s,u=n.fileName,l=void 0===u?"":u,d=n.thumbnail,"string"==typeof n.messageType&&"string"==typeof c&&"string"==typeof l&&(um(d)||void 0===d)&&um(t)){e.next=8;break}throw new L("Invalid message params type",jf);case 8:if(!i||"FILE"!==a){e.next=10;break}throw new L("Invalid message params, unexpected field in RtmFileMessage",jf);case 10:if(!(33554432<(h=t.size))){e.next=13;break}throw new gb("The payload size overflow 32 MB",Vz);case 13:return e.next=15,wi(t);case 15:return f=e.sent,e.next=18,sC(f);case 18:if(p=e.sent,this.connectionState===Q.CONNECTED){e.next=21;break}throw new H("The client is not logged in",Xz);case 21:if("IMAGE"!==a){e.next=29;break}return e.next=24,st(n,f);case 24:A=e.sent,g=A.height,v=A.width,m=A.thumbnailWidth,y=A.thumbnailHeight;case 29:return b=this.mediaTaskManager.addUploadTask({file:new Uint8Array(f),hash:p},(function(){if(void 0===C.session)throw new Ca({SESSION_NOT_FOUND:"Failed to get session of the client"});return C.session.fetchFileUploadIndexGet({hash:p,size:h})}),(function(e,t){if(void 0===C.session)throw new Ca({SESSION_NOT_FOUND:"Failed to get session of the client"});return C.session.requestFileUploadIndexSet({hash:p,unit:e,servers:t}).toPromise()}),r),e.next=32,this.mediaTaskManager.waitMediaTask(b);case 32:if(E=e.sent,_=E.zone,S=E.retUnit,"IMAGE"!==a){e.next=38;break}return T={height:g,width:v,fileName:l,size:h,description:c,thumbnail:d,messageType:a,thumbnailWidth:m,thumbnailHeight:y,mediaId:"0".concat(tr(p)).concat(_,"z").concat(S,"z").concat(h,"z").concat(g,"z").concat(v)},e.abrupt("return",T);case 38:return R={fileName:l,size:h,description:c,mediaId:"0".concat(tr(p)).concat(_,"z").concat(S,"z").concat(h),thumbnail:d,messageType:a},e.abrupt("return",R);case 40:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"loginImpl",value:function(){var e=K(w.mark((function e(t){var n,r,i,o,a=this;return w.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.uid,r=t.instanceId,!(void 0!==this.lastLoginTime&&500>Date.now()-this.lastLoginTime)){e.next=4;break}throw new LB(["The frequency of login exceeded the limit of %d queries per second",2],Lz);case 4:if(this.connectionState===Q.DISCONNECTED){e.next=6;break}throw new H("The SDK is either logging in or has logged in the Agora RTM system",Jz);case 6:e.prev=6,this.context.uid=n,e.next=13;break;case 10:throw e.prev=10,e.t0=e.catch(6),new L(["The %s in the arguments is invalid",Object.keys({uid:n})[0]],th);case 13:return this.onConnectionStateChanged(Q.CONNECTING,Cb.LOGIN),this.session=i=new Fr(this.context,new sr(this.context,this.logger,!1),r,this.logger),o=function(){a.connectionState===Q.CONNECTED&&(a.onConnectionStateChanged(Q.RECONNECTING,Cb.INTERRUPTED),a.session)&&a.session.once("userJoined",(function(){a.onConnectionStateChanged(Q.CONNECTED,Cb.LOGIN_SUCCESS)}))},i.on("connectionLost",o),i.on("tokenExpired",(function(){a.emit("TokenExpired")})),i.once("userDrop",this.userDropHandler),this.session.on("peerTextMessage",(function(e){a.emit("MessageFromPeer",{text:e.text,messageType:S.MessageType.TEXT},e.peerId,e.properties)})),this.session.on("peerMediaMessage",(function(e){var t=e.peerId,n=e.properties,r=e.messageType;e=e.details,"FILE"===r?a.emit("MessageFromPeer",{messageType:S.MessageType.FILE,size:parseInt(na(e.media_size),10),description:na(e.media_description),fileName:na(e.media_filename),mediaId:na(e.media_id),thumbnail:new Blob([e.media_thumbnail])},t,n):"IMAGE"===r&&a.emit("MessageFromPeer",{messageType:S.MessageType.IMAGE,size:parseInt(na(e.media_size),10),description:na(e.media_description),fileName:na(e.media_filename),mediaId:na(e.media_id),thumbnail:new Blob([e.media_thumbnail]),height:parseInt(na(e.media_height),10),width:parseInt(na(e.media_width),10),thumbnailHeight:parseInt(na(e.media_thumbnailheight),10),thumbnailWidth:parseInt(na(e.media_thumbnailwidth),10)},t,n)})),this.session.on("peerRawMessage",(function(e){a.emit("MessageFromPeer",{rawMessage:e.raw,description:e.desc,messageType:S.MessageType.RAW},e.peerId,e.properties)})),i.on("instanceChanged",(function(e){return r=e})),i.on("peerOnlineStatusChanged",(function(e){var t=e.instance.toString()+e.state,n=a.peerStatusSeqLru.get(t);!n||e.seq.greaterThan(n)?(a.peerStatusSeqLru.set(t,e.seq),e.state!==a.subscribedPeerStatusCache[e.peerId]?a.emit("PeersOnlineStatusChanged",m({},e.peerId,e.state)):a.log("peer status for %s not changed, previous %s",e.peerId,e.state),a.subscribedPeerStatusCache[e.peerId]=e.state,clearTimeout(a.peerUnreachableTimers[t]),e.state===S.PeerOnlineState.UNREACHABLE&&(a.peerUnreachableTimers[t]=setTimeout((function(){a.subscribedPeerStatusCache[e.peerId]===S.PeerOnlineState.UNREACHABLE&&(a.subscribedPeerStatusCache[e.peerId]=S.PeerOnlineState.ONLINE,a.emit("PeersOnlineStatusChanged",m({},e.peerId,S.PeerOnlineState.ONLINE)))}),3e4))):a.log("peerOnlineStatusChanged dedup for %s, %d",t,e.seq.toNumber())})),i.on("invitationMessage",this.invitationManager.invitationMessageHandler.bind(this.invitationManager)),i.on("channelAttributesUpdated",(function(e){var t=e.channelId;e=e.attributeMaps;for(var n={},r=0;r<e.length;r++){var i=e[r],o=i.key,s=i.ms,c=i.value;if(i=i.origin,"string"!=typeof o||!U.isLong(s)||"string"!=typeof c||!ua(i))break;n[o]=new Blob([c]).size}a.channelAttributesCacheLru.set(t,n)})),i.on("userJoined",(function(e){if(0!==Object.keys(a.attributes).length){if(void 0===a.session)return;a.session.requestSetLocalUserAttributes(a.attributes,e).toPromise()}if(0!==a.attributeDrafts.size)for(var t=function(t,n){var r=(t=n[t]).attribute;t.promise.then((function(){void 0!==a.session&&a.session.requestSetLocalUserAttributes(r,e).toPromise()}))},n=0,r=Array.from(a.attributeDrafts);n<r.length;n++)t(n,r);0!==Object.keys(a.subscribedPeerStatusCache).length&&i.requestSubscribePeersOnlineStatus(Object.keys(a.subscribedPeerStatusCache))})),this.lastLoginTime=Date.now(),e.prev=29,e.next=32,i.loginHandler().toPromise();case 32:this.mediaTaskManager.setAuthInfo({ticket:i.connection.curOpenSockets.filter((function(e){return void 0!==e}))[0].ticket,instance:i.instanceId,isAreaCN:"CN"===this.context.area,loginOpt:i.userJoinOptions.toLong()}),e.next=44;break;case 35:if(e.prev=35,e.t1=e.catch(29),!Na(e.t1)){e.next=40;break}throw this.onConnectionStateChanged(Q.DISCONNECTED,Cb.LOGIN_TIMEOUT),new bb(Md(this.name,"login",1e4),Kz);case 40:if(this.onConnectionStateChanged(Q.DISCONNECTED,Cb.LOGIN_FAILURE),!wa(e.t1)){e.next=43;break}throw e.t1;case 43:throw new ca("Login failure",{code:yq,originalError:e.t1});case 44:this.onConnectionStateChanged(Q.CONNECTED,Cb.LOGIN_SUCCESS);case 45:case"end":return e.stop()}}),e,this,[[6,10],[29,35]])})));return function(t){return e.apply(this,arguments)}}()},{key:"onConnectionStateChanged",value:function(e,t){var n,r,i=this;e===Q.RECONNECTING&&(this.reconnId+=1),cb("ConnectionStateChange",{elapse:db(this.session&&this.session.startTime),lts:U.fromNumber(Date.now()),newState:Lr[e],oldState:Lr[this.connectionState],reason:FC[t],sid:Sa(this.session&&this.session.instanceId||U.fromNumber(0)),userId:this.context.uid,reconnId:this.reconnId},null===(n=this.context.areaConfig)||void 0===n?void 0:n.EVENT_REPORT_DOMAIN[0],null===(r=this.context.areaConfig)||void 0===r?void 0:r.EVENT_REPORT_BACKUP_DOMAIN[0]),this.connectionState===Q.RECONNECTING&&e===Q.CONNECTED&&(0!==Object.keys(this.subscribedPeerStatusCache).length&&void 0!==this.session&&this.session.requestPeersOnlineStatus(Object.keys(this.subscribedPeerStatusCache)).pipe(Z((function(e){return oc(sk(e.userInfos,"account"),(function(e){return!!e.ts}))}))).subscribe((function(e){e=oc(e,(function(e,t){return e=e?S.PeerOnlineState.ONLINE:S.PeerOnlineState.OFFLINE,i.subscribedPeerStatusCache[t]=e})),i.emit("PeersOnlineStatusChanged",e)})),this.internalEmitter.emit("RECONNECTED")),this.connectionState=e,e!==Q.ABORTED&&e!==Q.DISCONNECTED||(this.reconnId=0,this.attributes={},this.session&&(this.session.removeAllListeners(),this.session.joinedChannels.clear(),this.session.msgDedupLru.empty(),this.session.dialogueSequenceLru.empty()),this.session=void 0,this.channelAttributesCacheLru.empty(),this.peerStatusSeqLru.empty(),this.peerUnreachableTimers={},this.subscribedPeerStatusCache={},this.attributeDrafts.clear(),this.context.token=void 0),this.mediaTaskManager.emit("connectionStateChanged",e),this.emit("ConnectionStateChanged",e,t)}}]),t}(vb()),C=Kr,da(C.prototype,"renewToken",[ia],Object.getOwnPropertyDescriptor(C.prototype,"renewToken"),C.prototype),da(C.prototype,"queryPeersOnlineStatus",[ia],Object.getOwnPropertyDescriptor(C.prototype,"queryPeersOnlineStatus"),C.prototype),da(C.prototype,"getChannelMemberCount",[ia],Object.getOwnPropertyDescriptor(C.prototype,"getChannelMemberCount"),C.prototype),da(C.prototype,"setLocalUserAttributes",[ia],Object.getOwnPropertyDescriptor(C.prototype,"setLocalUserAttributes"),C.prototype),da(C.prototype,"setChannelAttributes",[ia],Object.getOwnPropertyDescriptor(C.prototype,"setChannelAttributes"),C.prototype),da(C.prototype,"addOrUpdateLocalUserAttributes",[ia],Object.getOwnPropertyDescriptor(C.prototype,"addOrUpdateLocalUserAttributes"),C.prototype),da(C.prototype,"addOrUpdateChannelAttributes",[ia],Object.getOwnPropertyDescriptor(C.prototype,"addOrUpdateChannelAttributes"),C.prototype),da(C.prototype,"deleteLocalUserAttributesByKeys",[ia],Object.getOwnPropertyDescriptor(C.prototype,"deleteLocalUserAttributesByKeys"),C.prototype),da(C.prototype,"deleteChannelAttributesByKeys",[ia],Object.getOwnPropertyDescriptor(C.prototype,"deleteChannelAttributesByKeys"),C.prototype),da(C.prototype,"clearLocalUserAttributes",[ia],Object.getOwnPropertyDescriptor(C.prototype,"clearLocalUserAttributes"),C.prototype),da(C.prototype,"clearChannelAttributes",[ia],Object.getOwnPropertyDescriptor(C.prototype,"clearChannelAttributes"),C.prototype),da(C.prototype,"getUserAttributes",[ia],Object.getOwnPropertyDescriptor(C.prototype,"getUserAttributes"),C.prototype),da(C.prototype,"getChannelAttributes",[ia],Object.getOwnPropertyDescriptor(C.prototype,"getChannelAttributes"),C.prototype),da(C.prototype,"getChannelAttributesByKeys",[ia],Object.getOwnPropertyDescriptor(C.prototype,"getChannelAttributesByKeys"),C.prototype),da(C.prototype,"getUserAttributesByKeys",[ia],Object.getOwnPropertyDescriptor(C.prototype,"getUserAttributesByKeys"),C.prototype),da(C.prototype,"login",[ia],Object.getOwnPropertyDescriptor(C.prototype,"login"),C.prototype),da(C.prototype,"logout",[ia],Object.getOwnPropertyDescriptor(C.prototype,"logout"),C.prototype),da(C.prototype,"logoutSync",[ia],Object.getOwnPropertyDescriptor(C.prototype,"logoutSync"),C.prototype),da(C.prototype,"sendMessageToPeer",[ia],Object.getOwnPropertyDescriptor(C.prototype,"sendMessageToPeer"),C.prototype),da(C.prototype,"createChannel",[ia],Object.getOwnPropertyDescriptor(C.prototype,"createChannel"),C.prototype),da(C.prototype,"createLocalInvitation",[ia],Object.getOwnPropertyDescriptor(C.prototype,"createLocalInvitation"),C.prototype),da(C.prototype,"subscribePeersOnlineStatus",[ia],Object.getOwnPropertyDescriptor(C.prototype,"subscribePeersOnlineStatus"),C.prototype),da(C.prototype,"unsubscribePeersOnlineStatus",[ia],Object.getOwnPropertyDescriptor(C.prototype,"unsubscribePeersOnlineStatus"),C.prototype),da(C.prototype,"queryPeersBySubscriptionOption",[ia],Object.getOwnPropertyDescriptor(C.prototype,"queryPeersBySubscriptionOption"),C.prototype),da(C.prototype,"createMessage",[ia],Object.getOwnPropertyDescriptor(C.prototype,"createMessage"),C.prototype),da(C.prototype,"downloadMedia",[ia],Object.getOwnPropertyDescriptor(C.prototype,"downloadMedia"),C.prototype),da(C.prototype,"createMediaMessageByUploading",[ia],Object.getOwnPropertyDescriptor(C.prototype,"createMediaMessageByUploading"),C.prototype),C),Mr={LOG_FILTER_OFF:{error:!1,warn:!1,info:!1,track:!1,debug:!1},LOG_FILTER_ERROR:{error:!0,warn:!1,info:!1,track:!1,debug:!1},LOG_FILTER_WARNING:{error:!0,warn:!0,info:!1,track:!1,debug:!1},LOG_FILTER_INFO:{error:!0,warn:!0,info:!0,track:!1,debug:!1},LOG_FILTER_DEBUG:{error:!0,warn:!0,info:!0,track:!0,debug:!0}},Nd=Ja(Ja({createInstance:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=t.enableLogUpload;n=void 0!==n&&n;var r=void 0===(t=t.logFilter)?Mr.LOG_FILTER_INFO:t;if(t=2<arguments.length?arguments[2]:void 0,!/^[\dA-Za-z]{32}$/.test(e))throw new L(["The %s in the arguments is invalid",Object.keys({appId:e})[0]],xz);var i={enableLogUpload:n,logFilter:r};if(null!=t){var o=fC(t);i._areaConfig=o}n=Sk=Ta.__global_unique_id__=(Ta.__global_unique_id__||0)+1,r=TB(i);var a=UB(i),s=VB(i),c=WB(n,i),u=nr(n,i),l=u("RTM:DEBUG","<Entry> ");return r("The Agora RTM Web SDK version is %s","1.4.2"),void 0!==t&&r("RTM areas are set to %s",t.join(", ")),l("Creating an RtmClient instance"),l('The Git commit ID is "'.concat("v1.4.2-0-gcddbca54",'"')),r("The process ID is %s",Sf),r("The build is %s","v1.4.2-0-gcddbca54"),l("NODE_ENV is %s","production"),new GC(e,{genLogger:u,genTracker:c,info:r,warn:a,logError:s,loggerId:n},i,(function(e){for(var t=0,n=Rk(e);t<n.length;t++){var r=n[t];try{var o=e[r];null!=o&&(i[r]=o)}catch(e){throw new L(["The %s in the arguments is invalid",r],void 0)}}}),o)},BUILD:"v1.4.2-0-gcddbca54",VERSION:"1.4.2",END_CALL_PREFIX:"AgoraRTMLegacyEndcallCompatibleMessagePrefix",processId:Sf,ConnectionChangeReason:S.ConnectionChangeReason,ConnectionState:S.ConnectionState,LocalInvitationFailureReason:S.LocalInvitationFailureReason,LocalInvitationState:S.LocalInvitationState,RemoteInvitationFailureReason:S.RemoteInvitationFailureReason,RemoteInvitationState:S.RemoteInvitationState,MessageType:S.MessageType,PeerOnlineState:S.PeerOnlineState,PeerSubscriptionOption:S.PeerSubscriptionOption},Mr),{},{setParameter:function(e,t){Object.keys(dd).includes(e)&&(dd[e]=t)},getParameter:function(e){return dd[e]}});return Nd})),"undefined"!=typeof window&&function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.Hls=t():e.Hls=t()}(this,(function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/dist/",n(n.s="./src/hls.ts")}({"./node_modules/eventemitter3/index.js":
/*!*********************************************!*\
  !*** ./node_modules/eventemitter3/index.js ***!
  \*********************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t,n){"use strict";var r=Object.prototype.hasOwnProperty,i="~";function o(){}function a(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function s(e,t,n,r,o){if("function"!=typeof n)throw new TypeError("The listener must be a function");var s=new a(n,r||e,o),c=i?i+t:t;return e._events[c]?e._events[c].fn?e._events[c]=[e._events[c],s]:e._events[c].push(s):(e._events[c]=s,e._eventsCount++),e}function c(e,t){0==--e._eventsCount?e._events=new o:delete e._events[t]}function u(){this._events=new o,this._eventsCount=0}Object.create&&(o.prototype=Object.create(null),(new o).__proto__||(i=!1)),u.prototype.eventNames=function(){var e,t,n=[];if(0===this._eventsCount)return n;for(t in e=this._events)r.call(e,t)&&n.push(i?t.slice(1):t);return Object.getOwnPropertySymbols?n.concat(Object.getOwnPropertySymbols(e)):n},u.prototype.listeners=function(e){var t=i?i+e:e,n=this._events[t];if(!n)return[];if(n.fn)return[n.fn];for(var r=0,o=n.length,a=new Array(o);r<o;r++)a[r]=n[r].fn;return a},u.prototype.listenerCount=function(e){var t=i?i+e:e,n=this._events[t];return n?n.fn?1:n.length:0},u.prototype.emit=function(e,t,n,r,o,a){var s=i?i+e:e;if(!this._events[s])return!1;var c,u,l=this._events[s],d=arguments.length;if(l.fn){switch(l.once&&this.removeListener(e,l.fn,void 0,!0),d){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,t),!0;case 3:return l.fn.call(l.context,t,n),!0;case 4:return l.fn.call(l.context,t,n,r),!0;case 5:return l.fn.call(l.context,t,n,r,o),!0;case 6:return l.fn.call(l.context,t,n,r,o,a),!0}for(u=1,c=new Array(d-1);u<d;u++)c[u-1]=arguments[u];l.fn.apply(l.context,c)}else{var h,f=l.length;for(u=0;u<f;u++)switch(l[u].once&&this.removeListener(e,l[u].fn,void 0,!0),d){case 1:l[u].fn.call(l[u].context);break;case 2:l[u].fn.call(l[u].context,t);break;case 3:l[u].fn.call(l[u].context,t,n);break;case 4:l[u].fn.call(l[u].context,t,n,r);break;default:if(!c)for(h=1,c=new Array(d-1);h<d;h++)c[h-1]=arguments[h];l[u].fn.apply(l[u].context,c)}}return!0},u.prototype.on=function(e,t,n){return s(this,e,t,n,!1)},u.prototype.once=function(e,t,n){return s(this,e,t,n,!0)},u.prototype.removeListener=function(e,t,n,r){var o=i?i+e:e;if(!this._events[o])return this;if(!t)return c(this,o),this;var a=this._events[o];if(a.fn)a.fn!==t||r&&!a.once||n&&a.context!==n||c(this,o);else{for(var s=0,u=[],l=a.length;s<l;s++)(a[s].fn!==t||r&&!a[s].once||n&&a[s].context!==n)&&u.push(a[s]);u.length?this._events[o]=1===u.length?u[0]:u:c(this,o)}return this},u.prototype.removeAllListeners=function(e){var t;return e?(t=i?i+e:e,this._events[t]&&c(this,t)):(this._events=new o,this._eventsCount=0),this},u.prototype.off=u.prototype.removeListener,u.prototype.addListener=u.prototype.on,u.prefixed=i,u.EventEmitter=u,e.exports=u},"./node_modules/url-toolkit/src/url-toolkit.js":
/*!*****************************************************!*\
  !*** ./node_modules/url-toolkit/src/url-toolkit.js ***!
  \*****************************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t,n){var r,i,o,a,s;r=/^((?:[a-zA-Z0-9+\-.]+:)?)(\/\/[^\/?#]*)?((?:[^\/?#]*\/)*[^;?#]*)?(;[^?#]*)?(\?[^#]*)?(#.*)?$/,i=/^([^\/?#]*)(.*)$/,o=/(?:\/|^)\.(?=\/)/g,a=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,s={buildAbsoluteURL:function(e,t,n){if(n=n||{},e=e.trim(),!(t=t.trim())){if(!n.alwaysNormalize)return e;var r=s.parseURL(e);if(!r)throw new Error("Error trying to parse base URL.");return r.path=s.normalizePath(r.path),s.buildURLFromParts(r)}var o=s.parseURL(t);if(!o)throw new Error("Error trying to parse relative URL.");if(o.scheme)return n.alwaysNormalize?(o.path=s.normalizePath(o.path),s.buildURLFromParts(o)):t;var a=s.parseURL(e);if(!a)throw new Error("Error trying to parse base URL.");if(!a.netLoc&&a.path&&"/"!==a.path[0]){var c=i.exec(a.path);a.netLoc=c[1],a.path=c[2]}a.netLoc&&!a.path&&(a.path="/");var u={scheme:a.scheme,netLoc:o.netLoc,path:null,params:o.params,query:o.query,fragment:o.fragment};if(!o.netLoc&&(u.netLoc=a.netLoc,"/"!==o.path[0]))if(o.path){var l=a.path,d=l.substring(0,l.lastIndexOf("/")+1)+o.path;u.path=s.normalizePath(d)}else u.path=a.path,o.params||(u.params=a.params,o.query||(u.query=a.query));return null===u.path&&(u.path=n.alwaysNormalize?s.normalizePath(o.path):o.path),s.buildURLFromParts(u)},parseURL:function(e){var t=r.exec(e);return t?{scheme:t[1]||"",netLoc:t[2]||"",path:t[3]||"",params:t[4]||"",query:t[5]||"",fragment:t[6]||""}:null},normalizePath:function(e){for(e=e.split("").reverse().join("").replace(o,"");e.length!==(e=e.replace(a,"")).length;);return e.split("").reverse().join("")},buildURLFromParts:function(e){return e.scheme+e.netLoc+e.path+e.params+e.query+e.fragment}},e.exports=s},"./node_modules/webworkify-webpack/index.js":
/*!**************************************************!*\
  !*** ./node_modules/webworkify-webpack/index.js ***!
  \**************************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t,n){function r(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.i=function(e){return e},n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:r})},n.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/",n.oe=function(e){throw console.error(e),e};var r=n(n.s=ENTRY_MODULE);return r.default||r}var i="[\\.|\\-|\\+|\\w|/|@]+",o="\\(\\s*(/\\*.*?\\*/)?\\s*.*?([\\.|\\-|\\+|\\w|/|@]+).*?\\)";function a(e){return(e+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}function s(e,t,r){var s={};s[r]=[];var c=t.toString(),u=c.match(/^function\s?\w*\(\w+,\s*\w+,\s*(\w+)\)/);if(!u)return s;for(var l,d=u[1],h=new RegExp("(\\\\n|\\W)"+a(d)+o,"g");l=h.exec(c);)"dll-reference"!==l[3]&&s[r].push(l[3]);for(h=new RegExp("\\("+a(d)+'\\("(dll-reference\\s('+i+'))"\\)\\)'+o,"g");l=h.exec(c);)e[l[2]]||(s[r].push(l[1]),e[l[2]]=n(l[1]).m),s[l[2]]=s[l[2]]||[],s[l[2]].push(l[4]);for(var f,p=Object.keys(s),A=0;A<p.length;A++)for(var g=0;g<s[p[A]].length;g++)f=s[p[A]][g],isNaN(1*f)||(s[p[A]][g]=1*s[p[A]][g]);return s}function c(e){return Object.keys(e).reduce((function(t,n){return t||e[n].length>0}),!1)}e.exports=function(e,t){t=t||{};var i={main:n.m},o=t.all?{main:Object.keys(i.main)}:function(e,t){for(var n={main:[t]},r={main:[]},i={main:{}};c(n);)for(var o=Object.keys(n),a=0;a<o.length;a++){var u=o[a],l=n[u].pop();if(i[u]=i[u]||{},!i[u][l]&&e[u][l]){i[u][l]=!0,r[u]=r[u]||[],r[u].push(l);for(var d=s(e,e[u][l],u),h=Object.keys(d),f=0;f<h.length;f++)n[h[f]]=n[h[f]]||[],n[h[f]]=n[h[f]].concat(d[h[f]])}}return r}(i,e),a="";Object.keys(o).filter((function(e){return"main"!==e})).forEach((function(e){for(var t=0;o[e][t];)t++;o[e].push(t),i[e][t]="(function(module, exports, __webpack_require__) { module.exports = __webpack_require__; })",a=a+"var "+e+" = ("+r.toString().replace("ENTRY_MODULE",JSON.stringify(t))+")({"+o[e].map((function(t){return JSON.stringify(t)+": "+i[e][t].toString()})).join(",")+"});\n"})),a=a+"new (("+r.toString().replace("ENTRY_MODULE",JSON.stringify(e))+")({"+o.main.map((function(e){return JSON.stringify(e)+": "+i.main[e].toString()})).join(",")+"}))(self);";var u=new window.Blob([a],{type:"text/javascript"});if(t.bare)return u;var l=(window.URL||window.webkitURL||window.mozURL||window.msURL).createObjectURL(u),d=new window.Worker(l);return d.objectURL=l,d}},"./src/crypt/decrypter.js":
/*!********************************************!*\
  !*** ./src/crypt/decrypter.js + 3 modules ***!
  \********************************************/
/*! exports provided: default */
/*! ModuleConcatenation bailout: Cannot concat with ./src/errors.ts because of ./src/hls.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/events.js because of ./src/hls.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/utils/get-self-scope.js because of ./src/hls.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/utils/logger.js because of ./src/hls.ts */function(e,t,n){"use strict";n.r(t);var r=function(){function e(e,t){this.subtle=e,this.aesIV=t}return e.prototype.decrypt=function(e,t){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},t,e)},e}(),i=function(){function e(e,t){this.subtle=e,this.key=t}return e.prototype.expandKey=function(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},!1,["encrypt","decrypt"])},e}();var o=function(){function e(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.initTable()}var t=e.prototype;return t.uint8ArrayToUint32Array_=function(e){for(var t=new DataView(e),n=new Uint32Array(4),r=0;r<4;r++)n[r]=t.getUint32(4*r);return n},t.initTable=function(){var e=this.sBox,t=this.invSBox,n=this.subMix,r=n[0],i=n[1],o=n[2],a=n[3],s=this.invSubMix,c=s[0],u=s[1],l=s[2],d=s[3],h=new Uint32Array(256),f=0,p=0,A=0;for(A=0;A<256;A++)h[A]=A<128?A<<1:A<<1^283;for(A=0;A<256;A++){var g=p^p<<1^p<<2^p<<3^p<<4;g=g>>>8^255&g^99,e[f]=g,t[g]=f;var v=h[f],m=h[v],y=h[m],b=257*h[g]^16843008*g;r[f]=b<<24|b>>>8,i[f]=b<<16|b>>>16,o[f]=b<<8|b>>>24,a[f]=b,b=16843009*y^65537*m^257*v^16843008*f,c[g]=b<<24|b>>>8,u[g]=b<<16|b>>>16,l[g]=b<<8|b>>>24,d[g]=b,f?(f=v^h[h[h[y^v]]],p^=h[h[p]]):f=p=1}},t.expandKey=function(e){for(var t=this.uint8ArrayToUint32Array_(e),n=!0,r=0;r<t.length&&n;)n=t[r]===this.key[r],r++;if(!n){this.key=t;var i=this.keySize=t.length;if(4!==i&&6!==i&&8!==i)throw new Error("Invalid aes key size="+i);var o,a,s,c,u=this.ksRows=4*(i+6+1),l=this.keySchedule=new Uint32Array(u),d=this.invKeySchedule=new Uint32Array(u),h=this.sBox,f=this.rcon,p=this.invSubMix,A=p[0],g=p[1],v=p[2],m=p[3];for(o=0;o<u;o++)o<i?s=l[o]=t[o]:(c=s,o%i==0?(c=h[(c=c<<8|c>>>24)>>>24]<<24|h[c>>>16&255]<<16|h[c>>>8&255]<<8|h[255&c],c^=f[o/i|0]<<24):i>6&&o%i==4&&(c=h[c>>>24]<<24|h[c>>>16&255]<<16|h[c>>>8&255]<<8|h[255&c]),l[o]=s=(l[o-i]^c)>>>0);for(a=0;a<u;a++)o=u-a,c=3&a?l[o]:l[o-4],d[a]=a<4||o<=4?c:A[h[c>>>24]]^g[h[c>>>16&255]]^v[h[c>>>8&255]]^m[h[255&c]],d[a]=d[a]>>>0}},t.networkToHostOrderSwap=function(e){return e<<24|(65280&e)<<8|(16711680&e)>>8|e>>>24},t.decrypt=function(e,t,n,r){for(var i,o,a,s,c,u,l,d,h,f,p,A,g,v,m,y,b,E=this.keySize+6,_=this.invKeySchedule,w=this.invSBox,S=this.invSubMix,T=S[0],R=S[1],C=S[2],I=S[3],x=this.uint8ArrayToUint32Array_(n),O=x[0],N=x[1],B=x[2],M=x[3],L=new Int32Array(e),k=new Int32Array(L.length),U=this.networkToHostOrderSwap;t<L.length;){for(h=U(L[t]),f=U(L[t+1]),p=U(L[t+2]),A=U(L[t+3]),c=h^_[0],u=A^_[1],l=p^_[2],d=f^_[3],g=4,v=1;v<E;v++)i=T[c>>>24]^R[u>>16&255]^C[l>>8&255]^I[255&d]^_[g],o=T[u>>>24]^R[l>>16&255]^C[d>>8&255]^I[255&c]^_[g+1],a=T[l>>>24]^R[d>>16&255]^C[c>>8&255]^I[255&u]^_[g+2],s=T[d>>>24]^R[c>>16&255]^C[u>>8&255]^I[255&l]^_[g+3],c=i,u=o,l=a,d=s,g+=4;i=w[c>>>24]<<24^w[u>>16&255]<<16^w[l>>8&255]<<8^w[255&d]^_[g],o=w[u>>>24]<<24^w[l>>16&255]<<16^w[d>>8&255]<<8^w[255&c]^_[g+1],a=w[l>>>24]<<24^w[d>>16&255]<<16^w[c>>8&255]<<8^w[255&u]^_[g+2],s=w[d>>>24]<<24^w[c>>16&255]<<16^w[u>>8&255]<<8^w[255&l]^_[g+3],g+=3,k[t]=U(i^O),k[t+1]=U(s^N),k[t+2]=U(a^B),k[t+3]=U(o^M),O=h,N=f,B=p,M=A,t+=4}return r?(m=k.buffer,y=m.byteLength,(b=y&&new DataView(m).getUint8(y-1))?m.slice(0,y-b):m):k.buffer},t.destroy=function(){this.key=void 0,this.keySize=void 0,this.ksRows=void 0,this.sBox=void 0,this.invSBox=void 0,this.subMix=void 0,this.invSubMix=void 0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.rcon=void 0},e}(),a=n("./src/errors.ts"),s=n("./src/utils/logger.js"),c=n("./src/events.js"),u=n("./src/utils/get-self-scope.js"),l=Object(u.getSelfScope)(),d=function(){function e(e,t,n){var r=(void 0===n?{}:n).removePKCS7Padding,i=void 0===r||r;if(this.logEnabled=!0,this.observer=e,this.config=t,this.removePKCS7Padding=i,i)try{var o=l.crypto;o&&(this.subtle=o.subtle||o.webkitSubtle)}catch(e){}this.disableWebCrypto=!this.subtle}var t=e.prototype;return t.isSync=function(){return this.disableWebCrypto&&this.config.enableSoftwareAES},t.decrypt=function(e,t,n,a){var c=this;if(this.disableWebCrypto&&this.config.enableSoftwareAES){this.logEnabled&&(s.logger.log("JS AES decrypt"),this.logEnabled=!1);var u=this.decryptor;u||(this.decryptor=u=new o),u.expandKey(t),a(u.decrypt(e,0,n,this.removePKCS7Padding))}else{this.logEnabled&&(s.logger.log("WebCrypto AES decrypt"),this.logEnabled=!1);var l=this.subtle;this.key!==t&&(this.key=t,this.fastAesKey=new i(l,t)),this.fastAesKey.expandKey().then((function(i){new r(l,n).decrypt(e,i).catch((function(r){c.onWebCryptoError(r,e,t,n,a)})).then((function(e){a(e)}))})).catch((function(r){c.onWebCryptoError(r,e,t,n,a)}))}},t.onWebCryptoError=function(e,t,n,r,i){this.config.enableSoftwareAES?(s.logger.log("WebCrypto Error, disable WebCrypto API"),this.disableWebCrypto=!0,this.logEnabled=!0,this.decrypt(t,n,r,i)):(s.logger.error("decrypting error : "+e.message),this.observer.trigger(c.default.ERROR,{type:a.ErrorTypes.MEDIA_ERROR,details:a.ErrorDetails.FRAG_DECRYPT_ERROR,fatal:!0,reason:e.message}))},t.destroy=function(){var e=this.decryptor;e&&(e.destroy(),this.decryptor=void 0)},e}();t.default=d},"./src/demux/demuxer-inline.js":
/*!**************************************************!*\
  !*** ./src/demux/demuxer-inline.js + 12 modules ***!
  \**************************************************/
/*! exports provided: default */
/*! ModuleConcatenation bailout: Cannot concat with ./src/crypt/decrypter.js because of ./src/hls.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/demux/id3.js because of ./src/hls.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/demux/mp4demuxer.js because of ./src/hls.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/errors.ts because of ./src/hls.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/events.js because of ./src/hls.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/polyfills/number.js because of ./src/hls.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/utils/get-self-scope.js because of ./src/hls.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/utils/logger.js because of ./src/hls.ts */function(e,t,n){"use strict";n.r(t);var r=n("./src/events.js"),i=n("./src/errors.ts"),o=n("./src/crypt/decrypter.js"),a=n("./src/polyfills/number.js"),s=n("./src/utils/logger.js"),c=n("./src/utils/get-self-scope.js");function u(e,t){return 255===e[t]&&240==(246&e[t+1])}function l(e,t){return 1&e[t+1]?7:9}function d(e,t){return(3&e[t+3])<<11|e[t+4]<<3|(224&e[t+5])>>>5}function h(e,t){return!!(t+1<e.length&&u(e,t))}function f(e,t){if(h(e,t)){var n=l(e,t);if(t+n>=e.length)return!1;var r=d(e,t);if(r<=n)return!1;var i=t+r;if(i===e.length||i+1<e.length&&u(e,i))return!0}return!1}function p(e,t,n,o,a){if(!e.samplerate){var c=function(e,t,n,o){var a,c,u,l,d,h=navigator.userAgent.toLowerCase(),f=o,p=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];if(a=1+((192&t[n+2])>>>6),!((c=(60&t[n+2])>>>2)>p.length-1))return l=(1&t[n+2])<<2,l|=(192&t[n+3])>>>6,s.logger.log("manifest codec:"+o+",ADTS data:type:"+a+",sampleingIndex:"+c+"["+p[c]+"Hz],channelConfig:"+l),/firefox/i.test(h)?c>=6?(a=5,d=new Array(4),u=c-3):(a=2,d=new Array(2),u=c):-1!==h.indexOf("android")?(a=2,d=new Array(2),u=c):(a=5,d=new Array(4),o&&(-1!==o.indexOf("mp4a.40.29")||-1!==o.indexOf("mp4a.40.5"))||!o&&c>=6?u=c-3:((o&&-1!==o.indexOf("mp4a.40.2")&&(c>=6&&1===l||/vivaldi/i.test(h))||!o&&1===l)&&(a=2,d=new Array(2)),u=c)),d[0]=a<<3,d[0]|=(14&c)>>1,d[1]|=(1&c)<<7,d[1]|=l<<3,5===a&&(d[1]|=(14&u)>>1,d[2]=(1&u)<<7,d[2]|=8,d[3]=0),{config:d,samplerate:p[c],channelCount:l,codec:"mp4a.40."+a,manifestCodec:f};e.trigger(r.default.ERROR,{type:i.ErrorTypes.MEDIA_ERROR,details:i.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"invalid ADTS sampling index:"+c})}(t,n,o,a);e.config=c.config,e.samplerate=c.samplerate,e.channelCount=c.channelCount,e.codec=c.codec,e.manifestCodec=c.manifestCodec,s.logger.log("parsed codec:"+e.codec+",rate:"+c.samplerate+",nb channel:"+c.channelCount)}}function A(e){return 9216e4/e}function g(e,t,n,r,i){var o=function(e,t,n,r,i){var o,a,s=e.length;if(o=l(e,t),a=d(e,t),(a-=o)>0&&t+o+a<=s)return{headerLength:o,frameLength:a,stamp:n+r*i}}(t,n,r,i,A(e.samplerate));if(o){var a=o.stamp,s=o.headerLength,c=o.frameLength,u={unit:t.subarray(n+s,n+s+c),pts:a,dts:a};return e.samples.push(u),{sample:u,length:c+s}}}var v=n("./src/demux/id3.js"),m=function(){function e(e,t,n){this.observer=e,this.config=n,this.remuxer=t}var t=e.prototype;return t.resetInitSegment=function(e,t,n,r){this._audioTrack={container:"audio/adts",type:"audio",id:0,sequenceNumber:0,isAAC:!0,samples:[],len:0,manifestCodec:t,duration:r,inputTimeScale:9e4}},t.resetTimeStamp=function(){},e.probe=function(e){if(!e)return!1;for(var t=(v.default.getID3Data(e,0)||[]).length,n=e.length;t<n;t++)if(f(e,t))return s.logger.log("ADTS sync word found !"),!0;return!1},t.append=function(e,t,n,r){for(var i=this._audioTrack,o=v.default.getID3Data(e,0)||[],c=v.default.getTimeStamp(o),u=Object(a.isFiniteNumber)(c)?90*c:9e4*t,l=0,d=u,f=e.length,A=o.length,m=[{pts:d,dts:d,data:o}];A<f-1;)if(h(e,A)&&A+5<f){p(i,this.observer,e,A,i.manifestCodec);var y=g(i,e,A,u,l);if(!y){s.logger.log("Unable to parse AAC frame");break}A+=y.length,d=y.sample.pts,l++}else v.default.isHeader(e,A)?(o=v.default.getID3Data(e,A),m.push({pts:d,dts:d,data:o}),A+=o.length):A++;this.remuxer.remux(i,{samples:[]},{samples:m,inputTimeScale:9e4},{samples:[]},t,n,r)},t.destroy=function(){},e}(),y=n("./src/demux/mp4demuxer.js"),b={BitratesMap:[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],SamplingRateMap:[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],SamplesCoefficients:[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],BytesInSlot:[0,1,1,4],appendFrame:function(e,t,n,r,i){if(!(n+24>t.length)){var o=this.parseHeader(t,n);if(o&&n+o.frameLength<=t.length){var a=r+i*(9e4*o.samplesPerFrame/o.sampleRate),s={unit:t.subarray(n,n+o.frameLength),pts:a,dts:a};return e.config=[],e.channelCount=o.channelCount,e.samplerate=o.sampleRate,e.samples.push(s),{sample:s,length:o.frameLength}}}},parseHeader:function(e,t){var n=e[t+1]>>3&3,r=e[t+1]>>1&3,i=e[t+2]>>4&15,o=e[t+2]>>2&3,a=e[t+2]>>1&1;if(1!==n&&0!==i&&15!==i&&3!==o){var s=3===n?3-r:3===r?3:4,c=1e3*b.BitratesMap[14*s+i-1],u=3===n?0:2===n?1:2,l=b.SamplingRateMap[3*u+o],d=e[t+3]>>6==3?1:2,h=b.SamplesCoefficients[n][r],f=b.BytesInSlot[r],p=8*h*f;return{sampleRate:l,channelCount:d,frameLength:parseInt(h*c/l+a,10)*f,samplesPerFrame:p}}},isHeaderPattern:function(e,t){return 255===e[t]&&224==(224&e[t+1])&&0!=(6&e[t+1])},isHeader:function(e,t){return!!(t+1<e.length&&this.isHeaderPattern(e,t))},probe:function(e,t){if(t+1<e.length&&this.isHeaderPattern(e,t)){var n=this.parseHeader(e,t),r=4;n&&n.frameLength&&(r=n.frameLength);var i=t+r;if(i===e.length||i+1<e.length&&this.isHeaderPattern(e,i))return!0}return!1}},E=b,_=function(){function e(e){this.data=e,this.bytesAvailable=e.byteLength,this.word=0,this.bitsAvailable=0}var t=e.prototype;return t.loadWord=function(){var e=this.data,t=this.bytesAvailable,n=e.byteLength-t,r=new Uint8Array(4),i=Math.min(4,t);if(0===i)throw new Error("no bytes available");r.set(e.subarray(n,n+i)),this.word=new DataView(r.buffer).getUint32(0),this.bitsAvailable=8*i,this.bytesAvailable-=i},t.skipBits=function(e){var t;this.bitsAvailable>e?(this.word<<=e,this.bitsAvailable-=e):(e-=this.bitsAvailable,e-=(t=e>>3)>>3,this.bytesAvailable-=t,this.loadWord(),this.word<<=e,this.bitsAvailable-=e)},t.readBits=function(e){var t=Math.min(this.bitsAvailable,e),n=this.word>>>32-t;return e>32&&s.logger.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=t,this.bitsAvailable>0?this.word<<=t:this.bytesAvailable>0&&this.loadWord(),(t=e-t)>0&&this.bitsAvailable?n<<t|this.readBits(t):n},t.skipLZ=function(){var e;for(e=0;e<this.bitsAvailable;++e)if(0!=(this.word&2147483648>>>e))return this.word<<=e,this.bitsAvailable-=e,e;return this.loadWord(),e+this.skipLZ()},t.skipUEG=function(){this.skipBits(1+this.skipLZ())},t.skipEG=function(){this.skipBits(1+this.skipLZ())},t.readUEG=function(){var e=this.skipLZ();return this.readBits(e+1)-1},t.readEG=function(){var e=this.readUEG();return 1&e?1+e>>>1:-1*(e>>>1)},t.readBoolean=function(){return 1===this.readBits(1)},t.readUByte=function(){return this.readBits(8)},t.readUShort=function(){return this.readBits(16)},t.readUInt=function(){return this.readBits(32)},t.skipScalingList=function(e){var t,n=8,r=8;for(t=0;t<e;t++)0!==r&&(r=(n+this.readEG()+256)%256),n=0===r?n:r},t.readSPS=function(){var e,t,n,r,i,o,a,s=0,c=0,u=0,l=0,d=this.readUByte.bind(this),h=this.readBits.bind(this),f=this.readUEG.bind(this),p=this.readBoolean.bind(this),A=this.skipBits.bind(this),g=this.skipEG.bind(this),v=this.skipUEG.bind(this),m=this.skipScalingList.bind(this);if(d(),e=d(),h(5),A(3),d(),v(),100===e||110===e||122===e||244===e||44===e||83===e||86===e||118===e||128===e){var y=f();if(3===y&&A(1),v(),v(),A(1),p())for(o=3!==y?8:12,a=0;a<o;a++)p()&&m(a<6?16:64)}v();var b=f();if(0===b)f();else if(1===b)for(A(1),g(),g(),t=f(),a=0;a<t;a++)g();v(),A(1),n=f(),r=f(),0===(i=h(1))&&A(1),A(1),p()&&(s=f(),c=f(),u=f(),l=f());var E=[1,1];if(p()&&p())switch(d()){case 1:E=[1,1];break;case 2:E=[12,11];break;case 3:E=[10,11];break;case 4:E=[16,11];break;case 5:E=[40,33];break;case 6:E=[24,11];break;case 7:E=[20,11];break;case 8:E=[32,11];break;case 9:E=[80,33];break;case 10:E=[18,11];break;case 11:E=[15,11];break;case 12:E=[64,33];break;case 13:E=[160,99];break;case 14:E=[4,3];break;case 15:E=[3,2];break;case 16:E=[2,1];break;case 255:E=[d()<<8|d(),d()<<8|d()]}return{width:Math.ceil(16*(n+1)-2*s-2*c),height:(2-i)*(r+1)*16-(i?2:4)*(u+l),pixelRatio:E}},t.readSliceType=function(){return this.readUByte(),this.readUEG(),this.readUEG()},e}(),w=function(){function e(e,t,n,r){this.decryptdata=n,this.discardEPB=r,this.decrypter=new o.default(e,t,{removePKCS7Padding:!1})}var t=e.prototype;return t.decryptBuffer=function(e,t){this.decrypter.decrypt(e,this.decryptdata.key.buffer,this.decryptdata.iv.buffer,t)},t.decryptAacSample=function(e,t,n,r){var i=e[t].unit,o=i.subarray(16,i.length-i.length%16),a=o.buffer.slice(o.byteOffset,o.byteOffset+o.length),s=this;this.decryptBuffer(a,(function(o){o=new Uint8Array(o),i.set(o,16),r||s.decryptAacSamples(e,t+1,n)}))},t.decryptAacSamples=function(e,t,n){for(;;t++){if(t>=e.length)return void n();if(!(e[t].unit.length<32)){var r=this.decrypter.isSync();if(this.decryptAacSample(e,t,n,r),!r)return}}},t.getAvcEncryptedData=function(e){for(var t=16*Math.floor((e.length-48)/160)+16,n=new Int8Array(t),r=0,i=32;i<=e.length-16;i+=160,r+=16)n.set(e.subarray(i,i+16),r);return n},t.getAvcDecryptedUnit=function(e,t){t=new Uint8Array(t);for(var n=0,r=32;r<=e.length-16;r+=160,n+=16)e.set(t.subarray(n,n+16),r);return e},t.decryptAvcSample=function(e,t,n,r,i,o){var a=this.discardEPB(i.data),s=this.getAvcEncryptedData(a),c=this;this.decryptBuffer(s.buffer,(function(s){i.data=c.getAvcDecryptedUnit(a,s),o||c.decryptAvcSamples(e,t,n+1,r)}))},t.decryptAvcSamples=function(e,t,n,r){for(;;t++,n=0){if(t>=e.length)return void r();for(var i=e[t].units;!(n>=i.length);n++){var o=i[n];if(!(o.length<=48||1!==o.type&&5!==o.type)){var a=this.decrypter.isSync();if(this.decryptAvcSample(e,t,n,r,o,a),!a)return}}}},e}(),S={video:1,audio:2,id3:3,text:4},T=function(){function e(e,t,n,r){this.observer=e,this.config=n,this.typeSupported=r,this.remuxer=t,this.sampleAes=null,this.pmtUnknownTypes={}}var t=e.prototype;return t.setDecryptData=function(e){null!=e&&null!=e.key&&"SAMPLE-AES"===e.method?this.sampleAes=new w(this.observer,this.config,e,this.discardEPB):this.sampleAes=null},e.probe=function(t){var n=e._syncOffset(t);return!(n<0)&&(n&&s.logger.warn("MPEG2-TS detected but first sync word found @ offset "+n+", junk ahead ?"),!0)},e._syncOffset=function(e){for(var t=Math.min(1e3,e.length-564),n=0;n<t;){if(71===e[n]&&71===e[n+188]&&71===e[n+376])return n;n++}return-1},e.createTrack=function(e,t){return{container:"video"===e||"audio"===e?"video/mp2t":void 0,type:e,id:S[e],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:"video"===e?0:void 0,isAAC:"audio"===e||void 0,duration:"audio"===e?t:void 0}},t.resetInitSegment=function(t,n,r,i){this.pmtParsed=!1,this._pmtId=-1,this.pmtUnknownTypes={},this._avcTrack=e.createTrack("video",i),this._audioTrack=e.createTrack("audio",i),this._id3Track=e.createTrack("id3",i),this._txtTrack=e.createTrack("text",i),this.aacOverFlow=null,this.aacLastPTS=null,this.avcSample=null,this.audioCodec=n,this.videoCodec=r,this._duration=i},t.resetTimeStamp=function(){},t.append=function(t,n,o,a){var c,u,l,d,h,f=t.length,p=!1;this.pmtUnknownTypes={},this.contiguous=o;var A=this.pmtParsed,g=this._avcTrack,v=this._audioTrack,m=this._id3Track,y=g.pid,b=v.pid,E=m.pid,_=this._pmtId,w=g.pesData,S=v.pesData,T=m.pesData,R=this._parsePAT,C=this._parsePMT.bind(this),I=this._parsePES,x=this._parseAVCPES.bind(this),O=this._parseAACPES.bind(this),N=this._parseMPEGPES.bind(this),B=this._parseID3PES.bind(this),M=e._syncOffset(t);for(f-=(f+M)%188,c=M;c<f;c+=188)if(71===t[c]){if(u=!!(64&t[c+1]),l=((31&t[c+1])<<8)+t[c+2],(48&t[c+3])>>4>1){if((d=c+5+t[c+4])===c+188)continue}else d=c+4;switch(l){case y:u&&(w&&(h=I(w))&&x(h,!1),w={data:[],size:0}),w&&(w.data.push(t.subarray(d,c+188)),w.size+=c+188-d);break;case b:u&&(S&&(h=I(S))&&(v.isAAC?O(h):N(h)),S={data:[],size:0}),S&&(S.data.push(t.subarray(d,c+188)),S.size+=c+188-d);break;case E:u&&(T&&(h=I(T))&&B(h),T={data:[],size:0}),T&&(T.data.push(t.subarray(d,c+188)),T.size+=c+188-d);break;case 0:u&&(d+=t[d]+1),_=this._pmtId=R(t,d);break;case _:u&&(d+=t[d]+1);var L=C(t,d,!0===this.typeSupported.mpeg||!0===this.typeSupported.mp3,null!=this.sampleAes);(y=L.avc)>0&&(g.pid=y),(b=L.audio)>0&&(v.pid=b,v.isAAC=L.isAAC),(E=L.id3)>0&&(m.pid=E),p&&!A&&(s.logger.log("reparse from beginning"),p=!1,c=M-188),A=this.pmtParsed=!0;break;case 17:case 8191:break;default:p=!0}}else this.observer.trigger(r.default.ERROR,{type:i.ErrorTypes.MEDIA_ERROR,details:i.ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,reason:"TS packet did not start with 0x47"});w&&(h=I(w))?(x(h,!0),g.pesData=null):g.pesData=w,S&&(h=I(S))?(v.isAAC?O(h):N(h),v.pesData=null):(S&&S.size&&s.logger.log("last AAC PES packet truncated,might overlap between fragments"),v.pesData=S),T&&(h=I(T))?(B(h),m.pesData=null):m.pesData=T,null==this.sampleAes?this.remuxer.remux(v,g,m,this._txtTrack,n,o,a):this.decryptAndRemux(v,g,m,this._txtTrack,n,o,a)},t.decryptAndRemux=function(e,t,n,r,i,o,a){if(e.samples&&e.isAAC){var s=this;this.sampleAes.decryptAacSamples(e.samples,0,(function(){s.decryptAndRemuxAvc(e,t,n,r,i,o,a)}))}else this.decryptAndRemuxAvc(e,t,n,r,i,o,a)},t.decryptAndRemuxAvc=function(e,t,n,r,i,o,a){if(t.samples){var s=this;this.sampleAes.decryptAvcSamples(t.samples,0,0,(function(){s.remuxer.remux(e,t,n,r,i,o,a)}))}else this.remuxer.remux(e,t,n,r,i,o,a)},t.destroy=function(){this._initPTS=this._initDTS=void 0,this._duration=0},t._parsePAT=function(e,t){return(31&e[t+10])<<8|e[t+11]},t._trackUnknownPmt=function(e,t,n){var r=this.pmtUnknownTypes[e]||0;return 0===r&&(this.pmtUnknownTypes[e]=0,t.call(s.logger,n)),this.pmtUnknownTypes[e]++,r},t._parsePMT=function(e,t,n,r){var i,o,a={audio:-1,avc:-1,id3:-1,isAAC:!0};for(i=t+3+((15&e[t+1])<<8|e[t+2])-4,t+=12+((15&e[t+10])<<8|e[t+11]);t<i;){switch(o=(31&e[t+1])<<8|e[t+2],e[t]){case 207:if(!r){this._trackUnknownPmt(e[t],s.logger.warn,"ADTS AAC with AES-128-CBC frame encryption found in unencrypted stream");break}case 15:-1===a.audio&&(a.audio=o);break;case 21:-1===a.id3&&(a.id3=o);break;case 219:if(!r){this._trackUnknownPmt(e[t],s.logger.warn,"H.264 with AES-128-CBC slice encryption found in unencrypted stream");break}case 27:-1===a.avc&&(a.avc=o);break;case 3:case 4:n?-1===a.audio&&(a.audio=o,a.isAAC=!1):this._trackUnknownPmt(e[t],s.logger.warn,"MPEG audio found, not supported in this browser");break;case 36:this._trackUnknownPmt(e[t],s.logger.warn,"Unsupported HEVC stream type found");break;default:this._trackUnknownPmt(e[t],s.logger.log,"Unknown stream type:"+e[t])}t+=5+((15&e[t+3])<<8|e[t+4])}return a},t._parsePES=function(e){var t,n,r,i,o,a,c,u,l=0,d=e.data;if(!e||0===e.size)return null;for(;d[0].length<19&&d.length>1;){var h=new Uint8Array(d[0].length+d[1].length);h.set(d[0]),h.set(d[1],d[0].length),d[0]=h,d.splice(1,1)}if(1===((t=d[0])[0]<<16)+(t[1]<<8)+t[2]){if((r=(t[4]<<8)+t[5])&&r>e.size-6)return null;if(192&(n=t[7])&&(a=536870912*(14&t[9])+4194304*(255&t[10])+16384*(254&t[11])+128*(255&t[12])+(254&t[13])/2,64&n?a-(c=536870912*(14&t[14])+4194304*(255&t[15])+16384*(254&t[16])+128*(255&t[17])+(254&t[18])/2)>54e5&&(s.logger.warn(Math.round((a-c)/9e4)+"s delta between PTS and DTS, align them"),a=c):c=a),u=(i=t[8])+9,e.size<=u)return null;e.size-=u,o=new Uint8Array(e.size);for(var f=0,p=d.length;f<p;f++){var A=(t=d[f]).byteLength;if(u){if(u>A){u-=A;continue}t=t.subarray(u),A-=u,u=0}o.set(t,l),l+=A}return r&&(r-=i+3),{data:o,pts:a,dts:c,len:r}}return null},t.pushAccesUnit=function(e,t){if(e.units.length&&e.frame){var n=t.samples,r=n.length;if(isNaN(e.pts)){if(!r)return void t.dropped++;var i=n[r-1];e.pts=i.pts,e.dts=i.dts}!this.config.forceKeyFrameOnDiscontinuity||!0===e.key||t.sps&&(r||this.contiguous)?(e.id=r,n.push(e)):t.dropped++}e.debug.length&&s.logger.log(e.pts+"/"+e.dts+":"+e.debug)},t._parseAVCPES=function(e,t){var n,r,i,o=this,a=this._avcTrack,s=this._parseAVCNALu(e.data),c=this.avcSample,u=!1,l=this.pushAccesUnit.bind(this),d=function(e,t,n,r){return{key:e,pts:t,dts:n,units:[],debug:r}};e.data=null,c&&s.length&&!a.audFound&&(l(c,a),c=this.avcSample=d(!1,e.pts,e.dts,"")),s.forEach((function(t){switch(t.type){case 1:r=!0,c||(c=o.avcSample=d(!0,e.pts,e.dts,"")),c.frame=!0;var s=t.data;if(u&&s.length>4){var h=new _(s).readSliceType();2!==h&&4!==h&&7!==h&&9!==h||(c.key=!0)}break;case 5:r=!0,c||(c=o.avcSample=d(!0,e.pts,e.dts,"")),c.key=!0,c.frame=!0;break;case 6:r=!0,(n=new _(o.discardEPB(t.data))).readUByte();for(var f=0,p=0,A=!1,g=0;!A&&n.bytesAvailable>1;){f=0;do{f+=g=n.readUByte()}while(255===g);p=0;do{p+=g=n.readUByte()}while(255===g);if(4===f&&0!==n.bytesAvailable){if(A=!0,181===n.readUByte())if(49===n.readUShort())if(1195456820===n.readUInt())if(3===n.readUByte()){var m=n.readUByte(),y=31&m,b=[m,n.readUByte()];for(i=0;i<y;i++)b.push(n.readUByte()),b.push(n.readUByte()),b.push(n.readUByte());o._insertSampleInOrder(o._txtTrack.samples,{type:3,pts:e.pts,bytes:b})}}else if(5===f&&0!==n.bytesAvailable){if(A=!0,p>16){var E=[];for(i=0;i<16;i++)E.push(n.readUByte().toString(16)),3!==i&&5!==i&&7!==i&&9!==i||E.push("-");var w=p-16,S=new Uint8Array(w);for(i=0;i<w;i++)S[i]=n.readUByte();o._insertSampleInOrder(o._txtTrack.samples,{pts:e.pts,payloadType:f,uuid:E.join(""),userDataBytes:S,userData:Object(v.utf8ArrayToStr)(S.buffer)})}}else if(p<n.bytesAvailable)for(i=0;i<p;i++)n.readUByte()}break;case 7:if(r=!0,u=!0,!a.sps){var T=(n=new _(t.data)).readSPS();a.width=T.width,a.height=T.height,a.pixelRatio=T.pixelRatio,a.sps=[t.data],a.duration=o._duration;var R=t.data.subarray(1,4),C="avc1.";for(i=0;i<3;i++){var I=R[i].toString(16);I.length<2&&(I="0"+I),C+=I}a.codec=C}break;case 8:r=!0,a.pps||(a.pps=[t.data]);break;case 9:r=!1,a.audFound=!0,c&&l(c,a),c=o.avcSample=d(!1,e.pts,e.dts,"");break;case 12:r=!1;break;default:r=!1,c&&(c.debug+="unknown NAL "+t.type+" ")}c&&r&&c.units.push(t)})),t&&c&&(l(c,a),this.avcSample=null)},t._insertSampleInOrder=function(e,t){var n=e.length;if(n>0){if(t.pts>=e[n-1].pts)e.push(t);else for(var r=n-1;r>=0;r--)if(t.pts<e[r].pts){e.splice(r,0,t);break}}else e.push(t)},t._getLastNalUnit=function(){var e,t=this.avcSample;if(!t||0===t.units.length){var n=this._avcTrack.samples;t=n[n.length-1]}if(t){var r=t.units;e=r[r.length-1]}return e},t._parseAVCNALu=function(e){var t,n,r,i,o=0,a=e.byteLength,s=this._avcTrack,c=s.naluState||0,u=c,l=[],d=-1;for(-1===c&&(d=0,i=31&e[0],c=0,o=1);o<a;)if(t=e[o++],c)if(1!==c)if(t)if(1===t){if(d>=0)r={data:e.subarray(d,o-c-1),type:i},l.push(r);else{var h=this._getLastNalUnit();if(h&&(u&&o<=4-u&&h.state&&(h.data=h.data.subarray(0,h.data.byteLength-u)),(n=o-c-1)>0)){var f=new Uint8Array(h.data.byteLength+n);f.set(h.data,0),f.set(e.subarray(0,n),h.data.byteLength),h.data=f}}o<a?(d=o,i=31&e[o],c=0):c=-1}else c=0;else c=3;else c=t?0:2;else c=t?0:1;if(d>=0&&c>=0&&(r={data:e.subarray(d,a),type:i,state:c},l.push(r)),0===l.length){var p=this._getLastNalUnit();if(p){var A=new Uint8Array(p.data.byteLength+e.byteLength);A.set(p.data,0),A.set(e,p.data.byteLength),p.data=A}}return s.naluState=c,l},t.discardEPB=function(e){for(var t,n,r=e.byteLength,i=[],o=1;o<r-2;)0===e[o]&&0===e[o+1]&&3===e[o+2]?(i.push(o+2),o+=2):o++;if(0===i.length)return e;t=r-i.length,n=new Uint8Array(t);var a=0;for(o=0;o<t;a++,o++)a===i[0]&&(a++,i.shift()),n[o]=e[a];return n},t._parseAACPES=function(e){var t,n,o,a,c,u,l,d=this._audioTrack,f=e.data,v=e.pts,m=this.aacOverFlow,y=this.aacLastPTS;if(m){var b=new Uint8Array(m.byteLength+f.byteLength);b.set(m,0),b.set(f,m.byteLength),f=b}for(o=0,c=f.length;o<c-1&&!h(f,o);o++);if(o&&(o<c-1?(u="AAC PES did not start with ADTS header,offset:"+o,l=!1):(u="no ADTS header found in AAC PES",l=!0),s.logger.warn("parsing error:"+u),this.observer.trigger(r.default.ERROR,{type:i.ErrorTypes.MEDIA_ERROR,details:i.ErrorDetails.FRAG_PARSING_ERROR,fatal:l,reason:u}),l))return;if(p(d,this.observer,f,o,this.audioCodec),n=0,t=A(d.samplerate),m&&y){var E=y+t;Math.abs(E-v)>1&&(s.logger.log("AAC: align PTS for overlapping frames by "+Math.round((E-v)/90)),v=E)}for(;o<c;){if(h(f,o)){if(o+5<c){var _=g(d,f,o,v,n);if(_){o+=_.length,a=_.sample.pts,n++;continue}}break}o++}m=o<c?f.subarray(o,c):null,this.aacOverFlow=m,this.aacLastPTS=a},t._parseMPEGPES=function(e){for(var t=e.data,n=t.length,r=0,i=0,o=e.pts;i<n;)if(E.isHeader(t,i)){var a=E.appendFrame(this._audioTrack,t,i,o,r);if(!a)break;i+=a.length,r++}else i++},t._parseID3PES=function(e){this._id3Track.samples.push(e)},e}(),R=function(){function e(e,t,n){this.observer=e,this.config=n,this.remuxer=t}var t=e.prototype;return t.resetInitSegment=function(e,t,n,r){this._audioTrack={container:"audio/mpeg",type:"audio",id:-1,sequenceNumber:0,isAAC:!1,samples:[],len:0,manifestCodec:t,duration:r,inputTimeScale:9e4}},t.resetTimeStamp=function(){},e.probe=function(e){var t,n,r=v.default.getID3Data(e,0);if(r&&void 0!==v.default.getTimeStamp(r))for(t=r.length,n=Math.min(e.length-1,t+100);t<n;t++)if(E.probe(e,t))return s.logger.log("MPEG Audio sync word found !"),!0;return!1},t.append=function(e,t,n,r){for(var i=v.default.getID3Data(e,0)||[],o=v.default.getTimeStamp(i),a=void 0!==o?90*o:9e4*t,s=i.length,c=e.length,u=0,l=0,d=this._audioTrack,h=[{pts:a,dts:a,data:i}];s<c;)if(E.isHeader(e,s)){var f=E.appendFrame(d,e,s,a,u);if(!f)break;s+=f.length,l=f.sample.pts,u++}else v.default.isHeader(e,s)?(i=v.default.getID3Data(e,s),h.push({pts:l,dts:l,data:i}),s+=i.length):s++;this.remuxer.remux(d,{samples:[]},{samples:h,inputTimeScale:9e4},{samples:[]},t,n,r)},t.destroy=function(){},e}(),C=function(){function e(){}return e.getSilentFrame=function(e,t){switch(e){case"mp4a.40.2":if(1===t)return new Uint8Array([0,200,0,128,35,128]);if(2===t)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(3===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(4===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(5===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(6===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(1===t)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(2===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(3===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}return null},e}(),I=Math.pow(2,32)-1,x=function(){function e(){}return e.init=function(){var t;for(t in e.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]},e.types)e.types.hasOwnProperty(t)&&(e.types[t]=[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3)]);var n=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),r=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);e.HDLR_TYPES={video:n,audio:r};var i=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),o=new Uint8Array([0,0,0,0,0,0,0,0]);e.STTS=e.STSC=e.STCO=o,e.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),e.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),e.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),e.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);var a=new Uint8Array([105,115,111,109]),s=new Uint8Array([97,118,99,49]),c=new Uint8Array([0,0,0,1]);e.FTYP=e.box(e.types.ftyp,a,c,a,s),e.DINF=e.box(e.types.dinf,e.box(e.types.dref,i))},e.box=function(e){for(var t,n=Array.prototype.slice.call(arguments,1),r=8,i=n.length,o=i;i--;)r+=n[i].byteLength;for((t=new Uint8Array(r))[0]=r>>24&255,t[1]=r>>16&255,t[2]=r>>8&255,t[3]=255&r,t.set(e,4),i=0,r=8;i<o;i++)t.set(n[i],r),r+=n[i].byteLength;return t},e.hdlr=function(t){return e.box(e.types.hdlr,e.HDLR_TYPES[t])},e.mdat=function(t){return e.box(e.types.mdat,t)},e.mdhd=function(t,n){n*=t;var r=Math.floor(n/(I+1)),i=Math.floor(n%(I+1));return e.box(e.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,255&t,r>>24,r>>16&255,r>>8&255,255&r,i>>24,i>>16&255,i>>8&255,255&i,85,196,0,0]))},e.mdia=function(t){return e.box(e.types.mdia,e.mdhd(t.timescale,t.duration),e.hdlr(t.type),e.minf(t))},e.mfhd=function(t){return e.box(e.types.mfhd,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,255&t]))},e.minf=function(t){return"audio"===t.type?e.box(e.types.minf,e.box(e.types.smhd,e.SMHD),e.DINF,e.stbl(t)):e.box(e.types.minf,e.box(e.types.vmhd,e.VMHD),e.DINF,e.stbl(t))},e.moof=function(t,n,r){return e.box(e.types.moof,e.mfhd(t),e.traf(r,n))},e.moov=function(t){for(var n=t.length,r=[];n--;)r[n]=e.trak(t[n]);return e.box.apply(null,[e.types.moov,e.mvhd(t[0].timescale,t[0].duration)].concat(r).concat(e.mvex(t)))},e.mvex=function(t){for(var n=t.length,r=[];n--;)r[n]=e.trex(t[n]);return e.box.apply(null,[e.types.mvex].concat(r))},e.mvhd=function(t,n){n*=t;var r=Math.floor(n/(I+1)),i=Math.floor(n%(I+1)),o=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,255&t,r>>24,r>>16&255,r>>8&255,255&r,i>>24,i>>16&255,i>>8&255,255&i,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return e.box(e.types.mvhd,o)},e.sdtp=function(t){var n,r,i=t.samples||[],o=new Uint8Array(4+i.length);for(r=0;r<i.length;r++)n=i[r].flags,o[r+4]=n.dependsOn<<4|n.isDependedOn<<2|n.hasRedundancy;return e.box(e.types.sdtp,o)},e.stbl=function(t){return e.box(e.types.stbl,e.stsd(t),e.box(e.types.stts,e.STTS),e.box(e.types.stsc,e.STSC),e.box(e.types.stsz,e.STSZ),e.box(e.types.stco,e.STCO))},e.avc1=function(t){var n,r,i,o=[],a=[];for(n=0;n<t.sps.length;n++)i=(r=t.sps[n]).byteLength,o.push(i>>>8&255),o.push(255&i),o=o.concat(Array.prototype.slice.call(r));for(n=0;n<t.pps.length;n++)i=(r=t.pps[n]).byteLength,a.push(i>>>8&255),a.push(255&i),a=a.concat(Array.prototype.slice.call(r));var s=e.box(e.types.avcC,new Uint8Array([1,o[3],o[4],o[5],255,224|t.sps.length].concat(o).concat([t.pps.length]).concat(a))),c=t.width,u=t.height,l=t.pixelRatio[0],d=t.pixelRatio[1];return e.box(e.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,c>>8&255,255&c,u>>8&255,255&u,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),s,e.box(e.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),e.box(e.types.pasp,new Uint8Array([l>>24,l>>16&255,l>>8&255,255&l,d>>24,d>>16&255,d>>8&255,255&d])))},e.esds=function(e){var t=e.config.length;return new Uint8Array([0,0,0,0,3,23+t,0,1,0,4,15+t,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([t]).concat(e.config).concat([6,1,2]))},e.mp4a=function(t){var n=t.samplerate;return e.box(e.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t.channelCount,0,16,0,0,0,0,n>>8&255,255&n,0,0]),e.box(e.types.esds,e.esds(t)))},e.mp3=function(t){var n=t.samplerate;return e.box(e.types[".mp3"],new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t.channelCount,0,16,0,0,0,0,n>>8&255,255&n,0,0]))},e.stsd=function(t){return"audio"===t.type?t.isAAC||"mp3"!==t.codec?e.box(e.types.stsd,e.STSD,e.mp4a(t)):e.box(e.types.stsd,e.STSD,e.mp3(t)):e.box(e.types.stsd,e.STSD,e.avc1(t))},e.tkhd=function(t){var n=t.id,r=t.duration*t.timescale,i=t.width,o=t.height,a=Math.floor(r/(I+1)),s=Math.floor(r%(I+1));return e.box(e.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,n>>24&255,n>>16&255,n>>8&255,255&n,0,0,0,0,a>>24,a>>16&255,a>>8&255,255&a,s>>24,s>>16&255,s>>8&255,255&s,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,i>>8&255,255&i,0,0,o>>8&255,255&o,0,0]))},e.traf=function(t,n){var r=e.sdtp(t),i=t.id,o=Math.floor(n/(I+1)),a=Math.floor(n%(I+1));return e.box(e.types.traf,e.box(e.types.tfhd,new Uint8Array([0,0,0,0,i>>24,i>>16&255,i>>8&255,255&i])),e.box(e.types.tfdt,new Uint8Array([1,0,0,0,o>>24,o>>16&255,o>>8&255,255&o,a>>24,a>>16&255,a>>8&255,255&a])),e.trun(t,r.length+16+20+8+16+8+8),r)},e.trak=function(t){return t.duration=t.duration||4294967295,e.box(e.types.trak,e.tkhd(t),e.mdia(t))},e.trex=function(t){var n=t.id;return e.box(e.types.trex,new Uint8Array([0,0,0,0,n>>24,n>>16&255,n>>8&255,255&n,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))},e.trun=function(t,n){var r,i,o,a,s,c,u=t.samples||[],l=u.length,d=12+16*l,h=new Uint8Array(d);for(n+=8+d,h.set([0,0,15,1,l>>>24&255,l>>>16&255,l>>>8&255,255&l,n>>>24&255,n>>>16&255,n>>>8&255,255&n],0),r=0;r<l;r++)o=(i=u[r]).duration,a=i.size,s=i.flags,c=i.cts,h.set([o>>>24&255,o>>>16&255,o>>>8&255,255&o,a>>>24&255,a>>>16&255,a>>>8&255,255&a,s.isLeading<<2|s.dependsOn,s.isDependedOn<<6|s.hasRedundancy<<4|s.paddingValue<<1|s.isNonSync,61440&s.degradPrio,15&s.degradPrio,c>>>24&255,c>>>16&255,c>>>8&255,255&c],12+16*r);return e.box(e.types.trun,h)},e.initSegment=function(t){e.types||e.init();var n,r=e.moov(t);return(n=new Uint8Array(e.FTYP.byteLength+r.byteLength)).set(e.FTYP),n.set(r,e.FTYP.byteLength),n},e}();function O(e,t,n,r){void 0===n&&(n=1),void 0===r&&(r=!1);var i=e*t*n;return r?Math.round(i):i}function N(e,t){return void 0===t&&(t=!1),O(e,1e3,1/9e4,t)}function B(e,t){return void 0===t&&(t=1),O(e,9e4,1/t)}var M=B(10),L=B(.2),k=null;function U(e,t){var n;if(void 0===t)return e;for(n=t<e?-8589934592:8589934592;Math.abs(e-t)>4294967296;)e+=n;return e}var D,P=function(){function e(e,t,n,r){if(this.observer=e,this.config=t,this.typeSupported=n,this.ISGenerated=!1,null===k){var i=navigator.userAgent.match(/Chrome\/(\d+)/i);k=i?parseInt(i[1]):0}}var t=e.prototype;return t.destroy=function(){},t.resetTimeStamp=function(e){this._initPTS=this._initDTS=e},t.resetInitSegment=function(){this.ISGenerated=!1},t.getVideoStartPts=function(e){var t=!1,n=e.reduce((function(e,n){var r=n.pts-e;return r<-4294967296?(t=!0,e):r>0?e:n.pts}),e[0].pts);return t&&s.logger.debug("PTS rollover detected"),n},t.remux=function(e,t,n,i,o,a,c){if(this.ISGenerated||this.generateIS(e,t,o),this.ISGenerated){var u=e.samples.length,l=t.samples.length,d=o,h=o;if(u&&l){var f=this.getVideoStartPts(t.samples),p=(e.samples[0].pts-f)/t.inputTimeScale;d+=Math.max(0,p),h+=Math.max(0,-p)}if(u){e.timescale||(s.logger.warn("regenerate InitSegment as audio detected"),this.generateIS(e,t,o));var A,g=this.remuxAudio(e,d,a,c);if(l)g&&(A=g.endPTS-g.startPTS),t.timescale||(s.logger.warn("regenerate InitSegment as video detected"),this.generateIS(e,t,o)),this.remuxVideo(t,h,a,A)}else if(l){var v=this.remuxVideo(t,h,a,0,c);v&&e.codec&&this.remuxEmptyAudio(e,d,a,v)}}n.samples.length&&this.remuxID3(n,o),i.samples.length&&this.remuxText(i,o),this.observer.trigger(r.default.FRAG_PARSED)},t.generateIS=function(e,t,n){var o,a,c=this.observer,u=e.samples,l=t.samples,d=this.typeSupported,h="audio/mp4",f={},p={tracks:f},A=void 0===this._initPTS;if(A&&(o=a=1/0),e.config&&u.length&&(e.timescale=e.samplerate,s.logger.log("audio sampling rate : "+e.samplerate),e.isAAC||(d.mpeg?(h="audio/mpeg",e.codec=""):d.mp3&&(e.codec="mp3")),f.audio={container:h,codec:e.codec,initSegment:!e.isAAC&&d.mpeg?new Uint8Array:x.initSegment([e]),metadata:{channelCount:e.channelCount}},A&&(o=a=u[0].pts-Math.round(e.inputTimeScale*n))),t.sps&&t.pps&&l.length){var g=t.inputTimeScale;if(t.timescale=g,f.video={container:"video/mp4",codec:t.codec,initSegment:x.initSegment([t]),metadata:{width:t.width,height:t.height}},A){var v=this.getVideoStartPts(l),m=Math.round(g*n);a=Math.min(a,l[0].dts-m),o=Math.min(o,v-m),this.observer.trigger(r.default.INIT_PTS_FOUND,{initPTS:o})}}else A&&f.audio&&this.observer.trigger(r.default.INIT_PTS_FOUND,{initPTS:o});Object.keys(f).length?(c.trigger(r.default.FRAG_PARSING_INIT_SEGMENT,p),this.ISGenerated=!0,A&&(this._initPTS=o,this._initDTS=a)):c.trigger(r.default.ERROR,{type:i.ErrorTypes.MEDIA_ERROR,details:i.ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,reason:"no audio/video samples found"})},t.remuxVideo=function(e,t,n,o){var a,c,u,l,d,h=e.timescale,f=e.samples,p=[],A=f.length,g=this._initPTS,v=8,m=Number.POSITIVE_INFINITY,y=Number.NEGATIVE_INFINITY,b=0,E=!1,_=this.nextAvcDts;if(0!==A){if(!n)_=t*h-(f[0].pts-U(f[0].dts,f[0].pts));for(var w=0;w<A;w++){var S=f[w];S.pts=U(S.pts-g,_),S.dts=U(S.dts-g,_),S.dts>S.pts&&(b=Math.max(Math.min(b,S.pts-S.dts),-1*L)),S.dts<f[w>0?w-1:w].dts&&(E=!0)}E&&f.sort((function(e,t){var n=e.dts-t.dts,r=e.pts-t.pts;return n||r||e.id-t.id})),l=f[0].dts,d=f[A-1].dts;var T=Math.round((d-l)/(A-1));if(b<0){if(b<-2*T){s.logger.warn("PTS < DTS detected in video samples, offsetting DTS to PTS "+N(-T,!0)+" ms");for(var R=0;R<A;R++)f[R].dts=f[R].pts-T}else{s.logger.warn("PTS < DTS detected in video samples, shifting DTS by "+N(b,!0)+" ms to overcome this issue");for(var C=0;C<A;C++)f[C].dts=f[C].dts+b}l=f[0].dts,d=f[A-1].dts}if(n){var I=l-_,O=I>T;if(O||I<-1){O?s.logger.warn("AVC: "+N(I,!0)+" ms ("+I+"dts) hole between fragments detected, filling it"):s.logger.warn("AVC: "+N(-I,!0)+" ms ("+I+"dts) overlapping between fragments detected"),l=_;var B=f[0].pts-I;f[0].dts=l,f[0].pts=B,s.logger.log("Video: First PTS/DTS adjusted: "+N(B,!0)+"/"+N(l,!0)+", delta: "+N(I,!0)+" ms")}}k&&k<75&&(l=Math.max(0,l));for(var M=0,D=0,P=0;P<A;P++){for(var F=f[P],H=F.units,j=H.length,V=0,Q=0;Q<j;Q++)V+=H[Q].data.length;D+=V,M+=j,F.length=V,F.dts=Math.max(F.dts,l),F.pts=Math.max(F.pts,F.dts,0),m=Math.min(F.pts,m),y=Math.max(F.pts,y)}d=f[A-1].dts;var G=D+4*M+8;try{c=new Uint8Array(G)}catch(e){return void this.observer.trigger(r.default.ERROR,{type:i.ErrorTypes.MUX_ERROR,details:i.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:G,reason:"fail allocating video mdat "+G})}var z=new DataView(c.buffer);z.setUint32(0,G),c.set(x.types.mdat,4);for(var K=0;K<A;K++){for(var q,W=f[K],X=W.units,J=0,Y=0,Z=X.length;Y<Z;Y++){var $=X[Y],ee=$.data,te=$.data.byteLength;z.setUint32(v,te),v+=4,c.set(ee,v),v+=te,J+=4+te}if(K<A-1)a=f[K+1].dts-W.dts;else{var ne=this.config,re=W.dts-f[K>0?K-1:K].dts;if(ne.stretchShortVideoTrack){var ie=ne.maxBufferHole,oe=Math.floor(ie*h),ae=(o?m+o*h:this.nextAudioPts)-W.pts;ae>oe?((a=ae-re)<0&&(a=re),s.logger.log("It is approximately "+N(ae,!1)+" ms to the next segment; using duration "+N(a,!1)+" ms for the last video frame.")):a=re}else a=re}q=Math.round(W.pts-W.dts),p.push({size:J,duration:a,cts:q,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:W.key?2:1,isNonSync:W.key?0:1}})}this.nextAvcDts=d+a;var se=e.dropped;if(e.nbNalu=0,e.dropped=0,p.length&&navigator.userAgent.toLowerCase().indexOf("chrome")>-1){var ce=p[0].flags;ce.dependsOn=2,ce.isNonSync=0}e.samples=p,u=x.moof(e.sequenceNumber++,l,e),e.samples=[];var ue={data1:u,data2:c,startPTS:m/h,endPTS:(y+a)/h,startDTS:l/h,endDTS:this.nextAvcDts/h,type:"video",hasAudio:!1,hasVideo:!0,nb:p.length,dropped:se};return this.observer.trigger(r.default.FRAG_PARSING_DATA,ue),ue}},t.remuxAudio=function(e,t,n,o){var a,c,u,l,d,h,f=e.inputTimeScale,p=e.timescale,A=f/p,g=(e.isAAC?1024:1152)*A,v=this._initPTS,m=!e.isAAC&&this.typeSupported.mpeg,y=m?0:8,b=e.samples,E=[],_=this.nextAudioPts;if(n|=b.length&&_&&(o&&Math.abs(t-_/f)<.1||Math.abs(b[0].pts-_-v)<20*g),b.forEach((function(e){e.pts=e.dts=U(e.pts-v,t*f)})),0!==(b=b.filter((function(e){return e.pts>=0}))).length){if(n||(_=o?Math.max(0,t*f):b[0].pts),e.isAAC)for(var w=this.config.maxAudioFramesDrift,S=0,T=_;S<b.length;){var R=b[S],I=R.pts,O=I-T;if(O<=-w*g)n||S>0?(s.logger.warn("Dropping 1 audio frame @ "+N(T,!0)/1e3+"s due to "+N(O,!0)+" ms overlap."),b.splice(S,1)):(s.logger.warn("Audio frame @ "+N(I,!0)/1e3+"s overlaps nextAudioPts by "+N(O,!0)+" ms."),T=I+g,S++);else if(O>=w*g&&O<M&&T){var B=Math.round(O/g);s.logger.warn("Injecting "+B+" audio frames @ "+N(T,!0)/1e3+"s due to "+N(O,!0)+" ms gap.");for(var L=0;L<B;L++){var k=Math.max(T,0);(c=C.getSilentFrame(e.manifestCodec||e.codec,e.channelCount))||(s.logger.log("Unable to get silent frame for given audio codec; duplicating last frame instead."),c=R.unit.subarray()),b.splice(S,0,{unit:c,pts:k,dts:k}),T+=g,S++}R.pts=R.dts=T,T+=g,S++}else Math.abs(O),R.pts=R.dts=T,T+=g,S++}for(var D=b.length,P=0;D--;)P+=b[D].unit.byteLength;for(var F=0,H=b.length;F<H;F++){var j=b[F],V=j.unit,Q=j.pts;if(void 0!==h&&a)a.duration=Math.round((Q-h)/A);else{var G=Q-_,z=0;if(n&&e.isAAC&&G){if(G>0&&G<M)z=Math.round((Q-_)/g),s.logger.log(N(G,!0)+" ms hole between AAC samples detected,filling it"),z>0&&((c=C.getSilentFrame(e.manifestCodec||e.codec,e.channelCount))||(c=V.subarray()),P+=z*c.length);else if(G<-12){s.logger.log("drop overlapping AAC sample, expected/parsed/delta: "+N(_,!0)+" ms / "+N(Q,!0)+" ms / "+N(-G,!0)+" ms"),P-=V.byteLength;continue}Q=_}if(d=Q,!(P>0))return;P+=y;try{u=new Uint8Array(P)}catch(e){return void this.observer.trigger(r.default.ERROR,{type:i.ErrorTypes.MUX_ERROR,details:i.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:P,reason:"fail allocating audio mdat "+P})}m||(new DataView(u.buffer).setUint32(0,P),u.set(x.types.mdat,4));for(var K=0;K<z;K++)(c=C.getSilentFrame(e.manifestCodec||e.codec,e.channelCount))||(s.logger.log("Unable to get silent frame for given audio codec; duplicating this frame instead."),c=V.subarray()),u.set(c,y),y+=c.byteLength,a={size:c.byteLength,cts:0,duration:1024,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:1}},E.push(a)}u.set(V,y);var q=V.byteLength;y+=q,a={size:q,cts:0,duration:0,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:1}},E.push(a),h=Q}var W=0;if((D=E.length)>=2&&(W=E[D-2].duration,a.duration=W),D){this.nextAudioPts=_=h+A*W,e.samples=E,l=m?new Uint8Array:x.moof(e.sequenceNumber++,d/A,e),e.samples=[];var X=d/f,J=_/f,Y={data1:l,data2:u,startPTS:X,endPTS:J,startDTS:X,endDTS:J,type:"audio",hasAudio:!0,hasVideo:!1,nb:D};return this.observer.trigger(r.default.FRAG_PARSING_DATA,Y),Y}return null}},t.remuxEmptyAudio=function(e,t,n,r){var i=e.inputTimeScale,o=i/(e.samplerate?e.samplerate:i),a=this.nextAudioPts,c=(void 0!==a?a:r.startDTS*i)+this._initDTS,u=r.endDTS*i+this._initDTS,l=1024*o,d=Math.ceil((u-c)/l),h=C.getSilentFrame(e.manifestCodec||e.codec,e.channelCount);if(s.logger.warn("remux empty Audio"),h){for(var f=[],p=0;p<d;p++){var A=c+p*l;f.push({unit:h,pts:A,dts:A})}e.samples=f,this.remuxAudio(e,t,n)}else s.logger.trace("Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec!")},t.remuxID3=function(e,t){var n=e.samples.length;if(n){for(var i=e.inputTimeScale,o=this._initPTS,a=this._initDTS,s=0;s<n;s++){var c=e.samples[s];c.pts=U(c.pts-o,t*i)/i,c.dts=U(c.dts-a,t*i)/i}this.observer.trigger(r.default.FRAG_PARSING_METADATA,{samples:e.samples}),e.samples=[]}},t.remuxText=function(e,t){var n=e.samples.length,i=e.inputTimeScale,o=this._initPTS;if(n){for(var a=0;a<n;a++){var s=e.samples[a];s.pts=U(s.pts-o,t*i)/i}e.samples.sort((function(e,t){return e.pts-t.pts})),this.observer.trigger(r.default.FRAG_PARSING_USERDATA,{samples:e.samples})}e.samples=[]},e}(),F=function(){function e(e){this.observer=e}var t=e.prototype;return t.destroy=function(){},t.resetTimeStamp=function(){},t.resetInitSegment=function(){},t.remux=function(e,t,n,i,o,a,s,c){var u=this.observer,l="";e&&(l+="audio"),t&&(l+="video"),u.trigger(r.default.FRAG_PARSING_DATA,{data1:c,startPTS:o,startDTS:o,type:l,hasAudio:!!e,hasVideo:!!t,nb:1,dropped:0}),u.trigger(r.default.FRAG_PARSED)},e}(),H=Object(c.getSelfScope)();try{D=H.performance.now.bind(H.performance)}catch(e){s.logger.debug("Unable to use Performance API on this environment"),D=H.Date.now}var j=function(){function e(e,t,n,r){this.observer=e,this.typeSupported=t,this.config=n,this.vendor=r}var t=e.prototype;return t.destroy=function(){var e=this.demuxer;e&&e.destroy()},t.push=function(e,t,n,i,a,s,c,u,l,d,h,f){var p=this;if(e.byteLength>0&&null!=t&&null!=t.key&&"AES-128"===t.method){var A=this.decrypter;null==A&&(A=this.decrypter=new o.default(this.observer,this.config));var g=D();A.decrypt(e,t.key.buffer,t.iv.buffer,(function(e){var o=D();p.observer.trigger(r.default.FRAG_DECRYPTED,{stats:{tstart:g,tdecrypt:o}}),p.pushDecrypted(new Uint8Array(e),t,new Uint8Array(n),i,a,s,c,u,l,d,h,f)}))}else this.pushDecrypted(new Uint8Array(e),t,new Uint8Array(n),i,a,s,c,u,l,d,h,f)},t.pushDecrypted=function(e,t,n,o,a,s,c,u,l,d,h,f){var p=this.demuxer,A=this.remuxer;if(!p||c||u){for(var g,v=this.observer,b=this.typeSupported,E=this.config,_=[{demux:T,remux:P},{demux:y.default,remux:F},{demux:m,remux:P},{demux:R,remux:P}],w=0,S=_.length;w<S&&!(g=_[w]).demux.probe(e);w++);if(!g)return void v.trigger(r.default.ERROR,{type:i.ErrorTypes.MEDIA_ERROR,details:i.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"no demux matching with content found"});A&&A instanceof g.remux||(A=new g.remux(v,E,b,this.vendor)),p&&p instanceof g.demux||(p=new g.demux(v,A,E,b),this.probe=g.demux.probe),this.demuxer=p,this.remuxer=A}(c||u)&&(p.resetInitSegment(n,o,a,d),A.resetInitSegment()),c&&(p.resetTimeStamp(f),A.resetTimeStamp(f)),"function"==typeof p.setDecryptData&&p.setDecryptData(t),p.append(e,s,l,h)},e}();t.default=j},"./src/demux/demuxer-worker.js":
/*!*************************************!*\
  !*** ./src/demux/demuxer-worker.js ***!
  \*************************************/
/*! exports provided: default */
/*! ModuleConcatenation bailout: Module is referenced from these modules with unsupported syntax: ./src/demux/demuxer.js (referenced with require.resolve) */function(e,t,n){"use strict";n.r(t);var r=n(/*! ../demux/demuxer-inline */"./src/demux/demuxer-inline.js"),i=n(/*! ../events */"./src/events.js"),o=n(/*! ../utils/logger */"./src/utils/logger.js"),a=n(/*! eventemitter3 */"./node_modules/eventemitter3/index.js");t.default=function(e){var t=new a.EventEmitter;t.trigger=function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];t.emit.apply(t,[e,e].concat(r))},t.off=function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];t.removeListener.apply(t,[e].concat(r))};var n=function(t,n){e.postMessage({event:t,data:n})};e.addEventListener("message",(function(i){var a=i.data;switch(a.cmd){case"init":var s=JSON.parse(a.config);e.demuxer=new r.default(t,a.typeSupported,s,a.vendor),Object(o.enableLogs)(s.debug),n("init",null);break;case"demux":e.demuxer.push(a.data,a.decryptdata,a.initSegment,a.audioCodec,a.videoCodec,a.timeOffset,a.discontinuity,a.trackSwitch,a.contiguous,a.duration,a.accurateTimeOffset,a.defaultInitPTS)}})),t.on(i.default.FRAG_DECRYPTED,n),t.on(i.default.FRAG_PARSING_INIT_SEGMENT,n),t.on(i.default.FRAG_PARSED,n),t.on(i.default.ERROR,n),t.on(i.default.FRAG_PARSING_METADATA,n),t.on(i.default.FRAG_PARSING_USERDATA,n),t.on(i.default.INIT_PTS_FOUND,n),t.on(i.default.FRAG_PARSING_DATA,(function(t,n){var r=[],i={event:t,data:n};n.data1&&(i.data1=n.data1.buffer,r.push(n.data1.buffer),delete n.data1),n.data2&&(i.data2=n.data2.buffer,r.push(n.data2.buffer),delete n.data2),e.postMessage(i,r)}))}},"./src/demux/id3.js":
/*!**************************!*\
  !*** ./src/demux/id3.js ***!
  \**************************/
/*! exports provided: default, utf8ArrayToStr */function(e,t,n){"use strict";n.r(t),n.d(t,"utf8ArrayToStr",(function(){return s}));var r,i=n(/*! ../utils/get-self-scope */"./src/utils/get-self-scope.js"),o=function(){function e(){}return e.isHeader=function(e,t){return t+10<=e.length&&73===e[t]&&68===e[t+1]&&51===e[t+2]&&e[t+3]<255&&e[t+4]<255&&e[t+6]<128&&e[t+7]<128&&e[t+8]<128&&e[t+9]<128},e.isFooter=function(e,t){return t+10<=e.length&&51===e[t]&&68===e[t+1]&&73===e[t+2]&&e[t+3]<255&&e[t+4]<255&&e[t+6]<128&&e[t+7]<128&&e[t+8]<128&&e[t+9]<128},e.getID3Data=function(t,n){for(var r=n,i=0;e.isHeader(t,n);){i+=10,i+=e._readSize(t,n+6),e.isFooter(t,n+10)&&(i+=10),n+=i}if(i>0)return t.subarray(r,r+i)},e._readSize=function(e,t){var n=0;return n=(127&e[t])<<21,n|=(127&e[t+1])<<14,n|=(127&e[t+2])<<7,n|=127&e[t+3]},e.getTimeStamp=function(t){for(var n=e.getID3Frames(t),r=0;r<n.length;r++){var i=n[r];if(e.isTimeStampFrame(i))return e._readTimeStamp(i)}},e.isTimeStampFrame=function(e){return e&&"PRIV"===e.key&&"com.apple.streaming.transportStreamTimestamp"===e.info},e._getFrameData=function(t){var n=String.fromCharCode(t[0],t[1],t[2],t[3]),r=e._readSize(t,4);return{type:n,size:r,data:t.subarray(10,10+r)}},e.getID3Frames=function(t){for(var n=0,r=[];e.isHeader(t,n);){for(var i=e._readSize(t,n+6),o=(n+=10)+i;n+8<o;){var a=e._getFrameData(t.subarray(n)),s=e._decodeFrame(a);s&&r.push(s),n+=a.size+10}e.isFooter(t,n)&&(n+=10)}return r},e._decodeFrame=function(t){return"PRIV"===t.type?e._decodePrivFrame(t):"T"===t.type[0]?e._decodeTextFrame(t):"W"===t.type[0]?e._decodeURLFrame(t):void 0},e._readTimeStamp=function(e){if(8===e.data.byteLength){var t=new Uint8Array(e.data),n=1&t[3],r=(t[4]<<23)+(t[5]<<15)+(t[6]<<7)+t[7];return r/=45,n&&(r+=47721858.84),Math.round(r)}},e._decodePrivFrame=function(t){if(!(t.size<2)){var n=e._utf8ArrayToStr(t.data,!0),r=new Uint8Array(t.data.subarray(n.length+1));return{key:t.type,info:n,data:r.buffer}}},e._decodeTextFrame=function(t){if(!(t.size<2)){if("TXXX"===t.type){var n=1,r=e._utf8ArrayToStr(t.data.subarray(n),!0);n+=r.length+1;var i=e._utf8ArrayToStr(t.data.subarray(n));return{key:t.type,info:r,data:i}}var o=e._utf8ArrayToStr(t.data.subarray(1));return{key:t.type,data:o}}},e._decodeURLFrame=function(t){if("WXXX"===t.type){if(t.size<2)return;var n=1,r=e._utf8ArrayToStr(t.data.subarray(n),!0);n+=r.length+1;var i=e._utf8ArrayToStr(t.data.subarray(n));return{key:t.type,info:r,data:i}}var o=e._utf8ArrayToStr(t.data);return{key:t.type,data:o}},e._utf8ArrayToStr=function(e,t){void 0===t&&(t=!1);var n=a();if(n){var r=n.decode(e);if(t){var i=r.indexOf("\0");return-1!==i?r.substring(0,i):r}return r.replace(/\0/g,"")}for(var o,s,c,u=e.length,l="",d=0;d<u;){if(0===(o=e[d++])&&t)return l;if(0!==o&&3!==o)switch(o>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:l+=String.fromCharCode(o);break;case 12:case 13:s=e[d++],l+=String.fromCharCode((31&o)<<6|63&s);break;case 14:s=e[d++],c=e[d++],l+=String.fromCharCode((15&o)<<12|(63&s)<<6|(63&c)<<0)}}return l},e}();function a(){var e=Object(i.getSelfScope)();return r||void 0===e.TextDecoder||(r=new e.TextDecoder("utf-8")),r}var s=o._utf8ArrayToStr;t.default=o},"./src/demux/mp4demuxer.js":
/*!*********************************!*\
  !*** ./src/demux/mp4demuxer.js ***!
  \*********************************/
/*! exports provided: default */function(e,t,n){"use strict";n.r(t);var r=n(/*! ../utils/logger */"./src/utils/logger.js"),i=n(/*! ../events */"./src/events.js"),o=Math.pow(2,32)-1,a=function(){function e(e,t){this.observer=e,this.remuxer=t}var t=e.prototype;return t.resetTimeStamp=function(e){this.initPTS=e},t.resetInitSegment=function(t,n,r,o){if(t&&t.byteLength){var a=this.initData=e.parseInitSegment(t);null==n&&(n="mp4a.40.5"),null==r&&(r="avc1.42e01e");var s={};a.audio&&a.video?s.audiovideo={container:"video/mp4",codec:n+","+r,initSegment:o?t:null}:(a.audio&&(s.audio={container:"audio/mp4",codec:n,initSegment:o?t:null}),a.video&&(s.video={container:"video/mp4",codec:r,initSegment:o?t:null})),this.observer.trigger(i.default.FRAG_PARSING_INIT_SEGMENT,{tracks:s})}else n&&(this.audioCodec=n),r&&(this.videoCodec=r)},e.probe=function(t){return e.findBox({data:t,start:0,end:Math.min(t.length,16384)},["moof"]).length>0},e.bin2str=function(e){return String.fromCharCode.apply(null,e)},e.readUint16=function(e,t){e.data&&(t+=e.start,e=e.data);var n=e[t]<<8|e[t+1];return n<0?65536+n:n},e.readUint32=function(e,t){e.data&&(t+=e.start,e=e.data);var n=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3];return n<0?4294967296+n:n},e.writeUint32=function(e,t,n){e.data&&(t+=e.start,e=e.data),e[t]=n>>24,e[t+1]=n>>16&255,e[t+2]=n>>8&255,e[t+3]=255&n},e.findBox=function(t,n){var r,i,o,a,s,c,u=[];if(t.data?(s=t.start,o=t.end,t=t.data):(s=0,o=t.byteLength),!n.length)return null;for(r=s;r<o;)c=(i=e.readUint32(t,r))>1?r+i:o,e.bin2str(t.subarray(r+4,r+8))===n[0]&&(1===n.length?u.push({data:t,start:r+8,end:c}):(a=e.findBox({data:t,start:r+8,end:c},n.slice(1))).length&&(u=u.concat(a))),r=c;return u},e.parseSegmentIndex=function(t){var n,r=e.findBox(t,["moov"])[0],i=r?r.end:null,o=0,a=e.findBox(t,["sidx"]);if(!a||!a[0])return null;n=[];var s=(a=a[0]).data[0];o=0===s?8:16;var c=e.readUint32(a,o);o+=4;o+=0===s?8:16,o+=2;var u=a.end+0,l=e.readUint16(a,o);o+=2;for(var d=0;d<l;d++){var h=o,f=e.readUint32(a,h);h+=4;var p=2147483647&f;if(1===(2147483648&f)>>>31)return void console.warn("SIDX has hierarchical references (not supported)");var A=e.readUint32(a,h);h+=4,n.push({referenceSize:p,subsegmentDuration:A,info:{duration:A/c,start:u,end:u+p-1}}),u+=p,o=h+=4}return{earliestPresentationTime:0,timescale:c,version:s,referencesCount:l,references:n,moovEndOffset:i}},e.parseInitSegment=function(t){var n=[];return e.findBox(t,["moov","trak"]).forEach((function(t){var i=e.findBox(t,["tkhd"])[0];if(i){var o=i.data[i.start],a=0===o?12:20,s=e.readUint32(i,a),c=e.findBox(t,["mdia","mdhd"])[0];if(c){a=0===(o=c.data[c.start])?12:20;var u=e.readUint32(c,a),l=e.findBox(t,["mdia","hdlr"])[0];if(l){var d={soun:"audio",vide:"video"}[e.bin2str(l.data.subarray(l.start+8,l.start+12))];if(d){var h=e.findBox(t,["mdia","minf","stbl","stsd"]);if(h.length){h=h[0];var f=e.bin2str(h.data.subarray(h.start+12,h.start+16));r.logger.log("MP4Demuxer:"+d+":"+f+" found")}n[s]={timescale:u,type:d},n[d]={timescale:u,id:s}}}}}})),n},e.getStartDTS=function(t,n){var r,i,o;return r=e.findBox(n,["moof","traf"]),i=[].concat.apply([],r.map((function(n){return e.findBox(n,["tfhd"]).map((function(r){var i,o;return i=e.readUint32(r,4),o=t[i].timescale||9e4,e.findBox(n,["tfdt"]).map((function(t){var n,r;return n=t.data[t.start],r=e.readUint32(t,4),1===n&&(r*=Math.pow(2,32),r+=e.readUint32(t,8)),r}))[0]/o}))}))),o=Math.min.apply(null,i),isFinite(o)?o:0},e.offsetStartDTS=function(t,n,r){e.findBox(n,["moof","traf"]).map((function(n){return e.findBox(n,["tfhd"]).map((function(i){var a=e.readUint32(i,4),s=t[a].timescale||9e4;e.findBox(n,["tfdt"]).map((function(t){var n=t.data[t.start],i=e.readUint32(t,4);if(0===n)e.writeUint32(t,4,i-r*s);else{i*=Math.pow(2,32),i+=e.readUint32(t,8),i-=r*s,i=Math.max(i,0);var a=Math.floor(i/(o+1)),c=Math.floor(i%(o+1));e.writeUint32(t,4,a),e.writeUint32(t,8,c)}}))}))}))},t.append=function(t,n,r,o){var a=this.initData;a||(this.resetInitSegment(t,this.audioCodec,this.videoCodec,!1),a=this.initData);var s,c=this.initPTS;if(void 0===c){var u=e.getStartDTS(a,t);this.initPTS=c=u-n,this.observer.trigger(i.default.INIT_PTS_FOUND,{initPTS:c})}e.offsetStartDTS(a,t,c),s=e.getStartDTS(a,t),this.remuxer.remux(a.audio,a.video,null,null,s,r,o,t)},t.destroy=function(){},e}();t.default=a},"./src/errors.ts":
/*!***********************!*\
  !*** ./src/errors.ts ***!
  \***********************/
/*! exports provided: ErrorTypes, ErrorDetails */function(e,t,n){"use strict";var r,i;n.r(t),n.d(t,"ErrorTypes",(function(){return r})),n.d(t,"ErrorDetails",(function(){return i})),function(e){e.NETWORK_ERROR="networkError",e.MEDIA_ERROR="mediaError",e.KEY_SYSTEM_ERROR="keySystemError",e.MUX_ERROR="muxError",e.OTHER_ERROR="otherError"}(r||(r={})),function(e){e.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",e.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",e.KEY_SYSTEM_NO_SESSION="keySystemNoSession",e.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",e.KEY_SYSTEM_NO_INIT_DATA="keySystemNoInitData",e.MANIFEST_LOAD_ERROR="manifestLoadError",e.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",e.MANIFEST_PARSING_ERROR="manifestParsingError",e.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",e.LEVEL_EMPTY_ERROR="levelEmptyError",e.LEVEL_LOAD_ERROR="levelLoadError",e.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",e.LEVEL_SWITCH_ERROR="levelSwitchError",e.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",e.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",e.FRAG_LOAD_ERROR="fragLoadError",e.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",e.FRAG_DECRYPT_ERROR="fragDecryptError",e.FRAG_PARSING_ERROR="fragParsingError",e.REMUX_ALLOC_ERROR="remuxAllocError",e.KEY_LOAD_ERROR="keyLoadError",e.KEY_LOAD_TIMEOUT="keyLoadTimeOut",e.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",e.BUFFER_APPEND_ERROR="bufferAppendError",e.BUFFER_APPENDING_ERROR="bufferAppendingError",e.BUFFER_STALLED_ERROR="bufferStalledError",e.BUFFER_FULL_ERROR="bufferFullError",e.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",e.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",e.INTERNAL_EXCEPTION="internalException"}(i||(i={}))},"./src/events.js":
/*!***********************!*\
  !*** ./src/events.js ***!
  \***********************/
/*! exports provided: default */function(e,t,n){"use strict";n.r(t);t.default={MEDIA_ATTACHING:"hlsMediaAttaching",MEDIA_ATTACHED:"hlsMediaAttached",MEDIA_DETACHING:"hlsMediaDetaching",MEDIA_DETACHED:"hlsMediaDetached",BUFFER_RESET:"hlsBufferReset",BUFFER_CODECS:"hlsBufferCodecs",BUFFER_CREATED:"hlsBufferCreated",BUFFER_APPENDING:"hlsBufferAppending",BUFFER_APPENDED:"hlsBufferAppended",BUFFER_EOS:"hlsBufferEos",BUFFER_FLUSHING:"hlsBufferFlushing",BUFFER_FLUSHED:"hlsBufferFlushed",MANIFEST_LOADING:"hlsManifestLoading",MANIFEST_LOADED:"hlsManifestLoaded",MANIFEST_PARSED:"hlsManifestParsed",LEVEL_SWITCHING:"hlsLevelSwitching",LEVEL_SWITCHED:"hlsLevelSwitched",LEVEL_LOADING:"hlsLevelLoading",LEVEL_LOADED:"hlsLevelLoaded",LEVEL_UPDATED:"hlsLevelUpdated",LEVEL_PTS_UPDATED:"hlsLevelPtsUpdated",LEVELS_UPDATED:"hlsLevelsUpdated",AUDIO_TRACKS_UPDATED:"hlsAudioTracksUpdated",AUDIO_TRACK_SWITCHING:"hlsAudioTrackSwitching",AUDIO_TRACK_SWITCHED:"hlsAudioTrackSwitched",AUDIO_TRACK_LOADING:"hlsAudioTrackLoading",AUDIO_TRACK_LOADED:"hlsAudioTrackLoaded",SUBTITLE_TRACKS_UPDATED:"hlsSubtitleTracksUpdated",SUBTITLE_TRACK_SWITCH:"hlsSubtitleTrackSwitch",SUBTITLE_TRACK_LOADING:"hlsSubtitleTrackLoading",SUBTITLE_TRACK_LOADED:"hlsSubtitleTrackLoaded",SUBTITLE_FRAG_PROCESSED:"hlsSubtitleFragProcessed",CUES_PARSED:"hlsCuesParsed",NON_NATIVE_TEXT_TRACKS_FOUND:"hlsNonNativeTextTracksFound",INIT_PTS_FOUND:"hlsInitPtsFound",FRAG_LOADING:"hlsFragLoading",FRAG_LOAD_PROGRESS:"hlsFragLoadProgress",FRAG_LOAD_EMERGENCY_ABORTED:"hlsFragLoadEmergencyAborted",FRAG_LOADED:"hlsFragLoaded",FRAG_DECRYPTED:"hlsFragDecrypted",FRAG_PARSING_INIT_SEGMENT:"hlsFragParsingInitSegment",FRAG_PARSING_USERDATA:"hlsFragParsingUserdata",FRAG_PARSING_METADATA:"hlsFragParsingMetadata",FRAG_PARSING_DATA:"hlsFragParsingData",FRAG_PARSED:"hlsFragParsed",FRAG_BUFFERED:"hlsFragBuffered",FRAG_CHANGED:"hlsFragChanged",FPS_DROP:"hlsFpsDrop",FPS_DROP_LEVEL_CAPPING:"hlsFpsDropLevelCapping",ERROR:"hlsError",DESTROYING:"hlsDestroying",KEY_LOADING:"hlsKeyLoading",KEY_LOADED:"hlsKeyLoaded",STREAM_STATE_TRANSITION:"hlsStreamStateTransition",LIVE_BACK_BUFFER_REACHED:"hlsLiveBackBufferReached"}},"./src/hls.ts":
/*!*********************************!*\
  !*** ./src/hls.ts + 50 modules ***!
  \*********************************/
/*! exports provided: default */
/*! ModuleConcatenation bailout: Cannot concat with ./src/crypt/decrypter.js because of ./src/demux/demuxer-worker.js */
/*! ModuleConcatenation bailout: Cannot concat with ./src/demux/demuxer-inline.js because of ./src/demux/demuxer-worker.js */
/*! ModuleConcatenation bailout: Cannot concat with ./src/demux/id3.js because of ./src/demux/demuxer-worker.js */
/*! ModuleConcatenation bailout: Cannot concat with ./src/demux/mp4demuxer.js because of ./src/demux/demuxer-worker.js */
/*! ModuleConcatenation bailout: Cannot concat with ./src/errors.ts because of ./src/demux/demuxer-worker.js */
/*! ModuleConcatenation bailout: Cannot concat with ./src/events.js because of ./src/demux/demuxer-worker.js */
/*! ModuleConcatenation bailout: Cannot concat with ./src/polyfills/number.js because of ./src/demux/demuxer-worker.js */
/*! ModuleConcatenation bailout: Cannot concat with ./src/utils/get-self-scope.js because of ./src/demux/demuxer-worker.js */
/*! ModuleConcatenation bailout: Cannot concat with ./src/utils/logger.js because of ./src/demux/demuxer-worker.js */
/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/eventemitter3/index.js (<- Module is not an ECMAScript module) */
/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/url-toolkit/src/url-toolkit.js (<- Module is not an ECMAScript module) */function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return cn}));var r={};n.r(r),n.d(r,"newCue",(function(){return ft}));var i,o,a=n("./node_modules/url-toolkit/src/url-toolkit.js"),s=n("./src/errors.ts"),c=n("./src/polyfills/number.js"),u=n("./src/events.js"),l=n("./src/utils/logger.js"),d={hlsEventGeneric:!0,hlsHandlerDestroying:!0,hlsHandlerDestroyed:!0},h=function(){function e(e){this.hls=void 0,this.handledEvents=void 0,this.useGenericHandler=void 0,this.hls=e,this.onEvent=this.onEvent.bind(this);for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];this.handledEvents=n,this.useGenericHandler=!0,this.registerListeners()}var t=e.prototype;return t.destroy=function(){this.onHandlerDestroying(),this.unregisterListeners(),this.onHandlerDestroyed()},t.onHandlerDestroying=function(){},t.onHandlerDestroyed=function(){},t.isEventHandler=function(){return"object"==typeof this.handledEvents&&this.handledEvents.length&&"function"==typeof this.onEvent},t.registerListeners=function(){this.isEventHandler()&&this.handledEvents.forEach((function(e){if(d[e])throw new Error("Forbidden event-name: "+e);this.hls.on(e,this.onEvent)}),this)},t.unregisterListeners=function(){this.isEventHandler()&&this.handledEvents.forEach((function(e){this.hls.off(e,this.onEvent)}),this)},t.onEvent=function(e,t){this.onEventGeneric(e,t)},t.onEventGeneric=function(e,t){try{(function(e,t){var n="on"+e.replace("hls","");if("function"!=typeof this[n])throw new Error("Event "+e+" has no generic handler in this "+this.constructor.name+" class (tried "+n+")");return this[n].bind(this,t)}).call(this,e,t).call()}catch(t){l.logger.error("An internal error happened while handling event "+e+'. Error message: "'+t.message+'". Here is a stacktrace:',t),this.hls.trigger(u.default.ERROR,{type:s.ErrorTypes.OTHER_ERROR,details:s.ErrorDetails.INTERNAL_EXCEPTION,fatal:!1,event:e,err:t})}},e}();!function(e){e.MANIFEST="manifest",e.LEVEL="level",e.AUDIO_TRACK="audioTrack",e.SUBTITLE_TRACK="subtitleTrack"}(i||(i={})),function(e){e.MAIN="main",e.AUDIO="audio",e.SUBTITLE="subtitle"}(o||(o={}));var f=n("./src/demux/mp4demuxer.js");function p(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var A,g=function(){function e(e,t){this._uri=null,this.baseuri=void 0,this.reluri=void 0,this.method=null,this.key=null,this.iv=null,this.baseuri=e,this.reluri=t}var t,n,r;return t=e,(n=[{key:"uri",get:function(){return!this._uri&&this.reluri&&(this._uri=Object(a.buildAbsoluteURL)(this.baseuri,this.reluri,{alwaysNormalize:!0})),this._uri}}])&&p(t.prototype,n),r&&p(t,r),e}();function v(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}!function(e){e.AUDIO="audio",e.VIDEO="video"}(A||(A={}));var m=function(){function e(){var e;this._url=null,this._byteRange=null,this._decryptdata=null,this._elementaryStreams=((e={})[A.AUDIO]=!1,e[A.VIDEO]=!1,e),this.deltaPTS=0,this.rawProgramDateTime=null,this.programDateTime=null,this.title=null,this.tagList=[],this.cc=void 0,this.type=void 0,this.relurl=void 0,this.baseurl=void 0,this.duration=void 0,this.start=void 0,this.sn=0,this.urlId=0,this.level=0,this.levelkey=void 0,this.loader=void 0}var t,n,r,i=e.prototype;return i.setByteRange=function(e,t){var n=e.split("@",2),r=[];1===n.length?r[0]=t?t.byteRangeEndOffset:0:r[0]=parseInt(n[1]),r[1]=parseInt(n[0])+r[0],this._byteRange=r},i.addElementaryStream=function(e){this._elementaryStreams[e]=!0},i.hasElementaryStream=function(e){return!0===this._elementaryStreams[e]},i.createInitializationVector=function(e){for(var t=new Uint8Array(16),n=12;n<16;n++)t[n]=e>>8*(15-n)&255;return t},i.setDecryptDataFromLevelKey=function(e,t){var n=e;return(null==e?void 0:e.method)&&e.uri&&!e.iv&&((n=new g(e.baseuri,e.reluri)).method=e.method,n.iv=this.createInitializationVector(t)),n},t=e,(n=[{key:"url",get:function(){return!this._url&&this.relurl&&(this._url=Object(a.buildAbsoluteURL)(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url},set:function(e){this._url=e}},{key:"byteRange",get:function(){return this._byteRange?this._byteRange:[]}},{key:"byteRangeStartOffset",get:function(){return this.byteRange[0]}},{key:"byteRangeEndOffset",get:function(){return this.byteRange[1]}},{key:"decryptdata",get:function(){if(!this.levelkey&&!this._decryptdata)return null;if(!this._decryptdata&&this.levelkey){var e=this.sn;"number"!=typeof e&&(this.levelkey&&"AES-128"===this.levelkey.method&&!this.levelkey.iv&&l.logger.warn('missing IV for initialization segment with method="'+this.levelkey.method+'" - compliance issue'),e=0),this._decryptdata=this.setDecryptDataFromLevelKey(this.levelkey,e)}return this._decryptdata}},{key:"endProgramDateTime",get:function(){if(null===this.programDateTime)return null;if(!Object(c.isFiniteNumber)(this.programDateTime))return null;var e=Object(c.isFiniteNumber)(this.duration)?this.duration:0;return this.programDateTime+1e3*e}},{key:"encrypted",get:function(){return!(!this.decryptdata||null===this.decryptdata.uri||null!==this.decryptdata.key)}}])&&v(t.prototype,n),r&&v(t,r),e}();function y(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var b=function(){function e(e){this.endCC=0,this.endSN=0,this.fragments=[],this.initSegment=null,this.live=!0,this.needSidxRanges=!1,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=e,this.version=null}var t,n,r;return t=e,(n=[{key:"hasProgramDateTime",get:function(){return!(!this.fragments[0]||!Object(c.isFiniteNumber)(this.fragments[0].programDateTime))}}])&&y(t.prototype,n),r&&y(t,r),e}(),E=/^(\d+)x(\d+)$/,_=/\s*(.+?)\s*=((?:\".*?\")|.*?)(?:,|$)/g,w=function(){function e(t){for(var n in"string"==typeof t&&(t=e.parseAttrList(t)),t)t.hasOwnProperty(n)&&(this[n]=t[n])}var t=e.prototype;return t.decimalInteger=function(e){var t=parseInt(this[e],10);return t>Number.MAX_SAFE_INTEGER?1/0:t},t.hexadecimalInteger=function(e){if(this[e]){var t=(this[e]||"0x").slice(2);t=(1&t.length?"0":"")+t;for(var n=new Uint8Array(t.length/2),r=0;r<t.length/2;r++)n[r]=parseInt(t.slice(2*r,2*r+2),16);return n}return null},t.hexadecimalIntegerAsNumber=function(e){var t=parseInt(this[e],16);return t>Number.MAX_SAFE_INTEGER?1/0:t},t.decimalFloatingPoint=function(e){return parseFloat(this[e])},t.enumeratedString=function(e){return this[e]},t.decimalResolution=function(e){var t=E.exec(this[e]);if(null!==t)return{width:parseInt(t[1],10),height:parseInt(t[2],10)}},e.parseAttrList=function(e){var t,n={};for(_.lastIndex=0;null!==(t=_.exec(e));){var r=t[2];0===r.indexOf('"')&&r.lastIndexOf('"')===r.length-1&&(r=r.slice(1,-1)),n[t[1]]=r}return n},e}(),S={audio:{a3ds:!0,"ac-3":!0,"ac-4":!0,alac:!0,alaw:!0,dra1:!0,"dts+":!0,"dts-":!0,dtsc:!0,dtse:!0,dtsh:!0,"ec-3":!0,enca:!0,g719:!0,g726:!0,m4ae:!0,mha1:!0,mha2:!0,mhm1:!0,mhm2:!0,mlpa:!0,mp4a:!0,"raw ":!0,Opus:!0,samr:!0,sawb:!0,sawp:!0,sevc:!0,sqcp:!0,ssmv:!0,twos:!0,ulaw:!0},video:{avc1:!0,avc2:!0,avc3:!0,avc4:!0,avcp:!0,drac:!0,dvav:!0,dvhe:!0,encv:!0,hev1:!0,hvc1:!0,mjp2:!0,mp4v:!0,mvc1:!0,mvc2:!0,mvc3:!0,mvc4:!0,resv:!0,rv60:!0,s263:!0,svc1:!0,svc2:!0,"vc-1":!0,vp08:!0,vp09:!0}};function T(e,t){return MediaSource.isTypeSupported((t||"video")+'/mp4;codecs="'+e+'"')}var R=/(?:#EXT-X-STREAM-INF:([^\n\r]*)[\r\n]+([^\r\n]+)|#EXT-X-SESSION-DATA:([^\n\r]*)[\r\n]+)/g,C=/#EXT-X-MEDIA:(.*)/g,I=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/|(?!#)([\S+ ?]+)/.source,/|#EXT-X-BYTERANGE:*(.+)/.source,/|#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/|#.*/.source].join(""),"g"),x=/(?:(?:#(EXTM3U))|(?:#EXT-X-(PLAYLIST-TYPE):(.+))|(?:#EXT-X-(MEDIA-SEQUENCE): *(\d+))|(?:#EXT-X-(TARGETDURATION): *(\d+))|(?:#EXT-X-(KEY):(.+))|(?:#EXT-X-(START):(.+))|(?:#EXT-X-(ENDLIST))|(?:#EXT-X-(DISCONTINUITY-SEQ)UENCE:(\d+))|(?:#EXT-X-(DIS)CONTINUITY))|(?:#EXT-X-(VERSION):(\d+))|(?:#EXT-X-(MAP):(.+))|(?:(#)([^:]*):(.*))|(?:(#)(.*))(?:.*)\r?\n?/,O=/\.(mp4|m4s|m4v|m4a)$/i,N=function(){function e(){}return e.findGroup=function(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(r.id===t)return r}},e.convertAVC1ToAVCOTI=function(e){var t,n=e.split(".");return n.length>2?(t=n.shift()+".",t+=parseInt(n.shift()).toString(16),t+=("000"+parseInt(n.shift()).toString(16)).substr(-4)):t=e,t},e.resolve=function(e,t){return a.buildAbsoluteURL(t,e,{alwaysNormalize:!0})},e.parseMasterPlaylist=function(t,n){var r,i=[],o={},a=!1;function s(e,t){["video","audio"].forEach((function(n){var r=e.filter((function(e){return function(e,t){var n=S[t];return!!n&&!0===n[e.slice(0,4)]}(e,n)}));if(r.length){var i=r.filter((function(e){return 0===e.lastIndexOf("avc1",0)||0===e.lastIndexOf("mp4a",0)}));t[n+"Codec"]=i.length>0?i[0]:r[0],e=e.filter((function(e){return-1===r.indexOf(e)}))}})),t.unknownCodecs=e}for(R.lastIndex=0;null!=(r=R.exec(t));)if(r[1]){var c={},u=c.attrs=new w(r[1]);c.url=e.resolve(r[2],n);var l=u.decimalResolution("RESOLUTION");l&&(c.width=l.width,c.height=l.height),c.bitrate=u.decimalInteger("AVERAGE-BANDWIDTH")||u.decimalInteger("BANDWIDTH"),c.name=u.NAME,s([].concat((u.CODECS||"").split(/[ ,]+/)),c),c.videoCodec&&-1!==c.videoCodec.indexOf("avc1")&&(c.videoCodec=e.convertAVC1ToAVCOTI(c.videoCodec)),i.push(c)}else if(r[3]){var d=new w(r[3]);d["DATA-ID"]&&(a=!0,o[d["DATA-ID"]]=d)}return{levels:i,sessionData:a?o:null}},e.parseMasterPlaylistMedia=function(t,n,r,i){var o;void 0===i&&(i=[]);var a=[],s=0;for(C.lastIndex=0;null!==(o=C.exec(t));){var c=new w(o[1]);if(c.TYPE===r){var u={attrs:c,id:s++,groupId:c["GROUP-ID"],instreamId:c["INSTREAM-ID"],name:c.NAME||c.LANGUAGE,type:r,default:"YES"===c.DEFAULT,autoselect:"YES"===c.AUTOSELECT,forced:"YES"===c.FORCED,lang:c.LANGUAGE};if(c.URI&&(u.url=e.resolve(c.URI,n)),i.length){var l=e.findGroup(i,u.groupId);u.audioCodec=l?l.codec:i[0].codec}a.push(u)}}return a},e.parseLevelPlaylist=function(e,t,n,r,i){var o,a,s,u=0,d=0,h=new b(t),f=0,p=null,A=new m,v=null;for(I.lastIndex=0;null!==(o=I.exec(e));){var y=o[1];if(y){A.duration=parseFloat(y);var E=(" "+o[2]).slice(1);A.title=E||null,A.tagList.push(E?["INF",y,E]:["INF",y])}else if(o[3]){if(Object(c.isFiniteNumber)(A.duration)){var _=u++;A.type=r,A.start=d,s&&(A.levelkey=s),A.sn=_,A.level=n,A.cc=f,A.urlId=i,A.baseurl=t,A.relurl=(" "+o[3]).slice(1),B(A,p),h.fragments.push(A),p=A,d+=A.duration,A=new m}}else if(o[4]){var S=(" "+o[4]).slice(1);p?A.setByteRange(S,p):A.setByteRange(S)}else if(o[5])A.rawProgramDateTime=(" "+o[5]).slice(1),A.tagList.push(["PROGRAM-DATE-TIME",A.rawProgramDateTime]),null===v&&(v=h.fragments.length);else{if(!(o=o[0].match(x))){l.logger.warn("No matches on slow regex match for level playlist!");continue}for(a=1;a<o.length&&void 0===o[a];a++);var T=(" "+o[a+1]).slice(1),R=(" "+o[a+2]).slice(1);switch(o[a]){case"#":A.tagList.push(R?[T,R]:[T]);break;case"PLAYLIST-TYPE":h.type=T.toUpperCase();break;case"MEDIA-SEQUENCE":u=h.startSN=parseInt(T);break;case"TARGETDURATION":h.targetduration=parseFloat(T);break;case"VERSION":h.version=parseInt(T);break;case"EXTM3U":break;case"ENDLIST":h.live=!1;break;case"DIS":f++,A.tagList.push(["DIS"]);break;case"DISCONTINUITY-SEQ":f=parseInt(T);break;case"KEY":var C=new w(T),N=C.enumeratedString("METHOD"),M=C.URI,L=C.hexadecimalInteger("IV");if("com.apple.streamingkeydelivery"===(C.KEYFORMAT||"identity")){l.logger.warn("Keyformat com.apple.streamingkeydelivery is not supported");continue}N&&(s=new g(t,M),M&&["AES-128","SAMPLE-AES","SAMPLE-AES-CENC"].indexOf(N)>=0&&(s.method=N,s.key=null,s.iv=L));break;case"START":var k=new w(T).decimalFloatingPoint("TIME-OFFSET");Object(c.isFiniteNumber)(k)&&(h.startTimeOffset=k);break;case"MAP":var U=new w(T);A.relurl=U.URI,U.BYTERANGE&&A.setByteRange(U.BYTERANGE),A.baseurl=t,A.level=n,A.type=r,A.sn="initSegment",h.initSegment=A,(A=new m).rawProgramDateTime=h.initSegment.rawProgramDateTime;break;default:l.logger.warn("line parsed but not handled: "+o)}}}return(A=p)&&!A.relurl&&(h.fragments.pop(),d-=A.duration),h.totalduration=d,h.averagetargetduration=d/h.fragments.length,h.endSN=u-1,h.startCC=h.fragments[0]?h.fragments[0].cc:0,h.endCC=f,!h.initSegment&&h.fragments.length&&h.fragments.every((function(e){return O.test(e.relurl)}))&&(l.logger.warn("MP4 fragments found but no init segment (probably no MAP, incomplete M3U8), trying to fetch SIDX"),(A=new m).relurl=h.fragments[0].relurl,A.baseurl=t,A.level=n,A.type=r,A.sn="initSegment",h.initSegment=A,h.needSidxRanges=!0),v&&function(e,t){for(var n=e[t],r=t-1;r>=0;r--){var i=e[r];i.programDateTime=n.programDateTime-1e3*i.duration,n=i}}(h.fragments,v),h},e}();function B(e,t){e.rawProgramDateTime?e.programDateTime=Date.parse(e.rawProgramDateTime):(null==t?void 0:t.programDateTime)&&(e.programDateTime=t.endProgramDateTime),Object(c.isFiniteNumber)(e.programDateTime)||(e.programDateTime=null,e.rawProgramDateTime=null)}var M=window.performance,L=function(e){var t,n;function r(t){var n;return(n=e.call(this,t,u.default.MANIFEST_LOADING,u.default.LEVEL_LOADING,u.default.AUDIO_TRACK_LOADING,u.default.SUBTITLE_TRACK_LOADING)||this).loaders={},n}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,r.canHaveQualityLevels=function(e){return e!==i.AUDIO_TRACK&&e!==i.SUBTITLE_TRACK},r.mapContextToLevelType=function(e){switch(e.type){case i.AUDIO_TRACK:return o.AUDIO;case i.SUBTITLE_TRACK:return o.SUBTITLE;default:return o.MAIN}},r.getResponseUrl=function(e,t){var n=e.url;return void 0!==n&&0!==n.indexOf("data:")||(n=t.url),n};var a=r.prototype;return a.createInternalLoader=function(e){var t=this.hls.config,n=t.pLoader,r=t.loader,i=new(n||r)(t);return e.loader=i,this.loaders[e.type]=i,i},a.getInternalLoader=function(e){return this.loaders[e.type]},a.resetInternalLoader=function(e){this.loaders[e]&&delete this.loaders[e]},a.destroyInternalLoaders=function(){for(var e in this.loaders){var t=this.loaders[e];t&&t.destroy(),this.resetInternalLoader(e)}},a.destroy=function(){this.destroyInternalLoaders(),e.prototype.destroy.call(this)},a.onManifestLoading=function(e){this.load({url:e.url,type:i.MANIFEST,level:0,id:null,responseType:"text"})},a.onLevelLoading=function(e){this.load({url:e.url,type:i.LEVEL,level:e.level,id:e.id,responseType:"text"})},a.onAudioTrackLoading=function(e){this.load({url:e.url,type:i.AUDIO_TRACK,level:null,id:e.id,responseType:"text"})},a.onSubtitleTrackLoading=function(e){this.load({url:e.url,type:i.SUBTITLE_TRACK,level:null,id:e.id,responseType:"text"})},a.load=function(e){var t=this.hls.config;l.logger.debug("Loading playlist of type "+e.type+", level: "+e.level+", id: "+e.id);var n,r,o,a,s=this.getInternalLoader(e);if(s){var c=s.context;if(c&&c.url===e.url)return l.logger.trace("playlist request ongoing"),!1;l.logger.warn("aborting previous loader for type: "+e.type),s.abort()}switch(e.type){case i.MANIFEST:n=t.manifestLoadingMaxRetry,r=t.manifestLoadingTimeOut,o=t.manifestLoadingRetryDelay,a=t.manifestLoadingMaxRetryTimeout;break;case i.LEVEL:n=0,a=0,o=0,r=t.levelLoadingTimeOut;break;default:n=t.levelLoadingMaxRetry,r=t.levelLoadingTimeOut,o=t.levelLoadingRetryDelay,a=t.levelLoadingMaxRetryTimeout}s=this.createInternalLoader(e);var u={timeout:r,maxRetry:n,retryDelay:o,maxRetryDelay:a},d={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)};return l.logger.debug("Calling internal loader delegate for URL: "+e.url),s.load(e,u,d),!0},a.loadsuccess=function(e,t,n,r){if(void 0===r&&(r=null),n.isSidxRequest)return this._handleSidxRequest(e,n),void this._handlePlaylistLoaded(e,t,n,r);if(this.resetInternalLoader(n.type),"string"!=typeof e.data)throw new Error('expected responseType of "text" for PlaylistLoader');var i=e.data;t.tload=M.now(),0===i.indexOf("#EXTM3U")?i.indexOf("#EXTINF:")>0||i.indexOf("#EXT-X-TARGETDURATION:")>0?this._handleTrackOrLevelPlaylist(e,t,n,r):this._handleMasterPlaylist(e,t,n,r):this._handleManifestParsingError(e,n,"no EXTM3U delimiter",r)},a.loaderror=function(e,t,n){void 0===n&&(n=null),this._handleNetworkError(t,n,!1,e)},a.loadtimeout=function(e,t,n){void 0===n&&(n=null),this._handleNetworkError(t,n,!0)},a._handleMasterPlaylist=function(e,t,n,i){var o=this.hls,a=e.data,s=r.getResponseUrl(e,n),c=N.parseMasterPlaylist(a,s),d=c.levels,h=c.sessionData;if(d.length){var f=d.map((function(e){return{id:e.attrs.AUDIO,codec:e.audioCodec}})),p=N.parseMasterPlaylistMedia(a,s,"AUDIO",f),A=N.parseMasterPlaylistMedia(a,s,"SUBTITLES"),g=N.parseMasterPlaylistMedia(a,s,"CLOSED-CAPTIONS");if(p.length){var v=!1;p.forEach((function(e){e.url||(v=!0)})),!1===v&&d[0].audioCodec&&!d[0].attrs.AUDIO&&(l.logger.log("audio codec signaled in quality level, but no embedded audio track signaled, create one"),p.unshift({type:"main",name:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:{},url:""}))}o.trigger(u.default.MANIFEST_LOADED,{levels:d,audioTracks:p,subtitles:A,captions:g,url:s,stats:t,networkDetails:i,sessionData:h})}else this._handleManifestParsingError(e,n,"no level found in manifest",i)},a._handleTrackOrLevelPlaylist=function(e,t,n,o){var a=this.hls,l=n.id,d=n.level,h=n.type,f=r.getResponseUrl(e,n),p=Object(c.isFiniteNumber)(l)?l:0,A=Object(c.isFiniteNumber)(d)?d:p,g=r.mapContextToLevelType(n),v=N.parseLevelPlaylist(e.data,f,A,g,p);if(v.tload=t.tload,v.fragments.length){if(h===i.MANIFEST){var m={url:f,details:v};a.trigger(u.default.MANIFEST_LOADED,{levels:[m],audioTracks:[],url:f,stats:t,networkDetails:o,sessionData:null})}if(t.tparsed=M.now(),v.needSidxRanges){var y=v.initSegment.url;this.load({url:y,isSidxRequest:!0,type:h,level:d,levelDetails:v,id:l,rangeStart:0,rangeEnd:2048,responseType:"arraybuffer"})}else n.levelDetails=v,this._handlePlaylistLoaded(e,t,n,o)}else a.trigger(u.default.ERROR,{type:s.ErrorTypes.NETWORK_ERROR,details:s.ErrorDetails.LEVEL_EMPTY_ERROR,fatal:!1,url:f,reason:"no fragments found in level",level:"number"==typeof n.level?n.level:void 0})},a._handleSidxRequest=function(e,t){if("string"==typeof e.data)throw new Error("sidx request must be made with responseType of array buffer");var n=f.default.parseSegmentIndex(new Uint8Array(e.data));if(n){var r=n.references,i=t.levelDetails;r.forEach((function(e,t){var n=e.info;if(i){var r=i.fragments[t];0===r.byteRange.length&&r.setByteRange(String(1+n.end-n.start)+"@"+String(n.start))}})),i&&i.initSegment.setByteRange(String(n.moovEndOffset)+"@0")}},a._handleManifestParsingError=function(e,t,n,r){this.hls.trigger(u.default.ERROR,{type:s.ErrorTypes.NETWORK_ERROR,details:s.ErrorDetails.MANIFEST_PARSING_ERROR,fatal:!0,url:e.url,reason:n,networkDetails:r})},a._handleNetworkError=function(e,t,n,r){var o,a;void 0===n&&(n=!1),void 0===r&&(r=null),l.logger.info("A network error occured while loading a "+e.type+"-type playlist");var c=this.getInternalLoader(e);switch(e.type){case i.MANIFEST:o=n?s.ErrorDetails.MANIFEST_LOAD_TIMEOUT:s.ErrorDetails.MANIFEST_LOAD_ERROR,a=!0;break;case i.LEVEL:o=n?s.ErrorDetails.LEVEL_LOAD_TIMEOUT:s.ErrorDetails.LEVEL_LOAD_ERROR,a=!1;break;case i.AUDIO_TRACK:o=n?s.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:s.ErrorDetails.AUDIO_TRACK_LOAD_ERROR,a=!1;break;default:a=!1}c&&(c.abort(),this.resetInternalLoader(e.type));var d={type:s.ErrorTypes.NETWORK_ERROR,details:o,fatal:a,url:e.url,loader:c,context:e,networkDetails:t};r&&(d.response=r),this.hls.trigger(u.default.ERROR,d)},a._handlePlaylistLoaded=function(e,t,n,o){var a=n.type,s=n.level,c=n.id,l=n.levelDetails;if(l&&l.targetduration)if(r.canHaveQualityLevels(n.type))this.hls.trigger(u.default.LEVEL_LOADED,{details:l,level:s||0,id:c||0,stats:t,networkDetails:o});else switch(a){case i.AUDIO_TRACK:this.hls.trigger(u.default.AUDIO_TRACK_LOADED,{details:l,id:c,stats:t,networkDetails:o});break;case i.SUBTITLE_TRACK:this.hls.trigger(u.default.SUBTITLE_TRACK_LOADED,{details:l,id:c,stats:t,networkDetails:o})}else this._handleManifestParsingError(e,n,"invalid target duration",o)},r}(h);var k=function(e){var t,n;function r(t){var n;return(n=e.call(this,t,u.default.FRAG_LOADING)||this).loaders={},n}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var i=r.prototype;return i.destroy=function(){var t=this.loaders;for(var n in t){var r=t[n];r&&r.destroy()}this.loaders={},e.prototype.destroy.call(this)},i.onFragLoading=function(e){var t=e.frag,n=t.type,r=this.loaders,i=this.hls.config,o=i.fLoader,a=i.loader;t.loaded=0;var s,u,d,h=r[n];h&&(l.logger.warn("abort previous fragment loader for type: "+n),h.abort()),h=r[n]=t.loader=i.fLoader?new o(i):new a(i),s={url:t.url,frag:t,responseType:"arraybuffer",progressData:!1};var f=t.byteRangeStartOffset,p=t.byteRangeEndOffset;Object(c.isFiniteNumber)(f)&&Object(c.isFiniteNumber)(p)&&(s.rangeStart=f,s.rangeEnd=p),u={timeout:i.fragLoadingTimeOut,maxRetry:0,retryDelay:0,maxRetryDelay:i.fragLoadingMaxRetryTimeout},d={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this),onProgress:this.loadprogress.bind(this)},h.load(s,u,d)},i.loadsuccess=function(e,t,n,r){void 0===r&&(r=null);var i=e.data,o=n.frag;o.loader=void 0,this.loaders[o.type]=void 0,this.hls.trigger(u.default.FRAG_LOADED,{payload:i,frag:o,stats:t,networkDetails:r})},i.loaderror=function(e,t,n){void 0===n&&(n=null);var r=t.frag,i=r.loader;i&&i.abort(),this.loaders[r.type]=void 0,this.hls.trigger(u.default.ERROR,{type:s.ErrorTypes.NETWORK_ERROR,details:s.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:t.frag,response:e,networkDetails:n})},i.loadtimeout=function(e,t,n){void 0===n&&(n=null);var r=t.frag,i=r.loader;i&&i.abort(),this.loaders[r.type]=void 0,this.hls.trigger(u.default.ERROR,{type:s.ErrorTypes.NETWORK_ERROR,details:s.ErrorDetails.FRAG_LOAD_TIMEOUT,fatal:!1,frag:t.frag,networkDetails:n})},i.loadprogress=function(e,t,n,r){void 0===r&&(r=null);var i=t.frag;i.loaded=e.loaded,this.hls.trigger(u.default.FRAG_LOAD_PROGRESS,{frag:i,stats:e,networkDetails:r})},r}(h);var U=function(e){var t,n;function r(t){var n;return(n=e.call(this,t,u.default.KEY_LOADING)||this).loaders={},n.decryptkey=null,n.decrypturl=null,n}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var i=r.prototype;return i.destroy=function(){for(var t in this.loaders){var n=this.loaders[t];n&&n.destroy()}this.loaders={},e.prototype.destroy.call(this)},i.onKeyLoading=function(e){var t=e.frag,n=t.type,r=this.loaders[n];if(t.decryptdata){var i=t.decryptdata.uri;if(i!==this.decrypturl||null===this.decryptkey){var o=this.hls.config;if(r&&(l.logger.warn("abort previous key loader for type:"+n),r.abort()),!i)return void l.logger.warn("key uri is falsy");t.loader=this.loaders[n]=new o.loader(o),this.decrypturl=i,this.decryptkey=null;var a={url:i,frag:t,responseType:"arraybuffer"},s={timeout:o.fragLoadingTimeOut,maxRetry:0,retryDelay:o.fragLoadingRetryDelay,maxRetryDelay:o.fragLoadingMaxRetryTimeout},c={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)};t.loader.load(a,s,c)}else this.decryptkey&&(t.decryptdata.key=this.decryptkey,this.hls.trigger(u.default.KEY_LOADED,{frag:t}))}else l.logger.warn("Missing decryption data on fragment in onKeyLoading")},i.loadsuccess=function(e,t,n){var r=n.frag;r.decryptdata?(this.decryptkey=r.decryptdata.key=new Uint8Array(e.data),r.loader=void 0,delete this.loaders[r.type],this.hls.trigger(u.default.KEY_LOADED,{frag:r})):l.logger.error("after key load, decryptdata unset")},i.loaderror=function(e,t){var n=t.frag,r=n.loader;r&&r.abort(),delete this.loaders[n.type],this.hls.trigger(u.default.ERROR,{type:s.ErrorTypes.NETWORK_ERROR,details:s.ErrorDetails.KEY_LOAD_ERROR,fatal:!1,frag:n,response:e})},i.loadtimeout=function(e,t){var n=t.frag,r=n.loader;r&&r.abort(),delete this.loaders[n.type],this.hls.trigger(u.default.ERROR,{type:s.ErrorTypes.NETWORK_ERROR,details:s.ErrorDetails.KEY_LOAD_TIMEOUT,fatal:!1,frag:n})},r}(h);var D="NOT_LOADED",P="APPENDING",F="PARTIAL",H="OK",j=function(e){var t,n;function r(t){var n;return(n=e.call(this,t,u.default.BUFFER_APPENDED,u.default.FRAG_BUFFERED,u.default.FRAG_LOADED)||this).bufferPadding=.2,n.fragments=Object.create(null),n.timeRanges=Object.create(null),n.config=t.config,n}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var i=r.prototype;return i.destroy=function(){this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.config=null,h.prototype.destroy.call(this),e.prototype.destroy.call(this)},i.getBufferedFrag=function(e,t){var n=this.fragments,r=Object.keys(n).filter((function(r){var i=n[r];if(i.body.type!==t)return!1;if(!i.buffered)return!1;var o=i.body;return o.startPTS<=e&&e<=o.endPTS}));if(0===r.length)return null;var i=r.pop();return n[i].body},i.detectEvictedFragments=function(e,t){var n=this;Object.keys(this.fragments).forEach((function(r){var i=n.fragments[r];if(i&&i.buffered){var o=i.range[e];if(o)for(var a=o.time,s=0;s<a.length;s++){var c=a[s];if(!n.isTimeBuffered(c.startPTS,c.endPTS,t)){n.removeFragment(i.body);break}}}}))},i.detectPartialFragments=function(e){var t=this,n=this.getFragmentKey(e),r=this.fragments[n];r&&(r.buffered=!0,Object.keys(this.timeRanges).forEach((function(n){if(e.hasElementaryStream(n)){var i=t.timeRanges[n];r.range[n]=t.getBufferedTimes(e.startPTS,e.endPTS,i)}})))},i.getBufferedTimes=function(e,t,n){for(var r,i,o=[],a=!1,s=0;s<n.length;s++){if(r=n.start(s)-this.bufferPadding,i=n.end(s)+this.bufferPadding,e>=r&&t<=i){o.push({startPTS:Math.max(e,n.start(s)),endPTS:Math.min(t,n.end(s))});break}if(e<i&&t>r)o.push({startPTS:Math.max(e,n.start(s)),endPTS:Math.min(t,n.end(s))}),a=!0;else if(t<=r)break}return{time:o,partial:a}},i.getFragmentKey=function(e){return e.type+"_"+e.level+"_"+e.urlId+"_"+e.sn},i.getPartialFragment=function(e){var t,n,r,i=this,o=null,a=0;return Object.keys(this.fragments).forEach((function(s){var c=i.fragments[s];i.isPartial(c)&&(n=c.body.startPTS-i.bufferPadding,r=c.body.endPTS+i.bufferPadding,e>=n&&e<=r&&(t=Math.min(e-n,r-e),a<=t&&(o=c.body,a=t)))})),o},i.getState=function(e){var t=this.getFragmentKey(e),n=this.fragments[t],r=D;return void 0!==n&&(r=n.buffered?!0===this.isPartial(n)?F:H:P),r},i.isPartial=function(e){return!0===e.buffered&&(void 0!==e.range.video&&!0===e.range.video.partial||void 0!==e.range.audio&&!0===e.range.audio.partial)},i.isTimeBuffered=function(e,t,n){for(var r,i,o=0;o<n.length;o++){if(r=n.start(o)-this.bufferPadding,i=n.end(o)+this.bufferPadding,e>=r&&t<=i)return!0;if(t<=r)return!1}return!1},i.onFragLoaded=function(e){var t=e.frag;Object(c.isFiniteNumber)(t.sn)&&!t.bitrateTest&&(this.fragments[this.getFragmentKey(t)]={body:t,range:Object.create(null),buffered:!1})},i.onBufferAppended=function(e){var t=this;this.timeRanges=e.timeRanges,Object.keys(this.timeRanges).forEach((function(e){var n=t.timeRanges[e];t.detectEvictedFragments(e,n)}))},i.onFragBuffered=function(e){this.detectPartialFragments(e.frag)},i.hasFragment=function(e){var t=this.getFragmentKey(e);return void 0!==this.fragments[t]},i.removeFragment=function(e){var t=this.getFragmentKey(e);delete this.fragments[t]},i.removeAllFragments=function(){this.fragments=Object.create(null)},r}(h),V={search:function(e,t){for(var n=0,r=e.length-1,i=null,o=null;n<=r;){var a=t(o=e[i=(n+r)/2|0]);if(a>0)n=i+1;else{if(!(a<0))return o;r=i-1}}return null}},Q=function(){function e(){}return e.isBuffered=function(e,t){try{if(e)for(var n=e.buffered,r=0;r<n.length;r++)if(t>=n.start(r)&&t<=n.end(r))return!0}catch(e){}return!1},e.bufferInfo=function(e,t,n){try{if(e){var r,i=e.buffered,o=[];for(r=0;r<i.length;r++)o.push({start:i.start(r),end:i.end(r)});return this.bufferedInfo(o,t,n)}}catch(e){}return{len:0,start:t,end:t,nextStart:void 0}},e.bufferedInfo=function(e,t,n){e.sort((function(e,t){var n=e.start-t.start;return n||t.end-e.end}));var r=[];if(n)for(var i=0;i<e.length;i++){var o=r.length;if(o){var a=r[o-1].end;e[i].start-a<n?e[i].end>a&&(r[o-1].end=e[i].end):r.push(e[i])}else r.push(e[i])}else r=e;for(var s,c=0,u=t,l=t,d=0;d<r.length;d++){var h=r[d].start,f=r[d].end;if(t+n>=h&&t<f)u=h,c=(l=f)-t;else if(t+n<h){s=h;break}}return{len:c,start:u,end:l,nextStart:s}},e}(),G=n("./node_modules/eventemitter3/index.js"),z=n("./node_modules/webworkify-webpack/index.js"),K=n("./src/demux/demuxer-inline.js");function q(){return window.MediaSource||window.WebKitMediaSource}var W=n("./src/utils/get-self-scope.js");var X=function(e){var t,n;function r(){return e.apply(this,arguments)||this}return n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,r.prototype.trigger=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];this.emit.apply(this,[e,e].concat(n))},r}(G.EventEmitter),J=Object(W.getSelfScope)(),Y=q()||{isTypeSupported:function(){return!1}},Z=function(){function e(e,t){var n=this;this.hls=e,this.id=t;var r=this.observer=new X,i=e.config,o=function(t,r){(r=r||{}).frag=n.frag,r.id=n.id,e.trigger(t,r)};r.on(u.default.FRAG_DECRYPTED,o),r.on(u.default.FRAG_PARSING_INIT_SEGMENT,o),r.on(u.default.FRAG_PARSING_DATA,o),r.on(u.default.FRAG_PARSED,o),r.on(u.default.ERROR,o),r.on(u.default.FRAG_PARSING_METADATA,o),r.on(u.default.FRAG_PARSING_USERDATA,o),r.on(u.default.INIT_PTS_FOUND,o);var a={mp4:Y.isTypeSupported("video/mp4"),mpeg:Y.isTypeSupported("audio/mpeg"),mp3:Y.isTypeSupported('audio/mp4; codecs="mp3"')},c=navigator.vendor;if(i.enableWorker&&"undefined"!=typeof Worker){var d;l.logger.log("demuxing in webworker");try{d=this.w=z(/*! ../demux/demuxer-worker.js */"./src/demux/demuxer-worker.js"),this.onwmsg=this.onWorkerMessage.bind(this),d.addEventListener("message",this.onwmsg),d.onerror=function(t){e.trigger(u.default.ERROR,{type:s.ErrorTypes.OTHER_ERROR,details:s.ErrorDetails.INTERNAL_EXCEPTION,fatal:!0,event:"demuxerWorker",err:{message:t.message+" ("+t.filename+":"+t.lineno+")"}})},d.postMessage({cmd:"init",typeSupported:a,vendor:c,id:t,config:JSON.stringify(i)})}catch(e){l.logger.warn("Error in worker:",e),l.logger.error("Error while initializing DemuxerWorker, fallback on DemuxerInline"),d&&J.URL.revokeObjectURL(d.objectURL),this.demuxer=new K.default(r,a,i,c),this.w=void 0}}else this.demuxer=new K.default(r,a,i,c)}var t=e.prototype;return t.destroy=function(){var e=this.w;if(e)e.removeEventListener("message",this.onwmsg),e.terminate(),this.w=null;else{var t=this.demuxer;t&&(t.destroy(),this.demuxer=null)}var n=this.observer;n&&(n.removeAllListeners(),this.observer=null)},t.push=function(e,t,n,r,i,o,a,s){var u=this.w,d=Object(c.isFiniteNumber)(i.startPTS)?i.startPTS:i.start,h=i.decryptdata,f=this.frag,p=!(f&&i.cc===f.cc),A=!(f&&i.level===f.level),g=f&&i.sn===f.sn+1,v=!A&&g;if(p&&l.logger.log(this.id+":discontinuity detected"),A&&l.logger.log(this.id+":switch detected"),this.frag=i,u)u.postMessage({cmd:"demux",data:e,decryptdata:h,initSegment:t,audioCodec:n,videoCodec:r,timeOffset:d,discontinuity:p,trackSwitch:A,contiguous:v,duration:o,accurateTimeOffset:a,defaultInitPTS:s},e instanceof ArrayBuffer?[e]:[]);else{var m=this.demuxer;m&&m.push(e,h,t,n,r,d,p,A,v,o,a,s)}},t.onWorkerMessage=function(e){var t=e.data,n=this.hls;switch(t.event){case"init":J.URL.revokeObjectURL(this.w.objectURL);break;case u.default.FRAG_PARSING_DATA:t.data.data1=new Uint8Array(t.data1),t.data2&&(t.data.data2=new Uint8Array(t.data2));default:t.data=t.data||{},t.data.frag=this.frag,t.data.id=this.id,n.trigger(t.event,t.data)}},e}();function $(e,t,n){switch(t){case"audio":e.audioGroupIds||(e.audioGroupIds=[]),e.audioGroupIds.push(n);break;case"text":e.textGroupIds||(e.textGroupIds=[]),e.textGroupIds.push(n)}}function ee(e,t,n){var r=e[t],i=e[n],o=i.startPTS;if(Object(c.isFiniteNumber)(o))n>t?(r.duration=o-r.start,r.duration<0&&l.logger.warn("negative duration computed for frag "+r.sn+",level "+r.level+", there should be some duration drift between playlist and fragment!")):(i.duration=r.start-o,i.duration<0&&l.logger.warn("negative duration computed for frag "+i.sn+",level "+i.level+", there should be some duration drift between playlist and fragment!"));else if(n>t){var a=r.cc===i.cc;i.start=r.start+(a&&r.minEndPTS?r.minEndPTS-r.start:r.duration)}else i.start=Math.max(r.start-i.duration,0)}function te(e,t,n,r,i,o){var a=n,s=r;if(Object(c.isFiniteNumber)(t.startPTS)){var u=Math.abs(t.startPTS-n);Object(c.isFiniteNumber)(t.deltaPTS)?t.deltaPTS=Math.max(u,t.deltaPTS):t.deltaPTS=u,a=Math.max(n,t.startPTS),n=Math.min(n,t.startPTS),s=Math.min(r,t.endPTS),r=Math.max(r,t.endPTS),i=Math.min(i,t.startDTS),o=Math.max(o,t.endDTS)}var l=n-t.start;t.start=t.startPTS=n,t.maxStartPTS=a,t.endPTS=r,t.minEndPTS=s,t.startDTS=i,t.endDTS=o,t.duration=r-n;var d,h,f,p=t.sn;if(!e||p<e.startSN||p>e.endSN)return 0;for(d=p-e.startSN,(h=e.fragments)[d]=t,f=d;f>0;f--)ee(h,f,f-1);for(f=d;f<h.length-1;f++)ee(h,f,f+1);return e.PTSKnown=!0,l}function ne(e,t){t.initSegment&&e.initSegment&&(t.initSegment=e.initSegment);var n,r=0;if(re(e,t,(function(e,i){r=e.cc-i.cc,Object(c.isFiniteNumber)(e.startPTS)&&(i.start=i.startPTS=e.startPTS,i.endPTS=e.endPTS,i.duration=e.duration,i.backtracked=e.backtracked,i.dropped=e.dropped,n=i),t.PTSKnown=!0})),t.PTSKnown){if(r){l.logger.log("discontinuity sliding from playlist, take drift into account");for(var i=t.fragments,o=0;o<i.length;o++)i[o].cc+=r}n?te(t,n,n.startPTS,n.endPTS,n.startDTS,n.endDTS):function(e,t){var n=t.startSN-e.startSN,r=e.fragments,i=t.fragments;if(n<0||n>r.length)return;for(var o=0;o<i.length;o++)i[o].start+=r[n].start}(e,t),t.PTSKnown=e.PTSKnown}}function re(e,t,n){if(e&&t)for(var r=Math.max(e.startSN,t.startSN)-t.startSN,i=Math.min(e.endSN,t.endSN)-t.startSN,o=t.startSN-e.startSN,a=r;a<=i;a++){var s=e.fragments[o+a],c=t.fragments[a];if(!s||!c)break;n(s,c,a)}}function ie(e,t,n){var r=1e3*(t.averagetargetduration?t.averagetargetduration:t.targetduration),i=r/2;return e&&t.endSN===e.endSN&&(r=i),n&&(r=Math.max(i,r-(window.performance.now()-n))),Math.round(r)}var oe={toString:function(e){for(var t="",n=e.length,r=0;r<n;r++)t+="["+e.start(r).toFixed(3)+","+e.end(r).toFixed(3)+"]";return t}};function ae(e,t){t.fragments.forEach((function(t){if(t){var n=t.start+e;t.start=t.startPTS=n,t.endPTS=n+t.duration}})),t.PTSKnown=!0}function se(e,t,n){!function(e,t,n){if(function(e,t,n){var r=!1;return t&&t.details&&n&&(n.endCC>n.startCC||e&&e.cc<n.startCC)&&(r=!0),r}(e,n,t)){var r=function(e,t){var n=e.fragments,r=t.fragments;if(r.length&&n.length){var i=function(e,t){for(var n=null,r=0;r<e.length;r+=1){var i=e[r];if(i&&i.cc===t){n=i;break}}return n}(n,r[0].cc);if(i&&(!i||i.startPTS))return i;l.logger.log("No frag in previous level to align on")}else l.logger.log("No fragments to align")}(n.details,t);r&&(l.logger.log("Adjusting PTS using last level due to CC increase within current level"),ae(r.start,t))}}(e,n,t),!n.PTSKnown&&t&&function(e,t){if(t&&t.fragments.length){if(!e.hasProgramDateTime||!t.hasProgramDateTime)return;var n=t.fragments[0].programDateTime,r=(e.fragments[0].programDateTime-n)/1e3+t.fragments[0].start;Object(c.isFiniteNumber)(r)&&(l.logger.log("adjusting PTS using programDateTime delta, sliding:"+r.toFixed(3)),ae(r,e))}}(n,t.details)}function ce(e,t,n){if(null===t||!Array.isArray(e)||!e.length||!Object(c.isFiniteNumber)(t))return null;if(t<(e[0].programDateTime||0))return null;if(t>=(e[e.length-1].endProgramDateTime||0))return null;n=n||0;for(var r=0;r<e.length;++r){var i=e[r];if(de(t,n,i))return i}return null}function ue(e,t,n,r){void 0===n&&(n=0),void 0===r&&(r=0);var i=null;if(e?i=t[e.sn-t[0].sn+1]:0===n&&0===t[0].start&&(i=t[0]),i&&0===le(n,r,i))return i;var o=V.search(t,le.bind(null,n,r));return o||i}function le(e,t,n){void 0===e&&(e=0),void 0===t&&(t=0);var r=Math.min(t,n.duration+(n.deltaPTS?n.deltaPTS:0));return n.start+n.duration-r<=e?1:n.start-r>e&&n.start?-1:0}function de(e,t,n){var r=1e3*Math.min(t,n.duration+(n.deltaPTS?n.deltaPTS:0));return(n.endProgramDateTime||0)-r>e}var he=function(){function e(e,t,n,r){this.config=e,this.media=t,this.fragmentTracker=n,this.hls=r,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1}var t=e.prototype;return t.poll=function(e){var t=this.config,n=this.media,r=this.stalled,i=n.currentTime,o=n.seeking,a=this.seeking&&!o,s=!this.seeking&&o;if(this.seeking=o,i===e){if((s||a)&&(this.stalled=null),!n.paused&&!n.ended&&0!==n.playbackRate&&n.buffered.length){var c=Q.bufferInfo(n,i,0),u=c.len>0,d=c.nextStart||0;if(u||d){if(o){var h=c.len>2,f=!d||d-i>2&&!this.fragmentTracker.getPartialFragment(i);if(h||f)return;this.moved=!1}if(!this.moved&&this.stalled){var p=Math.max(d,c.start||0)-i;if(p>0&&p<=2)return void this._trySkipBufferHole(null)}var A=self.performance.now();if(null!==r){var g=A-r;!o&&g>=250&&this._reportStall(c.len);var v=Q.bufferInfo(n,i,t.maxBufferHole);this._tryFixBufferStall(v,g)}else this.stalled=A}}}else if(this.moved=!0,null!==r){if(this.stallReported){var m=self.performance.now()-r;l.logger.warn("playback not stuck anymore @"+i+", after "+Math.round(m)+"ms"),this.stallReported=!1}this.stalled=null,this.nudgeRetry=0}},t._tryFixBufferStall=function(e,t){var n=this.config,r=this.fragmentTracker,i=this.media.currentTime,o=r.getPartialFragment(i);if(o&&this._trySkipBufferHole(o))return;e.len>n.maxBufferHole&&t>1e3*n.highBufferWatchdogPeriod&&(l.logger.warn("Trying to nudge playhead over buffer-hole"),this.stalled=null,this._tryNudgeBuffer())},t._reportStall=function(e){var t=this.hls,n=this.media;this.stallReported||(this.stallReported=!0,l.logger.warn("Playback stalling at @"+n.currentTime+" due to low buffer (buffer="+e+")"),t.trigger(u.default.ERROR,{type:s.ErrorTypes.MEDIA_ERROR,details:s.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!1,buffer:e}))},t._trySkipBufferHole=function(e){for(var t=this.config,n=this.hls,r=this.media,i=r.currentTime,o=0,a=0;a<r.buffered.length;a++){var c=r.buffered.start(a);if(i+t.maxBufferHole>=o&&i<c){var d=Math.max(c+.05,r.currentTime+.1);return l.logger.warn("skipping hole, adjusting currentTime from "+i+" to "+d),this.moved=!0,this.stalled=null,r.currentTime=d,e&&n.trigger(u.default.ERROR,{type:s.ErrorTypes.MEDIA_ERROR,details:s.ErrorDetails.BUFFER_SEEK_OVER_HOLE,fatal:!1,reason:"fragment loaded with buffer holes, seeking from "+i+" to "+d,frag:e}),d}o=r.buffered.end(a)}return 0},t._tryNudgeBuffer=function(){var e=this.config,t=this.hls,n=this.media,r=n.currentTime,i=(this.nudgeRetry||0)+1;if(this.nudgeRetry=i,i<e.nudgeMaxRetry){var o=r+i*e.nudgeOffset;l.logger.warn("Nudging 'currentTime' from "+r+" to "+o),n.currentTime=o,t.trigger(u.default.ERROR,{type:s.ErrorTypes.MEDIA_ERROR,details:s.ErrorDetails.BUFFER_NUDGE_ON_STALL,fatal:!1})}else l.logger.error("Playhead still not moving while enough data buffered @"+r+" after "+e.nudgeMaxRetry+" nudges"),t.trigger(u.default.ERROR,{type:s.ErrorTypes.MEDIA_ERROR,details:s.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!0})},e}();function fe(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var pe=function(e){var t,n;function r(t){for(var n,r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];return(n=e.call.apply(e,[this,t].concat(i))||this)._boundTick=void 0,n._tickTimer=null,n._tickInterval=null,n._tickCallCount=0,n._boundTick=n.tick.bind(fe(n)),n}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var i=r.prototype;return i.onHandlerDestroying=function(){this.clearNextTick(),this.clearInterval()},i.hasInterval=function(){return!!this._tickInterval},i.hasNextTick=function(){return!!this._tickTimer},i.setInterval=function(e){return!this._tickInterval&&(this._tickInterval=self.setInterval(this._boundTick,e),!0)},i.clearInterval=function(){return!!this._tickInterval&&(self.clearInterval(this._tickInterval),this._tickInterval=null,!0)},i.clearNextTick=function(){return!!this._tickTimer&&(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0)},i.tick=function(){this._tickCallCount++,1===this._tickCallCount&&(this.doTick(),this._tickCallCount>1&&(this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)),this._tickCallCount=0)},i.doTick=function(){},r}(h);var Ae="STOPPED",ge="STARTING",ve="IDLE",me="PAUSED",ye="KEY_LOADING",be="FRAG_LOADING",Ee="FRAG_LOADING_WAITING_RETRY",_e="WAITING_TRACK",we="PARSING",Se="PARSED",Te="BUFFER_FLUSHING",Re="ENDED",Ce="ERROR",Ie="WAITING_INIT_PTS",xe="WAITING_LEVEL",Oe=function(e){var t,n;function r(){return e.apply(this,arguments)||this}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var i=r.prototype;return i.doTick=function(){},i.startLoad=function(){},i.stopLoad=function(){var e=this.fragCurrent;e&&(e.loader&&e.loader.abort(),this.fragmentTracker.removeFragment(e)),this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=Ae},i._streamEnded=function(e,t){var n=this.fragCurrent,r=this.fragmentTracker;if(!t.live&&n&&!n.backtracked&&n.sn===t.endSN&&!e.nextStart){var i=r.getState(n);return i===F||i===H}return!1},i.onMediaSeeking=function(){var e=this.config,t=this.media,n=this.mediaBuffer,r=this.state,i=t?t.currentTime:null,o=Q.bufferInfo(n||t,i,this.config.maxBufferHole);if(l.logger.log("media seeking to "+(Object(c.isFiniteNumber)(i)?i.toFixed(3):i)),r===be){var a=this.fragCurrent;if(0===o.len&&a){var s=e.maxFragLookUpTolerance,u=a.start-s,d=a.start+a.duration+s;i<u||i>d?(a.loader&&(l.logger.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),a.loader.abort()),this.fragCurrent=null,this.fragPrevious=null,this.state=ve):l.logger.log("seeking outside of buffer but within currently loaded fragment range")}}else r===Re&&(0===o.len&&(this.fragPrevious=null,this.fragCurrent=null),this.state=ve);t&&(this.lastCurrentTime=i),this.loadedmetadata||(this.nextLoadPosition=this.startPosition=i),this.tick()},i.onMediaEnded=function(){this.startPosition=this.lastCurrentTime=0},i.onHandlerDestroying=function(){this.stopLoad(),e.prototype.onHandlerDestroying.call(this)},i.onHandlerDestroyed=function(){this.state=Ae,this.fragmentTracker=null},i.computeLivePosition=function(e,t){var n=void 0!==this.config.liveSyncDuration?this.config.liveSyncDuration:this.config.liveSyncDurationCount*t.targetduration;return e+Math.max(0,t.totalduration-n)},r}(pe);function Ne(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Be,Me=function(e){var t,n;function r(t,n){var r;return(r=e.call(this,t,u.default.MEDIA_ATTACHED,u.default.MEDIA_DETACHING,u.default.MANIFEST_LOADING,u.default.MANIFEST_PARSED,u.default.LEVEL_LOADED,u.default.LEVELS_UPDATED,u.default.KEY_LOADED,u.default.FRAG_LOADED,u.default.FRAG_LOAD_EMERGENCY_ABORTED,u.default.FRAG_PARSING_INIT_SEGMENT,u.default.FRAG_PARSING_DATA,u.default.FRAG_PARSED,u.default.ERROR,u.default.AUDIO_TRACK_SWITCHING,u.default.AUDIO_TRACK_SWITCHED,u.default.BUFFER_CREATED,u.default.BUFFER_APPENDED,u.default.BUFFER_FLUSHED)||this).fragmentTracker=n,r.config=t.config,r.audioCodecSwap=!1,r._state=Ae,r.stallReported=!1,r.gapController=null,r.altAudio=!1,r.audioOnly=!1,r.bitrateTest=!1,r}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var i,a,d,h=r.prototype;return h.startLoad=function(e){if(this.levels){var t=this.lastCurrentTime,n=this.hls;if(this.stopLoad(),this.setInterval(100),this.level=-1,this.fragLoadError=0,!this.startFragRequested){var r=n.startLevel;-1===r&&(n.config.testBandwidth?(r=0,this.bitrateTest=!0):r=n.nextAutoLevel),this.level=n.nextLoadLevel=r,this.loadedmetadata=!1}t>0&&-1===e&&(l.logger.log("override startPosition with lastCurrentTime @"+t.toFixed(3)),e=t),this.state=ve,this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}else this.forceStartLoad=!0,this.state=Ae},h.stopLoad=function(){this.forceStartLoad=!1,e.prototype.stopLoad.call(this)},h.doTick=function(){switch(this.state){case Te:this.fragLoadError=0;break;case ve:this._doTickIdle();break;case xe:var e=this.levels[this.level];e&&e.details&&(this.state=ve);break;case Ee:var t=window.performance.now(),n=this.retryDate;(!n||t>=n||this.media&&this.media.seeking)&&(l.logger.log("mediaController: retryDate reached, switch back to IDLE state"),this.state=ve)}this._checkBuffer(),this._checkFragmentChanged()},h._doTickIdle=function(){var e=this.hls,t=e.config,n=this.media;if(void 0!==this.levelLastLoaded&&(n||!this.startFragRequested&&t.startFragPrefetch))if(this.altAudio&&this.audioOnly)this.demuxer.frag=null;else{var r;r=this.loadedmetadata?n.currentTime:this.nextLoadPosition;var i=e.nextLoadLevel,o=this.levels[i];if(o){var a,s=o.bitrate;a=s?Math.max(8*t.maxBufferSize/s,t.maxBufferLength):t.maxBufferLength,a=Math.min(a,t.maxMaxBufferLength);var c=r<t.maxBufferHole?Math.max(2,t.maxBufferHole):t.maxBufferHole,d=Q.bufferInfo(this.mediaBuffer?this.mediaBuffer:n,r,c),h=d.len;if(!(h>=a)){l.logger.trace("buffer length of "+h.toFixed(3)+" is below max of "+a.toFixed(3)+". checking for more payload ..."),this.level=e.nextLoadLevel=i;var f=o.details;if(!f||f.live&&this.levelLastLoaded!==i)this.state=xe;else{if(this._streamEnded(d,f)){var p={};return this.altAudio&&(p.type="video"),this.hls.trigger(u.default.BUFFER_EOS,p),void(this.state=Re)}this._fetchPayloadOrEos(r,d,f)}}}}},h._fetchPayloadOrEos=function(e,t,n){var r=this.fragPrevious,i=(this.level,n.fragments),o=i.length;if(0!==o){var a,s=i[0].start,c=i[o-1].start+i[o-1].duration,u=t.end;if(n.initSegment&&!n.initSegment.data)a=n.initSegment;else if(n.live){var d=this.config.initialLiveManifestSize;if(o<d)return void l.logger.warn("Can not start playback of a level, reason: not enough fragments "+o+" < "+d);if(null===(a=this._ensureFragmentAtLivePoint(n,u,s,c,r,i)))return}else u<s&&(a=i[0]);a||(a=this._findFragment(s,r,o,i,u,c,n)),a&&(a.encrypted?this._loadKey(a,n):this._loadFragment(a,n,e,u))}},h._ensureFragmentAtLivePoint=function(e,t,n,r,i,o){var a,s=this.hls.config,u=this.media,d=1/0;if(void 0!==s.liveMaxLatencyDuration?d=s.liveMaxLatencyDuration:Object(c.isFiniteNumber)(s.liveMaxLatencyDurationCount)&&(d=s.liveMaxLatencyDurationCount*e.targetduration),t<Math.max(n-s.maxFragLookUpTolerance,r-d)){var h=this.liveSyncPosition=this.computeLivePosition(n,e);t=h,u&&!u.paused&&u.readyState&&u.duration>h&&h>u.currentTime&&(l.logger.log("buffer end: "+t.toFixed(3)+" is located too far from the end of live sliding playlist, reset currentTime to : "+h.toFixed(3)),u.currentTime=h),this.nextLoadPosition=h}if(e.PTSKnown&&t>r&&u&&u.readyState)return null;if(this.startFragRequested&&!e.PTSKnown&&i)if(e.hasProgramDateTime)l.logger.log("live playlist, switching playlist, load frag with same PDT: "+i.programDateTime),a=ce(o,i.endProgramDateTime,s.maxFragLookUpTolerance);else{var f=i.sn+1;if(f>=e.startSN&&f<=e.endSN){var p=o[f-e.startSN];i.cc===p.cc&&(a=p,l.logger.log("live playlist, switching playlist, load frag with next SN: "+a.sn))}a||(a=V.search(o,(function(e){return i.cc-e.cc})))&&l.logger.log("live playlist, switching playlist, load frag with same CC: "+a.sn)}return a},h._findFragment=function(e,t,n,r,i,o,a){var s,c=this.hls.config;i<o?s=ue(t,r,i,i>o-c.maxFragLookUpTolerance?0:c.maxFragLookUpTolerance):s=r[n-1];if(s){var u=s.sn-a.startSN,d=t&&s.level===t.level,h=r[u-1],f=r[u+1];if(t&&s.sn===t.sn)if(d&&!s.backtracked)if(s.sn<a.endSN){var p=t.deltaPTS;p&&p>c.maxBufferHole&&t.dropped&&u?(s=h,l.logger.warn("Previous fragment was dropped with large PTS gap between audio and video. Maybe fragment is not starting with a keyframe? Loading previous one to try to overcome this")):(s=f,this.fragmentTracker.getState(s)!==H&&l.logger.log("Re-loading fragment with SN: "+s.sn))}else s=null;else s.backtracked&&(f&&f.backtracked?(l.logger.warn("Already backtracked from fragment "+f.sn+", will not backtrack to fragment "+s.sn+". Loading fragment "+f.sn),s=f):(l.logger.warn("Loaded fragment with dropped frames, backtracking 1 segment to find a keyframe"),s.dropped=0,h?(s=h).backtracked=!0:u&&(s=null)))}return s},h._loadKey=function(e,t){l.logger.log("Loading key for "+e.sn+" of ["+t.startSN+"-"+t.endSN+"], level "+this.level),this.state=ye,this.hls.trigger(u.default.KEY_LOADING,{frag:e})},h._loadFragment=function(e,t,n,r){var i=this.fragmentTracker.getState(e);this.fragCurrent=e,"initSegment"!==e.sn&&(this.startFragRequested=!0),Object(c.isFiniteNumber)(e.sn)&&!e.bitrateTest&&(this.nextLoadPosition=e.start+e.duration),e.backtracked||i===D||i===F?(e.autoLevel=this.hls.autoLevelEnabled,e.bitrateTest=this.bitrateTest,l.logger.log("Loading "+e.sn+" of ["+t.startSN+"-"+t.endSN+"], level "+this.level+", "+(this.loadedmetadata?"currentTime":"nextLoadPosition")+": "+parseFloat(n.toFixed(3))+", bufferEnd: "+parseFloat(r.toFixed(3))),this.hls.trigger(u.default.FRAG_LOADING,{frag:e}),this.demuxer||(this.demuxer=new Z(this.hls,"main")),this.state=be):i===P&&this._reduceMaxBufferLength(e.duration)&&this.fragmentTracker.removeFragment(e)},h.getBufferedFrag=function(e){return this.fragmentTracker.getBufferedFrag(e,o.MAIN)},h.followingBufferedFrag=function(e){return e?this.getBufferedFrag(e.endPTS+.5):null},h._checkFragmentChanged=function(){var e,t,n=this.media;if(n&&n.readyState&&!1===n.seeking&&((t=n.currentTime)>this.lastCurrentTime&&(this.lastCurrentTime=t),Q.isBuffered(n,t)?e=this.getBufferedFrag(t):Q.isBuffered(n,t+.1)&&(e=this.getBufferedFrag(t+.1)),e)){var r=e;if(r!==this.fragPlaying){this.hls.trigger(u.default.FRAG_CHANGED,{frag:r});var i=r.level;this.fragPlaying&&this.fragPlaying.level===i||this.hls.trigger(u.default.LEVEL_SWITCHED,{level:i}),this.fragPlaying=r}}},h.immediateLevelSwitch=function(){if(l.logger.log("immediateLevelSwitch"),!this.immediateSwitch){this.immediateSwitch=!0;var e,t=this.media;t?(e=t.paused)||t.pause():e=!0,this.previouslyPaused=e}var n=this.fragCurrent;n&&n.loader&&n.loader.abort(),this.fragCurrent=null,this.flushMainBuffer(0,Number.POSITIVE_INFINITY)},h.immediateLevelSwitchEnd=function(){var e=this.media;e&&e.buffered.length&&(this.immediateSwitch=!1,e.currentTime>0&&Q.isBuffered(e,e.currentTime)&&(e.currentTime-=1e-4),this.previouslyPaused||e.play())},h.nextLevelSwitch=function(){var e=this.media;if(e&&e.readyState){var t,n=this.getBufferedFrag(e.currentTime);if(n&&n.startPTS>1&&this.flushMainBuffer(0,n.startPTS-1),e.paused)t=0;else{var r=this.hls.nextLoadLevel,i=this.levels[r],o=this.fragLastKbps;t=o&&this.fragCurrent?this.fragCurrent.duration*i.bitrate/(1e3*o)+1:0}var a=this.getBufferedFrag(e.currentTime+t);if(a){var s=this.followingBufferedFrag(a);if(s){var c=this.fragCurrent;c&&c.loader&&c.loader.abort(),this.fragCurrent=null;var u=Math.max(a.endPTS,s.maxStartPTS+Math.min(this.config.maxFragLookUpTolerance,s.duration));this.flushMainBuffer(u,Number.POSITIVE_INFINITY)}}}},h.flushMainBuffer=function(e,t){this.state=Te;var n={startOffset:e,endOffset:t};this.altAudio&&(n.type="video"),this.hls.trigger(u.default.BUFFER_FLUSHING,n)},h.onMediaAttached=function(e){var t=this.media=this.mediaBuffer=e.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),this.onvended=this.onMediaEnded.bind(this),t.addEventListener("seeking",this.onvseeking),t.addEventListener("seeked",this.onvseeked),t.addEventListener("ended",this.onvended);var n=this.config;this.levels&&n.autoStartLoad&&this.hls.startLoad(n.startPosition),this.gapController=new he(n,t,this.fragmentTracker,this.hls)},h.onMediaDetaching=function(){var e=this.media;e&&e.ended&&(l.logger.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0);var t=this.levels;t&&t.forEach((function(e){e.details&&e.details.fragments.forEach((function(e){e.backtracked=void 0}))})),e&&(e.removeEventListener("seeking",this.onvseeking),e.removeEventListener("seeked",this.onvseeked),e.removeEventListener("ended",this.onvended),this.onvseeking=this.onvseeked=this.onvended=null),this.fragmentTracker.removeAllFragments(),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.stopLoad()},h.onMediaSeeked=function(){var e=this.media,t=e?e.currentTime:void 0;Object(c.isFiniteNumber)(t)&&l.logger.log("media seeked to "+t.toFixed(3)),this.tick()},h.onManifestLoading=function(){l.logger.log("trigger BUFFER_RESET"),this.hls.trigger(u.default.BUFFER_RESET),this.fragmentTracker.removeAllFragments(),this.stalled=!1,this.startPosition=this.lastCurrentTime=0},h.onManifestParsed=function(e){var t,n=!1,r=!1;e.levels.forEach((function(e){(t=e.audioCodec)&&(-1!==t.indexOf("mp4a.40.2")&&(n=!0),-1!==t.indexOf("mp4a.40.5")&&(r=!0))})),this.audioCodecSwitch=n&&r,this.audioCodecSwitch&&l.logger.log("both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.altAudio=e.altAudio,this.levels=e.levels,this.startFragRequested=!1;var i=this.config;(i.autoStartLoad||this.forceStartLoad)&&this.hls.startLoad(i.startPosition)},h.onLevelLoaded=function(e){var t=e.details,n=e.level,r=this.levels[this.levelLastLoaded],i=this.levels[n],o=t.totalduration,a=0;if(l.logger.log("level "+n+" loaded ["+t.startSN+","+t.endSN+"],duration:"+o),t.live){var s=i.details;s&&t.fragments.length>0?(ne(s,t),a=t.fragments[0].start,this.liveSyncPosition=this.computeLivePosition(a,s),t.PTSKnown&&Object(c.isFiniteNumber)(a)?l.logger.log("live playlist sliding:"+a.toFixed(3)):(l.logger.log("live playlist - outdated PTS, unknown sliding"),se(this.fragPrevious,r,t))):(l.logger.log("live playlist - first load, unknown sliding"),t.PTSKnown=!1,se(this.fragPrevious,r,t))}else t.PTSKnown=!1;if(i.details=t,this.levelLastLoaded=n,this.hls.trigger(u.default.LEVEL_UPDATED,{details:t,level:n}),!1===this.startFragRequested){if(-1===this.startPosition||-1===this.lastCurrentTime){var d=t.startTimeOffset;Object(c.isFiniteNumber)(d)?(d<0&&(l.logger.log("negative start time offset "+d+", count from end of last fragment"),d=a+o+d),l.logger.log("start time offset found in playlist, adjust startPosition to "+d),this.startPosition=d):t.live?(this.startPosition=this.computeLivePosition(a,t),l.logger.log("configure startPosition to "+this.startPosition)):this.startPosition=0,this.lastCurrentTime=this.startPosition}this.nextLoadPosition=this.startPosition}this.state===xe&&(this.state=ve),this.tick()},h.onKeyLoaded=function(){this.state===ye&&(this.state=ve,this.tick())},h.onFragLoaded=function(e){var t=this.fragCurrent,n=this.hls,r=this.levels,i=this.media,o=e.frag;if(this.state===be&&t&&"main"===o.type&&o.level===t.level&&o.sn===t.sn){var a=e.stats,s=r[t.level],c=s.details;if(this.bitrateTest=!1,this.stats=a,l.logger.log("Loaded "+t.sn+" of ["+c.startSN+" ,"+c.endSN+"],level "+t.level),o.bitrateTest&&n.nextLoadLevel)this.state=ve,this.startFragRequested=!1,a.tparsed=a.tbuffered=window.performance.now(),n.trigger(u.default.FRAG_BUFFERED,{stats:a,frag:t,id:"main"}),this.tick();else if("initSegment"===o.sn)this.state=ve,a.tparsed=a.tbuffered=window.performance.now(),c.initSegment.data=e.payload,n.trigger(u.default.FRAG_BUFFERED,{stats:a,frag:t,id:"main"}),this.tick();else{l.logger.log("Parsing "+t.sn+" of ["+c.startSN+" ,"+c.endSN+"],level "+t.level+", cc "+t.cc),this.state=we,this.pendingBuffering=!0,this.appended=!1,o.bitrateTest&&(o.bitrateTest=!1,this.fragmentTracker.onFragLoaded({frag:o}));var d=!(i&&i.seeking)&&(c.PTSKnown||!c.live),h=c.initSegment?c.initSegment.data:[],f=this._getAudioCodec(s);(this.demuxer=this.demuxer||new Z(this.hls,"main")).push(e.payload,h,f,s.videoCodec,t,c.totalduration,d)}}this.fragLoadError=0},h.onFragParsingInitSegment=function(e){var t=this.fragCurrent,n=e.frag;if(t&&"main"===e.id&&n.sn===t.sn&&n.level===t.level&&this.state===we){var r,i,o=e.tracks;if(this.audioOnly=o.audio&&!o.video,this.altAudio&&!this.audioOnly&&delete o.audio,i=o.audio){var a=this.levels[this.level].audioCodec,s=navigator.userAgent.toLowerCase();a&&this.audioCodecSwap&&(l.logger.log("swapping playlist audio codec"),a=-1!==a.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5"),this.audioCodecSwitch&&1!==i.metadata.channelCount&&-1===s.indexOf("firefox")&&(a="mp4a.40.5"),-1!==s.indexOf("android")&&"audio/mpeg"!==i.container&&(a="mp4a.40.2",l.logger.log("Android: force audio codec to "+a)),i.levelCodec=a,i.id=e.id}for(r in(i=o.video)&&(i.levelCodec=this.levels[this.level].videoCodec,i.id=e.id),this.hls.trigger(u.default.BUFFER_CODECS,o),o){i=o[r],l.logger.log("main track:"+r+",container:"+i.container+",codecs[level/parsed]=["+i.levelCodec+"/"+i.codec+"]");var c=i.initSegment;c&&(this.appended=!0,this.pendingBuffering=!0,this.hls.trigger(u.default.BUFFER_APPENDING,{type:r,data:c,parent:"main",content:"initSegment"}))}this.tick()}},h.onFragParsingData=function(e){var t=this,n=this.fragCurrent,r=e.frag;if(n&&"main"===e.id&&r.sn===n.sn&&r.level===n.level&&("audio"!==e.type||!this.altAudio)&&this.state===we){var i=this.levels[this.level],o=n;if(Object(c.isFiniteNumber)(e.endPTS)||(e.endPTS=e.startPTS+n.duration,e.endDTS=e.startDTS+n.duration),!0===e.hasAudio&&o.addElementaryStream(A.AUDIO),!0===e.hasVideo&&o.addElementaryStream(A.VIDEO),l.logger.log("Parsed "+e.type+",PTS:["+e.startPTS.toFixed(3)+","+e.endPTS.toFixed(3)+"],DTS:["+e.startDTS.toFixed(3)+"/"+e.endDTS.toFixed(3)+"],nb:"+e.nb+",dropped:"+(e.dropped||0)),"video"===e.type)if(o.dropped=e.dropped,o.dropped)if(o.backtracked)l.logger.warn("Already backtracked on this fragment, appending with the gap",o.sn);else{var a=i.details;if(!a||o.sn!==a.startSN)return l.logger.warn("missing video frame(s), backtracking fragment",o.sn),this.fragmentTracker.removeFragment(o),o.backtracked=!0,this.nextLoadPosition=e.startPTS,this.state=ve,this.fragPrevious=o,this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),void this.tick();l.logger.warn("missing video frame(s) on first frag, appending with gap",o.sn)}else o.backtracked=!1;var s=te(i.details,o,e.startPTS,e.endPTS,e.startDTS,e.endDTS),d=this.hls;d.trigger(u.default.LEVEL_PTS_UPDATED,{details:i.details,level:this.level,drift:s,type:e.type,start:e.startPTS,end:e.endPTS}),[e.data1,e.data2].forEach((function(n){n&&n.length&&t.state===we&&(t.appended=!0,t.pendingBuffering=!0,d.trigger(u.default.BUFFER_APPENDING,{type:e.type,data:n,parent:"main",content:"data"}))})),this.tick()}},h.onFragParsed=function(e){var t=this.fragCurrent,n=e.frag;t&&"main"===e.id&&n.sn===t.sn&&n.level===t.level&&this.state===we&&(this.stats.tparsed=window.performance.now(),this.state=Se,this._checkAppendedParsed())},h.onAudioTrackSwitching=function(e){var t=this.altAudio,n=!!e.url,r=e.id;if(!n){if(this.mediaBuffer!==this.media){l.logger.log("switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;var i=this.fragCurrent;i.loader&&(l.logger.log("switching to main audio track, cancel main fragment load"),i.loader.abort()),this.fragCurrent=null,this.fragPrevious=null,this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),this.state=ve}var o=this.hls;t&&o.trigger(u.default.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"}),o.trigger(u.default.AUDIO_TRACK_SWITCHED,{id:r})}},h.onAudioTrackSwitched=function(e){var t=e.id,n=!!this.hls.audioTracks[t].url;if(n){var r=this.videoBuffer;r&&this.mediaBuffer!==r&&(l.logger.log("switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=r)}this.altAudio=n,this.tick()},h.onBufferCreated=function(e){var t,n,r=e.tracks,i=!1;for(var o in r){var a=r[o];"main"===a.id?(n=o,t=a,"video"===o&&(this.videoBuffer=r[o].buffer)):i=!0}i&&t?(l.logger.log("alternate track found, use "+n+".buffered to schedule main fragment loading"),this.mediaBuffer=t.buffer):this.mediaBuffer=this.media},h.onBufferAppended=function(e){if("main"===e.parent){var t=this.state;t!==we&&t!==Se||(this.pendingBuffering=e.pending>0,this._checkAppendedParsed())}},h._checkAppendedParsed=function(){if(!(this.state!==Se||this.appended&&this.pendingBuffering)){var e=this.fragCurrent;if(e){var t=this.mediaBuffer?this.mediaBuffer:this.media;l.logger.log("main buffered : "+oe.toString(t.buffered)),this.fragPrevious=e;var n=this.stats;n.tbuffered=window.performance.now(),this.fragLastKbps=Math.round(8*n.total/(n.tbuffered-n.tfirst)),this.hls.trigger(u.default.FRAG_BUFFERED,{stats:n,frag:e,id:"main"}),this.state=ve}(this.loadedmetadata||this.startPosition<=0)&&this.tick()}},h.onError=function(e){var t=e.frag||this.fragCurrent;if(!t||"main"===t.type){var n=!!this.media&&Q.isBuffered(this.media,this.media.currentTime)&&Q.isBuffered(this.media,this.media.currentTime+.5);switch(e.details){case s.ErrorDetails.FRAG_LOAD_ERROR:case s.ErrorDetails.FRAG_LOAD_TIMEOUT:case s.ErrorDetails.KEY_LOAD_ERROR:case s.ErrorDetails.KEY_LOAD_TIMEOUT:if(!e.fatal)if(this.fragLoadError+1<=this.config.fragLoadingMaxRetry){var r=Math.min(Math.pow(2,this.fragLoadError)*this.config.fragLoadingRetryDelay,this.config.fragLoadingMaxRetryTimeout);l.logger.warn("mediaController: frag loading failed, retry in "+r+" ms"),this.retryDate=window.performance.now()+r,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.fragLoadError++,this.state=Ee}else l.logger.error("mediaController: "+e.details+" reaches max retry, redispatch as fatal ..."),e.fatal=!0,this.state=Ce;break;case s.ErrorDetails.LEVEL_LOAD_ERROR:case s.ErrorDetails.LEVEL_LOAD_TIMEOUT:this.state!==Ce&&(e.fatal?(this.state=Ce,l.logger.warn("streamController: "+e.details+",switch to "+this.state+" state ...")):e.levelRetry||this.state!==xe||(this.state=ve));break;case s.ErrorDetails.BUFFER_FULL_ERROR:"main"!==e.parent||this.state!==we&&this.state!==Se||(n?(this._reduceMaxBufferLength(this.config.maxBufferLength),this.state=ve):(l.logger.warn("buffer full error also media.currentTime is not buffered, flush everything"),this.fragCurrent=null,this.flushMainBuffer(0,Number.POSITIVE_INFINITY)))}}},h._reduceMaxBufferLength=function(e){var t=this.config;return t.maxMaxBufferLength>=e&&(t.maxMaxBufferLength/=2,l.logger.warn("main:reduce max buffer length to "+t.maxMaxBufferLength+"s"),!0)},h._checkBuffer=function(){var e=this.media;if(e&&0!==e.readyState){var t=(this.mediaBuffer?this.mediaBuffer:e).buffered;!this.loadedmetadata&&t.length?(this.loadedmetadata=!0,this._seekToStartPos()):this.immediateSwitch?this.immediateLevelSwitchEnd():this.gapController.poll(this.lastCurrentTime,t)}},h.onFragLoadEmergencyAborted=function(){this.state=ve,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.tick()},h.onBufferFlushed=function(){var e=this.mediaBuffer?this.mediaBuffer:this.media;if(e){var t=this.audioOnly?A.AUDIO:A.VIDEO;this.fragmentTracker.detectEvictedFragments(t,e.buffered)}this.state=ve,this.fragPrevious=null},h.onLevelsUpdated=function(e){this.levels=e.levels},h.swapAudioCodec=function(){this.audioCodecSwap=!this.audioCodecSwap},h._seekToStartPos=function(){var e=this.media,t=e.currentTime,n=this.startPosition;if(t!==n&&n>=0){if(e.seeking)return void l.logger.log("could not seek to "+n+", already seeking at "+t);var r=(e.buffered.length?e.buffered.start(0):0)-n;r>0&&r<this.config.maxBufferHole&&(l.logger.log("adjusting start position by "+r+" to match buffer start"),n+=r,this.startPosition=n),l.logger.log("seek to target start position "+n+" from current time "+t+". ready state "+e.readyState),e.currentTime=n}},h._getAudioCodec=function(e){var t=this.config.defaultAudioCodec||e.audioCodec;return this.audioCodecSwap&&(l.logger.log("swapping playlist audio codec"),t&&(t=-1!==t.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5")),t},i=r,(a=[{key:"state",set:function(e){if(this.state!==e){var t=this.state;this._state=e,l.logger.log("main stream-controller: "+t+"->"+e),this.hls.trigger(u.default.STREAM_STATE_TRANSITION,{previousState:t,nextState:e})}},get:function(){return this._state}},{key:"currentLevel",get:function(){var e=this.media;if(e){var t=this.getBufferedFrag(e.currentTime);if(t)return t.level}return-1}},{key:"nextBufferedFrag",get:function(){var e=this.media;return e?this.followingBufferedFrag(this.getBufferedFrag(e.currentTime)):null}},{key:"nextLevel",get:function(){var e=this.nextBufferedFrag;return e?e.level:-1}},{key:"liveSyncPosition",get:function(){return this._liveSyncPosition},set:function(e){this._liveSyncPosition=e}}])&&Ne(i.prototype,a),d&&Ne(i,d),r}(Oe);function Le(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var ke=function(e){var t,n;function r(t){var n;return(n=e.call(this,t,u.default.MANIFEST_LOADED,u.default.LEVEL_LOADED,u.default.AUDIO_TRACK_SWITCHED,u.default.FRAG_LOADED,u.default.ERROR)||this).canload=!1,n.currentLevelIndex=null,n.manualLevelIndex=-1,n.timer=null,Be=/chrome|firefox/.test(navigator.userAgent.toLowerCase()),n}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var i,o,a,c=r.prototype;return c.onHandlerDestroying=function(){this.clearTimer(),this.manualLevelIndex=-1},c.clearTimer=function(){null!==this.timer&&(clearTimeout(this.timer),this.timer=null)},c.startLoad=function(){var e=this._levels;this.canload=!0,this.levelRetryCount=0,e&&e.forEach((function(e){e.loadError=0;var t=e.details;t&&t.live&&(e.details=void 0)})),null!==this.timer&&this.loadLevel()},c.stopLoad=function(){this.canload=!1},c.onManifestLoaded=function(e){var t,n=[],r=[],i={},o=null,a=!1,c=!1;if(e.levels.forEach((function(e){var t=e.attrs;e.loadError=0,e.fragmentError=!1,a=a||!!e.videoCodec,c=c||!!e.audioCodec,Be&&e.audioCodec&&-1!==e.audioCodec.indexOf("mp4a.40.34")&&(e.audioCodec=void 0),(o=i[e.bitrate])?o.url.push(e.url):(e.url=[e.url],e.urlId=0,i[e.bitrate]=e,n.push(e)),t&&(t.AUDIO&&$(o||e,"audio",t.AUDIO),t.SUBTITLES&&$(o||e,"text",t.SUBTITLES))})),a&&c&&(n=n.filter((function(e){return!!e.videoCodec}))),n=n.filter((function(e){var t=e.audioCodec,n=e.videoCodec;return(!t||T(t,"audio"))&&(!n||T(n,"video"))})),e.audioTracks&&(r=e.audioTracks.filter((function(e){return!e.audioCodec||T(e.audioCodec,"audio")}))).forEach((function(e,t){e.id=t})),n.length>0){t=n[0].bitrate,n.sort((function(e,t){return e.bitrate-t.bitrate})),this._levels=n;for(var d=0;d<n.length;d++)if(n[d].bitrate===t){this._firstLevel=d,l.logger.log("manifest loaded,"+n.length+" level(s) found, first bitrate:"+t);break}var h=c&&!a;this.hls.trigger(u.default.MANIFEST_PARSED,{levels:n,audioTracks:r,firstLevel:this._firstLevel,stats:e.stats,audio:c,video:a,altAudio:!h&&r.some((function(e){return!!e.url}))})}else this.hls.trigger(u.default.ERROR,{type:s.ErrorTypes.MEDIA_ERROR,details:s.ErrorDetails.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:this.hls.url,reason:"no level with compatible codecs found in manifest"})},c.setLevelInternal=function(e){var t=this._levels,n=this.hls;if(e>=0&&e<t.length){if(this.clearTimer(),this.currentLevelIndex!==e){l.logger.log("switching to level "+e),this.currentLevelIndex=e;var r=t[e];r.level=e,n.trigger(u.default.LEVEL_SWITCHING,r)}var i=t[e],o=i.details;if(!o||o.live){var a=i.urlId;n.trigger(u.default.LEVEL_LOADING,{url:i.url[a],level:e,id:a})}}else n.trigger(u.default.ERROR,{type:s.ErrorTypes.OTHER_ERROR,details:s.ErrorDetails.LEVEL_SWITCH_ERROR,level:e,fatal:!1,reason:"invalid level idx"})},c.onError=function(e){if(e.fatal)e.type===s.ErrorTypes.NETWORK_ERROR&&this.clearTimer();else{var t,n=!1,r=!1;switch(e.details){case s.ErrorDetails.FRAG_LOAD_ERROR:case s.ErrorDetails.FRAG_LOAD_TIMEOUT:case s.ErrorDetails.KEY_LOAD_ERROR:case s.ErrorDetails.KEY_LOAD_TIMEOUT:t=e.frag.level,r=!0;break;case s.ErrorDetails.LEVEL_LOAD_ERROR:case s.ErrorDetails.LEVEL_LOAD_TIMEOUT:t=e.context.level,n=!0;break;case s.ErrorDetails.REMUX_ALLOC_ERROR:t=e.level,n=!0}void 0!==t&&this.recoverLevel(e,t,n,r)}},c.recoverLevel=function(e,t,n,r){var i,o,a,s=this,c=this.hls.config,u=e.details,d=this._levels[t];if(d.loadError++,d.fragmentError=r,n){if(!(this.levelRetryCount+1<=c.levelLoadingMaxRetry))return l.logger.error("level controller, cannot recover from "+u+" error"),this.currentLevelIndex=null,this.clearTimer(),void(e.fatal=!0);o=Math.min(Math.pow(2,this.levelRetryCount)*c.levelLoadingRetryDelay,c.levelLoadingMaxRetryTimeout),this.timer=setTimeout((function(){return s.loadLevel()}),o),e.levelRetry=!0,this.levelRetryCount++,l.logger.warn("level controller, "+u+", retry in "+o+" ms, current retry count is "+this.levelRetryCount)}(n||r)&&((i=d.url.length)>1&&d.loadError<i?(d.urlId=(d.urlId+1)%i,d.details=void 0,l.logger.warn("level controller, "+u+" for level "+t+": switching to redundant URL-id "+d.urlId)):-1===this.manualLevelIndex?(a=0===t?this._levels.length-1:t-1,l.logger.warn("level controller, "+u+": switch to "+a),this.hls.nextAutoLevel=this.currentLevelIndex=a):r&&(l.logger.warn("level controller, "+u+": reload a fragment"),this.currentLevelIndex=null))},c.onFragLoaded=function(e){var t=e.frag;if(void 0!==t&&"main"===t.type){var n=this._levels[t.level];void 0!==n&&(n.fragmentError=!1,n.loadError=0,this.levelRetryCount=0)}},c.onLevelLoaded=function(e){var t=this,n=e.level,r=e.details;if(n===this.currentLevelIndex){var i=this._levels[n];if(i.fragmentError||(i.loadError=0,this.levelRetryCount=0),r.live){var o=ie(i.details,r,e.stats.trequest);l.logger.log("live playlist, reload in "+Math.round(o)+" ms"),this.timer=setTimeout((function(){return t.loadLevel()}),o)}else this.clearTimer()}},c.onAudioTrackSwitched=function(e){var t=this.hls.audioTracks[e.id].groupId,n=this.hls.levels[this.currentLevelIndex];if(n&&n.audioGroupIds){for(var r=-1,i=0;i<n.audioGroupIds.length;i++)if(n.audioGroupIds[i]===t){r=i;break}r!==n.urlId&&(n.urlId=r,this.startLoad())}},c.loadLevel=function(){if(l.logger.debug("call to loadLevel"),null!==this.currentLevelIndex&&this.canload){var e=this._levels[this.currentLevelIndex];if("object"==typeof e&&e.url.length>0){var t=this.currentLevelIndex,n=e.urlId,r=e.url[n];l.logger.log("Attempt loading level index "+t+" with URL-id "+n),this.hls.trigger(u.default.LEVEL_LOADING,{url:r,level:t,id:n})}}},c.removeLevel=function(e,t){var n=this.levels.filter((function(n,r){return r!==e||n.url.length>1&&void 0!==t&&(n.url=n.url.filter((function(e,n){return n!==t})),n.urlId=0,!0)})).map((function(e,t){var n=e.details;return n&&n.fragments&&n.fragments.forEach((function(e){e.level=t})),e}));this._levels=n,this.hls.trigger(u.default.LEVELS_UPDATED,{levels:n})},i=r,(o=[{key:"levels",get:function(){return this._levels}},{key:"level",get:function(){return this.currentLevelIndex},set:function(e){var t=this._levels;t&&(e=Math.min(e,t.length-1),this.currentLevelIndex===e&&t[e].details||this.setLevelInternal(e))}},{key:"manualLevel",get:function(){return this.manualLevelIndex},set:function(e){this.manualLevelIndex=e,void 0===this._startLevel&&(this._startLevel=e),-1!==e&&(this.level=e)}},{key:"firstLevel",get:function(){return this._firstLevel},set:function(e){this._firstLevel=e}},{key:"startLevel",get:function(){if(void 0===this._startLevel){var e=this.hls.config.startLevel;return void 0!==e?e:this._firstLevel}return this._startLevel},set:function(e){this._startLevel=e}},{key:"nextLoadLevel",get:function(){return-1!==this.manualLevelIndex?this.manualLevelIndex:this.hls.nextAutoLevel},set:function(e){this.level=e,-1===this.manualLevelIndex&&(this.hls.nextAutoLevel=e)}}])&&Le(i.prototype,o),a&&Le(i,a),r}(h),Ue=n("./src/demux/id3.js");function De(e,t){var n;try{n=new Event("addtrack")}catch(e){(n=document.createEvent("Event")).initEvent("addtrack",!1,!1)}n.track=e,t.dispatchEvent(n)}function Pe(e){if(null==e?void 0:e.cues)for(;e.cues.length>0;)e.removeCue(e.cues[0])}var Fe=function(e){var t,n;function r(t){var n;return(n=e.call(this,t,u.default.MEDIA_ATTACHED,u.default.MEDIA_DETACHING,u.default.FRAG_PARSING_METADATA,u.default.LIVE_BACK_BUFFER_REACHED)||this).id3Track=void 0,n.media=void 0,n}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var i=r.prototype;return i.destroy=function(){h.prototype.destroy.call(this)},i.onMediaAttached=function(e){this.media=e.media,this.media},i.onMediaDetaching=function(){Pe(this.id3Track),this.id3Track=void 0,this.media=void 0},i.getID3Track=function(e){for(var t=0;t<e.length;t++){var n=e[t];if("metadata"===n.kind&&"id3"===n.label)return De(n,this.media),n}return this.media.addTextTrack("metadata","id3")},i.onFragParsingMetadata=function(e){var t=e.frag,n=e.samples;this.id3Track||(this.id3Track=this.getID3Track(this.media.textTracks),this.id3Track.mode="hidden");for(var r=window.WebKitDataCue||window.VTTCue||window.TextTrackCue,i=0;i<n.length;i++){var o=Ue.default.getID3Frames(n[i].data);if(o){var a=Math.max(n[i].pts,0),s=i<n.length-1?n[i+1].pts:t.endPTS;s||(s=t.start+t.duration),s-a<=0&&(s=a+.25);for(var c=0;c<o.length;c++){var u=o[c];if(!Ue.default.isTimeStampFrame(u)){var l=new r(a,s,"");l.value=u,this.id3Track.addCue(l)}}}}},i.onLiveBackBufferReached=function(e){var t=e.bufferEnd,n=this.id3Track;if(n&&n.cues&&n.cues.length){var r=function(e,t){if(t<e[0].endTime)return e[0];if(t>e[e.length-1].endTime)return e[e.length-1];for(var n=0,r=e.length-1;n<=r;){var i=Math.floor((r+n)/2);if(t<e[i].endTime)r=i-1;else{if(!(t>e[i].endTime))return e[i];n=i+1}}return e[n].endTime-t<t-e[r].endTime?e[n]:e[r]}(n.cues,t);if(r)for(;n.cues[0]!==r;)n.removeCue(n.cues[0])}},r}(h);var He=function(){function e(e){this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.alpha_=e?Math.exp(Math.log(.5)/e):0,this.estimate_=0,this.totalWeight_=0}var t=e.prototype;return t.sample=function(e,t){var n=Math.pow(this.alpha_,e);this.estimate_=t*(1-n)+n*this.estimate_,this.totalWeight_+=e},t.getTotalWeight=function(){return this.totalWeight_},t.getEstimate=function(){if(this.alpha_){var e=1-Math.pow(this.alpha_,this.totalWeight_);return this.estimate_/e}return this.estimate_},e}(),je=function(){function e(e,t,n,r){this.hls=void 0,this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.hls=e,this.defaultEstimate_=r,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new He(t),this.fast_=new He(n)}var t=e.prototype;return t.sample=function(e,t){var n=(e=Math.max(e,this.minDelayMs_))/1e3,r=8*t/n;this.fast_.sample(n,r),this.slow_.sample(n,r)},t.canEstimate=function(){var e=this.fast_;return e&&e.getTotalWeight()>=this.minWeight_},t.getEstimate=function(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_},t.destroy=function(){},e}();function Ve(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Qe=window.performance,Ge=function(e){var t,n;function r(t){var n;return(n=e.call(this,t,u.default.FRAG_LOADING,u.default.FRAG_LOADED,u.default.FRAG_BUFFERED,u.default.ERROR)||this).lastLoadedFragLevel=0,n._nextAutoLevel=-1,n.hls=t,n.timer=null,n._bwEstimator=null,n.onCheck=n._abandonRulesCheck.bind(function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(n)),n}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var i,o,a,d=r.prototype;return d.destroy=function(){this.clearTimer(),h.prototype.destroy.call(this)},d.onFragLoading=function(e){var t=e.frag;if("main"===t.type&&(this.timer||(this.fragCurrent=t,this.timer=setInterval(this.onCheck,100)),!this._bwEstimator)){var n,r,i=this.hls,o=i.config,a=t.level;i.levels[a].details.live?(n=o.abrEwmaFastLive,r=o.abrEwmaSlowLive):(n=o.abrEwmaFastVoD,r=o.abrEwmaSlowVoD),this._bwEstimator=new je(i,r,n,o.abrEwmaDefaultEstimate)}},d._abandonRulesCheck=function(){var e=this.hls,t=e.media,n=this.fragCurrent;if(n){var r=n.loader;if(!r||r.stats&&r.stats.aborted)return l.logger.warn("frag loader destroy or aborted, disarm abandonRules"),this.clearTimer(),void(this._nextAutoLevel=-1);var i=r.stats;if(t&&i&&(!t.paused&&0!==t.playbackRate||!t.readyState)&&n.autoLevel&&n.level){var o=Qe.now()-i.trequest,a=Math.abs(t.playbackRate);if(o>500*n.duration/a){var s=e.levels,c=Math.max(1,i.bw?i.bw/8:1e3*i.loaded/o),d=s[n.level];if(!d)return;var h=d.realBitrate?Math.max(d.realBitrate,d.bitrate):d.bitrate,f=i.total?i.total:Math.max(i.loaded,Math.round(n.duration*h/8)),p=t.currentTime,A=(f-i.loaded)/c,g=(Q.bufferInfo(t,p,e.config.maxBufferHole).end-p)/a;if(g<2*n.duration/a&&A>g){var v,m,y=e.minAutoLevel;for(m=n.level-1;m>y;m--){var b=s[m].realBitrate?Math.max(s[m].realBitrate,s[m].bitrate):s[m].bitrate;if(n.duration*b/(6.4*c)<g)break}v<A&&(l.logger.warn("loading too slow, abort fragment loading and switch to level "+m+":fragLoadedDelay["+m+"]<fragLoadedDelay["+(n.level-1)+"];bufferStarvationDelay:"+v.toFixed(1)+"<"+A.toFixed(1)+":"+g.toFixed(1)),e.nextLoadLevel=m,this._bwEstimator.sample(o,i.loaded),r.abort(),this.clearTimer(),e.trigger(u.default.FRAG_LOAD_EMERGENCY_ABORTED,{frag:n,stats:i}))}}}}},d.onFragLoaded=function(e){var t=e.frag;if("main"===t.type&&Object(c.isFiniteNumber)(t.sn)){if(this.clearTimer(),this.lastLoadedFragLevel=t.level,this._nextAutoLevel=-1,this.hls.config.abrMaxWithRealBitrate){var n=this.hls.levels[t.level],r=(n.loaded?n.loaded.bytes:0)+e.stats.loaded,i=(n.loaded?n.loaded.duration:0)+e.frag.duration;n.loaded={bytes:r,duration:i},n.realBitrate=Math.round(8*r/i)}if(e.frag.bitrateTest){var o=e.stats;o.tparsed=o.tbuffered=o.tload,this.onFragBuffered(e)}}},d.onFragBuffered=function(e){var t=e.stats,n=e.frag;if(!0!==t.aborted&&"main"===n.type&&Object(c.isFiniteNumber)(n.sn)&&(!n.bitrateTest||t.tload===t.tbuffered)){var r=t.tparsed-t.trequest;l.logger.log("latency/loading/parsing/append/kbps:"+Math.round(t.tfirst-t.trequest)+"/"+Math.round(t.tload-t.tfirst)+"/"+Math.round(t.tparsed-t.tload)+"/"+Math.round(t.tbuffered-t.tparsed)+"/"+Math.round(8*t.loaded/(t.tbuffered-t.trequest))),this._bwEstimator.sample(r,t.loaded),t.bwEstimate=this._bwEstimator.getEstimate(),n.bitrateTest?this.bitrateTestDelay=r/1e3:this.bitrateTestDelay=0}},d.onError=function(e){switch(e.details){case s.ErrorDetails.FRAG_LOAD_ERROR:case s.ErrorDetails.FRAG_LOAD_TIMEOUT:this.clearTimer()}},d.clearTimer=function(){clearInterval(this.timer),this.timer=null},d._findBestLevel=function(e,t,n,r,i,o,a,s,c){for(var u=i;u>=r;u--){var d=c[u];if(d){var h=d.details,f=h?h.totalduration/h.fragments.length:t,p=!!h&&h.live,A=void 0;A=u<=e?a*n:s*n;var g=c[u].realBitrate?Math.max(c[u].realBitrate,c[u].bitrate):c[u].bitrate,v=g*f/A;if(l.logger.trace("level/adjustedbw/bitrate/avgDuration/maxFetchDuration/fetchDuration: "+u+"/"+Math.round(A)+"/"+g+"/"+f+"/"+o+"/"+v),A>g&&(!v||p&&!this.bitrateTestDelay||v<o))return u}}return-1},i=r,(o=[{key:"nextAutoLevel",get:function(){var e=this._nextAutoLevel,t=this._bwEstimator;if(!(-1===e||t&&t.canEstimate()))return e;var n=this._nextABRAutoLevel;return-1!==e&&(n=Math.min(e,n)),n},set:function(e){this._nextAutoLevel=e}},{key:"_nextABRAutoLevel",get:function(){var e=this.hls,t=e.maxAutoLevel,n=e.levels,r=e.config,i=e.minAutoLevel,o=e.media,a=this.lastLoadedFragLevel,s=this.fragCurrent?this.fragCurrent.duration:0,c=o?o.currentTime:0,u=o&&0!==o.playbackRate?Math.abs(o.playbackRate):1,d=this._bwEstimator?this._bwEstimator.getEstimate():r.abrEwmaDefaultEstimate,h=(Q.bufferInfo(o,c,r.maxBufferHole).end-c)/u,f=this._findBestLevel(a,s,d,i,t,h,r.abrBandWidthFactor,r.abrBandWidthUpFactor,n);if(f>=0)return f;l.logger.trace("rebuffering expected to happen, lets try to find a quality level minimizing the rebuffering");var p=s?Math.min(s,r.maxStarvationDelay):r.maxStarvationDelay,A=r.abrBandWidthFactor,g=r.abrBandWidthUpFactor;if(0===h){var v=this.bitrateTestDelay;v&&(p=(s?Math.min(s,r.maxLoadingDelay):r.maxLoadingDelay)-v,l.logger.trace("bitrate test took "+Math.round(1e3*v)+"ms, set first fragment max fetchDuration to "+Math.round(1e3*p)+" ms"),A=g=1)}return f=this._findBestLevel(a,s,d,i,t,h+p,A,g,n),Math.max(f,0)}}])&&Ve(i.prototype,o),a&&Ve(i,a),r}(h);var ze=q(),Ke=function(e){var t,n;function r(t){var n;return(n=e.call(this,t,u.default.MEDIA_ATTACHING,u.default.MEDIA_DETACHING,u.default.MANIFEST_PARSED,u.default.BUFFER_RESET,u.default.BUFFER_APPENDING,u.default.BUFFER_CODECS,u.default.BUFFER_EOS,u.default.BUFFER_FLUSHING,u.default.LEVEL_PTS_UPDATED,u.default.LEVEL_UPDATED)||this)._msDuration=null,n._levelDuration=null,n._levelTargetDuration=10,n._live=null,n._objectUrl=null,n._needsFlush=!1,n._needsEos=!1,n.config=void 0,n.audioTimestampOffset=void 0,n.bufferCodecEventsExpected=0,n._bufferCodecEventsTotal=0,n.media=null,n.mediaSource=null,n.segments=[],n.parent=void 0,n.appending=!1,n.appended=0,n.appendError=0,n.flushBufferCounter=0,n.tracks={},n.pendingTracks={},n.sourceBuffer={},n.flushRange=[],n._onMediaSourceOpen=function(){l.logger.log("media source opened"),n.hls.trigger(u.default.MEDIA_ATTACHED,{media:n.media});var e=n.mediaSource;e&&e.removeEventListener("sourceopen",n._onMediaSourceOpen),n.checkPendingTracks()},n._onMediaSourceClose=function(){l.logger.log("media source closed")},n._onMediaSourceEnded=function(){l.logger.log("media source ended")},n._onSBUpdateEnd=function(){if(n.audioTimestampOffset&&n.sourceBuffer.audio){var e=n.sourceBuffer.audio;l.logger.warn("change mpeg audio timestamp offset from "+e.timestampOffset+" to "+n.audioTimestampOffset),e.timestampOffset=n.audioTimestampOffset,delete n.audioTimestampOffset}n._needsFlush&&n.doFlush(),n._needsEos&&n.checkEos(),n.appending=!1;var t=n.parent,r=n.segments.reduce((function(e,n){return n.parent===t?e+1:e}),0),i={},o=n.sourceBuffer;for(var a in o){var s=o[a];if(!s)throw Error("handling source buffer update end error: source buffer for "+a+" uninitilized and unable to update buffered TimeRanges.");i[a]=s.buffered}n.hls.trigger(u.default.BUFFER_APPENDED,{parent:t,pending:r,timeRanges:i}),n._needsFlush||n.doAppending(),n.updateMediaElementDuration(),0===r&&n.flushLiveBackBuffer()},n._onSBUpdateError=function(e){l.logger.error("sourceBuffer error:",e),n.hls.trigger(u.default.ERROR,{type:s.ErrorTypes.MEDIA_ERROR,details:s.ErrorDetails.BUFFER_APPENDING_ERROR,fatal:!1})},n.config=t.config,n}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var i=r.prototype;return i.destroy=function(){h.prototype.destroy.call(this)},i.onLevelPtsUpdated=function(e){var t=e.type,n=this.tracks.audio;if("audio"===t&&n&&"audio/mpeg"===n.container){var r=this.sourceBuffer.audio;if(!r)throw Error("Level PTS Updated and source buffer for audio uninitalized");if(Math.abs(r.timestampOffset-e.start)>.1){var i=r.updating;try{r.abort()}catch(e){l.logger.warn("can not abort audio buffer: "+e)}i?this.audioTimestampOffset=e.start:(l.logger.warn("change mpeg audio timestamp offset from "+r.timestampOffset+" to "+e.start),r.timestampOffset=e.start)}}},i.onManifestParsed=function(e){var t=2;(e.audio&&!e.video||!e.altAudio)&&(t=1),this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=t,l.logger.log(this.bufferCodecEventsExpected+" bufferCodec event(s) expected")},i.onMediaAttaching=function(e){var t=this.media=e.media;if(t&&ze){var n=this.mediaSource=new ze;n.addEventListener("sourceopen",this._onMediaSourceOpen),n.addEventListener("sourceended",this._onMediaSourceEnded),n.addEventListener("sourceclose",this._onMediaSourceClose),t.src=window.URL.createObjectURL(n),this._objectUrl=t.src}},i.onMediaDetaching=function(){l.logger.log("media source detaching");var e=this.mediaSource;if(e){if("open"===e.readyState)try{e.endOfStream()}catch(e){l.logger.warn("onMediaDetaching:"+e.message+" while calling endOfStream")}e.removeEventListener("sourceopen",this._onMediaSourceOpen),e.removeEventListener("sourceended",this._onMediaSourceEnded),e.removeEventListener("sourceclose",this._onMediaSourceClose),this.media&&(this._objectUrl&&window.URL.revokeObjectURL(this._objectUrl),this.media.src===this._objectUrl?(this.media.removeAttribute("src"),this.media.load()):l.logger.warn("media.src was changed by a third party - skip cleanup")),this.mediaSource=null,this.media=null,this._objectUrl=null,this.bufferCodecEventsExpected=this._bufferCodecEventsTotal,this.pendingTracks={},this.tracks={},this.sourceBuffer={},this.flushRange=[],this.segments=[],this.appended=0}this.hls.trigger(u.default.MEDIA_DETACHED)},i.checkPendingTracks=function(){var e=this.bufferCodecEventsExpected,t=this.pendingTracks,n=Object.keys(t).length;(n&&!e||2===n)&&(this.createSourceBuffers(t),this.pendingTracks={},this.doAppending())},i.onBufferReset=function(){var e=this.sourceBuffer;for(var t in e){var n=e[t];try{n&&(this.mediaSource&&this.mediaSource.removeSourceBuffer(n),n.removeEventListener("updateend",this._onSBUpdateEnd),n.removeEventListener("error",this._onSBUpdateError))}catch(e){}}this.sourceBuffer={},this.flushRange=[],this.segments=[],this.appended=0},i.onBufferCodecs=function(e){var t=this;Object.keys(this.sourceBuffer).length||(Object.keys(e).forEach((function(n){t.pendingTracks[n]=e[n]})),this.bufferCodecEventsExpected=Math.max(this.bufferCodecEventsExpected-1,0),this.mediaSource&&"open"===this.mediaSource.readyState&&this.checkPendingTracks())},i.createSourceBuffers=function(e){var t=this.sourceBuffer,n=this.mediaSource;if(!n)throw Error("createSourceBuffers called when mediaSource was null");for(var r in e)if(!t[r]){var i=e[r];if(!i)throw Error("source buffer exists for track "+r+", however track does not");var o=i.levelCodec||i.codec,a=i.container+";codecs="+o;l.logger.log("creating sourceBuffer("+a+")");try{var c=t[r]=n.addSourceBuffer(a);c.addEventListener("updateend",this._onSBUpdateEnd),c.addEventListener("error",this._onSBUpdateError),this.tracks[r]={buffer:c,codec:o,id:i.id,container:i.container,levelCodec:i.levelCodec}}catch(e){l.logger.error("error while trying to add sourceBuffer:"+e.message),this.hls.trigger(u.default.ERROR,{type:s.ErrorTypes.MEDIA_ERROR,details:s.ErrorDetails.BUFFER_ADD_CODEC_ERROR,fatal:!1,err:e,mimeType:a})}}this.hls.trigger(u.default.BUFFER_CREATED,{tracks:this.tracks})},i.onBufferAppending=function(e){this._needsFlush||(this.segments?this.segments.push(e):this.segments=[e],this.doAppending())},i.onBufferEos=function(e){for(var t in this.sourceBuffer)if(!e.type||e.type===t){var n=this.sourceBuffer[t];n&&!n.ended&&(n.ended=!0,l.logger.log(t+" sourceBuffer now EOS"))}this.checkEos()},i.checkEos=function(){var e=this.sourceBuffer,t=this.mediaSource;if(t&&"open"===t.readyState){for(var n in e){var r=e[n];if(r){if(!r.ended)return;if(r.updating)return void(this._needsEos=!0)}}l.logger.log("all media data are available, signal endOfStream() to MediaSource and stop loading fragment");try{t.endOfStream()}catch(e){l.logger.warn("exception while calling mediaSource.endOfStream()")}this._needsEos=!1}else this._needsEos=!1},i.onBufferFlushing=function(e){e.type?this.flushRange.push({start:e.startOffset,end:e.endOffset,type:e.type}):(this.flushRange.push({start:e.startOffset,end:e.endOffset,type:"video"}),this.flushRange.push({start:e.startOffset,end:e.endOffset,type:"audio"})),this.flushBufferCounter=0,this.doFlush()},i.flushLiveBackBuffer=function(){if(this._live){var e=this.config.liveBackBufferLength;if(isFinite(e)&&!(e<0))if(this.media)for(var t=this.media.currentTime,n=this.sourceBuffer,r=Object.keys(n),i=t-Math.max(e,this._levelTargetDuration),o=r.length-1;o>=0;o--){var a=r[o],s=n[a];if(s){var c=s.buffered;c.length>0&&i>c.start(0)&&this.removeBufferRange(a,s,0,i)&&this.hls.trigger(u.default.LIVE_BACK_BUFFER_REACHED,{bufferEnd:i})}}else l.logger.error("flushLiveBackBuffer called without attaching media")}},i.onLevelUpdated=function(e){var t=e.details;t.fragments.length>0&&(this._levelDuration=t.totalduration+t.fragments[0].start,this._levelTargetDuration=t.averagetargetduration||t.targetduration||10,this._live=t.live,this.updateMediaElementDuration())},i.updateMediaElementDuration=function(){var e,t=this.config;if(null!==this._levelDuration&&this.media&&this.mediaSource&&this.sourceBuffer&&0!==this.media.readyState&&"open"===this.mediaSource.readyState){for(var n in this.sourceBuffer){var r=this.sourceBuffer[n];if(r&&!0===r.updating)return}e=this.media.duration,null===this._msDuration&&(this._msDuration=this.mediaSource.duration),!0===this._live&&!0===t.liveDurationInfinity?(l.logger.log("Media Source duration is set to Infinity"),this._msDuration=this.mediaSource.duration=1/0):(this._levelDuration>this._msDuration&&this._levelDuration>e||!Object(c.isFiniteNumber)(e))&&(l.logger.log("Updating Media Source duration to "+this._levelDuration.toFixed(3)),this._msDuration=this.mediaSource.duration=this._levelDuration)}},i.doFlush=function(){for(;this.flushRange.length;){var e=this.flushRange[0];if(!this.flushBuffer(e.start,e.end,e.type))return void(this._needsFlush=!0);this.flushRange.shift(),this.flushBufferCounter=0}if(0===this.flushRange.length){this._needsFlush=!1;var t=0,n=this.sourceBuffer;try{for(var r in n){var i=n[r];i&&(t+=i.buffered.length)}}catch(e){l.logger.error("error while accessing sourceBuffer.buffered")}this.appended=t,this.hls.trigger(u.default.BUFFER_FLUSHED)}},i.doAppending=function(){var e=this.config,t=this.hls,n=this.segments,r=this.sourceBuffer;if(Object.keys(r).length){if(!this.media||this.media.error)return this.segments=[],void l.logger.error("trying to append although a media error occured, flush segment and abort");if(!this.appending){var i=n.shift();if(i)try{var o=r[i.type];if(!o)return void this._onSBUpdateEnd();if(o.updating)return void n.unshift(i);o.ended=!1,this.parent=i.parent,o.appendBuffer(i.data),this.appendError=0,this.appended++,this.appending=!0}catch(r){l.logger.error("error while trying to append buffer:"+r.message),n.unshift(i);var a={type:s.ErrorTypes.MEDIA_ERROR,parent:i.parent,details:"",fatal:!1};22===r.code?(this.segments=[],a.details=s.ErrorDetails.BUFFER_FULL_ERROR):(this.appendError++,a.details=s.ErrorDetails.BUFFER_APPEND_ERROR,this.appendError>e.appendErrorMaxRetry&&(l.logger.log("fail "+e.appendErrorMaxRetry+" times to append segment in sourceBuffer"),this.segments=[],a.fatal=!0)),t.trigger(u.default.ERROR,a)}}}},i.flushBuffer=function(e,t,n){var r=this.sourceBuffer;if(!Object.keys(r).length)return!0;var i="null";if(this.media&&(i=this.media.currentTime.toFixed(3)),l.logger.log("flushBuffer,pos/start/end: "+i+"/"+e+"/"+t),this.flushBufferCounter>=this.appended)return l.logger.warn("abort flushing too many retries"),!0;var o=r[n];if(o){if(o.ended=!1,o.updating)return l.logger.warn("cannot flush, sb updating in progress"),!1;if(this.removeBufferRange(n,o,e,t))return this.flushBufferCounter++,!1}return l.logger.log("buffer flushed"),!0},i.removeBufferRange=function(e,t,n,r){try{for(var i=0;i<t.buffered.length;i++){var o=t.buffered.start(i),a=t.buffered.end(i),s=Math.max(o,n),c=Math.min(a,r);if(Math.min(c,a)-s>.5){var u="null";return this.media&&(u=this.media.currentTime.toString()),l.logger.log("sb remove "+e+" ["+s+","+c+"], of ["+o+","+a+"], pos:"+u),t.remove(s,c),!0}}}catch(e){l.logger.warn("removeBufferRange failed",e)}return!1},r}(h);function qe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var We=function(e){var t,n;function r(t){var n;return(n=e.call(this,t,u.default.FPS_DROP_LEVEL_CAPPING,u.default.MEDIA_ATTACHING,u.default.MANIFEST_PARSED,u.default.LEVELS_UPDATED,u.default.BUFFER_CODECS,u.default.MEDIA_DETACHING)||this).autoLevelCapping=Number.POSITIVE_INFINITY,n.firstLevel=null,n.levels=[],n.media=null,n.restrictedLevels=[],n.timer=null,n.clientRect=null,n}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var i,o,a,s=r.prototype;return s.destroy=function(){this.hls.config.capLevelToPlayerSize&&(this.media=null,this.clientRect=null,this.stopCapping())},s.onFpsDropLevelCapping=function(e){r.isLevelAllowed(e.droppedLevel,this.restrictedLevels)&&this.restrictedLevels.push(e.droppedLevel)},s.onMediaAttaching=function(e){this.media=e.media instanceof window.HTMLVideoElement?e.media:null},s.onManifestParsed=function(e){var t=this.hls;this.restrictedLevels=[],this.levels=e.levels,this.firstLevel=e.firstLevel,t.config.capLevelToPlayerSize&&e.video&&this.startCapping()},s.onBufferCodecs=function(e){this.hls.config.capLevelToPlayerSize&&e.video&&this.startCapping()},s.onLevelsUpdated=function(e){this.levels=e.levels},s.onMediaDetaching=function(){this.stopCapping()},s.detectPlayerSize=function(){if(this.media){var e=this.levels?this.levels.length:0;if(e){var t=this.hls;t.autoLevelCapping=this.getMaxLevel(e-1),t.autoLevelCapping>this.autoLevelCapping&&t.streamController.nextLevelSwitch(),this.autoLevelCapping=t.autoLevelCapping}}},s.getMaxLevel=function(e){var t=this;if(!this.levels)return-1;var n=this.levels.filter((function(n,i){return r.isLevelAllowed(i,t.restrictedLevels)&&i<=e}));return this.clientRect=null,r.getMaxLevelByMediaSize(n,this.mediaWidth,this.mediaHeight)},s.startCapping=function(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,this.hls.firstLevel=this.getMaxLevel(this.firstLevel),clearInterval(this.timer),this.timer=setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())},s.stopCapping=function(){this.restrictedLevels=[],this.firstLevel=null,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(this.timer=clearInterval(this.timer),this.timer=null)},s.getDimensions=function(){if(this.clientRect)return this.clientRect;var e=this.media,t={width:0,height:0};if(e){var n=e.getBoundingClientRect();t.width=n.width,t.height=n.height,t.width||t.height||(t.width=n.right-n.left||e.width||0,t.height=n.bottom-n.top||e.height||0)}return this.clientRect=t,t},r.isLevelAllowed=function(e,t){return void 0===t&&(t=[]),-1===t.indexOf(e)},r.getMaxLevelByMediaSize=function(e,t,n){if(!e||e&&!e.length)return-1;for(var r,i,o=e.length-1,a=0;a<e.length;a+=1){var s=e[a];if((s.width>=t||s.height>=n)&&(r=s,!(i=e[a+1])||r.width!==i.width||r.height!==i.height)){o=a;break}}return o},i=r,a=[{key:"contentScaleFactor",get:function(){var e=1;try{e=window.devicePixelRatio}catch(e){}return e}}],(o=[{key:"mediaWidth",get:function(){return this.getDimensions().width*r.contentScaleFactor}},{key:"mediaHeight",get:function(){return this.getDimensions().height*r.contentScaleFactor}}])&&qe(i.prototype,o),a&&qe(i,a),r}(h);var Xe=window.performance,Je=function(e){var t,n;function r(t){return e.call(this,t,u.default.MEDIA_ATTACHING)||this}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var i=r.prototype;return i.destroy=function(){this.timer&&clearInterval(this.timer),this.isVideoPlaybackQualityAvailable=!1},i.onMediaAttaching=function(e){var t=this.hls.config;t.capLevelOnFPSDrop&&("function"==typeof(this.video=e.media instanceof window.HTMLVideoElement?e.media:null).getVideoPlaybackQuality&&(this.isVideoPlaybackQualityAvailable=!0),clearInterval(this.timer),this.timer=setInterval(this.checkFPSInterval.bind(this),t.fpsDroppedMonitoringPeriod))},i.checkFPS=function(e,t,n){var r=Xe.now();if(t){if(this.lastTime){var i=r-this.lastTime,o=n-this.lastDroppedFrames,a=t-this.lastDecodedFrames,s=1e3*o/i,c=this.hls;if(c.trigger(u.default.FPS_DROP,{currentDropped:o,currentDecoded:a,totalDroppedFrames:n}),s>0&&o>c.config.fpsDroppedMonitoringThreshold*a){var d=c.currentLevel;l.logger.warn("drop FPS ratio greater than max allowed value for currentLevel: "+d),d>0&&(-1===c.autoLevelCapping||c.autoLevelCapping>=d)&&(d-=1,c.trigger(u.default.FPS_DROP_LEVEL_CAPPING,{level:d,droppedLevel:c.currentLevel}),c.autoLevelCapping=d,c.streamController.nextLevelSwitch())}}this.lastTime=r,this.lastDroppedFrames=n,this.lastDecodedFrames=t}},i.checkFPSInterval=function(){var e=this.video;if(e)if(this.isVideoPlaybackQualityAvailable){var t=e.getVideoPlaybackQuality();this.checkFPS(e,t.totalVideoFrames,t.droppedVideoFrames)}else this.checkFPS(e,e.webkitDecodedFrameCount,e.webkitDroppedFrameCount)},r}(h),Ye=function(){function e(e){e&&e.xhrSetup&&(this.xhrSetup=e.xhrSetup)}var t=e.prototype;return t.destroy=function(){this.abort(),this.loader=null},t.abort=function(){var e=this.loader;e&&4!==e.readyState&&(this.stats.aborted=!0,e.abort()),window.clearTimeout(this.requestTimeout),this.requestTimeout=null,window.clearTimeout(this.retryTimeout),this.retryTimeout=null},t.load=function(e,t,n){this.context=e,this.config=t,this.callbacks=n,this.stats={trequest:window.performance.now(),retry:0},this.retryDelay=t.retryDelay,this.loadInternal()},t.loadInternal=function(){var e,t=this.context;e=this.loader=new window.XMLHttpRequest;var n=this.stats;n.tfirst=0,n.loaded=0;var r=this.xhrSetup;try{if(r)try{r(e,t.url)}catch(n){e.open("GET",t.url,!0),r(e,t.url)}e.readyState||e.open("GET",t.url,!0)}catch(n){return void this.callbacks.onError({code:e.status,text:n.message},t,e)}t.rangeEnd&&e.setRequestHeader("Range","bytes="+t.rangeStart+"-"+(t.rangeEnd-1)),e.onreadystatechange=this.readystatechange.bind(this),e.onprogress=this.loadprogress.bind(this),e.responseType=t.responseType,this.requestTimeout=window.setTimeout(this.loadtimeout.bind(this),this.config.timeout),e.send()},t.readystatechange=function(e){var t=e.currentTarget,n=t.readyState,r=this.stats,i=this.context,o=this.config;if(!r.aborted&&n>=2)if(window.clearTimeout(this.requestTimeout),0===r.tfirst&&(r.tfirst=Math.max(window.performance.now(),r.trequest)),4===n){var a=t.status;if(a>=200&&a<300){var s,c;r.tload=Math.max(r.tfirst,window.performance.now()),c="arraybuffer"===i.responseType?(s=t.response).byteLength:(s=t.responseText).length,r.loaded=r.total=c;var u={url:t.responseURL,data:s};this.callbacks.onSuccess(u,r,i,t)}else r.retry>=o.maxRetry||a>=400&&a<499?(l.logger.error(a+" while loading "+i.url),this.callbacks.onError({code:a,text:t.statusText},i,t)):(l.logger.warn(a+" while loading "+i.url+", retrying in "+this.retryDelay+"..."),this.destroy(),this.retryTimeout=window.setTimeout(this.loadInternal.bind(this),this.retryDelay),this.retryDelay=Math.min(2*this.retryDelay,o.maxRetryDelay),r.retry++)}else this.requestTimeout=window.setTimeout(this.loadtimeout.bind(this),o.timeout)},t.loadtimeout=function(){l.logger.warn("timeout while loading "+this.context.url),this.callbacks.onTimeout(this.stats,this.context,null)},t.loadprogress=function(e){var t=e.currentTarget,n=this.stats;n.loaded=e.loaded,e.lengthComputable&&(n.total=e.total);var r=this.callbacks.onProgress;r&&r(n,this.context,null,t)},e}();function Ze(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var $e=function(e){var t,n;function r(t){var n;return(n=e.call(this,t,u.default.MANIFEST_LOADING,u.default.MANIFEST_PARSED,u.default.AUDIO_TRACK_LOADED,u.default.AUDIO_TRACK_SWITCHED,u.default.LEVEL_LOADED,u.default.ERROR)||this)._trackId=-1,n._selectDefaultTrack=!0,n.tracks=[],n.trackIdBlacklist=Object.create(null),n.audioGroupId=null,n}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var i,o,a,c=r.prototype;return c.onManifestLoading=function(){this.tracks=[],this._trackId=-1,this._selectDefaultTrack=!0},c.onManifestParsed=function(e){var t=this.tracks=e.audioTracks||[];this.hls.trigger(u.default.AUDIO_TRACKS_UPDATED,{audioTracks:t}),this._selectAudioGroup(this.hls.nextLoadLevel)},c.onAudioTrackLoaded=function(e){if(e.id>=this.tracks.length)l.logger.warn("Invalid audio track id:",e.id);else{if(l.logger.log("audioTrack "+e.id+" loaded"),this.tracks[e.id].details=e.details,e.details.live&&!this.hasInterval()){var t=1e3*e.details.targetduration;this.setInterval(t)}!e.details.live&&this.hasInterval()&&this.clearInterval()}},c.onAudioTrackSwitched=function(e){var t=this.tracks[e.id].groupId;t&&this.audioGroupId!==t&&(this.audioGroupId=t)},c.onLevelLoaded=function(e){this._selectAudioGroup(e.level)},c.onError=function(e){e.type===s.ErrorTypes.NETWORK_ERROR&&(e.fatal&&this.clearInterval(),e.details===s.ErrorDetails.AUDIO_TRACK_LOAD_ERROR&&(l.logger.warn("Network failure on audio-track id:",e.context.id),this._handleLoadError()))},c._setAudioTrack=function(e){if(this._trackId===e&&this.tracks[this._trackId].details)l.logger.debug("Same id as current audio-track passed, and track details available -> no-op");else if(e<0||e>=this.tracks.length)l.logger.warn("Invalid id passed to audio-track controller");else{var t=this.tracks[e];l.logger.log("Now switching to audio-track index "+e),this.clearInterval(),this._trackId=e;var n=t.url,r=t.type,i=t.id;this.hls.trigger(u.default.AUDIO_TRACK_SWITCHING,{id:i,type:r,url:n}),this._loadTrackDetailsIfNeeded(t)}},c.doTick=function(){this._updateTrack(this._trackId)},c._selectAudioGroup=function(e){var t=this.hls.levels[e];if(t&&t.audioGroupIds){var n=t.audioGroupIds[t.urlId];this.audioGroupId!==n&&(this.audioGroupId=n,this._selectInitialAudioTrack())}},c._selectInitialAudioTrack=function(){var e=this,t=this.tracks;if(t.length){var n=this.tracks[this._trackId],r=null;if(n&&(r=n.name),this._selectDefaultTrack){var i=t.filter((function(e){return e.default}));i.length?t=i:l.logger.warn("No default audio tracks defined")}var o=!1,a=function(){t.forEach((function(t){o||e.audioGroupId&&t.groupId!==e.audioGroupId||r&&r!==t.name||(e._setAudioTrack(t.id),o=!0)}))};a(),o||(r=null,a()),o||(l.logger.error("No track found for running audio group-ID: "+this.audioGroupId),this.hls.trigger(u.default.ERROR,{type:s.ErrorTypes.MEDIA_ERROR,details:s.ErrorDetails.AUDIO_TRACK_LOAD_ERROR,fatal:!0}))}},c._needsTrackLoading=function(e){var t=e.details,n=e.url;return!(t&&!t.live)&&!!n},c._loadTrackDetailsIfNeeded=function(e){if(this._needsTrackLoading(e)){var t=e.url,n=e.id;l.logger.log("loading audio-track playlist for id: "+n),this.hls.trigger(u.default.AUDIO_TRACK_LOADING,{url:t,id:n})}},c._updateTrack=function(e){if(!(e<0||e>=this.tracks.length)){this.clearInterval(),this._trackId=e,l.logger.log("trying to update audio-track "+e);var t=this.tracks[e];this._loadTrackDetailsIfNeeded(t)}},c._handleLoadError=function(){this.trackIdBlacklist[this._trackId]=!0;var e=this._trackId,t=this.tracks[e],n=t.name,r=t.language,i=t.groupId;l.logger.warn("Loading failed on audio track id: "+e+", group-id: "+i+', name/language: "'+n+'" / "'+r+'"');for(var o=e,a=0;a<this.tracks.length;a++){if(!this.trackIdBlacklist[a])if(this.tracks[a].name===n){o=a;break}}o!==e?(l.logger.log("Attempting audio-track fallback id:",o,"group-id:",this.tracks[o].groupId),this._setAudioTrack(o)):l.logger.warn('No fallback audio-track found for name/language: "'+n+'" / "'+r+'"')},i=r,(o=[{key:"audioTracks",get:function(){return this.tracks}},{key:"audioTrack",get:function(){return this._trackId},set:function(e){this._setAudioTrack(e),this._selectDefaultTrack=!1}}])&&Ze(i.prototype,o),a&&Ze(i,a),r}(pe);function et(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var tt=window.performance,nt=function(e){var t,n;function r(t,n){var r;return(r=e.call(this,t,u.default.MEDIA_ATTACHED,u.default.MEDIA_DETACHING,u.default.AUDIO_TRACKS_UPDATED,u.default.AUDIO_TRACK_SWITCHING,u.default.AUDIO_TRACK_LOADED,u.default.KEY_LOADED,u.default.FRAG_LOADED,u.default.FRAG_PARSING_INIT_SEGMENT,u.default.FRAG_PARSING_DATA,u.default.FRAG_PARSED,u.default.ERROR,u.default.BUFFER_RESET,u.default.BUFFER_CREATED,u.default.BUFFER_APPENDED,u.default.BUFFER_FLUSHED,u.default.INIT_PTS_FOUND)||this).fragmentTracker=n,r.config=t.config,r.audioCodecSwap=!1,r._state=Ae,r.initPTS=[],r.waitingFragment=null,r.videoTrackCC=null,r.waitingVideoCC=null,r}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var i,o,a,d=r.prototype;return d.onInitPtsFound=function(e){var t=e.id,n=e.frag.cc,r=e.initPTS;"main"===t&&(this.initPTS[n]=r,this.videoTrackCC=n,l.logger.log("InitPTS for cc: "+n+" found from main: "+r),this.state===Ie&&this.tick())},d.startLoad=function(e){if(this.tracks){var t=this.lastCurrentTime;this.stopLoad(),this.setInterval(100),this.fragLoadError=0,t>0&&-1===e?(l.logger.log("audio:override startPosition with lastCurrentTime @"+t.toFixed(3)),this.state=ve):(this.lastCurrentTime=this.startPosition?this.startPosition:e,this.state=ge),this.nextLoadPosition=this.startPosition=this.lastCurrentTime,this.tick()}else this.startPosition=e,this.state=Ae},d.doTick=function(){var e,t,n,r=this.hls,i=r.config;switch(this.state){case Ce:case me:case Te:break;case ge:this.state=_e,this.loadedmetadata=!1;break;case ve:var o=this.tracks;if(!o)break;if(!this.media&&(this.startFragRequested||!i.startFragPrefetch))break;if(this.loadedmetadata)e=this.media.currentTime;else if(void 0===(e=this.nextLoadPosition))break;var a=this.mediaBuffer?this.mediaBuffer:this.media,s=this.videoBuffer?this.videoBuffer:this.media,d=e<i.maxBufferHole?Math.max(2,i.maxBufferHole):i.maxBufferHole,h=Q.bufferInfo(a,e,d),f=Q.bufferInfo(s,e,d),p=h.len,A=h.end,g=this.fragPrevious,v=Math.min(i.maxBufferLength,i.maxMaxBufferLength),m=Math.max(v,f.len),y=this.audioSwitch,b=this.trackId;if((p<m||y)&&b<o.length){if(void 0===(n=o[b].details)){this.state=_e;break}if(!y&&this._streamEnded(h,n))return this.hls.trigger(u.default.BUFFER_EOS,{type:"audio"}),void(this.state=Re);var E,_=n.fragments,w=_.length,S=_[0].start,T=_[w-1].start+_[w-1].duration;if(y)if(n.live&&!n.PTSKnown)l.logger.log("switching audiotrack, live stream, unknown PTS,load first fragment"),A=0;else if(A=e,n.PTSKnown&&e<S){if(!(h.end>S||h.nextStart))return;l.logger.log("alt audio track ahead of main track, seek to start of alt audio track"),this.media.currentTime=S+.05}if(n.initSegment&&!n.initSegment.data)E=n.initSegment;else if(A<=S){if(E=_[0],null!==this.videoTrackCC&&E.cc!==this.videoTrackCC&&(E=function(e,t){return V.search(e,(function(e){return e.cc<t?1:e.cc>t?-1:0}))}(_,this.videoTrackCC)),n.live&&E.loadIdx&&E.loadIdx===this.fragLoadIdx){var R=h.nextStart?h.nextStart:S;return l.logger.log("no alt audio available @currentTime:"+this.media.currentTime+", seeking @"+(R+.05)),void(this.media.currentTime=R+.05)}}else{var C,I=i.maxFragLookUpTolerance,x=g?_[g.sn-_[0].sn+1]:void 0;A<T?(A>T-I&&(I=0),C=x&&!le(A,I,x)?x:V.search(_,(function(e){return le(A,I,e)}))):C=_[w-1],C&&(E=C,S=C.start,g&&E.level===g.level&&E.sn===g.sn&&(E.sn<n.endSN?(E=_[E.sn+1-n.startSN],this.fragmentTracker.getState(E)!==H&&l.logger.log("SN just loaded, load next one: "+E.sn)):E=null))}E&&(E.encrypted?(l.logger.log("Loading key for "+E.sn+" of ["+n.startSN+" ,"+n.endSN+"],track "+b),this.state=ye,r.trigger(u.default.KEY_LOADING,{frag:E})):(this.fragCurrent=E,(y||this.fragmentTracker.getState(E)===D)&&(l.logger.log("Loading "+E.sn+", cc: "+E.cc+" of ["+n.startSN+" ,"+n.endSN+"],track "+b+", "+(this.loadedmetadata?"currentTime":"nextLoadPosition")+": "+e+", bufferEnd: "+A.toFixed(3)),"initSegment"!==E.sn&&(this.startFragRequested=!0),Object(c.isFiniteNumber)(E.sn)&&(this.nextLoadPosition=E.start+E.duration),r.trigger(u.default.FRAG_LOADING,{frag:E}),this.state=be)))}break;case _e:(t=this.tracks[this.trackId])&&t.details&&(this.state=ve);break;case Ee:var O=tt.now(),N=this.retryDate,B=(a=this.media)&&a.seeking;(!N||O>=N||B)&&(l.logger.log("audioStreamController: retryDate reached, switch back to IDLE state"),this.state=ve);break;case Ie:var M=this.waitingFragment;if(M){var L=M.frag.cc;if(void 0!==this.initPTS[L])this.waitingFragment=null,this.state=be,this.onFragLoaded(M);else if(this.videoTrackCC!==this.waitingVideoCC)l.logger.log("Waiting fragment cc ("+L+") cancelled because video is at cc "+this.videoTrackCC),this.clearWaitingFragment();else{var k=Q.bufferInfo(this.mediaBuffer,this.media.currentTime,i.maxBufferHole);le(k.end,i.maxFragLookUpTolerance,M.frag)<0&&(l.logger.log("Waiting fragment cc ("+L+") @ "+M.frag.start+" cancelled because another fragment at "+k.end+" is needed"),this.clearWaitingFragment())}}else this.state=ve}},d.clearWaitingFragment=function(){var e=this.waitingFragment;e&&(this.fragmentTracker.removeFragment(e.frag),this.waitingFragment=null,this.waitingVideoCC=null,this.state=ve)},d.onMediaAttached=function(e){var t=this.media=this.mediaBuffer=e.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvended=this.onMediaEnded.bind(this),t.addEventListener("seeking",this.onvseeking),t.addEventListener("ended",this.onvended);var n=this.config;this.tracks&&n.autoStartLoad&&this.startLoad(n.startPosition)},d.onMediaDetaching=function(){var e=this.media;e&&e.ended&&(l.logger.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),e&&(e.removeEventListener("seeking",this.onvseeking),e.removeEventListener("ended",this.onvended),this.onvseeking=this.onvseeked=this.onvended=null),this.media=this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()},d.onAudioTracksUpdated=function(e){l.logger.log("audio tracks updated"),this.tracks=e.audioTracks},d.onAudioTrackSwitching=function(e){var t=!!e.url;this.trackId=e.id,this.fragCurrent=null,this.clearWaitingFragment(),this.state=me,t?this.setInterval(100):this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),t&&(this.audioSwitch=!0,this.state=ve),this.tick()},d.onAudioTrackLoaded=function(e){var t=e.details,n=e.id,r=this.tracks[n],i=t.totalduration,o=0;if(l.logger.log("track "+n+" loaded ["+t.startSN+","+t.endSN+"],duration:"+i),t.live){var a=r.details;a&&t.fragments.length>0?(ne(a,t),o=t.fragments[0].start,t.PTSKnown?l.logger.log("live audio playlist sliding:"+o.toFixed(3)):l.logger.log("live audio playlist - outdated PTS, unknown sliding")):(t.PTSKnown=!1,l.logger.log("live audio playlist - first load, unknown sliding"))}else t.PTSKnown=!1;if(r.details=t,!this.startFragRequested){if(-1===this.startPosition){var s=t.startTimeOffset;Object(c.isFiniteNumber)(s)?(l.logger.log("start time offset found in playlist, adjust startPosition to "+s),this.startPosition=s):t.live?(this.startPosition=this.computeLivePosition(o,t),l.logger.log("compute startPosition for audio-track to "+this.startPosition)):this.startPosition=0}this.nextLoadPosition=this.startPosition}this.state===_e&&(this.state=ve),this.tick()},d.onKeyLoaded=function(){this.state===ye&&(this.state=ve,this.tick())},d.onFragLoaded=function(e){var t=this.fragCurrent,n=e.frag;if(this.state===be&&t&&"audio"===n.type&&n.level===t.level&&n.sn===t.sn){var r=this.tracks[this.trackId],i=r.details,o=i.totalduration,a=t.level,s=t.sn,c=t.cc,d=this.config.defaultAudioCodec||r.audioCodec||"mp4a.40.2",h=this.stats=e.stats;if("initSegment"===s)this.state=ve,h.tparsed=h.tbuffered=tt.now(),i.initSegment.data=e.payload,this.hls.trigger(u.default.FRAG_BUFFERED,{stats:h,frag:t,id:"audio"}),this.tick();else{this.state=we,this.appended=!1,this.demuxer||(this.demuxer=new Z(this.hls,"audio"));var f=this.initPTS[c],p=i.initSegment?i.initSegment.data:[];if(void 0!==f){this.pendingBuffering=!0,l.logger.log("Demuxing "+s+" of ["+i.startSN+" ,"+i.endSN+"],track "+a);this.demuxer.push(e.payload,p,d,null,t,o,!1,f)}else l.logger.log("Unknown video PTS for cc "+c+", waiting for video PTS before demuxing audio frag "+s+" of ["+i.startSN+" ,"+i.endSN+"],track "+a),this.waitingFragment=e,this.waitingVideoCC=this.videoTrackCC,this.state=Ie}}this.fragLoadError=0},d.onFragParsingInitSegment=function(e){var t=this.fragCurrent,n=e.frag;if(t&&"audio"===e.id&&n.sn===t.sn&&n.level===t.level&&this.state===we){var r,i=e.tracks;if(i.video&&delete i.video,r=i.audio){r.levelCodec=r.codec,r.id=e.id,this.hls.trigger(u.default.BUFFER_CODECS,i),l.logger.log("audio track:audio,container:"+r.container+",codecs[level/parsed]=["+r.levelCodec+"/"+r.codec+"]");var o=r.initSegment;if(o){var a={type:"audio",data:o,parent:"audio",content:"initSegment"};this.audioSwitch?this.pendingData=[a]:(this.appended=!0,this.pendingBuffering=!0,this.hls.trigger(u.default.BUFFER_APPENDING,a))}this.tick()}}},d.onFragParsingData=function(e){var t=this,n=this.fragCurrent,r=e.frag;if(n&&"audio"===e.id&&"audio"===e.type&&r.sn===n.sn&&r.level===n.level&&this.state===we){var i=this.trackId,o=this.tracks[i],a=this.hls;Object(c.isFiniteNumber)(e.endPTS)||(e.endPTS=e.startPTS+n.duration,e.endDTS=e.startDTS+n.duration),n.addElementaryStream(A.AUDIO),l.logger.log("parsed "+e.type+",PTS:["+e.startPTS.toFixed(3)+","+e.endPTS.toFixed(3)+"],DTS:["+e.startDTS.toFixed(3)+"/"+e.endDTS.toFixed(3)+"],nb:"+e.nb),te(o.details,n,e.startPTS,e.endPTS);var d=this.media,h=!1;if(this.audioSwitch)if(d&&d.readyState){var f=d.currentTime;l.logger.log("switching audio track : currentTime:"+f),f>=e.startPTS&&(l.logger.log("switching audio track : flushing all audio"),this.state=Te,a.trigger(u.default.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"}),h=!0,this.audioSwitch=!1,a.trigger(u.default.AUDIO_TRACK_SWITCHED,{id:i}))}else this.audioSwitch=!1,a.trigger(u.default.AUDIO_TRACK_SWITCHED,{id:i});var p=this.pendingData;if(!p)return l.logger.warn("Apparently attempt to enqueue media payload without codec initialization data upfront"),void a.trigger(u.default.ERROR,{type:s.ErrorTypes.MEDIA_ERROR,details:null,fatal:!0});this.audioSwitch||([e.data1,e.data2].forEach((function(t){t&&t.length&&p.push({type:e.type,data:t,parent:"audio",content:"data"})})),!h&&p.length&&(p.forEach((function(e){t.state===we&&(t.pendingBuffering=!0,t.hls.trigger(u.default.BUFFER_APPENDING,e))})),this.pendingData=[],this.appended=!0)),this.tick()}},d.onFragParsed=function(e){var t=this.fragCurrent,n=e.frag;t&&"audio"===e.id&&n.sn===t.sn&&n.level===t.level&&this.state===we&&(this.stats.tparsed=tt.now(),this.state=Se,this._checkAppendedParsed())},d.onBufferReset=function(){this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1},d.onBufferCreated=function(e){var t=e.tracks.audio;t&&(this.mediaBuffer=t.buffer,this.loadedmetadata=!0),e.tracks.video&&(this.videoBuffer=e.tracks.video.buffer)},d.onBufferAppended=function(e){if("audio"===e.parent){var t=this.state;t!==we&&t!==Se||(this.pendingBuffering=e.pending>0,this._checkAppendedParsed())}},d._checkAppendedParsed=function(){if(!(this.state!==Se||this.appended&&this.pendingBuffering)){var e=this.fragCurrent,t=this.stats,n=this.hls;if(e){this.fragPrevious=e,t.tbuffered=tt.now(),n.trigger(u.default.FRAG_BUFFERED,{stats:t,frag:e,id:"audio"});var r=this.mediaBuffer?this.mediaBuffer:this.media;r&&l.logger.log("audio buffered : "+oe.toString(r.buffered)),this.audioSwitch&&this.appended&&(this.audioSwitch=!1,n.trigger(u.default.AUDIO_TRACK_SWITCHED,{id:this.trackId})),this.state=ve}this.tick()}},d.onError=function(e){var t=e.frag;if(!t||"audio"===t.type)switch(e.details){case s.ErrorDetails.FRAG_LOAD_ERROR:case s.ErrorDetails.FRAG_LOAD_TIMEOUT:var n=e.frag;if(n&&"audio"!==n.type)break;if(!e.fatal){var r=this.fragLoadError;r?r++:r=1;var i=this.config;if(r<=i.fragLoadingMaxRetry){this.fragLoadError=r;var o=Math.min(Math.pow(2,r-1)*i.fragLoadingRetryDelay,i.fragLoadingMaxRetryTimeout);l.logger.warn("AudioStreamController: frag loading failed, retry in "+o+" ms"),this.retryDate=tt.now()+o,this.state=Ee}else l.logger.error("AudioStreamController: "+e.details+" reaches max retry, redispatch as fatal ..."),e.fatal=!0,this.state=Ce}break;case s.ErrorDetails.AUDIO_TRACK_LOAD_ERROR:case s.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:case s.ErrorDetails.KEY_LOAD_ERROR:case s.ErrorDetails.KEY_LOAD_TIMEOUT:this.state!==Ce&&(this.state=e.fatal?Ce:ve,l.logger.warn("AudioStreamController: "+e.details+" while loading frag, now switching to "+this.state+" state ..."));break;case s.ErrorDetails.BUFFER_FULL_ERROR:if("audio"===e.parent&&(this.state===we||this.state===Se)){var a=this.mediaBuffer,c=this.media.currentTime;if(a&&Q.isBuffered(a,c)&&Q.isBuffered(a,c+.5)){var d=this.config;d.maxMaxBufferLength>=d.maxBufferLength&&(d.maxMaxBufferLength/=2,l.logger.warn("AudioStreamController: reduce max buffer length to "+d.maxMaxBufferLength+"s")),this.state=ve}else l.logger.warn("AudioStreamController: buffer full error also media.currentTime is not buffered, flush audio buffer"),this.fragCurrent=null,this.state=Te,this.hls.trigger(u.default.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"})}}},d.onBufferFlushed=function(){var e=this,t=this.pendingData;t&&t.length?(l.logger.log("AudioStreamController: appending pending audio data after buffer flushed"),t.forEach((function(t){e.hls.trigger(u.default.BUFFER_APPENDING,t)})),this.appended=!0,this.pendingData=[],this.state=Se):(this.state=ve,this.fragPrevious=null,this.tick())},i=r,(o=[{key:"state",set:function(e){if(this.state!==e){var t=this.state;this._state=e,l.logger.log("audio stream:"+t+"->"+e)}},get:function(){return this._state}}])&&et(i.prototype,o),a&&et(i,a),r}(Oe),rt=function(){if("undefined"!=typeof window&&window.VTTCue)return window.VTTCue;var e={"":!0,lr:!0,rl:!0},t={start:!0,middle:!0,end:!0,left:!0,right:!0};function n(e){return"string"==typeof e&&(!!t[e.toLowerCase()]&&e.toLowerCase())}function r(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)e[r]=n[r]}return e}function i(t,i,o){var a=this,s={enumerable:!0};a.hasBeenReset=!1;var c="",u=!1,l=t,d=i,h=o,f=null,p="",A=!0,g="auto",v="start",m=50,y="middle",b=50,E="middle";Object.defineProperty(a,"id",r({},s,{get:function(){return c},set:function(e){c=""+e}})),Object.defineProperty(a,"pauseOnExit",r({},s,{get:function(){return u},set:function(e){u=!!e}})),Object.defineProperty(a,"startTime",r({},s,{get:function(){return l},set:function(e){if("number"!=typeof e)throw new TypeError("Start time must be set to a number.");l=e,this.hasBeenReset=!0}})),Object.defineProperty(a,"endTime",r({},s,{get:function(){return d},set:function(e){if("number"!=typeof e)throw new TypeError("End time must be set to a number.");d=e,this.hasBeenReset=!0}})),Object.defineProperty(a,"text",r({},s,{get:function(){return h},set:function(e){h=""+e,this.hasBeenReset=!0}})),Object.defineProperty(a,"region",r({},s,{get:function(){return f},set:function(e){f=e,this.hasBeenReset=!0}})),Object.defineProperty(a,"vertical",r({},s,{get:function(){return p},set:function(t){var n=function(t){return"string"==typeof t&&!!e[t.toLowerCase()]&&t.toLowerCase()}(t);if(!1===n)throw new SyntaxError("An invalid or illegal string was specified.");p=n,this.hasBeenReset=!0}})),Object.defineProperty(a,"snapToLines",r({},s,{get:function(){return A},set:function(e){A=!!e,this.hasBeenReset=!0}})),Object.defineProperty(a,"line",r({},s,{get:function(){return g},set:function(e){if("number"!=typeof e&&"auto"!==e)throw new SyntaxError("An invalid number or illegal string was specified.");g=e,this.hasBeenReset=!0}})),Object.defineProperty(a,"lineAlign",r({},s,{get:function(){return v},set:function(e){var t=n(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");v=t,this.hasBeenReset=!0}})),Object.defineProperty(a,"position",r({},s,{get:function(){return m},set:function(e){if(e<0||e>100)throw new Error("Position must be between 0 and 100.");m=e,this.hasBeenReset=!0}})),Object.defineProperty(a,"positionAlign",r({},s,{get:function(){return y},set:function(e){var t=n(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");y=t,this.hasBeenReset=!0}})),Object.defineProperty(a,"size",r({},s,{get:function(){return b},set:function(e){if(e<0||e>100)throw new Error("Size must be between 0 and 100.");b=e,this.hasBeenReset=!0}})),Object.defineProperty(a,"align",r({},s,{get:function(){return E},set:function(e){var t=n(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");E=t,this.hasBeenReset=!0}})),a.displayState=void 0}return i.prototype.getCueAsHTML=function(){return window.WebVTT.convertCueToDOMTree(window,this.text)},i}(),it=function(){return{decode:function(e){if(!e)return"";if("string"!=typeof e)throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(e))}}};function ot(){this.window=window,this.state="INITIAL",this.buffer="",this.decoder=new it,this.regionList=[]}function at(){this.values=Object.create(null)}function st(e,t,n,r){var i=r?e.split(r):[e];for(var o in i)if("string"==typeof i[o]){var a=i[o].split(n);if(2===a.length)t(a[0],a[1])}}at.prototype={set:function(e,t){this.get(e)||""===t||(this.values[e]=t)},get:function(e,t,n){return n?this.has(e)?this.values[e]:t[n]:this.has(e)?this.values[e]:t},has:function(e){return e in this.values},alt:function(e,t,n){for(var r=0;r<n.length;++r)if(t===n[r]){this.set(e,t);break}},integer:function(e,t){/^-?\d+$/.test(t)&&this.set(e,parseInt(t,10))},percent:function(e,t){return!!(t.match(/^([\d]{1,3})(\.[\d]*)?%$/)&&(t=parseFloat(t))>=0&&t<=100)&&(this.set(e,t),!0)}};var ct=new rt(0,0,0),ut="middle"===ct.align?"middle":"center";function lt(e,t,n){var r=e;function i(){var t=function(e){function t(e,t,n,r){return 3600*(0|e)+60*(0|t)+(0|n)+(0|r)/1e3}var n=e.match(/^(\d+):(\d{2})(:\d{2})?\.(\d{3})/);return n?n[3]?t(n[1],n[2],n[3].replace(":",""),n[4]):n[1]>59?t(n[1],n[2],0,n[4]):t(0,n[1],n[2],n[4]):null}(e);if(null===t)throw new Error("Malformed timestamp: "+r);return e=e.replace(/^[^\sa-zA-Z-]+/,""),t}function o(){e=e.replace(/^\s+/,"")}if(o(),t.startTime=i(),o(),"--\x3e"!==e.substr(0,3))throw new Error("Malformed time stamp (time stamps must be separated by '--\x3e'): "+r);e=e.substr(3),o(),t.endTime=i(),o(),function(e,t){var r=new at;st(e,(function(e,t){switch(e){case"region":for(var i=n.length-1;i>=0;i--)if(n[i].id===t){r.set(e,n[i].region);break}break;case"vertical":r.alt(e,t,["rl","lr"]);break;case"line":var o=t.split(","),a=o[0];r.integer(e,a),r.percent(e,a)&&r.set("snapToLines",!1),r.alt(e,a,["auto"]),2===o.length&&r.alt("lineAlign",o[1],["start",ut,"end"]);break;case"position":o=t.split(","),r.percent(e,o[0]),2===o.length&&r.alt("positionAlign",o[1],["start",ut,"end","line-left","line-right","auto"]);break;case"size":r.percent(e,t);break;case"align":r.alt(e,t,["start",ut,"end","left","right"])}}),/:/,/\s/),t.region=r.get("region",null),t.vertical=r.get("vertical","");var i=r.get("line","auto");"auto"===i&&-1===ct.line&&(i=-1),t.line=i,t.lineAlign=r.get("lineAlign","start"),t.snapToLines=r.get("snapToLines",!0),t.size=r.get("size",100),t.align=r.get("align",ut);var o=r.get("position","auto");"auto"===o&&50===ct.position&&(o="start"===t.align||"left"===t.align?0:"end"===t.align||"right"===t.align?100:50),t.position=o}(e,t)}function dt(e){return e.replace(/<br(?: \/)?>/gi,"\n")}ot.prototype={parse:function(e){var t=this;function n(){var e=t.buffer,n=0;for(e=dt(e);n<e.length&&"\r"!==e[n]&&"\n"!==e[n];)++n;var r=e.substr(0,n);return"\r"===e[n]&&++n,"\n"===e[n]&&++n,t.buffer=e.substr(n),r}e&&(t.buffer+=t.decoder.decode(e,{stream:!0}));try{var r;if("INITIAL"===t.state){if(!/\r\n|\n/.test(t.buffer))return this;var i=(r=n()).match(/^(ï»¿)?WEBVTT([ \t].*)?$/);if(!i||!i[0])throw new Error("Malformed WebVTT signature.");t.state="HEADER"}for(var o=!1;t.buffer;){if(!/\r\n|\n/.test(t.buffer))return this;switch(o?o=!1:r=n(),t.state){case"HEADER":/:/.test(r)?st(r,(function(e,t){}),/:/):r||(t.state="ID");continue;case"NOTE":r||(t.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(r)){t.state="NOTE";break}if(!r)continue;if(t.cue=new rt(0,0,""),t.state="CUE",-1===r.indexOf("--\x3e")){t.cue.id=r;continue}case"CUE":try{lt(r,t.cue,t.regionList)}catch(e){t.cue=null,t.state="BADCUE";continue}t.state="CUETEXT";continue;case"CUETEXT":var a=-1!==r.indexOf("--\x3e");if(!r||a&&(o=!0)){t.oncue&&t.oncue(t.cue),t.cue=null,t.state="ID";continue}t.cue.text&&(t.cue.text+="\n"),t.cue.text+=r;continue;case"BADCUE":r||(t.state="ID");continue}}}catch(e){"CUETEXT"===t.state&&t.cue&&t.oncue&&t.oncue(t.cue),t.cue=null,t.state="INITIAL"===t.state?"BADWEBVTT":"BADCUE"}return this},flush:function(){var e=this;try{if(e.buffer+=e.decoder.decode(),(e.cue||"HEADER"===e.state)&&(e.buffer+="\n\n",e.parse()),"INITIAL"===e.state)throw new Error("Malformed WebVTT signature.")}catch(e){throw e}return e.onflush&&e.onflush(),this}};var ht=ot;function ft(e,t,n,r){for(var i,o,a,s,c,u=[],l=window.VTTCue||TextTrackCue,d=0;d<r.rows.length;d++)if(a=!0,s=0,c="",!(i=r.rows[d]).isEmpty()){for(var h=0;h<i.chars.length;h++)i.chars[h].uchar.match(/\s/)&&a?s++:(c+=i.chars[h].uchar,a=!1);i.cueStartTime=t,t===n&&(n+=1e-4),o=new l(t,n,dt(c.trim())),s>=16?s--:s++,navigator.userAgent.match(/Firefox\//)?o.line=d+1:o.line=d>7?d-2:d+1,o.align="left",o.position=Math.max(0,Math.min(100,s/32*100)),u.push(o),e&&e.addCue(o)}return u}var pt,At={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},gt=function(e){var t=e;return At.hasOwnProperty(e)&&(t=At[e]),String.fromCharCode(t)},vt=15,mt=100,yt={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},bt={17:2,18:4,21:6,22:8,23:10,19:13,20:15},Et={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},_t={25:2,26:4,29:6,30:8,31:10,27:13,28:15},wt=["white","green","blue","cyan","red","yellow","magenta","black","transparent"];!function(e){e[e.ERROR=0]="ERROR",e[e.TEXT=1]="TEXT",e[e.WARNING=2]="WARNING",e[e.INFO=2]="INFO",e[e.DEBUG=3]="DEBUG",e[e.DATA=3]="DATA"}(pt||(pt={}));var St=function(){function e(){this.time=null,this.verboseLevel=pt.ERROR}return e.prototype.log=function(e,t){this.verboseLevel>=e&&l.logger.log(this.time+" ["+e+"] "+t)},e}(),Tt=function(e){for(var t=[],n=0;n<e.length;n++)t.push(e[n].toString(16));return t},Rt=function(){function e(e,t,n,r,i){this.foreground=void 0,this.underline=void 0,this.italics=void 0,this.background=void 0,this.flash=void 0,this.foreground=e||"white",this.underline=t||!1,this.italics=n||!1,this.background=r||"black",this.flash=i||!1}var t=e.prototype;return t.reset=function(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1},t.setStyles=function(e){for(var t=["foreground","underline","italics","background","flash"],n=0;n<t.length;n++){var r=t[n];e.hasOwnProperty(r)&&(this[r]=e[r])}},t.isDefault=function(){return"white"===this.foreground&&!this.underline&&!this.italics&&"black"===this.background&&!this.flash},t.equals=function(e){return this.foreground===e.foreground&&this.underline===e.underline&&this.italics===e.italics&&this.background===e.background&&this.flash===e.flash},t.copy=function(e){this.foreground=e.foreground,this.underline=e.underline,this.italics=e.italics,this.background=e.background,this.flash=e.flash},t.toString=function(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash},e}(),Ct=function(){function e(e,t,n,r,i,o){this.uchar=void 0,this.penState=void 0,this.uchar=e||" ",this.penState=new Rt(t,n,r,i,o)}var t=e.prototype;return t.reset=function(){this.uchar=" ",this.penState.reset()},t.setChar=function(e,t){this.uchar=e,this.penState.copy(t)},t.setPenState=function(e){this.penState.copy(e)},t.equals=function(e){return this.uchar===e.uchar&&this.penState.equals(e.penState)},t.copy=function(e){this.uchar=e.uchar,this.penState.copy(e.penState)},t.isEmpty=function(){return" "===this.uchar&&this.penState.isDefault()},e}(),It=function(){function e(e){this.chars=void 0,this.pos=void 0,this.currPenState=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chars=[];for(var t=0;t<mt;t++)this.chars.push(new Ct);this.logger=e,this.pos=0,this.currPenState=new Rt}var t=e.prototype;return t.equals=function(e){for(var t=!0,n=0;n<mt;n++)if(!this.chars[n].equals(e.chars[n])){t=!1;break}return t},t.copy=function(e){for(var t=0;t<mt;t++)this.chars[t].copy(e.chars[t])},t.isEmpty=function(){for(var e=!0,t=0;t<mt;t++)if(!this.chars[t].isEmpty()){e=!1;break}return e},t.setCursor=function(e){this.pos!==e&&(this.pos=e),this.pos<0?(this.logger.log(pt.DEBUG,"Negative cursor position "+this.pos),this.pos=0):this.pos>mt&&(this.logger.log(pt.DEBUG,"Too large cursor position "+this.pos),this.pos=mt)},t.moveCursor=function(e){var t=this.pos+e;if(e>1)for(var n=this.pos+1;n<t+1;n++)this.chars[n].setPenState(this.currPenState);this.setCursor(t)},t.backSpace=function(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)},t.insertChar=function(e){e>=144&&this.backSpace();var t=gt(e);this.pos>=mt?this.logger.log(pt.ERROR,"Cannot insert "+e.toString(16)+" ("+t+") at position "+this.pos+". Skipping it!"):(this.chars[this.pos].setChar(t,this.currPenState),this.moveCursor(1))},t.clearFromPos=function(e){var t;for(t=e;t<mt;t++)this.chars[t].reset()},t.clear=function(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()},t.clearToEndOfRow=function(){this.clearFromPos(this.pos)},t.getTextString=function(){for(var e=[],t=!0,n=0;n<mt;n++){var r=this.chars[n].uchar;" "!==r&&(t=!1),e.push(r)}return t?"":e.join("")},t.setPenStyles=function(e){this.currPenState.setStyles(e),this.chars[this.pos].setPenState(this.currPenState)},e}(),xt=function(){function e(e){this.rows=void 0,this.currRow=void 0,this.nrRollUpRows=void 0,this.lastOutputScreen=void 0,this.logger=void 0,this.rows=[];for(var t=0;t<vt;t++)this.rows.push(new It(e));this.logger=e,this.currRow=14,this.nrRollUpRows=null,this.lastOutputScreen=null,this.reset()}var t=e.prototype;return t.reset=function(){for(var e=0;e<vt;e++)this.rows[e].clear();this.currRow=14},t.equals=function(e){for(var t=!0,n=0;n<vt;n++)if(!this.rows[n].equals(e.rows[n])){t=!1;break}return t},t.copy=function(e){for(var t=0;t<vt;t++)this.rows[t].copy(e.rows[t])},t.isEmpty=function(){for(var e=!0,t=0;t<vt;t++)if(!this.rows[t].isEmpty()){e=!1;break}return e},t.backSpace=function(){this.rows[this.currRow].backSpace()},t.clearToEndOfRow=function(){this.rows[this.currRow].clearToEndOfRow()},t.insertChar=function(e){this.rows[this.currRow].insertChar(e)},t.setPen=function(e){this.rows[this.currRow].setPenStyles(e)},t.moveCursor=function(e){this.rows[this.currRow].moveCursor(e)},t.setCursor=function(e){this.logger.log(pt.INFO,"setCursor: "+e),this.rows[this.currRow].setCursor(e)},t.setPAC=function(e){this.logger.log(pt.INFO,"pacData = "+JSON.stringify(e));var t=e.row-1;if(this.nrRollUpRows&&t<this.nrRollUpRows-1&&(t=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==t){for(var n=0;n<vt;n++)this.rows[n].clear();var r=this.currRow+1-this.nrRollUpRows,i=this.lastOutputScreen;if(i){var o=i.rows[r].cueStartTime,a=this.logger.time;if(o&&null!==a&&o<a)for(var s=0;s<this.nrRollUpRows;s++)this.rows[t-this.nrRollUpRows+s+1].copy(i.rows[r+s])}}this.currRow=t;var c=this.rows[this.currRow];if(null!==e.indent){var u=e.indent,l=Math.max(u-1,0);c.setCursor(e.indent),e.color=c.chars[l].penState.foreground}var d={foreground:e.color,underline:e.underline,italics:e.italics,background:"black",flash:!1};this.setPen(d)},t.setBkgData=function(e){this.logger.log(pt.INFO,"bkgData = "+JSON.stringify(e)),this.backSpace(),this.setPen(e),this.insertChar(32)},t.setRollUpRows=function(e){this.nrRollUpRows=e},t.rollUp=function(){if(null!==this.nrRollUpRows){this.logger.log(pt.TEXT,this.getDisplayText());var e=this.currRow+1-this.nrRollUpRows,t=this.rows.splice(e,1)[0];t.clear(),this.rows.splice(this.currRow,0,t),this.logger.log(pt.INFO,"Rolling up")}else this.logger.log(pt.DEBUG,"roll_up but nrRollUpRows not set yet")},t.getDisplayText=function(e){e=e||!1;for(var t=[],n="",r=-1,i=0;i<vt;i++){var o=this.rows[i].getTextString();o&&(r=i+1,e?t.push("Row "+r+": '"+o+"'"):t.push(o.trim()))}return t.length>0&&(n=e?"["+t.join(" | ")+"]":t.join("\n")),n},t.getTextAndFormat=function(){return this.rows},e}(),Ot=function(){function e(e,t,n){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=e,this.outputFilter=t,this.mode=null,this.verbose=0,this.displayedMemory=new xt(n),this.nonDisplayedMemory=new xt(n),this.lastOutputScreen=new xt(n),this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=n}var t=e.prototype;return t.reset=function(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null},t.getHandler=function(){return this.outputFilter},t.setHandler=function(e){this.outputFilter=e},t.setPAC=function(e){this.writeScreen.setPAC(e)},t.setBkgData=function(e){this.writeScreen.setBkgData(e)},t.setMode=function(e){e!==this.mode&&(this.mode=e,this.logger.log(pt.INFO,"MODE="+e),"MODE_POP-ON"===this.mode?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),"MODE_ROLL-UP"!==this.mode&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=e)},t.insertChars=function(e){for(var t=0;t<e.length;t++)this.writeScreen.insertChar(e[t]);var n=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(pt.INFO,n+": "+this.writeScreen.getDisplayText(!0)),"MODE_PAINT-ON"!==this.mode&&"MODE_ROLL-UP"!==this.mode||(this.logger.log(pt.TEXT,"DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())},t.ccRCL=function(){this.logger.log(pt.INFO,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")},t.ccBS=function(){this.logger.log(pt.INFO,"BS - BackSpace"),"MODE_TEXT"!==this.mode&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())},t.ccAOF=function(){},t.ccAON=function(){},t.ccDER=function(){this.logger.log(pt.INFO,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()},t.ccRU=function(e){this.logger.log(pt.INFO,"RU("+e+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(e)},t.ccFON=function(){this.logger.log(pt.INFO,"FON - Flash On"),this.writeScreen.setPen({flash:!0})},t.ccRDC=function(){this.logger.log(pt.INFO,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")},t.ccTR=function(){this.logger.log(pt.INFO,"TR"),this.setMode("MODE_TEXT")},t.ccRTD=function(){this.logger.log(pt.INFO,"RTD"),this.setMode("MODE_TEXT")},t.ccEDM=function(){this.logger.log(pt.INFO,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)},t.ccCR=function(){this.logger.log(pt.INFO,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)},t.ccENM=function(){this.logger.log(pt.INFO,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()},t.ccEOC=function(){if(this.logger.log(pt.INFO,"EOC - End Of Caption"),"MODE_POP-ON"===this.mode){var e=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=e,this.writeScreen=this.nonDisplayedMemory,this.logger.log(pt.TEXT,"DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(!0)},t.ccTO=function(e){this.logger.log(pt.INFO,"TO("+e+") - Tab Offset"),this.writeScreen.moveCursor(e)},t.ccMIDROW=function(e){var t={flash:!1};if(t.underline=e%2==1,t.italics=e>=46,t.italics)t.foreground="white";else{var n=Math.floor(e/2)-16;t.foreground=["white","green","blue","cyan","red","yellow","magenta"][n]}this.logger.log(pt.INFO,"MIDROW: "+JSON.stringify(t)),this.writeScreen.setPen(t)},t.outputDataUpdate=function(e){void 0===e&&(e=!1);var t=this.logger.time;null!==t&&this.outputFilter&&(null!==this.cueStartTime||this.displayedMemory.isEmpty()?this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,t,this.lastOutputScreen),e&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:t):this.cueStartTime=t,this.lastOutputScreen.copy(this.displayedMemory))},t.cueSplitAtTime=function(e){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.displayedMemory),this.cueStartTime=e))},e}();function Nt(e,t,n){n.a=e,n.b=t}function Bt(e,t,n){return n.a===e&&n.b===t}var Mt=function(){function e(e,t,n){this.channels=void 0,this.currentChannel=0,this.cmdHistory=void 0,this.logger=void 0;var r=new St;this.channels=[null,new Ot(e,t,r),new Ot(e+1,n,r)],this.cmdHistory={a:null,b:null},this.logger=r}var t=e.prototype;return t.getHandler=function(e){return this.channels[e].getHandler()},t.setHandler=function(e,t){this.channels[e].setHandler(t)},t.addData=function(e,t){var n,r,i,o=!1;this.logger.time=e;for(var a=0;a<t.length;a+=2)if(r=127&t[a],i=127&t[a+1],0!==r||0!==i){if(this.logger.log(pt.DATA,"["+Tt([t[a],t[a+1]])+"] -> ("+Tt([r,i])+")"),(n=this.parseCmd(r,i))||(n=this.parseMidrow(r,i)),n||(n=this.parsePAC(r,i)),n||(n=this.parseBackgroundAttributes(r,i)),!n&&(o=this.parseChars(r,i))){var s=this.currentChannel;if(s&&s>0)this.channels[s].insertChars(o);else this.logger.log(pt.WARNING,"No channel found yet. TEXT-MODE?")}n||o||this.logger.log(pt.WARNING,"Couldn't parse cleaned data "+Tt([r,i])+" orig: "+Tt([t[a],t[a+1]]))}},t.parseCmd=function(e,t){var n=this.cmdHistory;if(!((20===e||28===e||21===e||29===e)&&t>=32&&t<=47)&&!((23===e||31===e)&&t>=33&&t<=35))return!1;if(Bt(e,t,n))return Nt(null,null,n),this.logger.log(pt.DEBUG,"Repeated command ("+Tt([e,t])+") is dropped"),!0;var r=20===e||21===e||23===e?1:2,i=this.channels[r];return 20===e||21===e||28===e||29===e?32===t?i.ccRCL():33===t?i.ccBS():34===t?i.ccAOF():35===t?i.ccAON():36===t?i.ccDER():37===t?i.ccRU(2):38===t?i.ccRU(3):39===t?i.ccRU(4):40===t?i.ccFON():41===t?i.ccRDC():42===t?i.ccTR():43===t?i.ccRTD():44===t?i.ccEDM():45===t?i.ccCR():46===t?i.ccENM():47===t&&i.ccEOC():i.ccTO(t-32),Nt(e,t,n),this.currentChannel=r,!0},t.parseMidrow=function(e,t){var n=0;if((17===e||25===e)&&t>=32&&t<=47){if((n=17===e?1:2)!==this.currentChannel)return this.logger.log(pt.ERROR,"Mismatch channel in midrow parsing"),!1;var r=this.channels[n];return!!r&&(r.ccMIDROW(t),this.logger.log(pt.DEBUG,"MIDROW ("+Tt([e,t])+")"),!0)}return!1},t.parsePAC=function(e,t){var n,r=this.cmdHistory;if(!((e>=17&&e<=23||e>=25&&e<=31)&&t>=64&&t<=127)&&!((16===e||24===e)&&t>=64&&t<=95))return!1;if(Bt(e,t,r))return Nt(null,null,r),!0;var i=e<=23?1:2;n=t>=64&&t<=95?1===i?yt[e]:Et[e]:1===i?bt[e]:_t[e];var o=this.channels[i];return!!o&&(o.setPAC(this.interpretPAC(n,t)),Nt(e,t,r),this.currentChannel=i,!0)},t.interpretPAC=function(e,t){var n=t,r={color:null,italics:!1,indent:null,underline:!1,row:e};return n=t>95?t-96:t-64,r.underline=1==(1&n),n<=13?r.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(n/2)]:n<=15?(r.italics=!0,r.color="white"):r.indent=4*Math.floor((n-16)/2),r},t.parseChars=function(e,t){var n,r=null,i=null;if(e>=25?(n=2,i=e-8):(n=1,i=e),i>=17&&i<=19){var o=t;o=17===i?t+80:18===i?t+112:t+144,this.logger.log(pt.INFO,"Special char '"+gt(o)+"' in channel "+n),r=[o]}else e>=32&&e<=127&&(r=0===t?[e]:[e,t]);if(r){var a=Tt(r);this.logger.log(pt.DEBUG,"Char codes =  "+a.join(",")),Nt(e,t,this.cmdHistory)}return r},t.parseBackgroundAttributes=function(e,t){var n;if(!((16===e||24===e)&&t>=32&&t<=47)&&!((23===e||31===e)&&t>=45&&t<=47))return!1;var r={};16===e||24===e?(n=Math.floor((t-32)/2),r.background=wt[n],t%2==1&&(r.background=r.background+"_semi")):45===t?r.background="transparent":(r.foreground="black",47===t&&(r.underline=!0));var i=e<=23?1:2;return this.channels[i].setBkgData(r),Nt(e,t,this.cmdHistory),!0},t.reset=function(){for(var e=0;e<Object.keys(this.channels).length;e++){var t=this.channels[e];t&&t.reset()}this.cmdHistory={a:null,b:null}},t.cueSplitAtTime=function(e){for(var t=0;t<this.channels.length;t++){var n=this.channels[t];n&&n.cueSplitAtTime(e)}},e}(),Lt=function(){function e(e,t){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=e,this.trackName=t}var t=e.prototype;return t.dispatchCue=function(){null!==this.startTime&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)},t.newCue=function(e,t,n){(null===this.startTime||this.startTime>e)&&(this.startTime=e),this.endTime=t,this.screen=n,this.timelineController.createCaptionsTrack(this.trackName)},t.reset=function(){this.cueRanges=[]},e}(),kt=function(e,t,n){return e.substr(n||0,t.length)===t},Ut=function(e){for(var t=5381,n=e.length;n;)t=33*t^e.charCodeAt(--n);return(t>>>0).toString()},Dt={parse:function(e,t,n,r,i,o){var a,s=Object(Ue.utf8ArrayToStr)(new Uint8Array(e)).trim().replace(/\r\n|\n\r|\n|\r/g,"\n").split("\n"),u="00:00.000",l=0,d=0,h=0,f=[],p=!0,A=!1,g=new ht;g.oncue=function(e){var t=n[r],i=n.ccOffset;t&&t.new&&(void 0!==d?i=n.ccOffset=t.start:function(e,t,n){var r=e[t],i=e[r.prevCC];if(!i||!i.new&&r.new)return e.ccOffset=e.presentationOffset=r.start,void(r.new=!1);for(;i&&i.new;)e.ccOffset+=r.start-i.start,r.new=!1,i=e[(r=i).prevCC];e.presentationOffset=n}(n,r,h)),h&&(i=h-n.presentationOffset),A&&(e.startTime+=i-d,e.endTime+=i-d),e.id=Ut(e.startTime.toString())+Ut(e.endTime.toString())+Ut(e.text),e.text=decodeURIComponent(encodeURIComponent(e.text)),e.endTime>0&&f.push(e)},g.onparsingerror=function(e){a=e},g.onflush=function(){a&&o?o(a):i(f)},s.forEach((function(e){if(p){if(kt(e,"X-TIMESTAMP-MAP=")){p=!1,A=!0,e.substr(16).split(",").forEach((function(e){kt(e,"LOCAL:")?u=e.substr(6):kt(e,"MPEGTS:")&&(l=parseInt(e.substr(7)))}));try{t+(9e4*n[r].start||0)<0&&(t+=8589934592),l-=t,d=function(e){var t=parseInt(e.substr(-3)),n=parseInt(e.substr(-6,2)),r=parseInt(e.substr(-9,2)),i=e.length>9?parseInt(e.substr(0,e.indexOf(":"))):0;if(!(Object(c.isFiniteNumber)(t)&&Object(c.isFiniteNumber)(n)&&Object(c.isFiniteNumber)(r)&&Object(c.isFiniteNumber)(i)))throw Error("Malformed X-TIMESTAMP-MAP: Local:"+e);return t+=1e3*n,t+=6e4*r,t+36e5*i}(u)/1e3,h=l/9e4}catch(e){A=!1,a=e}return}""===e&&(p=!1)}g.parse(e+"\n")})),g.flush()}};function Pt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ft(e,t){return e&&e.label===t.name&&!(e.textTrack1||e.textTrack2)}var Ht=function(e){var t,n;function r(t){var n;if((n=e.call(this,t,u.default.MEDIA_ATTACHING,u.default.MEDIA_DETACHING,u.default.FRAG_PARSING_USERDATA,u.default.FRAG_DECRYPTED,u.default.MANIFEST_LOADING,u.default.MANIFEST_LOADED,u.default.FRAG_LOADED,u.default.INIT_PTS_FOUND)||this).media=null,n.config=void 0,n.enabled=!0,n.Cues=void 0,n.textTracks=[],n.tracks=[],n.initPTS=[],n.unparsedVttFrags=[],n.captionsTracks={},n.nonNativeCaptionsTracks={},n.captionsProperties=void 0,n.cea608Parser1=void 0,n.cea608Parser2=void 0,n.lastSn=-1,n.prevCC=-1,n.vttCCs={ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!1}},n.hls=t,n.config=t.config,n.Cues=t.config.cueHandler,n.captionsProperties={textTrack1:{label:n.config.captionsTextTrack1Label,languageCode:n.config.captionsTextTrack1LanguageCode},textTrack2:{label:n.config.captionsTextTrack2Label,languageCode:n.config.captionsTextTrack2LanguageCode},textTrack3:{label:n.config.captionsTextTrack3Label,languageCode:n.config.captionsTextTrack3LanguageCode},textTrack4:{label:n.config.captionsTextTrack4Label,languageCode:n.config.captionsTextTrack4LanguageCode}},n.config.enableCEA708Captions){var r=new Lt(Pt(n),"textTrack1"),i=new Lt(Pt(n),"textTrack2"),o=new Lt(Pt(n),"textTrack3"),a=new Lt(Pt(n),"textTrack4");n.cea608Parser1=new Mt(1,r,i),n.cea608Parser2=new Mt(3,o,a)}return n}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var i=r.prototype;return i.addCues=function(e,t,n,r,i){for(var o,a,s,c,l=!1,d=i.length;d--;){var h=i[d],f=(o=h[0],a=h[1],s=t,c=n,Math.min(a,c)-Math.max(o,s));if(f>=0&&(h[0]=Math.min(h[0],t),h[1]=Math.max(h[1],n),l=!0,f/(n-t)>.5))return}if(l||i.push([t,n]),this.config.renderTextTracksNatively)this.Cues.newCue(this.captionsTracks[e],t,n,r);else{var p=this.Cues.newCue(null,t,n,r);this.hls.trigger(u.default.CUES_PARSED,{type:"captions",cues:p,track:e})}},i.onInitPtsFound=function(e){var t=this,n=e.frag,r=e.id,i=e.initPTS,o=this.unparsedVttFrags;"main"===r&&(this.initPTS[n.cc]=i),o.length&&(this.unparsedVttFrags=[],o.forEach((function(e){t.onFragLoaded(e)})))},i.getExistingTrack=function(e){var t=this.media;if(t)for(var n=0;n<t.textTracks.length;n++){var r=t.textTracks[n];if(r[e])return r}return null},i.createCaptionsTrack=function(e){this.config.renderTextTracksNatively?this.createNativeTrack(e):this.createNonNativeTrack(e)},i.createNativeTrack=function(e){if(!this.captionsTracks[e]){var t=this.captionsProperties,n=this.captionsTracks,r=this.media,i=t[e],o=i.label,a=i.languageCode,s=this.getExistingTrack(e);if(s)n[e]=s,Pe(n[e]),De(n[e],r);else{var c=this.createTextTrack("captions",o,a);c&&(c[e]=!0,n[e]=c)}}},i.createNonNativeTrack=function(e){if(!this.nonNativeCaptionsTracks[e]){var t=this.captionsProperties[e];if(t){var n={_id:e,label:t.label,kind:"captions",default:!!t.media&&!!t.media.default,closedCaptions:t.media};this.nonNativeCaptionsTracks[e]=n,this.hls.trigger(u.default.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[n]})}}},i.createTextTrack=function(e,t,n){var r=this.media;if(r)return r.addTextTrack(e,t,n)},i.destroy=function(){e.prototype.destroy.call(this)},i.onMediaAttaching=function(e){this.media=e.media,this._cleanTracks()},i.onMediaDetaching=function(){var e=this.captionsTracks;Object.keys(e).forEach((function(t){Pe(e[t]),delete e[t]})),this.nonNativeCaptionsTracks={}},i.onManifestLoading=function(){this.lastSn=-1,this.prevCC=-1,this.vttCCs={ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!1}},this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={}},i._cleanTracks=function(){var e=this.media;if(e){var t=e.textTracks;if(t)for(var n=0;n<t.length;n++)Pe(t[n])}},i.onManifestLoaded=function(e){var t=this;if(this.textTracks=[],this.unparsedVttFrags=this.unparsedVttFrags||[],this.initPTS=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset()),this.config.enableWebVTT){var n=e.subtitles||[],r=this.tracks&&n&&this.tracks.length===n.length;if(this.tracks=e.subtitles||[],this.config.renderTextTracksNatively){var i=this.media?this.media.textTracks:[];this.tracks.forEach((function(e,n){var r;if(n<i.length){for(var o=null,a=0;a<i.length;a++)if(Ft(i[a],e)){o=i[a];break}o&&(r=o)}r||(r=t.createTextTrack("subtitles",e.name,e.lang)),e.default?r.mode=t.hls.subtitleDisplay?"showing":"hidden":r.mode="disabled",t.textTracks.push(r)}))}else if(!r&&this.tracks&&this.tracks.length){var o=this.tracks.map((function(e){return{label:e.name,kind:e.type.toLowerCase(),default:e.default,subtitleTrack:e}}));this.hls.trigger(u.default.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:o})}}this.config.enableCEA708Captions&&e.captions&&e.captions.forEach((function(e){var n=/(?:CC|SERVICE)([1-4])/.exec(e.instreamId);if(n){var r="textTrack"+n[1],i=t.captionsProperties[r];i&&(i.label=e.name,e.lang&&(i.languageCode=e.lang),i.media=e)}}))},i.onFragLoaded=function(e){var t=e.frag,n=e.payload,r=this.cea608Parser1,i=this.cea608Parser2,o=this.initPTS,a=this.lastSn,s=this.unparsedVttFrags;if("main"===t.type){var l=t.sn;t.sn!==a+1&&r&&i&&(r.reset(),i.reset()),this.lastSn=l}else if("subtitle"===t.type)if(n.byteLength){if(!Object(c.isFiniteNumber)(o[t.cc]))return s.push(e),void(o.length&&this.hls.trigger(u.default.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:t}));var d=t.decryptdata;null!=d&&null!=d.key&&"AES-128"===d.method||this._parseVTTs(t,n)}else this.hls.trigger(u.default.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:t})},i._parseVTTs=function(e,t){var n=this,r=this.hls,i=this.prevCC,o=this.textTracks,a=this.vttCCs;a[e.cc]||(a[e.cc]={start:e.start,prevCC:i,new:!0},this.prevCC=e.cc),Dt.parse(t,this.initPTS[e.cc],a,e.cc,(function(t){if(n.config.renderTextTracksNatively){var i=o[e.level];if("disabled"===i.mode)return void r.trigger(u.default.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e});t.forEach((function(e){if(!i.cues.getCueById(e.id))try{if(i.addCue(e),!i.cues.getCueById(e.id))throw new Error("addCue is failed for: "+e)}catch(n){l.logger.debug("Failed occurred on adding cues: "+n);var t=new window.TextTrackCue(e.startTime,e.endTime,e.text);t.id=e.id,i.addCue(t)}}))}else{var a=n.tracks[e.level].default?"default":"subtitles"+e.level;r.trigger(u.default.CUES_PARSED,{type:"subtitles",cues:t,track:a})}r.trigger(u.default.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:e})}),(function(t){l.logger.log("Failed to parse VTT cue: "+t),r.trigger(u.default.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e})}))},i.onFragDecrypted=function(e){var t=e.frag,n=e.payload;if("subtitle"===t.type){if(!Object(c.isFiniteNumber)(this.initPTS[t.cc]))return void this.unparsedVttFrags.push(e);this._parseVTTs(t,n)}},i.onFragParsingUserdata=function(e){var t=this.cea608Parser1,n=this.cea608Parser2;if(this.enabled&&t&&n)for(var r=0;r<e.samples.length;r++){var i=e.samples[r].bytes;if(i){var o=this.extractCea608Data(i);t.addData(e.samples[r].pts,o[0]),n.addData(e.samples[r].pts,o[1])}}},i.extractCea608Data=function(e){for(var t=31&e[0],n=2,r=[[],[]],i=0;i<t;i++){var o=e[n++],a=127&e[n++],s=127&e[n++],c=3&o;0===a&&0===s||0!=(4&o)&&(0!==c&&1!==c||(r[c].push(a),r[c].push(s)))}return r},r}(h);function jt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Vt(e){for(var t=[],n=0;n<e.length;n++){var r=e[n];"subtitles"===r.kind&&r.label&&t.push(e[n])}return t}var Qt=function(e){var t,n;function r(t){var n;return(n=e.call(this,t,u.default.MEDIA_ATTACHED,u.default.MEDIA_DETACHING,u.default.MANIFEST_LOADED,u.default.SUBTITLE_TRACK_LOADED)||this).tracks=[],n.trackId=-1,n.media=null,n.stopped=!0,n.subtitleDisplay=!0,n.queuedDefaultTrack=null,n}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var i,o,a,s=r.prototype;return s.destroy=function(){h.prototype.destroy.call(this)},s.onMediaAttached=function(e){var t=this;this.media=e.media,this.media&&(Object(c.isFiniteNumber)(this.queuedDefaultTrack)&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=null),this.trackChangeListener=this._onTextTracksChanged.bind(this),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.subtitlePollingInterval=setInterval((function(){t.trackChangeListener()}),500):this.media.textTracks.addEventListener("change",this.trackChangeListener))},s.onMediaDetaching=function(){this.media&&(this.useTextTrackPolling?clearInterval(this.subtitlePollingInterval):this.media.textTracks.removeEventListener("change",this.trackChangeListener),Object(c.isFiniteNumber)(this.subtitleTrack)&&(this.queuedDefaultTrack=this.subtitleTrack),Vt(this.media.textTracks).forEach((function(e){Pe(e)})),this.subtitleTrack=-1,this.media=null)},s.onManifestLoaded=function(e){var t=this,n=e.subtitles||[];this.tracks=n,this.hls.trigger(u.default.SUBTITLE_TRACKS_UPDATED,{subtitleTracks:n}),n.forEach((function(e){e.default&&(t.media?t.subtitleTrack=e.id:t.queuedDefaultTrack=e.id)}))},s.onSubtitleTrackLoaded=function(e){var t=this,n=e.id,r=e.details,i=this.trackId,o=this.tracks,a=o[i];if(n>=o.length||n!==i||!a||this.stopped)this._clearReloadTimer();else if(l.logger.log("subtitle track "+n+" loaded"),r.live){var s=ie(a.details,r,e.stats.trequest);l.logger.log("Reloading live subtitle playlist in "+s+"ms"),this.timer=setTimeout((function(){t._loadCurrentTrack()}),s)}else this._clearReloadTimer()},s.startLoad=function(){this.stopped=!1,this._loadCurrentTrack()},s.stopLoad=function(){this.stopped=!0,this._clearReloadTimer()},s._clearReloadTimer=function(){this.timer&&(clearTimeout(this.timer),this.timer=null)},s._loadCurrentTrack=function(){var e=this.trackId,t=this.tracks,n=this.hls,r=t[e];e<0||!r||r.details&&!r.details.live||(l.logger.log("Loading subtitle track "+e),n.trigger(u.default.SUBTITLE_TRACK_LOADING,{url:r.url,id:e}))},s._toggleTrackModes=function(e){var t=this.media,n=this.subtitleDisplay,r=this.trackId;if(t){var i=Vt(t.textTracks);if(-1===e)[].slice.call(i).forEach((function(e){e.mode="disabled"}));else{var o=i[r];o&&(o.mode="disabled")}var a=i[e];a&&(a.mode=n?"showing":"hidden")}},s._setSubtitleTrackInternal=function(e){var t=this.hls,n=this.tracks;!Object(c.isFiniteNumber)(e)||e<-1||e>=n.length||(this.trackId=e,l.logger.log("Switching to subtitle track "+e),t.trigger(u.default.SUBTITLE_TRACK_SWITCH,{id:e}),this._loadCurrentTrack())},s._onTextTracksChanged=function(){if(this.media&&this.hls.config.renderTextTracksNatively){for(var e=-1,t=Vt(this.media.textTracks),n=0;n<t.length;n++)if("hidden"===t[n].mode)e=n;else if("showing"===t[n].mode){e=n;break}this.subtitleTrack=e}},i=r,(o=[{key:"subtitleTracks",get:function(){return this.tracks}},{key:"subtitleTrack",get:function(){return this.trackId},set:function(e){this.trackId!==e&&(this._toggleTrackModes(e),this._setSubtitleTrackInternal(e))}}])&&jt(i.prototype,o),a&&jt(i,a),r}(h),Gt=n("./src/crypt/decrypter.js");var zt,Kt=window.performance,qt=function(e){var t,n;function r(t,n){var r;return(r=e.call(this,t,u.default.MEDIA_ATTACHED,u.default.MEDIA_DETACHING,u.default.ERROR,u.default.KEY_LOADED,u.default.FRAG_LOADED,u.default.SUBTITLE_TRACKS_UPDATED,u.default.SUBTITLE_TRACK_SWITCH,u.default.SUBTITLE_TRACK_LOADED,u.default.SUBTITLE_FRAG_PROCESSED,u.default.LEVEL_UPDATED)||this).fragmentTracker=n,r.config=t.config,r.state=Ae,r.tracks=[],r.tracksBuffered=[],r.currentTrackId=-1,r.decrypter=new Gt.default(t,t.config),r.lastAVStart=0,r._onMediaSeeking=r.onMediaSeeking.bind(function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(r)),r}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var i=r.prototype;return i.onSubtitleFragProcessed=function(e){var t=e.frag,n=e.success;if(this.fragPrevious=t,this.state=ve,n){var r=this.tracksBuffered[this.currentTrackId];if(r){for(var i,o=t.start,a=0;a<r.length;a++)if(o>=r[a].start&&o<=r[a].end){i=r[a];break}var s=t.start+t.duration;i?i.end=s:(i={start:o,end:s},r.push(i))}}},i.onMediaAttached=function(e){var t=e.media;this.media=t,t.addEventListener("seeking",this._onMediaSeeking),this.state=ve},i.onMediaDetaching=function(){var e=this;this.media&&(this.media.removeEventListener("seeking",this._onMediaSeeking),this.fragmentTracker.removeAllFragments(),this.currentTrackId=-1,this.tracks.forEach((function(t){e.tracksBuffered[t.id]=[]})),this.media=null,this.state=Ae)},i.onError=function(e){var t=e.frag;t&&"subtitle"===t.type&&(this.state=ve)},i.onSubtitleTracksUpdated=function(e){var t=this;l.logger.log("subtitle tracks updated"),this.tracksBuffered=[],this.tracks=e.subtitleTracks,this.tracks.forEach((function(e){t.tracksBuffered[e.id]=[]}))},i.onSubtitleTrackSwitch=function(e){if(this.currentTrackId=e.id,this.tracks&&this.tracks.length&&-1!==this.currentTrackId){var t=this.tracks[this.currentTrackId];t&&t.details&&this.setInterval(500)}else this.clearInterval()},i.onSubtitleTrackLoaded=function(e){var t=e.id,n=e.details,r=this.currentTrackId,i=this.tracks,o=i[r];t>=i.length||t!==r||!o||(n.live&&function(e,t,n){void 0===n&&(n=0);var r=-1;re(e,t,(function(e,t,n){t.start=e.start,r=n}));var i=t.fragments;if(r<0)i.forEach((function(e){e.start+=n}));else for(var o=r+1;o<i.length;o++)i[o].start=i[o-1].start+i[o-1].duration}(o.details,n,this.lastAVStart),o.details=n,this.setInterval(500))},i.onKeyLoaded=function(){this.state===ye&&(this.state=ve)},i.onFragLoaded=function(e){var t=this.fragCurrent,n=e.frag.decryptdata,r=e.frag,i=this.hls;if(this.state===be&&t&&"subtitle"===e.frag.type&&t.sn===e.frag.sn&&e.payload.byteLength>0&&n&&n.key&&"AES-128"===n.method){var o=Kt.now();this.decrypter.decrypt(e.payload,n.key.buffer,n.iv.buffer,(function(e){var t=Kt.now();i.trigger(u.default.FRAG_DECRYPTED,{frag:r,payload:e,stats:{tstart:o,tdecrypt:t}})}))}},i.onLevelUpdated=function(e){var t=e.details.fragments;this.lastAVStart=t.length?t[0].start:0},i.doTick=function(){if(this.media)switch(this.state){case ve:var e=this.config,t=this.currentTrackId,n=this.fragmentTracker,r=this.media,i=this.tracks;if(!i||!i[t]||!i[t].details)break;var o,a=e.maxBufferHole,s=e.maxFragLookUpTolerance,c=Math.min(e.maxBufferLength,e.maxMaxBufferLength),d=Q.bufferedInfo(this._getBuffered(),r.currentTime,a),h=d.end,f=d.len,p=i[t].details,A=p.fragments,g=A.length,v=A[g-1].start+A[g-1].duration;if(f>c)return;var m=this.fragPrevious;h<v?(m&&p.hasProgramDateTime&&(o=ce(A,m.endProgramDateTime,s)),o||(o=ue(m,A,h,s))):o=A[g-1],o&&o.encrypted?(l.logger.log("Loading key for "+o.sn),this.state=ye,this.hls.trigger(u.default.KEY_LOADING,{frag:o})):o&&n.getState(o)===D&&(this.fragCurrent=o,this.state=be,this.hls.trigger(u.default.FRAG_LOADING,{frag:o}))}else this.state=ve},i.stopLoad=function(){this.lastAVStart=0,e.prototype.stopLoad.call(this)},i._getBuffered=function(){return this.tracksBuffered[this.currentTrackId]||[]},i.onMediaSeeking=function(){this.fragPrevious=null},r}(Oe);!function(e){e.WIDEVINE="com.widevine.alpha",e.PLAYREADY="com.microsoft.playready"}(zt||(zt={}));var Wt="undefined"!=typeof window&&window.navigator&&window.navigator.requestMediaKeySystemAccess?window.navigator.requestMediaKeySystemAccess.bind(window.navigator):null;function Xt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Jt=function(e){var t,n;function r(t){var n;return(n=e.call(this,t,u.default.MEDIA_ATTACHED,u.default.MEDIA_DETACHED,u.default.MANIFEST_PARSED)||this)._widevineLicenseUrl=void 0,n._licenseXhrSetup=void 0,n._emeEnabled=void 0,n._requestMediaKeySystemAccess=void 0,n._drmSystemOptions=void 0,n._config=void 0,n._mediaKeysList=[],n._media=null,n._hasSetMediaKeys=!1,n._requestLicenseFailureCount=0,n.mediaKeysPromise=null,n._onMediaEncrypted=function(e){if(l.logger.log('Media is encrypted using "'+e.initDataType+'" init data type'),!n.mediaKeysPromise)return l.logger.error("Fatal: Media is encrypted but no CDM access or no keys have been requested"),void n.hls.trigger(u.default.ERROR,{type:s.ErrorTypes.KEY_SYSTEM_ERROR,details:s.ErrorDetails.KEY_SYSTEM_NO_KEYS,fatal:!0});var t=function(t){n._media&&(n._attemptSetMediaKeys(t),n._generateRequestWithPreferredKeySession(e.initDataType,e.initData))};n.mediaKeysPromise.then(t).catch(t)},n._config=t.config,n._widevineLicenseUrl=n._config.widevineLicenseUrl,n._licenseXhrSetup=n._config.licenseXhrSetup,n._emeEnabled=n._config.emeEnabled,n._requestMediaKeySystemAccess=n._config.requestMediaKeySystemAccessFunc,n._drmSystemOptions=t.config.drmSystemOptions,n}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var i,o,a,c=r.prototype;return c.getLicenseServerUrl=function(e){switch(e){case zt.WIDEVINE:if(!this._widevineLicenseUrl)break;return this._widevineLicenseUrl}throw new Error('no license server URL configured for key-system "'+e+'"')},c._attemptKeySystemAccess=function(e,t,n){var r=this,i=function(e,t,n,r){switch(e){case zt.WIDEVINE:return function(e,t,n){var r={audioCapabilities:[],videoCapabilities:[]};return e.forEach((function(e){r.audioCapabilities.push({contentType:'audio/mp4; codecs="'+e+'"',robustness:n.audioRobustness||""})})),t.forEach((function(e){r.videoCapabilities.push({contentType:'video/mp4; codecs="'+e+'"',robustness:n.videoRobustness||""})})),[r]}(t,n,r);default:throw new Error("Unknown key-system: "+e)}}(e,t,n,this._drmSystemOptions);l.logger.log("Requesting encrypted media key-system access");var o=this.requestMediaKeySystemAccess(e,i);this.mediaKeysPromise=o.then((function(t){return r._onMediaKeySystemAccessObtained(e,t)})),o.catch((function(t){l.logger.error('Failed to obtain key-system "'+e+'" access:',t)}))},c._onMediaKeySystemAccessObtained=function(e,t){var n=this;l.logger.log('Access for key-system "'+e+'" obtained');var r={mediaKeysSessionInitialized:!1,mediaKeySystemAccess:t,mediaKeySystemDomain:e};this._mediaKeysList.push(r);var i=Promise.resolve().then((function(){return t.createMediaKeys()})).then((function(t){return r.mediaKeys=t,l.logger.log('Media-keys created for key-system "'+e+'"'),n._onMediaKeysCreated(),t}));return i.catch((function(e){l.logger.error("Failed to create media-keys:",e)})),i},c._onMediaKeysCreated=function(){var e=this;this._mediaKeysList.forEach((function(t){t.mediaKeysSession||(t.mediaKeysSession=t.mediaKeys.createSession(),e._onNewMediaKeySession(t.mediaKeysSession))}))},c._onNewMediaKeySession=function(e){var t=this;l.logger.log("New key-system session "+e.sessionId),e.addEventListener("message",(function(n){t._onKeySessionMessage(e,n.message)}),!1)},c._onKeySessionMessage=function(e,t){l.logger.log("Got EME message event, creating license request"),this._requestLicense(t,(function(t){l.logger.log("Received license data (length: "+(t?t.byteLength:t)+"), updating key-session"),e.update(t)}))},c._attemptSetMediaKeys=function(e){if(!this._media)throw new Error("Attempted to set mediaKeys without first attaching a media element");if(!this._hasSetMediaKeys){var t=this._mediaKeysList[0];if(!t||!t.mediaKeys)return l.logger.error("Fatal: Media is encrypted but no CDM access or no keys have been obtained yet"),void this.hls.trigger(u.default.ERROR,{type:s.ErrorTypes.KEY_SYSTEM_ERROR,details:s.ErrorDetails.KEY_SYSTEM_NO_KEYS,fatal:!0});l.logger.log("Setting keys for encrypted media"),this._media.setMediaKeys(t.mediaKeys),this._hasSetMediaKeys=!0}},c._generateRequestWithPreferredKeySession=function(e,t){var n=this,r=this._mediaKeysList[0];if(!r)return l.logger.error("Fatal: Media is encrypted but not any key-system access has been obtained yet"),void this.hls.trigger(u.default.ERROR,{type:s.ErrorTypes.KEY_SYSTEM_ERROR,details:s.ErrorDetails.KEY_SYSTEM_NO_ACCESS,fatal:!0});if(r.mediaKeysSessionInitialized)l.logger.warn("Key-Session already initialized but requested again");else{var i=r.mediaKeysSession;if(!i)return l.logger.error("Fatal: Media is encrypted but no key-session existing"),void this.hls.trigger(u.default.ERROR,{type:s.ErrorTypes.KEY_SYSTEM_ERROR,details:s.ErrorDetails.KEY_SYSTEM_NO_SESSION,fatal:!0});if(!t)return l.logger.warn("Fatal: initData required for generating a key session is null"),void this.hls.trigger(u.default.ERROR,{type:s.ErrorTypes.KEY_SYSTEM_ERROR,details:s.ErrorDetails.KEY_SYSTEM_NO_INIT_DATA,fatal:!0});l.logger.log('Generating key-session request for "'+e+'" init data type'),r.mediaKeysSessionInitialized=!0,i.generateRequest(e,t).then((function(){l.logger.debug("Key-session generation succeeded")})).catch((function(e){l.logger.error("Error generating key-session request:",e),n.hls.trigger(u.default.ERROR,{type:s.ErrorTypes.KEY_SYSTEM_ERROR,details:s.ErrorDetails.KEY_SYSTEM_NO_SESSION,fatal:!1})}))}},c._createLicenseXhr=function(e,t,n){var r=new XMLHttpRequest,i=this._licenseXhrSetup;try{if(i)try{i(r,e)}catch(t){r.open("POST",e,!0),i(r,e)}r.readyState||r.open("POST",e,!0)}catch(e){throw new Error("issue setting up KeySystem license XHR "+e)}return r.responseType="arraybuffer",r.onreadystatechange=this._onLicenseRequestReadyStageChange.bind(this,r,e,t,n),r},c._onLicenseRequestReadyStageChange=function(e,t,n,r){switch(e.readyState){case 4:if(200===e.status)this._requestLicenseFailureCount=0,l.logger.log("License request succeeded"),"arraybuffer"!==e.responseType&&l.logger.warn("xhr response type was not set to the expected arraybuffer for license request"),r(e.response);else{if(l.logger.error("License Request XHR failed ("+t+"). Status: "+e.status+" ("+e.statusText+")"),this._requestLicenseFailureCount++,this._requestLicenseFailureCount>3)return void this.hls.trigger(u.default.ERROR,{type:s.ErrorTypes.KEY_SYSTEM_ERROR,details:s.ErrorDetails.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0});var i=3-this._requestLicenseFailureCount+1;l.logger.warn("Retrying license request, "+i+" attempts left"),this._requestLicense(n,r)}}},c._generateLicenseRequestChallenge=function(e,t){switch(e.mediaKeySystemDomain){case zt.WIDEVINE:return t}throw new Error("unsupported key-system: "+e.mediaKeySystemDomain)},c._requestLicense=function(e,t){l.logger.log("Requesting content license for key-system");var n=this._mediaKeysList[0];if(!n)return l.logger.error("Fatal error: Media is encrypted but no key-system access has been obtained yet"),void this.hls.trigger(u.default.ERROR,{type:s.ErrorTypes.KEY_SYSTEM_ERROR,details:s.ErrorDetails.KEY_SYSTEM_NO_ACCESS,fatal:!0});try{var r=this.getLicenseServerUrl(n.mediaKeySystemDomain),i=this._createLicenseXhr(r,e,t);l.logger.log("Sending license request to URL: "+r);var o=this._generateLicenseRequestChallenge(n,e);i.send(o)}catch(e){l.logger.error("Failure requesting DRM license: "+e),this.hls.trigger(u.default.ERROR,{type:s.ErrorTypes.KEY_SYSTEM_ERROR,details:s.ErrorDetails.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0})}},c.onMediaAttached=function(e){if(this._emeEnabled){var t=e.media;this._media=t,t.addEventListener("encrypted",this._onMediaEncrypted)}},c.onMediaDetached=function(){var e=this._media,t=this._mediaKeysList;e&&(e.removeEventListener("encrypted",this._onMediaEncrypted),this._media=null,this._mediaKeysList=[],Promise.all(t.map((function(e){if(e.mediaKeysSession)return e.mediaKeysSession.close().catch((function(){}))}))).then((function(){return e.setMediaKeys(null)})).catch((function(){})))},c.onManifestParsed=function(e){if(this._emeEnabled){var t=e.levels.map((function(e){return e.audioCodec})),n=e.levels.map((function(e){return e.videoCodec}));this._attemptKeySystemAccess(zt.WIDEVINE,t,n)}},i=r,(o=[{key:"requestMediaKeySystemAccess",get:function(){if(!this._requestMediaKeySystemAccess)throw new Error("No requestMediaKeySystemAccess function configured");return this._requestMediaKeySystemAccess}}])&&Xt(i.prototype,o),a&&Xt(i,a),r}(h);function Yt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Zt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Yt(Object(n),!0).forEach((function(t){$t(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Yt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function $t(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var en=Zt(Zt({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,initialLiveManifestSize:1,maxBufferLength:30,maxBufferSize:6e7,maxBufferHole:.5,lowBufferWatchdogPeriod:.5,highBufferWatchdogPeriod:3,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,liveDurationInfinity:!1,liveBackBufferLength:1/0,maxMaxBufferLength:600,enableWorker:!0,enableSoftwareAES:!0,manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,startLevel:void 0,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:Ye,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,abrController:Ge,bufferController:Ke,capLevelController:We,fpsController:Je,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystemOptions:{},requestMediaKeySystemAccessFunc:Wt,testBandwidth:!0},{cueHandler:r,enableCEA708Captions:!0,enableWebVTT:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}),{},{subtitleStreamController:qt,subtitleTrackController:Qt,timelineController:Ht,audioStreamController:nt,audioTrackController:$e,emeController:Jt});function tn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function nn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?tn(Object(n),!0).forEach((function(t){rn(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):tn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function rn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function on(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function an(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function sn(e,t,n){return t&&an(e.prototype,t),n&&an(e,n),e}var cn=function(e){var t,n;function r(t){var n;void 0===t&&(t={}),(n=e.call(this)||this).config=void 0,n._autoLevelCapping=void 0,n.abrController=void 0,n.capLevelController=void 0,n.levelController=void 0,n.streamController=void 0,n.networkControllers=void 0,n.audioTrackController=void 0,n.subtitleTrackController=void 0,n.emeController=void 0,n.coreComponents=void 0,n.media=null,n.url=null;var i=r.DefaultConfig;if((t.liveSyncDurationCount||t.liveMaxLatencyDurationCount)&&(t.liveSyncDuration||t.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");n.config=nn(nn({},i),t);var o=on(n).config;if(void 0!==o.liveMaxLatencyDurationCount&&o.liveMaxLatencyDurationCount<=o.liveSyncDurationCount)throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be gt "liveSyncDurationCount"');if(void 0!==o.liveMaxLatencyDuration&&(void 0===o.liveSyncDuration||o.liveMaxLatencyDuration<=o.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be gt "liveSyncDuration"');Object(l.enableLogs)(o.debug),n._autoLevelCapping=-1;var a=n.abrController=new o.abrController(on(n)),s=new o.bufferController(on(n)),c=n.capLevelController=new o.capLevelController(on(n)),u=new o.fpsController(on(n)),d=new L(on(n)),h=new k(on(n)),f=new U(on(n)),p=new Fe(on(n)),A=n.levelController=new ke(on(n)),g=new j(on(n)),v=[A,n.streamController=new Me(on(n),g)],m=o.audioStreamController;m&&v.push(new m(on(n),g)),n.networkControllers=v;var y=[d,h,f,a,s,c,u,p,g];if(m=o.audioTrackController){var b=new m(on(n));n.audioTrackController=b,y.push(b)}if(m=o.subtitleTrackController){var E=new m(on(n));n.subtitleTrackController=E,v.push(E)}if(m=o.emeController){var _=new m(on(n));n.emeController=_,y.push(_)}return(m=o.subtitleStreamController)&&v.push(new m(on(n),g)),(m=o.timelineController)&&y.push(new m(on(n))),n.coreComponents=y,n}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,r.isSupported=function(){return function(){var e=q();if(!e)return!1;var t=self.SourceBuffer||self.WebKitSourceBuffer,n=e&&"function"==typeof e.isTypeSupported&&e.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"'),r=!t||t.prototype&&"function"==typeof t.prototype.appendBuffer&&"function"==typeof t.prototype.remove;return!!n&&!!r}()},sn(r,null,[{key:"version",get:function(){return"0.14.12"}},{key:"Events",get:function(){return u.default}},{key:"ErrorTypes",get:function(){return s.ErrorTypes}},{key:"ErrorDetails",get:function(){return s.ErrorDetails}},{key:"DefaultConfig",get:function(){return r.defaultConfig?r.defaultConfig:en},set:function(e){r.defaultConfig=e}}]);var i=r.prototype;return i.destroy=function(){l.logger.log("destroy"),this.trigger(u.default.DESTROYING),this.detachMedia(),this.coreComponents.concat(this.networkControllers).forEach((function(e){e.destroy()})),this.url=null,this.removeAllListeners(),this._autoLevelCapping=-1},i.attachMedia=function(e){l.logger.log("attachMedia"),this.media=e,this.trigger(u.default.MEDIA_ATTACHING,{media:e})},i.detachMedia=function(){l.logger.log("detachMedia"),this.trigger(u.default.MEDIA_DETACHING),this.media=null},i.loadSource=function(e){e=a.buildAbsoluteURL(window.location.href,e,{alwaysNormalize:!0}),l.logger.log("loadSource:"+e),this.url=e,this.trigger(u.default.MANIFEST_LOADING,{url:e})},i.startLoad=function(e){void 0===e&&(e=-1),l.logger.log("startLoad("+e+")"),this.networkControllers.forEach((function(t){t.startLoad(e)}))},i.stopLoad=function(){l.logger.log("stopLoad"),this.networkControllers.forEach((function(e){e.stopLoad()}))},i.swapAudioCodec=function(){l.logger.log("swapAudioCodec"),this.streamController.swapAudioCodec()},i.recoverMediaError=function(){l.logger.log("recoverMediaError");var e=this.media;this.detachMedia(),e&&this.attachMedia(e)},i.removeLevel=function(e,t){void 0===t&&(t=0),this.levelController.removeLevel(e,t)},sn(r,[{key:"levels",get:function(){return this.levelController.levels}},{key:"currentLevel",get:function(){return this.streamController.currentLevel},set:function(e){l.logger.log("set currentLevel:"+e),this.loadLevel=e,this.streamController.immediateLevelSwitch()}},{key:"nextLevel",get:function(){return this.streamController.nextLevel},set:function(e){l.logger.log("set nextLevel:"+e),this.levelController.manualLevel=e,this.streamController.nextLevelSwitch()}},{key:"loadLevel",get:function(){return this.levelController.level},set:function(e){l.logger.log("set loadLevel:"+e),this.levelController.manualLevel=e}},{key:"nextLoadLevel",get:function(){return this.levelController.nextLoadLevel},set:function(e){this.levelController.nextLoadLevel=e}},{key:"firstLevel",get:function(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)},set:function(e){l.logger.log("set firstLevel:"+e),this.levelController.firstLevel=e}},{key:"startLevel",get:function(){return this.levelController.startLevel},set:function(e){l.logger.log("set startLevel:"+e),-1!==e&&(e=Math.max(e,this.minAutoLevel)),this.levelController.startLevel=e}},{key:"capLevelToPlayerSize",set:function(e){var t=!!e;t!==this.config.capLevelToPlayerSize&&(t?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=t)}},{key:"autoLevelCapping",get:function(){return this._autoLevelCapping},set:function(e){l.logger.log("set autoLevelCapping:"+e),this._autoLevelCapping=e}},{key:"bandwidthEstimate",get:function(){var e=this.abrController._bwEstimator;return e?e.getEstimate():NaN}},{key:"autoLevelEnabled",get:function(){return-1===this.levelController.manualLevel}},{key:"manualLevel",get:function(){return this.levelController.manualLevel}},{key:"minAutoLevel",get:function(){for(var e=this.levels,t=this.config.minAutoBitrate,n=e?e.length:0,r=0;r<n;r++){if((e[r].realBitrate?Math.max(e[r].realBitrate,e[r].bitrate):e[r].bitrate)>t)return r}return 0}},{key:"maxAutoLevel",get:function(){var e=this.levels,t=this.autoLevelCapping;return-1===t&&e&&e.length?e.length-1:t}},{key:"nextAutoLevel",get:function(){return Math.min(Math.max(this.abrController.nextAutoLevel,this.minAutoLevel),this.maxAutoLevel)},set:function(e){this.abrController.nextAutoLevel=Math.max(this.minAutoLevel,e)}},{key:"audioTracks",get:function(){var e=this.audioTrackController;return e?e.audioTracks:[]}},{key:"audioTrack",get:function(){var e=this.audioTrackController;return e?e.audioTrack:-1},set:function(e){var t=this.audioTrackController;t&&(t.audioTrack=e)}},{key:"liveSyncPosition",get:function(){return this.streamController.liveSyncPosition}},{key:"subtitleTracks",get:function(){var e=this.subtitleTrackController;return e?e.subtitleTracks:[]}},{key:"subtitleTrack",get:function(){var e=this.subtitleTrackController;return e?e.subtitleTrack:-1},set:function(e){var t=this.subtitleTrackController;t&&(t.subtitleTrack=e)}},{key:"subtitleDisplay",get:function(){var e=this.subtitleTrackController;return!!e&&e.subtitleDisplay},set:function(e){var t=this.subtitleTrackController;t&&(t.subtitleDisplay=e)}}]),r}(X);cn.defaultConfig=void 0},"./src/polyfills/number.js":
/*!*********************************!*\
  !*** ./src/polyfills/number.js ***!
  \*********************************/
/*! exports provided: isFiniteNumber, MAX_SAFE_INTEGER */function(e,t,n){"use strict";n.r(t),n.d(t,"isFiniteNumber",(function(){return r})),n.d(t,"MAX_SAFE_INTEGER",(function(){return i}));var r=Number.isFinite||function(e){return"number"==typeof e&&isFinite(e)},i=Number.MAX_SAFE_INTEGER||9007199254740991},"./src/utils/get-self-scope.js":
/*!*************************************!*\
  !*** ./src/utils/get-self-scope.js ***!
  \*************************************/
/*! exports provided: getSelfScope */function(e,t,n){"use strict";function r(){return"undefined"==typeof window?self:window}n.r(t),n.d(t,"getSelfScope",(function(){return r}))},"./src/utils/logger.js":
/*!*****************************!*\
  !*** ./src/utils/logger.js ***!
  \*****************************/
/*! exports provided: enableLogs, logger */function(e,t,n){"use strict";n.r(t),n.d(t,"enableLogs",(function(){return l})),n.d(t,"logger",(function(){return d}));var r=n(/*! ./get-self-scope */"./src/utils/get-self-scope.js");function i(){}var o={trace:i,debug:i,log:i,warn:i,info:i,error:i},a=o;function s(e,t){return t="["+e+"] > "+t}var c=Object(r.getSelfScope)();function u(e){var t=c.console[e];return t?function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];r[0]&&(r[0]=s(e,r[0])),t.apply(c.console,r)}:i}var l=function(e){if(c.console&&!0===e||"object"==typeof e){!function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];n.forEach((function(t){a[t]=e[t]?e[t].bind(e):u(t)}))}(e,"debug","log","info","warn","error");try{a.log()}catch(e){a=o}}else a=o},d=a}}).default})),
/**
  @license
                                 Apache License
                         Version 2.0, January 2004
                      http://www.apache.org/licenses/

 TERMS AND CONDITIONS FOR USE, REPRODUCTION, AND DISTRIBUTION

 1. Definitions.

    "License" shall mean the terms and conditions for use, reproduction,
    and distribution as defined by Sections 1 through 9 of this document.

    "Licensor" shall mean the copyright owner or entity authorized by
    the copyright owner that is granting the License.

    "Legal Entity" shall mean the union of the acting entity and all
    other entities that control, are controlled by, or are under common
    control with that entity. For the purposes of this definition,
    "control" means (i) the power, direct or indirect, to cause the
    direction or management of such entity, whether by contract or
    otherwise, or (ii) ownership of fifty percent (50%) or more of the
    outstanding shares, or (iii) beneficial ownership of such entity.

    "You" (or "Your") shall mean an individual or Legal Entity
    exercising permissions granted by this License.

    "Source" form shall mean the preferred form for making modifications,
    including but not limited to software source code, documentation
    source, and configuration files.

    "Object" form shall mean any form resulting from mechanical
    transformation or translation of a Source form, including but
    not limited to compiled object code, generated documentation,
    and conversions to other media types.

    "Work" shall mean the work of authorship, whether in Source or
    Object form, made available under the License, as indicated by a
    copyright notice that is included in or attached to the work
    (an example is provided in the Appendix below).

    "Derivative Works" shall mean any work, whether in Source or Object
    form, that is based on (or derived from) the Work and for which the
    editorial revisions, annotations, elaborations, or other modifications
    represent, as a whole, an original work of authorship. For the purposes
    of this License, Derivative Works shall not include works that remain
    separable from, or merely link (or bind by name) to the interfaces of,
    the Work and Derivative Works thereof.

    "Contribution" shall mean any work of authorship, including
    the original version of the Work and any modifications or additions
    to that Work or Derivative Works thereof, that is intentionally
    submitted to Licensor for inclusion in the Work by the copyright owner
    or by an individual or Legal Entity authorized to submit on behalf of
    the copyright owner. For the purposes of this definition, "submitted"
    means any form of electronic, verbal, or written communication sent
    to the Licensor or its representatives, including but not limited to
    communication on electronic mailing lists, source code control systems,
    and issue tracking systems that are managed by, or on behalf of, the
    Licensor for the purpose of discussing and improving the Work, but
    excluding communication that is conspicuously marked or otherwise
    designated in writing by the copyright owner as "Not a Contribution."

    "Contributor" shall mean Licensor and any individual or Legal Entity
    on behalf of whom a Contribution has been received by Licensor and
    subsequently incorporated within the Work.

 2. Grant of Copyright License. Subject to the terms and conditions of
    this License, each Contributor hereby grants to You a perpetual,
    worldwide, non-exclusive, no-charge, royalty-free, irrevocable
    copyright license to reproduce, prepare Derivative Works of,
    publicly display, publicly perform, sublicense, and distribute the
    Work and such Derivative Works in Source or Object form.

 3. Grant of Patent License. Subject to the terms and conditions of
    this License, each Contributor hereby grants to You a perpetual,
    worldwide, non-exclusive, no-charge, royalty-free, irrevocable
    (except as stated in this section) patent license to make, have made,
    use, offer to sell, sell, import, and otherwise transfer the Work,
    where such license applies only to those patent claims licensable
    by such Contributor that are necessarily infringed by their
    Contribution(s) alone or by combination of their Contribution(s)
    with the Work to which such Contribution(s) was submitted. If You
    institute patent litigation against any entity (including a
    cross-claim or counterclaim in a lawsuit) alleging that the Work
    or a Contribution incorporated within the Work constitutes direct
    or contributory patent infringement, then any patent licenses
    granted to You under this License for that Work shall terminate
    as of the date such litigation is filed.

 4. Redistribution. You may reproduce and distribute copies of the
    Work or Derivative Works thereof in any medium, with or without
    modifications, and in Source or Object form, provided that You
    meet the following conditions:

    (a) You must give any other recipients of the Work or
        Derivative Works a copy of this License; and

    (b) You must cause any modified files to carry prominent notices
        stating that You changed the files; and

    (c) You must retain, in the Source form of any Derivative Works
        that You distribute, all copyright, patent, trademark, and
        attribution notices from the Source form of the Work,
        excluding those notices that do not pertain to any part of
        the Derivative Works; and

    (d) If the Work includes a "NOTICE" text file as part of its
        distribution, then any Derivative Works that You distribute must
        include a readable copy of the attribution notices contained
        within such NOTICE file, excluding those notices that do not
        pertain to any part of the Derivative Works, in at least one
        of the following places: within a NOTICE text file distributed
        as part of the Derivative Works; within the Source form or
        documentation, if provided along with the Derivative Works; or,
        within a display generated by the Derivative Works, if and
        wherever such third-party notices normally appear. The contents
        of the NOTICE file are for informational purposes only and
        do not modify the License. You may add Your own attribution
        notices within Derivative Works that You distribute, alongside
        or as an addendum to the NOTICE text from the Work, provided
        that such additional attribution notices cannot be construed
        as modifying the License.

    You may add Your own copyright statement to Your modifications and
    may provide additional or different license terms and conditions
    for use, reproduction, or distribution of Your modifications, or
    for any such Derivative Works as a whole, provided Your use,
    reproduction, and distribution of the Work otherwise complies with
    the conditions stated in this License.

 5. Submission of Contributions. Unless You explicitly state otherwise,
    any Contribution intentionally submitted for inclusion in the Work
    by You to the Licensor shall be under the terms and conditions of
    this License, without any additional terms or conditions.
    Notwithstanding the above, nothing herein shall supersede or modify
    the terms of any separate license agreement you may have executed
    with Licensor regarding such Contributions.

 6. Trademarks. This License does not grant permission to use the trade
    names, trademarks, service marks, or product names of the Licensor,
    except as required for reasonable and customary use in describing the
    origin of the Work and reproducing the content of the NOTICE file.

 7. Disclaimer of Warranty. Unless required by applicable law or
    agreed to in writing, Licensor provides the Work (and each
    Contributor provides its Contributions) on an "AS IS" BASIS,
    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or
    implied, including, without limitation, any warranties or conditions
    of TITLE, NON-INFRINGEMENT, MERCHANTABILITY, or FITNESS FOR A
    PARTICULAR PURPOSE. You are solely responsible for determining the
    appropriateness of using or redistributing the Work and assume any
    risks associated with Your exercise of permissions under this License.

 8. Limitation of Liability. In no event and under no legal theory,
    whether in tort (including negligence), contract, or otherwise,
    unless required by applicable law (such as deliberate and grossly
    negligent acts) or agreed to in writing, shall any Contributor be
    liable to You for damages, including any direct, indirect, special,
    incidental, or consequential damages of any character arising as a
    result of this License or out of the use or inability to use the
    Work (including but not limited to damages for loss of goodwill,
    work stoppage, computer failure or malfunction, or any and all
    other commercial damages or losses), even if such Contributor
    has been advised of the possibility of such damages.

 9. Accepting Warranty or Additional Liability. While redistributing
    the Work or Derivative Works thereof, You may choose to offer,
    and charge a fee for, acceptance of support, warranty, indemnity,
    or other liability obligations and/or rights consistent with this
    License. However, in accepting such obligations, You may act only
    on Your own behalf and on Your sole responsibility, not on behalf
    of any other Contributor, and only if You agree to indemnify,
    defend, and hold each Contributor harmless for any liability
    incurred by, or claims asserted against, such Contributor by reason
    of your accepting any such warranty or additional liability.

 END OF TERMS AND CONDITIONS

 APPENDIX: How to apply the Apache License to your work.

    To apply the Apache License to your work, attach the following
    boilerplate notice, with the fields enclosed by brackets "[]"
    replaced with your own identifying information. (Don't include
    the brackets!)  The text should be enclosed in the appropriate
    comment syntax for the file format. We also recommend that a
    file or class name and description of purpose be included on the
    same "printed page" as the copyright notice for easier
    identification within third-party archives.

 Copyright (c) 2015-2018 Google, Inc., Netflix, Inc., Microsoft Corp. and contributors

 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

     http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.
 

 **/
/**
  @license
                                 Apache License
                         Version 2.0, January 2004
                      http://www.apache.org/licenses/

 TERMS AND CONDITIONS FOR USE, REPRODUCTION, AND DISTRIBUTION

 1. Definitions.

    "License" shall mean the terms and conditions for use, reproduction,
    and distribution as defined by Sections 1 through 9 of this document.

    "Licensor" shall mean the copyright owner or entity authorized by
    the copyright owner that is granting the License.

    "Legal Entity" shall mean the union of the acting entity and all
    other entities that control, are controlled by, or are under common
    control with that entity. For the purposes of this definition,
    "control" means (i) the power, direct or indirect, to cause the
    direction or management of such entity, whether by contract or
    otherwise, or (ii) ownership of fifty percent (50%) or more of the
    outstanding shares, or (iii) beneficial ownership of such entity.

    "You" (or "Your") shall mean an individual or Legal Entity
    exercising permissions granted by this License.

    "Source" form shall mean the preferred form for making modifications,
    including but not limited to software source code, documentation
    source, and configuration files.

    "Object" form shall mean any form resulting from mechanical
    transformation or translation of a Source form, including but
    not limited to compiled object code, generated documentation,
    and conversions to other media types.

    "Work" shall mean the work of authorship, whether in Source or
    Object form, made available under the License, as indicated by a
    copyright notice that is included in or attached to the work
    (an example is provided in the Appendix below).

    "Derivative Works" shall mean any work, whether in Source or Object
    form, that is based on (or derived from) the Work and for which the
    editorial revisions, annotations, elaborations, or other modifications
    represent, as a whole, an original work of authorship. For the purposes
    of this License, Derivative Works shall not include works that remain
    separable from, or merely link (or bind by name) to the interfaces of,
    the Work and Derivative Works thereof.

    "Contribution" shall mean any work of authorship, including
    the original version of the Work and any modifications or additions
    to that Work or Derivative Works thereof, that is intentionally
    submitted to Licensor for inclusion in the Work by the copyright owner
    or by an individual or Legal Entity authorized to submit on behalf of
    the copyright owner. For the purposes of this definition, "submitted"
    means any form of electronic, verbal, or written communication sent
    to the Licensor or its representatives, including but not limited to
    communication on electronic mailing lists, source code control systems,
    and issue tracking systems that are managed by, or on behalf of, the
    Licensor for the purpose of discussing and improving the Work, but
    excluding communication that is conspicuously marked or otherwise
    designated in writing by the copyright owner as "Not a Contribution."

    "Contributor" shall mean Licensor and any individual or Legal Entity
    on behalf of whom a Contribution has been received by Licensor and
    subsequently incorporated within the Work.

 2. Grant of Copyright License. Subject to the terms and conditions of
    this License, each Contributor hereby grants to You a perpetual,
    worldwide, non-exclusive, no-charge, royalty-free, irrevocable
    copyright license to reproduce, prepare Derivative Works of,
    publicly display, publicly perform, sublicense, and distribute the
    Work and such Derivative Works in Source or Object form.

 3. Grant of Patent License. Subject to the terms and conditions of
    this License, each Contributor hereby grants to You a perpetual,
    worldwide, non-exclusive, no-charge, royalty-free, irrevocable
    (except as stated in this section) patent license to make, have made,
    use, offer to sell, sell, import, and otherwise transfer the Work,
    where such license applies only to those patent claims licensable
    by such Contributor that are necessarily infringed by their
    Contribution(s) alone or by combination of their Contribution(s)
    with the Work to which such Contribution(s) was submitted. If You
    institute patent litigation against any entity (including a
    cross-claim or counterclaim in a lawsuit) alleging that the Work
    or a Contribution incorporated within the Work constitutes direct
    or contributory patent infringement, then any patent licenses
    granted to You under this License for that Work shall terminate
    as of the date such litigation is filed.

 4. Redistribution. You may reproduce and distribute copies of the
    Work or Derivative Works thereof in any medium, with or without
    modifications, and in Source or Object form, provided that You
    meet the following conditions:

    (a) You must give any other recipients of the Work or
        Derivative Works a copy of this License; and

    (b) You must cause any modified files to carry prominent notices
        stating that You changed the files; and

    (c) You must retain, in the Source form of any Derivative Works
        that You distribute, all copyright, patent, trademark, and
        attribution notices from the Source form of the Work,
        excluding those notices that do not pertain to any part of
        the Derivative Works; and

    (d) If the Work includes a "NOTICE" text file as part of its
        distribution, then any Derivative Works that You distribute must
        include a readable copy of the attribution notices contained
        within such NOTICE file, excluding those notices that do not
        pertain to any part of the Derivative Works, in at least one
        of the following places: within a NOTICE text file distributed
        as part of the Derivative Works; within the Source form or
        documentation, if provided along with the Derivative Works; or,
        within a display generated by the Derivative Works, if and
        wherever such third-party notices normally appear. The contents
        of the NOTICE file are for informational purposes only and
        do not modify the License. You may add Your own attribution
        notices within Derivative Works that You distribute, alongside
        or as an addendum to the NOTICE text from the Work, provided
        that such additional attribution notices cannot be construed
        as modifying the License.

    You may add Your own copyright statement to Your modifications and
    may provide additional or different license terms and conditions
    for use, reproduction, or distribution of Your modifications, or
    for any such Derivative Works as a whole, provided Your use,
    reproduction, and distribution of the Work otherwise complies with
    the conditions stated in this License.

 5. Submission of Contributions. Unless You explicitly state otherwise,
    any Contribution intentionally submitted for inclusion in the Work
    by You to the Licensor shall be under the terms and conditions of
    this License, without any additional terms or conditions.
    Notwithstanding the above, nothing herein shall supersede or modify
    the terms of any separate license agreement you may have executed
    with Licensor regarding such Contributions.

 6. Trademarks. This License does not grant permission to use the trade
    names, trademarks, service marks, or product names of the Licensor,
    except as required for reasonable and customary use in describing the
    origin of the Work and reproducing the content of the NOTICE file.

 7. Disclaimer of Warranty. Unless required by applicable law or
    agreed to in writing, Licensor provides the Work (and each
    Contributor provides its Contributions) on an "AS IS" BASIS,
    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or
    implied, including, without limitation, any warranties or conditions
    of TITLE, NON-INFRINGEMENT, MERCHANTABILITY, or FITNESS FOR A
    PARTICULAR PURPOSE. You are solely responsible for determining the
    appropriateness of using or redistributing the Work and assume any
    risks associated with Your exercise of permissions under this License.

 8. Limitation of Liability. In no event and under no legal theory,
    whether in tort (including negligence), contract, or otherwise,
    unless required by applicable law (such as deliberate and grossly
    negligent acts) or agreed to in writing, shall any Contributor be
    liable to You for damages, including any direct, indirect, special,
    incidental, or consequential damages of any character arising as a
    result of this License or out of the use or inability to use the
    Work (including but not limited to damages for loss of goodwill,
    work stoppage, computer failure or malfunction, or any and all
    other commercial damages or losses), even if such Contributor
    has been advised of the possibility of such damages.

 9. Accepting Warranty or Additional Liability. While redistributing
    the Work or Derivative Works thereof, You may choose to offer,
    and charge a fee for, acceptance of support, warranty, indemnity,
    or other liability obligations and/or rights consistent with this
    License. However, in accepting such obligations, You may act only
    on Your own behalf and on Your sole responsibility, not on behalf
    of any other Contributor, and only if You agree to indemnify,
    defend, and hold each Contributor harmless for any liability
    incurred by, or claims asserted against, such Contributor by reason
    of your accepting any such warranty or additional liability.

 END OF TERMS AND CONDITIONS

 APPENDIX: How to apply the Apache License to your work.

    To apply the Apache License to your work, attach the following
    boilerplate notice, with the fields enclosed by brackets "[]"
    replaced with your own identifying information. (Don't include
    the brackets!)  The text should be enclosed in the appropriate
    comment syntax for the file format. We also recommend that a
    file or class name and description of purpose be included on the
    same "printed page" as the copyright notice for easier
    identification within third-party archives.

 Copyright (c) 2015-2018 Google, Inc., Netflix, Inc., Microsoft Corp. and contributors

 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

     http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.
 

 **/
function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define("rxjs",["exports"],t):t(e.rxjs={})}(this,(function(e){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};function n(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}var r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e};function i(e){return"function"==typeof e}var o=!1,a={Promise:void 0,set useDeprecatedSynchronousErrorHandling(e){if(e){var t=new Error;console.warn("DEPRECATED! RxJS was set to use deprecated synchronous error handling behavior by code at: \n"+t.stack)}else o&&console.log("RxJS: Back to a better error behavior. Thank you. <3");o=e},get useDeprecatedSynchronousErrorHandling(){return o}};function s(e){setTimeout((function(){throw e}),0)}var c={closed:!0,next:function(e){},error:function(e){if(a.useDeprecatedSynchronousErrorHandling)throw e;s(e)},complete:function(){}},u=Array.isArray||function(e){return e&&"number"==typeof e.length};function l(e){return null!==e&&"object"==typeof e}var d=function(){function e(e){return Error.call(this),this.message=e?e.length+" errors occurred during unsubscription:\n"+e.map((function(e,t){return t+1+") "+e.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=e,this}return e.prototype=Object.create(Error.prototype),e}(),h=function(){function e(e){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,e&&(this._ctorUnsubscribe=!0,this._unsubscribe=e)}return e.prototype.unsubscribe=function(){var t;if(!this.closed){var n=this,r=n._parentOrParents,o=n._ctorUnsubscribe,a=n._unsubscribe,s=n._subscriptions;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,r instanceof e)r.remove(this);else if(null!==r)for(var c=0;c<r.length;++c){r[c].remove(this)}if(i(a)){o&&(this._unsubscribe=void 0);try{a.call(this)}catch(e){t=e instanceof d?f(e.errors):[e]}}if(u(s)){c=-1;for(var h=s.length;++c<h;){var p=s[c];if(l(p))try{p.unsubscribe()}catch(e){t=t||[],e instanceof d?t=t.concat(f(e.errors)):t.push(e)}}}if(t)throw new d(t)}},e.prototype.add=function(t){var n=t;if(!t)return e.EMPTY;switch(typeof t){case"function":n=new e(t);case"object":if(n===this||n.closed||"function"!=typeof n.unsubscribe)return n;if(this.closed)return n.unsubscribe(),n;if(!(n instanceof e)){var r=n;(n=new e)._subscriptions=[r]}break;default:throw new Error("unrecognized teardown "+t+" added to Subscription.")}var i=n._parentOrParents;if(null===i)n._parentOrParents=this;else if(i instanceof e){if(i===this)return n;n._parentOrParents=[i,this]}else{if(-1!==i.indexOf(this))return n;i.push(this)}var o=this._subscriptions;return null===o?this._subscriptions=[n]:o.push(n),n},e.prototype.remove=function(e){var t=this._subscriptions;if(t){var n=t.indexOf(e);-1!==n&&t.splice(n,1)}},e.EMPTY=function(e){return e.closed=!0,e}(new e),e}();function f(e){return e.reduce((function(e,t){return e.concat(t instanceof d?t.errors:t)}),[])}var p="function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random(),A=function(e){function t(n,r,i){var o=e.call(this)||this;switch(o.syncErrorValue=null,o.syncErrorThrown=!1,o.syncErrorThrowable=!1,o.isStopped=!1,arguments.length){case 0:o.destination=c;break;case 1:if(!n){o.destination=c;break}if("object"==typeof n){n instanceof t?(o.syncErrorThrowable=n.syncErrorThrowable,o.destination=n,n.add(o)):(o.syncErrorThrowable=!0,o.destination=new g(o,n));break}default:o.syncErrorThrowable=!0,o.destination=new g(o,n,r,i)}return o}return n(t,e),t.prototype[p]=function(){return this},t.create=function(e,n,r){var i=new t(e,n,r);return i.syncErrorThrowable=!1,i},t.prototype.next=function(e){this.isStopped||this._next(e)},t.prototype.error=function(e){this.isStopped||(this.isStopped=!0,this._error(e))},t.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this))},t.prototype._next=function(e){this.destination.next(e)},t.prototype._error=function(e){this.destination.error(e),this.unsubscribe()},t.prototype._complete=function(){this.destination.complete(),this.unsubscribe()},t.prototype._unsubscribeAndRecycle=function(){var e=this._parentOrParents;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=e,this},t}(h),g=function(e){function t(t,n,r,o){var a,s=e.call(this)||this;s._parentSubscriber=t;var u=s;return i(n)?a=n:n&&(a=n.next,r=n.error,o=n.complete,n!==c&&(i((u=Object.create(n)).unsubscribe)&&s.add(u.unsubscribe.bind(u)),u.unsubscribe=s.unsubscribe.bind(s))),s._context=u,s._next=a,s._error=r,s._complete=o,s}return n(t,e),t.prototype.next=function(e){if(!this.isStopped&&this._next){var t=this._parentSubscriber;a.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?this.__tryOrSetError(t,this._next,e)&&this.unsubscribe():this.__tryOrUnsub(this._next,e)}},t.prototype.error=function(e){if(!this.isStopped){var t=this._parentSubscriber,n=a.useDeprecatedSynchronousErrorHandling;if(this._error)n&&t.syncErrorThrowable?(this.__tryOrSetError(t,this._error,e),this.unsubscribe()):(this.__tryOrUnsub(this._error,e),this.unsubscribe());else if(t.syncErrorThrowable)n?(t.syncErrorValue=e,t.syncErrorThrown=!0):s(e),this.unsubscribe();else{if(this.unsubscribe(),n)throw e;s(e)}}},t.prototype.complete=function(){var e=this;if(!this.isStopped){var t=this._parentSubscriber;if(this._complete){var n=function(){return e._complete.call(e._context)};a.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?(this.__tryOrSetError(t,n),this.unsubscribe()):(this.__tryOrUnsub(n),this.unsubscribe())}else this.unsubscribe()}},t.prototype.__tryOrUnsub=function(e,t){try{e.call(this._context,t)}catch(e){if(this.unsubscribe(),a.useDeprecatedSynchronousErrorHandling)throw e;s(e)}},t.prototype.__tryOrSetError=function(e,t,n){if(!a.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{t.call(this._context,n)}catch(t){return a.useDeprecatedSynchronousErrorHandling?(e.syncErrorValue=t,e.syncErrorThrown=!0,!0):(s(t),!0)}return!1},t.prototype._unsubscribe=function(){var e=this._parentSubscriber;this._context=null,this._parentSubscriber=null,e.unsubscribe()},t}(A);function v(e){for(;e;){var t=e,n=t.closed,r=t.destination,i=t.isStopped;if(n||i)return!1;e=r&&r instanceof A?r:null}return!0}var m="function"==typeof Symbol&&Symbol.observable||"@@observable";function y(e){return e}function b(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return E(e)}function E(e){return 0===e.length?y:1===e.length?e[0]:function(t){return e.reduce((function(e,t){return t(e)}),t)}}var _=function(){function e(e){this._isScalar=!1,e&&(this._subscribe=e)}return e.prototype.lift=function(t){var n=new e;return n.source=this,n.operator=t,n},e.prototype.subscribe=function(e,t,n){var r=this.operator,i=function(e,t,n){if(e){if(e instanceof A)return e;if(e[p])return e[p]()}return e||t||n?new A(e,t,n):new A(c)}(e,t,n);if(r?i.add(r.call(i,this.source)):i.add(this.source||a.useDeprecatedSynchronousErrorHandling&&!i.syncErrorThrowable?this._subscribe(i):this._trySubscribe(i)),a.useDeprecatedSynchronousErrorHandling&&i.syncErrorThrowable&&(i.syncErrorThrowable=!1,i.syncErrorThrown))throw i.syncErrorValue;return i},e.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){a.useDeprecatedSynchronousErrorHandling&&(e.syncErrorThrown=!0,e.syncErrorValue=t),v(e)?e.error(t):console.warn(t)}},e.prototype.forEach=function(e,t){var n=this;return new(t=w(t))((function(t,r){var i;i=n.subscribe((function(t){try{e(t)}catch(e){r(e),i&&i.unsubscribe()}}),r,t)}))},e.prototype._subscribe=function(e){var t=this.source;return t&&t.subscribe(e)},e.prototype[m]=function(){return this},e.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return 0===e.length?this:E(e)(this)},e.prototype.toPromise=function(e){var t=this;return new(e=w(e))((function(e,n){var r;t.subscribe((function(e){return r=e}),(function(e){return n(e)}),(function(){return e(r)}))}))},e.create=function(t){return new e(t)},e}();function w(e){if(e||(e=a.Promise||Promise),!e)throw new Error("no Promise impl found");return e}var S=function(){function e(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return e.prototype=Object.create(Error.prototype),e}(),T=function(e){function t(t,n){var r=e.call(this)||this;return r.subject=t,r.subscriber=n,r.closed=!1,r}return n(t,e),t.prototype.unsubscribe=function(){if(!this.closed){this.closed=!0;var e=this.subject,t=e.observers;if(this.subject=null,t&&0!==t.length&&!e.isStopped&&!e.closed){var n=t.indexOf(this.subscriber);-1!==n&&t.splice(n,1)}}},t}(h),R=function(e){function t(t){var n=e.call(this,t)||this;return n.destination=t,n}return n(t,e),t}(A),C=function(e){function t(){var t=e.call(this)||this;return t.observers=[],t.closed=!1,t.isStopped=!1,t.hasError=!1,t.thrownError=null,t}return n(t,e),t.prototype[p]=function(){return new R(this)},t.prototype.lift=function(e){var t=new I(this,this);return t.operator=e,t},t.prototype.next=function(e){if(this.closed)throw new S;if(!this.isStopped)for(var t=this.observers,n=t.length,r=t.slice(),i=0;i<n;i++)r[i].next(e)},t.prototype.error=function(e){if(this.closed)throw new S;this.hasError=!0,this.thrownError=e,this.isStopped=!0;for(var t=this.observers,n=t.length,r=t.slice(),i=0;i<n;i++)r[i].error(e);this.observers.length=0},t.prototype.complete=function(){if(this.closed)throw new S;this.isStopped=!0;for(var e=this.observers,t=e.length,n=e.slice(),r=0;r<t;r++)n[r].complete();this.observers.length=0},t.prototype.unsubscribe=function(){this.isStopped=!0,this.closed=!0,this.observers=null},t.prototype._trySubscribe=function(t){if(this.closed)throw new S;return e.prototype._trySubscribe.call(this,t)},t.prototype._subscribe=function(e){if(this.closed)throw new S;return this.hasError?(e.error(this.thrownError),h.EMPTY):this.isStopped?(e.complete(),h.EMPTY):(this.observers.push(e),new T(this,e))},t.prototype.asObservable=function(){var e=new _;return e.source=this,e},t.create=function(e,t){return new I(e,t)},t}(_),I=function(e){function t(t,n){var r=e.call(this)||this;return r.destination=t,r.source=n,r}return n(t,e),t.prototype.next=function(e){var t=this.destination;t&&t.next&&t.next(e)},t.prototype.error=function(e){var t=this.destination;t&&t.error&&this.destination.error(e)},t.prototype.complete=function(){var e=this.destination;e&&e.complete&&this.destination.complete()},t.prototype._subscribe=function(e){return this.source?this.source.subscribe(e):h.EMPTY},t}(C);function x(){return function(e){return e.lift(new N(e))}}var O,N=function(){function e(e){this.connectable=e}return e.prototype.call=function(e,t){var n=this.connectable;n._refCount++;var r=new B(e,n),i=t.subscribe(r);return r.closed||(r.connection=n.connect()),i},e}(),B=function(e){function t(t,n){var r=e.call(this,t)||this;return r.connectable=n,r}return n(t,e),t.prototype._unsubscribe=function(){var e=this.connectable;if(e){this.connectable=null;var t=e._refCount;if(t<=0)this.connection=null;else if(e._refCount=t-1,t>1)this.connection=null;else{var n=this.connection,r=e._connection;this.connection=null,!r||n&&r!==n||r.unsubscribe()}}else this.connection=null},t}(A),M=function(e){function t(t,n){var r=e.call(this)||this;return r.source=t,r.subjectFactory=n,r._refCount=0,r._isComplete=!1,r}return n(t,e),t.prototype._subscribe=function(e){return this.getSubject().subscribe(e)},t.prototype.getSubject=function(){var e=this._subject;return e&&!e.isStopped||(this._subject=this.subjectFactory()),this._subject},t.prototype.connect=function(){var e=this._connection;return e||(this._isComplete=!1,(e=this._connection=new h).add(this.source.subscribe(new k(this.getSubject(),this))),e.closed&&(this._connection=null,e=h.EMPTY)),e},t.prototype.refCount=function(){return x()(this)},t}(_),L={operator:{value:null},_refCount:{value:0,writable:!0},_subject:{value:null,writable:!0},_connection:{value:null,writable:!0},_subscribe:{value:(O=M.prototype)._subscribe},_isComplete:{value:O._isComplete,writable:!0},getSubject:{value:O.getSubject},connect:{value:O.connect},refCount:{value:O.refCount}},k=function(e){function t(t,n){var r=e.call(this,t)||this;return r.connectable=n,r}return n(t,e),t.prototype._error=function(t){this._unsubscribe(),e.prototype._error.call(this,t)},t.prototype._complete=function(){this.connectable._isComplete=!0,this._unsubscribe(),e.prototype._complete.call(this)},t.prototype._unsubscribe=function(){var e=this.connectable;if(e){this.connectable=null;var t=e._connection;e._refCount=0,e._subject=null,e._connection=null,t&&t.unsubscribe()}},t}(R);!function(e){function t(t,n){var r=e.call(this,t)||this;return r.connectable=n,r}n(t,e),t.prototype._unsubscribe=function(){var e=this.connectable;if(e){this.connectable=null;var t=e._refCount;if(t<=0)this.connection=null;else if(e._refCount=t-1,t>1)this.connection=null;else{var n=this.connection,r=e._connection;this.connection=null,!r||n&&r!==n||r.unsubscribe()}}else this.connection=null}}(A);var U=function(){function e(e,t,n,r){this.keySelector=e,this.elementSelector=t,this.durationSelector=n,this.subjectSelector=r}return e.prototype.call=function(e,t){return t.subscribe(new D(e,this.keySelector,this.elementSelector,this.durationSelector,this.subjectSelector))},e}(),D=function(e){function t(t,n,r,i,o){var a=e.call(this,t)||this;return a.keySelector=n,a.elementSelector=r,a.durationSelector=i,a.subjectSelector=o,a.groups=null,a.attemptedToUnsubscribe=!1,a.count=0,a}return n(t,e),t.prototype._next=function(e){var t;try{t=this.keySelector(e)}catch(e){return void this.error(e)}this._group(e,t)},t.prototype._group=function(e,t){var n=this.groups;n||(n=this.groups=new Map);var r,i=n.get(t);if(this.elementSelector)try{r=this.elementSelector(e)}catch(e){this.error(e)}else r=e;if(!i){i=this.subjectSelector?this.subjectSelector():new C,n.set(t,i);var o=new F(t,i,this);if(this.destination.next(o),this.durationSelector){var a=void 0;try{a=this.durationSelector(new F(t,i))}catch(e){return void this.error(e)}this.add(a.subscribe(new P(t,i,this)))}}i.closed||i.next(r)},t.prototype._error=function(e){var t=this.groups;t&&(t.forEach((function(t,n){t.error(e)})),t.clear()),this.destination.error(e)},t.prototype._complete=function(){var e=this.groups;e&&(e.forEach((function(e,t){e.complete()})),e.clear()),this.destination.complete()},t.prototype.removeGroup=function(e){this.groups.delete(e)},t.prototype.unsubscribe=function(){this.closed||(this.attemptedToUnsubscribe=!0,0===this.count&&e.prototype.unsubscribe.call(this))},t}(A),P=function(e){function t(t,n,r){var i=e.call(this,n)||this;return i.key=t,i.group=n,i.parent=r,i}return n(t,e),t.prototype._next=function(e){this.complete()},t.prototype._unsubscribe=function(){var e=this.parent,t=this.key;this.key=this.parent=null,e&&e.removeGroup(t)},t}(A),F=function(e){function t(t,n,r){var i=e.call(this)||this;return i.key=t,i.groupSubject=n,i.refCountSubscription=r,i}return n(t,e),t.prototype._subscribe=function(e){var t=new h,n=this.refCountSubscription,r=this.groupSubject;return n&&!n.closed&&t.add(new H(n)),t.add(r.subscribe(e)),t},t}(_),H=function(e){function t(t){var n=e.call(this)||this;return n.parent=t,t.count++,n}return n(t,e),t.prototype.unsubscribe=function(){var t=this.parent;t.closed||this.closed||(e.prototype.unsubscribe.call(this),t.count-=1,0===t.count&&t.attemptedToUnsubscribe&&t.unsubscribe())},t}(h),j=function(e){function t(t){var n=e.call(this)||this;return n._value=t,n}return n(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this.getValue()},enumerable:!0,configurable:!0}),t.prototype._subscribe=function(t){var n=e.prototype._subscribe.call(this,t);return n&&!n.closed&&t.next(this._value),n},t.prototype.getValue=function(){if(this.hasError)throw this.thrownError;if(this.closed)throw new S;return this._value},t.prototype.next=function(t){e.prototype.next.call(this,this._value=t)},t}(C),V=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.scheduler=t,r.work=n,r.pending=!1,r}return n(t,e),t.prototype.schedule=function(e,t){if(void 0===t&&(t=0),this.closed)return this;this.state=e;var n=this.id,r=this.scheduler;return null!=n&&(this.id=this.recycleAsyncId(r,n,t)),this.pending=!0,this.delay=t,this.id=this.id||this.requestAsyncId(r,this.id,t),this},t.prototype.requestAsyncId=function(e,t,n){return void 0===n&&(n=0),setInterval(e.flush.bind(e,this),n)},t.prototype.recycleAsyncId=function(e,t,n){if(void 0===n&&(n=0),null!==n&&this.delay===n&&!1===this.pending)return t;clearInterval(t)},t.prototype.execute=function(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var n=this._execute(e,t);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},t.prototype._execute=function(e,t){var n=!1,r=void 0;try{this.work(e)}catch(e){n=!0,r=!!e&&e||new Error(e)}if(n)return this.unsubscribe(),r},t.prototype._unsubscribe=function(){var e=this.id,t=this.scheduler,n=t.actions,r=n.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==r&&n.splice(r,1),null!=e&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null},t}(function(e){function t(t,n){return e.call(this)||this}return n(t,e),t.prototype.schedule=function(e,t){return void 0===t&&(t=0),this},t}(h)),Q=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.scheduler=t,r.work=n,r}return n(t,e),t.prototype.schedule=function(t,n){return void 0===n&&(n=0),n>0?e.prototype.schedule.call(this,t,n):(this.delay=n,this.state=t,this.scheduler.flush(this),this)},t.prototype.execute=function(t,n){return n>0||this.closed?e.prototype.execute.call(this,t,n):this._execute(t,n)},t.prototype.requestAsyncId=function(t,n,r){return void 0===r&&(r=0),null!==r&&r>0||null===r&&this.delay>0?e.prototype.requestAsyncId.call(this,t,n,r):t.flush(this)},t}(V),G=function(){function e(t,n){void 0===n&&(n=e.now),this.SchedulerAction=t,this.now=n}return e.prototype.schedule=function(e,t,n){return void 0===t&&(t=0),new this.SchedulerAction(this,e).schedule(n,t)},e.now=function(){return Date.now()},e}(),z=function(e){function t(n,r){void 0===r&&(r=G.now);var i=e.call(this,n,(function(){return t.delegate&&t.delegate!==i?t.delegate.now():r()}))||this;return i.actions=[],i.active=!1,i.scheduled=void 0,i}return n(t,e),t.prototype.schedule=function(n,r,i){return void 0===r&&(r=0),t.delegate&&t.delegate!==this?t.delegate.schedule(n,r,i):e.prototype.schedule.call(this,n,r,i)},t.prototype.flush=function(e){var t=this.actions;if(this.active)t.push(e);else{var n;this.active=!0;do{if(n=e.execute(e.state,e.delay))break}while(e=t.shift());if(this.active=!1,n){for(;e=t.shift();)e.unsubscribe();throw n}}},t}(G),K=new(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t}(z))(Q),q=K,W=new _((function(e){return e.complete()}));function X(e){return e?function(e){return new _((function(t){return e.schedule((function(){return t.complete()}))}))}(e):W}function J(e){return e&&"function"==typeof e.schedule}var Y,Z=function(e){return function(t){for(var n=0,r=e.length;n<r&&!t.closed;n++)t.next(e[n]);t.complete()}};function $(e,t){return new _((function(n){var r=new h,i=0;return r.add(t.schedule((function(){i!==e.length?(n.next(e[i++]),n.closed||r.add(this.schedule())):n.complete()}))),r}))}function ee(e,t){return t?$(e,t):new _(Z(e))}function te(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=e[e.length-1];return J(n)?(e.pop(),$(e,n)):ee(e)}function ne(e,t){return new _(t?function(n){return t.schedule(re,0,{error:e,subscriber:n})}:function(t){return t.error(e)})}function re(e){var t=e.error;e.subscriber.error(t)}(Y=e.NotificationKind||(e.NotificationKind={})).NEXT="N",Y.ERROR="E",Y.COMPLETE="C";var ie=function(){function e(e,t,n){this.kind=e,this.value=t,this.error=n,this.hasValue="N"===e}return e.prototype.observe=function(e){switch(this.kind){case"N":return e.next&&e.next(this.value);case"E":return e.error&&e.error(this.error);case"C":return e.complete&&e.complete()}},e.prototype.do=function(e,t,n){switch(this.kind){case"N":return e&&e(this.value);case"E":return t&&t(this.error);case"C":return n&&n()}},e.prototype.accept=function(e,t,n){return e&&"function"==typeof e.next?this.observe(e):this.do(e,t,n)},e.prototype.toObservable=function(){switch(this.kind){case"N":return te(this.value);case"E":return ne(this.error);case"C":return X()}throw new Error("unexpected notification kind value")},e.createNext=function(t){return void 0!==t?new e("N",t):e.undefinedValueNotification},e.createError=function(t){return new e("E",void 0,t)},e.createComplete=function(){return e.completeNotification},e.completeNotification=new e("C"),e.undefinedValueNotification=new e("N",void 0),e}();var oe=function(){function e(e,t){void 0===t&&(t=0),this.scheduler=e,this.delay=t}return e.prototype.call=function(e,t){return t.subscribe(new ae(e,this.scheduler,this.delay))},e}(),ae=function(e){function t(t,n,r){void 0===r&&(r=0);var i=e.call(this,t)||this;return i.scheduler=n,i.delay=r,i}return n(t,e),t.dispatch=function(e){var t=e.notification,n=e.destination;t.observe(n),this.unsubscribe()},t.prototype.scheduleMessage=function(e){this.destination.add(this.scheduler.schedule(t.dispatch,this.delay,new se(e,this.destination)))},t.prototype._next=function(e){this.scheduleMessage(ie.createNext(e))},t.prototype._error=function(e){this.scheduleMessage(ie.createError(e)),this.unsubscribe()},t.prototype._complete=function(){this.scheduleMessage(ie.createComplete()),this.unsubscribe()},t}(A),se=function(e,t){this.notification=e,this.destination=t},ce=function(e){function t(t,n,r){void 0===t&&(t=Number.POSITIVE_INFINITY),void 0===n&&(n=Number.POSITIVE_INFINITY);var i=e.call(this)||this;return i.scheduler=r,i._events=[],i._infiniteTimeWindow=!1,i._bufferSize=t<1?1:t,i._windowTime=n<1?1:n,n===Number.POSITIVE_INFINITY?(i._infiniteTimeWindow=!0,i.next=i.nextInfiniteTimeWindow):i.next=i.nextTimeWindow,i}return n(t,e),t.prototype.nextInfiniteTimeWindow=function(t){var n=this._events;n.push(t),n.length>this._bufferSize&&n.shift(),e.prototype.next.call(this,t)},t.prototype.nextTimeWindow=function(t){this._events.push(new ue(this._getNow(),t)),this._trimBufferThenGetEvents(),e.prototype.next.call(this,t)},t.prototype._subscribe=function(e){var t,n=this._infiniteTimeWindow,r=n?this._events:this._trimBufferThenGetEvents(),i=this.scheduler,o=r.length;if(this.closed)throw new S;if(this.isStopped||this.hasError?t=h.EMPTY:(this.observers.push(e),t=new T(this,e)),i&&e.add(e=new ae(e,i)),n)for(var a=0;a<o&&!e.closed;a++)e.next(r[a]);else for(a=0;a<o&&!e.closed;a++)e.next(r[a].value);return this.hasError?e.error(this.thrownError):this.isStopped&&e.complete(),t},t.prototype._getNow=function(){return(this.scheduler||q).now()},t.prototype._trimBufferThenGetEvents=function(){for(var e=this._getNow(),t=this._bufferSize,n=this._windowTime,r=this._events,i=r.length,o=0;o<i&&!(e-r[o].time<n);)o++;return i>t&&(o=Math.max(o,i-t)),o>0&&r.splice(0,o),r},t}(C),ue=function(e,t){this.time=e,this.value=t},le=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.value=null,t.hasNext=!1,t.hasCompleted=!1,t}return n(t,e),t.prototype._subscribe=function(t){return this.hasError?(t.error(this.thrownError),h.EMPTY):this.hasCompleted&&this.hasNext?(t.next(this.value),t.complete(),h.EMPTY):e.prototype._subscribe.call(this,t)},t.prototype.next=function(e){this.hasCompleted||(this.value=e,this.hasNext=!0)},t.prototype.error=function(t){this.hasCompleted||e.prototype.error.call(this,t)},t.prototype.complete=function(){this.hasCompleted=!0,this.hasNext&&e.prototype.next.call(this,this.value),e.prototype.complete.call(this)},t}(C),de=1,he=Promise.resolve(),fe={};function pe(e){return e in fe&&(delete fe[e],!0)}var Ae=function(e){var t=de++;return fe[t]=!0,he.then((function(){return pe(t)&&e()})),t},ge=function(e){pe(e)},ve=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.scheduler=t,r.work=n,r}return n(t,e),t.prototype.requestAsyncId=function(t,n,r){return void 0===r&&(r=0),null!==r&&r>0?e.prototype.requestAsyncId.call(this,t,n,r):(t.actions.push(this),t.scheduled||(t.scheduled=Ae(t.flush.bind(t,null))))},t.prototype.recycleAsyncId=function(t,n,r){if(void 0===r&&(r=0),null!==r&&r>0||null===r&&this.delay>0)return e.prototype.recycleAsyncId.call(this,t,n,r);0===t.actions.length&&(ge(n),t.scheduled=void 0)},t}(V),me=new(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.flush=function(e){this.active=!0,this.scheduled=void 0;var t,n=this.actions,r=-1,i=n.length;e=e||n.shift();do{if(t=e.execute(e.state,e.delay))break}while(++r<i&&(e=n.shift()));if(this.active=!1,t){for(;++r<i&&(e=n.shift());)e.unsubscribe();throw t}},t}(z))(ve),ye=me,be=new z(V),Ee=be,_e=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.scheduler=t,r.work=n,r}return n(t,e),t.prototype.requestAsyncId=function(t,n,r){return void 0===r&&(r=0),null!==r&&r>0?e.prototype.requestAsyncId.call(this,t,n,r):(t.actions.push(this),t.scheduled||(t.scheduled=requestAnimationFrame((function(){return t.flush(null)}))))},t.prototype.recycleAsyncId=function(t,n,r){if(void 0===r&&(r=0),null!==r&&r>0||null===r&&this.delay>0)return e.prototype.recycleAsyncId.call(this,t,n,r);0===t.actions.length&&(cancelAnimationFrame(n),t.scheduled=void 0)},t}(V),we=new(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.flush=function(e){this.active=!0,this.scheduled=void 0;var t,n=this.actions,r=-1,i=n.length;e=e||n.shift();do{if(t=e.execute(e.state,e.delay))break}while(++r<i&&(e=n.shift()));if(this.active=!1,t){for(;++r<i&&(e=n.shift());)e.unsubscribe();throw t}},t}(z))(_e),Se=we,Te=function(e){function t(t,n){void 0===t&&(t=Re),void 0===n&&(n=Number.POSITIVE_INFINITY);var r=e.call(this,t,(function(){return r.frame}))||this;return r.maxFrames=n,r.frame=0,r.index=-1,r}return n(t,e),t.prototype.flush=function(){for(var e,t,n=this.actions,r=this.maxFrames;(t=n[0])&&t.delay<=r&&(n.shift(),this.frame=t.delay,!(e=t.execute(t.state,t.delay))););if(e){for(;t=n.shift();)t.unsubscribe();throw e}},t.frameTimeFactor=10,t}(z),Re=function(e){function t(t,n,r){void 0===r&&(r=t.index+=1);var i=e.call(this,t,n)||this;return i.scheduler=t,i.work=n,i.index=r,i.active=!0,i.index=t.index=r,i}return n(t,e),t.prototype.schedule=function(n,r){if(void 0===r&&(r=0),!this.id)return e.prototype.schedule.call(this,n,r);this.active=!1;var i=new t(this.scheduler,this.work);return this.add(i),i.schedule(n,r)},t.prototype.requestAsyncId=function(e,n,r){void 0===r&&(r=0),this.delay=e.frame+r;var i=e.actions;return i.push(this),i.sort(t.sortActions),!0},t.prototype.recycleAsyncId=function(e,t,n){void 0===n&&(n=0)},t.prototype._execute=function(t,n){if(!0===this.active)return e.prototype._execute.call(this,t,n)},t.sortActions=function(e,t){return e.delay===t.delay?e.index===t.index?0:e.index>t.index?1:-1:e.delay>t.delay?1:-1},t}(V);function Ce(){}var Ie=function(){function e(){return Error.call(this),this.message="argument out of range",this.name="ArgumentOutOfRangeError",this}return e.prototype=Object.create(Error.prototype),e}(),xe=function(){function e(){return Error.call(this),this.message="no elements in sequence",this.name="EmptyError",this}return e.prototype=Object.create(Error.prototype),e}(),Oe=function(){function e(){return Error.call(this),this.message="Timeout has occurred",this.name="TimeoutError",this}return e.prototype=Object.create(Error.prototype),e}();function Ne(e,t){return function(n){if("function"!=typeof e)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return n.lift(new Be(e,t))}}var Be=function(){function e(e,t){this.project=e,this.thisArg=t}return e.prototype.call=function(e,t){return t.subscribe(new Me(e,this.project,this.thisArg))},e}(),Me=function(e){function t(t,n,r){var i=e.call(this,t)||this;return i.project=n,i.count=0,i.thisArg=r||i,i}return n(t,e),t.prototype._next=function(e){var t;try{t=this.project.call(this.thisArg,e,this.count++)}catch(e){return void this.destination.error(e)}this.destination.next(t)},t}(A);function Le(e){var t=this,n=e.args,r=e.subscriber,i=e.params,o=i.callbackFunc,a=i.context,s=i.scheduler,c=i.subject;if(!c){c=i.subject=new le;try{o.apply(a,n.concat([function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=e.length<=1?e[0]:e;t.add(s.schedule(ke,0,{value:r,subject:c}))}]))}catch(e){c.error(e)}}this.add(c.subscribe(r))}function ke(e){var t=e.value,n=e.subject;n.next(t),n.complete()}function Ue(e){var t=this,n=e.params,r=e.subscriber,i=e.context,o=n.callbackFunc,a=n.args,s=n.scheduler,c=n.subject;if(!c){c=n.subject=new le;try{o.apply(i,a.concat([function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=e.shift();if(r)t.add(s.schedule(Pe,0,{err:r,subject:c}));else{var i=e.length<=1?e[0]:e;t.add(s.schedule(De,0,{value:i,subject:c}))}}]))}catch(e){this.add(s.schedule(Pe,0,{err:e,subject:c}))}}this.add(c.subscribe(r))}function De(e){var t=e.value,n=e.subject;n.next(t),n.complete()}function Pe(e){var t=e.err;e.subject.error(t)}var Fe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.notifyNext=function(e,t,n,r,i){this.destination.next(t)},t.prototype.notifyError=function(e,t){this.destination.error(e)},t.prototype.notifyComplete=function(e){this.destination.complete()},t}(A),He=function(e){function t(t,n,r){var i=e.call(this)||this;return i.parent=t,i.outerValue=n,i.outerIndex=r,i.index=0,i}return n(t,e),t.prototype._next=function(e){this.parent.notifyNext(this.outerValue,e,this.outerIndex,this.index++,this)},t.prototype._error=function(e){this.parent.notifyError(e,this),this.unsubscribe()},t.prototype._complete=function(){this.parent.notifyComplete(this),this.unsubscribe()},t}(A);var je="function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator",Ve=function(e){return e&&"number"==typeof e.length&&"function"!=typeof e};function Qe(e){return!!e&&"function"!=typeof e.subscribe&&"function"==typeof e.then}var Ge=function(e){if(e&&"function"==typeof e[m])return r=e,function(e){var t=r[m]();if("function"!=typeof t.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return t.subscribe(e)};if(Ve(e))return Z(e);if(Qe(e))return n=e,function(e){return n.then((function(t){e.closed||(e.next(t),e.complete())}),(function(t){return e.error(t)})).then(null,s),e};if(e&&"function"==typeof e[je])return t=e,function(e){for(var n=t[je]();;){var r=void 0;try{r=n.next()}catch(t){return e.error(t),e}if(r.done){e.complete();break}if(e.next(r.value),e.closed)break}return"function"==typeof n.return&&e.add((function(){n.return&&n.return()})),e};var t,n,r,i=l(e)?"an invalid object":"'"+e+"'";throw new TypeError("You provided "+i+" where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.")};function ze(e,t,n,r,i){if(void 0===i&&(i=new He(e,n,r)),!i.closed)return t instanceof _?t.subscribe(i):Ge(t)(i)}var Ke={};var qe=function(){function e(e){this.resultSelector=e}return e.prototype.call=function(e,t){return t.subscribe(new We(e,this.resultSelector))},e}(),We=function(e){function t(t,n){var r=e.call(this,t)||this;return r.resultSelector=n,r.active=0,r.values=[],r.observables=[],r}return n(t,e),t.prototype._next=function(e){this.values.push(Ke),this.observables.push(e)},t.prototype._complete=function(){var e=this.observables,t=e.length;if(0===t)this.destination.complete();else{this.active=t,this.toRespond=t;for(var n=0;n<t;n++){var r=e[n];this.add(ze(this,r,void 0,n))}}},t.prototype.notifyComplete=function(e){0==(this.active-=1)&&this.destination.complete()},t.prototype.notifyNext=function(e,t,n){var r=this.values,i=r[n],o=this.toRespond?i===Ke?--this.toRespond:this.toRespond:0;r[n]=t,0===o&&(this.resultSelector?this._tryResultSelector(r):this.destination.next(r.slice()))},t.prototype._tryResultSelector=function(e){var t;try{t=this.resultSelector.apply(this,e)}catch(e){return void this.destination.error(e)}this.destination.next(t)},t}(Fe);function Xe(e,t){if(null!=e){if(function(e){return e&&"function"==typeof e[m]}(e))return function(e,t){return new _((function(n){var r=new h;return r.add(t.schedule((function(){var i=e[m]();r.add(i.subscribe({next:function(e){r.add(t.schedule((function(){return n.next(e)})))},error:function(e){r.add(t.schedule((function(){return n.error(e)})))},complete:function(){r.add(t.schedule((function(){return n.complete()})))}}))}))),r}))}(e,t);if(Qe(e))return function(e,t){return new _((function(n){var r=new h;return r.add(t.schedule((function(){return e.then((function(e){r.add(t.schedule((function(){n.next(e),r.add(t.schedule((function(){return n.complete()})))})))}),(function(e){r.add(t.schedule((function(){return n.error(e)})))}))}))),r}))}(e,t);if(Ve(e))return $(e,t);if(function(e){return e&&"function"==typeof e[je]}(e)||"string"==typeof e)return function(e,t){if(!e)throw new Error("Iterable cannot be null");return new _((function(n){var r,i=new h;return i.add((function(){r&&"function"==typeof r.return&&r.return()})),i.add(t.schedule((function(){r=e[je](),i.add(t.schedule((function(){if(!n.closed){var e,t;try{var i=r.next();e=i.value,t=i.done}catch(e){return void n.error(e)}t?n.complete():(n.next(e),this.schedule())}})))}))),i}))}(e,t)}throw new TypeError((null!==e&&typeof e||e)+" is not observable")}function Je(e,t){return t?Xe(e,t):e instanceof _?e:new _(Ge(e))}var Ye=function(e){function t(t){var n=e.call(this)||this;return n.parent=t,n}return n(t,e),t.prototype._next=function(e){this.parent.notifyNext(e)},t.prototype._error=function(e){this.parent.notifyError(e),this.unsubscribe()},t.prototype._complete=function(){this.parent.notifyComplete(),this.unsubscribe()},t}(A),Ze=(function(e){function t(t,n,r){var i=e.call(this)||this;return i.parent=t,i.outerValue=n,i.outerIndex=r,i}n(t,e),t.prototype._next=function(e){this.parent.notifyNext(this.outerValue,e,this.outerIndex,this)},t.prototype._error=function(e){this.parent.notifyError(e),this.unsubscribe()},t.prototype._complete=function(){this.parent.notifyComplete(this),this.unsubscribe()}}(A),function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.notifyNext=function(e){this.destination.next(e)},t.prototype.notifyError=function(e){this.destination.error(e)},t.prototype.notifyComplete=function(){this.destination.complete()},t}(A));!function(e){function t(){return null!==e&&e.apply(this,arguments)||this}n(t,e),t.prototype.notifyNext=function(e,t,n,r){this.destination.next(t)},t.prototype.notifyError=function(e){this.destination.error(e)},t.prototype.notifyComplete=function(e){this.destination.complete()}}(A);function $e(e,t){if(!t.closed)return e instanceof _?e.subscribe(t):Ge(e)(t)}function et(e,t,n){return void 0===n&&(n=Number.POSITIVE_INFINITY),"function"==typeof t?function(r){return r.pipe(et((function(n,r){return Je(e(n,r)).pipe(Ne((function(e,i){return t(n,e,r,i)})))}),n))}:("number"==typeof t&&(n=t),function(t){return t.lift(new tt(e,n))})}var tt=function(){function e(e,t){void 0===t&&(t=Number.POSITIVE_INFINITY),this.project=e,this.concurrent=t}return e.prototype.call=function(e,t){return t.subscribe(new nt(e,this.project,this.concurrent))},e}(),nt=function(e){function t(t,n,r){void 0===r&&(r=Number.POSITIVE_INFINITY);var i=e.call(this,t)||this;return i.project=n,i.concurrent=r,i.hasCompleted=!1,i.buffer=[],i.active=0,i.index=0,i}return n(t,e),t.prototype._next=function(e){this.active<this.concurrent?this._tryNext(e):this.buffer.push(e)},t.prototype._tryNext=function(e){var t,n=this.index++;try{t=this.project(e,n)}catch(e){return void this.destination.error(e)}this.active++,this._innerSub(t)},t.prototype._innerSub=function(e){var t=new Ye(this),n=this.destination;n.add(t);var r=$e(e,t);r!==t&&n.add(r)},t.prototype._complete=function(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete(),this.unsubscribe()},t.prototype.notifyNext=function(e){this.destination.next(e)},t.prototype.notifyComplete=function(){var e=this.buffer;this.active--,e.length>0?this._next(e.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()},t}(Ze),rt=et;function it(e){return void 0===e&&(e=Number.POSITIVE_INFINITY),et(y,e)}function ot(){return it(1)}function at(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return ot()(te.apply(void 0,e))}function st(e){return new _((function(t){var n;try{n=e()}catch(e){return void t.error(e)}return(n?Je(n):X()).subscribe(t)}))}function ct(e,t){return new _((function(n){var r=e.length;if(0!==r)for(var i=new Array(r),o=0,a=0,s=function(s){var c=Je(e[s]),u=!1;n.add(c.subscribe({next:function(e){u||(u=!0,a++),i[s]=e},error:function(e){return n.error(e)},complete:function(){++o!==r&&u||(a===r&&n.next(t?t.reduce((function(e,t,n){return e[t]=i[n],e}),{}):i),n.complete())}}))},c=0;c<r;c++)s(c);else n.complete()}))}function ut(e,t,n,r,i){var o;if(function(e){return e&&"function"==typeof e.addEventListener&&"function"==typeof e.removeEventListener}(e)){var a=e;e.addEventListener(t,n,i),o=function(){return a.removeEventListener(t,n,i)}}else if(function(e){return e&&"function"==typeof e.on&&"function"==typeof e.off}(e)){var s=e;e.on(t,n),o=function(){return s.off(t,n)}}else if(function(e){return e&&"function"==typeof e.addListener&&"function"==typeof e.removeListener}(e)){var c=e;e.addListener(t,n),o=function(){return c.removeListener(t,n)}}else{if(!e||!e.length)throw new TypeError("Invalid event target");for(var u=0,l=e.length;u<l;u++)ut(e[u],t,n,r,i)}r.add(o)}function lt(e){var t=e.subscriber,n=e.condition;if(!t.closed){if(e.needIterate)try{e.state=e.iterate(e.state)}catch(e){return void t.error(e)}else e.needIterate=!0;if(n){var r=void 0;try{r=n(e.state)}catch(e){return void t.error(e)}if(!r)return void t.complete();if(t.closed)return}var i;try{i=e.resultSelector(e.state)}catch(e){return void t.error(e)}if(!t.closed&&(t.next(i),!t.closed))return this.schedule(e)}}function dt(e){return!u(e)&&e-parseFloat(e)+1>=0}function ht(e){var t=e.subscriber,n=e.counter,r=e.period;t.next(n),this.schedule({subscriber:t,counter:n+1,period:r},r)}function ft(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=Number.POSITIVE_INFINITY,r=null,i=e[e.length-1];return J(i)?(r=e.pop(),e.length>1&&"number"==typeof e[e.length-1]&&(n=e.pop())):"number"==typeof i&&(n=e.pop()),null===r&&1===e.length&&e[0]instanceof _?e[0]:it(n)(ee(e,r))}var pt=new _(Ce);function At(e){var t=e.keys,n=e.index,r=e.subscriber,i=e.subscription,o=e.obj;if(!r.closed)if(n<t.length){var a=t[n];r.next([a,o[a]]),i.add(this.schedule({keys:t,index:n+1,subscriber:r,subscription:i,obj:o}))}else r.complete()}function gt(e,t){function n(){return!n.pred.apply(n.thisArg,arguments)}return n.pred=e,n.thisArg=t,n}function vt(e,t){return function(n){return n.lift(new mt(e,t))}}var mt=function(){function e(e,t){this.predicate=e,this.thisArg=t}return e.prototype.call=function(e,t){return t.subscribe(new yt(e,this.predicate,this.thisArg))},e}(),yt=function(e){function t(t,n,r){var i=e.call(this,t)||this;return i.predicate=n,i.thisArg=r,i.count=0,i}return n(t,e),t.prototype._next=function(e){var t;try{t=this.predicate.call(this.thisArg,e,this.count++)}catch(e){return void this.destination.error(e)}t&&this.destination.next(e)},t}(A);function bt(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(1===e.length){if(!u(e[0]))return e[0];e=e[0]}return ee(e,void 0).lift(new Et)}var Et=function(){function e(){}return e.prototype.call=function(e,t){return t.subscribe(new _t(e))},e}(),_t=function(e){function t(t){var n=e.call(this,t)||this;return n.hasFirst=!1,n.observables=[],n.subscriptions=[],n}return n(t,e),t.prototype._next=function(e){this.observables.push(e)},t.prototype._complete=function(){var e=this.observables,t=e.length;if(0===t)this.destination.complete();else{for(var n=0;n<t&&!this.hasFirst;n++){var r=ze(this,e[n],void 0,n);this.subscriptions&&this.subscriptions.push(r),this.add(r)}this.observables=null}},t.prototype.notifyNext=function(e,t,n){if(!this.hasFirst){this.hasFirst=!0;for(var r=0;r<this.subscriptions.length;r++)if(r!==n){var i=this.subscriptions[r];i.unsubscribe(),this.remove(i)}this.subscriptions=null}this.destination.next(t)},t}(Fe);function wt(e){var t=e.start,n=e.index,r=e.count,i=e.subscriber;n>=r?i.complete():(i.next(t),i.closed||(e.index=n+1,e.start=t+1,this.schedule(e)))}function St(e,t,n){void 0===e&&(e=0);var r=-1;return dt(t)?r=Number(t)<1?1:Number(t):J(t)&&(n=t),J(n)||(n=Ee),new _((function(t){var i=dt(e)?e:+e-n.now();return n.schedule(Tt,i,{index:0,period:r,subscriber:t})}))}function Tt(e){var t=e.index,n=e.period,r=e.subscriber;if(r.next(t),!r.closed){if(-1===n)return r.complete();e.index=t+1,this.schedule(e,n)}}function Rt(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=e[e.length-1];return"function"==typeof n&&e.pop(),ee(e,void 0).lift(new Ct(n))}var Ct=function(){function e(e){this.resultSelector=e}return e.prototype.call=function(e,t){return t.subscribe(new It(e,this.resultSelector))},e}(),It=function(e){function t(t,n,r){void 0===r&&(r=Object.create(null));var i=e.call(this,t)||this;return i.resultSelector=n,i.iterators=[],i.active=0,i.resultSelector="function"==typeof n?n:void 0,i}return n(t,e),t.prototype._next=function(e){var t=this.iterators;u(e)?t.push(new Ot(e)):"function"==typeof e[je]?t.push(new xt(e[je]())):t.push(new Nt(this.destination,this,e))},t.prototype._complete=function(){var e=this.iterators,t=e.length;if(this.unsubscribe(),0!==t){this.active=t;for(var n=0;n<t;n++){var r=e[n];if(r.stillUnsubscribed)this.destination.add(r.subscribe());else this.active--}}else this.destination.complete()},t.prototype.notifyInactive=function(){this.active--,0===this.active&&this.destination.complete()},t.prototype.checkIterators=function(){for(var e=this.iterators,t=e.length,n=this.destination,r=0;r<t;r++){if("function"==typeof(a=e[r]).hasValue&&!a.hasValue())return}var i=!1,o=[];for(r=0;r<t;r++){var a,s=(a=e[r]).next();if(a.hasCompleted()&&(i=!0),s.done)return void n.complete();o.push(s.value)}this.resultSelector?this._tryresultSelector(o):n.next(o),i&&n.complete()},t.prototype._tryresultSelector=function(e){var t;try{t=this.resultSelector.apply(this,e)}catch(e){return void this.destination.error(e)}this.destination.next(t)},t}(A),xt=function(){function e(e){this.iterator=e,this.nextResult=e.next()}return e.prototype.hasValue=function(){return!0},e.prototype.next=function(){var e=this.nextResult;return this.nextResult=this.iterator.next(),e},e.prototype.hasCompleted=function(){var e=this.nextResult;return Boolean(e&&e.done)},e}(),Ot=function(){function e(e){this.array=e,this.index=0,this.length=0,this.length=e.length}return e.prototype[je]=function(){return this},e.prototype.next=function(e){var t=this.index++,n=this.array;return t<this.length?{value:n[t],done:!1}:{value:null,done:!0}},e.prototype.hasValue=function(){return this.array.length>this.index},e.prototype.hasCompleted=function(){return this.array.length===this.index},e}(),Nt=function(e){function t(t,n,r){var i=e.call(this,t)||this;return i.parent=n,i.observable=r,i.stillUnsubscribed=!0,i.buffer=[],i.isComplete=!1,i}return n(t,e),t.prototype[je]=function(){return this},t.prototype.next=function(){var e=this.buffer;return 0===e.length&&this.isComplete?{value:null,done:!0}:{value:e.shift(),done:!1}},t.prototype.hasValue=function(){return this.buffer.length>0},t.prototype.hasCompleted=function(){return 0===this.buffer.length&&this.isComplete},t.prototype.notifyComplete=function(){this.buffer.length>0?(this.isComplete=!0,this.parent.notifyInactive()):this.destination.complete()},t.prototype.notifyNext=function(e){this.buffer.push(e),this.parent.checkIterators()},t.prototype.subscribe=function(){return $e(this.observable,new Ye(this))},t}(Ze);function Bt(e){return function(t){return t.lift(new Mt(e))}}var Mt=function(){function e(e){this.durationSelector=e}return e.prototype.call=function(e,t){return t.subscribe(new Lt(e,this.durationSelector))},e}(),Lt=function(e){function t(t,n){var r=e.call(this,t)||this;return r.durationSelector=n,r.hasValue=!1,r}return n(t,e),t.prototype._next=function(e){if(this.value=e,this.hasValue=!0,!this.throttled){var t=void 0;try{t=(0,this.durationSelector)(e)}catch(e){return this.destination.error(e)}var n=$e(t,new Ye(this));!n||n.closed?this.clearThrottle():this.add(this.throttled=n)}},t.prototype.clearThrottle=function(){var e=this,t=e.value,n=e.hasValue,r=e.throttled;r&&(this.remove(r),this.throttled=void 0,r.unsubscribe()),n&&(this.value=void 0,this.hasValue=!1,this.destination.next(t))},t.prototype.notifyNext=function(){this.clearThrottle()},t.prototype.notifyComplete=function(){this.clearThrottle()},t}(Ze);var kt=function(){function e(e){this.closingNotifier=e}return e.prototype.call=function(e,t){return t.subscribe(new Ut(e,this.closingNotifier))},e}(),Ut=function(e){function t(t,n){var r=e.call(this,t)||this;return r.buffer=[],r.add($e(n,new Ye(r))),r}return n(t,e),t.prototype._next=function(e){this.buffer.push(e)},t.prototype.notifyNext=function(){var e=this.buffer;this.buffer=[],this.destination.next(e)},t}(Ze);var Dt=function(){function e(e,t){this.bufferSize=e,this.startBufferEvery=t,this.subscriberClass=t&&e!==t?Ft:Pt}return e.prototype.call=function(e,t){return t.subscribe(new this.subscriberClass(e,this.bufferSize,this.startBufferEvery))},e}(),Pt=function(e){function t(t,n){var r=e.call(this,t)||this;return r.bufferSize=n,r.buffer=[],r}return n(t,e),t.prototype._next=function(e){var t=this.buffer;t.push(e),t.length==this.bufferSize&&(this.destination.next(t),this.buffer=[])},t.prototype._complete=function(){var t=this.buffer;t.length>0&&this.destination.next(t),e.prototype._complete.call(this)},t}(A),Ft=function(e){function t(t,n,r){var i=e.call(this,t)||this;return i.bufferSize=n,i.startBufferEvery=r,i.buffers=[],i.count=0,i}return n(t,e),t.prototype._next=function(e){var t=this,n=t.bufferSize,r=t.startBufferEvery,i=t.buffers,o=t.count;this.count++,o%r==0&&i.push([]);for(var a=i.length;a--;){var s=i[a];s.push(e),s.length===n&&(i.splice(a,1),this.destination.next(s))}},t.prototype._complete=function(){for(var t=this.buffers,n=this.destination;t.length>0;){var r=t.shift();r.length>0&&n.next(r)}e.prototype._complete.call(this)},t}(A);var Ht=function(){function e(e,t,n,r){this.bufferTimeSpan=e,this.bufferCreationInterval=t,this.maxBufferSize=n,this.scheduler=r}return e.prototype.call=function(e,t){return t.subscribe(new Vt(e,this.bufferTimeSpan,this.bufferCreationInterval,this.maxBufferSize,this.scheduler))},e}(),jt=function(){this.buffer=[]},Vt=function(e){function t(t,n,r,i,o){var a=e.call(this,t)||this;a.bufferTimeSpan=n,a.bufferCreationInterval=r,a.maxBufferSize=i,a.scheduler=o,a.contexts=[];var s=a.openContext();if(a.timespanOnly=null==r||r<0,a.timespanOnly){var c={subscriber:a,context:s,bufferTimeSpan:n};a.add(s.closeAction=o.schedule(Qt,n,c))}else{var u={subscriber:a,context:s},l={bufferTimeSpan:n,bufferCreationInterval:r,subscriber:a,scheduler:o};a.add(s.closeAction=o.schedule(zt,n,u)),a.add(o.schedule(Gt,r,l))}return a}return n(t,e),t.prototype._next=function(e){for(var t,n=this.contexts,r=n.length,i=0;i<r;i++){var o=n[i],a=o.buffer;a.push(e),a.length==this.maxBufferSize&&(t=o)}t&&this.onBufferFull(t)},t.prototype._error=function(t){this.contexts.length=0,e.prototype._error.call(this,t)},t.prototype._complete=function(){for(var t=this.contexts,n=this.destination;t.length>0;){var r=t.shift();n.next(r.buffer)}e.prototype._complete.call(this)},t.prototype._unsubscribe=function(){this.contexts=null},t.prototype.onBufferFull=function(e){this.closeContext(e);var t=e.closeAction;if(t.unsubscribe(),this.remove(t),!this.closed&&this.timespanOnly){e=this.openContext();var n=this.bufferTimeSpan,r={subscriber:this,context:e,bufferTimeSpan:n};this.add(e.closeAction=this.scheduler.schedule(Qt,n,r))}},t.prototype.openContext=function(){var e=new jt;return this.contexts.push(e),e},t.prototype.closeContext=function(e){this.destination.next(e.buffer);var t=this.contexts;(t?t.indexOf(e):-1)>=0&&t.splice(t.indexOf(e),1)},t}(A);function Qt(e){var t=e.subscriber,n=e.context;n&&t.closeContext(n),t.closed||(e.context=t.openContext(),e.context.closeAction=this.schedule(e,e.bufferTimeSpan))}function Gt(e){var t=e.bufferCreationInterval,n=e.bufferTimeSpan,r=e.subscriber,i=e.scheduler,o=r.openContext();r.closed||(r.add(o.closeAction=i.schedule(zt,n,{subscriber:r,context:o})),this.schedule(e,t))}function zt(e){var t=e.subscriber,n=e.context;t.closeContext(n)}var Kt=function(){function e(e,t){this.openings=e,this.closingSelector=t}return e.prototype.call=function(e,t){return t.subscribe(new qt(e,this.openings,this.closingSelector))},e}(),qt=function(e){function t(t,n,r){var i=e.call(this,t)||this;return i.closingSelector=r,i.contexts=[],i.add(ze(i,n)),i}return n(t,e),t.prototype._next=function(e){for(var t=this.contexts,n=t.length,r=0;r<n;r++)t[r].buffer.push(e)},t.prototype._error=function(t){for(var n=this.contexts;n.length>0;){var r=n.shift();r.subscription.unsubscribe(),r.buffer=null,r.subscription=null}this.contexts=null,e.prototype._error.call(this,t)},t.prototype._complete=function(){for(var t=this.contexts;t.length>0;){var n=t.shift();this.destination.next(n.buffer),n.subscription.unsubscribe(),n.buffer=null,n.subscription=null}this.contexts=null,e.prototype._complete.call(this)},t.prototype.notifyNext=function(e,t){e?this.closeBuffer(e):this.openBuffer(t)},t.prototype.notifyComplete=function(e){this.closeBuffer(e.context)},t.prototype.openBuffer=function(e){try{var t=this.closingSelector.call(this,e);t&&this.trySubscribe(t)}catch(e){this._error(e)}},t.prototype.closeBuffer=function(e){var t=this.contexts;if(t&&e){var n=e.buffer,r=e.subscription;this.destination.next(n),t.splice(t.indexOf(e),1),this.remove(r),r.unsubscribe()}},t.prototype.trySubscribe=function(e){var t=this.contexts,n=new h,r={buffer:[],subscription:n};t.push(r);var i=ze(this,e,r);!i||i.closed?this.closeBuffer(r):(i.context=r,this.add(i),n.add(i))},t}(Fe);var Wt=function(){function e(e){this.closingSelector=e}return e.prototype.call=function(e,t){return t.subscribe(new Xt(e,this.closingSelector))},e}(),Xt=function(e){function t(t,n){var r=e.call(this,t)||this;return r.closingSelector=n,r.subscribing=!1,r.openBuffer(),r}return n(t,e),t.prototype._next=function(e){this.buffer.push(e)},t.prototype._complete=function(){var t=this.buffer;t&&this.destination.next(t),e.prototype._complete.call(this)},t.prototype._unsubscribe=function(){this.buffer=void 0,this.subscribing=!1},t.prototype.notifyNext=function(){this.openBuffer()},t.prototype.notifyComplete=function(){this.subscribing?this.complete():this.openBuffer()},t.prototype.openBuffer=function(){var e=this.closingSubscription;e&&(this.remove(e),e.unsubscribe());var t,n=this.buffer;this.buffer&&this.destination.next(n),this.buffer=[];try{t=(0,this.closingSelector)()}catch(e){return this.error(e)}e=new h,this.closingSubscription=e,this.add(e),this.subscribing=!0,e.add($e(t,new Ye(this))),this.subscribing=!1},t}(Ze);var Jt=function(){function e(e){this.selector=e}return e.prototype.call=function(e,t){return t.subscribe(new Yt(e,this.selector,this.caught))},e}(),Yt=function(e){function t(t,n,r){var i=e.call(this,t)||this;return i.selector=n,i.caught=r,i}return n(t,e),t.prototype.error=function(t){if(!this.isStopped){var n=void 0;try{n=this.selector(t,this.caught)}catch(t){return void e.prototype.error.call(this,t)}this._unsubscribeAndRecycle();var r=new Ye(this);this.add(r);var i=$e(n,r);i!==r&&this.add(i)}},t}(Ze);function Zt(e,t){return et(e,t,1)}var $t=function(){function e(e,t){this.predicate=e,this.source=t}return e.prototype.call=function(e,t){return t.subscribe(new en(e,this.predicate,this.source))},e}(),en=function(e){function t(t,n,r){var i=e.call(this,t)||this;return i.predicate=n,i.source=r,i.count=0,i.index=0,i}return n(t,e),t.prototype._next=function(e){this.predicate?this._tryPredicate(e):this.count++},t.prototype._tryPredicate=function(e){var t;try{t=this.predicate(e,this.index++,this.source)}catch(e){return void this.destination.error(e)}t&&this.count++},t.prototype._complete=function(){this.destination.next(this.count),this.destination.complete()},t}(A);var tn=function(){function e(e){this.durationSelector=e}return e.prototype.call=function(e,t){return t.subscribe(new nn(e,this.durationSelector))},e}(),nn=function(e){function t(t,n){var r=e.call(this,t)||this;return r.durationSelector=n,r.hasValue=!1,r}return n(t,e),t.prototype._next=function(e){try{var t=this.durationSelector.call(this,e);t&&this._tryNext(e,t)}catch(e){this.destination.error(e)}},t.prototype._complete=function(){this.emitValue(),this.destination.complete()},t.prototype._tryNext=function(e,t){var n=this.durationSubscription;this.value=e,this.hasValue=!0,n&&(n.unsubscribe(),this.remove(n)),(n=$e(t,new Ye(this)))&&!n.closed&&this.add(this.durationSubscription=n)},t.prototype.notifyNext=function(){this.emitValue()},t.prototype.notifyComplete=function(){this.emitValue()},t.prototype.emitValue=function(){if(this.hasValue){var t=this.value,n=this.durationSubscription;n&&(this.durationSubscription=void 0,n.unsubscribe(),this.remove(n)),this.value=void 0,this.hasValue=!1,e.prototype._next.call(this,t)}},t}(Ze);var rn=function(){function e(e,t){this.dueTime=e,this.scheduler=t}return e.prototype.call=function(e,t){return t.subscribe(new on(e,this.dueTime,this.scheduler))},e}(),on=function(e){function t(t,n,r){var i=e.call(this,t)||this;return i.dueTime=n,i.scheduler=r,i.debouncedSubscription=null,i.lastValue=null,i.hasValue=!1,i}return n(t,e),t.prototype._next=function(e){this.clearDebounce(),this.lastValue=e,this.hasValue=!0,this.add(this.debouncedSubscription=this.scheduler.schedule(an,this.dueTime,this))},t.prototype._complete=function(){this.debouncedNext(),this.destination.complete()},t.prototype.debouncedNext=function(){if(this.clearDebounce(),this.hasValue){var e=this.lastValue;this.lastValue=null,this.hasValue=!1,this.destination.next(e)}},t.prototype.clearDebounce=function(){var e=this.debouncedSubscription;null!==e&&(this.remove(e),e.unsubscribe(),this.debouncedSubscription=null)},t}(A);function an(e){e.debouncedNext()}function sn(e){return void 0===e&&(e=null),function(t){return t.lift(new cn(e))}}var cn=function(){function e(e){this.defaultValue=e}return e.prototype.call=function(e,t){return t.subscribe(new un(e,this.defaultValue))},e}(),un=function(e){function t(t,n){var r=e.call(this,t)||this;return r.defaultValue=n,r.isEmpty=!0,r}return n(t,e),t.prototype._next=function(e){this.isEmpty=!1,this.destination.next(e)},t.prototype._complete=function(){this.isEmpty&&this.destination.next(this.defaultValue),this.destination.complete()},t}(A);function ln(e){return e instanceof Date&&!isNaN(+e)}var dn=function(){function e(e,t){this.delay=e,this.scheduler=t}return e.prototype.call=function(e,t){return t.subscribe(new hn(e,this.delay,this.scheduler))},e}(),hn=function(e){function t(t,n,r){var i=e.call(this,t)||this;return i.delay=n,i.scheduler=r,i.queue=[],i.active=!1,i.errored=!1,i}return n(t,e),t.dispatch=function(e){for(var t=e.source,n=t.queue,r=e.scheduler,i=e.destination;n.length>0&&n[0].time-r.now()<=0;)n.shift().notification.observe(i);if(n.length>0){var o=Math.max(0,n[0].time-r.now());this.schedule(e,o)}else this.unsubscribe(),t.active=!1},t.prototype._schedule=function(e){this.active=!0,this.destination.add(e.schedule(t.dispatch,this.delay,{source:this,destination:this.destination,scheduler:e}))},t.prototype.scheduleNotification=function(e){if(!0!==this.errored){var t=this.scheduler,n=new fn(t.now()+this.delay,e);this.queue.push(n),!1===this.active&&this._schedule(t)}},t.prototype._next=function(e){this.scheduleNotification(ie.createNext(e))},t.prototype._error=function(e){this.errored=!0,this.queue=[],this.destination.error(e),this.unsubscribe()},t.prototype._complete=function(){this.scheduleNotification(ie.createComplete()),this.unsubscribe()},t}(A),fn=function(e,t){this.time=e,this.notification=t};var pn=function(){function e(e){this.delayDurationSelector=e}return e.prototype.call=function(e,t){return t.subscribe(new An(e,this.delayDurationSelector))},e}(),An=function(e){function t(t,n){var r=e.call(this,t)||this;return r.delayDurationSelector=n,r.completed=!1,r.delayNotifierSubscriptions=[],r.index=0,r}return n(t,e),t.prototype.notifyNext=function(e,t,n,r,i){this.destination.next(e),this.removeSubscription(i),this.tryComplete()},t.prototype.notifyError=function(e,t){this._error(e)},t.prototype.notifyComplete=function(e){var t=this.removeSubscription(e);t&&this.destination.next(t),this.tryComplete()},t.prototype._next=function(e){var t=this.index++;try{var n=this.delayDurationSelector(e,t);n&&this.tryDelay(n,e)}catch(e){this.destination.error(e)}},t.prototype._complete=function(){this.completed=!0,this.tryComplete(),this.unsubscribe()},t.prototype.removeSubscription=function(e){e.unsubscribe();var t=this.delayNotifierSubscriptions.indexOf(e);return-1!==t&&this.delayNotifierSubscriptions.splice(t,1),e.outerValue},t.prototype.tryDelay=function(e,t){var n=ze(this,e,t);n&&!n.closed&&(this.destination.add(n),this.delayNotifierSubscriptions.push(n))},t.prototype.tryComplete=function(){this.completed&&0===this.delayNotifierSubscriptions.length&&this.destination.complete()},t}(Fe),gn=function(e){function t(t,n){var r=e.call(this)||this;return r.source=t,r.subscriptionDelay=n,r}return n(t,e),t.prototype._subscribe=function(e){this.subscriptionDelay.subscribe(new vn(e,this.source))},t}(_),vn=function(e){function t(t,n){var r=e.call(this)||this;return r.parent=t,r.source=n,r.sourceSubscribed=!1,r}return n(t,e),t.prototype._next=function(e){this.subscribeToSource()},t.prototype._error=function(e){this.unsubscribe(),this.parent.error(e)},t.prototype._complete=function(){this.unsubscribe(),this.subscribeToSource()},t.prototype.subscribeToSource=function(){this.sourceSubscribed||(this.sourceSubscribed=!0,this.unsubscribe(),this.source.subscribe(this.parent))},t}(A);var mn=function(){function e(){}return e.prototype.call=function(e,t){return t.subscribe(new yn(e))},e}(),yn=function(e){function t(t){return e.call(this,t)||this}return n(t,e),t.prototype._next=function(e){e.observe(this.destination)},t}(A);var bn=function(){function e(e,t){this.keySelector=e,this.flushes=t}return e.prototype.call=function(e,t){return t.subscribe(new En(e,this.keySelector,this.flushes))},e}(),En=function(e){function t(t,n,r){var i=e.call(this,t)||this;return i.keySelector=n,i.values=new Set,r&&i.add($e(r,new Ye(i))),i}return n(t,e),t.prototype.notifyNext=function(){this.values.clear()},t.prototype.notifyError=function(e){this._error(e)},t.prototype._next=function(e){this.keySelector?this._useKeySelector(e):this._finalizeNext(e,e)},t.prototype._useKeySelector=function(e){var t,n=this.destination;try{t=this.keySelector(e)}catch(e){return void n.error(e)}this._finalizeNext(t,e)},t.prototype._finalizeNext=function(e,t){var n=this.values;n.has(e)||(n.add(e),this.destination.next(t))},t}(Ze);function _n(e,t){return function(n){return n.lift(new wn(e,t))}}var wn=function(){function e(e,t){this.compare=e,this.keySelector=t}return e.prototype.call=function(e,t){return t.subscribe(new Sn(e,this.compare,this.keySelector))},e}(),Sn=function(e){function t(t,n,r){var i=e.call(this,t)||this;return i.keySelector=r,i.hasKey=!1,"function"==typeof n&&(i.compare=n),i}return n(t,e),t.prototype.compare=function(e,t){return e===t},t.prototype._next=function(e){var t;try{var n=this.keySelector;t=n?n(e):e}catch(e){return this.destination.error(e)}var r=!1;if(this.hasKey)try{r=(0,this.compare)(this.key,t)}catch(e){return this.destination.error(e)}else this.hasKey=!0;r||(this.key=t,this.destination.next(e))},t}(A);function Tn(e){return void 0===e&&(e=In),function(t){return t.lift(new Rn(e))}}var Rn=function(){function e(e){this.errorFactory=e}return e.prototype.call=function(e,t){return t.subscribe(new Cn(e,this.errorFactory))},e}(),Cn=function(e){function t(t,n){var r=e.call(this,t)||this;return r.errorFactory=n,r.hasValue=!1,r}return n(t,e),t.prototype._next=function(e){this.hasValue=!0,this.destination.next(e)},t.prototype._complete=function(){if(this.hasValue)return this.destination.complete();var e=void 0;try{e=this.errorFactory()}catch(t){e=t}this.destination.error(e)},t}(A);function In(){return new xe}function xn(e){return function(t){return 0===e?X():t.lift(new On(e))}}var On=function(){function e(e){if(this.total=e,this.total<0)throw new Ie}return e.prototype.call=function(e,t){return t.subscribe(new Nn(e,this.total))},e}(),Nn=function(e){function t(t,n){var r=e.call(this,t)||this;return r.total=n,r.count=0,r}return n(t,e),t.prototype._next=function(e){var t=this.total,n=++this.count;n<=t&&(this.destination.next(e),n===t&&(this.destination.complete(),this.unsubscribe()))},t}(A);var Bn=function(){function e(e,t,n){this.predicate=e,this.thisArg=t,this.source=n}return e.prototype.call=function(e,t){return t.subscribe(new Mn(e,this.predicate,this.thisArg,this.source))},e}(),Mn=function(e){function t(t,n,r,i){var o=e.call(this,t)||this;return o.predicate=n,o.thisArg=r,o.source=i,o.index=0,o.thisArg=r||o,o}return n(t,e),t.prototype.notifyComplete=function(e){this.destination.next(e),this.destination.complete()},t.prototype._next=function(e){var t=!1;try{t=this.predicate.call(this.thisArg,e,this.index++,this.source)}catch(e){return void this.destination.error(e)}t||this.notifyComplete(!1)},t.prototype._complete=function(){this.notifyComplete(!0)},t}(A);var Ln=function(){function e(){}return e.prototype.call=function(e,t){return t.subscribe(new kn(e))},e}(),kn=function(e){function t(t){var n=e.call(this,t)||this;return n.hasCompleted=!1,n.hasSubscription=!1,n}return n(t,e),t.prototype._next=function(e){this.hasSubscription||(this.hasSubscription=!0,this.add($e(e,new Ye(this))))},t.prototype._complete=function(){this.hasCompleted=!0,this.hasSubscription||this.destination.complete()},t.prototype.notifyComplete=function(){this.hasSubscription=!1,this.hasCompleted&&this.destination.complete()},t}(Ze);var Un=function(){function e(e){this.project=e}return e.prototype.call=function(e,t){return t.subscribe(new Dn(e,this.project))},e}(),Dn=function(e){function t(t,n){var r=e.call(this,t)||this;return r.project=n,r.hasSubscription=!1,r.hasCompleted=!1,r.index=0,r}return n(t,e),t.prototype._next=function(e){this.hasSubscription||this.tryNext(e)},t.prototype.tryNext=function(e){var t,n=this.index++;try{t=this.project(e,n)}catch(e){return void this.destination.error(e)}this.hasSubscription=!0,this._innerSub(t)},t.prototype._innerSub=function(e){var t=new Ye(this),n=this.destination;n.add(t);var r=$e(e,t);r!==t&&n.add(r)},t.prototype._complete=function(){this.hasCompleted=!0,this.hasSubscription||this.destination.complete(),this.unsubscribe()},t.prototype.notifyNext=function(e){this.destination.next(e)},t.prototype.notifyError=function(e){this.destination.error(e)},t.prototype.notifyComplete=function(){this.hasSubscription=!1,this.hasCompleted&&this.destination.complete()},t}(Ze);var Pn=function(){function e(e,t,n){this.project=e,this.concurrent=t,this.scheduler=n}return e.prototype.call=function(e,t){return t.subscribe(new Fn(e,this.project,this.concurrent,this.scheduler))},e}(),Fn=function(e){function t(t,n,r,i){var o=e.call(this,t)||this;return o.project=n,o.concurrent=r,o.scheduler=i,o.index=0,o.active=0,o.hasCompleted=!1,r<Number.POSITIVE_INFINITY&&(o.buffer=[]),o}return n(t,e),t.dispatch=function(e){var t=e.subscriber,n=e.result,r=e.value,i=e.index;t.subscribeToProjection(n,r,i)},t.prototype._next=function(e){var n=this.destination;if(n.closed)this._complete();else{var r=this.index++;if(this.active<this.concurrent){n.next(e);try{var i=(0,this.project)(e,r);if(this.scheduler){var o={subscriber:this,result:i,value:e,index:r};this.destination.add(this.scheduler.schedule(t.dispatch,0,o))}else this.subscribeToProjection(i,e,r)}catch(e){n.error(e)}}else this.buffer.push(e)}},t.prototype.subscribeToProjection=function(e,t,n){this.active++,this.destination.add($e(e,new Ye(this)))},t.prototype._complete=function(){this.hasCompleted=!0,this.hasCompleted&&0===this.active&&this.destination.complete(),this.unsubscribe()},t.prototype.notifyNext=function(e){this._next(e)},t.prototype.notifyComplete=function(){var e=this.buffer;this.active--,e&&e.length>0&&this._next(e.shift()),this.hasCompleted&&0===this.active&&this.destination.complete()},t}(Ze);var Hn=function(){function e(e){this.callback=e}return e.prototype.call=function(e,t){return t.subscribe(new jn(e,this.callback))},e}(),jn=function(e){function t(t,n){var r=e.call(this,t)||this;return r.add(new h(n)),r}return n(t,e),t}(A);var Vn=function(){function e(e,t,n,r){this.predicate=e,this.source=t,this.yieldIndex=n,this.thisArg=r}return e.prototype.call=function(e,t){return t.subscribe(new Qn(e,this.predicate,this.source,this.yieldIndex,this.thisArg))},e}(),Qn=function(e){function t(t,n,r,i,o){var a=e.call(this,t)||this;return a.predicate=n,a.source=r,a.yieldIndex=i,a.thisArg=o,a.index=0,a}return n(t,e),t.prototype.notifyComplete=function(e){var t=this.destination;t.next(e),t.complete(),this.unsubscribe()},t.prototype._next=function(e){var t=this.predicate,n=this.thisArg,r=this.index++;try{t.call(n||this,e,r,this.source)&&this.notifyComplete(this.yieldIndex?r:e)}catch(e){this.destination.error(e)}},t.prototype._complete=function(){this.notifyComplete(this.yieldIndex?-1:void 0)},t}(A);var Gn=function(){function e(){}return e.prototype.call=function(e,t){return t.subscribe(new zn(e))},e}(),zn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype._next=function(e){},t}(A);var Kn=function(){function e(){}return e.prototype.call=function(e,t){return t.subscribe(new qn(e))},e}(),qn=function(e){function t(t){return e.call(this,t)||this}return n(t,e),t.prototype.notifyComplete=function(e){var t=this.destination;t.next(e),t.complete()},t.prototype._next=function(e){this.notifyComplete(!1)},t.prototype._complete=function(){this.notifyComplete(!0)},t}(A);function Wn(e){return function(t){return 0===e?X():t.lift(new Xn(e))}}var Xn=function(){function e(e){if(this.total=e,this.total<0)throw new Ie}return e.prototype.call=function(e,t){return t.subscribe(new Jn(e,this.total))},e}(),Jn=function(e){function t(t,n){var r=e.call(this,t)||this;return r.total=n,r.ring=new Array,r.count=0,r}return n(t,e),t.prototype._next=function(e){var t=this.ring,n=this.total,r=this.count++;t.length<n?t.push(e):t[r%n]=e},t.prototype._complete=function(){var e=this.destination,t=this.count;if(t>0)for(var n=this.count>=this.total?this.total:this.count,r=this.ring,i=0;i<n;i++){var o=t++%n;e.next(r[o])}e.complete()},t}(A);var Yn=function(){function e(e){this.value=e}return e.prototype.call=function(e,t){return t.subscribe(new Zn(e,this.value))},e}(),Zn=function(e){function t(t,n){var r=e.call(this,t)||this;return r.value=n,r}return n(t,e),t.prototype._next=function(e){this.destination.next(this.value)},t}(A);var $n=function(){function e(){}return e.prototype.call=function(e,t){return t.subscribe(new er(e))},e}(),er=function(e){function t(t){return e.call(this,t)||this}return n(t,e),t.prototype._next=function(e){this.destination.next(ie.createNext(e))},t.prototype._error=function(e){var t=this.destination;t.next(ie.createError(e)),t.complete()},t.prototype._complete=function(){var e=this.destination;e.next(ie.createComplete()),e.complete()},t}(A);function tr(e,t){var n=!1;return arguments.length>=2&&(n=!0),function(r){return r.lift(new nr(e,t,n))}}var nr=function(){function e(e,t,n){void 0===n&&(n=!1),this.accumulator=e,this.seed=t,this.hasSeed=n}return e.prototype.call=function(e,t){return t.subscribe(new rr(e,this.accumulator,this.seed,this.hasSeed))},e}(),rr=function(e){function t(t,n,r,i){var o=e.call(this,t)||this;return o.accumulator=n,o._seed=r,o.hasSeed=i,o.index=0,o}return n(t,e),Object.defineProperty(t.prototype,"seed",{get:function(){return this._seed},set:function(e){this.hasSeed=!0,this._seed=e},enumerable:!0,configurable:!0}),t.prototype._next=function(e){if(this.hasSeed)return this._tryNext(e);this.seed=e,this.destination.next(e)},t.prototype._tryNext=function(e){var t,n=this.index++;try{t=this.accumulator(this.seed,e,n)}catch(e){this.destination.error(e)}this.seed=t,this.destination.next(t)},t}(A);function ir(e,t){return arguments.length>=2?function(n){return b(tr(e,t),Wn(1),sn(t))(n)}:function(t){return b(tr((function(t,n,r){return e(t,n,r+1)})),Wn(1))(t)}}var or=function(){function e(e,t,n){this.accumulator=e,this.seed=t,this.concurrent=n}return e.prototype.call=function(e,t){return t.subscribe(new ar(e,this.accumulator,this.seed,this.concurrent))},e}(),ar=function(e){function t(t,n,r,i){var o=e.call(this,t)||this;return o.accumulator=n,o.acc=r,o.concurrent=i,o.hasValue=!1,o.hasCompleted=!1,o.buffer=[],o.active=0,o.index=0,o}return n(t,e),t.prototype._next=function(e){if(this.active<this.concurrent){var t=this.index++,n=this.destination,r=void 0;try{r=(0,this.accumulator)(this.acc,e,t)}catch(e){return n.error(e)}this.active++,this._innerSub(r)}else this.buffer.push(e)},t.prototype._innerSub=function(e){var t=new Ye(this),n=this.destination;n.add(t);var r=$e(e,t);r!==t&&n.add(r)},t.prototype._complete=function(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&(!1===this.hasValue&&this.destination.next(this.acc),this.destination.complete()),this.unsubscribe()},t.prototype.notifyNext=function(e){var t=this.destination;this.acc=e,this.hasValue=!0,t.next(e)},t.prototype.notifyComplete=function(){var e=this.buffer;this.active--,e.length>0?this._next(e.shift()):0===this.active&&this.hasCompleted&&(!1===this.hasValue&&this.destination.next(this.acc),this.destination.complete())},t}(Ze);function sr(e,t){return function(n){var r;if(r="function"==typeof e?e:function(){return e},"function"==typeof t)return n.lift(new cr(r,t));var i=Object.create(n,L);return i.source=n,i.subjectFactory=r,i}}var cr=function(){function e(e,t){this.subjectFactory=e,this.selector=t}return e.prototype.call=function(e,t){var n=this.selector,r=this.subjectFactory(),i=n(r).subscribe(e);return i.add(t.subscribe(r)),i},e}();var ur=function(){function e(e){this.nextSources=e}return e.prototype.call=function(e,t){return t.subscribe(new lr(e,this.nextSources))},e}(),lr=function(e){function t(t,n){var r=e.call(this,t)||this;return r.destination=t,r.nextSources=n,r}return n(t,e),t.prototype.notifyError=function(){this.subscribeToNextSource()},t.prototype.notifyComplete=function(){this.subscribeToNextSource()},t.prototype._error=function(e){this.subscribeToNextSource(),this.unsubscribe()},t.prototype._complete=function(){this.subscribeToNextSource(),this.unsubscribe()},t.prototype.subscribeToNextSource=function(){var e=this.nextSources.shift();if(e){var t=new Ye(this),n=this.destination;n.add(t);var r=$e(e,t);r!==t&&n.add(r)}else this.destination.complete()},t}(Ze);var dr=function(){function e(){}return e.prototype.call=function(e,t){return t.subscribe(new hr(e))},e}(),hr=function(e){function t(t){var n=e.call(this,t)||this;return n.hasPrev=!1,n}return n(t,e),t.prototype._next=function(e){var t;this.hasPrev?t=[this.prev,e]:this.hasPrev=!0,this.prev=e,t&&this.destination.next(t)},t}(A);function fr(e,t){return function(n){for(var r=n,i=0;i<t;i++){var o=null!=r?r[e[i]]:void 0;if(void 0===o)return;r=o}return r}}var pr=function(){function e(e,t){this.count=e,this.source=t}return e.prototype.call=function(e,t){return t.subscribe(new Ar(e,this.count,this.source))},e}(),Ar=function(e){function t(t,n,r){var i=e.call(this,t)||this;return i.count=n,i.source=r,i}return n(t,e),t.prototype.complete=function(){if(!this.isStopped){var t=this.source,n=this.count;if(0===n)return e.prototype.complete.call(this);n>-1&&(this.count=n-1),t.subscribe(this._unsubscribeAndRecycle())}},t}(A);var gr=function(){function e(e){this.notifier=e}return e.prototype.call=function(e,t){return t.subscribe(new vr(e,this.notifier,t))},e}(),vr=function(e){function t(t,n,r){var i=e.call(this,t)||this;return i.notifier=n,i.source=r,i.sourceIsBeingSubscribedTo=!0,i}return n(t,e),t.prototype.notifyNext=function(){this.sourceIsBeingSubscribedTo=!0,this.source.subscribe(this)},t.prototype.notifyComplete=function(){if(!1===this.sourceIsBeingSubscribedTo)return e.prototype.complete.call(this)},t.prototype.complete=function(){if(this.sourceIsBeingSubscribedTo=!1,!this.isStopped){if(this.retries||this.subscribeToRetries(),!this.retriesSubscription||this.retriesSubscription.closed)return e.prototype.complete.call(this);this._unsubscribeAndRecycle(),this.notifications.next(void 0)}},t.prototype._unsubscribe=function(){var e=this.notifications,t=this.retriesSubscription;e&&(e.unsubscribe(),this.notifications=void 0),t&&(t.unsubscribe(),this.retriesSubscription=void 0),this.retries=void 0},t.prototype._unsubscribeAndRecycle=function(){var t=this._unsubscribe;return this._unsubscribe=null,e.prototype._unsubscribeAndRecycle.call(this),this._unsubscribe=t,this},t.prototype.subscribeToRetries=function(){var t;this.notifications=new C;try{t=(0,this.notifier)(this.notifications)}catch(t){return e.prototype.complete.call(this)}this.retries=t,this.retriesSubscription=$e(t,new Ye(this))},t}(Ze);var mr=function(){function e(e,t){this.count=e,this.source=t}return e.prototype.call=function(e,t){return t.subscribe(new yr(e,this.count,this.source))},e}(),yr=function(e){function t(t,n,r){var i=e.call(this,t)||this;return i.count=n,i.source=r,i}return n(t,e),t.prototype.error=function(t){if(!this.isStopped){var n=this.source,r=this.count;if(0===r)return e.prototype.error.call(this,t);r>-1&&(this.count=r-1),n.subscribe(this._unsubscribeAndRecycle())}},t}(A);var br=function(){function e(e,t){this.notifier=e,this.source=t}return e.prototype.call=function(e,t){return t.subscribe(new Er(e,this.notifier,this.source))},e}(),Er=function(e){function t(t,n,r){var i=e.call(this,t)||this;return i.notifier=n,i.source=r,i}return n(t,e),t.prototype.error=function(t){if(!this.isStopped){var n=this.errors,r=this.retries,i=this.retriesSubscription;if(r)this.errors=void 0,this.retriesSubscription=void 0;else{n=new C;try{r=(0,this.notifier)(n)}catch(t){return e.prototype.error.call(this,t)}i=$e(r,new Ye(this))}this._unsubscribeAndRecycle(),this.errors=n,this.retries=r,this.retriesSubscription=i,n.next(t)}},t.prototype._unsubscribe=function(){var e=this.errors,t=this.retriesSubscription;e&&(e.unsubscribe(),this.errors=void 0),t&&(t.unsubscribe(),this.retriesSubscription=void 0),this.retries=void 0},t.prototype.notifyNext=function(){var e=this._unsubscribe;this._unsubscribe=null,this._unsubscribeAndRecycle(),this._unsubscribe=e,this.source.subscribe(this)},t}(Ze);var _r=function(){function e(e){this.notifier=e}return e.prototype.call=function(e,t){var n=new wr(e),r=t.subscribe(n);return r.add($e(this.notifier,new Ye(n))),r},e}(),wr=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.hasValue=!1,t}return n(t,e),t.prototype._next=function(e){this.value=e,this.hasValue=!0},t.prototype.notifyNext=function(){this.emitValue()},t.prototype.notifyComplete=function(){this.emitValue()},t.prototype.emitValue=function(){this.hasValue&&(this.hasValue=!1,this.destination.next(this.value))},t}(Ze);var Sr=function(){function e(e,t){this.period=e,this.scheduler=t}return e.prototype.call=function(e,t){return t.subscribe(new Tr(e,this.period,this.scheduler))},e}(),Tr=function(e){function t(t,n,r){var i=e.call(this,t)||this;return i.period=n,i.scheduler=r,i.hasValue=!1,i.add(r.schedule(Rr,n,{subscriber:i,period:n})),i}return n(t,e),t.prototype._next=function(e){this.lastValue=e,this.hasValue=!0},t.prototype.notifyNext=function(){this.hasValue&&(this.hasValue=!1,this.destination.next(this.lastValue))},t}(A);function Rr(e){var t=e.subscriber,n=e.period;t.notifyNext(),this.schedule(e,n)}var Cr=function(){function e(e,t){this.compareTo=e,this.comparator=t}return e.prototype.call=function(e,t){return t.subscribe(new Ir(e,this.compareTo,this.comparator))},e}(),Ir=function(e){function t(t,n,r){var i=e.call(this,t)||this;return i.compareTo=n,i.comparator=r,i._a=[],i._b=[],i._oneComplete=!1,i.destination.add(n.subscribe(new xr(t,i))),i}return n(t,e),t.prototype._next=function(e){this._oneComplete&&0===this._b.length?this.emit(!1):(this._a.push(e),this.checkValues())},t.prototype._complete=function(){this._oneComplete?this.emit(0===this._a.length&&0===this._b.length):this._oneComplete=!0,this.unsubscribe()},t.prototype.checkValues=function(){for(var e=this,t=e._a,n=e._b,r=e.comparator;t.length>0&&n.length>0;){var i=t.shift(),o=n.shift(),a=!1;try{a=r?r(i,o):i===o}catch(e){this.destination.error(e)}a||this.emit(!1)}},t.prototype.emit=function(e){var t=this.destination;t.next(e),t.complete()},t.prototype.nextB=function(e){this._oneComplete&&0===this._a.length?this.emit(!1):(this._b.push(e),this.checkValues())},t.prototype.completeB=function(){this._oneComplete?this.emit(0===this._a.length&&0===this._b.length):this._oneComplete=!0},t}(A),xr=function(e){function t(t,n){var r=e.call(this,t)||this;return r.parent=n,r}return n(t,e),t.prototype._next=function(e){this.parent.nextB(e)},t.prototype._error=function(e){this.parent.error(e),this.unsubscribe()},t.prototype._complete=function(){this.parent.completeB(),this.unsubscribe()},t}(A);function Or(){return new C}var Nr=function(){function e(e,t){this.predicate=e,this.source=t}return e.prototype.call=function(e,t){return t.subscribe(new Br(e,this.predicate,this.source))},e}(),Br=function(e){function t(t,n,r){var i=e.call(this,t)||this;return i.predicate=n,i.source=r,i.seenValue=!1,i.index=0,i}return n(t,e),t.prototype.applySingleValue=function(e){this.seenValue?this.destination.error("Sequence contains more than one element"):(this.seenValue=!0,this.singleValue=e)},t.prototype._next=function(e){var t=this.index++;this.predicate?this.tryNext(e,t):this.applySingleValue(e)},t.prototype.tryNext=function(e,t){try{this.predicate(e,t,this.source)&&this.applySingleValue(e)}catch(e){this.destination.error(e)}},t.prototype._complete=function(){var e=this.destination;this.index>0?(e.next(this.seenValue?this.singleValue:void 0),e.complete()):e.error(new xe)},t}(A);var Mr=function(){function e(e){this.total=e}return e.prototype.call=function(e,t){return t.subscribe(new Lr(e,this.total))},e}(),Lr=function(e){function t(t,n){var r=e.call(this,t)||this;return r.total=n,r.count=0,r}return n(t,e),t.prototype._next=function(e){++this.count>this.total&&this.destination.next(e)},t}(A);var kr=function(){function e(e){if(this._skipCount=e,this._skipCount<0)throw new Ie}return e.prototype.call=function(e,t){return 0===this._skipCount?t.subscribe(new A(e)):t.subscribe(new Ur(e,this._skipCount))},e}(),Ur=function(e){function t(t,n){var r=e.call(this,t)||this;return r._skipCount=n,r._count=0,r._ring=new Array(n),r}return n(t,e),t.prototype._next=function(e){var t=this._skipCount,n=this._count++;if(n<t)this._ring[n]=e;else{var r=n%t,i=this._ring,o=i[r];i[r]=e,this.destination.next(o)}},t}(A);var Dr=function(){function e(e){this.notifier=e}return e.prototype.call=function(e,t){return t.subscribe(new Pr(e,this.notifier))},e}(),Pr=function(e){function t(t,n){var r=e.call(this,t)||this;r.hasValue=!1;var i=new Ye(r);r.add(i),r.innerSubscription=i;var o=$e(n,i);return o!==i&&(r.add(o),r.innerSubscription=o),r}return n(t,e),t.prototype._next=function(t){this.hasValue&&e.prototype._next.call(this,t)},t.prototype.notifyNext=function(){this.hasValue=!0,this.innerSubscription&&this.innerSubscription.unsubscribe()},t.prototype.notifyComplete=function(){},t}(Ze);var Fr=function(){function e(e){this.predicate=e}return e.prototype.call=function(e,t){return t.subscribe(new Hr(e,this.predicate))},e}(),Hr=function(e){function t(t,n){var r=e.call(this,t)||this;return r.predicate=n,r.skipping=!0,r.index=0,r}return n(t,e),t.prototype._next=function(e){var t=this.destination;this.skipping&&this.tryCallPredicate(e),this.skipping||t.next(e)},t.prototype.tryCallPredicate=function(e){try{var t=this.predicate(e,this.index++);this.skipping=Boolean(t)}catch(e){this.destination.error(e)}},t}(A);var jr=function(e){function t(t,n,r){void 0===n&&(n=0),void 0===r&&(r=ye);var i=e.call(this)||this;return i.source=t,i.delayTime=n,i.scheduler=r,(!dt(n)||n<0)&&(i.delayTime=0),r&&"function"==typeof r.schedule||(i.scheduler=ye),i}return n(t,e),t.create=function(e,n,r){return void 0===n&&(n=0),void 0===r&&(r=ye),new t(e,n,r)},t.dispatch=function(e){var t=e.source,n=e.subscriber;return this.add(t.subscribe(n))},t.prototype._subscribe=function(e){var n=this.delayTime,r=this.source;return this.scheduler.schedule(t.dispatch,n,{source:r,subscriber:e})},t}(_);var Vr=function(){function e(e,t){this.scheduler=e,this.delay=t}return e.prototype.call=function(e,t){return new jr(t,this.delay,this.scheduler).subscribe(e)},e}();function Qr(e,t){return"function"==typeof t?function(n){return n.pipe(Qr((function(n,r){return Je(e(n,r)).pipe(Ne((function(e,i){return t(n,e,r,i)})))})))}:function(t){return t.lift(new Gr(e))}}var Gr=function(){function e(e){this.project=e}return e.prototype.call=function(e,t){return t.subscribe(new zr(e,this.project))},e}(),zr=function(e){function t(t,n){var r=e.call(this,t)||this;return r.project=n,r.index=0,r}return n(t,e),t.prototype._next=function(e){var t,n=this.index++;try{t=this.project(e,n)}catch(e){return void this.destination.error(e)}this._innerSub(t)},t.prototype._innerSub=function(e){var t=this.innerSubscription;t&&t.unsubscribe();var n=new Ye(this),r=this.destination;r.add(n),this.innerSubscription=$e(e,n),this.innerSubscription!==n&&r.add(this.innerSubscription)},t.prototype._complete=function(){var t=this.innerSubscription;t&&!t.closed||e.prototype._complete.call(this),this.unsubscribe()},t.prototype._unsubscribe=function(){this.innerSubscription=void 0},t.prototype.notifyComplete=function(){this.innerSubscription=void 0,this.isStopped&&e.prototype._complete.call(this)},t.prototype.notifyNext=function(e){this.destination.next(e)},t}(Ze);var Kr=function(){function e(e){this.notifier=e}return e.prototype.call=function(e,t){var n=new qr(e),r=$e(this.notifier,new Ye(n));return r&&!n.seenValue?(n.add(r),t.subscribe(n)):n},e}(),qr=function(e){function t(t){var n=e.call(this,t)||this;return n.seenValue=!1,n}return n(t,e),t.prototype.notifyNext=function(){this.seenValue=!0,this.complete()},t.prototype.notifyComplete=function(){},t}(Ze);var Wr=function(){function e(e,t){this.predicate=e,this.inclusive=t}return e.prototype.call=function(e,t){return t.subscribe(new Xr(e,this.predicate,this.inclusive))},e}(),Xr=function(e){function t(t,n,r){var i=e.call(this,t)||this;return i.predicate=n,i.inclusive=r,i.index=0,i}return n(t,e),t.prototype._next=function(e){var t,n=this.destination;try{t=this.predicate(e,this.index++)}catch(e){return void n.error(e)}this.nextOrComplete(e,t)},t.prototype.nextOrComplete=function(e,t){var n=this.destination;Boolean(t)?n.next(e):(this.inclusive&&n.next(e),n.complete())},t}(A);var Jr=function(){function e(e,t,n){this.nextOrObserver=e,this.error=t,this.complete=n}return e.prototype.call=function(e,t){return t.subscribe(new Yr(e,this.nextOrObserver,this.error,this.complete))},e}(),Yr=function(e){function t(t,n,r,o){var a=e.call(this,t)||this;return a._tapNext=Ce,a._tapError=Ce,a._tapComplete=Ce,a._tapError=r||Ce,a._tapComplete=o||Ce,i(n)?(a._context=a,a._tapNext=n):n&&(a._context=n,a._tapNext=n.next||Ce,a._tapError=n.error||Ce,a._tapComplete=n.complete||Ce),a}return n(t,e),t.prototype._next=function(e){try{this._tapNext.call(this._context,e)}catch(e){return void this.destination.error(e)}this.destination.next(e)},t.prototype._error=function(e){try{this._tapError.call(this._context,e)}catch(e){return void this.destination.error(e)}this.destination.error(e)},t.prototype._complete=function(){try{this._tapComplete.call(this._context)}catch(e){return void this.destination.error(e)}return this.destination.complete()},t}(A),Zr={leading:!0,trailing:!1};var $r=function(){function e(e,t,n){this.durationSelector=e,this.leading=t,this.trailing=n}return e.prototype.call=function(e,t){return t.subscribe(new ei(e,this.durationSelector,this.leading,this.trailing))},e}(),ei=function(e){function t(t,n,r,i){var o=e.call(this,t)||this;return o.destination=t,o.durationSelector=n,o._leading=r,o._trailing=i,o._hasValue=!1,o}return n(t,e),t.prototype._next=function(e){this._hasValue=!0,this._sendValue=e,this._throttled||(this._leading?this.send():this.throttle(e))},t.prototype.send=function(){var e=this._hasValue,t=this._sendValue;e&&(this.destination.next(t),this.throttle(t)),this._hasValue=!1,this._sendValue=void 0},t.prototype.throttle=function(e){var t=this.tryDurationSelector(e);t&&this.add(this._throttled=$e(t,new Ye(this)))},t.prototype.tryDurationSelector=function(e){try{return this.durationSelector(e)}catch(e){return this.destination.error(e),null}},t.prototype.throttlingDone=function(){var e=this._throttled,t=this._trailing;e&&e.unsubscribe(),this._throttled=void 0,t&&this.send()},t.prototype.notifyNext=function(){this.throttlingDone()},t.prototype.notifyComplete=function(){this.throttlingDone()},t}(Ze);var ti=function(){function e(e,t,n,r){this.duration=e,this.scheduler=t,this.leading=n,this.trailing=r}return e.prototype.call=function(e,t){return t.subscribe(new ni(e,this.duration,this.scheduler,this.leading,this.trailing))},e}(),ni=function(e){function t(t,n,r,i,o){var a=e.call(this,t)||this;return a.duration=n,a.scheduler=r,a.leading=i,a.trailing=o,a._hasTrailingValue=!1,a._trailingValue=null,a}return n(t,e),t.prototype._next=function(e){this.throttled?this.trailing&&(this._trailingValue=e,this._hasTrailingValue=!0):(this.add(this.throttled=this.scheduler.schedule(ri,this.duration,{subscriber:this})),this.leading?this.destination.next(e):this.trailing&&(this._trailingValue=e,this._hasTrailingValue=!0))},t.prototype._complete=function(){this._hasTrailingValue?(this.destination.next(this._trailingValue),this.destination.complete()):this.destination.complete()},t.prototype.clearThrottle=function(){var e=this.throttled;e&&(this.trailing&&this._hasTrailingValue&&(this.destination.next(this._trailingValue),this._trailingValue=null,this._hasTrailingValue=!1),e.unsubscribe(),this.remove(e),this.throttled=null)},t}(A);function ri(e){e.subscriber.clearThrottle()}var ii=function(e,t){this.value=e,this.interval=t};function oi(e,t,n){return void 0===n&&(n=Ee),function(r){var i=ln(e),o=i?+e-n.now():Math.abs(e);return r.lift(new ai(o,i,t,n))}}var ai=function(){function e(e,t,n,r){this.waitFor=e,this.absoluteTimeout=t,this.withObservable=n,this.scheduler=r}return e.prototype.call=function(e,t){return t.subscribe(new si(e,this.absoluteTimeout,this.waitFor,this.withObservable,this.scheduler))},e}(),si=function(e){function t(t,n,r,i,o){var a=e.call(this,t)||this;return a.absoluteTimeout=n,a.waitFor=r,a.withObservable=i,a.scheduler=o,a.scheduleTimeout(),a}return n(t,e),t.dispatchTimeout=function(e){var t=e.withObservable;e._unsubscribeAndRecycle(),e.add($e(t,new Ye(e)))},t.prototype.scheduleTimeout=function(){var e=this.action;e?this.action=e.schedule(this,this.waitFor):this.add(this.action=this.scheduler.schedule(t.dispatchTimeout,this.waitFor,this))},t.prototype._next=function(t){this.absoluteTimeout||this.scheduleTimeout(),e.prototype._next.call(this,t)},t.prototype._unsubscribe=function(){this.action=void 0,this.scheduler=null,this.withObservable=null},t}(Ze);var ci=function(e,t){this.value=e,this.timestamp=t};function ui(e,t,n){return 0===n?[t]:(e.push(t),e)}var li=function(){function e(e){this.windowBoundaries=e}return e.prototype.call=function(e,t){var n=new di(e),r=t.subscribe(n);return r.closed||n.add($e(this.windowBoundaries,new Ye(n))),r},e}(),di=function(e){function t(t){var n=e.call(this,t)||this;return n.window=new C,t.next(n.window),n}return n(t,e),t.prototype.notifyNext=function(){this.openWindow()},t.prototype.notifyError=function(e){this._error(e)},t.prototype.notifyComplete=function(){this._complete()},t.prototype._next=function(e){this.window.next(e)},t.prototype._error=function(e){this.window.error(e),this.destination.error(e)},t.prototype._complete=function(){this.window.complete(),this.destination.complete()},t.prototype._unsubscribe=function(){this.window=null},t.prototype.openWindow=function(){var e=this.window;e&&e.complete();var t=this.destination,n=this.window=new C;t.next(n)},t}(Ze);var hi=function(){function e(e,t){this.windowSize=e,this.startWindowEvery=t}return e.prototype.call=function(e,t){return t.subscribe(new fi(e,this.windowSize,this.startWindowEvery))},e}(),fi=function(e){function t(t,n,r){var i=e.call(this,t)||this;return i.destination=t,i.windowSize=n,i.startWindowEvery=r,i.windows=[new C],i.count=0,t.next(i.windows[0]),i}return n(t,e),t.prototype._next=function(e){for(var t=this.startWindowEvery>0?this.startWindowEvery:this.windowSize,n=this.destination,r=this.windowSize,i=this.windows,o=i.length,a=0;a<o&&!this.closed;a++)i[a].next(e);var s=this.count-r+1;if(s>=0&&s%t==0&&!this.closed&&i.shift().complete(),++this.count%t==0&&!this.closed){var c=new C;i.push(c),n.next(c)}},t.prototype._error=function(e){var t=this.windows;if(t)for(;t.length>0&&!this.closed;)t.shift().error(e);this.destination.error(e)},t.prototype._complete=function(){var e=this.windows;if(e)for(;e.length>0&&!this.closed;)e.shift().complete();this.destination.complete()},t.prototype._unsubscribe=function(){this.count=0,this.windows=null},t}(A);var pi=function(){function e(e,t,n,r){this.windowTimeSpan=e,this.windowCreationInterval=t,this.maxWindowSize=n,this.scheduler=r}return e.prototype.call=function(e,t){return t.subscribe(new gi(e,this.windowTimeSpan,this.windowCreationInterval,this.maxWindowSize,this.scheduler))},e}(),Ai=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._numberOfNextedValues=0,t}return n(t,e),t.prototype.next=function(t){this._numberOfNextedValues++,e.prototype.next.call(this,t)},Object.defineProperty(t.prototype,"numberOfNextedValues",{get:function(){return this._numberOfNextedValues},enumerable:!0,configurable:!0}),t}(C),gi=function(e){function t(t,n,r,i,o){var a=e.call(this,t)||this;a.destination=t,a.windowTimeSpan=n,a.windowCreationInterval=r,a.maxWindowSize=i,a.scheduler=o,a.windows=[];var s=a.openWindow();if(null!==r&&r>=0){var c={subscriber:a,window:s,context:null},u={windowTimeSpan:n,windowCreationInterval:r,subscriber:a,scheduler:o};a.add(o.schedule(yi,n,c)),a.add(o.schedule(mi,r,u))}else{var l={subscriber:a,window:s,windowTimeSpan:n};a.add(o.schedule(vi,n,l))}return a}return n(t,e),t.prototype._next=function(e){for(var t=this.windows,n=t.length,r=0;r<n;r++){var i=t[r];i.closed||(i.next(e),i.numberOfNextedValues>=this.maxWindowSize&&this.closeWindow(i))}},t.prototype._error=function(e){for(var t=this.windows;t.length>0;)t.shift().error(e);this.destination.error(e)},t.prototype._complete=function(){for(var e=this.windows;e.length>0;){var t=e.shift();t.closed||t.complete()}this.destination.complete()},t.prototype.openWindow=function(){var e=new Ai;return this.windows.push(e),this.destination.next(e),e},t.prototype.closeWindow=function(e){e.complete();var t=this.windows;t.splice(t.indexOf(e),1)},t}(A);function vi(e){var t=e.subscriber,n=e.windowTimeSpan,r=e.window;r&&t.closeWindow(r),e.window=t.openWindow(),this.schedule(e,n)}function mi(e){var t=e.windowTimeSpan,n=e.subscriber,r=e.scheduler,i=e.windowCreationInterval,o=n.openWindow(),a=this,s={action:a,subscription:null},c={subscriber:n,window:o,context:s};s.subscription=r.schedule(yi,t,c),a.add(s.subscription),a.schedule(e,i)}function yi(e){var t=e.subscriber,n=e.window,r=e.context;r&&r.action&&r.subscription&&r.action.remove(r.subscription),t.closeWindow(n)}var bi=function(){function e(e,t){this.openings=e,this.closingSelector=t}return e.prototype.call=function(e,t){return t.subscribe(new Ei(e,this.openings,this.closingSelector))},e}(),Ei=function(e){function t(t,n,r){var i=e.call(this,t)||this;return i.openings=n,i.closingSelector=r,i.contexts=[],i.add(i.openSubscription=ze(i,n,n)),i}return n(t,e),t.prototype._next=function(e){var t=this.contexts;if(t)for(var n=t.length,r=0;r<n;r++)t[r].window.next(e)},t.prototype._error=function(t){var n=this.contexts;if(this.contexts=null,n)for(var r=n.length,i=-1;++i<r;){var o=n[i];o.window.error(t),o.subscription.unsubscribe()}e.prototype._error.call(this,t)},t.prototype._complete=function(){var t=this.contexts;if(this.contexts=null,t)for(var n=t.length,r=-1;++r<n;){var i=t[r];i.window.complete(),i.subscription.unsubscribe()}e.prototype._complete.call(this)},t.prototype._unsubscribe=function(){var e=this.contexts;if(this.contexts=null,e)for(var t=e.length,n=-1;++n<t;){var r=e[n];r.window.unsubscribe(),r.subscription.unsubscribe()}},t.prototype.notifyNext=function(e,t,n,r,i){if(e===this.openings){var o=void 0;try{o=(0,this.closingSelector)(t)}catch(e){return this.error(e)}var a=new C,s=new h,c={window:a,subscription:s};this.contexts.push(c);var u=ze(this,o,c);u.closed?this.closeWindow(this.contexts.length-1):(u.context=c,s.add(u)),this.destination.next(a)}else this.closeWindow(this.contexts.indexOf(e))},t.prototype.notifyError=function(e){this.error(e)},t.prototype.notifyComplete=function(e){e!==this.openSubscription&&this.closeWindow(this.contexts.indexOf(e.context))},t.prototype.closeWindow=function(e){if(-1!==e){var t=this.contexts,n=t[e],r=n.window,i=n.subscription;t.splice(e,1),r.complete(),i.unsubscribe()}},t}(Fe);var _i=function(){function e(e){this.closingSelector=e}return e.prototype.call=function(e,t){return t.subscribe(new wi(e,this.closingSelector))},e}(),wi=function(e){function t(t,n){var r=e.call(this,t)||this;return r.destination=t,r.closingSelector=n,r.openWindow(),r}return n(t,e),t.prototype.notifyNext=function(e,t,n,r,i){this.openWindow(i)},t.prototype.notifyError=function(e){this._error(e)},t.prototype.notifyComplete=function(e){this.openWindow(e)},t.prototype._next=function(e){this.window.next(e)},t.prototype._error=function(e){this.window.error(e),this.destination.error(e),this.unsubscribeClosingNotification()},t.prototype._complete=function(){this.window.complete(),this.destination.complete(),this.unsubscribeClosingNotification()},t.prototype.unsubscribeClosingNotification=function(){this.closingNotification&&this.closingNotification.unsubscribe()},t.prototype.openWindow=function(e){void 0===e&&(e=null),e&&(this.remove(e),e.unsubscribe());var t=this.window;t&&t.complete();var n,r=this.window=new C;this.destination.next(r);try{n=(0,this.closingSelector)()}catch(e){return this.destination.error(e),void this.window.error(e)}this.add(this.closingNotification=ze(this,n))},t}(Fe);var Si=function(){function e(e,t){this.observables=e,this.project=t}return e.prototype.call=function(e,t){return t.subscribe(new Ti(e,this.observables,this.project))},e}(),Ti=function(e){function t(t,n,r){var i=e.call(this,t)||this;i.observables=n,i.project=r,i.toRespond=[];var o=n.length;i.values=new Array(o);for(var a=0;a<o;a++)i.toRespond.push(a);for(a=0;a<o;a++){var s=n[a];i.add(ze(i,s,void 0,a))}return i}return n(t,e),t.prototype.notifyNext=function(e,t,n){this.values[n]=t;var r=this.toRespond;if(r.length>0){var i=r.indexOf(n);-1!==i&&r.splice(i,1)}},t.prototype.notifyComplete=function(){},t.prototype._next=function(e){if(0===this.toRespond.length){var t=[e].concat(this.values);this.project?this._tryProject(t):this.destination.next(t)}},t.prototype._tryProject=function(e){var t;try{t=this.project.apply(this,e)}catch(e){return void this.destination.error(e)}this.destination.next(t)},t}(Fe);var Ri=Object.freeze({audit:Bt,auditTime:function(e,t){return void 0===t&&(t=Ee),Bt((function(){return St(e,t)}))},buffer:function(e){return function(t){return t.lift(new kt(e))}},bufferCount:function(e,t){return void 0===t&&(t=null),function(n){return n.lift(new Dt(e,t))}},bufferTime:function(e){var t=arguments.length,n=Ee;J(arguments[arguments.length-1])&&(n=arguments[arguments.length-1],t--);var r=null;t>=2&&(r=arguments[1]);var i=Number.POSITIVE_INFINITY;return t>=3&&(i=arguments[2]),function(t){return t.lift(new Ht(e,r,i,n))}},bufferToggle:function(e,t){return function(n){return n.lift(new Kt(e,t))}},bufferWhen:function(e){return function(t){return t.lift(new Wt(e))}},catchError:function(e){return function(t){var n=new Jt(e),r=t.lift(n);return n.caught=r}},combineAll:function(e){return function(t){return t.lift(new qe(e))}},combineLatest:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=null;return"function"==typeof e[e.length-1]&&(n=e.pop()),1===e.length&&u(e[0])&&(e=e[0].slice()),function(t){return t.lift.call(Je([t].concat(e)),new qe(n))}},concat:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return function(t){return t.lift.call(at.apply(void 0,[t].concat(e)))}},concatAll:ot,concatMap:Zt,concatMapTo:function(e,t){return Zt((function(){return e}),t)},count:function(e){return function(t){return t.lift(new $t(e,t))}},debounce:function(e){return function(t){return t.lift(new tn(e))}},debounceTime:function(e,t){return void 0===t&&(t=Ee),function(n){return n.lift(new rn(e,t))}},defaultIfEmpty:sn,delay:function(e,t){void 0===t&&(t=Ee);var n=ln(e)?+e-t.now():Math.abs(e);return function(e){return e.lift(new dn(n,t))}},delayWhen:function(e,t){return t?function(n){return new gn(n,t).lift(new pn(e))}:function(t){return t.lift(new pn(e))}},dematerialize:function(){return function(e){return e.lift(new mn)}},distinct:function(e,t){return function(n){return n.lift(new bn(e,t))}},distinctUntilChanged:_n,distinctUntilKeyChanged:function(e,t){return _n((function(n,r){return t?t(n[e],r[e]):n[e]===r[e]}))},elementAt:function(e,t){if(e<0)throw new Ie;var n=arguments.length>=2;return function(r){return r.pipe(vt((function(t,n){return n===e})),xn(1),n?sn(t):Tn((function(){return new Ie})))}},endWith:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return function(t){return at(t,te.apply(void 0,e))}},every:function(e,t){return function(n){return n.lift(new Bn(e,t,n))}},exhaust:function(){return function(e){return e.lift(new Ln)}},exhaustMap:function e(t,n){return n?function(r){return r.pipe(e((function(e,r){return Je(t(e,r)).pipe(Ne((function(t,i){return n(e,t,r,i)})))})))}:function(e){return e.lift(new Un(t))}},expand:function(e,t,n){return void 0===t&&(t=Number.POSITIVE_INFINITY),t=(t||0)<1?Number.POSITIVE_INFINITY:t,function(r){return r.lift(new Pn(e,t,n))}},filter:vt,finalize:function(e){return function(t){return t.lift(new Hn(e))}},find:function(e,t){if("function"!=typeof e)throw new TypeError("predicate is not a function");return function(n){return n.lift(new Vn(e,n,!1,t))}},findIndex:function(e,t){return function(n){return n.lift(new Vn(e,n,!0,t))}},first:function(e,t){var n=arguments.length>=2;return function(r){return r.pipe(e?vt((function(t,n){return e(t,n,r)})):y,xn(1),n?sn(t):Tn((function(){return new xe})))}},groupBy:function(e,t,n,r){return function(i){return i.lift(new U(e,t,n,r))}},ignoreElements:function(){return function(e){return e.lift(new Gn)}},isEmpty:function(){return function(e){return e.lift(new Kn)}},last:function(e,t){var n=arguments.length>=2;return function(r){return r.pipe(e?vt((function(t,n){return e(t,n,r)})):y,Wn(1),n?sn(t):Tn((function(){return new xe})))}},map:Ne,mapTo:function(e){return function(t){return t.lift(new Yn(e))}},materialize:function(){return function(e){return e.lift(new $n)}},max:function(e){return ir("function"==typeof e?function(t,n){return e(t,n)>0?t:n}:function(e,t){return e>t?e:t})},merge:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return function(t){return t.lift.call(ft.apply(void 0,[t].concat(e)))}},mergeAll:it,mergeMap:et,flatMap:rt,mergeMapTo:function(e,t,n){return void 0===n&&(n=Number.POSITIVE_INFINITY),"function"==typeof t?et((function(){return e}),t,n):("number"==typeof t&&(n=t),et((function(){return e}),n))},mergeScan:function(e,t,n){return void 0===n&&(n=Number.POSITIVE_INFINITY),function(r){return r.lift(new or(e,t,n))}},min:function(e){return ir("function"==typeof e?function(t,n){return e(t,n)<0?t:n}:function(e,t){return e<t?e:t})},multicast:sr,observeOn:function(e,t){return void 0===t&&(t=0),function(n){return n.lift(new oe(e,t))}},onErrorResumeNext:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return 1===e.length&&u(e[0])&&(e=e[0]),function(t){return t.lift(new ur(e))}},pairwise:function(){return function(e){return e.lift(new dr)}},partition:function(e,t){return function(n){return[vt(e,t)(n),vt(gt(e,t))(n)]}},pluck:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=e.length;if(0===n)throw new Error("list of properties cannot be empty.");return function(t){return Ne(fr(e,n))(t)}},publish:function(e){return e?sr((function(){return new C}),e):sr(new C)},publishBehavior:function(e){return function(t){return sr(new j(e))(t)}},publishLast:function(){return function(e){return sr(new le)(e)}},publishReplay:function(e,t,n,r){n&&"function"!=typeof n&&(r=n);var i="function"==typeof n?n:void 0,o=new ce(e,t,r);return function(e){return sr((function(){return o}),i)(e)}},race:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return function(t){return 1===e.length&&u(e[0])&&(e=e[0]),t.lift.call(bt.apply(void 0,[t].concat(e)))}},reduce:ir,repeat:function(e){return void 0===e&&(e=-1),function(t){return 0===e?X():e<0?t.lift(new pr(-1,t)):t.lift(new pr(e-1,t))}},repeatWhen:function(e){return function(t){return t.lift(new gr(e))}},retry:function(e){return void 0===e&&(e=-1),function(t){return t.lift(new mr(e,t))}},retryWhen:function(e){return function(t){return t.lift(new br(e,t))}},refCount:x,sample:function(e){return function(t){return t.lift(new _r(e))}},sampleTime:function(e,t){return void 0===t&&(t=Ee),function(n){return n.lift(new Sr(e,t))}},scan:tr,sequenceEqual:function(e,t){return function(n){return n.lift(new Cr(e,t))}},share:function(){return function(e){return x()(sr(Or)(e))}},shareReplay:function(e,t,n){var r;return r=e&&"object"==typeof e?e:{bufferSize:e,windowTime:t,refCount:!1,scheduler:n},function(e){return e.lift(function(e){var t,n,r=e.bufferSize,i=void 0===r?Number.POSITIVE_INFINITY:r,o=e.windowTime,a=void 0===o?Number.POSITIVE_INFINITY:o,s=e.refCount,c=e.scheduler,u=0,l=!1,d=!1;return function(e){var r;u++,!t||l?(l=!1,t=new ce(i,a,c),r=t.subscribe(this),n=e.subscribe({next:function(e){t.next(e)},error:function(e){l=!0,t.error(e)},complete:function(){d=!0,n=void 0,t.complete()}})):r=t.subscribe(this),this.add((function(){u--,r.unsubscribe(),n&&!d&&s&&0===u&&(n.unsubscribe(),n=void 0,t=void 0)}))}}(r))}},single:function(e){return function(t){return t.lift(new Nr(e,t))}},skip:function(e){return function(t){return t.lift(new Mr(e))}},skipLast:function(e){return function(t){return t.lift(new kr(e))}},skipUntil:function(e){return function(t){return t.lift(new Dr(e))}},skipWhile:function(e){return function(t){return t.lift(new Fr(e))}},startWith:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=e[e.length-1];return J(n)?(e.pop(),function(t){return at(e,t,n)}):function(t){return at(e,t)}},subscribeOn:function(e,t){return void 0===t&&(t=0),function(n){return n.lift(new Vr(e,t))}},switchAll:function(){return Qr(y)},switchMap:Qr,switchMapTo:function(e,t){return t?Qr((function(){return e}),t):Qr((function(){return e}))},take:xn,takeLast:Wn,takeUntil:function(e){return function(t){return t.lift(new Kr(e))}},takeWhile:function(e,t){return void 0===t&&(t=!1),function(n){return n.lift(new Wr(e,t))}},tap:function(e,t,n){return function(r){return r.lift(new Jr(e,t,n))}},throttle:function(e,t){return void 0===t&&(t=Zr),function(n){return n.lift(new $r(e,!!t.leading,!!t.trailing))}},throttleTime:function(e,t,n){return void 0===t&&(t=Ee),void 0===n&&(n=Zr),function(r){return r.lift(new ti(e,t,n.leading,n.trailing))}},throwIfEmpty:Tn,timeInterval:function(e){return void 0===e&&(e=Ee),function(t){return st((function(){return t.pipe(tr((function(t,n){var r=t.current;return{value:n,current:e.now(),last:r}}),{current:e.now(),value:void 0,last:void 0}),Ne((function(e){var t=e.current,n=e.last,r=e.value;return new ii(r,t-n)})))}))}},timeout:function(e,t){return void 0===t&&(t=Ee),oi(e,ne(new Oe),t)},timeoutWith:oi,timestamp:function(e){return void 0===e&&(e=Ee),Ne((function(t){return new ci(t,e.now())}))},toArray:function(){return ir(ui,[])},window:function(e){return function(t){return t.lift(new li(e))}},windowCount:function(e,t){return void 0===t&&(t=0),function(n){return n.lift(new hi(e,t))}},windowTime:function(e){var t=Ee,n=null,r=Number.POSITIVE_INFINITY;return J(arguments[3])&&(t=arguments[3]),J(arguments[2])?t=arguments[2]:dt(arguments[2])&&(r=Number(arguments[2])),J(arguments[1])?t=arguments[1]:dt(arguments[1])&&(n=Number(arguments[1])),function(i){return i.lift(new pi(e,n,r,t))}},windowToggle:function(e,t){return function(n){return n.lift(new bi(e,t))}},windowWhen:function(e){return function(t){return t.lift(new _i(e))}},withLatestFrom:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return function(t){var n;"function"==typeof e[e.length-1]&&(n=e.pop());var r=e;return t.lift(new Si(r,n))}},zip:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return function(t){return t.lift.call(Rt.apply(void 0,[t].concat(e)))}},zipAll:function(e){return function(t){return t.lift(new Ct(e))}}}),Ci=function(e,t){void 0===t&&(t=Number.POSITIVE_INFINITY),this.subscribedFrame=e,this.unsubscribedFrame=t},Ii=function(){function e(){this.subscriptions=[]}return e.prototype.logSubscribedFrame=function(){return this.subscriptions.push(new Ci(this.scheduler.now())),this.subscriptions.length-1},e.prototype.logUnsubscribedFrame=function(e){var t=this.subscriptions,n=t[e];t[e]=new Ci(n.subscribedFrame,this.scheduler.now())},e}();function xi(e,t){for(var n=0,r=t.length;n<r;n++)for(var i=t[n],o=Object.getOwnPropertyNames(i.prototype),a=0,s=o.length;a<s;a++){var c=o[a];e.prototype[c]=i.prototype[c]}}var Oi=function(e){function t(t,n){var r=e.call(this,(function(e){var t=this,n=t.logSubscribedFrame(),r=new h;return r.add(new h((function(){t.logUnsubscribedFrame(n)}))),t.scheduleMessages(e),r}))||this;return r.messages=t,r.subscriptions=[],r.scheduler=n,r}return n(t,e),t.prototype.scheduleMessages=function(e){for(var t=this.messages.length,n=0;n<t;n++){var r=this.messages[n];e.add(this.scheduler.schedule((function(e){var t=e.message,n=e.subscriber;t.notification.observe(n)}),r.frame,{message:r,subscriber:e}))}},t}(_);xi(Oi,[Ii]);var Ni=function(e){function t(t,n){var r=e.call(this)||this;return r.messages=t,r.subscriptions=[],r.scheduler=n,r}return n(t,e),t.prototype._subscribe=function(t){var n=this,r=n.logSubscribedFrame(),i=new h;return i.add(new h((function(){n.logUnsubscribedFrame(r)}))),i.add(e.prototype._subscribe.call(this,t)),i},t.prototype.setup=function(){for(var e=this,t=e.messages.length,n=0;n<t;n++)!function(){var t=e.messages[n];e.scheduler.schedule((function(){t.notification.observe(e)}),t.frame)}()},t}(C);xi(Ni,[Ii]);var Bi=function(e){function t(t){var n=e.call(this,Re,750)||this;return n.assertDeepEqual=t,n.hotObservables=[],n.coldObservables=[],n.flushTests=[],n.runMode=!1,n}return n(t,e),t.prototype.createTime=function(e){var n=e.indexOf("|");if(-1===n)throw new Error('marble diagram for time should have a completion marker "|"');return n*t.frameTimeFactor},t.prototype.createColdObservable=function(e,n,r){if(-1!==e.indexOf("^"))throw new Error('cold observable cannot have subscription offset "^"');if(-1!==e.indexOf("!"))throw new Error('cold observable cannot have unsubscription marker "!"');var i=t.parseMarbles(e,n,r,void 0,this.runMode),o=new Oi(i,this);return this.coldObservables.push(o),o},t.prototype.createHotObservable=function(e,n,r){if(-1!==e.indexOf("!"))throw new Error('hot observable cannot have unsubscription marker "!"');var i=t.parseMarbles(e,n,r,void 0,this.runMode),o=new Ni(i,this);return this.hotObservables.push(o),o},t.prototype.materializeInnerObservable=function(e,t){var n=this,r=[];return e.subscribe((function(e){r.push({frame:n.frame-t,notification:ie.createNext(e)})}),(function(e){r.push({frame:n.frame-t,notification:ie.createError(e)})}),(function(){r.push({frame:n.frame-t,notification:ie.createComplete()})})),r},t.prototype.expectObservable=function(e,n){var r=this;void 0===n&&(n=null);var i,o=[],a={actual:o,ready:!1},s=t.parseMarblesAsSubscriptions(n,this.runMode),c=s.subscribedFrame===Number.POSITIVE_INFINITY?0:s.subscribedFrame,u=s.unsubscribedFrame;this.schedule((function(){i=e.subscribe((function(e){var t=e;e instanceof _&&(t=r.materializeInnerObservable(t,r.frame)),o.push({frame:r.frame,notification:ie.createNext(t)})}),(function(e){o.push({frame:r.frame,notification:ie.createError(e)})}),(function(){o.push({frame:r.frame,notification:ie.createComplete()})}))}),c),u!==Number.POSITIVE_INFINITY&&this.schedule((function(){return i.unsubscribe()}),u),this.flushTests.push(a);var l=this.runMode;return{toBe:function(e,n,r){a.ready=!0,a.expected=t.parseMarbles(e,n,r,!0,l)}}},t.prototype.expectSubscriptions=function(e){var n={actual:e,ready:!1};this.flushTests.push(n);var r=this.runMode;return{toBe:function(e){var i="string"==typeof e?[e]:e;n.ready=!0,n.expected=i.map((function(e){return t.parseMarblesAsSubscriptions(e,r)}))}}},t.prototype.flush=function(){for(var t=this,n=this.hotObservables;n.length>0;)n.shift().setup();e.prototype.flush.call(this),this.flushTests=this.flushTests.filter((function(e){return!e.ready||(t.assertDeepEqual(e.actual,e.expected),!1)}))},t.parseMarblesAsSubscriptions=function(e,t){var n=this;if(void 0===t&&(t=!1),"string"!=typeof e)return new Ci(Number.POSITIVE_INFINITY);for(var r,i=e.length,o=-1,a=Number.POSITIVE_INFINITY,s=Number.POSITIVE_INFINITY,c=0,u=function(i){var u=c,d=function(e){u+=e*n.frameTimeFactor},h=e[i];switch(h){case" ":t||d(1);break;case"-":d(1);break;case"(":o=c,d(1);break;case")":o=-1,d(1);break;case"^":if(a!==Number.POSITIVE_INFINITY)throw new Error("found a second subscription point '^' in a subscription marble diagram. There can only be one.");a=o>-1?o:c,d(1);break;case"!":if(s!==Number.POSITIVE_INFINITY)throw new Error("found a second subscription point '^' in a subscription marble diagram. There can only be one.");s=o>-1?o:c;break;default:if(t&&h.match(/^[0-9]$/)&&(0===i||" "===e[i-1])){var f=e.slice(i).match(/^([0-9]+(?:\.[0-9]+)?)(ms|s|m) /);if(f){i+=f[0].length-1;var p=parseFloat(f[1]),A=void 0;switch(f[2]){case"ms":A=p;break;case"s":A=1e3*p;break;case"m":A=1e3*p*60}d(A/l.frameTimeFactor);break}}throw new Error("there can only be '^' and '!' markers in a subscription marble diagram. Found instead '"+h+"'.")}c=u,r=i},l=this,d=0;d<i;d++)u(d),d=r;return s<0?new Ci(a):new Ci(a,s)},t.parseMarbles=function(e,t,n,r,i){var o=this;if(void 0===r&&(r=!1),void 0===i&&(i=!1),-1!==e.indexOf("!"))throw new Error('conventional marble diagrams cannot have the unsubscription marker "!"');for(var a,s=e.length,c=[],u=i?e.replace(/^[ ]+/,"").indexOf("^"):e.indexOf("^"),l=-1===u?0:u*-this.frameTimeFactor,d="object"!=typeof t?function(e){return e}:function(e){return r&&t[e]instanceof Oi?t[e].messages:t[e]},h=-1,f=function(t){var r=l,s=function(e){r+=e*o.frameTimeFactor},u=void 0,f=e[t];switch(f){case" ":i||s(1);break;case"-":s(1);break;case"(":h=l,s(1);break;case")":h=-1,s(1);break;case"|":u=ie.createComplete(),s(1);break;case"^":s(1);break;case"#":u=ie.createError(n||"error"),s(1);break;default:if(i&&f.match(/^[0-9]$/)&&(0===t||" "===e[t-1])){var A=e.slice(t).match(/^([0-9]+(?:\.[0-9]+)?)(ms|s|m) /);if(A){t+=A[0].length-1;var g=parseFloat(A[1]),v=void 0;switch(A[2]){case"ms":v=g;break;case"s":v=1e3*g;break;case"m":v=1e3*g*60}s(v/p.frameTimeFactor);break}}u=ie.createNext(d(f)),s(1)}u&&c.push({frame:h>-1?h:l,notification:u}),l=r,a=t},p=this,A=0;A<s;A++)f(A),A=a;return c},t.prototype.run=function(e){var n=t.frameTimeFactor,r=this.maxFrames;t.frameTimeFactor=1,this.maxFrames=Number.POSITIVE_INFINITY,this.runMode=!0,z.delegate=this;var i={cold:this.createColdObservable.bind(this),hot:this.createHotObservable.bind(this),flush:this.flush.bind(this),expectObservable:this.expectObservable.bind(this),expectSubscriptions:this.expectSubscriptions.bind(this)};try{var o=e(i);return this.flush(),o}finally{t.frameTimeFactor=n,this.maxFrames=r,this.runMode=!1,z.delegate=void 0}},t}(Te),Mi=Object.freeze({TestScheduler:Bi}),Li="undefined"!=typeof window&&window,ki="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,Ui="undefined"!=typeof global&&global,Di=Li||Ui||ki;function Pi(e,t){return void 0===t&&(t=null),new zi({method:"GET",url:e,headers:t})}function Fi(e,t,n){return new zi({method:"POST",url:e,body:t,headers:n})}function Hi(e,t){return new zi({method:"DELETE",url:e,headers:t})}function ji(e,t,n){return new zi({method:"PUT",url:e,body:t,headers:n})}function Vi(e,t,n){return new zi({method:"PATCH",url:e,body:t,headers:n})}!function(){if(!Di)throw new Error("RxJS could not find any global context (window, self, global)")}();var Qi=Ne((function(e,t){return e.response}));function Gi(e,t){return Qi(new zi({method:"GET",url:e,responseType:"json",headers:t}))}var zi=function(e){function t(t){var n=e.call(this)||this,r={async:!0,createXHR:function(){return this.crossDomain?function(){if(Di.XMLHttpRequest)return new Di.XMLHttpRequest;if(Di.XDomainRequest)return new Di.XDomainRequest;throw new Error("CORS is not supported by your browser")}():function(){if(Di.XMLHttpRequest)return new Di.XMLHttpRequest;var e=void 0;try{for(var t=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],n=0;n<3;n++)try{if(e=t[n],new Di.ActiveXObject(e))break}catch(e){}return new Di.ActiveXObject(e)}catch(e){throw new Error("XMLHttpRequest is not supported by your browser")}}()},crossDomain:!0,withCredentials:!1,headers:{},method:"GET",responseType:"json",timeout:0};if("string"==typeof t)r.url=t;else for(var i in t)t.hasOwnProperty(i)&&(r[i]=t[i]);return n.request=r,n}var r;return n(t,e),t.prototype._subscribe=function(e){return new Ki(e,this.request)},t.create=((r=function(e){return new t(e)}).get=Pi,r.post=Fi,r.delete=Hi,r.put=ji,r.patch=Vi,r.getJSON=Gi,r),t}(_),Ki=function(e){function t(t,n){var r=e.call(this,t)||this;r.request=n,r.done=!1;var i=n.headers=n.headers||{};return n.crossDomain||r.getHeader(i,"X-Requested-With")||(i["X-Requested-With"]="XMLHttpRequest"),r.getHeader(i,"Content-Type")||Di.FormData&&n.body instanceof Di.FormData||void 0===n.body||(i["Content-Type"]="application/x-www-form-urlencoded; charset=UTF-8"),n.body=r.serializeBody(n.body,r.getHeader(n.headers,"Content-Type")),r.send(),r}return n(t,e),t.prototype.next=function(e){this.done=!0;var t,n=this,r=n.xhr,i=n.request,o=n.destination;try{t=new qi(e,r,i)}catch(e){return o.error(e)}o.next(t)},t.prototype.send=function(){var e=this.request,t=this.request,n=t.user,r=t.method,i=t.url,o=t.async,a=t.password,s=t.headers,c=t.body;try{var u=this.xhr=e.createXHR();this.setupEvents(u,e),n?u.open(r,i,o,n,a):u.open(r,i,o),o&&(u.timeout=e.timeout,u.responseType=e.responseType),"withCredentials"in u&&(u.withCredentials=!!e.withCredentials),this.setHeaders(u,s),c?u.send(c):u.send()}catch(e){this.error(e)}},t.prototype.serializeBody=function(e,t){if(!e||"string"==typeof e)return e;if(Di.FormData&&e instanceof Di.FormData)return e;if(t){var n=t.indexOf(";");-1!==n&&(t=t.substring(0,n))}switch(t){case"application/x-www-form-urlencoded":return Object.keys(e).map((function(t){return encodeURIComponent(t)+"="+encodeURIComponent(e[t])})).join("&");case"application/json":return JSON.stringify(e);default:return e}},t.prototype.setHeaders=function(e,t){for(var n in t)t.hasOwnProperty(n)&&e.setRequestHeader(n,t[n])},t.prototype.getHeader=function(e,t){for(var n in e)if(n.toLowerCase()===t.toLowerCase())return e[n]},t.prototype.setupEvents=function(e,t){var n=t.progressSubscriber;function r(e){var t,n=r,i=n.subscriber,o=n.progressSubscriber,a=n.request;o&&o.error(e);try{t=new Ji(this,a)}catch(e){t=e}i.error(t)}if(e.ontimeout=r,r.request=t,r.subscriber=this,r.progressSubscriber=n,e.upload&&"withCredentials"in e){var i,o;if(n)i=function(e){i.progressSubscriber.next(e)},Di.XDomainRequest?e.onprogress=i:e.upload.onprogress=i,i.progressSubscriber=n;o=function(e){var t,n=o,r=n.progressSubscriber,i=n.subscriber,a=n.request;r&&r.error(e);try{t=new Wi("ajax error",this,a)}catch(e){t=e}i.error(t)},e.onerror=o,o.request=t,o.subscriber=this,o.progressSubscriber=n}function a(e){}function s(e){var t=s,n=t.subscriber,r=t.progressSubscriber,i=t.request;if(4===this.readyState){var o=1223===this.status?204:this.status,a="text"===this.responseType?this.response||this.responseText:this.response;if(0===o&&(o=a?200:0),o<400)r&&r.complete(),n.next(e),n.complete();else{r&&r.error(e);var c=void 0;try{c=new Wi("ajax error "+o,this,i)}catch(e){c=e}n.error(c)}}}e.onreadystatechange=a,a.subscriber=this,a.progressSubscriber=n,a.request=t,e.onload=s,s.subscriber=this,s.progressSubscriber=n,s.request=t},t.prototype.unsubscribe=function(){var t=this.done,n=this.xhr;!t&&n&&4!==n.readyState&&"function"==typeof n.abort&&n.abort(),e.prototype.unsubscribe.call(this)},t}(A),qi=function(e,t,n){this.originalEvent=e,this.xhr=t,this.request=n,this.status=t.status,this.responseType=t.responseType||n.responseType,this.response=Xi(this.responseType,t)},Wi=function(){function e(e,t,n){return Error.call(this),this.message=e,this.name="AjaxError",this.xhr=t,this.request=n,this.status=t.status,this.responseType=t.responseType||n.responseType,this.response=Xi(this.responseType,t),this}return e.prototype=Object.create(Error.prototype),e}();function Xi(e,t){switch(e){case"json":return function(e){return"response"in e?e.responseType?e.response:JSON.parse(e.response||e.responseText||"null"):JSON.parse(e.responseText||"null")}(t);case"xml":return t.responseXML;case"text":default:return"response"in t?t.response:t.responseText}}var Ji=function(e,t){return Wi.call(this,"ajax timeout",e,t),this.name="AjaxTimeoutError",this},Yi=zi.create,Zi=Object.freeze({ajax:Yi,AjaxResponse:qi,AjaxError:Wi,AjaxTimeoutError:Ji}),$i={url:"",deserializer:function(e){return JSON.parse(e.data)},serializer:function(e){return JSON.stringify(e)}},eo=function(e){function t(t,n){var i=e.call(this)||this;if(t instanceof _)i.destination=n,i.source=t;else{var o=i._config=r({},$i);if(i._output=new C,"string"==typeof t)o.url=t;else for(var a in t)t.hasOwnProperty(a)&&(o[a]=t[a]);if(!o.WebSocketCtor&&WebSocket)o.WebSocketCtor=WebSocket;else if(!o.WebSocketCtor)throw new Error("no WebSocket constructor can be found");i.destination=new ce}return i}return n(t,e),t.prototype.lift=function(e){var n=new t(this._config,this.destination);return n.operator=e,n.source=this,n},t.prototype._resetState=function(){this._socket=null,this.source||(this.destination=new ce),this._output=new C},t.prototype.multiplex=function(e,t,n){var r=this;return new _((function(i){try{r.next(e())}catch(e){i.error(e)}var o=r.subscribe((function(e){try{n(e)&&i.next(e)}catch(e){i.error(e)}}),(function(e){return i.error(e)}),(function(){return i.complete()}));return function(){try{r.next(t())}catch(e){i.error(e)}o.unsubscribe()}}))},t.prototype._connectSocket=function(){var e=this,t=this._config,n=t.WebSocketCtor,r=t.protocol,i=t.url,o=t.binaryType,a=this._output,s=null;try{s=r?new n(i,r):new n(i),this._socket=s,o&&(this._socket.binaryType=o)}catch(e){return void a.error(e)}var c=new h((function(){e._socket=null,s&&1===s.readyState&&s.close()}));s.onopen=function(t){if(!e._socket)return s.close(),void e._resetState();var n=e._config.openObserver;n&&n.next(t);var r=e.destination;e.destination=A.create((function(t){if(1===s.readyState)try{var n=e._config.serializer;s.send(n(t))}catch(t){e.destination.error(t)}}),(function(t){var n=e._config.closingObserver;n&&n.next(void 0),t&&t.code?s.close(t.code,t.reason):a.error(new TypeError("WebSocketSubject.error must be called with an object with an error code, and an optional reason: { code: number, reason: string }")),e._resetState()}),(function(){var t=e._config.closingObserver;t&&t.next(void 0),s.close(),e._resetState()})),r&&r instanceof ce&&c.add(r.subscribe(e.destination))},s.onerror=function(t){e._resetState(),a.error(t)},s.onclose=function(t){e._resetState();var n=e._config.closeObserver;n&&n.next(t),t.wasClean?a.complete():a.error(t)},s.onmessage=function(t){try{var n=e._config.deserializer;a.next(n(t))}catch(e){a.error(e)}}},t.prototype._subscribe=function(e){var t=this,n=this.source;return n?n.subscribe(e):(this._socket||this._connectSocket(),this._output.subscribe(e),e.add((function(){var e=t._socket;0===t._output.observers.length&&(e&&1===e.readyState&&e.close(),t._resetState())})),e)},t.prototype.unsubscribe=function(){var t=this._socket;t&&1===t.readyState&&t.close(),this._resetState(),e.prototype.unsubscribe.call(this)},t}(I);var to=Ri,no=Mi,ro=Zi,io=Object.freeze({webSocket:function(e){return new eo(e)},WebSocketSubject:eo}),oo=Object.freeze({fromFetch:function(e,t){void 0===t&&(t={});var n=t.selector,i=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&(n[r[i]]=e[r[i]])}return n}(t,["selector"]);return new _((function(t){var o,a=new AbortController,s=a.signal,c=!0,u=!1,l=new h;if(l.add((function(){u=!0,c&&a.abort()})),i){if(i.signal)if(i.signal.aborted)a.abort();else{var d=i.signal,f=function(){s.aborted||a.abort()};d.addEventListener("abort",f),l.add((function(){return d.removeEventListener("abort",f)}))}o=r({},i,{signal:s})}else o={signal:s};return fetch(e,o).then((function(e){n?l.add(Je(n(e)).subscribe((function(e){return t.next(e)}),(function(e){c=!1,u||t.error(e)}),(function(){c=!1,t.complete()}))):(c=!1,t.next(e),t.complete())})).catch((function(e){c=!1,u||t.error(e)})),l}))}});e.operators=to,e.testing=no,e.ajax=ro,e.webSocket=io,e.fetch=oo,e.Observable=_,e.ConnectableObservable=M,e.GroupedObservable=F,e.observable=m,e.Subject=C,e.BehaviorSubject=j,e.ReplaySubject=ce,e.AsyncSubject=le,e.asap=ye,e.asapScheduler=me,e.async=Ee,e.asyncScheduler=be,e.queue=q,e.queueScheduler=K,e.animationFrame=Se,e.animationFrameScheduler=we,e.VirtualTimeScheduler=Te,e.VirtualAction=Re,e.Scheduler=G,e.Subscription=h,e.Subscriber=A,e.Notification=ie,e.pipe=b,e.noop=Ce,e.identity=y,e.isObservable=function(e){return!!e&&(e instanceof _||"function"==typeof e.lift&&"function"==typeof e.subscribe)},e.ArgumentOutOfRangeError=Ie,e.EmptyError=xe,e.ObjectUnsubscribedError=S,e.UnsubscriptionError=d,e.TimeoutError=Oe,e.bindCallback=function e(t,n,r){if(n){if(!J(n))return function(){for(var i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];return e(t,r).apply(void 0,i).pipe(Ne((function(e){return u(e)?n.apply(void 0,e):n(e)})))};r=n}return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var i,o=this,a={context:o,subject:i,callbackFunc:t,scheduler:r};return new _((function(n){if(r){var s={args:e,subscriber:n,params:a};return r.schedule(Le,0,s)}if(!i){i=new le;try{t.apply(o,e.concat([function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];i.next(e.length<=1?e[0]:e),i.complete()}]))}catch(e){v(i)?i.error(e):console.warn(e)}}return i.subscribe(n)}))}},e.bindNodeCallback=function e(t,n,r){if(n){if(!J(n))return function(){for(var i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];return e(t,r).apply(void 0,i).pipe(Ne((function(e){return u(e)?n.apply(void 0,e):n(e)})))};r=n}return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var i={subject:void 0,args:e,callbackFunc:t,scheduler:r,context:this};return new _((function(n){var o=i.context,a=i.subject;if(r)return r.schedule(Ue,0,{params:i,subscriber:n,context:o});if(!a){a=i.subject=new le;try{t.apply(o,e.concat([function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=e.shift();n?a.error(n):(a.next(e.length<=1?e[0]:e),a.complete())}]))}catch(e){v(a)?a.error(e):console.warn(e)}}return a.subscribe(n)}))}},e.combineLatest=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=void 0,r=void 0;return J(e[e.length-1])&&(r=e.pop()),"function"==typeof e[e.length-1]&&(n=e.pop()),1===e.length&&u(e[0])&&(e=e[0]),ee(e,r).lift(new qe(n))},e.concat=at,e.defer=st,e.empty=X,e.forkJoin=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(1===e.length){var n=e[0];if(u(n))return ct(n,null);if(l(n)&&Object.getPrototypeOf(n)===Object.prototype){var r=Object.keys(n);return ct(r.map((function(e){return n[e]})),r)}}if("function"==typeof e[e.length-1]){var i=e.pop();return ct(e=1===e.length&&u(e[0])?e[0]:e,null).pipe(Ne((function(e){return i.apply(void 0,e)})))}return ct(e,null)},e.from=Je,e.fromEvent=function e(t,n,r,o){return i(r)&&(o=r,r=void 0),o?e(t,n,r).pipe(Ne((function(e){return u(e)?o.apply(void 0,e):o(e)}))):new _((function(e){ut(t,n,(function(t){arguments.length>1?e.next(Array.prototype.slice.call(arguments)):e.next(t)}),e,r)}))},e.fromEventPattern=function e(t,n,r){return r?e(t,n).pipe(Ne((function(e){return u(e)?r.apply(void 0,e):r(e)}))):new _((function(e){var r,o=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return e.next(1===t.length?t[0]:t)};try{r=t(o)}catch(t){return void e.error(t)}if(i(n))return function(){return n(o,r)}}))},e.generate=function(e,t,n,r,i){var o,a;if(1==arguments.length){var s=e;a=s.initialState,t=s.condition,n=s.iterate,o=s.resultSelector||y,i=s.scheduler}else void 0===r||J(r)?(a=e,o=y,i=r):(a=e,o=r);return new _((function(e){var r=a;if(i)return i.schedule(lt,0,{subscriber:e,iterate:n,condition:t,resultSelector:o,state:r});for(;;){if(t){var s=void 0;try{s=t(r)}catch(t){return void e.error(t)}if(!s){e.complete();break}}var c=void 0;try{c=o(r)}catch(t){return void e.error(t)}if(e.next(c),e.closed)break;try{r=n(r)}catch(t){return void e.error(t)}}}))},e.iif=function(e,t,n){return void 0===t&&(t=W),void 0===n&&(n=W),st((function(){return e()?t:n}))},e.interval=function(e,t){return void 0===e&&(e=0),void 0===t&&(t=Ee),(!dt(e)||e<0)&&(e=0),t&&"function"==typeof t.schedule||(t=Ee),new _((function(n){return n.add(t.schedule(ht,e,{subscriber:n,counter:0,period:e})),n}))},e.merge=ft,e.never=function(){return pt},e.of=te,e.onErrorResumeNext=function e(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];if(0===t.length)return W;var r=t[0],i=t.slice(1);return 1===t.length&&u(r)?e.apply(void 0,r):new _((function(t){var n=function(){return t.add(e.apply(void 0,i).subscribe(t))};return Je(r).subscribe({next:function(e){t.next(e)},error:n,complete:n})}))},e.pairs=function(e,t){return new _(t?function(n){var r=Object.keys(e),i=new h;return i.add(t.schedule(At,0,{keys:r,index:0,subscriber:n,subscription:i,obj:e})),i}:function(t){for(var n=Object.keys(e),r=0;r<n.length&&!t.closed;r++){var i=n[r];e.hasOwnProperty(i)&&t.next([i,e[i]])}t.complete()})},e.partition=function(e,t,n){return[vt(t,n)(new _(Ge(e))),vt(gt(t,n))(new _(Ge(e)))]},e.race=bt,e.range=function(e,t,n){return void 0===e&&(e=0),new _((function(r){void 0===t&&(t=e,e=0);var i=0,o=e;if(n)return n.schedule(wt,0,{index:i,count:t,start:e,subscriber:r});for(;;){if(i++>=t){r.complete();break}if(r.next(o++),r.closed)break}}))},e.throwError=ne,e.timer=St,e.using=function(e,t){return new _((function(n){var r,i;try{r=e()}catch(e){return void n.error(e)}try{i=t(r)}catch(e){return void n.error(e)}var o=(i?Je(i):W).subscribe(n);return function(){o.unsubscribe(),r&&r.unsubscribe()}}))},e.zip=Rt,e.scheduled=Xe,e.EMPTY=W,e.NEVER=pt,e.config=a,Object.defineProperty(e,"__esModule",{value:!0})}));
/**
 * @license rxcomp v1.0.0-beta.20
 * (c) 2020 Luca Zampetti <lzampetti@gmail.com>
 * License: MIT
 */
var rxcomp=function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}function o(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}function a(e){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function c(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function u(e,t,n){return(u=c()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var i=new(Function.bind.apply(e,r));return n&&s(i,n.prototype),i}).apply(null,arguments)}function l(e){var t="function"==typeof Map?new Map:void 0;return(l=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return u(e,arguments,a(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),s(r,e)})(e)}var d={},h={},f=function(){function e(){this.rxcompId=-1,this.unsubscribe$=new t.Subject,this.changes$=new t.ReplaySubject(1)}var n=e.prototype;return n.onInit=function(){},n.onChanges=function(e){},n.onView=function(){},n.onDestroy=function(){},n.pushChanges=function(){p(this).module.instances&&(this.changes$.next(this),this.onView())},n.onParentDidChange=function(e){p(this).module.resolveInputsOutputs(this,e),this.onChanges(e),this.pushChanges()},e.getInputsTokens=function(e,t,n){var r,i={};return null==(r=this.meta.inputs)||r.forEach((function(e){var r=n.resolveAttribute(e,t);r&&(i[e]=r)})),i},e}();function p(e){return d[e.rxcompId]}var A=function(e){function t(){return e.apply(this,arguments)||this}return o(t,e),t}(f),g=function(e){function t(){var t;return(t=e.apply(this,arguments)||this).class="",t.keys=[],t}o(t,e);var n=t.prototype;return n.onInit=function(){var e=this,t=p(this).node;Array.prototype.slice.call(t.classList).forEach((function(t){e.keys.push(t)}))},n.onChanges=function(){var e=p(this).node,t=[],n=this.class;if("object"==typeof n)for(var r in n)n[r]&&t.push(r);else"string"==typeof n&&(t=n.split(/\s+/));t=t.concat(this.keys),e.setAttribute("class",t.join(" "))},t}(A);g.meta={selector:"[[class]]",inputs:["class"]};var v=function(e){function t(){return e.apply(this,arguments)||this}return o(t,e),t}(l(Error)),m=function(e){function t(t,n,r,i,o){var a,s="ExpressionError in "+r.constructor.name+' "'+i+'"\n\t\t'+t.message;(a=e.call(this,s)||this).name=t.name,a.module=n,a.instance=r,a.expression=i,a.params=o;var c=p(r).node;return a.template=c.outerHTML,a}return o(t,e),t}(l(Error)),y=function(){function e(e,t){this.next=e,this.interceptor=t}return e.prototype.handle=function(e){return this.interceptor.intercept(e,this.next)},e}(),b=function(){function e(){}return e.prototype.handle=function(e){return t.of(e)},e}(),E=[],_=new t.ReplaySubject(1),w=_.pipe(n.switchMap((function(e){return E.reduceRight((function(e,t){return new y(e,t)}),new b).handle(e)})),n.tap((function(e){e&&console.error(e)}))),S=function(e){function r(){var t;return(t=e.apply(this,arguments)||this).event="",t}return o(r,e),r.prototype.onInit=function(){var e=p(this),r=e.module,i=e.node,o=e.parentInstance,a=e.selector,s=this.event=a.replace(/\[|\]|\(|\)/g,""),c=t.fromEvent(i,s).pipe(n.shareReplay(1)),u=i.getAttribute("("+s+")");if(u){var l=r.makeFunction(u,["$event"]);c.pipe(n.takeUntil(this.unsubscribe$)).subscribe((function(e){r.resolve(l,o,e)}))}else o[s+"$"]=c},r}(A);S.meta={selector:"[("+["mousedown","mouseup","mousemove","click","dblclick","mouseover","mouseout","mouseenter","mouseleave","contextmenu","touchstart","touchmove","touchend","keydown","keyup","input","change","loaded"].join(")],[(")+")]"};var T=function(e){function t(){return e.apply(this,arguments)||this}return o(t,e),t}(f),R=function(e){function t(){return e.apply(this,arguments)||this}return o(t,e),t.prototype.pushChanges=function(){var e=p(this),t=e.module,n=e.node;t.instances&&(this.changes$.next(this),t.parse(n,this),this.onView())},t}(f),C=["constructor","rxcompId","onInit","onChanges","onDestroy","pushChanges","changes$","unsubscribe$"],I=function(e){function t(n,r){var i;return void 0===r&&(r={}),i=e.call(this)||this,r=t.mergeDescriptors(n,n,r),r=t.mergeDescriptors(Object.getPrototypeOf(n),n,r),Object.defineProperties(function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(i),r),i}o(t,e);var n=t.prototype;return n.pushChanges=function(){var t=this,n=p(this);n.keys||(n.keys=Object.keys(n.parentInstance).filter((function(e){return-1===C.indexOf(e)}))),n.module.instances&&n.keys.forEach((function(e){t[e]=n.parentInstance[e]})),e.prototype.pushChanges.call(this)},n.onParentDidChange=function(e){this.onChanges(e),this.pushChanges()},t.mergeDescriptors=function(e,t,n){void 0===n&&(n={});for(var r=Object.getOwnPropertyNames(e),i=function(){var i=r.shift();if(-1===C.indexOf(i)&&!n.hasOwnProperty(i)){var o=Object.getOwnPropertyDescriptor(e,i);"function"==typeof o.value&&(o.value=function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return t[i].apply(t,n)}),n[i]=o}};r.length;)i();return n},t}(R),x=function(e){function t(t,n,r,i,o,a,s){var c;return(c=e.call(this,s)||this)[t]=n,c[r]=i,c.index=o,c.count=a,c}return o(t,e),i(t,[{key:"first",get:function(){return 0===this.index}},{key:"last",get:function(){return this.index===this.count-1}},{key:"even",get:function(){return this.index%2==0}},{key:"odd",get:function(){return!this.even}}]),t}(I),O=function(e){function t(){var t;return(t=e.apply(this,arguments)||this).instances=[],t}o(t,e);var n=t.prototype;return n.onInit=function(){var e=p(this).node,t=this.forbegin=document.createComment("*for begin");t.rxcompId=e.rxcompId,e.parentNode.replaceChild(t,e);var n=this.forend=document.createComment("*for end");t.parentNode.insertBefore(n,t.nextSibling),e.removeAttribute("*for")},n.onChanges=function(){for(var e=p(this),t=e.module,n=e.node,r=this.tokens,i=this.for||[],o=Array.isArray(i),a=o?i:Object.keys(i),s=a.length,c=this.instances.length,u=0;u<Math.max(c,s);u++)if(u<s){var l=o?u:a[u],d=o?a[l]:i[l];if(u<c){var h=this.instances[u];h[r.key]=l,h[r.value]=d}else{var f=n.cloneNode(!0);delete f.rxcompId,this.forend.parentNode.insertBefore(f,this.forend);var A=[r.key,l,r.value,d,u,s,e.parentInstance],g=t.makeInstance(f,x,e.selector,e.parentInstance,A,void 0,!0);g&&(t.compile(f,g),t.makeInstanceSubscription(g,e.parentInstance),this.instances.push(g))}}else{var v=p(this.instances[u]).node;v.parentNode.removeChild(v),t.remove(v)}this.instances.length=a.length},t.getInputsTokens=function(e,n,r){var i={},o=n.getAttribute("*for");if(o){var a=t.getForExpressionTokens(o);e.tokens=a,i.for=a.iterable}return i},t.getForExpressionTokens=function(e){if(null===e)throw new Error("invalid for");if(-1===e.trim().indexOf("let ")||-1===e.trim().indexOf(" of "))throw new Error("invalid for");var t=e.split(";").map((function(e){return e.trim()})).filter((function(e){return""!==e})),n=t[0].split(" of ").map((function(e){return e.trim()})),r=n[0].replace(/\s*let\s*/,""),i=n[1],o="index",a=r.match(/\[(.+)\s*,\s*(.+)\]/);if(a&&(o=a[1],r=a[2]),t.length>1){var s=t[1].split(/\s*let\s*|\s*=\s*index/).map((function(e){return e.trim()}));3===s.length&&(o=s[1])}return{key:o,value:r,iterable:i}},t}(T);O.meta={selector:"[*for]",inputs:["for"]};var N=function(e){function t(){return e.apply(this,arguments)||this}return o(t,e),i(t,[{key:"target",set:function(e){if(this.target_!==e){this.target_=e;var t=p(this).node;e?t.setAttribute("target",e):t.removeAttribute("target")}},get:function(){return this.target_}}]),t}(A);N.meta={selector:"[[target]]",inputs:["target"]};var B=function(e){function t(){return e.apply(this,arguments)||this}return o(t,e),i(t,[{key:"href",set:function(e){if(this.href_!==e){this.href_=e;var t=p(this).node;e?t.setAttribute("href",e):t.removeAttribute("href")}},get:function(){return this.href_}}]),t}(A);B.meta={selector:"[[href]]",inputs:["href"]};var M=function(e){function t(){return e.apply(this,arguments)||this}o(t,e);var n=t.prototype;return n.onInit=function(){var e=p(this).node,t=this.ifbegin=document.createComment("*if begin");t.rxcompId=e.rxcompId,e.parentNode.replaceChild(t,e);var n=this.ifend=document.createComment("*if end");t.parentNode.insertBefore(n,t.nextSibling);var r=e.cloneNode(!0);r.removeAttribute("*if"),this.clonedNode=r,this.element=r.cloneNode(!0)},n.onChanges=function(){var e=p(this).module,t=this.element;if(Boolean(this.if)){if(!t.parentNode){var n=this.ifend;n.parentNode.insertBefore(t,n),e.compile(t)}}else t.parentNode&&(e.remove(t,this),t.parentNode.removeChild(t),this.element=this.clonedNode.cloneNode(!0))},t}(T);M.meta={selector:"[*if]",inputs:["if"]};var L=function(e){function t(){return e.apply(this,arguments)||this}return o(t,e),i(t,[{key:"innerHTML",set:function(e){this.innerHTML_!==e&&(this.innerHTML_=e,p(this).node.innerHTML=null==e?"":e)},get:function(){return this.innerHTML_}}]),t}(A);L.meta={selector:"[innerHTML]",inputs:["innerHTML"]};var k=function(e){function t(){var t;return(t=e.apply(this,arguments)||this).active=!1,t}return o(t,e),t.prototype.onToggle=function(){this.active=!this.active,this.pushChanges()},t}(R);k.meta={selector:"json-component",inputs:["item"],template:'\n\t\t<div class="rxc-block">\n\t\t\t<div class="rxc-head">\n\t\t\t\t<span class="rxc-head__title" (click)="onToggle()">\n\t\t\t\t\t<span *if="!active">+ json </span>\n\t\t\t\t\t<span *if="active">- json </span>\n\t\t\t\t\t<span [innerHTML]="item"></span>\n\t\t\t\t</span>\n\t\t\t</div>\n\t\t\t<ul class="rxc-list" *if="active">\n\t\t\t\t<li class="rxc-list__item">\n\t\t\t\t\t<span class="rxc-list__value" [innerHTML]="item | json"></span>\n\t\t\t\t</li>\n\t\t\t</ul>\n\t\t</div>'};var U=function(){function e(){}return e.transform=function(e){return e},e}(),D=[T,R,A],P=function(){function e(){}return e.bootstrap=function(e){if(!e)throw new v("missing moduleFactory");if(!e.meta)throw new v("missing moduleFactory meta");if(!e.meta.bootstrap)throw new v("missing bootstrap");if(!e.meta.bootstrap.meta)throw new v("missing bootstrap meta");if(!e.meta.bootstrap.meta.selector)throw new v("missing bootstrap meta selector");var t=this.resolveMeta(e),n=new e;return n.meta=t,t.imports.forEach((function(e){e.prototype.constructor.call(n)})),n},e.querySelector=function(e){return document.querySelector(e)},e.resolveMeta=function(e){var t=this.resolveImportedMeta(e),n=e.meta.bootstrap,r=this.querySelector(n.meta.selector);if(!r)throw new v("missing node "+n.meta.selector);var i=r.innerHTML,o=this.resolvePipes(t),a=this.resolveFactories(t);return this.sortFactories(a),a.unshift(n),{factories:a,pipes:o,selectors:this.unwrapSelectors(a),bootstrap:n,node:r,nodeInnerHTML:i,imports:e.meta.imports||[]}},e.resolveImportedMeta=function(e){var t=this,n=Object.assign({imports:[],declarations:[],pipes:[],exports:[]},e.meta);return n.imports=(e.meta.imports||[]).map((function(e){return t.resolveImportedMeta(e)})),n},e.resolvePipes=function(e,t){var n=this,r=e.imports.map((function(e){return n.resolvePipes(e,!0)})),i={};return(t?e.exports:e.declarations).filter((function(e){return e.prototype instanceof U})).forEach((function(e){return i[e.meta.name]=e})),Object.assign.apply(Object,[{}].concat(r,[i]))},e.resolveFactories=function(e,t){var n,r=this,i=e.imports.map((function(e){return r.resolveFactories(e,!0)})),o=(t?e.exports:e.declarations).filter((function(e){return e.prototype instanceof f}));return(n=Array.prototype.concat).call.apply(n,[o].concat(i))},e.sortFactories=function(e){e.sort((function(e,t){var n=D.reduce((function(t,n,r){return e.prototype instanceof n?r:t}),-1)-D.reduce((function(e,n,r){return t.prototype instanceof n?r:e}),-1);return 0===n?(e.meta.hosts?1:0)-(t.meta.hosts?1:0):n}))},e.getExpressions=function(e){var t=[];return e.replace(/\.([\w\-\_]+)|\[(.+?\]*)(\=)(.*?)\]|\[(.+?\]*)\]|([\w\-\_]+)/g,(function(e,n,r,i,o,a,s){return n&&t.push((function(e){return e.classList.contains(n)})),r&&t.push((function(e){return e.hasAttribute(r)&&e.getAttribute(r)===o||e.hasAttribute("["+r+"]")&&e.getAttribute("["+r+"]")===o})),a&&t.push((function(e){return e.hasAttribute(a)||e.hasAttribute("["+a+"]")})),s&&t.push((function(e){return e.nodeName.toLowerCase()===s.toLowerCase()})),""})),t},e.unwrapSelectors=function(e){var t=this,n=[];return e.forEach((function(e){e.meta&&e.meta.selector&&e.meta.selector.split(",").forEach((function(r){r=r.trim();var i=[],o=r.replace(/\:not\((.+?)\)/g,(function(e,n){return i=t.getExpressions(n),""})),a=t.getExpressions(o);n.push((function(t){var n=a.reduce((function(e,n){return e&&n(t)}),!0),o=i.reduce((function(e,n){return e||n(t)}),!1);return!(!n||o)&&{node:t,factory:e,selector:r}}))}))})),n},e}(),F="undefined"!=typeof window&&void 0!==window.document,H="undefined"!=typeof window&&"nodejs"===window.name||"undefined"!=typeof navigator&&-1!==navigator.userAgent.indexOf("Node.js")||"undefined"!=typeof navigator&&-1!==navigator.userAgent.indexOf("jsdom"),j="undefined"!=typeof process&&null!=process.versions&&null!=process.versions.node,V="object"==typeof self&&self.constructor&&"DedicatedWorkerGlobalScope"===self.constructor.name,Q=j,G=!j&&F,z=V,K=function(){function e(){}return e.encode=function(e,t){return void 0===t&&(t=[q]),t.reduce((function(e,t){return t(e)}),e)},e.decode=function(e,t){return void 0===t&&(t=[X]),t.reduce((function(e,t){return t(e)}),e)},e.encodeJson=function(e){return this.encode(e,[q])},e.decodeJson=function(e){return this.decode(e,[X])},e.encodeBase64=function(e){return this.encode(e,[q,J])},e.decodeBase64=function(e){return this.decode(e,[Y,X])},e}();function q(e,t,n){var r;try{var i=[];r=JSON.stringify(e,(function(e,n){if("object"==typeof n&&null!=n){if(-1!==i.indexOf(n))return t;i.push(n)}return n}),n)}catch(e){}return r}function W(e,t){return function(n){return q(n,e,t)}}function X(e){var t;if(e)try{t=JSON.parse(e)}catch(e){}return t}function J(e){var t;try{t=G?btoa(e):Buffer.from(e).toString("base64")}catch(n){t=e}return t}function Y(e){var t;try{t=G?atob(e):Buffer.from(e,"base64").toString()}catch(n){t=e}return t}var Z=function(e){function t(){return e.apply(this,arguments)||this}return o(t,e),t.transform=function(e){return K.encode(e,[W("#ref",2)])},t}(U);Z.meta={name:"json"};var $="object"==typeof self&&self.self===self&&self||"object"==typeof global&&global.global===global&&global||void 0,ee=0,te=function(){function e(){this.unsubscribe$=new t.Subject}var r=e.prototype;return r.compile=function(t,n){var r,i=this;return e.querySelectorsAll(t,this.meta.selectors,[]).map((function(e){r&&r!==e.node&&(n=void 0);var t=i.makeInstance(e.node,e.factory,e.selector,n);return e.factory.prototype instanceof R&&(r=e.node),t})).filter((function(e){return void 0!==e}))},r.makeInstance=function(t,n,r,i,o,a,s){if(void 0===s&&(s=!1),i||t.parentNode){var c=n.meta;if(!(i=i||this.getParentInstance(t.parentNode)))return;var l=u(n,o||[]);a&&Object.keys(a).forEach((function(e){Object.defineProperty(l,e,{value:a[e],configurable:!1,enumerable:!1,writable:!0})}));var d=e.makeContext(this,l,i,t,n,r);return l instanceof I||(this.makeHosts(c,l,t),d.inputs=this.makeInputs(c,l,t,n),d.outputs=this.makeOutputs(c,l),this.resolveInputsOutputs(l,i)),l.onInit(),s||this.makeInstanceSubscription(l,i),l}},r.makeInstanceSubscription=function(e,t){t instanceof f&&t.changes$.pipe(n.takeUntil(e.unsubscribe$)).subscribe((function(t){e.onParentDidChange(t)}))},r.makeFunction=function(t,n){void 0===n&&(n=["$instance"]),t=e.parseExpression(t);var r="with(this) {\n\treturn (function ("+n.join(",")+", $$module) {\n\t\ttry {\n\t\t\tconst $$pipes = $$module.meta.pipes;\n\t\t\treturn "+t+";\n\t\t} catch(error) {\n\t\t\t$$module.nextError(error, this, "+JSON.stringify(t)+", arguments);\n\t\t}\n\t}.bind(this)).apply(this, arguments);\n}",i=new Function(r);return i.expression=t,i},r.resolveInputsOutputs=function(e,t){var n=p(e),r=n.parentInstance,i=n.inputs;for(var o in i){var a=i[o],s=this.resolve(a,r,e);e[o]=s}},r.resolveAttribute=function(e,t){var n=null;if(t.hasAttribute("["+e+"]"))n=t.getAttribute("["+e+"]");else if(t.hasAttribute("*"+e))n=t.getAttribute("*"+e);else if(t.hasAttribute(e)&&(n=t.getAttribute(e))){var r=n.replace(/({{)|(}})|(")/g,(function(e,t,n,r){return t?'"+':n?'+"':r?'"':""}));n='"'+r+'"'}return n},r.resolve=function(e,t,n){return e.apply(t,[n,this])},r.parse=function(e,t){for(var n=0;n<e.childNodes.length;n++){var r=e.childNodes[n];if(1===r.nodeType){var i=r;ne(i)||this.parse(i,t)}else if(3===r.nodeType){var o=r;this.parseTextNode(o,t)}}},r.remove=function(t,n){var r=n?p(n):void 0;return e.traverseDown(t,(function(t){var n=t.rxcompId;n&&(0===e.deleteContext(n,r).length&&delete t.rxcompId)})),t},r.destroy=function(){this.unsubscribe$.next(),this.unsubscribe$.complete(),this.remove(this.meta.node),this.meta.node.innerHTML=this.meta.nodeInnerHTML},r.nextError=function(e,t,n,r){var i=new m(e,this,t,n,r);_.next(i)},r.makeContext=function(t,n,r,i){return e.makeContext(this,t,n,r,t.constructor,i)},r.makeHosts=function(e,t,n){e.hosts&&Object.keys(e.hosts).forEach((function(r){var i=e.hosts[r];t[r]=ie(t,i,n)}))},r.makeInputs=function(e,t,n,r){var i=this,o={},a=r.getInputsTokens(t,n,this);return Object.keys(a).forEach((function(e){o[e]=i.makeFunction(a[e])})),o},r.makeOutput=function(e,r){var i=this,o=p(e),a=o.node,s=o.parentInstance,c=a.getAttribute("("+r+")"),u=c?this.makeFunction(c,["$event"]):null,l=(new t.Subject).pipe(n.tap((function(e){u&&i.resolve(u,s,e)})));return l.pipe(n.takeUntil(e.unsubscribe$)).subscribe(),e[r]=l,l},r.makeOutputs=function(e,t){var n=this,r={};return e.outputs&&e.outputs.forEach((function(e){var i=n.makeOutput(t,e);i&&(r[e]=i)})),r},r.getInstance=function(e){if(e===document)return $;var t=re(e);return t?t.instance:void 0},r.getParentInstance=function(t){var n=this;return e.traverseUp(t,(function(e){return n.getInstance(e)}))},r.parseTextNode=function(e,t){var n=this,r=e.nodeExpressions;if(r||(r=this.parseTextNodeExpression(e.wholeText)),r.length){var i=r.reduce((function(e,r){var i;return"function"==typeof r?null==(i=n.resolve(r,t,t))&&(i=""):i=r,e+i}),"");if(e.nodeValue!==i){var o=document.createTextNode(i);o.nodeExpressions=r,e.parentNode.replaceChild(o,e)}}else e.nodeExpressions=r},r.pushFragment=function(e,t,n,r){var i=e.substring(t,n);r.push(i)},r.parseTextNodeExpression=function(e){for(var t,n=[],r=/\{{2}((([^{}])|(\{([^{}]|(\{.*?\}))+?\}))*?)\}{2}/g,i=0;null!==(t=r.exec(e));){var o=r.lastIndex-t[0].length;if(o>i&&this.pushFragment(e,o,i,n),i=r.lastIndex,t[1]){var a=this.makeFunction(t[1]);n.push(a)}}var s=e.length;return s>i&&this.pushFragment(e,i,s,n),n.find((function(e){return"function"==typeof e}))?n:[]},e.makeContext=function(e,t,n,r,i,o){t.rxcompId=++ee;var a={module:e,instance:t,parentInstance:n,node:r,factory:i,selector:o},s=r.rxcompId=r.rxcompId||t.rxcompId;return(h[s]||(h[s]=[])).push(a),d[t.rxcompId]=a,a},e.parseExpression=function(t){for(var n=/(\()([^\(\)]*)(\))/;t.match(n);)t=t.replace(n,(function(t){return"┌"+e.parsePipes(arguments.length<=2?void 0:arguments[2])+"┘"}));return t=(t=e.parsePipes(t)).replace(/(┌)|(┘)/g,(function(e){return(arguments.length<=1?void 0:arguments[1])?"(":")"})),e.parseOptionalChaining(t)},e.parsePipes=function(t){for(var n=/(.*?[^\|])\|([^\|]+)/;t.match(n);)t=t.replace(n,(function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];var o=r[0].trim(),a=e.parsePipeParams(r[1]),s=a.shift().trim();return"$$pipes."+s+".transform┌"+[o].concat(a)+"┘"}));return t},e.parsePipeParams=function(e){for(var t=[],n=0,r="",i=0,o=e.length;n<o;){var a=e.substr(n,1);"{"!==a&&"("!==a&&"["!==a||i++,"}"!==a&&")"!==a&&"]"!==a||i--,":"===a&&0===i?(r.length&&t.push(r.trim()),r=""):r+=a,n++}return r.length&&t.push(r.trim()),t},e.parseOptionalChaining=function(e){var t;return e=e.replace(/(\w+(\?\.))+([\.|\w]+)/g,(function(e){for(var n=e.split("?."),r=0;r<n.length-1;r++){var i=r>0?"("+n[r]+" = "+t+")":n[r],o=n[r+1];t=r>0?i+"."+o:"("+i+" ? "+i+"."+o+" : void 0)"}return t||""}))},e.deleteContext=function(e,t){var n=[],r=h[e];return r&&(r.forEach((function(e){if(e===t)n.push(t);else{var r=e.instance;r.unsubscribe$.next(),r.unsubscribe$.complete(),r.onDestroy(),delete d[r.rxcompId]}})),n.length?h[e]=n:delete h[e]),n},e.matchSelectors=function(e,t,n){for(var r=0;r<t.length;r++){var i=t[r](e);if(i){var o=i.factory;if(o.prototype instanceof R&&o.meta.template&&(e.innerHTML=o.meta.template),n.push(i),o.prototype instanceof T)break}}return n},e.querySelectorsAll=function(e,t,n){if(1===e.nodeType){var r=this.matchSelectors(e,t,[]);if(n=n.concat(r),r.find((function(e){return e.factory.prototype instanceof T})))return n;for(var i=e.childNodes,o=0;o<i.length;o++)n=this.querySelectorsAll(i[o],t,n)}return n},e.traverseUp=function(e,t,n){if(void 0===n&&(n=0),e){var r=t(e,n);return r||this.traverseUp(e.parentNode,t,n+1)}},e.traverseDown=function(e,t,n){if(void 0===n&&(n=0),e){var r=t(e,n);if(r)return r;if(1===e.nodeType)for(var i=0,o=e.childNodes.length;i<o&&!r;)r=this.traverseDown(e.childNodes[i],t,n+1),i++;return r}},e.traversePrevious=function(e,t,n){if(void 0===n&&(n=0),e){var r=t(e,n);return r||this.traversePrevious(e.previousSibling,t,n+1)}},e.traverseNext=function(e,t,n){if(void 0===n&&(n=0),e){var r=t(e,n);return r||this.traverseNext(e.nextSibling,t,n+1)}},e}();function ne(e){var t,n=e.rxcompId;if(n){var r=h[n];r&&(t=r.reduce((function(e,t){return t.instance instanceof I?e||t:t.instance instanceof R?t:e}),void 0))}return t}function re(e){var t=ne(e);if(!(t&&t.factory.prototype instanceof T))return t}function ie(e,t,n){if(n||(n=p(e).node),n.rxcompId){var r=h[n.rxcompId];if(r)for(var i=0;i<r.length;i++){var o=r[i];if(o.instance!==e&&o.instance instanceof t)return o.instance}}return n.parentNode?ie(e,t,n.parentNode):void 0}var oe=function(e){function t(){return e.apply(this,arguments)||this}return o(t,e),i(t,[{key:"src",set:function(e){if(this.src_!==e){this.src_=e;var t=p(this).node;e?t.setAttribute("src",e):t.removeAttribute("src")}},get:function(){return this.src_}}]),t}(A);oe.meta={selector:"[[src]]",inputs:["src"]};var ae=function(e){function t(){return e.apply(this,arguments)||this}return o(t,e),t.prototype.onChanges=function(){var e=p(this).node,t=this.style,n=this.previousStyle;if(n)for(var r in n)if(!t||!t[r]){var i=r.split(".").shift();e.style.removeProperty(i)}if(t)for(var o in t)if(!n||n[o]!==t[o]){var a=o.split("."),s=a.shift(),c=t[o]+(a.length?a[0]:"");e.style.setProperty(s,c)}this.previousStyle=t},t}(A);ae.meta={selector:"[[style]]",inputs:["style"]};var se=[g,S,O,B,N,M,L,k,oe,ae],ce=[Z],ue=function(e){function t(){var t;return t=e.call(this)||this,w.pipe(n.takeUntil(t.unsubscribe$)).subscribe(),t}return o(t,e),t}(te);ue.meta={declarations:[].concat(se,ce),exports:[].concat(se,ce)};var le=function(e){function t(){return e.apply(this,arguments)||this}return o(t,e),t.bootstrap=function(e){if(!G)throw new v("missing platform browser, Window not found");if(!e)throw new v("missing moduleFactory");if(!e.meta)throw new v("missing moduleFactory meta");if(!e.meta.bootstrap)throw new v("missing bootstrap");if(!e.meta.bootstrap.meta)throw new v("missing bootstrap meta");if(!e.meta.bootstrap.meta.selector)throw new v("missing bootstrap meta selector");var t=this.resolveMeta(e),n=new e;if(n.meta=t,t.imports.forEach((function(e){e.prototype.constructor.call(n)})),$.rxcomp_hydrate_){var r,i=t.node.cloneNode();i.innerHTML=t.nodeInnerHTML=$.rxcomp_hydrate_.innerHTML;var o=n.compile(i,$);n.instances=o,o[0].pushChanges(),null==(r=t.node.parentNode)||r.replaceChild(i,t.node)}else{var a=n.compile(t.node,$);n.instances=a,a[0].pushChanges()}return n},t}(P);var de=function(){function e(){}return e.makeKey=function(e,t){var n="rxcomp-hydrate-"+e+"-"+(t?he(t):"");return n=n.replace(/(\s+)|(\W+)/g,(function(){return(arguments.length<=1?void 0:arguments[1])?"":"_"}))},e.has=function(e){return null!==document.querySelector("#"+e)},e.get=function(e){var t=document.querySelector("#"+e);if(t&&t.firstChild){var n=t.firstChild.nodeValue;return n?K.decode(n,[X]):void 0}},e.set=function(e,t){var n=K.encode(t,[q]);if(n){var r=document.createTextNode(n),i=document.querySelector("#"+e);i?i.replaceChild(r,i.firstChild):((i=document.createElement("script")).setAttribute("id",e),i.setAttribute("type","text/template"),i.append(r),document.head.append(i))}},e.remove=function(e){var t=document.querySelector("#"+e);t&&t.parentNode&&t.parentNode.removeChild(t)},e}();function he(e,t){return void 0===t&&(t=""),"number"==typeof e?t+="-"+e.toString():"string"==typeof e?t+="-"+e.substr(0,20):e&&Array.isArray(e)?t+="-"+e.map((function(e){return he(e)})).join(""):e&&"object"==typeof e&&(t+="-"+Object.keys(e).map((function(t){return t+he(e[t])})).join("-")),t}return e.Browser=le,e.ClassDirective=g,e.Component=R,e.Context=I,e.CoreModule=ue,e.DefaultErrorHandler=b,e.Directive=A,e.ErrorInterceptorHandler=y,e.ErrorInterceptors=E,e.EventDirective=S,e.ExpressionError=m,e.Factory=f,e.ForItem=x,e.ForStructure=O,e.HrefDirective=B,e.HrefTargetDirective=N,e.IfStructure=M,e.InnerHtmlDirective=L,e.JsonComponent=k,e.JsonPipe=Z,e.Module=te,e.ModuleError=v,e.PLATFORM_BROWSER=F,e.PLATFORM_JS_DOM=H,e.PLATFORM_NODE=j,e.PLATFORM_WEB_WORKER=V,e.Pipe=U,e.Platform=P,e.Serializer=K,e.SrcDirective=oe,e.Structure=T,e.StyleDirective=ae,e.TransferService=de,e.WINDOW=$,e.decodeBase64=Y,e.decodeJson=X,e.encodeBase64=J,e.encodeJson=q,e.encodeJsonWithOptions=W,e.errors$=w,e.getContext=p,e.getContextByNode=re,e.getHost=ie,e.getLocationComponents=function(e){for(var t,n="",r="",i="",o="",a="",s="",c="",u=/^((http\:|https\:)?\/\/)?((([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])|(([a-zA-Z0-9]|[a-zA-Z0-9][a-zA-Z0-9\-]*[a-zA-Z0-9])\.)*([A-Za-z0-9]|[A-Za-z0-9][A-Za-z0-9\-]*[A-Za-z0-9])|locahost)?(\:([^\/]+))?(\.?\/[^\?]+)?(\?[^\#]+)?(\#.+)?$/g,l=[];null!==(t=u.exec(e));)l.push(t);for(var d=0,h=l;d<h.length;d++){var f=h[d];n=f[2]||"",r=i=f[3]||"",o=f[11]||"",a=f[12]||"",s=f[13]||"",c=f[14]||""}return{href:e,protocol:n,host:r,hostname:i,port:o,pathname:a,search:s,hash:c}},e.getParsableContextByElement=ne,e.isPlatformBrowser=G,e.isPlatformServer=Q,e.isPlatformWorker=z,e.nextError$=_,e.optionsToKey=he,e}({},rxjs,rxjs.operators);
/**
 * @license rxcomp-form v1.0.0-beta.18
 * (c) 2020 Luca Zampetti <lzampetti@gmail.com>
 * License: MIT
 */this.rxcomp=this.rxcomp||{},this.rxcomp.form=function(e,t,n,r){"use strict";function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}function a(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}var s=function(e){function n(){return e.apply(this,arguments)||this}return a(n,e),n.prototype.onChanges=function(e){var n=t.getContext(this).node,r=this.control.flags;Object.keys(r).forEach((function(e){r[e]?n.classList.add(e):n.classList.remove(e)}))},o(n,[{key:"control",get:function(){return{}}}]),n}(t.Directive);s.meta={selector:"",hosts:{host:s}};var c=function(e){function t(){return e.apply(this,arguments)||this}return a(t,e),o(t,[{key:"control",get:function(){if(this.formArray)return this.formArray;if(!this.host)throw"missing form collection";return this.host.control.get(this.formArrayName)}}]),t}(s);c.meta={selector:"[formArray],[formArrayName]",inputs:["formArray","formArrayName"],hosts:{host:s}};var u=function(e){function i(){return e.apply(this,arguments)||this}a(i,e);var s=i.prototype;return s.onInit=function(){var e=this,i=t.getContext(this).node;n.fromEvent(i,"input").pipe(r.takeUntil(this.unsubscribe$)).subscribe((function(t){return e.onChange(t)})),n.fromEvent(i,"change").pipe(r.takeUntil(this.unsubscribe$)).subscribe((function(t){return e.onChange(t)})),n.fromEvent(i,"blur").pipe(r.takeUntil(this.unsubscribe$)).subscribe((function(t){return e.onBlur(t)}))},s.onChanges=function(e){var n=t.getContext(this).node;this.formControlName&&(n.name=this.formControlName);var r=this.control,i=r.flags;Object.keys(i).forEach((function(e){i[e]?n.classList.add(e):n.classList.remove(e)})),this.writeValue(r.value)},s.writeValue=function(e){t.getContext(this).node.value=null==e?"":e},s.onChange=function(e){var n=t.getContext(this).node;this.control.value=""===n.value?null:n.value},s.onBlur=function(e){this.control.touched=!0},s.setDisabledState=function(e){t.getContext(this).node.disabled=e},o(i,[{key:"control",get:function(){if(this.formControl)return this.formControl;if(!this.host)throw"missing form collection";return this.host.control.get(this.formControlName)}}]),i}(t.Directive);u.meta={selector:"",inputs:["formControl","formControlName","value"],hosts:{host:s}};var l=function(e){function i(){return e.apply(this,arguments)||this}a(i,e);var o=i.prototype;return o.onInit=function(){var e=this,i=t.getContext(this).node;n.fromEvent(i,"change").pipe(r.takeUntil(this.unsubscribe$)).subscribe((function(t){return e.onChange(t)})),n.fromEvent(i,"blur").pipe(r.takeUntil(this.unsubscribe$)).subscribe((function(t){return e.onBlur(t)}))},o.writeValue=function(e){var n=t.getContext(this).node;e===this.value?n.setAttribute("checked",e):n.removeAttribute("checked")},o.setDisabledState=function(e){t.getContext(this).node.disabled=e},o.onChange=function(e){var n=t.getContext(this).node;this.control.value=n.checked?this.value:!0!==this.value&&null},o.onBlur=function(e){this.control.touched=!0},i}(u);l.meta={selector:"input[type=checkbox][formControl],input[type=checkbox][formControlName]",inputs:["formControl","formControlName","value"],hosts:{host:s}};var d=function(e){function n(){return e.apply(this,arguments)||this}return a(n,e),n.prototype.onChanges=function(e){var n=t.getContext(this).node,r=this.control.flags;Object.keys(r).forEach((function(e){r[e]?n.classList.add(e):n.classList.remove(e)}))},o(n,[{key:"control",get:function(){if(this.formField)return this.formField;if(!this.host)throw"missing form collection";return this.host.control.get(this.formFieldName)}}]),n}(t.Component);d.meta={selector:"[formField],[formFieldName]",inputs:["formField","formFieldName"],hosts:{host:s}};var h=function(e){function t(){return e.apply(this,arguments)||this}return a(t,e),o(t,[{key:"control",get:function(){if(this.formGroup)return this.formGroup;if(!this.host)throw"missing form collection";return this.host.control.get(this.formGroupName)}}]),t}(s);h.meta={selector:"[formGroup],[formGroupName]",inputs:["formGroup","formGroupName"],hosts:{host:s}};var f=function(e){function n(){return e.apply(this,arguments)||this}a(n,e);var r=n.prototype;return r.writeValue=function(e){t.getContext(this).node.value=null==e?"":e},r.onChange=function(e){var n=t.getContext(this).node;this.control.value=""===n.value?null:n.value},r.onBlur=function(e){this.control.touched=!0},n}(u);f.meta={selector:"input[type=text][formControl],input[type=text][formControlName],input[type=email][formControl],input[type=email][formControlName],input[type=password][formControl],input[type=password][formControlName],textarea[formControl],textarea[formControlName]",inputs:["formControl","formControlName"],hosts:{host:s}};var p=function(e){function n(){return e.apply(this,arguments)||this}return a(n,e),n.prototype.onChanges=function(e){t.getContext(this).node.setAttribute("placeholder",this.placeholder||"")},n}(t.Directive);p.meta={selector:"input[placeholder],textarea[placeholder]",inputs:["placeholder"]};var A=function(e){function i(){return e.apply(this,arguments)||this}a(i,e);var o=i.prototype;return o.onInit=function(){var e=this,i=t.getContext(this).node;n.fromEvent(i,"change").pipe(r.takeUntil(this.unsubscribe$)).subscribe((function(t){return e.onChange(t)})),n.fromEvent(i,"blur").pipe(r.takeUntil(this.unsubscribe$)).subscribe((function(t){return e.onBlur(t)}))},o.writeValue=function(e){var n=t.getContext(this).node;n.checked=n.value===e},o.setDisabledState=function(e){t.getContext(this).node.disabled=e},o.onChange=function(e){var n=t.getContext(this).node;n.checked&&(this.control.value=n.value)},o.onBlur=function(e){this.control.touched=!0},i}(u);A.meta={selector:"input[type=radio][formControl],input[type=radio][formControlName]",inputs:["formControl","formControlName"],hosts:{host:s}};var g=function(e){function n(){return e.apply(this,arguments)||this}a(n,e);var r=n.prototype;return r.writeValue=function(e){t.getContext(this).node.value=null==e?"":e},r.setDisabledState=function(e){t.getContext(this).node.disabled=e},r.onChange=function(e){var n=t.getContext(this).node;this.control.value=""===n.value?null:n.value},r.onBlur=function(e){this.control.touched=!0},n}(u);g.meta={selector:"select[formControl],select[formControlName]",inputs:["formControl","formControlName"],hosts:{host:s}};var v=function(e){function i(){return e.apply(this,arguments)||this}return a(i,e),i.prototype.onInit=function(){var e=t.getContext(this),i=e.module,o=e.node,a=e.selector,s=e.parentInstance,c=this.event=a.replace(/\[|\]|\(|\)/g,""),u=o,l=this.event$=n.fromEvent(u,"submit").pipe(r.tap((function(e){e.preventDefault()})),r.shareReplay(1)),d=o.getAttribute("("+c+")");if(d){var h=i.makeFunction(d,["$event"]);l.pipe(r.takeUntil(this.unsubscribe$)).subscribe((function(e){i.resolve(h,s,e)}))}else s[c+"$"]=l},i}(t.Directive);v.meta={selector:"[(submit)]"};var m=function(){function e(e,t){this.validator=e,this.params$=new n.BehaviorSubject(t)}return e.prototype.validate=function(e){return this.validator(e,this.params)},o(e,[{key:"params",get:function(){return this.params$.getValue()},set:function(e){if(e){var t=this.params;Object.keys(e).reduce((function(n,r){return n||!t||t[r]!==e[r]}),!1)&&this.params$.next(e)}}}]),e}();function y(){return new m((function(e,t){return null}))}function b(){return new m((function(e,t){return null==e||0===e.length?{required:!0}:null}))}function E(){return new m((function(e,t){return!0===e?null:{required:!0}}))}function _(e){return new m((function(e,t){var n=t.min;return e&&n?(e=parseFloat(e),!isNaN(e)&&e<n?{min:{min:n,actual:e}}:null):null}),{min:e})}function w(e){return new m((function(e,t){var n=t.max;return e&&n?(e=parseFloat(e),!isNaN(e)&&e>n?{max:{max:n,actual:e}}:null):null}),{max:e})}function S(e){return new m((function(e,t){var n=t.minlength;if(!e||!n)return null;var r=e?e.length:0;return r<n?{minlength:{requiredLength:n,actualLength:r}}:null}),{minlength:e})}function T(e){return new m((function(e,t){var n=t.maxlength;if(!e||!n)return null;var r=e?e.length:0;return r>n?{minlength:{requiredLength:n,actualLength:r}}:null}),{maxlength:e})}function R(e){return new m((function(e,t){var n=t.pattern;if(!e||!n)return null;var r=function(e){var t;e instanceof RegExp?t=e:"string"==typeof e&&(e="$"===(e="^"===e.charAt(0)?e:"^"+e).charAt(e.length-1)?e:e+"$",t=new RegExp(e));return t||new RegExp("")}(n);return r.test(e)?null:{pattern:{requiredPattern:r.toString(),actualValue:e}}}),{pattern:e})}function C(){var e=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;return new m((function(t,n){return t?e.test(t)?null:{email:!0}:null}))}var I=Object.freeze({__proto__:null,NullValidator:y,RequiredValidator:b,RequiredTrueValidator:E,MinValidator:_,MaxValidator:w,MinLengthValidator:S,MaxLengthValidator:T,PatternValidator:R,EmailValidator:C}),x=function(e){function t(){return e.apply(this,arguments)||this}return a(t,e),t.prototype.onInit=function(){var e=this.validator=C();this.host&&this.host.control.addValidators(e)},t}(t.Directive);x.meta={selector:"[email][formControl],[email][formControlName]",inputs:["email"],hosts:{host:u}};var O=function(e){function t(){var t;return(t=e.apply(this,arguments)||this).maxlength=Number.POSITIVE_INFINITY,t}a(t,e);var n=t.prototype;return n.onInit=function(){this.validator=T(this.maxlength),this.host&&this.host.control.addValidators(this.validator)},n.onChanges=function(e){this.validator&&(this.validator.params={maxlength:this.maxlength})},t}(t.Directive);O.meta={selector:"[maxlength][formControl],[maxlength][formControlName]",inputs:["maxlength"],hosts:{host:u}};var N=function(e){function t(){var t;return(t=e.apply(this,arguments)||this).max=Number.POSITIVE_INFINITY,t}a(t,e);var n=t.prototype;return n.onInit=function(){this.validator=w(this.max),this.host&&this.host.control.addValidators(this.validator)},n.onChanges=function(e){this.validator&&(this.validator.params={max:this.max})},t}(t.Directive);N.meta={selector:"[max][formControl],[max][formControlName]",inputs:["max"],hosts:{host:u}};var B=function(e){function t(){var t;return(t=e.apply(this,arguments)||this).minlength=Number.NEGATIVE_INFINITY,t}a(t,e);var n=t.prototype;return n.onInit=function(){this.validator=S(this.minlength),this.host&&this.host.control.addValidators(this.validator)},n.onChanges=function(e){this.validator&&(this.validator.params={minlength:this.minlength})},t}(t.Directive);B.meta={selector:"[minlength][formControl],[minlength][formControlName]",inputs:["minlength"],hosts:{host:u}};var M=function(e){function t(){var t;return(t=e.apply(this,arguments)||this).min=Number.NEGATIVE_INFINITY,t}a(t,e);var n=t.prototype;return n.onInit=function(){this.validator=_(this.min),this.host&&this.host.control.addValidators(this.validator)},n.onChanges=function(e){this.validator&&(this.validator.params={min:this.min})},t}(t.Directive);M.meta={selector:"[min][formControl],[min][formControlName]",inputs:["min"],hosts:{host:u}};var L=function(e){function t(){return e.apply(this,arguments)||this}a(t,e);var n=t.prototype;return n.onInit=function(){this.pattern&&(this.validator=R(this.pattern),this.host&&this.host.control.addValidators(this.validator))},n.onChanges=function(e){this.validator&&(this.validator.params={pattern:this.pattern})},t}(t.Directive);L.meta={selector:"[pattern][formControl],[pattern][formControlName]",inputs:["pattern"],hosts:{host:u}};var k=function(e){function t(){return e.apply(this,arguments)||this}return a(t,e),t.prototype.onInit=function(){this.validator=E(),this.host&&this.host.control.addValidators(this.validator)},t}(t.Directive);k.meta={selector:"[requiredTrue][formControl],[requiredTrue][formControlName]",inputs:["requiredTrue"],hosts:{host:u}};var U=function(e){function t(){return e.apply(this,arguments)||this}return a(t,e),t.prototype.onInit=function(){this.validator=b(),this.host&&this.host.control.addValidators(this.validator)},t}(t.Directive);U.meta={selector:"[required][formControl],[required][formControlName]",inputs:["required"],hosts:{host:u}};var D,P=[c,l,d,h,f,p,A,g,v,x,N,O,M,B,L,U,k],F=[],H=function(e){function t(){return e.apply(this,arguments)||this}return a(t,e),t}(t.Module);H.meta={declarations:[].concat(P,F),exports:[].concat(P,F)},function(e){e.Pending="pending",e.Valid="valid",e.Invalid="invalid",e.Disabled="disabled",e.Hidden="hidden"}(D||(D={}));var j=D,V=function(){function e(e){var t=this;this.value_=void 0,this.submitted_=!1,this.touched_=!1,this.dirty_=!1,this.valueSubject=new n.BehaviorSubject(null),this.statusSubject=new n.BehaviorSubject(null),this.validatorsSubject=(new n.ReplaySubject).pipe(r.switchAll()),this.value$=this.valueSubject.pipe(r.distinctUntilChanged(),r.skip(1),r.tap((function(){t.submitted_=!1,t.dirty_=!0,t.statusSubject.next(null)})),r.shareReplay(1)),this.status$=n.merge(this.statusSubject,this.validatorsSubject).pipe(r.switchMap((function(){return t.validate$(t.value)})),r.shareReplay(1)),this.changes$=n.merge(this.value$,this.status$).pipe(r.map((function(){return t.value})),r.auditTime(1),r.shareReplay(1)),this.validators=e?Array.isArray(e)?e:[e]:[]}var t=e.prototype;return t.initSubjects_=function(){this.switchValidators_()},t.switchValidators_=function(){var e=this.validators.map((function(e){return e.params$})),t=e.length?n.combineLatest(e):n.of(e);this.validatorsSubject.next(t)},t.initObservables_=function(){},t.validate$=function(e){var t=this;return this.status===j.Disabled||this.status===j.Hidden||this.submitted_||!this.validators.length?(this.errors_={},this.status===j.Invalid&&(this.status=j.Valid),n.of(this.errors_)):n.combineLatest(this.validators.map((function(t){var r=t.validate(e);return n.isObservable(r)?r:n.of(r)}))).pipe(r.map((function(e){return t.errors_=Object.assign.apply(Object,[{}].concat(e)),t.status=0===Object.keys(t.errors_).length?j.Valid:j.Invalid,t.errors_})))},t.reset=function(e){this.status=e||j.Pending,this.value_=null,this.dirty_=!1,this.touched_=!1,this.submitted_=!1,this.statusSubject.next(null)},t.patch=function(e){this.value_=e,this.dirty_=!0,this.submitted_=!1,this.statusSubject.next(null)},t.addValidators=function(){var e;(e=this.validators).push.apply(e,arguments),this.switchValidators_()},t.replaceValidators=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.validators=t,this.switchValidators_()},t.clearValidators=function(){this.validators=[],this.switchValidators_()},o(e,[{key:"errors",get:function(){return this.errors_},set:function(e){this.errors_=e}},{key:"pending",get:function(){return this.status===j.Pending}},{key:"valid",get:function(){return this.status!==j.Invalid}},{key:"invalid",get:function(){return this.status===j.Invalid}},{key:"disabled",get:function(){return this.status===j.Disabled},set:function(e){e?this.status!==j.Disabled&&(this.status=j.Disabled,this.dirty_=!1,this.touched_=!1,this.submitted_=!1,this.statusSubject.next(null)):this.status===j.Disabled&&(this.status=j.Pending,this.dirty_=!1,this.touched_=!1,this.submitted_=!1,this.statusSubject.next(null))}},{key:"enabled",get:function(){return this.status!==j.Disabled}},{key:"hidden",get:function(){return this.status===j.Hidden},set:function(e){e?this.status!==j.Hidden&&(this.status=j.Hidden,this.dirty_=!1,this.touched_=!1,this.submitted_=!1,this.statusSubject.next(null)):this.status===j.Hidden&&(this.status=j.Pending,this.dirty_=!1,this.touched_=!1,this.submitted_=!1,this.statusSubject.next(null))}},{key:"visible",get:function(){return this.status!==j.Hidden}},{key:"submitted",get:function(){return this.submitted_},set:function(e){this.submitted_=e,this.statusSubject.next(null)}},{key:"dirty",get:function(){return this.dirty_}},{key:"pristine",get:function(){return!this.dirty_}},{key:"touched",get:function(){return this.touched_},set:function(e){this.touched_=e,this.statusSubject.next(null)}},{key:"untouched",get:function(){return!this.touched_}},{key:"flags",get:function(){return{untouched:this.untouched,touched:this.touched,pristine:this.pristine,dirty:this.dirty,pending:this.pending,enabled:this.enabled,disabled:this.disabled,hidden:this.hidden,visible:this.visible,valid:this.valid,invalid:this.invalid,submitted:this.submitted}}},{key:"value",get:function(){return this.value_},set:function(e){this.value_=e,this.valueSubject.next(e)}}]),e}(),Q=function(e){function t(t,n){var r;return void 0===t&&(t=null),(r=e.call(this,n)||this).value_=t,r.status=j.Pending,r.errors={},r.initSubjects_(),r.initObservables_(),r.statusSubject.next(null),r}return a(t,e),t}(V),G=function(e){function t(t,r){var i;return(i=e.call(this,r)||this).changesChildren=new n.BehaviorSubject(void 0),i.controls=t,i.initControls_(),i.initSubjects_(),i.initObservables_(),i}a(t,e);var i=t.prototype;return i.initControl_=function(e,t){var n=e instanceof V?e:new Q(e);return n.addValidators.apply(n,this.validators),n.name=t,n},i.initControls_=function(){var e=this;return this.forEach_((function(t,n){e.init(t,n)})),this.controls},i.initSubjects_=function(){this.changesChildren=this.changesChildren.pipe(r.switchAll()),this.switchSubjects_()},i.switchSubjects_=function(){var e=this.reduce_((function(e,t){return e.push(t.changes$),e}),[]),t=e.length?n.combineLatest(e):n.of(e);this.changesChildren.next(t)},i.initObservables_=function(){var e=this;this.changes$=this.changesChildren.pipe(r.map((function(){return e.value})),r.shareReplay(1))},i.validate=function(e){var t;if(this.status===j.Disabled||this.status===j.Hidden)t=[];else{var n=this.validators.map((function(t){return t.validate(e)})).filter((function(e){return null!==e}));t=this.reduce_((function(e,t){return e.concat(t.errors)}),n),this.status=0===t.length?j.Valid:j.Invalid}return t},i.forEach_=function(e){var t=this;Object.keys(this.controls).forEach((function(n){return e(t.controls[n],n)}))},i.reduce_=function(e,t){return this.forEach_((function(n,r){t=e(t,n,r)})),t},i.all_=function(e,t){return this.reduce_((function(n,r){return n&&r[e]===t}),!0)},i.any_=function(e,t){return this.reduce_((function(n,r){return n||r[e]===t}),!1)},i.reset=function(){this.forEach_((function(e){return e.reset()}))},i.patch=function(e){e&&this.forEach_((function(t,n){null!=e[n]&&t.patch(e[n])}))},i.init=function(e,t){this.controls[t]=this.initControl_(e,t)},i.get=function(e){return this.controls[e]},i.set=function(e,t){delete this.controls[t],this.controls[t]=this.initControl_(e,t),this.switchSubjects_()},i.add=function(e,t){this.controls[t]=this.initControl_(e,t),this.switchSubjects_()},i.remove=function(e){var t=this,n=Object.keys(this.controls).find((function(n){return t.controls[n]===e?n:null}));n&&this.removeKey(n)},i.removeKey=function(e){var t=void 0!==this.controls[e];delete this.controls[e],t&&this.switchSubjects_()},i.addValidators=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.forEach_((function(e){return e.addValidators.apply(e,t)}))},i.replaceValidators=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.forEach_((function(e){return e.replaceValidators.apply(e,t)}))},i.clearValidators=function(){this.forEach_((function(e){return e.clearValidators()}))},o(t,[{key:"valid",get:function(){return this.all_("valid",!0)}},{key:"invalid",get:function(){return this.any_("invalid",!0)}},{key:"pending",get:function(){return this.any_("pending",!0)}},{key:"disabled",get:function(){return this.all_("disabled",!0)},set:function(e){this.forEach_((function(t){t.disabled=e}))}},{key:"enabled",get:function(){return this.any_("enabled",!0)}},{key:"hidden",get:function(){return this.all_("hidden",!0)},set:function(e){this.forEach_((function(t){t.hidden=e}))}},{key:"visible",get:function(){return this.any_("visible",!0)}},{key:"submitted",get:function(){return this.all_("submitted",!0)},set:function(e){this.forEach_((function(t){t.submitted=e}))}},{key:"dirty",get:function(){return this.any_("dirty",!0)}},{key:"pristine",get:function(){return this.all_("pristine",!0)}},{key:"touched",get:function(){return this.all_("touched",!0)},set:function(e){this.forEach_((function(t){t.touched=e}))}},{key:"untouched",get:function(){return this.any_("untouched",!0)}},{key:"value",get:function(){return this.reduce_((function(e,t,n){return e[n]=t.value,e}),{})},set:function(e){this.forEach_((function(t,n){t.value=e[n]}))}},{key:"errors",get:function(){return this.reduce_((function(e,t){return Object.assign(e,t.errors)}),{})},set:function(e){}}]),t}(V),z=function(e){function t(t,n){return void 0===t&&(t=[]),e.call(this,t,n)||this}a(t,e);var n=t.prototype;return n.forEach_=function(e){this.controls.forEach((function(t,n){return e(t,n)}))},n.init=function(e,t){this.controls.length=Math.max(this.controls.length,t),this.controls[t]=this.initControl_(e,t)},n.set=function(e,t){this.controls.splice(t,1,this.initControl_(e,t)),this.switchSubjects_()},n.add=function(e,t){this.controls.length=Math.max(this.controls.length,t),this.controls[t]=this.initControl_(e,t),this.switchSubjects_()},n.push=function(e){this.controls.push(this.initControl_(e,this.controls.length)),this.switchSubjects_()},n.insert=function(e,t){this.controls.splice(t,0,this.initControl_(e,t)),this.switchSubjects_()},n.remove=function(e){var t=this.controls.indexOf(e);-1!==t&&this.removeKey(t)},n.removeKey=function(e){this.controls.length>e&&(this.controls.splice(e,1),this.switchSubjects_())},n.at=function(e){return this.controls[e]},o(t,[{key:"value",get:function(){return this.reduce_((function(e,t,n){return e[n]=t.value,e}),[])}},{key:"length",get:function(){return this.controls.length}}]),t}(G);var K=function(e){function t(t,n){return void 0===t&&(t={}),e.call(this,t,n)||this}return a(t,e),t}(G);return e.EmailValidator=C,e.FormAbstract=V,e.FormAbstractCollection=G,e.FormAbstractCollectionDirective=s,e.FormArray=z,e.FormArrayDirective=c,e.FormCheckboxDirective=l,e.FormControl=Q,e.FormEmailDirective=x,e.FormFieldComponent=d,e.FormGroup=K,e.FormGroupDirective=h,e.FormInputDirective=f,e.FormMaxDirective=N,e.FormMaxLengthDirective=O,e.FormMinDirective=M,e.FormMinLengthDirective=B,e.FormModule=H,e.FormPatternDirective=L,e.FormPlaceholderDirective=p,e.FormRadioDirective=A,e.FormRequiredDirective=U,e.FormRequiredTrueDirective=k,e.FormSelectDirective=g,e.FormStatus=j,e.FormValidator=m,e.MaxLengthValidator=T,e.MaxValidator=w,e.MinLengthValidator=S,e.MinValidator=_,e.NullValidator=y,e.PatternValidator=R,e.RequiredTrueValidator=E,e.RequiredValidator=b,e.Validators=I,e.formArray=function(e,t){return void 0===e&&(e=[]),new z(e,t)},e.formGroup=function(e,t){return void 0===e&&(e={}),new K(e,t)},e}({},rxcomp,rxjs,rxjs.operators),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e=e||self).window=e.window||{})}(this,(function(e){"use strict";
/*!
	 * EasePack 3.6.1
	 * https://greensock.com
	 *
	 * @license Copyright 2008-2021, GreenSock. All rights reserved.
	 * Subject to the terms at https://greensock.com/standard-license or for
	 * Club GreenSock members, the agreement issued with that membership.
	 * @author: Jack Doyle, jack@greensock.com
	*/var t,n,r=function(){return t||"undefined"!=typeof window&&(t=window.gsap)&&t.registerPlugin&&t},i=function(e,t){return!!(void 0===e?t:e&&!~(e+"").indexOf("false"))},o=function(e){if(t=e||r()){n=t.registerEase;var i,o=t.parseEase(),a=function(e){return function(t){var n=.5+t/2;e.config=function(t){return e(2*(1-t)*t*n+t*t)}}};for(i in o)o[i].config||a(o[i]);for(i in n("slow",l),n("expoScale",d),n("rough",h),f)"version"!==i&&t.core.globals(i,f[i])}},a=function(e,t,n){var r=(e=Math.min(1,e||.7))<1?t||0===t?t:.7:0,o=(1-e)/2,a=o+e,s=i(n);return function(e){var t=e+(.5-e)*r;return e<o?s?1-(e=1-e/o)*e:t-(e=1-e/o)*e*e*e*t:e>a?s?1===e?0:1-(e=(e-a)/o)*e:t+(e-t)*(e=(e-a)/o)*e*e*e:s?1:t}},s=function(e,n,r){var i=Math.log(n/e),o=n-e;return r&&(r=t.parseEase(r)),function(t){return(e*Math.exp(i*(r?r(t):t))-e)/o}},c=function(e,t,n){this.t=e,this.v=t,n&&(this.next=n,n.prev=this,this.c=n.v-t,this.gap=n.t-e)},u=function(e){"object"!=typeof e&&(e={points:+e||20});for(var n,r,o,a,s,u,l,d=e.taper||"none",h=[],f=0,p=0|(+e.points||20),A=p,g=i(e.randomize,!0),v=i(e.clamp),m=t?t.parseEase(e.template):0,y=.4*(+e.strength||1);--A>-1;)n=g?Math.random():1/p*A,r=m?m(n):n,o="none"===d?y:"out"===d?(a=1-n)*a*y:"in"===d?n*n*y:n<.5?(a=2*n)*a*.5*y:(a=2*(1-n))*a*.5*y,g?r+=Math.random()*o-.5*o:A%2?r+=.5*o:r-=.5*o,v&&(r>1?r=1:r<0&&(r=0)),h[f++]={x:n,y:r};for(h.sort((function(e,t){return e.x-t.x})),u=new c(1,1,null),A=p;A--;)s=h[A],u=new c(s.x,s.y,u);return l=new c(0,0,u.t?u:u.next),function(e){var t=l;if(e>t.t){for(;t.next&&e>=t.t;)t=t.next;t=t.prev}else for(;t.prev&&e<=t.t;)t=t.prev;return l=t,t.v+(e-t.t)/t.gap*t.c}},l=a(.7);l.ease=l,l.config=a;var d=s(1,2);d.config=s;var h=u();h.ease=h,h.config=u;var f={SlowMo:l,RoughEase:h,ExpoScaleEase:d};for(var p in f)f[p].register=o,f[p].version="3.6.1";r()&&t.registerPlugin(l),e.EasePack=f,e.ExpoScaleEase=d,e.RoughEase=h,e.SlowMo=l,e.default=f,Object.defineProperty(e,"__esModule",{value:!0})})),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e=e||self).window=e.window||{})}(this,(function(e){"use strict";function t(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}function n(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}
/*!
   * GSAP 3.6.1
   * https://greensock.com
   *
   * @license Copyright 2008-2021, GreenSock. All rights reserved.
   * Subject to the terms at https://greensock.com/standard-license or for
   * Club GreenSock members, the agreement issued with that membership.
   * @author: Jack Doyle, jack@greensock.com
  */var r,i,o,a,s,c,u,l,d,h,f,p,A,g,v,m,y,b,E,_,w,S,T,R,C,I,x,O,N={autoSleep:120,force3D:"auto",nullTargetWarn:1,units:{lineHeight:""}},B={duration:.5,overwrite:!1,delay:0},M=1e8,L=1e-8,k=2*Math.PI,U=k/4,D=0,P=Math.sqrt,F=Math.cos,H=Math.sin,j=function(e){return"string"==typeof e},V=function(e){return"function"==typeof e},Q=function(e){return"number"==typeof e},G=function(e){return void 0===e},z=function(e){return"object"==typeof e},K=function(e){return!1!==e},q=function(){return"undefined"!=typeof window},W=function(e){return V(e)||j(e)},X="function"==typeof ArrayBuffer&&ArrayBuffer.isView||function(){},J=Array.isArray,Y=/(?:-?\.?\d|\.)+/gi,Z=/[-+=.]*\d+[.e\-+]*\d*[e\-+]*\d*/g,$=/[-+=.]*\d+[.e-]*\d*[a-z%]*/g,ee=/[-+=.]*\d+\.?\d*(?:e-|e\+)?\d*/gi,te=/[+-]=-?[.\d]+/,ne=/[#\-+.]*\b[a-z\d-=+%.]+/gi,re=/[\d.+\-=]+(?:e[-+]\d*)*/i,ie={},oe={},ae=function(e){return(oe=Be(e,ie))&&mn},se=function(e,t){return console.warn("Invalid property",e,"set to",t,"Missing plugin? gsap.registerPlugin()")},ce=function(e,t){return!t&&console.warn(e)},ue=function(e,t){return e&&(ie[e]=t)&&oe&&(oe[e]=t)||ie},le=function(){return 0},de={},he=[],fe={},pe={},Ae={},ge=30,ve=[],me="",ye=function(e){var t,n,r=e[0];if(z(r)||V(r)||(e=[e]),!(t=(r._gsap||{}).harness)){for(n=ve.length;n--&&!ve[n].targetTest(r););t=ve[n]}for(n=e.length;n--;)e[n]&&(e[n]._gsap||(e[n]._gsap=new Vt(e[n],t)))||e.splice(n,1);return e},be=function(e){return e._gsap||ye(st(e))[0]._gsap},Ee=function(e,t,n){return(n=e[t])&&V(n)?e[t]():G(n)&&e.getAttribute&&e.getAttribute(t)||n},_e=function(e,t){return(e=e.split(",")).forEach(t)||e},we=function(e){return Math.round(1e5*e)/1e5||0},Se=function(e,t){for(var n=t.length,r=0;e.indexOf(t[r])<0&&++r<n;);return r<n},Te=function(e,t,n){var r,i=Q(e[1]),o=(i?2:1)+(t<2?0:1),a=e[o];if(i&&(a.duration=e[1]),a.parent=n,t){for(r=a;n&&!("immediateRender"in r);)r=n.vars.defaults||{},n=K(n.vars.inherit)&&n.parent;a.immediateRender=K(r.immediateRender),t<2?a.runBackwards=1:a.startAt=e[o-1]}return a},Re=function(){var e,t,n=he.length,r=he.slice(0);for(fe={},he.length=0,e=0;e<n;e++)(t=r[e])&&t._lazy&&(t.render(t._lazy[0],t._lazy[1],!0)._lazy=0)},Ce=function(e,t,n,r){he.length&&Re(),e.render(t,n,r),he.length&&Re()},Ie=function(e){var t=parseFloat(e);return(t||0===t)&&(e+"").match(ne).length<2?t:j(e)?e.trim():e},xe=function(e){return e},Oe=function(e,t){for(var n in t)n in e||(e[n]=t[n]);return e},Ne=function(e,t){for(var n in t)n in e||"duration"===n||"ease"===n||(e[n]=t[n])},Be=function(e,t){for(var n in t)e[n]=t[n];return e},Me=function e(t,n){for(var r in n)"__proto__"!==r&&"constructor"!==r&&"prototype"!==r&&(t[r]=z(n[r])?e(t[r]||(t[r]={}),n[r]):n[r]);return t},Le=function(e,t){var n,r={};for(n in e)n in t||(r[n]=e[n]);return r},ke=function(e){var t=e.parent||i,n=e.keyframes?Ne:Oe;if(K(e.inherit))for(;t;)n(e,t.vars.defaults),t=t.parent||t._dp;return e},Ue=function(e,t,n,r){void 0===n&&(n="_first"),void 0===r&&(r="_last");var i=t._prev,o=t._next;i?i._next=o:e[n]===t&&(e[n]=o),o?o._prev=i:e[r]===t&&(e[r]=i),t._next=t._prev=t.parent=null},De=function(e,t){e.parent&&(!t||e.parent.autoRemoveChildren)&&e.parent.remove(e),e._act=0},Pe=function(e,t){if(e&&(!t||t._end>e._dur||t._start<0))for(var n=e;n;)n._dirty=1,n=n.parent;return e},Fe=function(e){for(var t=e.parent;t&&t.parent;)t._dirty=1,t.totalDuration(),t=t.parent;return e},He=function e(t){return!t||t._ts&&e(t.parent)},je=function(e){return e._repeat?Ve(e._tTime,e=e.duration()+e._rDelay)*e:0},Ve=function(e,t){var n=Math.floor(e/=t);return e&&n===e?n-1:n},Qe=function(e,t){return(e-t._start)*t._ts+(t._ts>=0?0:t._dirty?t.totalDuration():t._tDur)},Ge=function(e){return e._end=we(e._start+(e._tDur/Math.abs(e._ts||e._rts||L)||0))},ze=function(e,t){var n=e._dp;return n&&n.smoothChildTiming&&e._ts&&(e._start=we(n._time-(e._ts>0?t/e._ts:((e._dirty?e.totalDuration():e._tDur)-t)/-e._ts)),Ge(e),n._dirty||Pe(n,e)),e},Ke=function(e,t){var n;if((t._time||t._initted&&!t._dur)&&(n=Qe(e.rawTime(),t),(!t._dur||nt(0,t.totalDuration(),n)-t._tTime>L)&&t.render(n,!0)),Pe(e,t)._dp&&e._initted&&e._time>=e._dur&&e._ts){if(e._dur<e.duration())for(n=e;n._dp;)n.rawTime()>=0&&n.totalTime(n._tTime),n=n._dp;e._zTime=-1e-8}},qe=function(e,t,n,r){return t.parent&&De(t),t._start=we(n+t._delay),t._end=we(t._start+(t.totalDuration()/Math.abs(t.timeScale())||0)),function(e,t,n,r,i){void 0===n&&(n="_first"),void 0===r&&(r="_last");var o,a=e[r];if(i)for(o=t[i];a&&a[i]>o;)a=a._prev;a?(t._next=a._next,a._next=t):(t._next=e[n],e[n]=t),t._next?t._next._prev=t:e[r]=t,t._prev=a,t.parent=t._dp=e}(e,t,"_first","_last",e._sort?"_start":0),e._recent=t,r||Ke(e,t),e},We=function(e,t){return(ie.ScrollTrigger||se("scrollTrigger",t))&&ie.ScrollTrigger.create(t,e)},Xe=function(e,t,n,r){return Xt(e,t),e._initted?!n&&e._pt&&(e._dur&&!1!==e.vars.lazy||!e._dur&&e.vars.lazy)&&u!==xt.frame?(he.push(e),e._lazy=[t,r],1):void 0:1},Je=function e(t){var n=t.parent;return n&&n._ts&&n._initted&&!n._lock&&(n.rawTime()<0||e(n))},Ye=function(e,t,n,r){var i=e._repeat,o=we(t)||0,a=e._tTime/e._tDur;return a&&!r&&(e._time*=o/e._dur),e._dur=o,e._tDur=i?i<0?1e10:we(o*(i+1)+e._rDelay*i):o,a&&!r?ze(e,e._tTime=e._tDur*a):e.parent&&Ge(e),n||Pe(e.parent,e),e},Ze=function(e){return e instanceof Gt?Pe(e):Ye(e,e._dur)},$e={_start:0,endTime:le},et=function e(t,n){var r,i,o=t.labels,a=t._recent||$e,s=t.duration()>=M?a.endTime(!1):t._dur;return j(n)&&(isNaN(n)||n in o)?"<"===(r=n.charAt(0))||">"===r?("<"===r?a._start:a.endTime(a._repeat>=0))+(parseFloat(n.substr(1))||0):(r=n.indexOf("="))<0?(n in o||(o[n]=s),o[n]):(i=+(n.charAt(r-1)+n.substr(r+1)),r>1?e(t,n.substr(0,r-1))+i:s+i):null==n?s:+n},tt=function(e,t){return e||0===e?t(e):t},nt=function(e,t,n){return n<e?e:n>t?t:n},rt=function(e){if("string"!=typeof e)return"";var t=re.exec(e);return t?e.substr(t.index+t[0].length):""},it=[].slice,ot=function(e,t){return e&&z(e)&&"length"in e&&(!t&&!e.length||e.length-1 in e&&z(e[0]))&&!e.nodeType&&e!==o},at=function(e,t,n){return void 0===n&&(n=[]),e.forEach((function(e){var r;return j(e)&&!t||ot(e,1)?(r=n).push.apply(r,st(e)):n.push(e)}))||n},st=function(e,t){return!j(e)||t||!a&&Ot()?J(e)?at(e,t):ot(e)?it.call(e,0):e?[e]:[]:it.call(s.querySelectorAll(e),0)},ct=function(e){return e.sort((function(){return.5-Math.random()}))},ut=function(e){if(V(e))return e;var t=z(e)?e:{each:e},n=Dt(t.ease),r=t.from||0,i=parseFloat(t.base)||0,o={},a=r>0&&r<1,s=isNaN(r)||a,c=t.axis,u=r,l=r;return j(r)?u=l={center:.5,edges:.5,end:1}[r]||0:!a&&s&&(u=r[0],l=r[1]),function(e,a,d){var h,f,p,A,g,v,m,y,b,E=(d||t).length,_=o[E];if(!_){if(!(b="auto"===t.grid?0:(t.grid||[1,M])[1])){for(m=-M;m<(m=d[b++].getBoundingClientRect().left)&&b<E;);b--}for(_=o[E]=[],h=s?Math.min(b,E)*u-.5:r%b,f=s?E*l/b-.5:r/b|0,m=0,y=M,v=0;v<E;v++)p=v%b-h,A=f-(v/b|0),_[v]=g=c?Math.abs("y"===c?A:p):P(p*p+A*A),g>m&&(m=g),g<y&&(y=g);"random"===r&&ct(_),_.max=m-y,_.min=y,_.v=E=(parseFloat(t.amount)||parseFloat(t.each)*(b>E?E-1:c?"y"===c?E/b:b:Math.max(b,E/b))||0)*("edges"===r?-1:1),_.b=E<0?i-E:i,_.u=rt(t.amount||t.each)||0,n=n&&E<0?kt(n):n}return E=(_[e]-_.min)/_.max||0,we(_.b+(n?n(E):E)*_.v)+_.u}},lt=function(e){var t=e<1?Math.pow(10,(e+"").length-2):1;return function(n){var r=Math.round(parseFloat(n)/e)*e*t;return(r-r%1)/t+(Q(n)?0:rt(n))}},dt=function(e,t){var n,r,i=J(e);return!i&&z(e)&&(n=i=e.radius||M,e.values?(e=st(e.values),(r=!Q(e[0]))&&(n*=n)):e=lt(e.increment)),tt(t,i?V(e)?function(t){return r=e(t),Math.abs(r-t)<=n?r:t}:function(t){for(var i,o,a=parseFloat(r?t.x:t),s=parseFloat(r?t.y:0),c=M,u=0,l=e.length;l--;)(i=r?(i=e[l].x-a)*i+(o=e[l].y-s)*o:Math.abs(e[l]-a))<c&&(c=i,u=l);return u=!n||c<=n?e[u]:t,r||u===t||Q(t)?u:u+rt(t)}:lt(e))},ht=function(e,t,n,r){return tt(J(e)?!t:!0===n?!!(n=0):!r,(function(){return J(e)?e[~~(Math.random()*e.length)]:(n=n||1e-5)&&(r=n<1?Math.pow(10,(n+"").length-2):1)&&Math.floor(Math.round((e-n/2+Math.random()*(t-e+.99*n))/n)*n*r)/r}))},ft=function(e,t,n){return tt(n,(function(n){return e[~~t(n)]}))},pt=function(e){for(var t,n,r,i,o=0,a="";~(t=e.indexOf("random(",o));)r=e.indexOf(")",t),i="["===e.charAt(t+7),n=e.substr(t+7,r-t-7).match(i?ne:Y),a+=e.substr(o,t-o)+ht(i?n:+n[0],i?0:+n[1],+n[2]||1e-5),o=r+1;return a+e.substr(o,e.length-o)},At=function(e,t,n,r,i){var o=t-e,a=r-n;return tt(i,(function(t){return n+((t-e)/o*a||0)}))},gt=function(e,t,n){var r,i,o,a=e.labels,s=M;for(r in a)(i=a[r]-t)<0==!!n&&i&&s>(i=Math.abs(i))&&(o=r,s=i);return o},vt=function(e,t,n){var r,i,o=e.vars,a=o[t];if(a)return r=o[t+"Params"],i=o.callbackScope||e,n&&he.length&&Re(),r?a.apply(i,r):a.call(i)},mt=function(e){return De(e),e.scrollTrigger&&e.scrollTrigger.kill(!1),e.progress()<1&&vt(e,"onInterrupt"),e},yt=function(e){var t=(e=!e.name&&e.default||e).name,n=V(e),r=t&&!n&&e.init?function(){this._props=[]}:e,i={init:le,render:un,add:qt,kill:dn,modifier:ln,rawVars:0},o={targetTest:0,get:0,getSetter:on,aliases:{},register:0};if(Ot(),e!==r){if(pe[t])return;Oe(r,Oe(Le(e,i),o)),Be(r.prototype,Be(i,Le(e,o))),pe[r.prop=t]=r,e.targetTest&&(ve.push(r),de[t]=1),t=("css"===t?"CSS":t.charAt(0).toUpperCase()+t.substr(1))+"Plugin"}ue(t,r),e.register&&e.register(mn,r,pn)},bt=255,Et={aqua:[0,bt,bt],lime:[0,bt,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,bt],navy:[0,0,128],white:[bt,bt,bt],olive:[128,128,0],yellow:[bt,bt,0],orange:[bt,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[bt,0,0],pink:[bt,192,203],cyan:[0,bt,bt],transparent:[bt,bt,bt,0]},_t=function(e,t,n){return(6*(e=e<0?e+1:e>1?e-1:e)<1?t+(n-t)*e*6:e<.5?n:3*e<2?t+(n-t)*(2/3-e)*6:t)*bt+.5|0},wt=function(e,t,n){var r,i,o,a,s,c,u,l,d,h,f=e?Q(e)?[e>>16,e>>8&bt,e&bt]:0:Et.black;if(!f){if(","===e.substr(-1)&&(e=e.substr(0,e.length-1)),Et[e])f=Et[e];else if("#"===e.charAt(0)){if(e.length<6&&(r=e.charAt(1),i=e.charAt(2),o=e.charAt(3),e="#"+r+r+i+i+o+o+(5===e.length?e.charAt(4)+e.charAt(4):"")),9===e.length)return[(f=parseInt(e.substr(1,6),16))>>16,f>>8&bt,f&bt,parseInt(e.substr(7),16)/255];f=[(e=parseInt(e.substr(1),16))>>16,e>>8&bt,e&bt]}else if("hsl"===e.substr(0,3))if(f=h=e.match(Y),t){if(~e.indexOf("="))return f=e.match(Z),n&&f.length<4&&(f[3]=1),f}else a=+f[0]%360/360,s=+f[1]/100,r=2*(c=+f[2]/100)-(i=c<=.5?c*(s+1):c+s-c*s),f.length>3&&(f[3]*=1),f[0]=_t(a+1/3,r,i),f[1]=_t(a,r,i),f[2]=_t(a-1/3,r,i);else f=e.match(Y)||Et.transparent;f=f.map(Number)}return t&&!h&&(r=f[0]/bt,i=f[1]/bt,o=f[2]/bt,c=((u=Math.max(r,i,o))+(l=Math.min(r,i,o)))/2,u===l?a=s=0:(d=u-l,s=c>.5?d/(2-u-l):d/(u+l),a=u===r?(i-o)/d+(i<o?6:0):u===i?(o-r)/d+2:(r-i)/d+4,a*=60),f[0]=~~(a+.5),f[1]=~~(100*s+.5),f[2]=~~(100*c+.5)),n&&f.length<4&&(f[3]=1),f},St=function(e){var t=[],n=[],r=-1;return e.split(Rt).forEach((function(e){var i=e.match($)||[];t.push.apply(t,i),n.push(r+=i.length+1)})),t.c=n,t},Tt=function(e,t,n){var r,i,o,a,s="",c=(e+s).match(Rt),u=t?"hsla(":"rgba(",l=0;if(!c)return e;if(c=c.map((function(e){return(e=wt(e,t,1))&&u+(t?e[0]+","+e[1]+"%,"+e[2]+"%,"+e[3]:e.join(","))+")"})),n&&(o=St(e),(r=n.c).join(s)!==o.c.join(s)))for(a=(i=e.replace(Rt,"1").split($)).length-1;l<a;l++)s+=i[l]+(~r.indexOf(l)?c.shift()||u+"0,0,0,0)":(o.length?o:c.length?c:n).shift());if(!i)for(a=(i=e.split(Rt)).length-1;l<a;l++)s+=i[l]+c[l];return s+i[a]},Rt=function(){var e,t="(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#(?:[0-9a-f]{3,4}){1,2}\\b";for(e in Et)t+="|"+e+"\\b";return new RegExp(t+")","gi")}(),Ct=/hsl[a]?\(/,It=function(e){var t,n=e.join(" ");if(Rt.lastIndex=0,Rt.test(n))return t=Ct.test(n),e[1]=Tt(e[1],t),e[0]=Tt(e[0],t,St(e[1])),!0},xt=(m=Date.now,y=500,b=33,E=m(),_=E,S=w=1e3/240,R=function e(t){var n,r,i,o,a=m()-_,s=!0===t;if(a>y&&(E+=a-b),((n=(i=(_+=a)-E)-S)>0||s)&&(o=++A.frame,g=i-1e3*A.time,A.time=i/=1e3,S+=n+(n>=w?4:w-n),r=1),s||(h=f(e)),r)for(v=0;v<T.length;v++)T[v](i,g,o,t)},A={time:0,frame:0,tick:function(){R(!0)},deltaRatio:function(e){return g/(1e3/(e||60))},wake:function(){c&&(!a&&q()&&(o=a=window,s=o.document||{},ie.gsap=mn,(o.gsapVersions||(o.gsapVersions=[])).push(mn.version),ae(oe||o.GreenSockGlobals||!o.gsap&&o||{}),p=o.requestAnimationFrame),h&&A.sleep(),f=p||function(e){return setTimeout(e,S-1e3*A.time+1|0)},d=1,R(2))},sleep:function(){(p?o.cancelAnimationFrame:clearTimeout)(h),d=0,f=le},lagSmoothing:function(e,t){y=e||1e8,b=Math.min(t,y,0)},fps:function(e){w=1e3/(e||240),S=1e3*A.time+w},add:function(e){T.indexOf(e)<0&&T.push(e),Ot()},remove:function(e){var t;~(t=T.indexOf(e))&&T.splice(t,1)&&v>=t&&v--},_listeners:T=[]}),Ot=function(){return!d&&xt.wake()},Nt={},Bt=/^[\d.\-M][\d.\-,\s]/,Mt=/["']/g,Lt=function(e){for(var t,n,r,i={},o=e.substr(1,e.length-3).split(":"),a=o[0],s=1,c=o.length;s<c;s++)n=o[s],t=s!==c-1?n.lastIndexOf(","):n.length,r=n.substr(0,t),i[a]=isNaN(r)?r.replace(Mt,"").trim():+r,a=n.substr(t+1).trim();return i},kt=function(e){return function(t){return 1-e(1-t)}},Ut=function e(t,n){for(var r,i=t._first;i;)i instanceof Gt?e(i,n):!i.vars.yoyoEase||i._yoyo&&i._repeat||i._yoyo===n||(i.timeline?e(i.timeline,n):(r=i._ease,i._ease=i._yEase,i._yEase=r,i._yoyo=n)),i=i._next},Dt=function(e,t){return e&&(V(e)?e:Nt[e]||function(e){var t,n,r,i,o=(e+"").split("("),a=Nt[o[0]];return a&&o.length>1&&a.config?a.config.apply(null,~e.indexOf("{")?[Lt(o[1])]:(t=e,n=t.indexOf("(")+1,r=t.indexOf(")"),i=t.indexOf("(",n),t.substring(n,~i&&i<r?t.indexOf(")",r+1):r)).split(",").map(Ie)):Nt._CE&&Bt.test(e)?Nt._CE("",e):a}(e))||t},Pt=function(e,t,n,r){void 0===n&&(n=function(e){return 1-t(1-e)}),void 0===r&&(r=function(e){return e<.5?t(2*e)/2:1-t(2*(1-e))/2});var i,o={easeIn:t,easeOut:n,easeInOut:r};return _e(e,(function(e){for(var t in Nt[e]=ie[e]=o,Nt[i=e.toLowerCase()]=n,o)Nt[i+("easeIn"===t?".in":"easeOut"===t?".out":".inOut")]=Nt[e+"."+t]=o[t]})),o},Ft=function(e){return function(t){return t<.5?(1-e(1-2*t))/2:.5+e(2*(t-.5))/2}},Ht=function e(t,n,r){var i=n>=1?n:1,o=(r||(t?.3:.45))/(n<1?n:1),a=o/k*(Math.asin(1/i)||0),s=function(e){return 1===e?1:i*Math.pow(2,-10*e)*H((e-a)*o)+1},c="out"===t?s:"in"===t?function(e){return 1-s(1-e)}:Ft(s);return o=k/o,c.config=function(n,r){return e(t,n,r)},c},jt=function e(t,n){void 0===n&&(n=1.70158);var r=function(e){return e?--e*e*((n+1)*e+n)+1:0},i="out"===t?r:"in"===t?function(e){return 1-r(1-e)}:Ft(r);return i.config=function(n){return e(t,n)},i};_e("Linear,Quad,Cubic,Quart,Quint,Strong",(function(e,t){var n=t<5?t+1:t;Pt(e+",Power"+(n-1),t?function(e){return Math.pow(e,n)}:function(e){return e},(function(e){return 1-Math.pow(1-e,n)}),(function(e){return e<.5?Math.pow(2*e,n)/2:1-Math.pow(2*(1-e),n)/2}))})),Nt.Linear.easeNone=Nt.none=Nt.Linear.easeIn,Pt("Elastic",Ht("in"),Ht("out"),Ht()),C=7.5625,x=1/(I=2.75),Pt("Bounce",(function(e){return 1-O(1-e)}),O=function(e){return e<x?C*e*e:e<.7272727272727273?C*Math.pow(e-1.5/I,2)+.75:e<.9090909090909092?C*(e-=2.25/I)*e+.9375:C*Math.pow(e-2.625/I,2)+.984375}),Pt("Expo",(function(e){return e?Math.pow(2,10*(e-1)):0})),Pt("Circ",(function(e){return-(P(1-e*e)-1)})),Pt("Sine",(function(e){return 1===e?1:1-F(e*U)})),Pt("Back",jt("in"),jt("out"),jt()),Nt.SteppedEase=Nt.steps=ie.SteppedEase={config:function(e,t){void 0===e&&(e=1);var n=1/e,r=e+(t?0:1),i=t?1:0;return function(e){return((r*nt(0,.99999999,e)|0)+i)*n}}},B.ease=Nt["quad.out"],_e("onComplete,onUpdate,onStart,onRepeat,onReverseComplete,onInterrupt",(function(e){return me+=e+","+e+"Params,"}));var Vt=function(e,t){this.id=D++,e._gsap=this,this.target=e,this.harness=t,this.get=t?t.get:Ee,this.set=t?t.getSetter:on},Qt=function(){function e(e,t){var n=e.parent||i;this.vars=e,this._delay=+e.delay||0,(this._repeat=e.repeat===1/0?-2:e.repeat||0)&&(this._rDelay=e.repeatDelay||0,this._yoyo=!!e.yoyo||!!e.yoyoEase),this._ts=1,Ye(this,+e.duration,1,1),this.data=e.data,d||xt.wake(),n&&qe(n,this,t||0===t?t:n._time,1),e.reversed&&this.reverse(),e.paused&&this.paused(!0)}var t=e.prototype;return t.delay=function(e){return e||0===e?(this.parent&&this.parent.smoothChildTiming&&this.startTime(this._start+e-this._delay),this._delay=e,this):this._delay},t.duration=function(e){return arguments.length?this.totalDuration(this._repeat>0?e+(e+this._rDelay)*this._repeat:e):this.totalDuration()&&this._dur},t.totalDuration=function(e){return arguments.length?(this._dirty=0,Ye(this,this._repeat<0?e:(e-this._repeat*this._rDelay)/(this._repeat+1))):this._tDur},t.totalTime=function(e,t){if(Ot(),!arguments.length)return this._tTime;var n=this._dp;if(n&&n.smoothChildTiming&&this._ts){for(ze(this,e),!n._dp||n.parent||Ke(n,this);n.parent;)n.parent._time!==n._start+(n._ts>=0?n._tTime/n._ts:(n.totalDuration()-n._tTime)/-n._ts)&&n.totalTime(n._tTime,!0),n=n.parent;!this.parent&&this._dp.autoRemoveChildren&&(this._ts>0&&e<this._tDur||this._ts<0&&e>0||!this._tDur&&!e)&&qe(this._dp,this,this._start-this._delay)}return(this._tTime!==e||!this._dur&&!t||this._initted&&Math.abs(this._zTime)===L||!e&&!this._initted&&(this.add||this._ptLookup))&&(this._ts||(this._pTime=e),Ce(this,e,t)),this},t.time=function(e,t){return arguments.length?this.totalTime(Math.min(this.totalDuration(),e+je(this))%this._dur||(e?this._dur:0),t):this._time},t.totalProgress=function(e,t){return arguments.length?this.totalTime(this.totalDuration()*e,t):this.totalDuration()?Math.min(1,this._tTime/this._tDur):this.ratio},t.progress=function(e,t){return arguments.length?this.totalTime(this.duration()*(!this._yoyo||1&this.iteration()?e:1-e)+je(this),t):this.duration()?Math.min(1,this._time/this._dur):this.ratio},t.iteration=function(e,t){var n=this.duration()+this._rDelay;return arguments.length?this.totalTime(this._time+(e-1)*n,t):this._repeat?Ve(this._tTime,n)+1:1},t.timeScale=function(e){if(!arguments.length)return-1e-8===this._rts?0:this._rts;if(this._rts===e)return this;var t=this.parent&&this._ts?Qe(this.parent._time,this):this._tTime;return this._rts=+e||0,this._ts=this._ps||-1e-8===e?0:this._rts,Fe(this.totalTime(nt(-this._delay,this._tDur,t),!0))},t.paused=function(e){return arguments.length?(this._ps!==e&&(this._ps=e,e?(this._pTime=this._tTime||Math.max(-this._delay,this.rawTime()),this._ts=this._act=0):(Ot(),this._ts=this._rts,this.totalTime(this.parent&&!this.parent.smoothChildTiming?this.rawTime():this._tTime||this._pTime,1===this.progress()&&(this._tTime-=L)&&Math.abs(this._zTime)!==L))),this):this._ps},t.startTime=function(e){if(arguments.length){this._start=e;var t=this.parent||this._dp;return t&&(t._sort||!this.parent)&&qe(t,this,e-this._delay),this}return this._start},t.endTime=function(e){return this._start+(K(e)?this.totalDuration():this.duration())/Math.abs(this._ts)},t.rawTime=function(e){var t=this.parent||this._dp;return t?e&&(!this._ts||this._repeat&&this._time&&this.totalProgress()<1)?this._tTime%(this._dur+this._rDelay):this._ts?Qe(t.rawTime(e),this):this._tTime:this._tTime},t.globalTime=function(e){for(var t=this,n=arguments.length?e:t.rawTime();t;)n=t._start+n/(t._ts||1),t=t._dp;return n},t.repeat=function(e){return arguments.length?(this._repeat=e===1/0?-2:e,Ze(this)):-2===this._repeat?1/0:this._repeat},t.repeatDelay=function(e){return arguments.length?(this._rDelay=e,Ze(this)):this._rDelay},t.yoyo=function(e){return arguments.length?(this._yoyo=e,this):this._yoyo},t.seek=function(e,t){return this.totalTime(et(this,e),K(t))},t.restart=function(e,t){return this.play().totalTime(e?-this._delay:0,K(t))},t.play=function(e,t){return null!=e&&this.seek(e,t),this.reversed(!1).paused(!1)},t.reverse=function(e,t){return null!=e&&this.seek(e||this.totalDuration(),t),this.reversed(!0).paused(!1)},t.pause=function(e,t){return null!=e&&this.seek(e,t),this.paused(!0)},t.resume=function(){return this.paused(!1)},t.reversed=function(e){return arguments.length?(!!e!==this.reversed()&&this.timeScale(-this._rts||(e?-1e-8:0)),this):this._rts<0},t.invalidate=function(){return this._initted=this._act=0,this._zTime=-1e-8,this},t.isActive=function(){var e,t=this.parent||this._dp,n=this._start;return!(t&&!(this._ts&&this._initted&&t.isActive()&&(e=t.rawTime(!0))>=n&&e<this.endTime(!0)-L))},t.eventCallback=function(e,t,n){var r=this.vars;return arguments.length>1?(t?(r[e]=t,n&&(r[e+"Params"]=n),"onUpdate"===e&&(this._onUpdate=t)):delete r[e],this):r[e]},t.then=function(e){var t=this;return new Promise((function(n){var r=V(e)?e:xe,i=function(){var e=t.then;t.then=null,V(r)&&(r=r(t))&&(r.then||r===t)&&(t.then=e),n(r),t.then=e};t._initted&&1===t.totalProgress()&&t._ts>=0||!t._tTime&&t._ts<0?i():t._prom=i}))},t.kill=function(){mt(this)},e}();Oe(Qt.prototype,{_time:0,_start:0,_end:0,_tTime:0,_tDur:0,_dirty:0,_repeat:0,_yoyo:!1,parent:null,_initted:!1,_rDelay:0,_ts:1,_dp:0,ratio:0,_zTime:-1e-8,_prom:0,_ps:!1,_rts:1});var Gt=function(e){function r(t,r){var i;return void 0===t&&(t={}),(i=e.call(this,t,r)||this).labels={},i.smoothChildTiming=!!t.smoothChildTiming,i.autoRemoveChildren=!!t.autoRemoveChildren,i._sort=K(t.sortChildren),i.parent&&Ke(i.parent,n(i)),t.scrollTrigger&&We(n(i),t.scrollTrigger),i}t(r,e);var o=r.prototype;return o.to=function(e,t,n){return new $t(e,Te(arguments,0,this),et(this,Q(t)?arguments[3]:n)),this},o.from=function(e,t,n){return new $t(e,Te(arguments,1,this),et(this,Q(t)?arguments[3]:n)),this},o.fromTo=function(e,t,n,r){return new $t(e,Te(arguments,2,this),et(this,Q(t)?arguments[4]:r)),this},o.set=function(e,t,n){return t.duration=0,t.parent=this,ke(t).repeatDelay||(t.repeat=0),t.immediateRender=!!t.immediateRender,new $t(e,t,et(this,n),1),this},o.call=function(e,t,n){return qe(this,$t.delayedCall(0,e,t),et(this,n))},o.staggerTo=function(e,t,n,r,i,o,a){return n.duration=t,n.stagger=n.stagger||r,n.onComplete=o,n.onCompleteParams=a,n.parent=this,new $t(e,n,et(this,i)),this},o.staggerFrom=function(e,t,n,r,i,o,a){return n.runBackwards=1,ke(n).immediateRender=K(n.immediateRender),this.staggerTo(e,t,n,r,i,o,a)},o.staggerFromTo=function(e,t,n,r,i,o,a,s){return r.startAt=n,ke(r).immediateRender=K(r.immediateRender),this.staggerTo(e,t,r,i,o,a,s)},o.render=function(e,t,n){var r,o,a,s,c,u,l,d,h,f,p,A,g=this._time,v=this._dirty?this.totalDuration():this._tDur,m=this._dur,y=this!==i&&e>v-L&&e>=0?v:e<L?0:e,b=this._zTime<0!=e<0&&(this._initted||!m);if(y!==this._tTime||n||b){if(g!==this._time&&m&&(y+=this._time-g,e+=this._time-g),r=y,h=this._start,u=!(d=this._ts),b&&(m||(g=this._zTime),(e||!t)&&(this._zTime=e)),this._repeat){if(p=this._yoyo,c=m+this._rDelay,this._repeat<-1&&e<0)return this.totalTime(100*c+e,t,n);if(r=we(y%c),y===v?(s=this._repeat,r=m):((s=~~(y/c))&&s===y/c&&(r=m,s--),r>m&&(r=m)),f=Ve(this._tTime,c),!g&&this._tTime&&f!==s&&(f=s),p&&1&s&&(r=m-r,A=1),s!==f&&!this._lock){var E=p&&1&f,_=E===(p&&1&s);if(s<f&&(E=!E),g=E?0:m,this._lock=1,this.render(g||(A?0:we(s*c)),t,!m)._lock=0,!t&&this.parent&&vt(this,"onRepeat"),this.vars.repeatRefresh&&!A&&(this.invalidate()._lock=1),g&&g!==this._time||u!==!this._ts||this.vars.onRepeat&&!this.parent&&!this._act)return this;if(m=this._dur,v=this._tDur,_&&(this._lock=2,g=E?m:-1e-4,this.render(g,!0)),this._lock=0,!this._ts&&!u)return this;Ut(this,A)}}if(this._hasPause&&!this._forcing&&this._lock<2&&(l=function(e,t,n){var r;if(n>t)for(r=e._first;r&&r._start<=n;){if(!r._dur&&"isPause"===r.data&&r._start>t)return r;r=r._next}else for(r=e._last;r&&r._start>=n;){if(!r._dur&&"isPause"===r.data&&r._start<t)return r;r=r._prev}}(this,we(g),we(r)))&&(y-=r-(r=l._start)),this._tTime=y,this._time=r,this._act=!d,this._initted||(this._onUpdate=this.vars.onUpdate,this._initted=1,this._zTime=e,g=0),!g&&r&&!t&&vt(this,"onStart"),r>=g&&e>=0)for(o=this._first;o;){if(a=o._next,(o._act||r>=o._start)&&o._ts&&l!==o){if(o.parent!==this)return this.render(e,t,n);if(o.render(o._ts>0?(r-o._start)*o._ts:(o._dirty?o.totalDuration():o._tDur)+(r-o._start)*o._ts,t,n),r!==this._time||!this._ts&&!u){l=0,a&&(y+=this._zTime=-1e-8);break}}o=a}else{o=this._last;for(var w=e<0?e:r;o;){if(a=o._prev,(o._act||w<=o._end)&&o._ts&&l!==o){if(o.parent!==this)return this.render(e,t,n);if(o.render(o._ts>0?(w-o._start)*o._ts:(o._dirty?o.totalDuration():o._tDur)+(w-o._start)*o._ts,t,n),r!==this._time||!this._ts&&!u){l=0,a&&(y+=this._zTime=w?-1e-8:L);break}}o=a}}if(l&&!t&&(this.pause(),l.render(r>=g?0:-1e-8)._zTime=r>=g?1:-1,this._ts))return this._start=h,Ge(this),this.render(e,t,n);this._onUpdate&&!t&&vt(this,"onUpdate",!0),(y===v&&v>=this.totalDuration()||!y&&g)&&(h!==this._start&&Math.abs(d)===Math.abs(this._ts)||this._lock||((e||!m)&&(y===v&&this._ts>0||!y&&this._ts<0)&&De(this,1),t||e<0&&!g||!y&&!g||(vt(this,y===v?"onComplete":"onReverseComplete",!0),this._prom&&!(y<v&&this.timeScale()>0)&&this._prom())))}return this},o.add=function(e,t){var n=this;if(Q(t)||(t=et(this,t)),!(e instanceof Qt)){if(J(e))return e.forEach((function(e){return n.add(e,t)})),this;if(j(e))return this.addLabel(e,t);if(!V(e))return this;e=$t.delayedCall(0,e)}return this!==e?qe(this,e,t):this},o.getChildren=function(e,t,n,r){void 0===e&&(e=!0),void 0===t&&(t=!0),void 0===n&&(n=!0),void 0===r&&(r=-M);for(var i=[],o=this._first;o;)o._start>=r&&(o instanceof $t?t&&i.push(o):(n&&i.push(o),e&&i.push.apply(i,o.getChildren(!0,t,n)))),o=o._next;return i},o.getById=function(e){for(var t=this.getChildren(1,1,1),n=t.length;n--;)if(t[n].vars.id===e)return t[n]},o.remove=function(e){return j(e)?this.removeLabel(e):V(e)?this.killTweensOf(e):(Ue(this,e),e===this._recent&&(this._recent=this._last),Pe(this))},o.totalTime=function(t,n){return arguments.length?(this._forcing=1,!this._dp&&this._ts&&(this._start=we(xt.time-(this._ts>0?t/this._ts:(this.totalDuration()-t)/-this._ts))),e.prototype.totalTime.call(this,t,n),this._forcing=0,this):this._tTime},o.addLabel=function(e,t){return this.labels[e]=et(this,t),this},o.removeLabel=function(e){return delete this.labels[e],this},o.addPause=function(e,t,n){var r=$t.delayedCall(0,t||le,n);return r.data="isPause",this._hasPause=1,qe(this,r,et(this,e))},o.removePause=function(e){var t=this._first;for(e=et(this,e);t;)t._start===e&&"isPause"===t.data&&De(t),t=t._next},o.killTweensOf=function(e,t,n){for(var r=this.getTweensOf(e,n),i=r.length;i--;)zt!==r[i]&&r[i].kill(e,t);return this},o.getTweensOf=function(e,t){for(var n,r=[],i=st(e),o=this._first,a=Q(t);o;)o instanceof $t?Se(o._targets,i)&&(a?(!zt||o._initted&&o._ts)&&o.globalTime(0)<=t&&o.globalTime(o.totalDuration())>t:!t||o.isActive())&&r.push(o):(n=o.getTweensOf(i,t)).length&&r.push.apply(r,n),o=o._next;return r},o.tweenTo=function(e,t){t=t||{};var n=this,r=et(n,e),i=t,o=i.startAt,a=i.onStart,s=i.onStartParams,c=i.immediateRender,u=$t.to(n,Oe({ease:t.ease||"none",lazy:!1,immediateRender:!1,time:r,overwrite:"auto",duration:t.duration||Math.abs((r-(o&&"time"in o?o.time:n._time))/n.timeScale())||L,onStart:function(){n.pause();var e=t.duration||Math.abs((r-n._time)/n.timeScale());u._dur!==e&&Ye(u,e,0,1).render(u._time,!0,!0),a&&a.apply(u,s||[])}},t));return c?u.render(0):u},o.tweenFromTo=function(e,t,n){return this.tweenTo(t,Oe({startAt:{time:et(this,e)}},n))},o.recent=function(){return this._recent},o.nextLabel=function(e){return void 0===e&&(e=this._time),gt(this,et(this,e))},o.previousLabel=function(e){return void 0===e&&(e=this._time),gt(this,et(this,e),1)},o.currentLabel=function(e){return arguments.length?this.seek(e,!0):this.previousLabel(this._time+L)},o.shiftChildren=function(e,t,n){void 0===n&&(n=0);for(var r,i=this._first,o=this.labels;i;)i._start>=n&&(i._start+=e,i._end+=e),i=i._next;if(t)for(r in o)o[r]>=n&&(o[r]+=e);return Pe(this)},o.invalidate=function(){var t=this._first;for(this._lock=0;t;)t.invalidate(),t=t._next;return e.prototype.invalidate.call(this)},o.clear=function(e){void 0===e&&(e=!0);for(var t,n=this._first;n;)t=n._next,this.remove(n),n=t;return this._dp&&(this._time=this._tTime=this._pTime=0),e&&(this.labels={}),Pe(this)},o.totalDuration=function(e){var t,n,r,o=0,a=this,s=a._last,c=M;if(arguments.length)return a.timeScale((a._repeat<0?a.duration():a.totalDuration())/(a.reversed()?-e:e));if(a._dirty){for(r=a.parent;s;)t=s._prev,s._dirty&&s.totalDuration(),(n=s._start)>c&&a._sort&&s._ts&&!a._lock?(a._lock=1,qe(a,s,n-s._delay,1)._lock=0):c=n,n<0&&s._ts&&(o-=n,(!r&&!a._dp||r&&r.smoothChildTiming)&&(a._start+=n/a._ts,a._time-=n,a._tTime-=n),a.shiftChildren(-n,!1,-Infinity),c=0),s._end>o&&s._ts&&(o=s._end),s=t;Ye(a,a===i&&a._time>o?a._time:o,1,1),a._dirty=0}return a._tDur},r.updateRoot=function(e){if(i._ts&&(Ce(i,Qe(e,i)),u=xt.frame),xt.frame>=ge){ge+=N.autoSleep||120;var t=i._first;if((!t||!t._ts)&&N.autoSleep&&xt._listeners.length<2){for(;t&&!t._ts;)t=t._next;t||xt.sleep()}}},r}(Qt);Oe(Gt.prototype,{_lock:0,_hasPause:0,_forcing:0});var zt,Kt=function(e,t,n,r,i,o,a){var s,c,u,l,d,h,f,p,A=new pn(this._pt,e,t,0,1,cn,null,i),g=0,v=0;for(A.b=n,A.e=r,n+="",(f=~(r+="").indexOf("random("))&&(r=pt(r)),o&&(o(p=[n,r],e,t),n=p[0],r=p[1]),c=n.match(ee)||[];s=ee.exec(r);)l=s[0],d=r.substring(g,s.index),u?u=(u+1)%5:"rgba("===d.substr(-5)&&(u=1),l!==c[v++]&&(h=parseFloat(c[v-1])||0,A._pt={_next:A._pt,p:d||1===v?d:",",s:h,c:"="===l.charAt(1)?parseFloat(l.substr(2))*("-"===l.charAt(0)?-1:1):parseFloat(l)-h,m:u&&u<4?Math.round:0},g=ee.lastIndex);return A.c=g<r.length?r.substring(g,r.length):"",A.fp=a,(te.test(r)||f)&&(A.e=0),this._pt=A,A},qt=function(e,t,n,r,i,o,a,s,c){V(r)&&(r=r(i||0,e,o));var u,l=e[t],d="get"!==n?n:V(l)?c?e[t.indexOf("set")||!V(e["get"+t.substr(3)])?t:"get"+t.substr(3)](c):e[t]():l,h=V(l)?c?nn:tn:en;if(j(r)&&(~r.indexOf("random(")&&(r=pt(r)),"="===r.charAt(1)&&(r=parseFloat(d)+parseFloat(r.substr(2))*("-"===r.charAt(0)?-1:1)+(rt(d)||0))),d!==r)return isNaN(d*r)?(!l&&!(t in e)&&se(t,r),Kt.call(this,e,t,d,r,h,s||N.stringFilter,c)):(u=new pn(this._pt,e,t,+d||0,r-(d||0),"boolean"==typeof l?sn:an,0,h),c&&(u.fp=c),a&&u.modifier(a,this,e),this._pt=u)},Wt=function(e,t,n,r,i,o){var a,s,c,u;if(pe[e]&&!1!==(a=new pe[e]).init(i,a.rawVars?t[e]:function(e,t,n,r,i){if(V(e)&&(e=Jt(e,i,t,n,r)),!z(e)||e.style&&e.nodeType||J(e)||X(e))return j(e)?Jt(e,i,t,n,r):e;var o,a={};for(o in e)a[o]=Jt(e[o],i,t,n,r);return a}(t[e],r,i,o,n),n,r,o)&&(n._pt=s=new pn(n._pt,i,e,0,1,a.render,a,0,a.priority),n!==l))for(c=n._ptLookup[n._targets.indexOf(i)],u=a._props.length;u--;)c[a._props[u]]=s;return a},Xt=function e(t,n){var o,a,s,c,u,l,d,h,f,p,A,g,v,m=t.vars,y=m.ease,b=m.startAt,E=m.immediateRender,_=m.lazy,w=m.onUpdate,S=m.onUpdateParams,T=m.callbackScope,R=m.runBackwards,C=m.yoyoEase,I=m.keyframes,x=m.autoRevert,O=t._dur,N=t._startAt,M=t._targets,k=t.parent,U=k&&"nested"===k.data?k.parent._targets:M,D="auto"===t._overwrite&&!r,P=t.timeline;if(P&&(!I||!y)&&(y="none"),t._ease=Dt(y,B.ease),t._yEase=C?kt(Dt(!0===C?y:C,B.ease)):0,C&&t._yoyo&&!t._repeat&&(C=t._yEase,t._yEase=t._ease,t._ease=C),!P){if(g=(h=M[0]?be(M[0]).harness:0)&&m[h.prop],o=Le(m,de),N&&N.render(-1,!0).kill(),b)if(De(t._startAt=$t.set(M,Oe({data:"isStart",overwrite:!1,parent:k,immediateRender:!0,lazy:K(_),startAt:null,delay:0,onUpdate:w,onUpdateParams:S,callbackScope:T,stagger:0},b))),E){if(n>0)x||(t._startAt=0);else if(O&&!(n<0&&N))return void(n&&(t._zTime=n))}else!1===x&&(t._startAt=0);else if(R&&O)if(N)!x&&(t._startAt=0);else if(n&&(E=!1),s=Oe({overwrite:!1,data:"isFromStart",lazy:E&&K(_),immediateRender:E,stagger:0,parent:k},o),g&&(s[h.prop]=g),De(t._startAt=$t.set(M,s)),E){if(!n)return}else e(t._startAt,L);for(t._pt=0,_=O&&K(_)||_&&!O,a=0;a<M.length;a++){if(d=(u=M[a])._gsap||ye(M)[a]._gsap,t._ptLookup[a]=p={},fe[d.id]&&he.length&&Re(),A=U===M?a:U.indexOf(u),h&&!1!==(f=new h).init(u,g||o,t,A,U)&&(t._pt=c=new pn(t._pt,u,f.name,0,1,f.render,f,0,f.priority),f._props.forEach((function(e){p[e]=c})),f.priority&&(l=1)),!h||g)for(s in o)pe[s]&&(f=Wt(s,o,t,A,u,U))?f.priority&&(l=1):p[s]=c=qt.call(t,u,s,"get",o[s],A,U,0,m.stringFilter);t._op&&t._op[a]&&t.kill(u,t._op[a]),D&&t._pt&&(zt=t,i.killTweensOf(u,p,t.globalTime(0)),v=!t.parent,zt=0),t._pt&&_&&(fe[d.id]=1)}l&&fn(t),t._onInit&&t._onInit(t)}t._from=!P&&!!m.runBackwards,t._onUpdate=w,t._initted=(!t._op||t._pt)&&!v},Jt=function(e,t,n,r,i){return V(e)?e.call(t,n,r,i):j(e)&&~e.indexOf("random(")?pt(e):e},Yt=me+"repeat,repeatDelay,yoyo,repeatRefresh,yoyoEase",Zt=(Yt+",id,stagger,delay,duration,paused,scrollTrigger").split(","),$t=function(e){function o(t,o,a,s){var c;"number"==typeof o&&(a.duration=o,o=a,a=null);var u,l,d,h,f,p,A,g,v=(c=e.call(this,s?o:ke(o),a)||this).vars,m=v.duration,y=v.delay,b=v.immediateRender,E=v.stagger,_=v.overwrite,w=v.keyframes,S=v.defaults,T=v.scrollTrigger,R=v.yoyoEase,C=c.parent,I=(J(t)||X(t)?Q(t[0]):"length"in o)?[t]:st(t);if(c._targets=I.length?ye(I):ce("GSAP target "+t+" not found. https://greensock.com",!N.nullTargetWarn)||[],c._ptLookup=[],c._overwrite=_,w||E||W(m)||W(y)){if(o=c.vars,(u=c.timeline=new Gt({data:"nested",defaults:S||{}})).kill(),u.parent=u._dp=n(c),u._start=0,w)Oe(u.vars.defaults,{ease:"none"}),w.forEach((function(e){return u.to(I,e,">")}));else{if(h=I.length,A=E?ut(E):le,z(E))for(f in E)~Yt.indexOf(f)&&(g||(g={}),g[f]=E[f]);for(l=0;l<h;l++){for(f in d={},o)Zt.indexOf(f)<0&&(d[f]=o[f]);d.stagger=0,R&&(d.yoyoEase=R),g&&Be(d,g),p=I[l],d.duration=+Jt(m,n(c),l,p,I),d.delay=(+Jt(y,n(c),l,p,I)||0)-c._delay,!E&&1===h&&d.delay&&(c._delay=y=d.delay,c._start+=y,d.delay=0),u.to(p,d,A(l,p,I))}u.duration()?m=y=0:c.timeline=0}m||c.duration(m=u.duration())}else c.timeline=0;return!0!==_||r||(zt=n(c),i.killTweensOf(I),zt=0),C&&Ke(C,n(c)),(b||!m&&!w&&c._start===we(C._time)&&K(b)&&He(n(c))&&"nested"!==C.data)&&(c._tTime=-1e-8,c.render(Math.max(0,-y))),T&&We(n(c),T),c}t(o,e);var a=o.prototype;return a.render=function(e,t,n){var r,i,o,a,s,c,u,l,d,h=this._time,f=this._tDur,p=this._dur,A=e>f-L&&e>=0?f:e<L?0:e;if(p){if(A!==this._tTime||!e||n||!this._initted&&this._tTime||this._startAt&&this._zTime<0!=e<0){if(r=A,l=this.timeline,this._repeat){if(a=p+this._rDelay,this._repeat<-1&&e<0)return this.totalTime(100*a+e,t,n);if(r=we(A%a),A===f?(o=this._repeat,r=p):((o=~~(A/a))&&o===A/a&&(r=p,o--),r>p&&(r=p)),(c=this._yoyo&&1&o)&&(d=this._yEase,r=p-r),s=Ve(this._tTime,a),r===h&&!n&&this._initted)return this;o!==s&&(l&&this._yEase&&Ut(l,c),!this.vars.repeatRefresh||c||this._lock||(this._lock=n=1,this.render(we(a*o),!0).invalidate()._lock=0))}if(!this._initted){if(Xe(this,e<0?e:r,n,t))return this._tTime=0,this;if(p!==this._dur)return this.render(e,t,n)}for(this._tTime=A,this._time=r,!this._act&&this._ts&&(this._act=1,this._lazy=0),this.ratio=u=(d||this._ease)(r/p),this._from&&(this.ratio=u=1-u),r&&!h&&!t&&vt(this,"onStart"),i=this._pt;i;)i.r(u,i.d),i=i._next;l&&l.render(e<0?e:!r&&c?-1e-8:l._dur*u,t,n)||this._startAt&&(this._zTime=e),this._onUpdate&&!t&&(e<0&&this._startAt&&this._startAt.render(e,!0,n),vt(this,"onUpdate")),this._repeat&&o!==s&&this.vars.onRepeat&&!t&&this.parent&&vt(this,"onRepeat"),A!==this._tDur&&A||this._tTime!==A||(e<0&&this._startAt&&!this._onUpdate&&this._startAt.render(e,!0,!0),(e||!p)&&(A===this._tDur&&this._ts>0||!A&&this._ts<0)&&De(this,1),t||e<0&&!h||!A&&!h||(vt(this,A===f?"onComplete":"onReverseComplete",!0),this._prom&&!(A<f&&this.timeScale()>0)&&this._prom()))}}else!function(e,t,n,r){var i,o,a,s=e.ratio,c=t<0||!t&&(!e._start&&Je(e)||(e._ts<0||e._dp._ts<0)&&"isFromStart"!==e.data&&"isStart"!==e.data)?0:1,u=e._rDelay,l=0;if(u&&e._repeat&&(l=nt(0,e._tDur,t),o=Ve(l,u),a=Ve(e._tTime,u),e._yoyo&&1&o&&(c=1-c),o!==a&&(s=1-c,e.vars.repeatRefresh&&e._initted&&e.invalidate())),c!==s||r||e._zTime===L||!t&&e._zTime){if(!e._initted&&Xe(e,t,r,n))return;for(a=e._zTime,e._zTime=t||(n?L:0),n||(n=t&&!a),e.ratio=c,e._from&&(c=1-c),e._time=0,e._tTime=l,i=e._pt;i;)i.r(c,i.d),i=i._next;e._startAt&&t<0&&e._startAt.render(t,!0,!0),e._onUpdate&&!n&&vt(e,"onUpdate"),l&&e._repeat&&!n&&e.parent&&vt(e,"onRepeat"),(t>=e._tDur||t<0)&&e.ratio===c&&(c&&De(e,1),n||(vt(e,c?"onComplete":"onReverseComplete",!0),e._prom&&e._prom()))}else e._zTime||(e._zTime=t)}(this,e,t,n);return this},a.targets=function(){return this._targets},a.invalidate=function(){return this._pt=this._op=this._startAt=this._onUpdate=this._lazy=this.ratio=0,this._ptLookup=[],this.timeline&&this.timeline.invalidate(),e.prototype.invalidate.call(this)},a.kill=function(e,t){if(void 0===t&&(t="all"),!(e||t&&"all"!==t))return this._lazy=this._pt=0,this.parent?mt(this):this;if(this.timeline){var n=this.timeline.totalDuration();return this.timeline.killTweensOf(e,t,zt&&!0!==zt.vars.overwrite)._first||mt(this),this.parent&&n!==this.timeline.totalDuration()&&Ye(this,this._dur*this.timeline._tDur/n,0,1),this}var r,i,o,a,s,c,u,l=this._targets,d=e?st(e):l,h=this._ptLookup,f=this._pt;if((!t||"all"===t)&&function(e,t){for(var n=e.length,r=n===t.length;r&&n--&&e[n]===t[n];);return n<0}(l,d))return"all"===t&&(this._pt=0),mt(this);for(r=this._op=this._op||[],"all"!==t&&(j(t)&&(s={},_e(t,(function(e){return s[e]=1})),t=s),t=function(e,t){var n,r,i,o,a=e[0]?be(e[0]).harness:0,s=a&&a.aliases;if(!s)return t;for(r in n=Be({},t),s)if(r in n)for(i=(o=s[r].split(",")).length;i--;)n[o[i]]=n[r];return n}(l,t)),u=l.length;u--;)if(~d.indexOf(l[u]))for(s in i=h[u],"all"===t?(r[u]=t,a=i,o={}):(o=r[u]=r[u]||{},a=t),a)(c=i&&i[s])&&("kill"in c.d&&!0!==c.d.kill(s)||Ue(this,c,"_pt"),delete i[s]),"all"!==o&&(o[s]=1);return this._initted&&!this._pt&&f&&mt(this),this},o.to=function(e,t){return new o(e,t,arguments[2])},o.from=function(e,t){return new o(e,Te(arguments,1))},o.delayedCall=function(e,t,n,r){return new o(t,0,{immediateRender:!1,lazy:!1,overwrite:!1,delay:e,onComplete:t,onReverseComplete:t,onCompleteParams:n,onReverseCompleteParams:n,callbackScope:r})},o.fromTo=function(e,t,n){return new o(e,Te(arguments,2))},o.set=function(e,t){return t.duration=0,t.repeatDelay||(t.repeat=0),new o(e,t)},o.killTweensOf=function(e,t,n){return i.killTweensOf(e,t,n)},o}(Qt);Oe($t.prototype,{_targets:[],_lazy:0,_startAt:0,_op:0,_onInit:0}),_e("staggerTo,staggerFrom,staggerFromTo",(function(e){$t[e]=function(){var t=new Gt,n=it.call(arguments,0);return n.splice("staggerFromTo"===e?5:4,0,0),t[e].apply(t,n)}}));var en=function(e,t,n){return e[t]=n},tn=function(e,t,n){return e[t](n)},nn=function(e,t,n,r){return e[t](r.fp,n)},rn=function(e,t,n){return e.setAttribute(t,n)},on=function(e,t){return V(e[t])?tn:G(e[t])&&e.setAttribute?rn:en},an=function(e,t){return t.set(t.t,t.p,Math.round(1e4*(t.s+t.c*e))/1e4,t)},sn=function(e,t){return t.set(t.t,t.p,!!(t.s+t.c*e),t)},cn=function(e,t){var n=t._pt,r="";if(!e&&t.b)r=t.b;else if(1===e&&t.e)r=t.e;else{for(;n;)r=n.p+(n.m?n.m(n.s+n.c*e):Math.round(1e4*(n.s+n.c*e))/1e4)+r,n=n._next;r+=t.c}t.set(t.t,t.p,r,t)},un=function(e,t){for(var n=t._pt;n;)n.r(e,n.d),n=n._next},ln=function(e,t,n,r){for(var i,o=this._pt;o;)i=o._next,o.p===r&&o.modifier(e,t,n),o=i},dn=function(e){for(var t,n,r=this._pt;r;)n=r._next,r.p===e&&!r.op||r.op===e?Ue(this,r,"_pt"):r.dep||(t=1),r=n;return!t},hn=function(e,t,n,r){r.mSet(e,t,r.m.call(r.tween,n,r.mt),r)},fn=function(e){for(var t,n,r,i,o=e._pt;o;){for(t=o._next,n=r;n&&n.pr>o.pr;)n=n._next;(o._prev=n?n._prev:i)?o._prev._next=o:r=o,(o._next=n)?n._prev=o:i=o,o=t}e._pt=r},pn=function(){function e(e,t,n,r,i,o,a,s,c){this.t=t,this.s=r,this.c=i,this.p=n,this.r=o||an,this.d=a||this,this.set=s||en,this.pr=c||0,this._next=e,e&&(e._prev=this)}return e.prototype.modifier=function(e,t,n){this.mSet=this.mSet||this.set,this.set=hn,this.m=e,this.mt=n,this.tween=t},e}();_e(me+"parent,duration,ease,delay,overwrite,runBackwards,startAt,yoyo,immediateRender,repeat,repeatDelay,data,paused,reversed,lazy,callbackScope,stringFilter,id,yoyoEase,stagger,inherit,repeatRefresh,keyframes,autoRevert,scrollTrigger",(function(e){return de[e]=1})),ie.TweenMax=ie.TweenLite=$t,ie.TimelineLite=ie.TimelineMax=Gt,i=new Gt({sortChildren:!1,defaults:B,autoRemoveChildren:!0,id:"root",smoothChildTiming:!0}),N.stringFilter=It;var An={registerPlugin:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];t.forEach((function(e){return yt(e)}))},timeline:function(e){return new Gt(e)},getTweensOf:function(e,t){return i.getTweensOf(e,t)},getProperty:function(e,t,n,r){j(e)&&(e=st(e)[0]);var i=be(e||{}).get,o=n?xe:Ie;return"native"===n&&(n=""),e?t?o((pe[t]&&pe[t].get||i)(e,t,n,r)):function(t,n,r){return o((pe[t]&&pe[t].get||i)(e,t,n,r))}:e},quickSetter:function(e,t,n){if((e=st(e)).length>1){var r=e.map((function(e){return mn.quickSetter(e,t,n)})),i=r.length;return function(e){for(var t=i;t--;)r[t](e)}}e=e[0]||{};var o=pe[t],a=be(e),s=a.harness&&(a.harness.aliases||{})[t]||t,c=o?function(t){var r=new o;l._pt=0,r.init(e,n?t+n:t,l,0,[e]),r.render(1,r),l._pt&&un(1,l)}:a.set(e,s);return o?c:function(t){return c(e,s,n?t+n:t,a,1)}},isTweening:function(e){return i.getTweensOf(e,!0).length>0},defaults:function(e){return e&&e.ease&&(e.ease=Dt(e.ease,B.ease)),Me(B,e||{})},config:function(e){return Me(N,e||{})},registerEffect:function(e){var t=e.name,n=e.effect,r=e.plugins,i=e.defaults,o=e.extendTimeline;(r||"").split(",").forEach((function(e){return e&&!pe[e]&&!ie[e]&&ce(t+" effect requires "+e+" plugin.")})),Ae[t]=function(e,t,r){return n(st(e),Oe(t||{},i),r)},o&&(Gt.prototype[t]=function(e,n,r){return this.add(Ae[t](e,z(n)?n:(r=n)&&{},this),r)})},registerEase:function(e,t){Nt[e]=Dt(t)},parseEase:function(e,t){return arguments.length?Dt(e,t):Nt},getById:function(e){return i.getById(e)},exportRoot:function(e,t){void 0===e&&(e={});var n,r,o=new Gt(e);for(o.smoothChildTiming=K(e.smoothChildTiming),i.remove(o),o._dp=0,o._time=o._tTime=i._time,n=i._first;n;)r=n._next,!t&&!n._dur&&n instanceof $t&&n.vars.onComplete===n._targets[0]||qe(o,n,n._start-n._delay),n=r;return qe(i,o,0),o},utils:{wrap:function e(t,n,r){var i=n-t;return J(t)?ft(t,e(0,t.length),n):tt(r,(function(e){return(i+(e-t)%i)%i+t}))},wrapYoyo:function e(t,n,r){var i=n-t,o=2*i;return J(t)?ft(t,e(0,t.length-1),n):tt(r,(function(e){return t+((e=(o+(e-t)%o)%o||0)>i?o-e:e)}))},distribute:ut,random:ht,snap:dt,normalize:function(e,t,n){return At(e,t,0,1,n)},getUnit:rt,clamp:function(e,t,n){return tt(n,(function(n){return nt(e,t,n)}))},splitColor:wt,toArray:st,mapRange:At,pipe:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return t.reduce((function(e,t){return t(e)}),e)}},unitize:function(e,t){return function(n){return e(parseFloat(n))+(t||rt(n))}},interpolate:function e(t,n,r,i){var o=isNaN(t+n)?0:function(e){return(1-e)*t+e*n};if(!o){var a,s,c,u,l,d=j(t),h={};if(!0===r&&(i=1)&&(r=null),d)t={p:t},n={p:n};else if(J(t)&&!J(n)){for(c=[],u=t.length,l=u-2,s=1;s<u;s++)c.push(e(t[s-1],t[s]));u--,o=function(e){e*=u;var t=Math.min(l,~~e);return c[t](e-t)},r=n}else i||(t=Be(J(t)?[]:{},t));if(!c){for(a in n)qt.call(h,t,a,"get",n[a]);o=function(e){return un(e,h)||(d?t.p:t)}}}return tt(r,o)},shuffle:ct},install:ae,effects:Ae,ticker:xt,updateRoot:Gt.updateRoot,plugins:pe,globalTimeline:i,core:{PropTween:pn,globals:ue,Tween:$t,Timeline:Gt,Animation:Qt,getCache:be,_removeLinkedListItem:Ue,suppressOverwrites:function(e){return r=e}}};_e("to,from,fromTo,delayedCall,set,killTweensOf",(function(e){return An[e]=$t[e]})),xt.add(Gt.updateRoot),l=An.to({},{duration:0});var gn=function(e,t){for(var n=e._pt;n&&n.p!==t&&n.op!==t&&n.fp!==t;)n=n._next;return n},vn=function(e,t){return{name:e,rawVars:1,init:function(e,n,r){r._onInit=function(e){var r,i;if(j(n)&&(r={},_e(n,(function(e){return r[e]=1})),n=r),t){for(i in r={},n)r[i]=t(n[i]);n=r}!function(e,t){var n,r,i,o=e._targets;for(n in t)for(r=o.length;r--;)(i=e._ptLookup[r][n])&&(i=i.d)&&(i._pt&&(i=gn(i,n)),i&&i.modifier&&i.modifier(t[n],e,o[r],n))}(e,n)}}}},mn=An.registerPlugin({name:"attr",init:function(e,t,n,r,i){var o,a;for(o in t)(a=this.add(e,"setAttribute",(e.getAttribute(o)||0)+"",t[o],r,i,0,0,o))&&(a.op=o),this._props.push(o)}},{name:"endArray",init:function(e,t){for(var n=t.length;n--;)this.add(e,n,e[n]||0,t[n])}},vn("roundProps",lt),vn("modifiers"),vn("snap",dt))||An;$t.version=Gt.version=mn.version="3.6.1",c=1,q()&&Ot();var yn,bn,En,_n,wn,Sn,Tn,Rn=Nt.Power0,Cn=Nt.Power1,In=Nt.Power2,xn=Nt.Power3,On=Nt.Power4,Nn=Nt.Linear,Bn=Nt.Quad,Mn=Nt.Cubic,Ln=Nt.Quart,kn=Nt.Quint,Un=Nt.Strong,Dn=Nt.Elastic,Pn=Nt.Back,Fn=Nt.SteppedEase,Hn=Nt.Bounce,jn=Nt.Sine,Vn=Nt.Expo,Qn=Nt.Circ,Gn={},zn=180/Math.PI,Kn=Math.PI/180,qn=Math.atan2,Wn=/([A-Z])/g,Xn=/(?:left|right|width|margin|padding|x)/i,Jn=/[\s,\(]\S/,Yn={autoAlpha:"opacity,visibility",scale:"scaleX,scaleY",alpha:"opacity"},Zn=function(e,t){return t.set(t.t,t.p,Math.round(1e4*(t.s+t.c*e))/1e4+t.u,t)},$n=function(e,t){return t.set(t.t,t.p,1===e?t.e:Math.round(1e4*(t.s+t.c*e))/1e4+t.u,t)},er=function(e,t){return t.set(t.t,t.p,e?Math.round(1e4*(t.s+t.c*e))/1e4+t.u:t.b,t)},tr=function(e,t){var n=t.s+t.c*e;t.set(t.t,t.p,~~(n+(n<0?-.5:.5))+t.u,t)},nr=function(e,t){return t.set(t.t,t.p,e?t.e:t.b,t)},rr=function(e,t){return t.set(t.t,t.p,1!==e?t.b:t.e,t)},ir=function(e,t,n){return e.style[t]=n},or=function(e,t,n){return e.style.setProperty(t,n)},ar=function(e,t,n){return e._gsap[t]=n},sr=function(e,t,n){return e._gsap.scaleX=e._gsap.scaleY=n},cr=function(e,t,n,r,i){var o=e._gsap;o.scaleX=o.scaleY=n,o.renderTransform(i,o)},ur=function(e,t,n,r,i){var o=e._gsap;o[t]=n,o.renderTransform(i,o)},lr="transform",dr=lr+"Origin",hr=function(e,t){var n=bn.createElementNS?bn.createElementNS((t||"http://www.w3.org/1999/xhtml").replace(/^https/,"http"),e):bn.createElement(e);return n.style?n:bn.createElement(e)},fr=function e(t,n,r){var i=getComputedStyle(t);return i[n]||i.getPropertyValue(n.replace(Wn,"-$1").toLowerCase())||i.getPropertyValue(n)||!r&&e(t,Ar(n)||n,1)||""},pr="O,Moz,ms,Ms,Webkit".split(","),Ar=function(e,t,n){var r=(t||wn).style,i=5;if(e in r&&!n)return e;for(e=e.charAt(0).toUpperCase()+e.substr(1);i--&&!(pr[i]+e in r););return i<0?null:(3===i?"ms":i>=0?pr[i]:"")+e},gr=function(){"undefined"!=typeof window&&window.document&&(yn=window,bn=yn.document,En=bn.documentElement,wn=hr("div")||{style:{}},hr("div"),lr=Ar(lr),dr=lr+"Origin",wn.style.cssText="border-width:0;line-height:0;position:absolute;padding:0",Tn=!!Ar("perspective"),_n=1)},vr=function e(t){var n,r=hr("svg",this.ownerSVGElement&&this.ownerSVGElement.getAttribute("xmlns")||"http://www.w3.org/2000/svg"),i=this.parentNode,o=this.nextSibling,a=this.style.cssText;if(En.appendChild(r),r.appendChild(this),this.style.display="block",t)try{n=this.getBBox(),this._gsapBBox=this.getBBox,this.getBBox=e}catch(e){}else this._gsapBBox&&(n=this._gsapBBox());return i&&(o?i.insertBefore(this,o):i.appendChild(this)),En.removeChild(r),this.style.cssText=a,n},mr=function(e,t){for(var n=t.length;n--;)if(e.hasAttribute(t[n]))return e.getAttribute(t[n])},yr=function(e){var t;try{t=e.getBBox()}catch(n){t=vr.call(e,!0)}return t&&(t.width||t.height)||e.getBBox===vr||(t=vr.call(e,!0)),!t||t.width||t.x||t.y?t:{x:+mr(e,["x","cx","x1"])||0,y:+mr(e,["y","cy","y1"])||0,width:0,height:0}},br=function(e){return!(!e.getCTM||e.parentNode&&!e.ownerSVGElement||!yr(e))},Er=function(e,t){if(t){var n=e.style;t in Gn&&t!==dr&&(t=lr),n.removeProperty?("ms"!==t.substr(0,2)&&"webkit"!==t.substr(0,6)||(t="-"+t),n.removeProperty(t.replace(Wn,"-$1").toLowerCase())):n.removeAttribute(t)}},_r=function(e,t,n,r,i,o){var a=new pn(e._pt,t,n,0,1,o?rr:nr);return e._pt=a,a.b=r,a.e=i,e._props.push(n),a},wr={deg:1,rad:1,turn:1},Sr=function e(t,n,r,i){var o,a,s,c,u=parseFloat(r)||0,l=(r+"").trim().substr((u+"").length)||"px",d=wn.style,h=Xn.test(n),f="svg"===t.tagName.toLowerCase(),p=(f?"client":"offset")+(h?"Width":"Height"),A=100,g="px"===i,v="%"===i;return i===l||!u||wr[i]||wr[l]?u:("px"!==l&&!g&&(u=e(t,n,r,"px")),c=t.getCTM&&br(t),!v&&"%"!==l||!Gn[n]&&!~n.indexOf("adius")?(d[h?"width":"height"]=A+(g?l:i),a=~n.indexOf("adius")||"em"===i&&t.appendChild&&!f?t:t.parentNode,c&&(a=(t.ownerSVGElement||{}).parentNode),a&&a!==bn&&a.appendChild||(a=bn.body),(s=a._gsap)&&v&&s.width&&h&&s.time===xt.time?we(u/s.width*A):((v||"%"===l)&&(d.position=fr(t,"position")),a===t&&(d.position="static"),a.appendChild(wn),o=wn[p],a.removeChild(wn),d.position="absolute",h&&v&&((s=be(a)).time=xt.time,s.width=a[p]),we(g?o*u/A:o&&u?A/o*u:0))):(o=c?t.getBBox()[h?"width":"height"]:t[p],we(v?u/o*A:u/100*o)))},Tr=function(e,t,n,r){var i;return _n||gr(),t in Yn&&"transform"!==t&&~(t=Yn[t]).indexOf(",")&&(t=t.split(",")[0]),Gn[t]&&"transform"!==t?(i=Ur(e,r),i="transformOrigin"!==t?i[t]:Dr(fr(e,dr))+" "+i.zOrigin+"px"):(!(i=e.style[t])||"auto"===i||r||~(i+"").indexOf("calc("))&&(i=xr[t]&&xr[t](e,t,n)||fr(e,t)||Ee(e,t)||("opacity"===t?1:0)),n&&!~(i+"").trim().indexOf(" ")?Sr(e,t,i,n)+n:i},Rr=function(e,t,n,r){if(!n||"none"===n){var i=Ar(t,e,1),o=i&&fr(e,i,1);o&&o!==n?(t=i,n=o):"borderColor"===t&&(n=fr(e,"borderTopColor"))}var a,s,c,u,l,d,h,f,p,A,g,v,m=new pn(this._pt,e.style,t,0,1,cn),y=0,b=0;if(m.b=n,m.e=r,n+="","auto"===(r+="")&&(e.style[t]=r,r=fr(e,t)||r,e.style[t]=n),It(a=[n,r]),r=a[1],c=(n=a[0]).match($)||[],(r.match($)||[]).length){for(;s=$.exec(r);)h=s[0],p=r.substring(y,s.index),l?l=(l+1)%5:"rgba("!==p.substr(-5)&&"hsla("!==p.substr(-5)||(l=1),h!==(d=c[b++]||"")&&(u=parseFloat(d)||0,g=d.substr((u+"").length),(v="="===h.charAt(1)?+(h.charAt(0)+"1"):0)&&(h=h.substr(2)),f=parseFloat(h),A=h.substr((f+"").length),y=$.lastIndex-A.length,A||(A=A||N.units[t]||g,y===r.length&&(r+=A,m.e+=A)),g!==A&&(u=Sr(e,t,d,A)||0),m._pt={_next:m._pt,p:p||1===b?p:",",s:u,c:v?v*f:f-u,m:l&&l<4||"zIndex"===t?Math.round:0});m.c=y<r.length?r.substring(y,r.length):""}else m.r="display"===t&&"none"===r?rr:nr;return te.test(r)&&(m.e=0),this._pt=m,m},Cr={top:"0%",bottom:"100%",left:"0%",right:"100%",center:"50%"},Ir=function(e,t){if(t.tween&&t.tween._time===t.tween._dur){var n,r,i,o=t.t,a=o.style,s=t.u,c=o._gsap;if("all"===s||!0===s)a.cssText="",r=1;else for(i=(s=s.split(",")).length;--i>-1;)n=s[i],Gn[n]&&(r=1,n="transformOrigin"===n?dr:lr),Er(o,n);r&&(Er(o,lr),c&&(c.svg&&o.removeAttribute("transform"),Ur(o,1),c.uncache=1))}},xr={clearProps:function(e,t,n,r,i){if("isFromStart"!==i.data){var o=e._pt=new pn(e._pt,t,n,0,0,Ir);return o.u=r,o.pr=-10,o.tween=i,e._props.push(n),1}}},Or=[1,0,0,1,0,0],Nr={},Br=function(e){return"matrix(1, 0, 0, 1, 0, 0)"===e||"none"===e||!e},Mr=function(e){var t=fr(e,lr);return Br(t)?Or:t.substr(7).match(Z).map(we)},Lr=function(e,t){var n,r,i,o,a=e._gsap||be(e),s=e.style,c=Mr(e);return a.svg&&e.getAttribute("transform")?"1,0,0,1,0,0"===(c=[(i=e.transform.baseVal.consolidate().matrix).a,i.b,i.c,i.d,i.e,i.f]).join(",")?Or:c:(c!==Or||e.offsetParent||e===En||a.svg||(i=s.display,s.display="block",(n=e.parentNode)&&e.offsetParent||(o=1,r=e.nextSibling,En.appendChild(e)),c=Mr(e),i?s.display=i:Er(e,"display"),o&&(r?n.insertBefore(e,r):n?n.appendChild(e):En.removeChild(e))),t&&c.length>6?[c[0],c[1],c[4],c[5],c[12],c[13]]:c)},kr=function(e,t,n,r,i,o){var a,s,c,u=e._gsap,l=i||Lr(e,!0),d=u.xOrigin||0,h=u.yOrigin||0,f=u.xOffset||0,p=u.yOffset||0,A=l[0],g=l[1],v=l[2],m=l[3],y=l[4],b=l[5],E=t.split(" "),_=parseFloat(E[0])||0,w=parseFloat(E[1])||0;n?l!==Or&&(s=A*m-g*v)&&(c=_*(-g/s)+w*(A/s)-(A*b-g*y)/s,_=_*(m/s)+w*(-v/s)+(v*b-m*y)/s,w=c):(_=(a=yr(e)).x+(~E[0].indexOf("%")?_/100*a.width:_),w=a.y+(~(E[1]||E[0]).indexOf("%")?w/100*a.height:w)),r||!1!==r&&u.smooth?(y=_-d,b=w-h,u.xOffset=f+(y*A+b*v)-y,u.yOffset=p+(y*g+b*m)-b):u.xOffset=u.yOffset=0,u.xOrigin=_,u.yOrigin=w,u.smooth=!!r,u.origin=t,u.originIsAbsolute=!!n,e.style[dr]="0px 0px",o&&(_r(o,u,"xOrigin",d,_),_r(o,u,"yOrigin",h,w),_r(o,u,"xOffset",f,u.xOffset),_r(o,u,"yOffset",p,u.yOffset)),e.setAttribute("data-svg-origin",_+" "+w)},Ur=function(e,t){var n=e._gsap||new Vt(e);if("x"in n&&!t&&!n.uncache)return n;var r,i,o,a,s,c,u,l,d,h,f,p,A,g,v,m,y,b,E,_,w,S,T,R,C,I,x,O,B,M,L,k,U=e.style,D=n.scaleX<0,P="px",F="deg",H=fr(e,dr)||"0";return r=i=o=c=u=l=d=h=f=0,a=s=1,n.svg=!(!e.getCTM||!br(e)),g=Lr(e,n.svg),n.svg&&(R=!n.uncache&&!t&&e.getAttribute("data-svg-origin"),kr(e,R||H,!!R||n.originIsAbsolute,!1!==n.smooth,g)),p=n.xOrigin||0,A=n.yOrigin||0,g!==Or&&(b=g[0],E=g[1],_=g[2],w=g[3],r=S=g[4],i=T=g[5],6===g.length?(a=Math.sqrt(b*b+E*E),s=Math.sqrt(w*w+_*_),c=b||E?qn(E,b)*zn:0,(d=_||w?qn(_,w)*zn+c:0)&&(s*=Math.abs(Math.cos(d*Kn))),n.svg&&(r-=p-(p*b+A*_),i-=A-(p*E+A*w))):(k=g[6],M=g[7],x=g[8],O=g[9],B=g[10],L=g[11],r=g[12],i=g[13],o=g[14],u=(v=qn(k,B))*zn,v&&(R=S*(m=Math.cos(-v))+x*(y=Math.sin(-v)),C=T*m+O*y,I=k*m+B*y,x=S*-y+x*m,O=T*-y+O*m,B=k*-y+B*m,L=M*-y+L*m,S=R,T=C,k=I),l=(v=qn(-_,B))*zn,v&&(m=Math.cos(-v),L=w*(y=Math.sin(-v))+L*m,b=R=b*m-x*y,E=C=E*m-O*y,_=I=_*m-B*y),c=(v=qn(E,b))*zn,v&&(R=b*(m=Math.cos(v))+E*(y=Math.sin(v)),C=S*m+T*y,E=E*m-b*y,T=T*m-S*y,b=R,S=C),u&&Math.abs(u)+Math.abs(c)>359.9&&(u=c=0,l=180-l),a=we(Math.sqrt(b*b+E*E+_*_)),s=we(Math.sqrt(T*T+k*k)),v=qn(S,T),d=Math.abs(v)>2e-4?v*zn:0,f=L?1/(L<0?-L:L):0),n.svg&&(R=e.getAttribute("transform"),n.forceCSS=e.setAttribute("transform","")||!Br(fr(e,lr)),R&&e.setAttribute("transform",R))),Math.abs(d)>90&&Math.abs(d)<270&&(D?(a*=-1,d+=c<=0?180:-180,c+=c<=0?180:-180):(s*=-1,d+=d<=0?180:-180)),n.x=r-((n.xPercent=r&&(n.xPercent||(Math.round(e.offsetWidth/2)===Math.round(-r)?-50:0)))?e.offsetWidth*n.xPercent/100:0)+P,n.y=i-((n.yPercent=i&&(n.yPercent||(Math.round(e.offsetHeight/2)===Math.round(-i)?-50:0)))?e.offsetHeight*n.yPercent/100:0)+P,n.z=o+P,n.scaleX=we(a),n.scaleY=we(s),n.rotation=we(c)+F,n.rotationX=we(u)+F,n.rotationY=we(l)+F,n.skewX=d+F,n.skewY=h+F,n.transformPerspective=f+P,(n.zOrigin=parseFloat(H.split(" ")[2])||0)&&(U[dr]=Dr(H)),n.xOffset=n.yOffset=0,n.force3D=N.force3D,n.renderTransform=n.svg?Gr:Tn?Qr:Fr,n.uncache=0,n},Dr=function(e){return(e=e.split(" "))[0]+" "+e[1]},Pr=function(e,t,n){var r=rt(t);return we(parseFloat(t)+parseFloat(Sr(e,"x",n+"px",r)))+r},Fr=function(e,t){t.z="0px",t.rotationY=t.rotationX="0deg",t.force3D=0,Qr(e,t)},Hr="0deg",jr="0px",Vr=") ",Qr=function(e,t){var n=t||this,r=n.xPercent,i=n.yPercent,o=n.x,a=n.y,s=n.z,c=n.rotation,u=n.rotationY,l=n.rotationX,d=n.skewX,h=n.skewY,f=n.scaleX,p=n.scaleY,A=n.transformPerspective,g=n.force3D,v=n.target,m=n.zOrigin,y="",b="auto"===g&&e&&1!==e||!0===g;if(m&&(l!==Hr||u!==Hr)){var E,_=parseFloat(u)*Kn,w=Math.sin(_),S=Math.cos(_);_=parseFloat(l)*Kn,E=Math.cos(_),o=Pr(v,o,w*E*-m),a=Pr(v,a,-Math.sin(_)*-m),s=Pr(v,s,S*E*-m+m)}A!==jr&&(y+="perspective("+A+Vr),(r||i)&&(y+="translate("+r+"%, "+i+"%) "),(b||o!==jr||a!==jr||s!==jr)&&(y+=s!==jr||b?"translate3d("+o+", "+a+", "+s+") ":"translate("+o+", "+a+Vr),c!==Hr&&(y+="rotate("+c+Vr),u!==Hr&&(y+="rotateY("+u+Vr),l!==Hr&&(y+="rotateX("+l+Vr),d===Hr&&h===Hr||(y+="skew("+d+", "+h+Vr),1===f&&1===p||(y+="scale("+f+", "+p+Vr),v.style[lr]=y||"translate(0, 0)"},Gr=function(e,t){var n,r,i,o,a,s=t||this,c=s.xPercent,u=s.yPercent,l=s.x,d=s.y,h=s.rotation,f=s.skewX,p=s.skewY,A=s.scaleX,g=s.scaleY,v=s.target,m=s.xOrigin,y=s.yOrigin,b=s.xOffset,E=s.yOffset,_=s.forceCSS,w=parseFloat(l),S=parseFloat(d);h=parseFloat(h),f=parseFloat(f),(p=parseFloat(p))&&(f+=p=parseFloat(p),h+=p),h||f?(h*=Kn,f*=Kn,n=Math.cos(h)*A,r=Math.sin(h)*A,i=Math.sin(h-f)*-g,o=Math.cos(h-f)*g,f&&(p*=Kn,a=Math.tan(f-p),i*=a=Math.sqrt(1+a*a),o*=a,p&&(a=Math.tan(p),n*=a=Math.sqrt(1+a*a),r*=a)),n=we(n),r=we(r),i=we(i),o=we(o)):(n=A,o=g,r=i=0),(w&&!~(l+"").indexOf("px")||S&&!~(d+"").indexOf("px"))&&(w=Sr(v,"x",l,"px"),S=Sr(v,"y",d,"px")),(m||y||b||E)&&(w=we(w+m-(m*n+y*i)+b),S=we(S+y-(m*r+y*o)+E)),(c||u)&&(a=v.getBBox(),w=we(w+c/100*a.width),S=we(S+u/100*a.height)),a="matrix("+n+","+r+","+i+","+o+","+w+","+S+")",v.setAttribute("transform",a),_&&(v.style[lr]=a)},zr=function(e,t,n,r,i,o){var a,s,c=360,u=j(i),l=parseFloat(i)*(u&&~i.indexOf("rad")?zn:1),d=o?l*o:l-r,h=r+d+"deg";return u&&("short"===(a=i.split("_")[1])&&(d%=c)!==d%180&&(d+=d<0?c:-360),"cw"===a&&d<0?d=(d+36e9)%c-~~(d/c)*c:"ccw"===a&&d>0&&(d=(d-36e9)%c-~~(d/c)*c)),e._pt=s=new pn(e._pt,t,n,r,d,$n),s.e=h,s.u="deg",e._props.push(n),s},Kr=function(e,t){for(var n in t)e[n]=t[n];return e},qr=function(e,t,n){var r,i,o,a,s,c,u,l=Kr({},n._gsap),d=n.style;for(i in l.svg?(o=n.getAttribute("transform"),n.setAttribute("transform",""),d[lr]=t,r=Ur(n,1),Er(n,lr),n.setAttribute("transform",o)):(o=getComputedStyle(n)[lr],d[lr]=t,r=Ur(n,1),d[lr]=o),Gn)(o=l[i])!==(a=r[i])&&"perspective,force3D,transformOrigin,svgOrigin".indexOf(i)<0&&(s=rt(o)!==(u=rt(a))?Sr(n,i,o,u):parseFloat(o),c=parseFloat(a),e._pt=new pn(e._pt,r,i,s,c-s,Zn),e._pt.u=u||0,e._props.push(i));Kr(r,l)};_e("padding,margin,Width,Radius",(function(e,t){var n="Top",r="Right",i="Bottom",o="Left",a=(t<3?[n,r,i,o]:[n+o,n+r,i+r,i+o]).map((function(n){return t<2?e+n:"border"+n+e}));xr[t>1?"border"+e:e]=function(e,t,n,r,i){var o,s;if(arguments.length<4)return o=a.map((function(t){return Tr(e,t,n)})),5===(s=o.join(" ")).split(o[0]).length?o[0]:s;o=(r+"").split(" "),s={},a.forEach((function(e,t){return s[e]=o[t]=o[t]||o[(t-1)/2|0]})),e.init(t,s,i)}}));var Wr,Xr,Jr,Yr={name:"css",register:gr,targetTest:function(e){return e.style&&e.nodeType},init:function(e,t,n,r,i){var o,a,s,c,u,l,d,h,f,p,A,g,v,m,y,b,E,_,w,S=this._props,T=e.style,R=n.vars.startAt;for(d in _n||gr(),t)if("autoRound"!==d&&(a=t[d],!pe[d]||!Wt(d,t,n,r,e,i)))if(u=typeof a,l=xr[d],"function"===u&&(u=typeof(a=a.call(n,r,e,i))),"string"===u&&~a.indexOf("random(")&&(a=pt(a)),l)l(this,e,d,a,n)&&(y=1);else if("--"===d.substr(0,2))o=(getComputedStyle(e).getPropertyValue(d)+"").trim(),a+="",Rt.lastIndex=0,Rt.test(o)||(h=rt(o),f=rt(a)),f?h!==f&&(o=Sr(e,d,o,f)+f):h&&(a+=h),this.add(T,"setProperty",o,a,r,i,0,0,d);else if("undefined"!==u){if(R&&d in R?(o="function"==typeof R[d]?R[d].call(n,r,e,i):R[d],d in N.units&&!rt(o)&&(o+=N.units[d]),"="===(o+"").charAt(1)&&(o=Tr(e,d))):o=Tr(e,d),c=parseFloat(o),(p="string"===u&&"="===a.charAt(1)?+(a.charAt(0)+"1"):0)&&(a=a.substr(2)),s=parseFloat(a),d in Yn&&("autoAlpha"===d&&(1===c&&"hidden"===Tr(e,"visibility")&&s&&(c=0),_r(this,T,"visibility",c?"inherit":"hidden",s?"inherit":"hidden",!s)),"scale"!==d&&"transform"!==d&&~(d=Yn[d]).indexOf(",")&&(d=d.split(",")[0])),A=d in Gn)if(g||((v=e._gsap).renderTransform&&!t.parseTransform||Ur(e,t.parseTransform),m=!1!==t.smoothOrigin&&v.smooth,(g=this._pt=new pn(this._pt,T,lr,0,1,v.renderTransform,v,0,-1)).dep=1),"scale"===d)this._pt=new pn(this._pt,v,"scaleY",v.scaleY,p?p*s:s-v.scaleY),S.push("scaleY",d),d+="X";else{if("transformOrigin"===d){E=void 0,_=void 0,w=void 0,E=(b=a).split(" "),_=E[0],w=E[1]||"50%","top"!==_&&"bottom"!==_&&"left"!==w&&"right"!==w||(b=_,_=w,w=b),E[0]=Cr[_]||_,E[1]=Cr[w]||w,a=E.join(" "),v.svg?kr(e,a,0,m,0,this):((f=parseFloat(a.split(" ")[2])||0)!==v.zOrigin&&_r(this,v,"zOrigin",v.zOrigin,f),_r(this,T,d,Dr(o),Dr(a)));continue}if("svgOrigin"===d){kr(e,a,1,m,0,this);continue}if(d in Nr){zr(this,v,d,c,a,p);continue}if("smoothOrigin"===d){_r(this,v,"smooth",v.smooth,a);continue}if("force3D"===d){v[d]=a;continue}if("transform"===d){qr(this,a,e);continue}}else d in T||(d=Ar(d)||d);if(A||(s||0===s)&&(c||0===c)&&!Jn.test(a)&&d in T)s||(s=0),(h=(o+"").substr((c+"").length))!==(f=rt(a)||(d in N.units?N.units[d]:h))&&(c=Sr(e,d,o,f)),this._pt=new pn(this._pt,A?v:T,d,c,p?p*s:s-c,A||"px"!==f&&"zIndex"!==d||!1===t.autoRound?Zn:tr),this._pt.u=f||0,h!==f&&(this._pt.b=o,this._pt.r=er);else if(d in T)Rr.call(this,e,d,o,a);else{if(!(d in e)){se(d,a);continue}this.add(e,d,e[d],a,r,i)}S.push(d)}y&&fn(this)},get:Tr,aliases:Yn,getSetter:function(e,t,n){var r=Yn[t];return r&&r.indexOf(",")<0&&(t=r),t in Gn&&t!==dr&&(e._gsap.x||Tr(e,"x"))?n&&Sn===n?"scale"===t?sr:ar:(Sn=n||{})&&("scale"===t?cr:ur):e.style&&!G(e.style[t])?ir:~t.indexOf("-")?or:on(e,t)},core:{_removeProperty:Er,_getMatrix:Lr}};mn.utils.checkPrefix=Ar,Jr=_e((Wr="x,y,z,scale,scaleX,scaleY,xPercent,yPercent")+","+(Xr="rotation,rotationX,rotationY,skewX,skewY")+",transform,transformOrigin,svgOrigin,force3D,smoothOrigin,transformPerspective",(function(e){Gn[e]=1})),_e(Xr,(function(e){N.units[e]="deg",Nr[e]=1})),Yn[Jr[13]]=Wr+","+Xr,_e("0:translateX,1:translateY,2:translateZ,8:rotate,8:rotationZ,8:rotateZ,9:rotateX,10:rotateY",(function(e){var t=e.split(":");Yn[t[1]]=Jr[t[0]]})),_e("x,y,z,top,right,bottom,left,width,height,fontSize,padding,margin,perspective",(function(e){N.units[e]="px"})),mn.registerPlugin(Yr);var Zr=mn.registerPlugin(Yr)||mn,$r=Zr.core.Tween;e.Back=Pn,e.Bounce=Hn,e.CSSPlugin=Yr,e.Circ=Qn,e.Cubic=Mn,e.Elastic=Dn,e.Expo=Vn,e.Linear=Nn,e.Power0=Rn,e.Power1=Cn,e.Power2=In,e.Power3=xn,e.Power4=On,e.Quad=Bn,e.Quart=Ln,e.Quint=kn,e.Sine=jn,e.SteppedEase=Fn,e.Strong=Un,e.TimelineLite=Gt,e.TimelineMax=Gt,e.TweenLite=$t,e.TweenMax=$r,e.default=Zr,e.gsap=Zr,"undefined"==typeof window||window!==e?Object.defineProperty(e,"__esModule",{value:!0}):delete window.default})),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.QRious=t()}(this,(function(){"use strict";var e=function(){},t=Object.prototype.hasOwnProperty,n=Array.prototype.slice;function r(e,r,i){for(var o,a,s=0,c=(i=n.call(arguments,2)).length;s<c;s++)for(o in a=i[s])e&&!t.call(a,o)||(r[o]=a[o])}var i=function(t,n,i,o){var a=this;return"string"!=typeof t&&(o=i,i=n,n=t,t=null),"function"!=typeof n&&(o=i,i=n,n=function(){return a.apply(this,arguments)}),r(!1,n,a,o),n.prototype=function(t,n){var i;return"function"==typeof Object.create?i=Object.create(t):(e.prototype=t,i=new e,e.prototype=null),n&&r(!0,i,n),i}(a.prototype,i),n.prototype.constructor=n,n.class_=t||a.class_,n.super_=a,n};function o(){}o.class_="Nevis",o.super_=Object,o.extend=i;var a=o,s=a.extend((function(e,t,n){this.qrious=e,this.element=t,this.element.qrious=e,this.enabled=Boolean(n)}),{draw:function(e){},getElement:function(){return this.enabled||(this.enabled=!0,this.render()),this.element},getModuleSize:function(e){var t=this.qrious,n=t.padding||0,r=Math.floor((t.size-2*n)/e.width);return Math.max(1,r)},getOffset:function(e){var t=this.qrious,n=t.padding;if(null!=n)return n;var r=this.getModuleSize(e),i=Math.floor((t.size-r*e.width)/2);return Math.max(0,i)},render:function(e){this.enabled&&(this.resize(),this.reset(),this.draw(e))},reset:function(){},resize:function(){}}),c=s.extend({draw:function(e){var t,n,r=this.qrious,i=this.getModuleSize(e),o=this.getOffset(e),a=this.element.getContext("2d");for(a.fillStyle=r.foreground,a.globalAlpha=r.foregroundAlpha,t=0;t<e.width;t++)for(n=0;n<e.width;n++)e.buffer[n*e.width+t]&&a.fillRect(i*t+o,i*n+o,i,i)},reset:function(){var e=this.qrious,t=this.element.getContext("2d"),n=e.size;t.lineWidth=1,t.clearRect(0,0,n,n),t.fillStyle=e.background,t.globalAlpha=e.backgroundAlpha,t.fillRect(0,0,n,n)},resize:function(){var e=this.element;e.width=e.height=this.qrious.size}}),u=a.extend(null,{BLOCK:[0,11,15,19,23,27,31,16,18,20,22,24,26,28,20,22,24,24,26,28,28,22,24,24,26,26,28,28,24,24,26,26,26,28,28,24,26,26,26,28,28]}),l=a.extend(null,{BLOCKS:[1,0,19,7,1,0,16,10,1,0,13,13,1,0,9,17,1,0,34,10,1,0,28,16,1,0,22,22,1,0,16,28,1,0,55,15,1,0,44,26,2,0,17,18,2,0,13,22,1,0,80,20,2,0,32,18,2,0,24,26,4,0,9,16,1,0,108,26,2,0,43,24,2,2,15,18,2,2,11,22,2,0,68,18,4,0,27,16,4,0,19,24,4,0,15,28,2,0,78,20,4,0,31,18,2,4,14,18,4,1,13,26,2,0,97,24,2,2,38,22,4,2,18,22,4,2,14,26,2,0,116,30,3,2,36,22,4,4,16,20,4,4,12,24,2,2,68,18,4,1,43,26,6,2,19,24,6,2,15,28,4,0,81,20,1,4,50,30,4,4,22,28,3,8,12,24,2,2,92,24,6,2,36,22,4,6,20,26,7,4,14,28,4,0,107,26,8,1,37,22,8,4,20,24,12,4,11,22,3,1,115,30,4,5,40,24,11,5,16,20,11,5,12,24,5,1,87,22,5,5,41,24,5,7,24,30,11,7,12,24,5,1,98,24,7,3,45,28,15,2,19,24,3,13,15,30,1,5,107,28,10,1,46,28,1,15,22,28,2,17,14,28,5,1,120,30,9,4,43,26,17,1,22,28,2,19,14,28,3,4,113,28,3,11,44,26,17,4,21,26,9,16,13,26,3,5,107,28,3,13,41,26,15,5,24,30,15,10,15,28,4,4,116,28,17,0,42,26,17,6,22,28,19,6,16,30,2,7,111,28,17,0,46,28,7,16,24,30,34,0,13,24,4,5,121,30,4,14,47,28,11,14,24,30,16,14,15,30,6,4,117,30,6,14,45,28,11,16,24,30,30,2,16,30,8,4,106,26,8,13,47,28,7,22,24,30,22,13,15,30,10,2,114,28,19,4,46,28,28,6,22,28,33,4,16,30,8,4,122,30,22,3,45,28,8,26,23,30,12,28,15,30,3,10,117,30,3,23,45,28,4,31,24,30,11,31,15,30,7,7,116,30,21,7,45,28,1,37,23,30,19,26,15,30,5,10,115,30,19,10,47,28,15,25,24,30,23,25,15,30,13,3,115,30,2,29,46,28,42,1,24,30,23,28,15,30,17,0,115,30,10,23,46,28,10,35,24,30,19,35,15,30,17,1,115,30,14,21,46,28,29,19,24,30,11,46,15,30,13,6,115,30,14,23,46,28,44,7,24,30,59,1,16,30,12,7,121,30,12,26,47,28,39,14,24,30,22,41,15,30,6,14,121,30,6,34,47,28,46,10,24,30,2,64,15,30,17,4,122,30,29,14,46,28,49,10,24,30,24,46,15,30,4,18,122,30,13,32,46,28,48,14,24,30,42,32,15,30,20,4,117,30,40,7,47,28,43,22,24,30,10,67,15,30,19,6,118,30,18,31,47,28,34,34,24,30,20,61,15,30],FINAL_FORMAT:[30660,29427,32170,30877,26159,25368,27713,26998,21522,20773,24188,23371,17913,16590,20375,19104,13663,12392,16177,14854,9396,8579,11994,11245,5769,5054,7399,6608,1890,597,3340,2107],LEVELS:{L:1,M:2,Q:3,H:4}}),d=a.extend(null,{EXPONENT:[1,2,4,8,16,32,64,128,29,58,116,232,205,135,19,38,76,152,45,90,180,117,234,201,143,3,6,12,24,48,96,192,157,39,78,156,37,74,148,53,106,212,181,119,238,193,159,35,70,140,5,10,20,40,80,160,93,186,105,210,185,111,222,161,95,190,97,194,153,47,94,188,101,202,137,15,30,60,120,240,253,231,211,187,107,214,177,127,254,225,223,163,91,182,113,226,217,175,67,134,17,34,68,136,13,26,52,104,208,189,103,206,129,31,62,124,248,237,199,147,59,118,236,197,151,51,102,204,133,23,46,92,184,109,218,169,79,158,33,66,132,21,42,84,168,77,154,41,82,164,85,170,73,146,57,114,228,213,183,115,230,209,191,99,198,145,63,126,252,229,215,179,123,246,241,255,227,219,171,75,150,49,98,196,149,55,110,220,165,87,174,65,130,25,50,100,200,141,7,14,28,56,112,224,221,167,83,166,81,162,89,178,121,242,249,239,195,155,43,86,172,69,138,9,18,36,72,144,61,122,244,245,247,243,251,235,203,139,11,22,44,88,176,125,250,233,207,131,27,54,108,216,173,71,142,0],LOG:[255,0,1,25,2,50,26,198,3,223,51,238,27,104,199,75,4,100,224,14,52,141,239,129,28,193,105,248,200,8,76,113,5,138,101,47,225,36,15,33,53,147,142,218,240,18,130,69,29,181,194,125,106,39,249,185,201,154,9,120,77,228,114,166,6,191,139,98,102,221,48,253,226,152,37,179,16,145,34,136,54,208,148,206,143,150,219,189,241,210,19,92,131,56,70,64,30,66,182,163,195,72,126,110,107,58,40,84,250,133,186,61,202,94,155,159,10,21,121,43,78,212,229,172,115,243,167,87,7,112,192,247,140,128,99,13,103,74,222,237,49,197,254,24,227,165,153,119,38,184,180,124,17,68,146,217,35,32,137,46,55,63,209,91,149,188,207,205,144,135,151,178,220,252,190,97,242,86,211,171,20,42,93,158,132,60,57,83,71,109,65,162,31,45,67,216,183,123,164,118,196,23,73,236,127,12,111,246,108,161,59,82,41,157,85,170,251,96,134,177,187,204,62,90,203,89,95,176,156,169,160,81,11,245,22,235,122,117,44,215,79,174,213,233,230,231,173,232,116,214,244,234,168,80,88,175]}),h=a.extend(null,{BLOCK:[3220,1468,2713,1235,3062,1890,2119,1549,2344,2936,1117,2583,1330,2470,1667,2249,2028,3780,481,4011,142,3098,831,3445,592,2517,1776,2234,1951,2827,1070,2660,1345,3177]}),f=a.extend((function(e){var t,n,r,i,o,a=e.value.length;for(this._badness=[],this._level=l.LEVELS[e.level],this._polynomial=[],this._value=e.value,this._version=0,this._stringBuffer=[];this._version<40&&(this._version++,r=4*(this._level-1)+16*(this._version-1),i=l.BLOCKS[r++],o=l.BLOCKS[r++],t=l.BLOCKS[r++],n=l.BLOCKS[r],!(a<=(r=t*(i+o)+o-3+(this._version<=9)))););this._dataBlock=t,this._eccBlock=n,this._neccBlock1=i,this._neccBlock2=o;var s=this.width=17+4*this._version;this.buffer=f._createArray(s*s),this._ecc=f._createArray(t+(t+n)*(i+o)+o),this._mask=f._createArray((s*(s+1)+1)/2),this._insertFinders(),this._insertAlignments(),this.buffer[8+s*(s-8)]=1,this._insertTimingGap(),this._reverseMask(),this._insertTimingRowAndColumn(),this._insertVersion(),this._syncMask(),this._convertBitStream(a),this._calculatePolynomial(),this._appendEccToData(),this._interleaveBlocks(),this._pack(),this._finish()}),{_addAlignment:function(e,t){var n,r=this.buffer,i=this.width;for(r[e+i*t]=1,n=-2;n<2;n++)r[e+n+i*(t-2)]=1,r[e-2+i*(t+n+1)]=1,r[e+2+i*(t+n)]=1,r[e+n+1+i*(t+2)]=1;for(n=0;n<2;n++)this._setMask(e-1,t+n),this._setMask(e+1,t-n),this._setMask(e-n,t-1),this._setMask(e+n,t+1)},_appendData:function(e,t,n,r){var i,o,a,s=this._polynomial,c=this._stringBuffer;for(o=0;o<r;o++)c[n+o]=0;for(o=0;o<t;o++){if(255!==(i=d.LOG[c[e+o]^c[n]]))for(a=1;a<r;a++)c[n+a-1]=c[n+a]^d.EXPONENT[f._modN(i+s[r-a])];else for(a=n;a<n+r;a++)c[a]=c[a+1];c[n+r-1]=255===i?0:d.EXPONENT[f._modN(i+s[0])]}},_appendEccToData:function(){var e,t=0,n=this._dataBlock,r=this._calculateMaxLength(),i=this._eccBlock;for(e=0;e<this._neccBlock1;e++)this._appendData(t,n,r,i),t+=n,r+=i;for(e=0;e<this._neccBlock2;e++)this._appendData(t,n+1,r,i),t+=n+1,r+=i},_applyMask:function(e){var t,n,r,i,o=this.buffer,a=this.width;switch(e){case 0:for(i=0;i<a;i++)for(r=0;r<a;r++)r+i&1||this._isMasked(r,i)||(o[r+i*a]^=1);break;case 1:for(i=0;i<a;i++)for(r=0;r<a;r++)1&i||this._isMasked(r,i)||(o[r+i*a]^=1);break;case 2:for(i=0;i<a;i++)for(t=0,r=0;r<a;r++,t++)3===t&&(t=0),t||this._isMasked(r,i)||(o[r+i*a]^=1);break;case 3:for(n=0,i=0;i<a;i++,n++)for(3===n&&(n=0),t=n,r=0;r<a;r++,t++)3===t&&(t=0),t||this._isMasked(r,i)||(o[r+i*a]^=1);break;case 4:for(i=0;i<a;i++)for(t=0,n=i>>1&1,r=0;r<a;r++,t++)3===t&&(t=0,n=!n),n||this._isMasked(r,i)||(o[r+i*a]^=1);break;case 5:for(n=0,i=0;i<a;i++,n++)for(3===n&&(n=0),t=0,r=0;r<a;r++,t++)3===t&&(t=0),(r&i&1)+!(!t|!n)||this._isMasked(r,i)||(o[r+i*a]^=1);break;case 6:for(n=0,i=0;i<a;i++,n++)for(3===n&&(n=0),t=0,r=0;r<a;r++,t++)3===t&&(t=0),(r&i&1)+(t&&t===n)&1||this._isMasked(r,i)||(o[r+i*a]^=1);break;case 7:for(n=0,i=0;i<a;i++,n++)for(3===n&&(n=0),t=0,r=0;r<a;r++,t++)3===t&&(t=0),(t&&t===n)+(r+i&1)&1||this._isMasked(r,i)||(o[r+i*a]^=1)}},_calculateMaxLength:function(){return this._dataBlock*(this._neccBlock1+this._neccBlock2)+this._neccBlock2},_calculatePolynomial:function(){var e,t,n=this._eccBlock,r=this._polynomial;for(r[0]=1,e=0;e<n;e++){for(r[e+1]=1,t=e;t>0;t--)r[t]=r[t]?r[t-1]^d.EXPONENT[f._modN(d.LOG[r[t]]+e)]:r[t-1];r[0]=d.EXPONENT[f._modN(d.LOG[r[0]]+e)]}for(e=0;e<=n;e++)r[e]=d.LOG[r[e]]},_checkBadness:function(){var e,t,n,r,i,o=0,a=this._badness,s=this.buffer,c=this.width;for(i=0;i<c-1;i++)for(r=0;r<c-1;r++)(s[r+c*i]&&s[r+1+c*i]&&s[r+c*(i+1)]&&s[r+1+c*(i+1)]||!(s[r+c*i]||s[r+1+c*i]||s[r+c*(i+1)]||s[r+1+c*(i+1)]))&&(o+=f.N2);var u=0;for(i=0;i<c;i++){for(n=0,a[0]=0,e=0,r=0;r<c;r++)e===(t=s[r+c*i])?a[n]++:a[++n]=1,u+=(e=t)?1:-1;o+=this._getBadness(n)}u<0&&(u=-u);var l=0,d=u;for(d+=d<<2,d<<=1;d>c*c;)d-=c*c,l++;for(o+=l*f.N4,r=0;r<c;r++){for(n=0,a[0]=0,e=0,i=0;i<c;i++)e===(t=s[r+c*i])?a[n]++:a[++n]=1,e=t;o+=this._getBadness(n)}return o},_convertBitStream:function(e){var t,n,r=this._ecc,i=this._version;for(n=0;n<e;n++)r[n]=this._value.charCodeAt(n);var o=this._stringBuffer=r.slice(),a=this._calculateMaxLength();e>=a-2&&(e=a-2,i>9&&e--);var s=e;if(i>9){for(o[s+2]=0,o[s+3]=0;s--;)t=o[s],o[s+3]|=255&t<<4,o[s+2]=t>>4;o[2]|=255&e<<4,o[1]=e>>4,o[0]=64|e>>12}else{for(o[s+1]=0,o[s+2]=0;s--;)t=o[s],o[s+2]|=255&t<<4,o[s+1]=t>>4;o[1]|=255&e<<4,o[0]=64|e>>4}for(s=e+3-(i<10);s<a;)o[s++]=236,o[s++]=17},_getBadness:function(e){var t,n=0,r=this._badness;for(t=0;t<=e;t++)r[t]>=5&&(n+=f.N1+r[t]-5);for(t=3;t<e-1;t+=2)r[t-2]===r[t+2]&&r[t+2]===r[t-1]&&r[t-1]===r[t+1]&&3*r[t-1]===r[t]&&(0===r[t-3]||t+3>e||3*r[t-3]>=4*r[t]||3*r[t+3]>=4*r[t])&&(n+=f.N3);return n},_finish:function(){var e,t;this._stringBuffer=this.buffer.slice();var n=0,r=3e4;for(t=0;t<8&&(this._applyMask(t),(e=this._checkBadness())<r&&(r=e,n=t),7!==n);t++)this.buffer=this._stringBuffer.slice();n!==t&&this._applyMask(n),r=l.FINAL_FORMAT[n+(this._level-1<<3)];var i=this.buffer,o=this.width;for(t=0;t<8;t++,r>>=1)1&r&&(i[o-1-t+8*o]=1,t<6?i[8+o*t]=1:i[8+o*(t+1)]=1);for(t=0;t<7;t++,r>>=1)1&r&&(i[8+o*(o-7+t)]=1,t?i[6-t+8*o]=1:i[7+8*o]=1)},_interleaveBlocks:function(){var e,t,n=this._dataBlock,r=this._ecc,i=this._eccBlock,o=0,a=this._calculateMaxLength(),s=this._neccBlock1,c=this._neccBlock2,u=this._stringBuffer;for(e=0;e<n;e++){for(t=0;t<s;t++)r[o++]=u[e+t*n];for(t=0;t<c;t++)r[o++]=u[s*n+e+t*(n+1)]}for(t=0;t<c;t++)r[o++]=u[s*n+e+t*(n+1)];for(e=0;e<i;e++)for(t=0;t<s+c;t++)r[o++]=u[a+e+t*i];this._stringBuffer=r},_insertAlignments:function(){var e,t,n,r=this._version,i=this.width;if(r>1)for(e=u.BLOCK[r],n=i-7;;){for(t=i-7;t>e-3&&(this._addAlignment(t,n),!(t<e));)t-=e;if(n<=e+9)break;n-=e,this._addAlignment(6,n),this._addAlignment(n,6)}},_insertFinders:function(){var e,t,n,r,i=this.buffer,o=this.width;for(e=0;e<3;e++){for(t=0,r=0,1===e&&(t=o-7),2===e&&(r=o-7),i[r+3+o*(t+3)]=1,n=0;n<6;n++)i[r+n+o*t]=1,i[r+o*(t+n+1)]=1,i[r+6+o*(t+n)]=1,i[r+n+1+o*(t+6)]=1;for(n=1;n<5;n++)this._setMask(r+n,t+1),this._setMask(r+1,t+n+1),this._setMask(r+5,t+n),this._setMask(r+n+1,t+5);for(n=2;n<4;n++)i[r+n+o*(t+2)]=1,i[r+2+o*(t+n+1)]=1,i[r+4+o*(t+n)]=1,i[r+n+1+o*(t+4)]=1}},_insertTimingGap:function(){var e,t,n=this.width;for(t=0;t<7;t++)this._setMask(7,t),this._setMask(n-8,t),this._setMask(7,t+n-7);for(e=0;e<8;e++)this._setMask(e,7),this._setMask(e+n-8,7),this._setMask(e,n-8)},_insertTimingRowAndColumn:function(){var e,t=this.buffer,n=this.width;for(e=0;e<n-14;e++)1&e?(this._setMask(8+e,6),this._setMask(6,8+e)):(t[8+e+6*n]=1,t[6+n*(8+e)]=1)},_insertVersion:function(){var e,t,n,r,i=this.buffer,o=this._version,a=this.width;if(o>6)for(e=h.BLOCK[o-7],t=17,n=0;n<6;n++)for(r=0;r<3;r++,t--)1&(t>11?o>>t-12:e>>t)?(i[5-n+a*(2-r+a-11)]=1,i[2-r+a-11+a*(5-n)]=1):(this._setMask(5-n,2-r+a-11),this._setMask(2-r+a-11,5-n))},_isMasked:function(e,t){var n=f._getMaskBit(e,t);return 1===this._mask[n]},_pack:function(){var e,t,n,r=1,i=1,o=this.width,a=o-1,s=o-1,c=(this._dataBlock+this._eccBlock)*(this._neccBlock1+this._neccBlock2)+this._neccBlock2;for(t=0;t<c;t++)for(e=this._stringBuffer[t],n=0;n<8;n++,e<<=1){128&e&&(this.buffer[a+o*s]=1);do{i?a--:(a++,r?0!==s?s--:(r=!r,6===(a-=2)&&(a--,s=9)):s!==o-1?s++:(r=!r,6===(a-=2)&&(a--,s-=8))),i=!i}while(this._isMasked(a,s))}},_reverseMask:function(){var e,t,n=this.width;for(e=0;e<9;e++)this._setMask(e,8);for(e=0;e<8;e++)this._setMask(e+n-8,8),this._setMask(8,e);for(t=0;t<7;t++)this._setMask(8,t+n-7)},_setMask:function(e,t){var n=f._getMaskBit(e,t);this._mask[n]=1},_syncMask:function(){var e,t,n=this.width;for(t=0;t<n;t++)for(e=0;e<=t;e++)this.buffer[e+n*t]&&this._setMask(e,t)}},{_createArray:function(e){var t,n=[];for(t=0;t<e;t++)n[t]=0;return n},_getMaskBit:function(e,t){var n;return e>t&&(n=e,e=t,t=n),n=t,n+=t*t,n>>=1,n+=e},_modN:function(e){for(;e>=255;)e=((e-=255)>>8)+(255&e);return e},N1:3,N2:3,N3:40,N4:10}),p=f,A=s.extend({draw:function(){this.element.src=this.qrious.toDataURL()},reset:function(){this.element.src=""},resize:function(){var e=this.element;e.width=e.height=this.qrious.size}}),g=a.extend((function(e,t,n,r){this.name=e,this.modifiable=Boolean(t),this.defaultValue=n,this._valueTransformer=r}),{transform:function(e){var t=this._valueTransformer;return"function"==typeof t?t(e,this):e}}),v=a.extend(null,{abs:function(e){return null!=e?Math.abs(e):null},hasOwn:function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},noop:function(){},toUpperCase:function(e){return null!=e?e.toUpperCase():null}}),m=a.extend((function(e){this.options={},e.forEach((function(e){this.options[e.name]=e}),this)}),{exists:function(e){return null!=this.options[e]},get:function(e,t){return m._get(this.options[e],t)},getAll:function(e){var t,n=this.options,r={};for(t in n)v.hasOwn(n,t)&&(r[t]=m._get(n[t],e));return r},init:function(e,t,n){var r,i;for(r in"function"!=typeof n&&(n=v.noop),this.options)v.hasOwn(this.options,r)&&(i=this.options[r],m._set(i,i.defaultValue,t),m._createAccessor(i,t,n));this._setAll(e,t,!0)},set:function(e,t,n){return this._set(e,t,n)},setAll:function(e,t){return this._setAll(e,t)},_set:function(e,t,n,r){var i=this.options[e];if(!i)throw new Error("Invalid option: "+e);if(!i.modifiable&&!r)throw new Error("Option cannot be modified: "+e);return m._set(i,t,n)},_setAll:function(e,t,n){if(!e)return!1;var r,i=!1;for(r in e)v.hasOwn(e,r)&&this._set(r,e[r],t,n)&&(i=!0);return i}},{_createAccessor:function(e,t,n){var r={get:function(){return m._get(e,t)}};e.modifiable&&(r.set=function(r){m._set(e,r,t)&&n(r,e)}),Object.defineProperty(t,e.name,r)},_get:function(e,t){return t["_"+e.name]},_set:function(e,t,n){var r="_"+e.name,i=n[r],o=e.transform(null!=t?t:e.defaultValue);return n[r]=o,o!==i}}),y=m,b=a.extend((function(){this._services={}}),{getService:function(e){var t=this._services[e];if(!t)throw new Error("Service is not being managed with name: "+e);return t},setService:function(e,t){if(this._services[e])throw new Error("Service is already managed with name: "+e);t&&(this._services[e]=t)}}),E=new y([new g("background",!0,"white"),new g("backgroundAlpha",!0,1,v.abs),new g("element"),new g("foreground",!0,"black"),new g("foregroundAlpha",!0,1,v.abs),new g("level",!0,"L",v.toUpperCase),new g("mime",!0,"image/png"),new g("padding",!0,null,v.abs),new g("size",!0,100,v.abs),new g("value",!0,"")]),_=new b,w=a.extend((function(e){E.init(e,this,this.update.bind(this));var t=E.get("element",this),n=_.getService("element"),r=t&&n.isCanvas(t)?t:n.createCanvas(),i=t&&n.isImage(t)?t:n.createImage();this._canvasRenderer=new c(this,r,!0),this._imageRenderer=new A(this,i,i===t),this.update()}),{get:function(){return E.getAll(this)},set:function(e){E.setAll(e,this)&&this.update()},toDataURL:function(e){return this.canvas.toDataURL(e||this.mime)},update:function(){var e=new p({level:this.level,value:this.value});this._canvasRenderer.render(e),this._imageRenderer.render(e)}},{use:function(e){_.setService(e.getName(),e)}});Object.defineProperties(w.prototype,{canvas:{get:function(){return this._canvasRenderer.getElement()}},image:{get:function(){return this._imageRenderer.getElement()}}});var S=w,T=a.extend({getName:function(){}}).extend({createCanvas:function(){},createImage:function(){},getName:function(){return"element"},isCanvas:function(e){},isImage:function(e){}}).extend({createCanvas:function(){return document.createElement("canvas")},createImage:function(){return document.createElement("img")},isCanvas:function(e){return e instanceof HTMLCanvasElement},isImage:function(e){return e instanceof HTMLImageElement}});return S.use(new T),S})),
/*!
 * html2canvas 1.0.0-rc.7 <https://html2canvas.hertzen.com>
 * Copyright (c) 2020 Niklas von Hertzen <https://hertzen.com>
 * Released under MIT License
 */
function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).html2canvas=t()}(this,(function(){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};function t(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}var n=function(){return(n=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function r(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){e.done?i(e.value):new n((function(t){t(e.value)})).then(a,s)}c((r=r.apply(e,t||[])).next())}))}function i(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}for(var o=function(){function e(e,t,n,r){this.left=e,this.top=t,this.width=n,this.height=r}return e.prototype.add=function(t,n,r,i){return new e(this.left+t,this.top+n,this.width+r,this.height+i)},e.fromClientRect=function(t){return new e(t.left,t.top,t.width,t.height)},e}(),a=function(e){return o.fromClientRect(e.getBoundingClientRect())},s=function(e){for(var t=[],n=0,r=e.length;n<r;){var i=e.charCodeAt(n++);if(i>=55296&&i<=56319&&n<r){var o=e.charCodeAt(n++);56320==(64512&o)?t.push(((1023&i)<<10)+(1023&o)+65536):(t.push(i),n--)}else t.push(i)}return t},c=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(String.fromCodePoint)return String.fromCodePoint.apply(String,e);var n=e.length;if(!n)return"";for(var r=[],i=-1,o="";++i<n;){var a=e[i];a<=65535?r.push(a):(a-=65536,r.push(55296+(a>>10),a%1024+56320)),(i+1===n||r.length>16384)&&(o+=String.fromCharCode.apply(String,r),r.length=0)}return o},u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",l="undefined"==typeof Uint8Array?[]:new Uint8Array(256),d=0;d<u.length;d++)l[u.charCodeAt(d)]=d;var h,f=function(e,t,n){return e.slice?e.slice(t,n):new Uint16Array(Array.prototype.slice.call(e,t,n))},p=function(){function e(e,t,n,r,i,o){this.initialValue=e,this.errorValue=t,this.highStart=n,this.highValueIndex=r,this.index=i,this.data=o}return e.prototype.get=function(e){var t;if(e>=0){if(e<55296||e>56319&&e<=65535)return t=((t=this.index[e>>5])<<2)+(31&e),this.data[t];if(e<=65535)return t=((t=this.index[2048+(e-55296>>5)])<<2)+(31&e),this.data[t];if(e<this.highStart)return t=2080+(e>>11),t=this.index[t],t+=e>>5&63,t=((t=this.index[t])<<2)+(31&e),this.data[t];if(e<=1114111)return this.data[this.highValueIndex]}return this.errorValue},e}(),A=10,g=13,v=15,m=17,y=18,b=19,E=20,_=21,w=22,S=24,T=25,R=26,C=27,I=28,x=30,O=32,N=33,B=34,M=35,L=37,k=38,U=39,D=40,P=42,F="×",H="÷",j=function(e){var t,n,r,i=function(e){var t,n,r,i,o,a=.75*e.length,s=e.length,c=0;"="===e[e.length-1]&&(a--,"="===e[e.length-2]&&a--);var u="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array&&void 0!==Uint8Array.prototype.slice?new ArrayBuffer(a):new Array(a),d=Array.isArray(u)?u:new Uint8Array(u);for(t=0;t<s;t+=4)n=l[e.charCodeAt(t)],r=l[e.charCodeAt(t+1)],i=l[e.charCodeAt(t+2)],o=l[e.charCodeAt(t+3)],d[c++]=n<<2|r>>4,d[c++]=(15&r)<<4|i>>2,d[c++]=(3&i)<<6|63&o;return u}(e),o=Array.isArray(i)?function(e){for(var t=e.length,n=[],r=0;r<t;r+=4)n.push(e[r+3]<<24|e[r+2]<<16|e[r+1]<<8|e[r]);return n}(i):new Uint32Array(i),a=Array.isArray(i)?function(e){for(var t=e.length,n=[],r=0;r<t;r+=2)n.push(e[r+1]<<8|e[r]);return n}(i):new Uint16Array(i),s=f(a,12,o[4]/2),c=2===o[5]?f(a,(24+o[4])/2):(t=o,n=Math.ceil((24+o[4])/4),t.slice?t.slice(n,r):new Uint32Array(Array.prototype.slice.call(t,n,r)));return new p(o[0],o[1],o[2],o[3],s,c)}("KwAAAAAAAAAACA4AIDoAAPAfAAACAAAAAAAIABAAGABAAEgAUABYAF4AZgBeAGYAYABoAHAAeABeAGYAfACEAIAAiACQAJgAoACoAK0AtQC9AMUAXgBmAF4AZgBeAGYAzQDVAF4AZgDRANkA3gDmAOwA9AD8AAQBDAEUARoBIgGAAIgAJwEvATcBPwFFAU0BTAFUAVwBZAFsAXMBewGDATAAiwGTAZsBogGkAawBtAG8AcIBygHSAdoB4AHoAfAB+AH+AQYCDgIWAv4BHgImAi4CNgI+AkUCTQJTAlsCYwJrAnECeQKBAk0CiQKRApkCoQKoArACuALAAsQCzAIwANQC3ALkAjAA7AL0AvwCAQMJAxADGAMwACADJgMuAzYDPgOAAEYDSgNSA1IDUgNaA1oDYANiA2IDgACAAGoDgAByA3YDfgOAAIQDgACKA5IDmgOAAIAAogOqA4AAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAK8DtwOAAIAAvwPHA88D1wPfAyAD5wPsA/QD/AOAAIAABAQMBBIEgAAWBB4EJgQuBDMEIAM7BEEEXgBJBCADUQRZBGEEaQQwADAAcQQ+AXkEgQSJBJEEgACYBIAAoASoBK8EtwQwAL8ExQSAAIAAgACAAIAAgACgAM0EXgBeAF4AXgBeAF4AXgBeANUEXgDZBOEEXgDpBPEE+QQBBQkFEQUZBSEFKQUxBTUFPQVFBUwFVAVcBV4AYwVeAGsFcwV7BYMFiwWSBV4AmgWgBacFXgBeAF4AXgBeAKsFXgCyBbEFugW7BcIFwgXIBcIFwgXQBdQF3AXkBesF8wX7BQMGCwYTBhsGIwYrBjMGOwZeAD8GRwZNBl4AVAZbBl4AXgBeAF4AXgBeAF4AXgBeAF4AXgBeAGMGXgBqBnEGXgBeAF4AXgBeAF4AXgBeAF4AXgB5BoAG4wSGBo4GkwaAAIADHgR5AF4AXgBeAJsGgABGA4AAowarBrMGswagALsGwwbLBjAA0wbaBtoG3QbaBtoG2gbaBtoG2gblBusG8wb7BgMHCwcTBxsHCwcjBysHMAc1BzUHOgdCB9oGSgdSB1oHYAfaBloHaAfaBlIH2gbaBtoG2gbaBtoG2gbaBjUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHbQdeAF4ANQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQd1B30HNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1B4MH2gaKB68EgACAAIAAgACAAIAAgACAAI8HlwdeAJ8HpweAAIAArwe3B14AXgC/B8UHygcwANAH2AfgB4AA6AfwBz4B+AcACFwBCAgPCBcIogEYAR8IJwiAAC8INwg/CCADRwhPCFcIXwhnCEoDGgSAAIAAgABvCHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIhAiLCI4IMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAJYIlgiWCJYIlgiWCJYIlgiWCJYIlgiWCJYIlgiWCJYIlgiWCJYIlgiWCJYIlgiWCJYIlgiWCJYIlgiWCJYIlggwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAANQc1BzUHNQc1BzUHNQc1BzUHNQc1B54INQc1B6II2gaqCLIIugiAAIAAvgjGCIAAgACAAIAAgACAAIAAgACAAIAAywiHAYAA0wiAANkI3QjlCO0I9Aj8CIAAgACAAAIJCgkSCRoJIgknCTYHLwk3CZYIlgiWCJYIlgiWCJYIlgiWCJYIlgiWCJYIlgiWCJYIlgiWCJYIlgiWCJYIlgiWCJYIlgiWCJYIlgiWCJYIlgiAAIAAAAFAAXgBeAGAAcABeAHwAQACQAKAArQC9AJ4AXgBeAE0A3gBRAN4A7AD8AMwBGgEAAKcBNwEFAUwBXAF4QkhCmEKnArcCgAHHAsABz4LAAcABwAHAAd+C6ABoAG+C/4LAAcABwAHAAc+DF4MAAcAB54M3gweDV4Nng3eDaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAEeDqABVg6WDqABoQ6gAaABoAHXDvcONw/3DvcO9w73DvcO9w73DvcO9w73DvcO9w73DvcO9w73DvcO9w73DvcO9w73DvcO9w73DvcO9w73DvcO9w73DncPAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcAB7cPPwlGCU4JMACAAIAAgABWCV4JYQmAAGkJcAl4CXwJgAkwADAAMAAwAIgJgACLCZMJgACZCZ8JowmrCYAAswkwAF4AXgB8AIAAuwkABMMJyQmAAM4JgADVCTAAMAAwADAAgACAAIAAgACAAIAAgACAAIAAqwYWBNkIMAAwADAAMADdCeAJ6AnuCR4E9gkwAP4JBQoNCjAAMACAABUK0wiAAB0KJAosCjQKgAAwADwKQwqAAEsKvQmdCVMKWwowADAAgACAALcEMACAAGMKgABrCjAAMAAwADAAMAAwADAAMAAwADAAMAAeBDAAMAAwADAAMAAwADAAMAAwADAAMAAwAIkEPQFzCnoKiQSCCooKkAqJBJgKoAqkCokEGAGsCrQKvArBCjAAMADJCtEKFQHZCuEK/gHpCvEKMAAwADAAMACAAIwE+QowAIAAPwEBCzAAMAAwADAAMACAAAkLEQswAIAAPwEZCyELgAAOCCkLMAAxCzkLMAAwADAAMAAwADAAXgBeAEELMAAwADAAMAAwADAAMAAwAEkLTQtVC4AAXAtkC4AAiQkwADAAMAAwADAAMAAwADAAbAtxC3kLgAuFC4sLMAAwAJMLlwufCzAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAApwswADAAMACAAIAAgACvC4AAgACAAIAAgACAALcLMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAvwuAAMcLgACAAIAAgACAAIAAyguAAIAAgACAAIAA0QswADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAANkLgACAAIAA4AswADAAMAAwADAAMAAwADAAMAAwADAAMAAwAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACJCR4E6AswADAAhwHwC4AA+AsADAgMEAwwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMACAAIAAGAwdDCUMMAAwAC0MNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQw1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHPQwwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADUHNQc1BzUHNQc1BzUHNQc2BzAAMAA5DDUHNQc1BzUHNQc1BzUHNQc1BzUHNQdFDDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAgACAAIAATQxSDFoMMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAF4AXgBeAF4AXgBeAF4AYgxeAGoMXgBxDHkMfwxeAIUMXgBeAI0MMAAwADAAMAAwAF4AXgCVDJ0MMAAwADAAMABeAF4ApQxeAKsMswy7DF4Awgy9DMoMXgBeAF4AXgBeAF4AXgBeAF4AXgDRDNkMeQBqCeAM3Ax8AOYM7Az0DPgMXgBeAF4AXgBeAF4AXgBeAF4AXgBeAF4AXgBeAF4AXgCgAAANoAAHDQ4NFg0wADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAeDSYNMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAIAAgACAAIAAgACAAC4NMABeAF4ANg0wADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAD4NRg1ODVYNXg1mDTAAbQ0wADAAMAAwADAAMAAwADAA2gbaBtoG2gbaBtoG2gbaBnUNeg3CBYANwgWFDdoGjA3aBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gaUDZwNpA2oDdoG2gawDbcNvw3HDdoG2gbPDdYN3A3fDeYN2gbsDfMN2gbaBvoN/g3aBgYODg7aBl4AXgBeABYOXgBeACUG2gYeDl4AJA5eACwO2w3aBtoGMQ45DtoG2gbaBtoGQQ7aBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gZJDjUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1B1EO2gY1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQdZDjUHNQc1BzUHNQc1B2EONQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHaA41BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1B3AO2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gY1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1B2EO2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gZJDtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBkkOeA6gAKAAoAAwADAAMAAwAKAAoACgAKAAoACgAKAAgA4wADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAD//wQABAAEAAQABAAEAAQABAAEAA0AAwABAAEAAgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAKABMAFwAeABsAGgAeABcAFgASAB4AGwAYAA8AGAAcAEsASwBLAEsASwBLAEsASwBLAEsAGAAYAB4AHgAeABMAHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAFgAbABIAHgAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABYADQARAB4ABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAAUABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAkAFgAaABsAGwAbAB4AHQAdAB4ATwAXAB4ADQAeAB4AGgAbAE8ATwAOAFAAHQAdAB0ATwBPABcATwBPAE8AFgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAB4AUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAFAATwBAAE8ATwBPAEAATwBQAFAATwBQAB4AHgAeAB4AHgAeAB0AHQAdAB0AHgAdAB4ADgBQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgBQAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAkACQAJAAkACQAJAAkABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAFAAHgAeAB4AKwArAFAAUABQAFAAGABQACsAKwArACsAHgAeAFAAHgBQAFAAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUAAeAB4AHgAeAB4AHgArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAYAA0AKwArAB4AHgAbACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAB4ABAAEAB4ABAAEABMABAArACsAKwArACsAKwArACsAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAKwArACsAKwArAFYAVgBWAB4AHgArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AGgAaABoAGAAYAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQAEwAEACsAEwATAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABLAEsASwBLAEsASwBLAEsASwBLABoAGQAZAB4AUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABMAUAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABABQAFAABAAEAB4ABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUAAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAFAABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQAUABQAB4AHgAYABMAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAFAABAAEAAQABAAEAFAABAAEAAQAUAAEAAQABAAEAAQAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArACsAHgArAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABABQAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAABAAEAAQABAAEAAQABABQAFAAUABQAFAAUABQAFAAUABQAAQABAANAA0ASwBLAEsASwBLAEsASwBLAEsASwAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQAKwBQAFAAUABQAFAAUABQAFAAKwArAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUAArAFAAKwArACsAUABQAFAAUAArACsABABQAAQABAAEAAQABAAEAAQAKwArAAQABAArACsABAAEAAQAUAArACsAKwArACsAKwArACsABAArACsAKwArAFAAUAArAFAAUABQAAQABAArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAGgAaAFAAUABQAFAAUABMAB4AGwBQAB4AKwArACsABAAEAAQAKwBQAFAAUABQAFAAUAArACsAKwArAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUAArAFAAUAArAFAAUAArAFAAUAArACsABAArAAQABAAEAAQABAArACsAKwArAAQABAArACsABAAEAAQAKwArACsABAArACsAKwArACsAKwArAFAAUABQAFAAKwBQACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwAEAAQAUABQAFAABAArACsAKwArACsAKwArACsAKwArACsABAAEAAQAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUAArAFAAUAArAFAAUABQAFAAUAArACsABABQAAQABAAEAAQABAAEAAQABAArAAQABAAEACsABAAEAAQAKwArAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAAQABAArACsASwBLAEsASwBLAEsASwBLAEsASwAeABsAKwArACsAKwArACsAKwBQAAQABAAEAAQABAAEACsABAAEAAQAKwBQAFAAUABQAFAAUABQAFAAKwArAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQAKwArAAQABAArACsABAAEAAQAKwArACsAKwArACsAKwArAAQABAArACsAKwArAFAAUAArAFAAUABQAAQABAArACsASwBLAEsASwBLAEsASwBLAEsASwAeAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwAEAFAAKwBQAFAAUABQAFAAUAArACsAKwBQAFAAUAArAFAAUABQAFAAKwArACsAUABQACsAUAArAFAAUAArACsAKwBQAFAAKwArACsAUABQAFAAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAAQABAAEAAQAKwArACsABAAEAAQAKwAEAAQABAAEACsAKwBQACsAKwArACsAKwArAAQAKwArACsAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAB4AHgAeAB4AHgAeABsAHgArACsAKwArACsABAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAABAAEAAQABAAEAAQABAArAAQABAAEACsABAAEAAQABAArACsAKwArACsAKwArAAQABAArAFAAUABQACsAKwArACsAKwBQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAB4AUAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAArAAQABAAEACsABAAEAAQABAArACsAKwArACsAKwArAAQABAArACsAKwArACsAKwArAFAAKwBQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAFAABAAEAAQABAAEAAQABAArAAQABAAEACsABAAEAAQABABQAB4AKwArACsAKwBQAFAAUAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQABoAUABQAFAAUABQAFAAKwArAAQABAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQACsAUAArACsAUABQAFAAUABQAFAAUAArACsAKwAEACsAKwArACsABAAEAAQABAAEAAQAKwAEACsABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArAAQABAAeACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAXAAqACoAKgAqACoAKgAqACsAKwArACsAGwBcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAeAEsASwBLAEsASwBLAEsASwBLAEsADQANACsAKwArACsAKwBcAFwAKwBcACsAKwBcAFwAKwBcACsAKwBcACsAKwArACsAKwArAFwAXABcAFwAKwBcAFwAXABcAFwAXABcACsAXABcAFwAKwBcACsAXAArACsAXABcACsAXABcAFwAXAAqAFwAXAAqACoAKgAqACoAKgArACoAKgBcACsAKwBcAFwAXABcAFwAKwBcACsAKgAqACoAKgAqACoAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArAFwAXABcAFwAUAAOAA4ADgAOAB4ADgAOAAkADgAOAA0ACQATABMAEwATABMACQAeABMAHgAeAB4ABAAEAB4AHgAeAB4AHgAeAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUAANAAQAHgAEAB4ABAAWABEAFgARAAQABABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAANAAQABAAEAAQABAANAAQABABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsADQANAB4AHgAeAB4AHgAeAAQAHgAeAB4AHgAeAB4AKwAeAB4ADgAOAA0ADgAeAB4AHgAeAB4ACQAJACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqAFwASwBLAEsASwBLAEsASwBLAEsASwANAA0AHgAeAB4AHgBcAFwAXABcAFwAXAAqACoAKgAqAFwAXABcAFwAKgAqACoAXAAqACoAKgBcAFwAKgAqACoAKgAqACoAKgBcAFwAXAAqACoAKgAqAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAKgAqACoAKgAqACoAKgAqACoAXAAqAEsASwBLAEsASwBLAEsASwBLAEsAKgAqACoAKgAqACoAUABQAFAAUABQAFAAKwBQACsAKwArACsAKwBQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQACsAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwAEAAQABAAeAA0AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQACsAKwANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABYAEQArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAADQANAA0AUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAABAAEAAQAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAA0ADQArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQACsABAAEACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoADQANABUAXAANAB4ADQAbAFwAKgArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArAB4AHgATABMADQANAA4AHgATABMAHgAEAAQABAAJACsASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAUABQAFAAUABQAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABABQACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwAeACsAKwArABMAEwBLAEsASwBLAEsASwBLAEsASwBLAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAKwBcAFwAXABcAFwAKwArACsAKwArACsAKwArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBcACsAKwArACoAKgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEACsAKwAeAB4AXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAKgAqACoAKgAqACoAKgArACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgArACsABABLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKgAqACoAKgAqACoAKgBcACoAKgAqACoAKgAqACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQAUABQAFAAUABQAFAAUAArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsADQANAB4ADQANAA0ADQAeAB4AHgAeAB4AHgAeAB4AHgAeAAQABAAEAAQABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeACsAKwArAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAUABQAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAHgAeAB4AHgBQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwANAA0ADQANAA0ASwBLAEsASwBLAEsASwBLAEsASwArACsAKwBQAFAAUABLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAA0AUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsABAAEAAQAHgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAUABQAFAABABQAFAAUABQAAQABAAEAFAAUAAEAAQABAArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwAEAAQABAAEAAQAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUAArAFAAKwBQACsAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAHgAeAB4AHgAeAB4AHgAeAFAAHgAeAB4AUABQAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAKwArAB4AHgAeAB4AHgAeACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAUABQAFAAKwAeAB4AHgAeAB4AHgAeAA4AHgArAA0ADQANAA0ADQANAA0ACQANAA0ADQAIAAQACwAEAAQADQAJAA0ADQAMAB0AHQAeABcAFwAWABcAFwAXABYAFwAdAB0AHgAeABQAFAAUAA0AAQABAAQABAAEAAQABAAJABoAGgAaABoAGgAaABoAGgAeABcAFwAdABUAFQAeAB4AHgAeAB4AHgAYABYAEQAVABUAFQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgANAB4ADQANAA0ADQAeAA0ADQANAAcAHgAeAB4AHgArAAQABAAEAAQABAAEAAQABAAEAAQAUABQACsAKwBPAFAAUABQAFAAUAAeAB4AHgAWABEATwBQAE8ATwBPAE8AUABQAFAAUABQAB4AHgAeABYAEQArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAGwAbABsAGwAbABsAGwAaABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAaABsAGwAbABsAGgAbABsAGgAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAB4AHgBQABoAHgAdAB4AUAAeABoAHgAeAB4AHgAeAB4AHgAeAB4ATwAeAFAAGwAeAB4AUABQAFAAUABQAB4AHgAeAB0AHQAeAFAAHgBQAB4AUAAeAFAATwBQAFAAHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAB4AUABQAFAAUABPAE8AUABQAFAAUABQAE8AUABQAE8AUABPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBQAFAAUABQAE8ATwBPAE8ATwBPAE8ATwBPAE8AUABQAFAAUABQAFAAUABQAFAAHgAeAFAAUABQAFAATwAeAB4AKwArACsAKwAdAB0AHQAdAB0AHQAdAB0AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAeAB0AHQAeAB4AHgAdAB0AHgAeAB0AHgAeAB4AHQAeAB0AGwAbAB4AHQAeAB4AHgAeAB0AHgAeAB0AHQAdAB0AHgAeAB0AHgAdAB4AHQAdAB0AHQAdAB0AHgAdAB4AHgAeAB4AHgAdAB0AHQAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAdAB4AHgAeAB4AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB4AHgAdAB0AHQAdAB4AHgAdAB0AHgAeAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAeAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHQAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABQAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAlACUAHgAeAB4AHgAeAB4AHgAeAB4AFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBQAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB4AHgAeAB4AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAdAB0AHQAdAB0AHQAdAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAeAB0AHQAeAB4AHgAeAB0AHQAeAB4AHgAeAB0AHQAdAB4AHgAdAB4AHgAdAB0AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB0AHQAeAB4AHQAeAB4AHgAeAB0AHQAeAB4AHgAeACUAJQAdAB0AJQAeACUAJQAlACAAJQAlAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAHgAeAB4AHgAdAB4AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB4AHQAdAB0AHgAdACUAHQAdAB4AHQAdAB4AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAHQAdAB0AHQAlAB4AJQAlACUAHQAlACUAHQAdAB0AJQAlAB0AHQAlAB0AHQAlACUAJQAeAB0AHgAeAB4AHgAdAB0AJQAdAB0AHQAdAB0AHQAlACUAJQAlACUAHQAlACUAIAAlAB0AHQAlACUAJQAlACUAJQAlACUAHgAeAB4AJQAlACAAIAAgACAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHgAeABcAFwAXABcAFwAXAB4AEwATACUAHgAeAB4AFgARABYAEQAWABEAFgARABYAEQAWABEAFgARAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARABYAEQAWABEAFgARABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB0AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAEAAQABAAeAB4AKwArACsAKwArABMADQANAA0AUAATAA0AUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUAANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAA0ADQANAA0ADQANAA0ADQAeAA0AFgANAB4AHgAXABcAHgAeABcAFwAWABEAFgARABYAEQAWABEADQANAA0ADQATAFAADQANAB4ADQANAB4AHgAeAB4AHgAMAAwADQANAA0AHgANAA0AFgANAA0ADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArAA0AEQARACUAJQBHAFcAVwAWABEAFgARABYAEQAWABEAFgARACUAJQAWABEAFgARABYAEQAWABEAFQAWABEAEQAlAFcAVwBXAFcAVwBXAFcAVwBXAAQABAAEAAQABAAEACUAVwBXAFcAVwA2ACUAJQBXAFcAVwBHAEcAJQAlACUAKwBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBRAFcAUQBXAFEAVwBXAFcAVwBXAFcAUQBXAFcAVwBXAFcAVwBRAFEAKwArAAQABAAVABUARwBHAFcAFQBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBRAFcAVwBXAFcAVwBXAFEAUQBXAFcAVwBXABUAUQBHAEcAVwArACsAKwArACsAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwArACUAJQBXAFcAVwBXACUAJQAlACUAJQAlACUAJQAlACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwArACsAKwArACUAJQAlACUAKwArACsAKwArACsAKwArACsAKwArACsAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACsAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAE8ATwBPAE8ATwBPAE8ATwAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQAlACUAJQAlACUAJQAlACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADQATAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABLAEsASwBLAEsASwBLAEsASwBLAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAABAAEAAQABAAeAAQABAAEAAQABAAEAAQABAAEAAQAHgBQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAeAA0ADQANAA0ADQArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAAQAUABQAFAABABQAFAAUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAeAB4AHgAeACsAKwArACsAUABQAFAAUABQAFAAHgAeABoAHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADgAOABMAEwArACsAKwArACsAKwArACsABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwANAA0ASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUAAeAB4AHgBQAA4AUAArACsAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArAB4AWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYACsAKwArAAQAHgAeAB4AHgAeAB4ADQANAA0AHgAeAB4AHgArAFAASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArAB4AHgBcAFwAXABcAFwAKgBcAFwAXABcAFwAXABcAFwAXABcAEsASwBLAEsASwBLAEsASwBLAEsAXABcAFwAXABcACsAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAFAAUABQAAQAUABQAFAAUABQAFAAUABQAAQABAArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAHgANAA0ADQBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAXAAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAKgAqACoAXABcACoAKgBcAFwAXABcAFwAKgAqAFwAKgBcACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcACoAKgBQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAA0ADQBQAFAAUAAEAAQAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQADQAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAVABVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBUAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVACsAKwArACsAKwArACsAKwArACsAKwArAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAKwArACsAKwBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAKwArACsAKwAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAKwArACsAKwArAFYABABWAFYAVgBWAFYAVgBWAFYAVgBWAB4AVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgArAFYAVgBWAFYAVgArAFYAKwBWAFYAKwBWAFYAKwBWAFYAVgBWAFYAVgBWAFYAVgBWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAEQAWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAaAB4AKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAGAARABEAGAAYABMAEwAWABEAFAArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACUAJQAlACUAJQAWABEAFgARABYAEQAWABEAFgARABYAEQAlACUAFgARACUAJQAlACUAJQAlACUAEQAlABEAKwAVABUAEwATACUAFgARABYAEQAWABEAJQAlACUAJQAlACUAJQAlACsAJQAbABoAJQArACsAKwArAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAcAKwATACUAJQAbABoAJQAlABYAEQAlACUAEQAlABEAJQBXAFcAVwBXAFcAVwBXAFcAVwBXABUAFQAlACUAJQATACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXABYAJQARACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAWACUAEQAlABYAEQARABYAEQARABUAVwBRAFEAUQBRAFEAUQBRAFEAUQBRAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcARwArACsAVwBXAFcAVwBXAFcAKwArAFcAVwBXAFcAVwBXACsAKwBXAFcAVwBXAFcAVwArACsAVwBXAFcAKwArACsAGgAbACUAJQAlABsAGwArAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAAQAB0AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsADQANAA0AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsADQBQAFAAUABQACsAKwArACsAUABQAFAAUABQAFAAUABQAA0AUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUAArACsAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQACsAKwArAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgBQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwBQAFAAUABQAFAABAAEAAQAKwAEAAQAKwArACsAKwArAAQABAAEAAQAUABQAFAAUAArAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsABAAEAAQAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsADQANAA0ADQANAA0ADQANAB4AKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AUABQAFAAUABQAFAAUABQAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwArACsAUABQAFAAUABQAA0ADQANAA0ADQANABQAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwANAA0ADQANAA0ADQANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwBQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAA0ADQAeAB4AHgAeAB4AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsASwBLAEsASwBLAEsASwBLAEsASwANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAeAA4AUAArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAADQANAB4ADQAeAAQABAAEAB4AKwArAEsASwBLAEsASwBLAEsASwBLAEsAUAAOAFAADQANAA0AKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAANAA0AHgANAA0AHgAEACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAA0AKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsABAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAUAArACsAKwArACsAKwAEACsAKwArACsAKwBQAFAAUABQAFAABAAEACsAKwAEAAQABAAEAAQABAAEACsAKwArAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAAQABABQAFAAUABQAA0ADQANAA0AHgBLAEsASwBLAEsASwBLAEsASwBLACsADQArAB4AKwArAAQABAAEAAQAUABQAB4AUAArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEACsAKwAEAAQABAAEAAQABAAEAAQABAAOAA0ADQATABMAHgAeAB4ADQANAA0ADQANAA0ADQANAA0ADQANAA0ADQANAA0AUABQAFAAUAAEAAQAKwArAAQADQANAB4AUAArACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAKwAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAXABcAA0ADQANACoASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAFAABAAEAAQABAAOAB4ADQANAA0ADQAOAB4ABAArACsAKwArACsAKwArACsAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAUABQAFAAUAArACsAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAA0ADQANACsADgAOAA4ADQANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAAQABAAEAFAADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAOABMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAArACsAKwAEACsABAAEACsABAAEAAQABAAEAAQABABQAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABIAEgAQwBDAEMAUABQAFAAUABDAFAAUABQAEgAQwBIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABDAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwANAA0AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAANACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAA0ADQANAB4AHgAeAB4AHgAeAFAAUABQAFAADQAeACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABAAEAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAEcARwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwArACsAKwArACsAKwArACsAKwArACsAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQACsAKwAeAAQABAANAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAB4AHgAeAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAHgAeAAQABAAEAAQABAAEAAQAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAB4AHgAEAAQABAAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAFAAUAArACsAUAArACsAUABQACsAKwBQAFAAUABQACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQACsAUABQAFAAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAKwAeAB4AUABQAFAAUABQACsAUAArACsAKwBQAFAAUABQAFAAUABQACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AKwArAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAEAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAeAB4ADQANAA0ADQAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABAArAAQABAArAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAEAAQABAAEAAQABAAEACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAFgAWAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArAFAAKwArAFAAKwBQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUAArAFAAKwBQACsAKwArACsAKwArAFAAKwArACsAKwBQACsAUAArAFAAKwBQAFAAUAArAFAAUAArAFAAKwArAFAAKwBQACsAUAArAFAAKwBQACsAUABQACsAUAArACsAUABQAFAAUAArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQACsAUABQAFAAUAArAFAAKwBQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwBQAFAAUAArAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAlACUAJQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeACUAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeACUAJQAlACUAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQAlACUAJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeACUAJQAlACUAJQAeACUAJQAlACUAJQAgACAAIAAlACUAIAAlACUAIAAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAIQAhACEAIQAhACUAJQAgACAAJQAlACAAIAAgACAAIAAgACAAIAAgACAAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAIAAgACAAIAAlACUAJQAlACAAJQAgACAAIAAgACAAIAAgACAAIAAlACUAJQAgACUAJQAlACUAIAAgACAAJQAgACAAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeACUAHgAlAB4AJQAlACUAJQAlACAAJQAlACUAJQAeACUAHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAIAAgACUAJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAIAAlACUAJQAlACAAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAIAAgACAAJQAlACUAIAAgACAAIAAgAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFwAXABcAFQAVABUAHgAeAB4AHgAlACUAJQAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAIAAgACAAJQAlACUAJQAlACUAJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACAAIAAlACAAIAAlACUAJQAlACUAJQAgACUAJQAlACUAJQAlACUAJQAlACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAIAAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACsAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsA"),V=[x,36],Q=[1,2,3,5],G=[A,8],z=[C,R],K=Q.concat(G),q=[k,U,D,B,M],W=[v,g],X=function(e,t,n,r){var i=r[n];if(Array.isArray(e)?-1!==e.indexOf(i):e===i)for(var o=n;o<=r.length;){if((c=r[++o])===t)return!0;if(c!==A)break}if(i===A)for(o=n;o>0;){var a=r[--o];if(Array.isArray(e)?-1!==e.indexOf(a):e===a)for(var s=n;s<=r.length;){var c;if((c=r[++s])===t)return!0;if(c!==A)break}if(a!==A)break}return!1},J=function(e,t){for(var n=e;n>=0;){var r=t[n];if(r!==A)return r;n--}return 0},Y=function(e,t,n,r,i){if(0===n[r])return F;var o=r-1;if(Array.isArray(i)&&!0===i[o])return F;var a=o-1,s=o+1,c=t[o],u=a>=0?t[a]:0,l=t[s];if(2===c&&3===l)return F;if(-1!==Q.indexOf(c))return"!";if(-1!==Q.indexOf(l))return F;if(-1!==G.indexOf(l))return F;if(8===J(o,t))return H;if(11===j.get(e[o])&&(l===L||l===O||l===N))return F;if(7===c||7===l)return F;if(9===c)return F;if(-1===[A,g,v].indexOf(c)&&9===l)return F;if(-1!==[m,y,b,S,I].indexOf(l))return F;if(J(o,t)===w)return F;if(X(23,w,o,t))return F;if(X([m,y],_,o,t))return F;if(X(12,12,o,t))return F;if(c===A)return H;if(23===c||23===l)return F;if(16===l||16===c)return H;if(-1!==[g,v,_].indexOf(l)||14===c)return F;if(36===u&&-1!==W.indexOf(c))return F;if(c===I&&36===l)return F;if(l===E&&-1!==V.concat(E,b,T,L,O,N).indexOf(c))return F;if(-1!==V.indexOf(l)&&c===T||-1!==V.indexOf(c)&&l===T)return F;if(c===C&&-1!==[L,O,N].indexOf(l)||-1!==[L,O,N].indexOf(c)&&l===R)return F;if(-1!==V.indexOf(c)&&-1!==z.indexOf(l)||-1!==z.indexOf(c)&&-1!==V.indexOf(l))return F;if(-1!==[C,R].indexOf(c)&&(l===T||-1!==[w,v].indexOf(l)&&t[s+1]===T)||-1!==[w,v].indexOf(c)&&l===T||c===T&&-1!==[T,I,S].indexOf(l))return F;if(-1!==[T,I,S,m,y].indexOf(l))for(var d=o;d>=0;){if((h=t[d])===T)return F;if(-1===[I,S].indexOf(h))break;d--}if(-1!==[C,R].indexOf(l))for(d=-1!==[m,y].indexOf(c)?a:o;d>=0;){var h;if((h=t[d])===T)return F;if(-1===[I,S].indexOf(h))break;d--}if(k===c&&-1!==[k,U,B,M].indexOf(l)||-1!==[U,B].indexOf(c)&&-1!==[U,D].indexOf(l)||-1!==[D,M].indexOf(c)&&l===D)return F;if(-1!==q.indexOf(c)&&-1!==[E,R].indexOf(l)||-1!==q.indexOf(l)&&c===C)return F;if(-1!==V.indexOf(c)&&-1!==V.indexOf(l))return F;if(c===S&&-1!==V.indexOf(l))return F;if(-1!==V.concat(T).indexOf(c)&&l===w||-1!==V.concat(T).indexOf(l)&&c===y)return F;if(41===c&&41===l){for(var f=n[o],p=1;f>0&&41===t[--f];)p++;if(p%2!=0)return F}return c===O&&l===N?F:H},Z=function(e,t){t||(t={lineBreak:"normal",wordBreak:"normal"});var n=function(e,t){void 0===t&&(t="strict");var n=[],r=[],i=[];return e.forEach((function(e,o){var a=j.get(e);if(a>50?(i.push(!0),a-=50):i.push(!1),-1!==["normal","auto","loose"].indexOf(t)&&-1!==[8208,8211,12316,12448].indexOf(e))return r.push(o),n.push(16);if(4===a||11===a){if(0===o)return r.push(o),n.push(x);var s=n[o-1];return-1===K.indexOf(s)?(r.push(r[o-1]),n.push(s)):(r.push(o),n.push(x))}return r.push(o),31===a?n.push("strict"===t?_:L):a===P||29===a?n.push(x):43===a?e>=131072&&e<=196605||e>=196608&&e<=262141?n.push(L):n.push(x):void n.push(a)})),[r,n,i]}(e,t.lineBreak),r=n[0],i=n[1],o=n[2];return"break-all"!==t.wordBreak&&"break-word"!==t.wordBreak||(i=i.map((function(e){return-1!==[T,x,P].indexOf(e)?L:e}))),[r,i,"keep-all"===t.wordBreak?o.map((function(t,n){return t&&e[n]>=19968&&e[n]<=40959})):void 0]},$=function(){function e(e,t,n,r){this.codePoints=e,this.required="!"===t,this.start=n,this.end=r}return e.prototype.slice=function(){return c.apply(void 0,this.codePoints.slice(this.start,this.end))},e}();!function(e){e[e.STRING_TOKEN=0]="STRING_TOKEN",e[e.BAD_STRING_TOKEN=1]="BAD_STRING_TOKEN",e[e.LEFT_PARENTHESIS_TOKEN=2]="LEFT_PARENTHESIS_TOKEN",e[e.RIGHT_PARENTHESIS_TOKEN=3]="RIGHT_PARENTHESIS_TOKEN",e[e.COMMA_TOKEN=4]="COMMA_TOKEN",e[e.HASH_TOKEN=5]="HASH_TOKEN",e[e.DELIM_TOKEN=6]="DELIM_TOKEN",e[e.AT_KEYWORD_TOKEN=7]="AT_KEYWORD_TOKEN",e[e.PREFIX_MATCH_TOKEN=8]="PREFIX_MATCH_TOKEN",e[e.DASH_MATCH_TOKEN=9]="DASH_MATCH_TOKEN",e[e.INCLUDE_MATCH_TOKEN=10]="INCLUDE_MATCH_TOKEN",e[e.LEFT_CURLY_BRACKET_TOKEN=11]="LEFT_CURLY_BRACKET_TOKEN",e[e.RIGHT_CURLY_BRACKET_TOKEN=12]="RIGHT_CURLY_BRACKET_TOKEN",e[e.SUFFIX_MATCH_TOKEN=13]="SUFFIX_MATCH_TOKEN",e[e.SUBSTRING_MATCH_TOKEN=14]="SUBSTRING_MATCH_TOKEN",e[e.DIMENSION_TOKEN=15]="DIMENSION_TOKEN",e[e.PERCENTAGE_TOKEN=16]="PERCENTAGE_TOKEN",e[e.NUMBER_TOKEN=17]="NUMBER_TOKEN",e[e.FUNCTION=18]="FUNCTION",e[e.FUNCTION_TOKEN=19]="FUNCTION_TOKEN",e[e.IDENT_TOKEN=20]="IDENT_TOKEN",e[e.COLUMN_TOKEN=21]="COLUMN_TOKEN",e[e.URL_TOKEN=22]="URL_TOKEN",e[e.BAD_URL_TOKEN=23]="BAD_URL_TOKEN",e[e.CDC_TOKEN=24]="CDC_TOKEN",e[e.CDO_TOKEN=25]="CDO_TOKEN",e[e.COLON_TOKEN=26]="COLON_TOKEN",e[e.SEMICOLON_TOKEN=27]="SEMICOLON_TOKEN",e[e.LEFT_SQUARE_BRACKET_TOKEN=28]="LEFT_SQUARE_BRACKET_TOKEN",e[e.RIGHT_SQUARE_BRACKET_TOKEN=29]="RIGHT_SQUARE_BRACKET_TOKEN",e[e.UNICODE_RANGE_TOKEN=30]="UNICODE_RANGE_TOKEN",e[e.WHITESPACE_TOKEN=31]="WHITESPACE_TOKEN",e[e.EOF_TOKEN=32]="EOF_TOKEN"}(h||(h={}));var ee=45,te=43,ne=-1,re=function(e){return e>=48&&e<=57},ie=function(e){return re(e)||e>=65&&e<=70||e>=97&&e<=102},oe=function(e){return 10===e||9===e||32===e},ae=function(e){return function(e){return function(e){return e>=97&&e<=122}(e)||function(e){return e>=65&&e<=90}(e)}(e)||function(e){return e>=128}(e)||95===e},se=function(e){return ae(e)||re(e)||e===ee},ce=function(e){return e>=0&&e<=8||11===e||e>=14&&e<=31||127===e},ue=function(e,t){return 92===e&&10!==t},le=function(e,t,n){return e===ee?ae(t)||ue(t,n):!!ae(e)||!(92!==e||!ue(e,t))},de=function(e,t,n){return e===te||e===ee?!!re(t)||46===t&&re(n):re(46===e?t:e)},he=function(e){var t=0,n=1;e[t]!==te&&e[t]!==ee||(e[t]===ee&&(n=-1),t++);for(var r=[];re(e[t]);)r.push(e[t++]);var i=r.length?parseInt(c.apply(void 0,r),10):0;46===e[t]&&t++;for(var o=[];re(e[t]);)o.push(e[t++]);var a=o.length,s=a?parseInt(c.apply(void 0,o),10):0;69!==e[t]&&101!==e[t]||t++;var u=1;e[t]!==te&&e[t]!==ee||(e[t]===ee&&(u=-1),t++);for(var l=[];re(e[t]);)l.push(e[t++]);var d=l.length?parseInt(c.apply(void 0,l),10):0;return n*(i+s*Math.pow(10,-a))*Math.pow(10,u*d)},fe={type:h.LEFT_PARENTHESIS_TOKEN},pe={type:h.RIGHT_PARENTHESIS_TOKEN},Ae={type:h.COMMA_TOKEN},ge={type:h.SUFFIX_MATCH_TOKEN},ve={type:h.PREFIX_MATCH_TOKEN},me={type:h.COLUMN_TOKEN},ye={type:h.DASH_MATCH_TOKEN},be={type:h.INCLUDE_MATCH_TOKEN},Ee={type:h.LEFT_CURLY_BRACKET_TOKEN},_e={type:h.RIGHT_CURLY_BRACKET_TOKEN},we={type:h.SUBSTRING_MATCH_TOKEN},Se={type:h.BAD_URL_TOKEN},Te={type:h.BAD_STRING_TOKEN},Re={type:h.CDO_TOKEN},Ce={type:h.CDC_TOKEN},Ie={type:h.COLON_TOKEN},xe={type:h.SEMICOLON_TOKEN},Oe={type:h.LEFT_SQUARE_BRACKET_TOKEN},Ne={type:h.RIGHT_SQUARE_BRACKET_TOKEN},Be={type:h.WHITESPACE_TOKEN},Me={type:h.EOF_TOKEN},Le=function(){function e(){this._value=[]}return e.prototype.write=function(e){this._value=this._value.concat(s(e))},e.prototype.read=function(){for(var e=[],t=this.consumeToken();t!==Me;)e.push(t),t=this.consumeToken();return e},e.prototype.consumeToken=function(){var e=this.consumeCodePoint();switch(e){case 34:return this.consumeStringToken(34);case 35:var t=this.peekCodePoint(0),n=this.peekCodePoint(1),r=this.peekCodePoint(2);if(se(t)||ue(n,r)){var i=le(t,n,r)?2:1,o=this.consumeName();return{type:h.HASH_TOKEN,value:o,flags:i}}break;case 36:if(61===this.peekCodePoint(0))return this.consumeCodePoint(),ge;break;case 39:return this.consumeStringToken(39);case 40:return fe;case 41:return pe;case 42:if(61===this.peekCodePoint(0))return this.consumeCodePoint(),we;break;case te:if(de(e,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(e),this.consumeNumericToken();break;case 44:return Ae;case ee:var a=e,s=this.peekCodePoint(0),u=this.peekCodePoint(1);if(de(a,s,u))return this.reconsumeCodePoint(e),this.consumeNumericToken();if(le(a,s,u))return this.reconsumeCodePoint(e),this.consumeIdentLikeToken();if(s===ee&&62===u)return this.consumeCodePoint(),this.consumeCodePoint(),Ce;break;case 46:if(de(e,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(e),this.consumeNumericToken();break;case 47:if(42===this.peekCodePoint(0))for(this.consumeCodePoint();;){var l=this.consumeCodePoint();if(42===l&&47===(l=this.consumeCodePoint()))return this.consumeToken();if(l===ne)return this.consumeToken()}break;case 58:return Ie;case 59:return xe;case 60:if(33===this.peekCodePoint(0)&&this.peekCodePoint(1)===ee&&this.peekCodePoint(2)===ee)return this.consumeCodePoint(),this.consumeCodePoint(),Re;break;case 64:var d=this.peekCodePoint(0),f=this.peekCodePoint(1),p=this.peekCodePoint(2);if(le(d,f,p)){o=this.consumeName();return{type:h.AT_KEYWORD_TOKEN,value:o}}break;case 91:return Oe;case 92:if(ue(e,this.peekCodePoint(0)))return this.reconsumeCodePoint(e),this.consumeIdentLikeToken();break;case 93:return Ne;case 61:if(61===this.peekCodePoint(0))return this.consumeCodePoint(),ve;break;case 123:return Ee;case 125:return _e;case 117:case 85:var A=this.peekCodePoint(0),g=this.peekCodePoint(1);return A!==te||!ie(g)&&63!==g||(this.consumeCodePoint(),this.consumeUnicodeRangeToken()),this.reconsumeCodePoint(e),this.consumeIdentLikeToken();case 124:if(61===this.peekCodePoint(0))return this.consumeCodePoint(),ye;if(124===this.peekCodePoint(0))return this.consumeCodePoint(),me;break;case 126:if(61===this.peekCodePoint(0))return this.consumeCodePoint(),be;break;case ne:return Me}return oe(e)?(this.consumeWhiteSpace(),Be):re(e)?(this.reconsumeCodePoint(e),this.consumeNumericToken()):ae(e)?(this.reconsumeCodePoint(e),this.consumeIdentLikeToken()):{type:h.DELIM_TOKEN,value:c(e)}},e.prototype.consumeCodePoint=function(){var e=this._value.shift();return void 0===e?-1:e},e.prototype.reconsumeCodePoint=function(e){this._value.unshift(e)},e.prototype.peekCodePoint=function(e){return e>=this._value.length?-1:this._value[e]},e.prototype.consumeUnicodeRangeToken=function(){for(var e=[],t=this.consumeCodePoint();ie(t)&&e.length<6;)e.push(t),t=this.consumeCodePoint();for(var n=!1;63===t&&e.length<6;)e.push(t),t=this.consumeCodePoint(),n=!0;if(n){var r=parseInt(c.apply(void 0,e.map((function(e){return 63===e?48:e}))),16),i=parseInt(c.apply(void 0,e.map((function(e){return 63===e?70:e}))),16);return{type:h.UNICODE_RANGE_TOKEN,start:r,end:i}}var o=parseInt(c.apply(void 0,e),16);if(this.peekCodePoint(0)===ee&&ie(this.peekCodePoint(1))){this.consumeCodePoint(),t=this.consumeCodePoint();for(var a=[];ie(t)&&a.length<6;)a.push(t),t=this.consumeCodePoint();i=parseInt(c.apply(void 0,a),16);return{type:h.UNICODE_RANGE_TOKEN,start:o,end:i}}return{type:h.UNICODE_RANGE_TOKEN,start:o,end:o}},e.prototype.consumeIdentLikeToken=function(){var e=this.consumeName();return"url"===e.toLowerCase()&&40===this.peekCodePoint(0)?(this.consumeCodePoint(),this.consumeUrlToken()):40===this.peekCodePoint(0)?(this.consumeCodePoint(),{type:h.FUNCTION_TOKEN,value:e}):{type:h.IDENT_TOKEN,value:e}},e.prototype.consumeUrlToken=function(){var e=[];if(this.consumeWhiteSpace(),this.peekCodePoint(0)===ne)return{type:h.URL_TOKEN,value:""};var t=this.peekCodePoint(0);if(39===t||34===t){var n=this.consumeStringToken(this.consumeCodePoint());return n.type===h.STRING_TOKEN&&(this.consumeWhiteSpace(),this.peekCodePoint(0)===ne||41===this.peekCodePoint(0))?(this.consumeCodePoint(),{type:h.URL_TOKEN,value:n.value}):(this.consumeBadUrlRemnants(),Se)}for(;;){var r=this.consumeCodePoint();if(r===ne||41===r)return{type:h.URL_TOKEN,value:c.apply(void 0,e)};if(oe(r))return this.consumeWhiteSpace(),this.peekCodePoint(0)===ne||41===this.peekCodePoint(0)?(this.consumeCodePoint(),{type:h.URL_TOKEN,value:c.apply(void 0,e)}):(this.consumeBadUrlRemnants(),Se);if(34===r||39===r||40===r||ce(r))return this.consumeBadUrlRemnants(),Se;if(92===r){if(!ue(r,this.peekCodePoint(0)))return this.consumeBadUrlRemnants(),Se;e.push(this.consumeEscapedCodePoint())}else e.push(r)}},e.prototype.consumeWhiteSpace=function(){for(;oe(this.peekCodePoint(0));)this.consumeCodePoint()},e.prototype.consumeBadUrlRemnants=function(){for(;;){var e=this.consumeCodePoint();if(41===e||e===ne)return;ue(e,this.peekCodePoint(0))&&this.consumeEscapedCodePoint()}},e.prototype.consumeStringSlice=function(e){for(var t="";e>0;){var n=Math.min(6e4,e);t+=c.apply(void 0,this._value.splice(0,n)),e-=n}return this._value.shift(),t},e.prototype.consumeStringToken=function(e){for(var t="",n=0;;){var r=this._value[n];if(r===ne||void 0===r||r===e)return t+=this.consumeStringSlice(n),{type:h.STRING_TOKEN,value:t};if(10===r)return this._value.splice(0,n),Te;if(92===r){var i=this._value[n+1];i!==ne&&void 0!==i&&(10===i?(t+=this.consumeStringSlice(n),n=-1,this._value.shift()):ue(r,i)&&(t+=this.consumeStringSlice(n),t+=c(this.consumeEscapedCodePoint()),n=-1))}n++}},e.prototype.consumeNumber=function(){var e=[],t=4,n=this.peekCodePoint(0);for(n!==te&&n!==ee||e.push(this.consumeCodePoint());re(this.peekCodePoint(0));)e.push(this.consumeCodePoint());n=this.peekCodePoint(0);var r=this.peekCodePoint(1);if(46===n&&re(r))for(e.push(this.consumeCodePoint(),this.consumeCodePoint()),t=8;re(this.peekCodePoint(0));)e.push(this.consumeCodePoint());n=this.peekCodePoint(0),r=this.peekCodePoint(1);var i=this.peekCodePoint(2);if((69===n||101===n)&&((r===te||r===ee)&&re(i)||re(r)))for(e.push(this.consumeCodePoint(),this.consumeCodePoint()),t=8;re(this.peekCodePoint(0));)e.push(this.consumeCodePoint());return[he(e),t]},e.prototype.consumeNumericToken=function(){var e=this.consumeNumber(),t=e[0],n=e[1],r=this.peekCodePoint(0),i=this.peekCodePoint(1),o=this.peekCodePoint(2);if(le(r,i,o)){var a=this.consumeName();return{type:h.DIMENSION_TOKEN,number:t,flags:n,unit:a}}return 37===r?(this.consumeCodePoint(),{type:h.PERCENTAGE_TOKEN,number:t,flags:n}):{type:h.NUMBER_TOKEN,number:t,flags:n}},e.prototype.consumeEscapedCodePoint=function(){var e=this.consumeCodePoint();if(ie(e)){for(var t=c(e);ie(this.peekCodePoint(0))&&t.length<6;)t+=c(this.consumeCodePoint());oe(this.peekCodePoint(0))&&this.consumeCodePoint();var n=parseInt(t,16);return 0===n||function(e){return e>=55296&&e<=57343}(n)||n>1114111?65533:n}return e===ne?65533:e},e.prototype.consumeName=function(){for(var e="";;){var t=this.consumeCodePoint();if(se(t))e+=c(t);else{if(!ue(t,this.peekCodePoint(0)))return this.reconsumeCodePoint(t),e;e+=c(this.consumeEscapedCodePoint())}}},e}(),ke=function(){function e(e){this._tokens=e}return e.create=function(t){var n=new Le;return n.write(t),new e(n.read())},e.parseValue=function(t){return e.create(t).parseComponentValue()},e.parseValues=function(t){return e.create(t).parseComponentValues()},e.prototype.parseComponentValue=function(){for(var e=this.consumeToken();e.type===h.WHITESPACE_TOKEN;)e=this.consumeToken();if(e.type===h.EOF_TOKEN)throw new SyntaxError("Error parsing CSS component value, unexpected EOF");this.reconsumeToken(e);var t=this.consumeComponentValue();do{e=this.consumeToken()}while(e.type===h.WHITESPACE_TOKEN);if(e.type===h.EOF_TOKEN)return t;throw new SyntaxError("Error parsing CSS component value, multiple values found when expecting only one")},e.prototype.parseComponentValues=function(){for(var e=[];;){var t=this.consumeComponentValue();if(t.type===h.EOF_TOKEN)return e;e.push(t),e.push()}},e.prototype.consumeComponentValue=function(){var e=this.consumeToken();switch(e.type){case h.LEFT_CURLY_BRACKET_TOKEN:case h.LEFT_SQUARE_BRACKET_TOKEN:case h.LEFT_PARENTHESIS_TOKEN:return this.consumeSimpleBlock(e.type);case h.FUNCTION_TOKEN:return this.consumeFunction(e)}return e},e.prototype.consumeSimpleBlock=function(e){for(var t={type:e,values:[]},n=this.consumeToken();;){if(n.type===h.EOF_TOKEN||Ge(n,e))return t;this.reconsumeToken(n),t.values.push(this.consumeComponentValue()),n=this.consumeToken()}},e.prototype.consumeFunction=function(e){for(var t={name:e.value,values:[],type:h.FUNCTION};;){var n=this.consumeToken();if(n.type===h.EOF_TOKEN||n.type===h.RIGHT_PARENTHESIS_TOKEN)return t;this.reconsumeToken(n),t.values.push(this.consumeComponentValue())}},e.prototype.consumeToken=function(){var e=this._tokens.shift();return void 0===e?Me:e},e.prototype.reconsumeToken=function(e){this._tokens.unshift(e)},e}(),Ue=function(e){return e.type===h.DIMENSION_TOKEN},De=function(e){return e.type===h.NUMBER_TOKEN},Pe=function(e){return e.type===h.IDENT_TOKEN},Fe=function(e){return e.type===h.STRING_TOKEN},He=function(e,t){return Pe(e)&&e.value===t},je=function(e){return e.type!==h.WHITESPACE_TOKEN},Ve=function(e){return e.type!==h.WHITESPACE_TOKEN&&e.type!==h.COMMA_TOKEN},Qe=function(e){var t=[],n=[];return e.forEach((function(e){if(e.type===h.COMMA_TOKEN){if(0===n.length)throw new Error("Error parsing function args, zero tokens for arg");return t.push(n),void(n=[])}e.type!==h.WHITESPACE_TOKEN&&n.push(e)})),n.length&&t.push(n),t},Ge=function(e,t){return t===h.LEFT_CURLY_BRACKET_TOKEN&&e.type===h.RIGHT_CURLY_BRACKET_TOKEN||(t===h.LEFT_SQUARE_BRACKET_TOKEN&&e.type===h.RIGHT_SQUARE_BRACKET_TOKEN||t===h.LEFT_PARENTHESIS_TOKEN&&e.type===h.RIGHT_PARENTHESIS_TOKEN)},ze=function(e){return e.type===h.NUMBER_TOKEN||e.type===h.DIMENSION_TOKEN},Ke=function(e){return e.type===h.PERCENTAGE_TOKEN||ze(e)},qe=function(e){return e.length>1?[e[0],e[1]]:[e[0]]},We={type:h.NUMBER_TOKEN,number:0,flags:4},Xe={type:h.PERCENTAGE_TOKEN,number:50,flags:4},Je={type:h.PERCENTAGE_TOKEN,number:100,flags:4},Ye=function(e,t,n){var r=e[0],i=e[1];return[Ze(r,t),Ze(void 0!==i?i:r,n)]},Ze=function(e,t){if(e.type===h.PERCENTAGE_TOKEN)return e.number/100*t;if(Ue(e))switch(e.unit){case"rem":case"em":return 16*e.number;case"px":default:return e.number}return e.number},$e="grad",et="turn",tt=function(e){if(e.type===h.DIMENSION_TOKEN)switch(e.unit){case"deg":return Math.PI*e.number/180;case $e:return Math.PI/200*e.number;case"rad":return e.number;case et:return 2*Math.PI*e.number}throw new Error("Unsupported angle type")},nt=function(e){return e.type===h.DIMENSION_TOKEN&&("deg"===e.unit||e.unit===$e||"rad"===e.unit||e.unit===et)},rt=function(e){switch(e.filter(Pe).map((function(e){return e.value})).join(" ")){case"to bottom right":case"to right bottom":case"left top":case"top left":return[We,We];case"to top":case"bottom":return it(0);case"to bottom left":case"to left bottom":case"right top":case"top right":return[We,Je];case"to right":case"left":return it(90);case"to top left":case"to left top":case"right bottom":case"bottom right":return[Je,Je];case"to bottom":case"top":return it(180);case"to top right":case"to right top":case"left bottom":case"bottom left":return[Je,We];case"to left":case"right":return it(270)}return 0},it=function(e){return Math.PI*e/180},ot=function(e){if(e.type===h.FUNCTION){var t=At[e.name];if(void 0===t)throw new Error('Attempting to parse an unsupported color function "'+e.name+'"');return t(e.values)}if(e.type===h.HASH_TOKEN){if(3===e.value.length){var n=e.value.substring(0,1),r=e.value.substring(1,2),i=e.value.substring(2,3);return ct(parseInt(n+n,16),parseInt(r+r,16),parseInt(i+i,16),1)}if(4===e.value.length){n=e.value.substring(0,1),r=e.value.substring(1,2),i=e.value.substring(2,3);var o=e.value.substring(3,4);return ct(parseInt(n+n,16),parseInt(r+r,16),parseInt(i+i,16),parseInt(o+o,16)/255)}if(6===e.value.length){n=e.value.substring(0,2),r=e.value.substring(2,4),i=e.value.substring(4,6);return ct(parseInt(n,16),parseInt(r,16),parseInt(i,16),1)}if(8===e.value.length){n=e.value.substring(0,2),r=e.value.substring(2,4),i=e.value.substring(4,6),o=e.value.substring(6,8);return ct(parseInt(n,16),parseInt(r,16),parseInt(i,16),parseInt(o,16)/255)}}if(e.type===h.IDENT_TOKEN){var a=gt[e.value.toUpperCase()];if(void 0!==a)return a}return gt.TRANSPARENT},at=function(e){return 0==(255&e)},st=function(e){var t=255&e,n=255&e>>8,r=255&e>>16,i=255&e>>24;return t<255?"rgba("+i+","+r+","+n+","+t/255+")":"rgb("+i+","+r+","+n+")"},ct=function(e,t,n,r){return(e<<24|t<<16|n<<8|Math.round(255*r)<<0)>>>0},ut=function(e,t){if(e.type===h.NUMBER_TOKEN)return e.number;if(e.type===h.PERCENTAGE_TOKEN){var n=3===t?1:255;return 3===t?e.number/100*n:Math.round(e.number/100*n)}return 0},lt=function(e){var t=e.filter(Ve);if(3===t.length){var n=t.map(ut),r=n[0],i=n[1],o=n[2];return ct(r,i,o,1)}if(4===t.length){var a=t.map(ut),s=(r=a[0],i=a[1],o=a[2],a[3]);return ct(r,i,o,s)}return 0};function dt(e,t,n){return n<0&&(n+=1),n>=1&&(n-=1),n<1/6?(t-e)*n*6+e:n<.5?t:n<2/3?6*(t-e)*(2/3-n)+e:e}var ht,ft,pt=function(e){var t=e.filter(Ve),n=t[0],r=t[1],i=t[2],o=t[3],a=(n.type===h.NUMBER_TOKEN?it(n.number):tt(n))/(2*Math.PI),s=Ke(r)?r.number/100:0,c=Ke(i)?i.number/100:0,u=void 0!==o&&Ke(o)?Ze(o,1):1;if(0===s)return ct(255*c,255*c,255*c,1);var l=c<=.5?c*(s+1):c+s-c*s,d=2*c-l,f=dt(d,l,a+1/3),p=dt(d,l,a),A=dt(d,l,a-1/3);return ct(255*f,255*p,255*A,u)},At={hsl:pt,hsla:pt,rgb:lt,rgba:lt},gt={ALICEBLUE:4042850303,ANTIQUEWHITE:4209760255,AQUA:16777215,AQUAMARINE:2147472639,AZURE:4043309055,BEIGE:4126530815,BISQUE:4293182719,BLACK:255,BLANCHEDALMOND:4293643775,BLUE:65535,BLUEVIOLET:2318131967,BROWN:2771004159,BURLYWOOD:3736635391,CADETBLUE:1604231423,CHARTREUSE:2147418367,CHOCOLATE:3530104575,CORAL:4286533887,CORNFLOWERBLUE:1687547391,CORNSILK:4294499583,CRIMSON:3692313855,CYAN:16777215,DARKBLUE:35839,DARKCYAN:9145343,DARKGOLDENROD:3095837695,DARKGRAY:2846468607,DARKGREEN:6553855,DARKGREY:2846468607,DARKKHAKI:3182914559,DARKMAGENTA:2332068863,DARKOLIVEGREEN:1433087999,DARKORANGE:4287365375,DARKORCHID:2570243327,DARKRED:2332033279,DARKSALMON:3918953215,DARKSEAGREEN:2411499519,DARKSLATEBLUE:1211993087,DARKSLATEGRAY:793726975,DARKSLATEGREY:793726975,DARKTURQUOISE:13554175,DARKVIOLET:2483082239,DEEPPINK:4279538687,DEEPSKYBLUE:12582911,DIMGRAY:1768516095,DIMGREY:1768516095,DODGERBLUE:512819199,FIREBRICK:2988581631,FLORALWHITE:4294635775,FORESTGREEN:579543807,FUCHSIA:4278255615,GAINSBORO:3705462015,GHOSTWHITE:4177068031,GOLD:4292280575,GOLDENROD:3668254975,GRAY:2155905279,GREEN:8388863,GREENYELLOW:2919182335,GREY:2155905279,HONEYDEW:4043305215,HOTPINK:4285117695,INDIANRED:3445382399,INDIGO:1258324735,IVORY:4294963455,KHAKI:4041641215,LAVENDER:3873897215,LAVENDERBLUSH:4293981695,LAWNGREEN:2096890111,LEMONCHIFFON:4294626815,LIGHTBLUE:2916673279,LIGHTCORAL:4034953471,LIGHTCYAN:3774873599,LIGHTGOLDENRODYELLOW:4210742015,LIGHTGRAY:3553874943,LIGHTGREEN:2431553791,LIGHTGREY:3553874943,LIGHTPINK:4290167295,LIGHTSALMON:4288707327,LIGHTSEAGREEN:548580095,LIGHTSKYBLUE:2278488831,LIGHTSLATEGRAY:2005441023,LIGHTSLATEGREY:2005441023,LIGHTSTEELBLUE:2965692159,LIGHTYELLOW:4294959359,LIME:16711935,LIMEGREEN:852308735,LINEN:4210091775,MAGENTA:4278255615,MAROON:2147483903,MEDIUMAQUAMARINE:1724754687,MEDIUMBLUE:52735,MEDIUMORCHID:3126187007,MEDIUMPURPLE:2473647103,MEDIUMSEAGREEN:1018393087,MEDIUMSLATEBLUE:2070474495,MEDIUMSPRINGGREEN:16423679,MEDIUMTURQUOISE:1221709055,MEDIUMVIOLETRED:3340076543,MIDNIGHTBLUE:421097727,MINTCREAM:4127193855,MISTYROSE:4293190143,MOCCASIN:4293178879,NAVAJOWHITE:4292783615,NAVY:33023,OLDLACE:4260751103,OLIVE:2155872511,OLIVEDRAB:1804477439,ORANGE:4289003775,ORANGERED:4282712319,ORCHID:3664828159,PALEGOLDENROD:4008225535,PALEGREEN:2566625535,PALETURQUOISE:2951671551,PALEVIOLETRED:3681588223,PAPAYAWHIP:4293907967,PEACHPUFF:4292524543,PERU:3448061951,PINK:4290825215,PLUM:3718307327,POWDERBLUE:2967529215,PURPLE:2147516671,REBECCAPURPLE:1714657791,RED:4278190335,ROSYBROWN:3163525119,ROYALBLUE:1097458175,SADDLEBROWN:2336560127,SALMON:4202722047,SANDYBROWN:4104413439,SEAGREEN:780883967,SEASHELL:4294307583,SIENNA:2689740287,SILVER:3233857791,SKYBLUE:2278484991,SLATEBLUE:1784335871,SLATEGRAY:1887473919,SLATEGREY:1887473919,SNOW:4294638335,SPRINGGREEN:16744447,STEELBLUE:1182971135,TAN:3535047935,TEAL:8421631,THISTLE:3636451583,TOMATO:4284696575,TRANSPARENT:0,TURQUOISE:1088475391,VIOLET:4001558271,WHEAT:4125012991,WHITE:4294967295,WHITESMOKE:4126537215,YELLOW:4294902015,YELLOWGREEN:2597139199};!function(e){e[e.VALUE=0]="VALUE",e[e.LIST=1]="LIST",e[e.IDENT_VALUE=2]="IDENT_VALUE",e[e.TYPE_VALUE=3]="TYPE_VALUE",e[e.TOKEN_VALUE=4]="TOKEN_VALUE"}(ht||(ht={})),function(e){e[e.BORDER_BOX=0]="BORDER_BOX",e[e.PADDING_BOX=1]="PADDING_BOX",e[e.CONTENT_BOX=2]="CONTENT_BOX"}(ft||(ft={}));var vt,mt={name:"background-clip",initialValue:"border-box",prefix:!1,type:ht.LIST,parse:function(e){return e.map((function(e){if(Pe(e))switch(e.value){case"padding-box":return ft.PADDING_BOX;case"content-box":return ft.CONTENT_BOX}return ft.BORDER_BOX}))}},yt={name:"background-color",initialValue:"transparent",prefix:!1,type:ht.TYPE_VALUE,format:"color"},bt=function(e){var t=ot(e[0]),n=e[1];return n&&Ke(n)?{color:t,stop:n}:{color:t,stop:null}},Et=function(e,t){var n=e[0],r=e[e.length-1];null===n.stop&&(n.stop=We),null===r.stop&&(r.stop=Je);for(var i=[],o=0,a=0;a<e.length;a++){var s=e[a].stop;if(null!==s){var c=Ze(s,t);c>o?i.push(c):i.push(o),o=c}else i.push(null)}var u=null;for(a=0;a<i.length;a++){var l=i[a];if(null===l)null===u&&(u=a);else if(null!==u){for(var d=a-u,h=(l-i[u-1])/(d+1),f=1;f<=d;f++)i[u+f-1]=h*f;u=null}}return e.map((function(e,n){return{color:e.color,stop:Math.max(Math.min(1,i[n]/t),0)}}))},_t=function(e,t,n){var r="number"==typeof e?e:function(e,t,n){var r=t/2,i=n/2,o=Ze(e[0],t)-r,a=i-Ze(e[1],n);return(Math.atan2(a,o)+2*Math.PI)%(2*Math.PI)}(e,t,n),i=Math.abs(t*Math.sin(r))+Math.abs(n*Math.cos(r)),o=t/2,a=n/2,s=i/2,c=Math.sin(r-Math.PI/2)*s,u=Math.cos(r-Math.PI/2)*s;return[i,o-u,o+u,a-c,a+c]},wt=function(e,t){return Math.sqrt(e*e+t*t)},St=function(e,t,n,r,i){return[[0,0],[0,t],[e,0],[e,t]].reduce((function(e,t){var o=t[0],a=t[1],s=wt(n-o,r-a);return(i?s<e.optimumDistance:s>e.optimumDistance)?{optimumCorner:t,optimumDistance:s}:e}),{optimumDistance:i?1/0:-1/0,optimumCorner:null}).optimumCorner},Tt=function(e){var t=it(180),n=[];return Qe(e).forEach((function(e,r){if(0===r){var i=e[0];if(i.type===h.IDENT_TOKEN&&-1!==["top","left","right","bottom"].indexOf(i.value))return void(t=rt(e));if(nt(i))return void(t=(tt(i)+it(270))%it(360))}var o=bt(e);n.push(o)})),{angle:t,stops:n,type:vt.LINEAR_GRADIENT}},Rt=function(e){return 0===e[0]&&255===e[1]&&0===e[2]&&255===e[3]},Ct=function(e,t,n,r,i){var o="http://www.w3.org/2000/svg",a=document.createElementNS(o,"svg"),s=document.createElementNS(o,"foreignObject");return a.setAttributeNS(null,"width",e.toString()),a.setAttributeNS(null,"height",t.toString()),s.setAttributeNS(null,"width","100%"),s.setAttributeNS(null,"height","100%"),s.setAttributeNS(null,"x",n.toString()),s.setAttributeNS(null,"y",r.toString()),s.setAttributeNS(null,"externalResourcesRequired","true"),a.appendChild(s),s.appendChild(i),a},It=function(e){return new Promise((function(t,n){var r=new Image;r.onload=function(){return t(r)},r.onerror=n,r.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent((new XMLSerializer).serializeToString(e))}))},xt={get SUPPORT_RANGE_BOUNDS(){var e=function(e){if(e.createRange){var t=e.createRange();if(t.getBoundingClientRect){var n=e.createElement("boundtest");n.style.height="123px",n.style.display="block",e.body.appendChild(n),t.selectNode(n);var r=t.getBoundingClientRect(),i=Math.round(r.height);if(e.body.removeChild(n),123===i)return!0}}return!1}(document);return Object.defineProperty(xt,"SUPPORT_RANGE_BOUNDS",{value:e}),e},get SUPPORT_SVG_DRAWING(){var e=function(e){var t=new Image,n=e.createElement("canvas"),r=n.getContext("2d");if(!r)return!1;t.src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg'></svg>";try{r.drawImage(t,0,0),n.toDataURL()}catch(e){return!1}return!0}(document);return Object.defineProperty(xt,"SUPPORT_SVG_DRAWING",{value:e}),e},get SUPPORT_FOREIGNOBJECT_DRAWING(){var e="function"==typeof Array.from&&"function"==typeof window.fetch?function(e){var t=e.createElement("canvas"),n=100;t.width=n,t.height=n;var r=t.getContext("2d");if(!r)return Promise.reject(!1);r.fillStyle="rgb(0, 255, 0)",r.fillRect(0,0,n,n);var i=new Image,o=t.toDataURL();i.src=o;var a=Ct(n,n,0,0,i);return r.fillStyle="red",r.fillRect(0,0,n,n),It(a).then((function(t){r.drawImage(t,0,0);var i=r.getImageData(0,0,n,n).data;r.fillStyle="red",r.fillRect(0,0,n,n);var a=e.createElement("div");return a.style.backgroundImage="url("+o+")",a.style.height="100px",Rt(i)?It(Ct(n,n,0,0,a)):Promise.reject(!1)})).then((function(e){return r.drawImage(e,0,0),Rt(r.getImageData(0,0,n,n).data)})).catch((function(){return!1}))}(document):Promise.resolve(!1);return Object.defineProperty(xt,"SUPPORT_FOREIGNOBJECT_DRAWING",{value:e}),e},get SUPPORT_CORS_IMAGES(){var e=void 0!==(new Image).crossOrigin;return Object.defineProperty(xt,"SUPPORT_CORS_IMAGES",{value:e}),e},get SUPPORT_RESPONSE_TYPE(){var e="string"==typeof(new XMLHttpRequest).responseType;return Object.defineProperty(xt,"SUPPORT_RESPONSE_TYPE",{value:e}),e},get SUPPORT_CORS_XHR(){var e="withCredentials"in new XMLHttpRequest;return Object.defineProperty(xt,"SUPPORT_CORS_XHR",{value:e}),e}},Ot=function(){function e(e){var t=e.id,n=e.enabled;this.id=t,this.enabled=n,this.start=Date.now()}return e.prototype.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.enabled&&("undefined"!=typeof window&&window.console&&"function"==typeof console.debug?console.debug.apply(console,[this.id,this.getTime()+"ms"].concat(e)):this.info.apply(this,e))},e.prototype.getTime=function(){return Date.now()-this.start},e.create=function(t){e.instances[t.id]=new e(t)},e.destroy=function(t){delete e.instances[t]},e.getInstance=function(t){var n=e.instances[t];if(void 0===n)throw new Error("No logger instance found with id "+t);return n},e.prototype.info=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.enabled&&"undefined"!=typeof window&&window.console&&"function"==typeof console.info&&console.info.apply(console,[this.id,this.getTime()+"ms"].concat(e))},e.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.enabled&&("undefined"!=typeof window&&window.console&&"function"==typeof console.error?console.error.apply(console,[this.id,this.getTime()+"ms"].concat(e)):this.info.apply(this,e))},e.instances={},e}(),Nt=function(){function e(){}return e.create=function(t,n){return e._caches[t]=new Bt(t,n)},e.destroy=function(t){delete e._caches[t]},e.open=function(t){var n=e._caches[t];if(void 0!==n)return n;throw new Error('Cache with key "'+t+'" not found')},e.getOrigin=function(t){var n=e._link;return n?(n.href=t,n.href=n.href,n.protocol+n.hostname+n.port):"about:blank"},e.isSameOrigin=function(t){return e.getOrigin(t)===e._origin},e.setContext=function(t){e._link=t.document.createElement("a"),e._origin=e.getOrigin(t.location.href)},e.getInstance=function(){var t=e._current;if(null===t)throw new Error("No cache instance attached");return t},e.attachInstance=function(t){e._current=t},e.detachInstance=function(){e._current=null},e._caches={},e._origin="about:blank",e._current=null,e}(),Bt=function(){function e(e,t){this.id=e,this._options=t,this._cache={}}return e.prototype.addImage=function(e){var t=Promise.resolve();return this.has(e)?t:Ft(e)||Ut(e)?(this._cache[e]=this.loadImage(e),t):t},e.prototype.match=function(e){return this._cache[e]},e.prototype.loadImage=function(e){return r(this,void 0,void 0,(function(){var t,n,r,o,a=this;return i(this,(function(i){switch(i.label){case 0:return t=Nt.isSameOrigin(e),n=!Dt(e)&&!0===this._options.useCORS&&xt.SUPPORT_CORS_IMAGES&&!t,r=!Dt(e)&&!t&&"string"==typeof this._options.proxy&&xt.SUPPORT_CORS_XHR&&!n,t||!1!==this._options.allowTaint||Dt(e)||r||n?(o=e,r?[4,this.proxy(o)]:[3,2]):[2];case 1:o=i.sent(),i.label=2;case 2:return Ot.getInstance(this.id).debug("Added image "+e.substring(0,256)),[4,new Promise((function(e,t){var r=new Image;r.onload=function(){return e(r)},r.onerror=t,(Pt(o)||n)&&(r.crossOrigin="anonymous"),r.src=o,!0===r.complete&&setTimeout((function(){return e(r)}),500),a._options.imageTimeout>0&&setTimeout((function(){return t("Timed out ("+a._options.imageTimeout+"ms) loading image")}),a._options.imageTimeout)}))];case 3:return[2,i.sent()]}}))}))},e.prototype.has=function(e){return void 0!==this._cache[e]},e.prototype.keys=function(){return Promise.resolve(Object.keys(this._cache))},e.prototype.proxy=function(e){var t=this,n=this._options.proxy;if(!n)throw new Error("No proxy defined");var r=e.substring(0,256);return new Promise((function(i,o){var a=xt.SUPPORT_RESPONSE_TYPE?"blob":"text",s=new XMLHttpRequest;if(s.onload=function(){if(200===s.status)if("text"===a)i(s.response);else{var e=new FileReader;e.addEventListener("load",(function(){return i(e.result)}),!1),e.addEventListener("error",(function(e){return o(e)}),!1),e.readAsDataURL(s.response)}else o("Failed to proxy resource "+r+" with status code "+s.status)},s.onerror=o,s.open("GET",n+"?url="+encodeURIComponent(e)+"&responseType="+a),"text"!==a&&s instanceof XMLHttpRequest&&(s.responseType=a),t._options.imageTimeout){var c=t._options.imageTimeout;s.timeout=c,s.ontimeout=function(){return o("Timed out ("+c+"ms) proxying "+r)}}s.send()}))},e}(),Mt=/^data:image\/svg\+xml/i,Lt=/^data:image\/.*;base64,/i,kt=/^data:image\/.*/i,Ut=function(e){return xt.SUPPORT_SVG_DRAWING||!Ht(e)},Dt=function(e){return kt.test(e)},Pt=function(e){return Lt.test(e)},Ft=function(e){return"blob"===e.substr(0,4)},Ht=function(e){return"svg"===e.substr(-3).toLowerCase()||Mt.test(e)},jt="closest-side",Vt="farthest-side",Qt="closest-corner",Gt="farthest-corner",zt="circle",Kt="ellipse",qt="cover",Wt="contain",Xt=function(e){var t=Jt.CIRCLE,n=Yt.FARTHEST_CORNER,r=[],i=[];return Qe(e).forEach((function(e,o){var a=!0;if(0===o?a=e.reduce((function(e,t){if(Pe(t))switch(t.value){case"center":return i.push(Xe),!1;case"top":case"left":return i.push(We),!1;case"right":case"bottom":return i.push(Je),!1}else if(Ke(t)||ze(t))return i.push(t),!1;return e}),a):1===o&&(a=e.reduce((function(e,r){if(Pe(r))switch(r.value){case zt:return t=Jt.CIRCLE,!1;case Kt:return t=Jt.ELLIPSE,!1;case Wt:case jt:return n=Yt.CLOSEST_SIDE,!1;case Vt:return n=Yt.FARTHEST_SIDE,!1;case Qt:return n=Yt.CLOSEST_CORNER,!1;case qt:case Gt:return n=Yt.FARTHEST_CORNER,!1}else if(ze(r)||Ke(r))return Array.isArray(n)||(n=[]),n.push(r),!1;return e}),a)),a){var s=bt(e);r.push(s)}})),{size:n,shape:t,stops:r,position:i,type:vt.RADIAL_GRADIENT}};!function(e){e[e.URL=0]="URL",e[e.LINEAR_GRADIENT=1]="LINEAR_GRADIENT",e[e.RADIAL_GRADIENT=2]="RADIAL_GRADIENT"}(vt||(vt={}));var Jt,Yt;!function(e){e[e.CIRCLE=0]="CIRCLE",e[e.ELLIPSE=1]="ELLIPSE"}(Jt||(Jt={})),function(e){e[e.CLOSEST_SIDE=0]="CLOSEST_SIDE",e[e.FARTHEST_SIDE=1]="FARTHEST_SIDE",e[e.CLOSEST_CORNER=2]="CLOSEST_CORNER",e[e.FARTHEST_CORNER=3]="FARTHEST_CORNER"}(Yt||(Yt={}));var Zt=function(e){if(e.type===h.URL_TOKEN){var t={url:e.value,type:vt.URL};return Nt.getInstance().addImage(e.value),t}if(e.type===h.FUNCTION){var n=en[e.name];if(void 0===n)throw new Error('Attempting to parse an unsupported image function "'+e.name+'"');return n(e.values)}throw new Error("Unsupported image type")};var $t,en={"linear-gradient":function(e){var t=it(180),n=[];return Qe(e).forEach((function(e,r){if(0===r){var i=e[0];if(i.type===h.IDENT_TOKEN&&"to"===i.value)return void(t=rt(e));if(nt(i))return void(t=tt(i))}var o=bt(e);n.push(o)})),{angle:t,stops:n,type:vt.LINEAR_GRADIENT}},"-moz-linear-gradient":Tt,"-ms-linear-gradient":Tt,"-o-linear-gradient":Tt,"-webkit-linear-gradient":Tt,"radial-gradient":function(e){var t=Jt.CIRCLE,n=Yt.FARTHEST_CORNER,r=[],i=[];return Qe(e).forEach((function(e,o){var a=!0;if(0===o){var s=!1;a=e.reduce((function(e,r){if(s)if(Pe(r))switch(r.value){case"center":return i.push(Xe),e;case"top":case"left":return i.push(We),e;case"right":case"bottom":return i.push(Je),e}else(Ke(r)||ze(r))&&i.push(r);else if(Pe(r))switch(r.value){case zt:return t=Jt.CIRCLE,!1;case Kt:return t=Jt.ELLIPSE,!1;case"at":return s=!0,!1;case jt:return n=Yt.CLOSEST_SIDE,!1;case qt:case Vt:return n=Yt.FARTHEST_SIDE,!1;case Wt:case Qt:return n=Yt.CLOSEST_CORNER,!1;case Gt:return n=Yt.FARTHEST_CORNER,!1}else if(ze(r)||Ke(r))return Array.isArray(n)||(n=[]),n.push(r),!1;return e}),a)}if(a){var c=bt(e);r.push(c)}})),{size:n,shape:t,stops:r,position:i,type:vt.RADIAL_GRADIENT}},"-moz-radial-gradient":Xt,"-ms-radial-gradient":Xt,"-o-radial-gradient":Xt,"-webkit-radial-gradient":Xt,"-webkit-gradient":function(e){var t=it(180),n=[],r=vt.LINEAR_GRADIENT,i=Jt.CIRCLE,o=Yt.FARTHEST_CORNER;return Qe(e).forEach((function(e,t){var i=e[0];if(0===t){if(Pe(i)&&"linear"===i.value)return void(r=vt.LINEAR_GRADIENT);if(Pe(i)&&"radial"===i.value)return void(r=vt.RADIAL_GRADIENT)}if(i.type===h.FUNCTION)if("from"===i.name){var o=ot(i.values[0]);n.push({stop:We,color:o})}else if("to"===i.name){o=ot(i.values[0]);n.push({stop:Je,color:o})}else if("color-stop"===i.name){var a=i.values.filter(Ve);if(2===a.length){o=ot(a[1]);var s=a[0];De(s)&&n.push({stop:{type:h.PERCENTAGE_TOKEN,number:100*s.number,flags:s.flags},color:o})}}})),r===vt.LINEAR_GRADIENT?{angle:(t+it(180))%it(360),stops:n,type:r}:{size:o,shape:i,stops:n,position:[],type:r}}},tn={name:"background-image",initialValue:"none",type:ht.LIST,prefix:!1,parse:function(e){if(0===e.length)return[];var t=e[0];return t.type===h.IDENT_TOKEN&&"none"===t.value?[]:e.filter((function(e){return Ve(e)&&function(e){return e.type!==h.FUNCTION||en[e.name]}(e)})).map(Zt)}},nn={name:"background-origin",initialValue:"border-box",prefix:!1,type:ht.LIST,parse:function(e){return e.map((function(e){if(Pe(e))switch(e.value){case"padding-box":return 1;case"content-box":return 2}return 0}))}},rn={name:"background-position",initialValue:"0% 0%",type:ht.LIST,prefix:!1,parse:function(e){return Qe(e).map((function(e){return e.filter(Ke)})).map(qe)}};!function(e){e[e.REPEAT=0]="REPEAT",e[e.NO_REPEAT=1]="NO_REPEAT",e[e.REPEAT_X=2]="REPEAT_X",e[e.REPEAT_Y=3]="REPEAT_Y"}($t||($t={}));var on,an={name:"background-repeat",initialValue:"repeat",prefix:!1,type:ht.LIST,parse:function(e){return Qe(e).map((function(e){return e.filter(Pe).map((function(e){return e.value})).join(" ")})).map(sn)}},sn=function(e){switch(e){case"no-repeat":return $t.NO_REPEAT;case"repeat-x":case"repeat no-repeat":return $t.REPEAT_X;case"repeat-y":case"no-repeat repeat":return $t.REPEAT_Y;case"repeat":default:return $t.REPEAT}};!function(e){e.AUTO="auto",e.CONTAIN="contain",e.COVER="cover"}(on||(on={}));var cn,un={name:"background-size",initialValue:"0",prefix:!1,type:ht.LIST,parse:function(e){return Qe(e).map((function(e){return e.filter(ln)}))}},ln=function(e){return Pe(e)||Ke(e)},dn=function(e){return{name:"border-"+e+"-color",initialValue:"transparent",prefix:!1,type:ht.TYPE_VALUE,format:"color"}},hn=dn("top"),fn=dn("right"),pn=dn("bottom"),An=dn("left"),gn=function(e){return{name:"border-radius-"+e,initialValue:"0 0",prefix:!1,type:ht.LIST,parse:function(e){return qe(e.filter(Ke))}}},vn=gn("top-left"),mn=gn("top-right"),yn=gn("bottom-right"),bn=gn("bottom-left");!function(e){e[e.NONE=0]="NONE",e[e.SOLID=1]="SOLID"}(cn||(cn={}));var En,_n=function(e){return{name:"border-"+e+"-style",initialValue:"solid",prefix:!1,type:ht.IDENT_VALUE,parse:function(e){switch(e){case"none":return cn.NONE}return cn.SOLID}}},wn=_n("top"),Sn=_n("right"),Tn=_n("bottom"),Rn=_n("left"),Cn=function(e){return{name:"border-"+e+"-width",initialValue:"0",type:ht.VALUE,prefix:!1,parse:function(e){return Ue(e)?e.number:0}}},In=Cn("top"),xn=Cn("right"),On=Cn("bottom"),Nn=Cn("left"),Bn={name:"color",initialValue:"transparent",prefix:!1,type:ht.TYPE_VALUE,format:"color"},Mn={name:"display",initialValue:"inline-block",prefix:!1,type:ht.LIST,parse:function(e){return e.filter(Pe).reduce((function(e,t){return e|Ln(t.value)}),0)}},Ln=function(e){switch(e){case"block":return 2;case"inline":return 4;case"run-in":return 8;case"flow":return 16;case"flow-root":return 32;case"table":return 64;case"flex":case"-webkit-flex":return 128;case"grid":case"-ms-grid":return 256;case"ruby":return 512;case"subgrid":return 1024;case"list-item":return 2048;case"table-row-group":return 4096;case"table-header-group":return 8192;case"table-footer-group":return 16384;case"table-row":return 32768;case"table-cell":return 65536;case"table-column-group":return 131072;case"table-column":return 262144;case"table-caption":return 524288;case"ruby-base":return 1048576;case"ruby-text":return 2097152;case"ruby-base-container":return 4194304;case"ruby-text-container":return 8388608;case"contents":return 16777216;case"inline-block":return 33554432;case"inline-list-item":return 67108864;case"inline-table":return 134217728;case"inline-flex":return 268435456;case"inline-grid":return 536870912}return 0};!function(e){e[e.NONE=0]="NONE",e[e.LEFT=1]="LEFT",e[e.RIGHT=2]="RIGHT",e[e.INLINE_START=3]="INLINE_START",e[e.INLINE_END=4]="INLINE_END"}(En||(En={}));var kn,Un={name:"float",initialValue:"none",prefix:!1,type:ht.IDENT_VALUE,parse:function(e){switch(e){case"left":return En.LEFT;case"right":return En.RIGHT;case"inline-start":return En.INLINE_START;case"inline-end":return En.INLINE_END}return En.NONE}},Dn={name:"letter-spacing",initialValue:"0",prefix:!1,type:ht.VALUE,parse:function(e){return e.type===h.IDENT_TOKEN&&"normal"===e.value?0:e.type===h.NUMBER_TOKEN||e.type===h.DIMENSION_TOKEN?e.number:0}};!function(e){e.NORMAL="normal",e.STRICT="strict"}(kn||(kn={}));var Pn,Fn={name:"line-break",initialValue:"normal",prefix:!1,type:ht.IDENT_VALUE,parse:function(e){switch(e){case"strict":return kn.STRICT;case"normal":default:return kn.NORMAL}}},Hn={name:"line-height",initialValue:"normal",prefix:!1,type:ht.TOKEN_VALUE},jn={name:"list-style-image",initialValue:"none",type:ht.VALUE,prefix:!1,parse:function(e){return e.type===h.IDENT_TOKEN&&"none"===e.value?null:Zt(e)}};!function(e){e[e.INSIDE=0]="INSIDE",e[e.OUTSIDE=1]="OUTSIDE"}(Pn||(Pn={}));var Vn,Qn={name:"list-style-position",initialValue:"outside",prefix:!1,type:ht.IDENT_VALUE,parse:function(e){switch(e){case"inside":return Pn.INSIDE;case"outside":default:return Pn.OUTSIDE}}};!function(e){e[e.NONE=-1]="NONE",e[e.DISC=0]="DISC",e[e.CIRCLE=1]="CIRCLE",e[e.SQUARE=2]="SQUARE",e[e.DECIMAL=3]="DECIMAL",e[e.CJK_DECIMAL=4]="CJK_DECIMAL",e[e.DECIMAL_LEADING_ZERO=5]="DECIMAL_LEADING_ZERO",e[e.LOWER_ROMAN=6]="LOWER_ROMAN",e[e.UPPER_ROMAN=7]="UPPER_ROMAN",e[e.LOWER_GREEK=8]="LOWER_GREEK",e[e.LOWER_ALPHA=9]="LOWER_ALPHA",e[e.UPPER_ALPHA=10]="UPPER_ALPHA",e[e.ARABIC_INDIC=11]="ARABIC_INDIC",e[e.ARMENIAN=12]="ARMENIAN",e[e.BENGALI=13]="BENGALI",e[e.CAMBODIAN=14]="CAMBODIAN",e[e.CJK_EARTHLY_BRANCH=15]="CJK_EARTHLY_BRANCH",e[e.CJK_HEAVENLY_STEM=16]="CJK_HEAVENLY_STEM",e[e.CJK_IDEOGRAPHIC=17]="CJK_IDEOGRAPHIC",e[e.DEVANAGARI=18]="DEVANAGARI",e[e.ETHIOPIC_NUMERIC=19]="ETHIOPIC_NUMERIC",e[e.GEORGIAN=20]="GEORGIAN",e[e.GUJARATI=21]="GUJARATI",e[e.GURMUKHI=22]="GURMUKHI",e[e.HEBREW=22]="HEBREW",e[e.HIRAGANA=23]="HIRAGANA",e[e.HIRAGANA_IROHA=24]="HIRAGANA_IROHA",e[e.JAPANESE_FORMAL=25]="JAPANESE_FORMAL",e[e.JAPANESE_INFORMAL=26]="JAPANESE_INFORMAL",e[e.KANNADA=27]="KANNADA",e[e.KATAKANA=28]="KATAKANA",e[e.KATAKANA_IROHA=29]="KATAKANA_IROHA",e[e.KHMER=30]="KHMER",e[e.KOREAN_HANGUL_FORMAL=31]="KOREAN_HANGUL_FORMAL",e[e.KOREAN_HANJA_FORMAL=32]="KOREAN_HANJA_FORMAL",e[e.KOREAN_HANJA_INFORMAL=33]="KOREAN_HANJA_INFORMAL",e[e.LAO=34]="LAO",e[e.LOWER_ARMENIAN=35]="LOWER_ARMENIAN",e[e.MALAYALAM=36]="MALAYALAM",e[e.MONGOLIAN=37]="MONGOLIAN",e[e.MYANMAR=38]="MYANMAR",e[e.ORIYA=39]="ORIYA",e[e.PERSIAN=40]="PERSIAN",e[e.SIMP_CHINESE_FORMAL=41]="SIMP_CHINESE_FORMAL",e[e.SIMP_CHINESE_INFORMAL=42]="SIMP_CHINESE_INFORMAL",e[e.TAMIL=43]="TAMIL",e[e.TELUGU=44]="TELUGU",e[e.THAI=45]="THAI",e[e.TIBETAN=46]="TIBETAN",e[e.TRAD_CHINESE_FORMAL=47]="TRAD_CHINESE_FORMAL",e[e.TRAD_CHINESE_INFORMAL=48]="TRAD_CHINESE_INFORMAL",e[e.UPPER_ARMENIAN=49]="UPPER_ARMENIAN",e[e.DISCLOSURE_OPEN=50]="DISCLOSURE_OPEN",e[e.DISCLOSURE_CLOSED=51]="DISCLOSURE_CLOSED"}(Vn||(Vn={}));var Gn,zn={name:"list-style-type",initialValue:"none",prefix:!1,type:ht.IDENT_VALUE,parse:function(e){switch(e){case"disc":return Vn.DISC;case"circle":return Vn.CIRCLE;case"square":return Vn.SQUARE;case"decimal":return Vn.DECIMAL;case"cjk-decimal":return Vn.CJK_DECIMAL;case"decimal-leading-zero":return Vn.DECIMAL_LEADING_ZERO;case"lower-roman":return Vn.LOWER_ROMAN;case"upper-roman":return Vn.UPPER_ROMAN;case"lower-greek":return Vn.LOWER_GREEK;case"lower-alpha":return Vn.LOWER_ALPHA;case"upper-alpha":return Vn.UPPER_ALPHA;case"arabic-indic":return Vn.ARABIC_INDIC;case"armenian":return Vn.ARMENIAN;case"bengali":return Vn.BENGALI;case"cambodian":return Vn.CAMBODIAN;case"cjk-earthly-branch":return Vn.CJK_EARTHLY_BRANCH;case"cjk-heavenly-stem":return Vn.CJK_HEAVENLY_STEM;case"cjk-ideographic":return Vn.CJK_IDEOGRAPHIC;case"devanagari":return Vn.DEVANAGARI;case"ethiopic-numeric":return Vn.ETHIOPIC_NUMERIC;case"georgian":return Vn.GEORGIAN;case"gujarati":return Vn.GUJARATI;case"gurmukhi":return Vn.GURMUKHI;case"hebrew":return Vn.HEBREW;case"hiragana":return Vn.HIRAGANA;case"hiragana-iroha":return Vn.HIRAGANA_IROHA;case"japanese-formal":return Vn.JAPANESE_FORMAL;case"japanese-informal":return Vn.JAPANESE_INFORMAL;case"kannada":return Vn.KANNADA;case"katakana":return Vn.KATAKANA;case"katakana-iroha":return Vn.KATAKANA_IROHA;case"khmer":return Vn.KHMER;case"korean-hangul-formal":return Vn.KOREAN_HANGUL_FORMAL;case"korean-hanja-formal":return Vn.KOREAN_HANJA_FORMAL;case"korean-hanja-informal":return Vn.KOREAN_HANJA_INFORMAL;case"lao":return Vn.LAO;case"lower-armenian":return Vn.LOWER_ARMENIAN;case"malayalam":return Vn.MALAYALAM;case"mongolian":return Vn.MONGOLIAN;case"myanmar":return Vn.MYANMAR;case"oriya":return Vn.ORIYA;case"persian":return Vn.PERSIAN;case"simp-chinese-formal":return Vn.SIMP_CHINESE_FORMAL;case"simp-chinese-informal":return Vn.SIMP_CHINESE_INFORMAL;case"tamil":return Vn.TAMIL;case"telugu":return Vn.TELUGU;case"thai":return Vn.THAI;case"tibetan":return Vn.TIBETAN;case"trad-chinese-formal":return Vn.TRAD_CHINESE_FORMAL;case"trad-chinese-informal":return Vn.TRAD_CHINESE_INFORMAL;case"upper-armenian":return Vn.UPPER_ARMENIAN;case"disclosure-open":return Vn.DISCLOSURE_OPEN;case"disclosure-closed":return Vn.DISCLOSURE_CLOSED;case"none":default:return Vn.NONE}}},Kn=function(e){return{name:"margin-"+e,initialValue:"0",prefix:!1,type:ht.TOKEN_VALUE}},qn=Kn("top"),Wn=Kn("right"),Xn=Kn("bottom"),Jn=Kn("left");!function(e){e[e.VISIBLE=0]="VISIBLE",e[e.HIDDEN=1]="HIDDEN",e[e.SCROLL=2]="SCROLL",e[e.AUTO=3]="AUTO"}(Gn||(Gn={}));var Yn,Zn={name:"overflow",initialValue:"visible",prefix:!1,type:ht.LIST,parse:function(e){return e.filter(Pe).map((function(e){switch(e.value){case"hidden":return Gn.HIDDEN;case"scroll":return Gn.SCROLL;case"auto":return Gn.AUTO;case"visible":default:return Gn.VISIBLE}}))}};!function(e){e.NORMAL="normal",e.BREAK_WORD="break-word"}(Yn||(Yn={}));var $n,er={name:"overflow-wrap",initialValue:"normal",prefix:!1,type:ht.IDENT_VALUE,parse:function(e){switch(e){case"break-word":return Yn.BREAK_WORD;case"normal":default:return Yn.NORMAL}}},tr=function(e){return{name:"padding-"+e,initialValue:"0",prefix:!1,type:ht.TYPE_VALUE,format:"length-percentage"}},nr=tr("top"),rr=tr("right"),ir=tr("bottom"),or=tr("left");!function(e){e[e.LEFT=0]="LEFT",e[e.CENTER=1]="CENTER",e[e.RIGHT=2]="RIGHT"}($n||($n={}));var ar,sr={name:"text-align",initialValue:"left",prefix:!1,type:ht.IDENT_VALUE,parse:function(e){switch(e){case"right":return $n.RIGHT;case"center":case"justify":return $n.CENTER;case"left":default:return $n.LEFT}}};!function(e){e[e.STATIC=0]="STATIC",e[e.RELATIVE=1]="RELATIVE",e[e.ABSOLUTE=2]="ABSOLUTE",e[e.FIXED=3]="FIXED",e[e.STICKY=4]="STICKY"}(ar||(ar={}));var cr,ur={name:"position",initialValue:"static",prefix:!1,type:ht.IDENT_VALUE,parse:function(e){switch(e){case"relative":return ar.RELATIVE;case"absolute":return ar.ABSOLUTE;case"fixed":return ar.FIXED;case"sticky":return ar.STICKY}return ar.STATIC}},lr={name:"text-shadow",initialValue:"none",type:ht.LIST,prefix:!1,parse:function(e){return 1===e.length&&He(e[0],"none")?[]:Qe(e).map((function(e){for(var t={color:gt.TRANSPARENT,offsetX:We,offsetY:We,blur:We},n=0,r=0;r<e.length;r++){var i=e[r];ze(i)?(0===n?t.offsetX=i:1===n?t.offsetY=i:t.blur=i,n++):t.color=ot(i)}return t}))}};!function(e){e[e.NONE=0]="NONE",e[e.LOWERCASE=1]="LOWERCASE",e[e.UPPERCASE=2]="UPPERCASE",e[e.CAPITALIZE=3]="CAPITALIZE"}(cr||(cr={}));var dr,hr={name:"text-transform",initialValue:"none",prefix:!1,type:ht.IDENT_VALUE,parse:function(e){switch(e){case"uppercase":return cr.UPPERCASE;case"lowercase":return cr.LOWERCASE;case"capitalize":return cr.CAPITALIZE}return cr.NONE}},fr={name:"transform",initialValue:"none",prefix:!0,type:ht.VALUE,parse:function(e){if(e.type===h.IDENT_TOKEN&&"none"===e.value)return null;if(e.type===h.FUNCTION){var t=pr[e.name];if(void 0===t)throw new Error('Attempting to parse an unsupported transform function "'+e.name+'"');return t(e.values)}return null}},pr={matrix:function(e){var t=e.filter((function(e){return e.type===h.NUMBER_TOKEN})).map((function(e){return e.number}));return 6===t.length?t:null},matrix3d:function(e){var t=e.filter((function(e){return e.type===h.NUMBER_TOKEN})).map((function(e){return e.number})),n=t[0],r=t[1],i=(t[2],t[3],t[4]),o=t[5],a=(t[6],t[7],t[8],t[9],t[10],t[11],t[12]),s=t[13];t[14],t[15];return 16===t.length?[n,r,i,o,a,s]:null}},Ar={type:h.PERCENTAGE_TOKEN,number:50,flags:4},gr=[Ar,Ar],vr={name:"transform-origin",initialValue:"50% 50%",prefix:!0,type:ht.LIST,parse:function(e){var t=e.filter(Ke);return 2!==t.length?gr:[t[0],t[1]]}};!function(e){e[e.VISIBLE=0]="VISIBLE",e[e.HIDDEN=1]="HIDDEN",e[e.COLLAPSE=2]="COLLAPSE"}(dr||(dr={}));var mr,yr={name:"visible",initialValue:"none",prefix:!1,type:ht.IDENT_VALUE,parse:function(e){switch(e){case"hidden":return dr.HIDDEN;case"collapse":return dr.COLLAPSE;case"visible":default:return dr.VISIBLE}}};!function(e){e.NORMAL="normal",e.BREAK_ALL="break-all",e.KEEP_ALL="keep-all"}(mr||(mr={}));var br,Er={name:"word-break",initialValue:"normal",prefix:!1,type:ht.IDENT_VALUE,parse:function(e){switch(e){case"break-all":return mr.BREAK_ALL;case"keep-all":return mr.KEEP_ALL;case"normal":default:return mr.NORMAL}}},_r={name:"z-index",initialValue:"auto",prefix:!1,type:ht.VALUE,parse:function(e){if(e.type===h.IDENT_TOKEN)return{auto:!0,order:0};if(De(e))return{auto:!1,order:e.number};throw new Error("Invalid z-index number parsed")}},wr={name:"opacity",initialValue:"1",type:ht.VALUE,prefix:!1,parse:function(e){return De(e)?e.number:1}},Sr={name:"text-decoration-color",initialValue:"transparent",prefix:!1,type:ht.TYPE_VALUE,format:"color"},Tr={name:"text-decoration-line",initialValue:"none",prefix:!1,type:ht.LIST,parse:function(e){return e.filter(Pe).map((function(e){switch(e.value){case"underline":return 1;case"overline":return 2;case"line-through":return 3;case"none":return 4}return 0})).filter((function(e){return 0!==e}))}},Rr={name:"font-family",initialValue:"",prefix:!1,type:ht.LIST,parse:function(e){var t=[],n=[];return e.forEach((function(e){switch(e.type){case h.IDENT_TOKEN:case h.STRING_TOKEN:t.push(e.value);break;case h.NUMBER_TOKEN:t.push(e.number.toString());break;case h.COMMA_TOKEN:n.push(t.join(" ")),t.length=0}})),t.length&&n.push(t.join(" ")),n.map((function(e){return-1===e.indexOf(" ")?e:"'"+e+"'"}))}},Cr={name:"font-size",initialValue:"0",prefix:!1,type:ht.TYPE_VALUE,format:"length"},Ir={name:"font-weight",initialValue:"normal",type:ht.VALUE,prefix:!1,parse:function(e){if(De(e))return e.number;if(Pe(e))switch(e.value){case"bold":return 700;case"normal":default:return 400}return 400}},xr={name:"font-variant",initialValue:"none",type:ht.LIST,prefix:!1,parse:function(e){return e.filter(Pe).map((function(e){return e.value}))}};!function(e){e.NORMAL="normal",e.ITALIC="italic",e.OBLIQUE="oblique"}(br||(br={}));var Or,Nr={name:"font-style",initialValue:"normal",prefix:!1,type:ht.IDENT_VALUE,parse:function(e){switch(e){case"oblique":return br.OBLIQUE;case"italic":return br.ITALIC;case"normal":default:return br.NORMAL}}},Br=function(e,t){return 0!=(e&t)},Mr={name:"content",initialValue:"none",type:ht.LIST,prefix:!1,parse:function(e){if(0===e.length)return[];var t=e[0];return t.type===h.IDENT_TOKEN&&"none"===t.value?[]:e}},Lr={name:"counter-increment",initialValue:"none",prefix:!0,type:ht.LIST,parse:function(e){if(0===e.length)return null;var t=e[0];if(t.type===h.IDENT_TOKEN&&"none"===t.value)return null;for(var n=[],r=e.filter(je),i=0;i<r.length;i++){var o=r[i],a=r[i+1];if(o.type===h.IDENT_TOKEN){var s=a&&De(a)?a.number:1;n.push({counter:o.value,increment:s})}}return n}},kr={name:"counter-reset",initialValue:"none",prefix:!0,type:ht.LIST,parse:function(e){if(0===e.length)return[];for(var t=[],n=e.filter(je),r=0;r<n.length;r++){var i=n[r],o=n[r+1];if(Pe(i)&&"none"!==i.value){var a=o&&De(o)?o.number:0;t.push({counter:i.value,reset:a})}}return t}},Ur={name:"quotes",initialValue:"none",prefix:!0,type:ht.LIST,parse:function(e){if(0===e.length)return null;var t=e[0];if(t.type===h.IDENT_TOKEN&&"none"===t.value)return null;var n=[],r=e.filter(Fe);if(r.length%2!=0)return null;for(var i=0;i<r.length;i+=2){var o=r[i].value,a=r[i+1].value;n.push({open:o,close:a})}return n}},Dr=function(e,t,n){if(!e)return"";var r=e[Math.min(t,e.length-1)];return r?n?r.open:r.close:""},Pr={name:"box-shadow",initialValue:"none",type:ht.LIST,prefix:!1,parse:function(e){return 1===e.length&&He(e[0],"none")?[]:Qe(e).map((function(e){for(var t={color:255,offsetX:We,offsetY:We,blur:We,spread:We,inset:!1},n=0,r=0;r<e.length;r++){var i=e[r];He(i,"inset")?t.inset=!0:ze(i)?(0===n?t.offsetX=i:1===n?t.offsetY=i:2===n?t.blur=i:t.spread=i,n++):t.color=ot(i)}return t}))}},Fr=function(){function e(e){this.backgroundClip=Vr(mt,e.backgroundClip),this.backgroundColor=Vr(yt,e.backgroundColor),this.backgroundImage=Vr(tn,e.backgroundImage),this.backgroundOrigin=Vr(nn,e.backgroundOrigin),this.backgroundPosition=Vr(rn,e.backgroundPosition),this.backgroundRepeat=Vr(an,e.backgroundRepeat),this.backgroundSize=Vr(un,e.backgroundSize),this.borderTopColor=Vr(hn,e.borderTopColor),this.borderRightColor=Vr(fn,e.borderRightColor),this.borderBottomColor=Vr(pn,e.borderBottomColor),this.borderLeftColor=Vr(An,e.borderLeftColor),this.borderTopLeftRadius=Vr(vn,e.borderTopLeftRadius),this.borderTopRightRadius=Vr(mn,e.borderTopRightRadius),this.borderBottomRightRadius=Vr(yn,e.borderBottomRightRadius),this.borderBottomLeftRadius=Vr(bn,e.borderBottomLeftRadius),this.borderTopStyle=Vr(wn,e.borderTopStyle),this.borderRightStyle=Vr(Sn,e.borderRightStyle),this.borderBottomStyle=Vr(Tn,e.borderBottomStyle),this.borderLeftStyle=Vr(Rn,e.borderLeftStyle),this.borderTopWidth=Vr(In,e.borderTopWidth),this.borderRightWidth=Vr(xn,e.borderRightWidth),this.borderBottomWidth=Vr(On,e.borderBottomWidth),this.borderLeftWidth=Vr(Nn,e.borderLeftWidth),this.boxShadow=Vr(Pr,e.boxShadow),this.color=Vr(Bn,e.color),this.display=Vr(Mn,e.display),this.float=Vr(Un,e.cssFloat),this.fontFamily=Vr(Rr,e.fontFamily),this.fontSize=Vr(Cr,e.fontSize),this.fontStyle=Vr(Nr,e.fontStyle),this.fontVariant=Vr(xr,e.fontVariant),this.fontWeight=Vr(Ir,e.fontWeight),this.letterSpacing=Vr(Dn,e.letterSpacing),this.lineBreak=Vr(Fn,e.lineBreak),this.lineHeight=Vr(Hn,e.lineHeight),this.listStyleImage=Vr(jn,e.listStyleImage),this.listStylePosition=Vr(Qn,e.listStylePosition),this.listStyleType=Vr(zn,e.listStyleType),this.marginTop=Vr(qn,e.marginTop),this.marginRight=Vr(Wn,e.marginRight),this.marginBottom=Vr(Xn,e.marginBottom),this.marginLeft=Vr(Jn,e.marginLeft),this.opacity=Vr(wr,e.opacity);var t=Vr(Zn,e.overflow);this.overflowX=t[0],this.overflowY=t[t.length>1?1:0],this.overflowWrap=Vr(er,e.overflowWrap),this.paddingTop=Vr(nr,e.paddingTop),this.paddingRight=Vr(rr,e.paddingRight),this.paddingBottom=Vr(ir,e.paddingBottom),this.paddingLeft=Vr(or,e.paddingLeft),this.position=Vr(ur,e.position),this.textAlign=Vr(sr,e.textAlign),this.textDecorationColor=Vr(Sr,e.textDecorationColor||e.color),this.textDecorationLine=Vr(Tr,e.textDecorationLine),this.textShadow=Vr(lr,e.textShadow),this.textTransform=Vr(hr,e.textTransform),this.transform=Vr(fr,e.transform),this.transformOrigin=Vr(vr,e.transformOrigin),this.visibility=Vr(yr,e.visibility),this.wordBreak=Vr(Er,e.wordBreak),this.zIndex=Vr(_r,e.zIndex)}return e.prototype.isVisible=function(){return this.display>0&&this.opacity>0&&this.visibility===dr.VISIBLE},e.prototype.isTransparent=function(){return at(this.backgroundColor)},e.prototype.isTransformed=function(){return null!==this.transform},e.prototype.isPositioned=function(){return this.position!==ar.STATIC},e.prototype.isPositionedWithZIndex=function(){return this.isPositioned()&&!this.zIndex.auto},e.prototype.isFloating=function(){return this.float!==En.NONE},e.prototype.isInlineLevel=function(){return Br(this.display,4)||Br(this.display,33554432)||Br(this.display,268435456)||Br(this.display,536870912)||Br(this.display,67108864)||Br(this.display,134217728)},e}(),Hr=function(e){this.content=Vr(Mr,e.content),this.quotes=Vr(Ur,e.quotes)},jr=function(e){this.counterIncrement=Vr(Lr,e.counterIncrement),this.counterReset=Vr(kr,e.counterReset)},Vr=function(e,t){var n=new Le,r=null!=t?t.toString():e.initialValue;n.write(r);var i=new ke(n.read());switch(e.type){case ht.IDENT_VALUE:var o=i.parseComponentValue();return e.parse(Pe(o)?o.value:e.initialValue);case ht.VALUE:return e.parse(i.parseComponentValue());case ht.LIST:return e.parse(i.parseComponentValues());case ht.TOKEN_VALUE:return i.parseComponentValue();case ht.TYPE_VALUE:switch(e.format){case"angle":return tt(i.parseComponentValue());case"color":return ot(i.parseComponentValue());case"image":return Zt(i.parseComponentValue());case"length":var a=i.parseComponentValue();return ze(a)?a:We;case"length-percentage":var s=i.parseComponentValue();return Ke(s)?s:We}}throw new Error("Attempting to parse unsupported css format type "+e.format)},Qr=function(e){this.styles=new Fr(window.getComputedStyle(e,null)),this.textNodes=[],this.elements=[],null!==this.styles.transform&&wi(e)&&(e.style.transform="none"),this.bounds=a(e),this.flags=0},Gr=function(e,t){this.text=e,this.bounds=t},zr=function(e){var t=e.ownerDocument;if(t){var n=t.createElement("html2canvaswrapper");n.appendChild(e.cloneNode(!0));var r=e.parentNode;if(r){r.replaceChild(n,e);var i=a(n);return n.firstChild&&r.replaceChild(n.firstChild,n),i}}return new o(0,0,0,0)},Kr=function(e,t,n){var r=e.ownerDocument;if(!r)throw new Error("Node has no owner document");var i=r.createRange();return i.setStart(e,t),i.setEnd(e,t+n),o.fromClientRect(i.getBoundingClientRect())},qr=function(e,t){return 0!==t.letterSpacing?s(e).map((function(e){return c(e)})):Wr(e,t)},Wr=function(e,t){for(var n,r=function(e,t){var n=s(e),r=Z(n,t),i=r[0],o=r[1],a=r[2],c=n.length,u=0,l=0;return{next:function(){if(l>=c)return{done:!0,value:null};for(var e=F;l<c&&(e=Y(n,o,i,++l,a))===F;);if(e!==F||l===c){var t=new $(n,e,u,l);return u=l,{value:t,done:!1}}return{done:!0,value:null}}}}(e,{lineBreak:t.lineBreak,wordBreak:t.overflowWrap===Yn.BREAK_WORD?"break-word":t.wordBreak}),i=[];!(n=r.next()).done;)n.value&&i.push(n.value.slice());return i},Xr=function(e,t){this.text=Jr(e.data,t.textTransform),this.textBounds=function(e,t,n){var r=qr(e,t),i=[],o=0;return r.forEach((function(e){if(t.textDecorationLine.length||e.trim().length>0)if(xt.SUPPORT_RANGE_BOUNDS)i.push(new Gr(e,Kr(n,o,e.length)));else{var r=n.splitText(e.length);i.push(new Gr(e,zr(n))),n=r}else xt.SUPPORT_RANGE_BOUNDS||(n=n.splitText(e.length));o+=e.length})),i}(this.text,t,e)},Jr=function(e,t){switch(t){case cr.LOWERCASE:return e.toLowerCase();case cr.CAPITALIZE:return e.replace(Yr,Zr);case cr.UPPERCASE:return e.toUpperCase();default:return e}},Yr=/(^|\s|:|-|\(|\))([a-z])/g,Zr=function(e,t,n){return e.length>0?t+n.toUpperCase():e},$r=function(e){function n(t){var n=e.call(this,t)||this;return n.src=t.currentSrc||t.src,n.intrinsicWidth=t.naturalWidth,n.intrinsicHeight=t.naturalHeight,Nt.getInstance().addImage(n.src),n}return t(n,e),n}(Qr),ei=function(e){function n(t){var n=e.call(this,t)||this;return n.canvas=t,n.intrinsicWidth=t.width,n.intrinsicHeight=t.height,n}return t(n,e),n}(Qr),ti=function(e){function n(t){var n=e.call(this,t)||this,r=new XMLSerializer;return n.svg="data:image/svg+xml,"+encodeURIComponent(r.serializeToString(t)),n.intrinsicWidth=t.width.baseVal.value,n.intrinsicHeight=t.height.baseVal.value,Nt.getInstance().addImage(n.svg),n}return t(n,e),n}(Qr),ni=function(e){function n(t){var n=e.call(this,t)||this;return n.value=t.value,n}return t(n,e),n}(Qr),ri=function(e){function n(t){var n=e.call(this,t)||this;return n.start=t.start,n.reversed="boolean"==typeof t.reversed&&!0===t.reversed,n}return t(n,e),n}(Qr),ii=[{type:h.DIMENSION_TOKEN,flags:0,unit:"px",number:3}],oi=[{type:h.PERCENTAGE_TOKEN,flags:0,number:50}],ai="checkbox",si="radio",ci="password",ui=707406591,li=function(e){function n(t){var n,r,i,a=e.call(this,t)||this;switch(a.type=t.type.toLowerCase(),a.checked=t.checked,a.value=0===(r=(n=t).type===ci?new Array(n.value.length+1).join("•"):n.value).length?n.placeholder||"":r,a.type!==ai&&a.type!==si||(a.styles.backgroundColor=3739148031,a.styles.borderTopColor=a.styles.borderRightColor=a.styles.borderBottomColor=a.styles.borderLeftColor=2779096575,a.styles.borderTopWidth=a.styles.borderRightWidth=a.styles.borderBottomWidth=a.styles.borderLeftWidth=1,a.styles.borderTopStyle=a.styles.borderRightStyle=a.styles.borderBottomStyle=a.styles.borderLeftStyle=cn.SOLID,a.styles.backgroundClip=[ft.BORDER_BOX],a.styles.backgroundOrigin=[0],a.bounds=(i=a.bounds).width>i.height?new o(i.left+(i.width-i.height)/2,i.top,i.height,i.height):i.width<i.height?new o(i.left,i.top+(i.height-i.width)/2,i.width,i.width):i),a.type){case ai:a.styles.borderTopRightRadius=a.styles.borderTopLeftRadius=a.styles.borderBottomRightRadius=a.styles.borderBottomLeftRadius=ii;break;case si:a.styles.borderTopRightRadius=a.styles.borderTopLeftRadius=a.styles.borderBottomRightRadius=a.styles.borderBottomLeftRadius=oi}return a}return t(n,e),n}(Qr),di=function(e){function n(t){var n=e.call(this,t)||this,r=t.options[t.selectedIndex||0];return n.value=r&&r.text||"",n}return t(n,e),n}(Qr),hi=function(e){function n(t){var n=e.call(this,t)||this;return n.value=t.value,n}return t(n,e),n}(Qr),fi=function(e){return ot(ke.create(e).parseComponentValue())},pi=function(e){function n(t){var n=e.call(this,t)||this;n.src=t.src,n.width=parseInt(t.width,10)||0,n.height=parseInt(t.height,10)||0,n.backgroundColor=n.styles.backgroundColor;try{if(t.contentWindow&&t.contentWindow.document&&t.contentWindow.document.documentElement){n.tree=mi(t.contentWindow.document.documentElement);var r=t.contentWindow.document.documentElement?fi(getComputedStyle(t.contentWindow.document.documentElement).backgroundColor):gt.TRANSPARENT,i=t.contentWindow.document.body?fi(getComputedStyle(t.contentWindow.document.body).backgroundColor):gt.TRANSPARENT;n.backgroundColor=at(r)?at(i)?n.styles.backgroundColor:i:r}}catch(e){}return n}return t(n,e),n}(Qr),Ai=["OL","UL","MENU"],gi=function(e,t,n){for(var r=e.firstChild,i=void 0;r;r=i)if(i=r.nextSibling,Ei(r)&&r.data.trim().length>0)t.textNodes.push(new Xr(r,t.styles));else if(_i(r)){var o=vi(r);o.styles.isVisible()&&(yi(r,o,n)?o.flags|=4:bi(o.styles)&&(o.flags|=2),-1!==Ai.indexOf(r.tagName)&&(o.flags|=8),t.elements.push(o),ki(r)||Ii(r)||Ui(r)||gi(r,o,n))}},vi=function(e){return Ni(e)?new $r(e):Oi(e)?new ei(e):Ii(e)?new ti(e):Ti(e)?new ni(e):Ri(e)?new ri(e):Ci(e)?new li(e):Ui(e)?new di(e):ki(e)?new hi(e):Bi(e)?new pi(e):new Qr(e)},mi=function(e){var t=vi(e);return t.flags|=4,gi(e,t,t),t},yi=function(e,t,n){return t.styles.isPositionedWithZIndex()||t.styles.opacity<1||t.styles.isTransformed()||xi(e)&&n.styles.isTransparent()},bi=function(e){return e.isPositioned()||e.isFloating()},Ei=function(e){return e.nodeType===Node.TEXT_NODE},_i=function(e){return e.nodeType===Node.ELEMENT_NODE},wi=function(e){return _i(e)&&void 0!==e.style&&!Si(e)},Si=function(e){return"object"==typeof e.className},Ti=function(e){return"LI"===e.tagName},Ri=function(e){return"OL"===e.tagName},Ci=function(e){return"INPUT"===e.tagName},Ii=function(e){return"svg"===e.tagName},xi=function(e){return"BODY"===e.tagName},Oi=function(e){return"CANVAS"===e.tagName},Ni=function(e){return"IMG"===e.tagName},Bi=function(e){return"IFRAME"===e.tagName},Mi=function(e){return"STYLE"===e.tagName},Li=function(e){return"SCRIPT"===e.tagName},ki=function(e){return"TEXTAREA"===e.tagName},Ui=function(e){return"SELECT"===e.tagName},Di=function(){function e(){this.counters={}}return e.prototype.getCounterValue=function(e){var t=this.counters[e];return t&&t.length?t[t.length-1]:1},e.prototype.getCounterValues=function(e){var t=this.counters[e];return t||[]},e.prototype.pop=function(e){var t=this;e.forEach((function(e){return t.counters[e].pop()}))},e.prototype.parse=function(e){var t=this,n=e.counterIncrement,r=e.counterReset,i=!0;null!==n&&n.forEach((function(e){var n=t.counters[e.counter];n&&0!==e.increment&&(i=!1,n[Math.max(0,n.length-1)]+=e.increment)}));var o=[];return i&&r.forEach((function(e){var n=t.counters[e.counter];o.push(e.counter),n||(n=t.counters[e.counter]=[]),n.push(e.reset)})),o},e}(),Pi={integers:[1e3,900,500,400,100,90,50,40,10,9,5,4,1],values:["M","CM","D","CD","C","XC","L","XL","X","IX","V","IV","I"]},Fi={integers:[9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["Ք","Փ","Ւ","Ց","Ր","Տ","Վ","Ս","Ռ","Ջ","Պ","Չ","Ո","Շ","Ն","Յ","Մ","Ճ","Ղ","Ձ","Հ","Կ","Ծ","Խ","Լ","Ի","Ժ","Թ","Ը","Է","Զ","Ե","Դ","Գ","Բ","Ա"]},Hi={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,400,300,200,100,90,80,70,60,50,40,30,20,19,18,17,16,15,10,9,8,7,6,5,4,3,2,1],values:["י׳","ט׳","ח׳","ז׳","ו׳","ה׳","ד׳","ג׳","ב׳","א׳","ת","ש","ר","ק","צ","פ","ע","ס","נ","מ","ל","כ","יט","יח","יז","טז","טו","י","ט","ח","ז","ו","ה","ד","ג","ב","א"]},ji={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["ჵ","ჰ","ჯ","ჴ","ხ","ჭ","წ","ძ","ც","ჩ","შ","ყ","ღ","ქ","ფ","ჳ","ტ","ს","რ","ჟ","პ","ო","ჲ","ნ","მ","ლ","კ","ი","თ","ჱ","ზ","ვ","ე","დ","გ","ბ","ა"]},Vi=function(e,t,n,r,i,o){return e<t||e>n?Yi(e,i,o.length>0):r.integers.reduce((function(t,n,i){for(;e>=n;)e-=n,t+=r.values[i];return t}),"")+o},Qi=function(e,t,n,r){var i="";do{n||e--,i=r(e)+i,e/=t}while(e*t>=t);return i},Gi=function(e,t,n,r,i){var o=n-t+1;return(e<0?"-":"")+(Qi(Math.abs(e),o,r,(function(e){return c(Math.floor(e%o)+t)}))+i)},zi=function(e,t,n){void 0===n&&(n=". ");var r=t.length;return Qi(Math.abs(e),r,!1,(function(e){return t[Math.floor(e%r)]}))+n},Ki=function(e,t,n,r,i,o){if(e<-9999||e>9999)return Yi(e,Vn.CJK_DECIMAL,i.length>0);var a=Math.abs(e),s=i;if(0===a)return t[0]+s;for(var c=0;a>0&&c<=4;c++){var u=a%10;0===u&&Br(o,1)&&""!==s?s=t[u]+s:u>1||1===u&&0===c||1===u&&1===c&&Br(o,2)||1===u&&1===c&&Br(o,4)&&e>100||1===u&&c>1&&Br(o,8)?s=t[u]+(c>0?n[c-1]:"")+s:1===u&&c>0&&(s=n[c-1]+s),a=Math.floor(a/10)}return(e<0?r:"")+s},qi="十百千萬",Wi="拾佰仟萬",Xi="マイナス",Ji="마이너스",Yi=function(e,t,n){var r=n?". ":"",i=n?"、":"",o=n?", ":"",a=n?" ":"";switch(t){case Vn.DISC:return"•"+a;case Vn.CIRCLE:return"◦"+a;case Vn.SQUARE:return"◾"+a;case Vn.DECIMAL_LEADING_ZERO:var s=Gi(e,48,57,!0,r);return s.length<4?"0"+s:s;case Vn.CJK_DECIMAL:return zi(e,"〇一二三四五六七八九",i);case Vn.LOWER_ROMAN:return Vi(e,1,3999,Pi,Vn.DECIMAL,r).toLowerCase();case Vn.UPPER_ROMAN:return Vi(e,1,3999,Pi,Vn.DECIMAL,r);case Vn.LOWER_GREEK:return Gi(e,945,969,!1,r);case Vn.LOWER_ALPHA:return Gi(e,97,122,!1,r);case Vn.UPPER_ALPHA:return Gi(e,65,90,!1,r);case Vn.ARABIC_INDIC:return Gi(e,1632,1641,!0,r);case Vn.ARMENIAN:case Vn.UPPER_ARMENIAN:return Vi(e,1,9999,Fi,Vn.DECIMAL,r);case Vn.LOWER_ARMENIAN:return Vi(e,1,9999,Fi,Vn.DECIMAL,r).toLowerCase();case Vn.BENGALI:return Gi(e,2534,2543,!0,r);case Vn.CAMBODIAN:case Vn.KHMER:return Gi(e,6112,6121,!0,r);case Vn.CJK_EARTHLY_BRANCH:return zi(e,"子丑寅卯辰巳午未申酉戌亥",i);case Vn.CJK_HEAVENLY_STEM:return zi(e,"甲乙丙丁戊己庚辛壬癸",i);case Vn.CJK_IDEOGRAPHIC:case Vn.TRAD_CHINESE_INFORMAL:return Ki(e,"零一二三四五六七八九",qi,"負",i,14);case Vn.TRAD_CHINESE_FORMAL:return Ki(e,"零壹貳參肆伍陸柒捌玖",Wi,"負",i,15);case Vn.SIMP_CHINESE_INFORMAL:return Ki(e,"零一二三四五六七八九",qi,"负",i,14);case Vn.SIMP_CHINESE_FORMAL:return Ki(e,"零壹贰叁肆伍陆柒捌玖",Wi,"负",i,15);case Vn.JAPANESE_INFORMAL:return Ki(e,"〇一二三四五六七八九","十百千万",Xi,i,0);case Vn.JAPANESE_FORMAL:return Ki(e,"零壱弐参四伍六七八九","拾百千万",Xi,i,7);case Vn.KOREAN_HANGUL_FORMAL:return Ki(e,"영일이삼사오육칠팔구","십백천만",Ji,o,7);case Vn.KOREAN_HANJA_INFORMAL:return Ki(e,"零一二三四五六七八九","十百千萬",Ji,o,0);case Vn.KOREAN_HANJA_FORMAL:return Ki(e,"零壹貳參四五六七八九","拾百千",Ji,o,7);case Vn.DEVANAGARI:return Gi(e,2406,2415,!0,r);case Vn.GEORGIAN:return Vi(e,1,19999,ji,Vn.DECIMAL,r);case Vn.GUJARATI:return Gi(e,2790,2799,!0,r);case Vn.GURMUKHI:return Gi(e,2662,2671,!0,r);case Vn.HEBREW:return Vi(e,1,10999,Hi,Vn.DECIMAL,r);case Vn.HIRAGANA:return zi(e,"あいうえおかきくけこさしすせそたちつてとなにぬねのはひふへほまみむめもやゆよらりるれろわゐゑをん");case Vn.HIRAGANA_IROHA:return zi(e,"いろはにほへとちりぬるをわかよたれそつねならむうゐのおくやまけふこえてあさきゆめみしゑひもせす");case Vn.KANNADA:return Gi(e,3302,3311,!0,r);case Vn.KATAKANA:return zi(e,"アイウエオカキクケコサシスセソタチツテトナニヌネノハヒフヘホマミムメモヤユヨラリルレロワヰヱヲン",i);case Vn.KATAKANA_IROHA:return zi(e,"イロハニホヘトチリヌルヲワカヨタレソツネナラムウヰノオクヤマケフコエテアサキユメミシヱヒモセス",i);case Vn.LAO:return Gi(e,3792,3801,!0,r);case Vn.MONGOLIAN:return Gi(e,6160,6169,!0,r);case Vn.MYANMAR:return Gi(e,4160,4169,!0,r);case Vn.ORIYA:return Gi(e,2918,2927,!0,r);case Vn.PERSIAN:return Gi(e,1776,1785,!0,r);case Vn.TAMIL:return Gi(e,3046,3055,!0,r);case Vn.TELUGU:return Gi(e,3174,3183,!0,r);case Vn.THAI:return Gi(e,3664,3673,!0,r);case Vn.TIBETAN:return Gi(e,3872,3881,!0,r);case Vn.DECIMAL:default:return Gi(e,48,57,!0,r)}},Zi="data-html2canvas-ignore",$i=function(){function e(e,t){if(this.options=t,this.scrolledElements=[],this.referenceElement=e,this.counters=new Di,this.quoteDepth=0,!e.ownerDocument)throw new Error("Cloned element does not have an owner document");this.documentElement=this.cloneNode(e.ownerDocument.documentElement)}return e.prototype.toIFrame=function(e,t){var n=this,o=to(e,t);if(!o.contentWindow)return Promise.reject("Unable to find iframe window");var a=e.defaultView.pageXOffset,s=e.defaultView.pageYOffset,c=o.contentWindow,u=c.document,l=no(o).then((function(){return r(n,void 0,void 0,(function(){var e;return i(this,(function(n){switch(n.label){case 0:return this.scrolledElements.forEach(ao),c&&(c.scrollTo(t.left,t.top),!/(iPad|iPhone|iPod)/g.test(navigator.userAgent)||c.scrollY===t.top&&c.scrollX===t.left||(u.documentElement.style.top=-t.top+"px",u.documentElement.style.left=-t.left+"px",u.documentElement.style.position="absolute")),e=this.options.onclone,void 0===this.clonedReferenceElement?[2,Promise.reject("Error finding the "+this.referenceElement.nodeName+" in the cloned document")]:u.fonts&&u.fonts.ready?[4,u.fonts.ready]:[3,2];case 1:n.sent(),n.label=2;case 2:return"function"==typeof e?[2,Promise.resolve().then((function(){return e(u)})).then((function(){return o}))]:[2,o]}}))}))}));return u.open(),u.write(io(document.doctype)+"<html></html>"),oo(this.referenceElement.ownerDocument,a,s),u.replaceChild(u.adoptNode(this.documentElement),u.documentElement),u.close(),l},e.prototype.createElementClone=function(e){if(Oi(e))return this.createCanvasClone(e);if(Mi(e))return this.createStyleClone(e);var t=e.cloneNode(!1);return Ni(t)&&"lazy"===t.loading&&(t.loading="eager"),t},e.prototype.createStyleClone=function(e){try{var t=e.sheet;if(t&&t.cssRules){var n=[].slice.call(t.cssRules,0).reduce((function(e,t){return t&&"string"==typeof t.cssText?e+t.cssText:e}),""),r=e.cloneNode(!1);return r.textContent=n,r}}catch(e){if(Ot.getInstance(this.options.id).error("Unable to access cssRules property",e),"SecurityError"!==e.name)throw e}return e.cloneNode(!1)},e.prototype.createCanvasClone=function(e){if(this.options.inlineImages&&e.ownerDocument){var t=e.ownerDocument.createElement("img");try{return t.src=e.toDataURL(),t}catch(e){Ot.getInstance(this.options.id).info("Unable to clone canvas contents, canvas is tainted")}}var n=e.cloneNode(!1);try{n.width=e.width,n.height=e.height;var r=e.getContext("2d"),i=n.getContext("2d");return i&&(r?i.putImageData(r.getImageData(0,0,e.width,e.height),0,0):i.drawImage(e,0,0)),n}catch(e){}return n},e.prototype.cloneNode=function(e){if(Ei(e))return document.createTextNode(e.data);if(!e.ownerDocument)return e.cloneNode(!1);var t=e.ownerDocument.defaultView;if(t&&_i(e)&&(wi(e)||Si(e))){var n=this.createElementClone(e),r=t.getComputedStyle(e),i=t.getComputedStyle(e,":before"),o=t.getComputedStyle(e,":after");this.referenceElement===e&&wi(n)&&(this.clonedReferenceElement=n),xi(n)&&lo(n);for(var a=this.counters.parse(new jr(r)),s=this.resolvePseudoContent(e,n,i,Or.BEFORE),c=e.firstChild;c;c=c.nextSibling)_i(c)&&(Li(c)||c.hasAttribute(Zi)||"function"==typeof this.options.ignoreElements&&this.options.ignoreElements(c))||this.options.copyStyles&&_i(c)&&Mi(c)||n.appendChild(this.cloneNode(c));s&&n.insertBefore(s,n.firstChild);var u=this.resolvePseudoContent(e,n,o,Or.AFTER);return u&&n.appendChild(u),this.counters.pop(a),r&&(this.options.copyStyles||Si(e))&&!Bi(e)&&ro(r,n),0===e.scrollTop&&0===e.scrollLeft||this.scrolledElements.push([n,e.scrollLeft,e.scrollTop]),(ki(e)||Ui(e))&&(ki(n)||Ui(n))&&(n.value=e.value),n}return e.cloneNode(!1)},e.prototype.resolvePseudoContent=function(e,t,n,r){var i=this;if(n){var o=n.content,a=t.ownerDocument;if(a&&o&&"none"!==o&&"-moz-alt-content"!==o&&"none"!==n.display){this.counters.parse(new jr(n));var s=new Hr(n),c=a.createElement("html2canvaspseudoelement");ro(n,c),s.content.forEach((function(t){if(t.type===h.STRING_TOKEN)c.appendChild(a.createTextNode(t.value));else if(t.type===h.URL_TOKEN){var n=a.createElement("img");n.src=t.value,n.style.opacity="1",c.appendChild(n)}else if(t.type===h.FUNCTION){if("attr"===t.name){var r=t.values.filter(Pe);r.length&&c.appendChild(a.createTextNode(e.getAttribute(r[0].value)||""))}else if("counter"===t.name){var o=t.values.filter(Ve),u=o[0],l=o[1];if(u&&Pe(u)){var d=i.counters.getCounterValue(u.value),f=l&&Pe(l)?zn.parse(l.value):Vn.DECIMAL;c.appendChild(a.createTextNode(Yi(d,f,!1)))}}else if("counters"===t.name){var p=t.values.filter(Ve),A=(u=p[0],p[1]);l=p[2];if(u&&Pe(u)){var g=i.counters.getCounterValues(u.value),v=l&&Pe(l)?zn.parse(l.value):Vn.DECIMAL,m=A&&A.type===h.STRING_TOKEN?A.value:"",y=g.map((function(e){return Yi(e,v,!1)})).join(m);c.appendChild(a.createTextNode(y))}}}else if(t.type===h.IDENT_TOKEN)switch(t.value){case"open-quote":c.appendChild(a.createTextNode(Dr(s.quotes,i.quoteDepth++,!0)));break;case"close-quote":c.appendChild(a.createTextNode(Dr(s.quotes,--i.quoteDepth,!1)));break;default:c.appendChild(a.createTextNode(t.value))}})),c.className=so+" "+co;var u=r===Or.BEFORE?" "+so:" "+co;return Si(t)?t.className.baseValue+=u:t.className+=u,c}}},e.destroy=function(e){return!!e.parentNode&&(e.parentNode.removeChild(e),!0)},e}();!function(e){e[e.BEFORE=0]="BEFORE",e[e.AFTER=1]="AFTER"}(Or||(Or={}));var eo,to=function(e,t){var n=e.createElement("iframe");return n.className="html2canvas-container",n.style.visibility="hidden",n.style.position="fixed",n.style.left="-10000px",n.style.top="0px",n.style.border="0",n.width=t.width.toString(),n.height=t.height.toString(),n.scrolling="no",n.setAttribute(Zi,"true"),e.body.appendChild(n),n},no=function(e){return new Promise((function(t,n){var r=e.contentWindow;if(!r)return n("No window assigned for iframe");var i=r.document;r.onload=e.onload=i.onreadystatechange=function(){r.onload=e.onload=i.onreadystatechange=null;var n=setInterval((function(){i.body.childNodes.length>0&&"complete"===i.readyState&&(clearInterval(n),t(e))}),50)}}))},ro=function(e,t){for(var n=e.length-1;n>=0;n--){var r=e.item(n);"content"!==r&&t.style.setProperty(r,e.getPropertyValue(r))}return t},io=function(e){var t="";return e&&(t+="<!DOCTYPE ",e.name&&(t+=e.name),e.internalSubset&&(t+=e.internalSubset),e.publicId&&(t+='"'+e.publicId+'"'),e.systemId&&(t+='"'+e.systemId+'"'),t+=">"),t},oo=function(e,t,n){e&&e.defaultView&&(t!==e.defaultView.pageXOffset||n!==e.defaultView.pageYOffset)&&e.defaultView.scrollTo(t,n)},ao=function(e){var t=e[0],n=e[1],r=e[2];t.scrollLeft=n,t.scrollTop=r},so="___html2canvas___pseudoelement_before",co="___html2canvas___pseudoelement_after",uo='{\n    content: "" !important;\n    display: none !important;\n}',lo=function(e){ho(e,"."+so+":before"+uo+"\n         ."+co+":after"+uo)},ho=function(e,t){var n=e.ownerDocument;if(n){var r=n.createElement("style");r.textContent=t,e.appendChild(r)}};!function(e){e[e.VECTOR=0]="VECTOR",e[e.BEZIER_CURVE=1]="BEZIER_CURVE"}(eo||(eo={}));var fo,po=function(e,t){return e.length===t.length&&e.some((function(e,n){return e===t[n]}))},Ao=function(){function e(e,t){this.type=eo.VECTOR,this.x=e,this.y=t}return e.prototype.add=function(t,n){return new e(this.x+t,this.y+n)},e}(),go=function(e,t,n){return new Ao(e.x+(t.x-e.x)*n,e.y+(t.y-e.y)*n)},vo=function(){function e(e,t,n,r){this.type=eo.BEZIER_CURVE,this.start=e,this.startControl=t,this.endControl=n,this.end=r}return e.prototype.subdivide=function(t,n){var r=go(this.start,this.startControl,t),i=go(this.startControl,this.endControl,t),o=go(this.endControl,this.end,t),a=go(r,i,t),s=go(i,o,t),c=go(a,s,t);return n?new e(this.start,r,a,c):new e(c,s,o,this.end)},e.prototype.add=function(t,n){return new e(this.start.add(t,n),this.startControl.add(t,n),this.endControl.add(t,n),this.end.add(t,n))},e.prototype.reverse=function(){return new e(this.end,this.endControl,this.startControl,this.start)},e}(),mo=function(e){return e.type===eo.BEZIER_CURVE},yo=function(e){var t=e.styles,n=e.bounds,r=Ye(t.borderTopLeftRadius,n.width,n.height),i=r[0],o=r[1],a=Ye(t.borderTopRightRadius,n.width,n.height),s=a[0],c=a[1],u=Ye(t.borderBottomRightRadius,n.width,n.height),l=u[0],d=u[1],h=Ye(t.borderBottomLeftRadius,n.width,n.height),f=h[0],p=h[1],A=[];A.push((i+s)/n.width),A.push((f+l)/n.width),A.push((o+p)/n.height),A.push((c+d)/n.height);var g=Math.max.apply(Math,A);g>1&&(i/=g,o/=g,s/=g,c/=g,l/=g,d/=g,f/=g,p/=g);var v=n.width-s,m=n.height-d,y=n.width-l,b=n.height-p,E=t.borderTopWidth,_=t.borderRightWidth,w=t.borderBottomWidth,S=t.borderLeftWidth,T=Ze(t.paddingTop,e.bounds.width),R=Ze(t.paddingRight,e.bounds.width),C=Ze(t.paddingBottom,e.bounds.width),I=Ze(t.paddingLeft,e.bounds.width);this.topLeftBorderBox=i>0||o>0?bo(n.left,n.top,i,o,fo.TOP_LEFT):new Ao(n.left,n.top),this.topRightBorderBox=s>0||c>0?bo(n.left+v,n.top,s,c,fo.TOP_RIGHT):new Ao(n.left+n.width,n.top),this.bottomRightBorderBox=l>0||d>0?bo(n.left+y,n.top+m,l,d,fo.BOTTOM_RIGHT):new Ao(n.left+n.width,n.top+n.height),this.bottomLeftBorderBox=f>0||p>0?bo(n.left,n.top+b,f,p,fo.BOTTOM_LEFT):new Ao(n.left,n.top+n.height),this.topLeftPaddingBox=i>0||o>0?bo(n.left+S,n.top+E,Math.max(0,i-S),Math.max(0,o-E),fo.TOP_LEFT):new Ao(n.left+S,n.top+E),this.topRightPaddingBox=s>0||c>0?bo(n.left+Math.min(v,n.width+S),n.top+E,v>n.width+S?0:s-S,c-E,fo.TOP_RIGHT):new Ao(n.left+n.width-_,n.top+E),this.bottomRightPaddingBox=l>0||d>0?bo(n.left+Math.min(y,n.width-S),n.top+Math.min(m,n.height+E),Math.max(0,l-_),d-w,fo.BOTTOM_RIGHT):new Ao(n.left+n.width-_,n.top+n.height-w),this.bottomLeftPaddingBox=f>0||p>0?bo(n.left+S,n.top+b,Math.max(0,f-S),p-w,fo.BOTTOM_LEFT):new Ao(n.left+S,n.top+n.height-w),this.topLeftContentBox=i>0||o>0?bo(n.left+S+I,n.top+E+T,Math.max(0,i-(S+I)),Math.max(0,o-(E+T)),fo.TOP_LEFT):new Ao(n.left+S+I,n.top+E+T),this.topRightContentBox=s>0||c>0?bo(n.left+Math.min(v,n.width+S+I),n.top+E+T,v>n.width+S+I?0:s-S+I,c-(E+T),fo.TOP_RIGHT):new Ao(n.left+n.width-(_+R),n.top+E+T),this.bottomRightContentBox=l>0||d>0?bo(n.left+Math.min(y,n.width-(S+I)),n.top+Math.min(m,n.height+E+T),Math.max(0,l-(_+R)),d-(w+C),fo.BOTTOM_RIGHT):new Ao(n.left+n.width-(_+R),n.top+n.height-(w+C)),this.bottomLeftContentBox=f>0||p>0?bo(n.left+S+I,n.top+b,Math.max(0,f-(S+I)),p-(w+C),fo.BOTTOM_LEFT):new Ao(n.left+S+I,n.top+n.height-(w+C))};!function(e){e[e.TOP_LEFT=0]="TOP_LEFT",e[e.TOP_RIGHT=1]="TOP_RIGHT",e[e.BOTTOM_RIGHT=2]="BOTTOM_RIGHT",e[e.BOTTOM_LEFT=3]="BOTTOM_LEFT"}(fo||(fo={}));var bo=function(e,t,n,r,i){var o=(Math.sqrt(2)-1)/3*4,a=n*o,s=r*o,c=e+n,u=t+r;switch(i){case fo.TOP_LEFT:return new vo(new Ao(e,u),new Ao(e,u-s),new Ao(c-a,t),new Ao(c,t));case fo.TOP_RIGHT:return new vo(new Ao(e,t),new Ao(e+a,t),new Ao(c,u-s),new Ao(c,u));case fo.BOTTOM_RIGHT:return new vo(new Ao(c,t),new Ao(c,t+s),new Ao(e+a,u),new Ao(e,u));case fo.BOTTOM_LEFT:default:return new vo(new Ao(c,u),new Ao(c-a,u),new Ao(e,t+s),new Ao(e,t))}},Eo=function(e){return[e.topLeftBorderBox,e.topRightBorderBox,e.bottomRightBorderBox,e.bottomLeftBorderBox]},_o=function(e){return[e.topLeftPaddingBox,e.topRightPaddingBox,e.bottomRightPaddingBox,e.bottomLeftPaddingBox]},wo=function(e,t,n){this.type=0,this.offsetX=e,this.offsetY=t,this.matrix=n,this.target=6},So=function(e,t){this.type=1,this.target=t,this.path=e},To=function(e){this.element=e,this.inlineLevel=[],this.nonInlineLevel=[],this.negativeZIndex=[],this.zeroOrAutoZIndexOrTransformedOrOpacity=[],this.positiveZIndex=[],this.nonPositionedFloats=[],this.nonPositionedInlineLevel=[]},Ro=function(){function e(e,t){if(this.container=e,this.effects=t.slice(0),this.curves=new yo(e),null!==e.styles.transform){var n=e.bounds.left+e.styles.transformOrigin[0].number,r=e.bounds.top+e.styles.transformOrigin[1].number,i=e.styles.transform;this.effects.push(new wo(n,r,i))}if(e.styles.overflowX!==Gn.VISIBLE){var o=Eo(this.curves),a=_o(this.curves);po(o,a)?this.effects.push(new So(o,6)):(this.effects.push(new So(o,2)),this.effects.push(new So(a,4)))}}return e.prototype.getParentEffects=function(){var e=this.effects.slice(0);if(this.container.styles.overflowX!==Gn.VISIBLE){var t=Eo(this.curves),n=_o(this.curves);po(t,n)||e.push(new So(n,6))}return e},e}(),Co=function(e,t,n,r){e.container.elements.forEach((function(i){var o=Br(i.flags,4),a=Br(i.flags,2),s=new Ro(i,e.getParentEffects());Br(i.styles.display,2048)&&r.push(s);var c=Br(i.flags,8)?[]:r;if(o||a){var u=o||i.styles.isPositioned()?n:t,l=new To(s);if(i.styles.isPositioned()||i.styles.opacity<1||i.styles.isTransformed()){var d=i.styles.zIndex.order;if(d<0){var h=0;u.negativeZIndex.some((function(e,t){return d>e.element.container.styles.zIndex.order?(h=t,!1):h>0})),u.negativeZIndex.splice(h,0,l)}else if(d>0){var f=0;u.positiveZIndex.some((function(e,t){return d>=e.element.container.styles.zIndex.order?(f=t+1,!1):f>0})),u.positiveZIndex.splice(f,0,l)}else u.zeroOrAutoZIndexOrTransformedOrOpacity.push(l)}else i.styles.isFloating()?u.nonPositionedFloats.push(l):u.nonPositionedInlineLevel.push(l);Co(s,l,o?l:n,c)}else i.styles.isInlineLevel()?t.inlineLevel.push(s):t.nonInlineLevel.push(s),Co(s,t,n,c);Br(i.flags,8)&&Io(i,c)}))},Io=function(e,t){for(var n=e instanceof ri?e.start:1,r=e instanceof ri&&e.reversed,i=0;i<t.length;i++){var o=t[i];o.container instanceof ni&&"number"==typeof o.container.value&&0!==o.container.value&&(n=o.container.value),o.listValue=Yi(n,o.container.styles.listStyleType,!0),n+=r?-1:1}},xo=function(e,t,n,r){var i=[];return mo(e)?i.push(e.subdivide(.5,!1)):i.push(e),mo(n)?i.push(n.subdivide(.5,!0)):i.push(n),mo(r)?i.push(r.subdivide(.5,!0).reverse()):i.push(r),mo(t)?i.push(t.subdivide(.5,!1).reverse()):i.push(t),i},Oo=function(e){var t=e.bounds,n=e.styles;return t.add(n.borderLeftWidth,n.borderTopWidth,-(n.borderRightWidth+n.borderLeftWidth),-(n.borderTopWidth+n.borderBottomWidth))},No=function(e){var t=e.styles,n=e.bounds,r=Ze(t.paddingLeft,n.width),i=Ze(t.paddingRight,n.width),o=Ze(t.paddingTop,n.width),a=Ze(t.paddingBottom,n.width);return n.add(r+t.borderLeftWidth,o+t.borderTopWidth,-(t.borderRightWidth+t.borderLeftWidth+r+i),-(t.borderTopWidth+t.borderBottomWidth+o+a))},Bo=function(e,t,n){var r=function(e,t){return 0===e?t.bounds:2===e?No(t):Oo(t)}(Uo(e.styles.backgroundOrigin,t),e),i=function(e,t){return e===ft.BORDER_BOX?t.bounds:e===ft.CONTENT_BOX?No(t):Oo(t)}(Uo(e.styles.backgroundClip,t),e),o=ko(Uo(e.styles.backgroundSize,t),n,r),a=o[0],s=o[1],c=Ye(Uo(e.styles.backgroundPosition,t),r.width-a,r.height-s);return[Do(Uo(e.styles.backgroundRepeat,t),c,o,r,i),Math.round(r.left+c[0]),Math.round(r.top+c[1]),a,s]},Mo=function(e){return Pe(e)&&e.value===on.AUTO},Lo=function(e){return"number"==typeof e},ko=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=e[0],s=e[1];if(Ke(a)&&s&&Ke(s))return[Ze(a,n.width),Ze(s,n.height)];var c=Lo(o);if(Pe(a)&&(a.value===on.CONTAIN||a.value===on.COVER))return Lo(o)?n.width/n.height<o!=(a.value===on.COVER)?[n.width,n.width/o]:[n.height*o,n.height]:[n.width,n.height];var u=Lo(r),l=Lo(i),d=u||l;if(Mo(a)&&(!s||Mo(s)))return u&&l?[r,i]:c||d?d&&c?[u?r:i*o,l?i:r/o]:[u?r:n.width,l?i:n.height]:[n.width,n.height];if(c){var h=0,f=0;return Ke(a)?h=Ze(a,n.width):Ke(s)&&(f=Ze(s,n.height)),Mo(a)?h=f*o:s&&!Mo(s)||(f=h/o),[h,f]}var p=null,A=null;if(Ke(a)?p=Ze(a,n.width):s&&Ke(s)&&(A=Ze(s,n.height)),null===p||s&&!Mo(s)||(A=u&&l?p/r*i:n.height),null!==A&&Mo(a)&&(p=u&&l?A/i*r:n.width),null!==p&&null!==A)return[p,A];throw new Error("Unable to calculate background-size for element")},Uo=function(e,t){var n=e[t];return void 0===n?e[0]:n},Do=function(e,t,n,r,i){var o=t[0],a=t[1],s=n[0],c=n[1];switch(e){case $t.REPEAT_X:return[new Ao(Math.round(r.left),Math.round(r.top+a)),new Ao(Math.round(r.left+r.width),Math.round(r.top+a)),new Ao(Math.round(r.left+r.width),Math.round(c+r.top+a)),new Ao(Math.round(r.left),Math.round(c+r.top+a))];case $t.REPEAT_Y:return[new Ao(Math.round(r.left+o),Math.round(r.top)),new Ao(Math.round(r.left+o+s),Math.round(r.top)),new Ao(Math.round(r.left+o+s),Math.round(r.height+r.top)),new Ao(Math.round(r.left+o),Math.round(r.height+r.top))];case $t.NO_REPEAT:return[new Ao(Math.round(r.left+o),Math.round(r.top+a)),new Ao(Math.round(r.left+o+s),Math.round(r.top+a)),new Ao(Math.round(r.left+o+s),Math.round(r.top+a+c)),new Ao(Math.round(r.left+o),Math.round(r.top+a+c))];default:return[new Ao(Math.round(i.left),Math.round(i.top)),new Ao(Math.round(i.left+i.width),Math.round(i.top)),new Ao(Math.round(i.left+i.width),Math.round(i.height+i.top)),new Ao(Math.round(i.left),Math.round(i.height+i.top))]}},Po="Hidden Text",Fo=function(){function e(e){this._data={},this._document=e}return e.prototype.parseMetrics=function(e,t){var n=this._document.createElement("div"),r=this._document.createElement("img"),i=this._document.createElement("span"),o=this._document.body;n.style.visibility="hidden",n.style.fontFamily=e,n.style.fontSize=t,n.style.margin="0",n.style.padding="0",o.appendChild(n),r.src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",r.width=1,r.height=1,r.style.margin="0",r.style.padding="0",r.style.verticalAlign="baseline",i.style.fontFamily=e,i.style.fontSize=t,i.style.margin="0",i.style.padding="0",i.appendChild(this._document.createTextNode(Po)),n.appendChild(i),n.appendChild(r);var a=r.offsetTop-i.offsetTop+2;n.removeChild(i),n.appendChild(this._document.createTextNode(Po)),n.style.lineHeight="normal",r.style.verticalAlign="super";var s=r.offsetTop-n.offsetTop+2;return o.removeChild(n),{baseline:a,middle:s}},e.prototype.getMetrics=function(e,t){var n=e+" "+t;return void 0===this._data[n]&&(this._data[n]=this.parseMetrics(e,t)),this._data[n]},e}(),Ho=function(){function e(e){this._activeEffects=[],this.canvas=e.canvas?e.canvas:document.createElement("canvas"),this.ctx=this.canvas.getContext("2d"),this.options=e,e.canvas||(this.canvas.width=Math.floor(e.width*e.scale),this.canvas.height=Math.floor(e.height*e.scale),this.canvas.style.width=e.width+"px",this.canvas.style.height=e.height+"px"),this.fontMetrics=new Fo(document),this.ctx.scale(this.options.scale,this.options.scale),this.ctx.translate(-e.x+e.scrollX,-e.y+e.scrollY),this.ctx.textBaseline="bottom",this._activeEffects=[],Ot.getInstance(e.id).debug("Canvas renderer initialized ("+e.width+"x"+e.height+" at "+e.x+","+e.y+") with scale "+e.scale)}return e.prototype.applyEffects=function(e,t){for(var n=this;this._activeEffects.length;)this.popEffect();e.filter((function(e){return Br(e.target,t)})).forEach((function(e){return n.applyEffect(e)}))},e.prototype.applyEffect=function(e){this.ctx.save(),function(e){return 0===e.type}(e)&&(this.ctx.translate(e.offsetX,e.offsetY),this.ctx.transform(e.matrix[0],e.matrix[1],e.matrix[2],e.matrix[3],e.matrix[4],e.matrix[5]),this.ctx.translate(-e.offsetX,-e.offsetY)),function(e){return 1===e.type}(e)&&(this.path(e.path),this.ctx.clip()),this._activeEffects.push(e)},e.prototype.popEffect=function(){this._activeEffects.pop(),this.ctx.restore()},e.prototype.renderStack=function(e){return r(this,void 0,void 0,(function(){var t;return i(this,(function(n){switch(n.label){case 0:return(t=e.element.container.styles).isVisible()?(this.ctx.globalAlpha=t.opacity,[4,this.renderStackContent(e)]):[3,2];case 1:n.sent(),n.label=2;case 2:return[2]}}))}))},e.prototype.renderNode=function(e){return r(this,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:return e.container.styles.isVisible()?[4,this.renderNodeBackgroundAndBorders(e)]:[3,3];case 1:return t.sent(),[4,this.renderNodeContent(e)];case 2:t.sent(),t.label=3;case 3:return[2]}}))}))},e.prototype.renderTextWithLetterSpacing=function(e,t){var n=this;0===t?this.ctx.fillText(e.text,e.bounds.left,e.bounds.top+e.bounds.height):s(e.text).map((function(e){return c(e)})).reduce((function(t,r){return n.ctx.fillText(r,t,e.bounds.top+e.bounds.height),t+n.ctx.measureText(r).width}),e.bounds.left)},e.prototype.createFontStyle=function(e){var t=e.fontVariant.filter((function(e){return"normal"===e||"small-caps"===e})).join(""),n=e.fontFamily.join(", "),r=Ue(e.fontSize)?""+e.fontSize.number+e.fontSize.unit:e.fontSize.number+"px";return[[e.fontStyle,t,e.fontWeight,r,n].join(" "),n,r]},e.prototype.renderTextNode=function(e,t){return r(this,void 0,void 0,(function(){var n,r,o,a,s=this;return i(this,(function(i){return n=this.createFontStyle(t),r=n[0],o=n[1],a=n[2],this.ctx.font=r,e.textBounds.forEach((function(e){s.ctx.fillStyle=st(t.color),s.renderTextWithLetterSpacing(e,t.letterSpacing);var n=t.textShadow;n.length&&e.text.trim().length&&(n.slice(0).reverse().forEach((function(t){s.ctx.shadowColor=st(t.color),s.ctx.shadowOffsetX=t.offsetX.number*s.options.scale,s.ctx.shadowOffsetY=t.offsetY.number*s.options.scale,s.ctx.shadowBlur=t.blur.number,s.ctx.fillText(e.text,e.bounds.left,e.bounds.top+e.bounds.height)})),s.ctx.shadowColor="",s.ctx.shadowOffsetX=0,s.ctx.shadowOffsetY=0,s.ctx.shadowBlur=0),t.textDecorationLine.length&&(s.ctx.fillStyle=st(t.textDecorationColor||t.color),t.textDecorationLine.forEach((function(t){switch(t){case 1:var n=s.fontMetrics.getMetrics(o,a).baseline;s.ctx.fillRect(e.bounds.left,Math.round(e.bounds.top+n),e.bounds.width,1);break;case 2:s.ctx.fillRect(e.bounds.left,Math.round(e.bounds.top),e.bounds.width,1);break;case 3:var r=s.fontMetrics.getMetrics(o,a).middle;s.ctx.fillRect(e.bounds.left,Math.ceil(e.bounds.top+r),e.bounds.width,1)}})))})),[2]}))}))},e.prototype.renderReplacedElement=function(e,t,n){if(n&&e.intrinsicWidth>0&&e.intrinsicHeight>0){var r=No(e),i=_o(t);this.path(i),this.ctx.save(),this.ctx.clip(),this.ctx.drawImage(n,0,0,e.intrinsicWidth,e.intrinsicHeight,r.left,r.top,r.width,r.height),this.ctx.restore()}},e.prototype.renderNodeContent=function(t){return r(this,void 0,void 0,(function(){var n,r,a,s,c,u,l,d,f,p,A,g,v,m;return i(this,(function(i){switch(i.label){case 0:this.applyEffects(t.effects,4),n=t.container,r=t.curves,a=n.styles,s=0,c=n.textNodes,i.label=1;case 1:return s<c.length?(u=c[s],[4,this.renderTextNode(u,a)]):[3,4];case 2:i.sent(),i.label=3;case 3:return s++,[3,1];case 4:if(!(n instanceof $r))return[3,8];i.label=5;case 5:return i.trys.push([5,7,,8]),[4,this.options.cache.match(n.src)];case 6:return g=i.sent(),this.renderReplacedElement(n,r,g),[3,8];case 7:return i.sent(),Ot.getInstance(this.options.id).error("Error loading image "+n.src),[3,8];case 8:if(n instanceof ei&&this.renderReplacedElement(n,r,n.canvas),!(n instanceof ti))return[3,12];i.label=9;case 9:return i.trys.push([9,11,,12]),[4,this.options.cache.match(n.svg)];case 10:return g=i.sent(),this.renderReplacedElement(n,r,g),[3,12];case 11:return i.sent(),Ot.getInstance(this.options.id).error("Error loading svg "+n.svg.substring(0,255)),[3,12];case 12:return n instanceof pi&&n.tree?[4,new e({id:this.options.id,scale:this.options.scale,backgroundColor:n.backgroundColor,x:0,y:0,scrollX:0,scrollY:0,width:n.width,height:n.height,cache:this.options.cache,windowWidth:n.width,windowHeight:n.height}).render(n.tree)]:[3,14];case 13:l=i.sent(),n.width&&n.height&&this.ctx.drawImage(l,0,0,n.width,n.height,n.bounds.left,n.bounds.top,n.bounds.width,n.bounds.height),i.label=14;case 14:if(n instanceof li&&(d=Math.min(n.bounds.width,n.bounds.height),n.type===ai?n.checked&&(this.ctx.save(),this.path([new Ao(n.bounds.left+.39363*d,n.bounds.top+.79*d),new Ao(n.bounds.left+.16*d,n.bounds.top+.5549*d),new Ao(n.bounds.left+.27347*d,n.bounds.top+.44071*d),new Ao(n.bounds.left+.39694*d,n.bounds.top+.5649*d),new Ao(n.bounds.left+.72983*d,n.bounds.top+.23*d),new Ao(n.bounds.left+.84*d,n.bounds.top+.34085*d),new Ao(n.bounds.left+.39363*d,n.bounds.top+.79*d)]),this.ctx.fillStyle=st(ui),this.ctx.fill(),this.ctx.restore()):n.type===si&&n.checked&&(this.ctx.save(),this.ctx.beginPath(),this.ctx.arc(n.bounds.left+d/2,n.bounds.top+d/2,d/4,0,2*Math.PI,!0),this.ctx.fillStyle=st(ui),this.ctx.fill(),this.ctx.restore())),jo(n)&&n.value.length){switch(this.ctx.font=this.createFontStyle(a)[0],this.ctx.fillStyle=st(a.color),this.ctx.textBaseline="middle",this.ctx.textAlign=Qo(n.styles.textAlign),m=No(n),f=0,n.styles.textAlign){case $n.CENTER:f+=m.width/2;break;case $n.RIGHT:f+=m.width}p=m.add(f,0,0,-m.height/2+1),this.ctx.save(),this.path([new Ao(m.left,m.top),new Ao(m.left+m.width,m.top),new Ao(m.left+m.width,m.top+m.height),new Ao(m.left,m.top+m.height)]),this.ctx.clip(),this.renderTextWithLetterSpacing(new Gr(n.value,p),a.letterSpacing),this.ctx.restore(),this.ctx.textBaseline="bottom",this.ctx.textAlign="left"}if(!Br(n.styles.display,2048))return[3,20];if(null===n.styles.listStyleImage)return[3,19];if((A=n.styles.listStyleImage).type!==vt.URL)return[3,18];g=void 0,v=A.url,i.label=15;case 15:return i.trys.push([15,17,,18]),[4,this.options.cache.match(v)];case 16:return g=i.sent(),this.ctx.drawImage(g,n.bounds.left-(g.width+10),n.bounds.top),[3,18];case 17:return i.sent(),Ot.getInstance(this.options.id).error("Error loading list-style-image "+v),[3,18];case 18:return[3,20];case 19:t.listValue&&n.styles.listStyleType!==Vn.NONE&&(this.ctx.font=this.createFontStyle(a)[0],this.ctx.fillStyle=st(a.color),this.ctx.textBaseline="middle",this.ctx.textAlign="right",m=new o(n.bounds.left,n.bounds.top+Ze(n.styles.paddingTop,n.bounds.width),n.bounds.width,function(e,t){return Pe(e)&&"normal"===e.value?1.2*t:e.type===h.NUMBER_TOKEN?t*e.number:Ke(e)?Ze(e,t):t}(a.lineHeight,a.fontSize.number)/2+1),this.renderTextWithLetterSpacing(new Gr(t.listValue,m),a.letterSpacing),this.ctx.textBaseline="bottom",this.ctx.textAlign="left"),i.label=20;case 20:return[2]}}))}))},e.prototype.renderStackContent=function(e){return r(this,void 0,void 0,(function(){var t,n,r,o,a,s,c,u,l,d,h,f,p,A,g;return i(this,(function(i){switch(i.label){case 0:return[4,this.renderNodeBackgroundAndBorders(e.element)];case 1:i.sent(),t=0,n=e.negativeZIndex,i.label=2;case 2:return t<n.length?(g=n[t],[4,this.renderStack(g)]):[3,5];case 3:i.sent(),i.label=4;case 4:return t++,[3,2];case 5:return[4,this.renderNodeContent(e.element)];case 6:i.sent(),r=0,o=e.nonInlineLevel,i.label=7;case 7:return r<o.length?(g=o[r],[4,this.renderNode(g)]):[3,10];case 8:i.sent(),i.label=9;case 9:return r++,[3,7];case 10:a=0,s=e.nonPositionedFloats,i.label=11;case 11:return a<s.length?(g=s[a],[4,this.renderStack(g)]):[3,14];case 12:i.sent(),i.label=13;case 13:return a++,[3,11];case 14:c=0,u=e.nonPositionedInlineLevel,i.label=15;case 15:return c<u.length?(g=u[c],[4,this.renderStack(g)]):[3,18];case 16:i.sent(),i.label=17;case 17:return c++,[3,15];case 18:l=0,d=e.inlineLevel,i.label=19;case 19:return l<d.length?(g=d[l],[4,this.renderNode(g)]):[3,22];case 20:i.sent(),i.label=21;case 21:return l++,[3,19];case 22:h=0,f=e.zeroOrAutoZIndexOrTransformedOrOpacity,i.label=23;case 23:return h<f.length?(g=f[h],[4,this.renderStack(g)]):[3,26];case 24:i.sent(),i.label=25;case 25:return h++,[3,23];case 26:p=0,A=e.positiveZIndex,i.label=27;case 27:return p<A.length?(g=A[p],[4,this.renderStack(g)]):[3,30];case 28:i.sent(),i.label=29;case 29:return p++,[3,27];case 30:return[2]}}))}))},e.prototype.mask=function(e){this.ctx.beginPath(),this.ctx.moveTo(0,0),this.ctx.lineTo(this.canvas.width,0),this.ctx.lineTo(this.canvas.width,this.canvas.height),this.ctx.lineTo(0,this.canvas.height),this.ctx.lineTo(0,0),this.formatPath(e.slice(0).reverse()),this.ctx.closePath()},e.prototype.path=function(e){this.ctx.beginPath(),this.formatPath(e),this.ctx.closePath()},e.prototype.formatPath=function(e){var t=this;e.forEach((function(e,n){var r=mo(e)?e.start:e;0===n?t.ctx.moveTo(r.x,r.y):t.ctx.lineTo(r.x,r.y),mo(e)&&t.ctx.bezierCurveTo(e.startControl.x,e.startControl.y,e.endControl.x,e.endControl.y,e.end.x,e.end.y)}))},e.prototype.renderRepeat=function(e,t,n,r){this.path(e),this.ctx.fillStyle=t,this.ctx.translate(n,r),this.ctx.fill(),this.ctx.translate(-n,-r)},e.prototype.resizeImage=function(e,t,n){if(e.width===t&&e.height===n)return e;var r=this.canvas.ownerDocument.createElement("canvas");return r.width=t,r.height=n,r.getContext("2d").drawImage(e,0,0,e.width,e.height,0,0,t,n),r},e.prototype.renderBackgroundImage=function(e){return r(this,void 0,void 0,(function(){var t,n,r,o,a,s;return i(this,(function(c){switch(c.label){case 0:t=e.styles.backgroundImage.length-1,n=function(n){var o,a,s,c,u,l,d,h,f,p,A,g,v,m,y,b,E,_,w,S,T,R,C,I,x,O,N,B,M,L,k;return i(this,(function(i){switch(i.label){case 0:if(n.type!==vt.URL)return[3,5];o=void 0,a=n.url,i.label=1;case 1:return i.trys.push([1,3,,4]),[4,r.options.cache.match(a)];case 2:return o=i.sent(),[3,4];case 3:return i.sent(),Ot.getInstance(r.options.id).error("Error loading background-image "+a),[3,4];case 4:return o&&(s=Bo(e,t,[o.width,o.height,o.width/o.height]),b=s[0],R=s[1],C=s[2],w=s[3],S=s[4],m=r.ctx.createPattern(r.resizeImage(o,w,S),"repeat"),r.renderRepeat(b,m,R,C)),[3,6];case 5:n.type===vt.LINEAR_GRADIENT?(c=Bo(e,t,[null,null,null]),b=c[0],R=c[1],C=c[2],w=c[3],S=c[4],u=_t(n.angle,w,S),l=u[0],d=u[1],h=u[2],f=u[3],p=u[4],(A=document.createElement("canvas")).width=w,A.height=S,g=A.getContext("2d"),v=g.createLinearGradient(d,f,h,p),Et(n.stops,l).forEach((function(e){return v.addColorStop(e.stop,st(e.color))})),g.fillStyle=v,g.fillRect(0,0,w,S),w>0&&S>0&&(m=r.ctx.createPattern(A,"repeat"),r.renderRepeat(b,m,R,C))):function(e){return e.type===vt.RADIAL_GRADIENT}(n)&&(y=Bo(e,t,[null,null,null]),b=y[0],E=y[1],_=y[2],w=y[3],S=y[4],T=0===n.position.length?[Xe]:n.position,R=Ze(T[0],w),C=Ze(T[T.length-1],S),I=function(e,t,n,r,i){var o=0,a=0;switch(e.size){case Yt.CLOSEST_SIDE:e.shape===Jt.CIRCLE?o=a=Math.min(Math.abs(t),Math.abs(t-r),Math.abs(n),Math.abs(n-i)):e.shape===Jt.ELLIPSE&&(o=Math.min(Math.abs(t),Math.abs(t-r)),a=Math.min(Math.abs(n),Math.abs(n-i)));break;case Yt.CLOSEST_CORNER:if(e.shape===Jt.CIRCLE)o=a=Math.min(wt(t,n),wt(t,n-i),wt(t-r,n),wt(t-r,n-i));else if(e.shape===Jt.ELLIPSE){var s=Math.min(Math.abs(n),Math.abs(n-i))/Math.min(Math.abs(t),Math.abs(t-r)),c=St(r,i,t,n,!0),u=c[0],l=c[1];a=s*(o=wt(u-t,(l-n)/s))}break;case Yt.FARTHEST_SIDE:e.shape===Jt.CIRCLE?o=a=Math.max(Math.abs(t),Math.abs(t-r),Math.abs(n),Math.abs(n-i)):e.shape===Jt.ELLIPSE&&(o=Math.max(Math.abs(t),Math.abs(t-r)),a=Math.max(Math.abs(n),Math.abs(n-i)));break;case Yt.FARTHEST_CORNER:if(e.shape===Jt.CIRCLE)o=a=Math.max(wt(t,n),wt(t,n-i),wt(t-r,n),wt(t-r,n-i));else if(e.shape===Jt.ELLIPSE){s=Math.max(Math.abs(n),Math.abs(n-i))/Math.max(Math.abs(t),Math.abs(t-r));var d=St(r,i,t,n,!1);u=d[0],l=d[1],a=s*(o=wt(u-t,(l-n)/s))}}return Array.isArray(e.size)&&(o=Ze(e.size[0],r),a=2===e.size.length?Ze(e.size[1],i):o),[o,a]}(n,R,C,w,S),x=I[0],O=I[1],x>0&&x>0&&(N=r.ctx.createRadialGradient(E+R,_+C,0,E+R,_+C,x),Et(n.stops,2*x).forEach((function(e){return N.addColorStop(e.stop,st(e.color))})),r.path(b),r.ctx.fillStyle=N,x!==O?(B=e.bounds.left+.5*e.bounds.width,M=e.bounds.top+.5*e.bounds.height,k=1/(L=O/x),r.ctx.save(),r.ctx.translate(B,M),r.ctx.transform(1,0,0,L,0,0),r.ctx.translate(-B,-M),r.ctx.fillRect(E,k*(_-M)+M,w,S*k),r.ctx.restore()):r.ctx.fill())),i.label=6;case 6:return t--,[2]}}))},r=this,o=0,a=e.styles.backgroundImage.slice(0).reverse(),c.label=1;case 1:return o<a.length?(s=a[o],[5,n(s)]):[3,4];case 2:c.sent(),c.label=3;case 3:return o++,[3,1];case 4:return[2]}}))}))},e.prototype.renderBorder=function(e,t,n){return r(this,void 0,void 0,(function(){return i(this,(function(r){return this.path(function(e,t){switch(t){case 0:return xo(e.topLeftBorderBox,e.topLeftPaddingBox,e.topRightBorderBox,e.topRightPaddingBox);case 1:return xo(e.topRightBorderBox,e.topRightPaddingBox,e.bottomRightBorderBox,e.bottomRightPaddingBox);case 2:return xo(e.bottomRightBorderBox,e.bottomRightPaddingBox,e.bottomLeftBorderBox,e.bottomLeftPaddingBox);case 3:default:return xo(e.bottomLeftBorderBox,e.bottomLeftPaddingBox,e.topLeftBorderBox,e.topLeftPaddingBox)}}(n,t)),this.ctx.fillStyle=st(e),this.ctx.fill(),[2]}))}))},e.prototype.renderNodeBackgroundAndBorders=function(e){return r(this,void 0,void 0,(function(){var t,n,r,o,a,s,c,u,l=this;return i(this,(function(i){switch(i.label){case 0:return this.applyEffects(e.effects,2),t=e.container.styles,n=!at(t.backgroundColor)||t.backgroundImage.length,r=[{style:t.borderTopStyle,color:t.borderTopColor},{style:t.borderRightStyle,color:t.borderRightColor},{style:t.borderBottomStyle,color:t.borderBottomColor},{style:t.borderLeftStyle,color:t.borderLeftColor}],o=Vo(Uo(t.backgroundClip,0),e.curves),n||t.boxShadow.length?(this.ctx.save(),this.path(o),this.ctx.clip(),at(t.backgroundColor)||(this.ctx.fillStyle=st(t.backgroundColor),this.ctx.fill()),[4,this.renderBackgroundImage(e.container)]):[3,2];case 1:i.sent(),this.ctx.restore(),t.boxShadow.slice(0).reverse().forEach((function(t){l.ctx.save();var n,r,i,o,a,s=Eo(e.curves),c=t.inset?0:1e4,u=(n=s,r=-c+(t.inset?1:-1)*t.spread.number,i=(t.inset?1:-1)*t.spread.number,o=t.spread.number*(t.inset?-2:2),a=t.spread.number*(t.inset?-2:2),n.map((function(e,t){switch(t){case 0:return e.add(r,i);case 1:return e.add(r+o,i);case 2:return e.add(r+o,i+a);case 3:return e.add(r,i+a)}return e})));t.inset?(l.path(s),l.ctx.clip(),l.mask(u)):(l.mask(s),l.ctx.clip(),l.path(u)),l.ctx.shadowOffsetX=t.offsetX.number+c,l.ctx.shadowOffsetY=t.offsetY.number,l.ctx.shadowColor=st(t.color),l.ctx.shadowBlur=t.blur.number,l.ctx.fillStyle=t.inset?st(t.color):"rgba(0,0,0,1)",l.ctx.fill(),l.ctx.restore()})),i.label=2;case 2:a=0,s=0,c=r,i.label=3;case 3:return s<c.length?(u=c[s]).style===cn.NONE||at(u.color)?[3,5]:[4,this.renderBorder(u.color,a,e.curves)]:[3,7];case 4:i.sent(),i.label=5;case 5:a++,i.label=6;case 6:return s++,[3,3];case 7:return[2]}}))}))},e.prototype.render=function(e){return r(this,void 0,void 0,(function(){var t;return i(this,(function(n){switch(n.label){case 0:return this.options.backgroundColor&&(this.ctx.fillStyle=st(this.options.backgroundColor),this.ctx.fillRect(this.options.x-this.options.scrollX,this.options.y-this.options.scrollY,this.options.width,this.options.height)),r=new Ro(e,[]),i=new To(r),Co(r,i,i,o=[]),Io(r.container,o),t=i,[4,this.renderStack(t)];case 1:return n.sent(),this.applyEffects([],2),[2,this.canvas]}var r,i,o}))}))},e}(),jo=function(e){return e instanceof hi||(e instanceof di||e instanceof li&&e.type!==si&&e.type!==ai)},Vo=function(e,t){switch(e){case ft.BORDER_BOX:return Eo(t);case ft.CONTENT_BOX:return function(e){return[e.topLeftContentBox,e.topRightContentBox,e.bottomRightContentBox,e.bottomLeftContentBox]}(t);case ft.PADDING_BOX:default:return _o(t)}},Qo=function(e){switch(e){case $n.CENTER:return"center";case $n.RIGHT:return"right";case $n.LEFT:default:return"left"}},Go=function(){function e(e){this.canvas=e.canvas?e.canvas:document.createElement("canvas"),this.ctx=this.canvas.getContext("2d"),this.options=e,this.canvas.width=Math.floor(e.width*e.scale),this.canvas.height=Math.floor(e.height*e.scale),this.canvas.style.width=e.width+"px",this.canvas.style.height=e.height+"px",this.ctx.scale(this.options.scale,this.options.scale),this.ctx.translate(-e.x+e.scrollX,-e.y+e.scrollY),Ot.getInstance(e.id).debug("EXPERIMENTAL ForeignObject renderer initialized ("+e.width+"x"+e.height+" at "+e.x+","+e.y+") with scale "+e.scale)}return e.prototype.render=function(e){return r(this,void 0,void 0,(function(){var t,n;return i(this,(function(r){switch(r.label){case 0:return t=Ct(Math.max(this.options.windowWidth,this.options.width)*this.options.scale,Math.max(this.options.windowHeight,this.options.height)*this.options.scale,this.options.scrollX*this.options.scale,this.options.scrollY*this.options.scale,e),[4,zo(t)];case 1:return n=r.sent(),this.options.backgroundColor&&(this.ctx.fillStyle=st(this.options.backgroundColor),this.ctx.fillRect(0,0,this.options.width*this.options.scale,this.options.height*this.options.scale)),this.ctx.drawImage(n,-this.options.x*this.options.scale,-this.options.y*this.options.scale),[2,this.canvas]}}))}))},e}(),zo=function(e){return new Promise((function(t,n){var r=new Image;r.onload=function(){t(r)},r.onerror=n,r.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent((new XMLSerializer).serializeToString(e))}))},Ko=function(e){return ot(ke.create(e).parseComponentValue())};"undefined"!=typeof window&&Nt.setContext(window);var qo=function(e,t){return r(undefined,void 0,void 0,(function(){var r,s,c,u,l,d,h,f,p,A,g,v,m,y,b,E,_,w,S,T,R,C,I;return i(this,(function(i){switch(i.label){case 0:if(!(r=e.ownerDocument))throw new Error("Element is not attached to a Document");if(!(s=r.defaultView))throw new Error("Document is not attached to a Window");return c=(Math.round(1e3*Math.random())+Date.now()).toString(16),u=xi(e)||"HTML"===e.tagName?function(e){var t=e.body,n=e.documentElement;if(!t||!n)throw new Error("Unable to get document size");var r=Math.max(Math.max(t.scrollWidth,n.scrollWidth),Math.max(t.offsetWidth,n.offsetWidth),Math.max(t.clientWidth,n.clientWidth)),i=Math.max(Math.max(t.scrollHeight,n.scrollHeight),Math.max(t.offsetHeight,n.offsetHeight),Math.max(t.clientHeight,n.clientHeight));return new o(0,0,r,i)}(r):a(e),l=u.width,d=u.height,h=u.left,f=u.top,p=n({},{allowTaint:!1,imageTimeout:15e3,proxy:void 0,useCORS:!1},t),A={backgroundColor:"#ffffff",cache:t.cache?t.cache:Nt.create(c,p),logging:!0,removeContainer:!0,foreignObjectRendering:!1,scale:s.devicePixelRatio||1,windowWidth:s.innerWidth,windowHeight:s.innerHeight,scrollX:s.pageXOffset,scrollY:s.pageYOffset,x:h,y:f,width:Math.ceil(l),height:Math.ceil(d),id:c},g=n({},A,p,t),v=new o(g.scrollX,g.scrollY,g.windowWidth,g.windowHeight),Ot.create({id:c,enabled:g.logging}),Ot.getInstance(c).debug("Starting document clone"),m=new $i(e,{id:c,onclone:g.onclone,ignoreElements:g.ignoreElements,inlineImages:g.foreignObjectRendering,copyStyles:g.foreignObjectRendering}),(y=m.clonedReferenceElement)?[4,m.toIFrame(r,v)]:[2,Promise.reject("Unable to find element in cloned iframe")];case 1:return b=i.sent(),E=r.documentElement?Ko(getComputedStyle(r.documentElement).backgroundColor):gt.TRANSPARENT,_=r.body?Ko(getComputedStyle(r.body).backgroundColor):gt.TRANSPARENT,w=t.backgroundColor,S="string"==typeof w?Ko(w):null===w?gt.TRANSPARENT:4294967295,T=e===r.documentElement?at(E)?at(_)?S:_:E:S,R={id:c,cache:g.cache,canvas:g.canvas,backgroundColor:T,scale:g.scale,x:g.x,y:g.y,scrollX:g.scrollX,scrollY:g.scrollY,width:g.width,height:g.height,windowWidth:g.windowWidth,windowHeight:g.windowHeight},g.foreignObjectRendering?(Ot.getInstance(c).debug("Document cloned, using foreign object rendering"),[4,new Go(R).render(y)]):[3,3];case 2:return C=i.sent(),[3,5];case 3:return Ot.getInstance(c).debug("Document cloned, using computed rendering"),Nt.attachInstance(g.cache),Ot.getInstance(c).debug("Starting DOM parsing"),I=mi(y),Nt.detachInstance(),T===I.styles.backgroundColor&&(I.styles.backgroundColor=gt.TRANSPARENT),Ot.getInstance(c).debug("Starting renderer"),[4,new Ho(R).render(I)];case 4:C=i.sent(),i.label=5;case 5:return!0===g.removeContainer&&($i.destroy(b)||Ot.getInstance(c).error("Cannot detach cloned iframe as it is not in the DOM anymore")),Ot.getInstance(c).debug("Finished rendering"),Ot.destroy(c),Nt.destroy(c),[2,C]}}))}))};return function(e,t){return void 0===t&&(t={}),qo(e,t)}})),
/**
 * @license b-here v1.0.0
 * (c) 2021 Luca Zampetti <lzampetti@gmail.com>
 * License: MIT
 */
function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).THREE={})}(this,(function(e){"use strict";function t(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,i)}function n(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function r(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}function i(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}function o(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function s(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return a(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}for(var c,u="128",l=100,d=300,h=301,f=302,p=303,A=304,g=306,v=307,m=1e3,y=1001,b=1002,E=1003,_=1004,w=1005,S=1006,T=1007,R=1008,C=1009,I=1012,x=1014,O=1015,N=1016,B=1020,M=1022,L=1023,k=1026,U=1027,D=33776,P=33777,F=33778,H=33779,j=35840,V=35841,Q=35842,G=35843,z=37492,K=37496,q=2300,W=2301,X=2302,J=2400,Y=2401,Z=2402,$=2500,ee=2501,te=3e3,ne=3001,re=3007,ie=3002,oe=3004,ae=3005,se=3006,ce=7680,ue=35044,le=35048,de="300 es",he=function(){function e(){}var t=e.prototype;return t.addEventListener=function(e,t){void 0===this._listeners&&(this._listeners={});var n=this._listeners;void 0===n[e]&&(n[e]=[]),-1===n[e].indexOf(t)&&n[e].push(t)},t.hasEventListener=function(e,t){if(void 0===this._listeners)return!1;var n=this._listeners;return void 0!==n[e]&&-1!==n[e].indexOf(t)},t.removeEventListener=function(e,t){if(void 0!==this._listeners){var n=this._listeners[e];if(void 0!==n){var r=n.indexOf(t);-1!==r&&n.splice(r,1)}}},t.dispatchEvent=function(e){if(void 0!==this._listeners){var t=this._listeners[e.type];if(void 0!==t){e.target=this;for(var n=t.slice(0),r=0,i=n.length;r<i;r++)n[r].call(this,e);e.target=null}}},e}(),fe=[],pe=0
/**
   * @license
   * Copyright 2010-2021 Three.js Authors
   * SPDX-License-Identifier: MIT
   */;pe<256;pe++)fe[pe]=(pe<16?"0":"")+pe.toString(16);var Ae=1234567,ge=Math.PI/180,ve=180/Math.PI;function me(){var e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,n=4294967295*Math.random()|0,r=4294967295*Math.random()|0;return(fe[255&e]+fe[e>>8&255]+fe[e>>16&255]+fe[e>>24&255]+"-"+fe[255&t]+fe[t>>8&255]+"-"+fe[t>>16&15|64]+fe[t>>24&255]+"-"+fe[63&n|128]+fe[n>>8&255]+"-"+fe[n>>16&255]+fe[n>>24&255]+fe[255&r]+fe[r>>8&255]+fe[r>>16&255]+fe[r>>24&255]).toUpperCase()}function ye(e,t,n){return Math.max(t,Math.min(n,e))}function be(e,t){return(e%t+t)%t}function Ee(e,t,n){return(1-n)*e+n*t}function _e(e){return 0==(e&e-1)&&0!==e}function we(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))}function Se(e){return Math.pow(2,Math.floor(Math.log(e)/Math.LN2))}var Te=Object.freeze({__proto__:null,DEG2RAD:ge,RAD2DEG:ve,generateUUID:me,clamp:ye,euclideanModulo:be,mapLinear:function(e,t,n,r,i){return r+(e-t)*(i-r)/(n-t)},inverseLerp:function(e,t,n){return e!==t?(n-e)/(t-e):0},lerp:Ee,damp:function(e,t,n,r){return Ee(e,t,1-Math.exp(-n*r))},pingpong:function(e,t){return void 0===t&&(t=1),t-Math.abs(be(e,2*t)-t)},smoothstep:function(e,t,n){return e<=t?0:e>=n?1:(e=(e-t)/(n-t))*e*(3-2*e)},smootherstep:function(e,t,n){return e<=t?0:e>=n?1:(e=(e-t)/(n-t))*e*e*(e*(6*e-15)+10)},randInt:function(e,t){return e+Math.floor(Math.random()*(t-e+1))},randFloat:function(e,t){return e+Math.random()*(t-e)},randFloatSpread:function(e){return e*(.5-Math.random())},seededRandom:function(e){return void 0!==e&&(Ae=e%2147483647),((Ae=16807*Ae%2147483647)-1)/2147483646},degToRad:function(e){return e*ge},radToDeg:function(e){return e*ve},isPowerOfTwo:_e,ceilPowerOfTwo:we,floorPowerOfTwo:Se,setQuaternionFromProperEuler:function(e,t,n,r,i){var o=Math.cos,a=Math.sin,s=o(n/2),c=a(n/2),u=o((t+r)/2),l=a((t+r)/2),d=o((t-r)/2),h=a((t-r)/2),f=o((r-t)/2),p=a((r-t)/2);switch(i){case"XYX":e.set(s*l,c*d,c*h,s*u);break;case"YZY":e.set(c*h,s*l,c*d,s*u);break;case"ZXZ":e.set(c*d,c*h,s*l,s*u);break;case"XZX":e.set(s*l,c*p,c*f,s*u);break;case"YXY":e.set(c*f,s*l,c*p,s*u);break;case"ZYZ":e.set(c*p,c*f,s*l,s*u);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+i)}}}),Re=function(){function e(e,t){void 0===e&&(e=0),void 0===t&&(t=0),this.x=e,this.y=t}var t=e.prototype;return t.set=function(e,t){return this.x=e,this.y=t,this},t.setScalar=function(e){return this.x=e,this.y=e,this},t.setX=function(e){return this.x=e,this},t.setY=function(e){return this.y=e,this},t.setComponent=function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this},t.getComponent=function(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}},t.clone=function(){return new this.constructor(this.x,this.y)},t.copy=function(e){return this.x=e.x,this.y=e.y,this},t.add=function(e,t){return void 0!==t?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this)},t.addScalar=function(e){return this.x+=e,this.y+=e,this},t.addVectors=function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this},t.addScaledVector=function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this},t.sub=function(e,t){return void 0!==t?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this)},t.subScalar=function(e){return this.x-=e,this.y-=e,this},t.subVectors=function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this},t.multiply=function(e){return this.x*=e.x,this.y*=e.y,this},t.multiplyScalar=function(e){return this.x*=e,this.y*=e,this},t.divide=function(e){return this.x/=e.x,this.y/=e.y,this},t.divideScalar=function(e){return this.multiplyScalar(1/e)},t.applyMatrix3=function(e){var t=this.x,n=this.y,r=e.elements;return this.x=r[0]*t+r[3]*n+r[6],this.y=r[1]*t+r[4]*n+r[7],this},t.min=function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this},t.max=function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this},t.clamp=function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this},t.clampScalar=function(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this},t.clampLength=function(e,t){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))},t.floor=function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},t.ceil=function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},t.round=function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},t.roundToZero=function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this},t.negate=function(){return this.x=-this.x,this.y=-this.y,this},t.dot=function(e){return this.x*e.x+this.y*e.y},t.cross=function(e){return this.x*e.y-this.y*e.x},t.lengthSq=function(){return this.x*this.x+this.y*this.y},t.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},t.manhattanLength=function(){return Math.abs(this.x)+Math.abs(this.y)},t.normalize=function(){return this.divideScalar(this.length()||1)},t.angle=function(){var e=Math.atan2(-this.y,-this.x)+Math.PI;return e},t.distanceTo=function(e){return Math.sqrt(this.distanceToSquared(e))},t.distanceToSquared=function(e){var t=this.x-e.x,n=this.y-e.y;return t*t+n*n},t.manhattanDistanceTo=function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)},t.setLength=function(e){return this.normalize().multiplyScalar(e)},t.lerp=function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this},t.lerpVectors=function(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this},t.equals=function(e){return e.x===this.x&&e.y===this.y},t.fromArray=function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this},t.toArray=function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e},t.fromBufferAttribute=function(e,t,n){return void 0!==n&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this},t.rotateAround=function(e,t){var n=Math.cos(t),r=Math.sin(t),i=this.x-e.x,o=this.y-e.y;return this.x=i*n-o*r+e.x,this.y=i*r+o*n+e.y,this},t.random=function(){return this.x=Math.random(),this.y=Math.random(),this},r(e,[{key:"width",get:function(){return this.x},set:function(e){this.x=e}},{key:"height",get:function(){return this.y},set:function(e){this.y=e}}]),e}();Re.prototype.isVector2=!0;var Ce,Ie=function(){function e(){this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}var t=e.prototype;return t.set=function(e,t,n,r,i,o,a,s,c){var u=this.elements;return u[0]=e,u[1]=r,u[2]=a,u[3]=t,u[4]=i,u[5]=s,u[6]=n,u[7]=o,u[8]=c,this},t.identity=function(){return this.set(1,0,0,0,1,0,0,0,1),this},t.copy=function(e){var t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this},t.extractBasis=function(e,t,n){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this},t.setFromMatrix4=function(e){var t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this},t.multiply=function(e){return this.multiplyMatrices(this,e)},t.premultiply=function(e){return this.multiplyMatrices(e,this)},t.multiplyMatrices=function(e,t){var n=e.elements,r=t.elements,i=this.elements,o=n[0],a=n[3],s=n[6],c=n[1],u=n[4],l=n[7],d=n[2],h=n[5],f=n[8],p=r[0],A=r[3],g=r[6],v=r[1],m=r[4],y=r[7],b=r[2],E=r[5],_=r[8];return i[0]=o*p+a*v+s*b,i[3]=o*A+a*m+s*E,i[6]=o*g+a*y+s*_,i[1]=c*p+u*v+l*b,i[4]=c*A+u*m+l*E,i[7]=c*g+u*y+l*_,i[2]=d*p+h*v+f*b,i[5]=d*A+h*m+f*E,i[8]=d*g+h*y+f*_,this},t.multiplyScalar=function(e){var t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this},t.determinant=function(){var e=this.elements,t=e[0],n=e[1],r=e[2],i=e[3],o=e[4],a=e[5],s=e[6],c=e[7],u=e[8];return t*o*u-t*a*c-n*i*u+n*a*s+r*i*c-r*o*s},t.invert=function(){var e=this.elements,t=e[0],n=e[1],r=e[2],i=e[3],o=e[4],a=e[5],s=e[6],c=e[7],u=e[8],l=u*o-a*c,d=a*s-u*i,h=c*i-o*s,f=t*l+n*d+r*h;if(0===f)return this.set(0,0,0,0,0,0,0,0,0);var p=1/f;return e[0]=l*p,e[1]=(r*c-u*n)*p,e[2]=(a*n-r*o)*p,e[3]=d*p,e[4]=(u*t-r*s)*p,e[5]=(r*i-a*t)*p,e[6]=h*p,e[7]=(n*s-c*t)*p,e[8]=(o*t-n*i)*p,this},t.transpose=function(){var e,t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this},t.getNormalMatrix=function(e){return this.setFromMatrix4(e).invert().transpose()},t.transposeIntoArray=function(e){var t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this},t.setUvTransform=function(e,t,n,r,i,o,a){var s=Math.cos(i),c=Math.sin(i);return this.set(n*s,n*c,-n*(s*o+c*a)+o+e,-r*c,r*s,-r*(-c*o+s*a)+a+t,0,0,1),this},t.scale=function(e,t){var n=this.elements;return n[0]*=e,n[3]*=e,n[6]*=e,n[1]*=t,n[4]*=t,n[7]*=t,this},t.rotate=function(e){var t=Math.cos(e),n=Math.sin(e),r=this.elements,i=r[0],o=r[3],a=r[6],s=r[1],c=r[4],u=r[7];return r[0]=t*i+n*s,r[3]=t*o+n*c,r[6]=t*a+n*u,r[1]=-n*i+t*s,r[4]=-n*o+t*c,r[7]=-n*a+t*u,this},t.translate=function(e,t){var n=this.elements;return n[0]+=e*n[2],n[3]+=e*n[5],n[6]+=e*n[8],n[1]+=t*n[2],n[4]+=t*n[5],n[7]+=t*n[8],this},t.equals=function(e){for(var t=this.elements,n=e.elements,r=0;r<9;r++)if(t[r]!==n[r])return!1;return!0},t.fromArray=function(e,t){void 0===t&&(t=0);for(var n=0;n<9;n++)this.elements[n]=e[n+t];return this},t.toArray=function(e,t){void 0===e&&(e=[]),void 0===t&&(t=0);var n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e},t.clone=function(){return(new this.constructor).fromArray(this.elements)},e}();Ie.prototype.isMatrix3=!0;var xe=function(){function e(){}return e.getDataURL=function(e){if(/^data:/i.test(e.src))return e.src;if("undefined"==typeof HTMLCanvasElement)return e.src;var t;if(e instanceof HTMLCanvasElement)t=e;else{void 0===Ce&&(Ce=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")),Ce.width=e.width,Ce.height=e.height;var n=Ce.getContext("2d");e instanceof ImageData?n.putImageData(e,0,0):n.drawImage(e,0,0,e.width,e.height),t=Ce}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")},e}(),Oe=0,Ne=function(e){function t(n,r,i,a,s,c,u,l,d,h){var f;return void 0===n&&(n=t.DEFAULT_IMAGE),void 0===r&&(r=t.DEFAULT_MAPPING),void 0===i&&(i=y),void 0===a&&(a=y),void 0===s&&(s=S),void 0===c&&(c=R),void 0===u&&(u=L),void 0===l&&(l=C),void 0===d&&(d=1),void 0===h&&(h=te),f=e.call(this)||this,Object.defineProperty(o(f),"id",{value:Oe++}),f.uuid=me(),f.name="",f.image=n,f.mipmaps=[],f.mapping=r,f.wrapS=i,f.wrapT=a,f.magFilter=s,f.minFilter=c,f.anisotropy=d,f.format=u,f.internalFormat=null,f.type=l,f.offset=new Re(0,0),f.repeat=new Re(1,1),f.center=new Re(0,0),f.rotation=0,f.matrixAutoUpdate=!0,f.matrix=new Ie,f.generateMipmaps=!0,f.premultiplyAlpha=!1,f.flipY=!0,f.unpackAlignment=4,f.encoding=h,f.version=0,f.onUpdate=null,f}i(t,e);var n=t.prototype;return n.updateMatrix=function(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)},n.clone=function(){return(new this.constructor).copy(this)},n.copy=function(e){return this.name=e.name,this.image=e.image,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.encoding=e.encoding,this},n.toJSON=function(e){var t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.textures[this.uuid])return e.textures[this.uuid];var n={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(void 0!==this.image){var r=this.image;if(void 0===r.uuid&&(r.uuid=me()),!t&&void 0===e.images[r.uuid]){var i;if(Array.isArray(r)){i=[];for(var o=0,a=r.length;o<a;o++)r[o].isDataTexture?i.push(Be(r[o].image)):i.push(Be(r[o]))}else i=Be(r);e.images[r.uuid]={uuid:r.uuid,url:i}}n.image=r.uuid}return t||(e.textures[this.uuid]=n),n},n.dispose=function(){this.dispatchEvent({type:"dispose"})},n.transformUv=function(e){if(this.mapping!==d)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case m:e.x=e.x-Math.floor(e.x);break;case y:e.x=e.x<0?0:1;break;case b:1===Math.abs(Math.floor(e.x)%2)?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x)}if(e.y<0||e.y>1)switch(this.wrapT){case m:e.y=e.y-Math.floor(e.y);break;case y:e.y=e.y<0?0:1;break;case b:1===Math.abs(Math.floor(e.y)%2)?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y)}return this.flipY&&(e.y=1-e.y),e},r(t,[{key:"needsUpdate",set:function(e){!0===e&&this.version++}}]),t}(he);function Be(e){return"undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap?xe.getDataURL(e):e.data?{data:Array.prototype.slice.call(e.data),width:e.width,height:e.height,type:e.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}Ne.DEFAULT_IMAGE=void 0,Ne.DEFAULT_MAPPING=d,Ne.prototype.isTexture=!0;var Me=function(){function e(e,t,n,r){void 0===e&&(e=0),void 0===t&&(t=0),void 0===n&&(n=0),void 0===r&&(r=1),this.x=e,this.y=t,this.z=n,this.w=r}var t=e.prototype;return t.set=function(e,t,n,r){return this.x=e,this.y=t,this.z=n,this.w=r,this},t.setScalar=function(e){return this.x=e,this.y=e,this.z=e,this.w=e,this},t.setX=function(e){return this.x=e,this},t.setY=function(e){return this.y=e,this},t.setZ=function(e){return this.z=e,this},t.setW=function(e){return this.w=e,this},t.setComponent=function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this},t.getComponent=function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}},t.clone=function(){return new this.constructor(this.x,this.y,this.z,this.w)},t.copy=function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this},t.add=function(e,t){return void 0!==t?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this)},t.addScalar=function(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this},t.addVectors=function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this},t.addScaledVector=function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this},t.sub=function(e,t){return void 0!==t?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this)},t.subScalar=function(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this},t.subVectors=function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this},t.multiply=function(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this},t.multiplyScalar=function(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this},t.applyMatrix4=function(e){var t=this.x,n=this.y,r=this.z,i=this.w,o=e.elements;return this.x=o[0]*t+o[4]*n+o[8]*r+o[12]*i,this.y=o[1]*t+o[5]*n+o[9]*r+o[13]*i,this.z=o[2]*t+o[6]*n+o[10]*r+o[14]*i,this.w=o[3]*t+o[7]*n+o[11]*r+o[15]*i,this},t.divideScalar=function(e){return this.multiplyScalar(1/e)},t.setAxisAngleFromQuaternion=function(e){this.w=2*Math.acos(e.w);var t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this},t.setAxisAngleFromRotationMatrix=function(e){var t,n,r,i,o=.01,a=.1,s=e.elements,c=s[0],u=s[4],l=s[8],d=s[1],h=s[5],f=s[9],p=s[2],A=s[6],g=s[10];if(Math.abs(u-d)<o&&Math.abs(l-p)<o&&Math.abs(f-A)<o){if(Math.abs(u+d)<a&&Math.abs(l+p)<a&&Math.abs(f+A)<a&&Math.abs(c+h+g-3)<a)return this.set(1,0,0,0),this;t=Math.PI;var v=(c+1)/2,m=(h+1)/2,y=(g+1)/2,b=(u+d)/4,E=(l+p)/4,_=(f+A)/4;return v>m&&v>y?v<o?(n=0,r=.707106781,i=.707106781):(r=b/(n=Math.sqrt(v)),i=E/n):m>y?m<o?(n=.707106781,r=0,i=.707106781):(n=b/(r=Math.sqrt(m)),i=_/r):y<o?(n=.707106781,r=.707106781,i=0):(n=E/(i=Math.sqrt(y)),r=_/i),this.set(n,r,i,t),this}var w=Math.sqrt((A-f)*(A-f)+(l-p)*(l-p)+(d-u)*(d-u));return Math.abs(w)<.001&&(w=1),this.x=(A-f)/w,this.y=(l-p)/w,this.z=(d-u)/w,this.w=Math.acos((c+h+g-1)/2),this},t.min=function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this},t.max=function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this},t.clamp=function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this},t.clampScalar=function(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this},t.clampLength=function(e,t){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))},t.floor=function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},t.ceil=function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},t.round=function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},t.roundToZero=function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},t.negate=function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},t.dot=function(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w},t.lengthSq=function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},t.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},t.manhattanLength=function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},t.normalize=function(){return this.divideScalar(this.length()||1)},t.setLength=function(e){return this.normalize().multiplyScalar(e)},t.lerp=function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this},t.lerpVectors=function(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this.w=e.w+(t.w-e.w)*n,this},t.equals=function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w},t.fromArray=function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this},t.toArray=function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e},t.fromBufferAttribute=function(e,t,n){return void 0!==n&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this},t.random=function(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this},r(e,[{key:"width",get:function(){return this.z},set:function(e){this.z=e}},{key:"height",get:function(){return this.w},set:function(e){this.w=e}}]),e}();Me.prototype.isVector4=!0;var Le=function(e){function t(t,n,r){var i;return(i=e.call(this)||this).width=t,i.height=n,i.depth=1,i.scissor=new Me(0,0,t,n),i.scissorTest=!1,i.viewport=new Me(0,0,t,n),r=r||{},i.texture=new Ne(void 0,r.mapping,r.wrapS,r.wrapT,r.magFilter,r.minFilter,r.format,r.type,r.anisotropy,r.encoding),i.texture.image={},i.texture.image.width=t,i.texture.image.height=n,i.texture.image.depth=1,i.texture.generateMipmaps=void 0!==r.generateMipmaps&&r.generateMipmaps,i.texture.minFilter=void 0!==r.minFilter?r.minFilter:S,i.depthBuffer=void 0===r.depthBuffer||r.depthBuffer,i.stencilBuffer=void 0!==r.stencilBuffer&&r.stencilBuffer,i.depthTexture=void 0!==r.depthTexture?r.depthTexture:null,i}i(t,e);var n=t.prototype;return n.setTexture=function(e){e.image={width:this.width,height:this.height,depth:this.depth},this.texture=e},n.setSize=function(e,t,n){void 0===n&&(n=1),this.width===e&&this.height===t&&this.depth===n||(this.width=e,this.height=t,this.depth=n,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=n,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)},n.clone=function(){return(new this.constructor).copy(this)},n.copy=function(e){return this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.depthTexture=e.depthTexture,this},n.dispose=function(){this.dispatchEvent({type:"dispose"})},t}(he);Le.prototype.isWebGLRenderTarget=!0;var ke=function(e){function t(t,n,r){var i;return(i=e.call(this,t,n,r)||this).samples=4,i}return i(t,e),t.prototype.copy=function(t){return e.prototype.copy.call(this,t),this.samples=t.samples,this},t}(Le);ke.prototype.isWebGLMultisampleRenderTarget=!0;var Ue=function(){function e(e,t,n,r){void 0===e&&(e=0),void 0===t&&(t=0),void 0===n&&(n=0),void 0===r&&(r=1),this._x=e,this._y=t,this._z=n,this._w=r}e.slerp=function(e,t,n,r){return console.warn("THREE.Quaternion: Static .slerp() has been deprecated. Use qm.slerpQuaternions( qa, qb, t ) instead."),n.slerpQuaternions(e,t,r)},e.slerpFlat=function(e,t,n,r,i,o,a){var s=n[r+0],c=n[r+1],u=n[r+2],l=n[r+3],d=i[o+0],h=i[o+1],f=i[o+2],p=i[o+3];if(0===a)return e[t+0]=s,e[t+1]=c,e[t+2]=u,void(e[t+3]=l);if(1===a)return e[t+0]=d,e[t+1]=h,e[t+2]=f,void(e[t+3]=p);if(l!==p||s!==d||c!==h||u!==f){var A=1-a,g=s*d+c*h+u*f+l*p,v=g>=0?1:-1,m=1-g*g;if(m>Number.EPSILON){var y=Math.sqrt(m),b=Math.atan2(y,g*v);A=Math.sin(A*b)/y,a=Math.sin(a*b)/y}var E=a*v;if(s=s*A+d*E,c=c*A+h*E,u=u*A+f*E,l=l*A+p*E,A===1-a){var _=1/Math.sqrt(s*s+c*c+u*u+l*l);s*=_,c*=_,u*=_,l*=_}}e[t]=s,e[t+1]=c,e[t+2]=u,e[t+3]=l},e.multiplyQuaternionsFlat=function(e,t,n,r,i,o){var a=n[r],s=n[r+1],c=n[r+2],u=n[r+3],l=i[o],d=i[o+1],h=i[o+2],f=i[o+3];return e[t]=a*f+u*l+s*h-c*d,e[t+1]=s*f+u*d+c*l-a*h,e[t+2]=c*f+u*h+a*d-s*l,e[t+3]=u*f-a*l-s*d-c*h,e};var t=e.prototype;return t.set=function(e,t,n,r){return this._x=e,this._y=t,this._z=n,this._w=r,this._onChangeCallback(),this},t.clone=function(){return new this.constructor(this._x,this._y,this._z,this._w)},t.copy=function(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this},t.setFromEuler=function(e,t){if(!e||!e.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var n=e._x,r=e._y,i=e._z,o=e._order,a=Math.cos,s=Math.sin,c=a(n/2),u=a(r/2),l=a(i/2),d=s(n/2),h=s(r/2),f=s(i/2);switch(o){case"XYZ":this._x=d*u*l+c*h*f,this._y=c*h*l-d*u*f,this._z=c*u*f+d*h*l,this._w=c*u*l-d*h*f;break;case"YXZ":this._x=d*u*l+c*h*f,this._y=c*h*l-d*u*f,this._z=c*u*f-d*h*l,this._w=c*u*l+d*h*f;break;case"ZXY":this._x=d*u*l-c*h*f,this._y=c*h*l+d*u*f,this._z=c*u*f+d*h*l,this._w=c*u*l-d*h*f;break;case"ZYX":this._x=d*u*l-c*h*f,this._y=c*h*l+d*u*f,this._z=c*u*f-d*h*l,this._w=c*u*l+d*h*f;break;case"YZX":this._x=d*u*l+c*h*f,this._y=c*h*l+d*u*f,this._z=c*u*f-d*h*l,this._w=c*u*l-d*h*f;break;case"XZY":this._x=d*u*l-c*h*f,this._y=c*h*l-d*u*f,this._z=c*u*f+d*h*l,this._w=c*u*l+d*h*f;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return!1!==t&&this._onChangeCallback(),this},t.setFromAxisAngle=function(e,t){var n=t/2,r=Math.sin(n);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(n),this._onChangeCallback(),this},t.setFromRotationMatrix=function(e){var t=e.elements,n=t[0],r=t[4],i=t[8],o=t[1],a=t[5],s=t[9],c=t[2],u=t[6],l=t[10],d=n+a+l;if(d>0){var h=.5/Math.sqrt(d+1);this._w=.25/h,this._x=(u-s)*h,this._y=(i-c)*h,this._z=(o-r)*h}else if(n>a&&n>l){var f=2*Math.sqrt(1+n-a-l);this._w=(u-s)/f,this._x=.25*f,this._y=(r+o)/f,this._z=(i+c)/f}else if(a>l){var p=2*Math.sqrt(1+a-n-l);this._w=(i-c)/p,this._x=(r+o)/p,this._y=.25*p,this._z=(s+u)/p}else{var A=2*Math.sqrt(1+l-n-a);this._w=(o-r)/A,this._x=(i+c)/A,this._y=(s+u)/A,this._z=.25*A}return this._onChangeCallback(),this},t.setFromUnitVectors=function(e,t){var n=e.dot(t)+1;return n<Number.EPSILON?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=n):(this._x=0,this._y=-e.z,this._z=e.y,this._w=n)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=n),this.normalize()},t.angleTo=function(e){return 2*Math.acos(Math.abs(ye(this.dot(e),-1,1)))},t.rotateTowards=function(e,t){var n=this.angleTo(e);if(0===n)return this;var r=Math.min(1,t/n);return this.slerp(e,r),this},t.identity=function(){return this.set(0,0,0,1)},t.invert=function(){return this.conjugate()},t.conjugate=function(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this},t.dot=function(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w},t.lengthSq=function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},t.length=function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},t.normalize=function(){var e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this},t.multiply=function(e,t){return void 0!==t?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(e,t)):this.multiplyQuaternions(this,e)},t.premultiply=function(e){return this.multiplyQuaternions(e,this)},t.multiplyQuaternions=function(e,t){var n=e._x,r=e._y,i=e._z,o=e._w,a=t._x,s=t._y,c=t._z,u=t._w;return this._x=n*u+o*a+r*c-i*s,this._y=r*u+o*s+i*a-n*c,this._z=i*u+o*c+n*s-r*a,this._w=o*u-n*a-r*s-i*c,this._onChangeCallback(),this},t.slerp=function(e,t){if(0===t)return this;if(1===t)return this.copy(e);var n=this._x,r=this._y,i=this._z,o=this._w,a=o*e._w+n*e._x+r*e._y+i*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),a>=1)return this._w=o,this._x=n,this._y=r,this._z=i,this;var s=1-a*a;if(s<=Number.EPSILON){var c=1-t;return this._w=c*o+t*this._w,this._x=c*n+t*this._x,this._y=c*r+t*this._y,this._z=c*i+t*this._z,this.normalize(),this._onChangeCallback(),this}var u=Math.sqrt(s),l=Math.atan2(u,a),d=Math.sin((1-t)*l)/u,h=Math.sin(t*l)/u;return this._w=o*d+this._w*h,this._x=n*d+this._x*h,this._y=r*d+this._y*h,this._z=i*d+this._z*h,this._onChangeCallback(),this},t.slerpQuaternions=function(e,t,n){this.copy(e).slerp(t,n)},t.equals=function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w},t.fromArray=function(e,t){return void 0===t&&(t=0),this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this},t.toArray=function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e},t.fromBufferAttribute=function(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this},t._onChange=function(e){return this._onChangeCallback=e,this},t._onChangeCallback=function(){},r(e,[{key:"x",get:function(){return this._x},set:function(e){this._x=e,this._onChangeCallback()}},{key:"y",get:function(){return this._y},set:function(e){this._y=e,this._onChangeCallback()}},{key:"z",get:function(){return this._z},set:function(e){this._z=e,this._onChangeCallback()}},{key:"w",get:function(){return this._w},set:function(e){this._w=e,this._onChangeCallback()}}]),e}();Ue.prototype.isQuaternion=!0;var De=function(){function e(e,t,n){void 0===e&&(e=0),void 0===t&&(t=0),void 0===n&&(n=0),this.x=e,this.y=t,this.z=n}var t=e.prototype;return t.set=function(e,t,n){return void 0===n&&(n=this.z),this.x=e,this.y=t,this.z=n,this},t.setScalar=function(e){return this.x=e,this.y=e,this.z=e,this},t.setX=function(e){return this.x=e,this},t.setY=function(e){return this.y=e,this},t.setZ=function(e){return this.z=e,this},t.setComponent=function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this},t.getComponent=function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}},t.clone=function(){return new this.constructor(this.x,this.y,this.z)},t.copy=function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this},t.add=function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this)},t.addScalar=function(e){return this.x+=e,this.y+=e,this.z+=e,this},t.addVectors=function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this},t.addScaledVector=function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this},t.sub=function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this)},t.subScalar=function(e){return this.x-=e,this.y-=e,this.z-=e,this},t.subVectors=function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this},t.multiply=function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(e,t)):(this.x*=e.x,this.y*=e.y,this.z*=e.z,this)},t.multiplyScalar=function(e){return this.x*=e,this.y*=e,this.z*=e,this},t.multiplyVectors=function(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this},t.applyEuler=function(e){return e&&e.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(Fe.setFromEuler(e))},t.applyAxisAngle=function(e,t){return this.applyQuaternion(Fe.setFromAxisAngle(e,t))},t.applyMatrix3=function(e){var t=this.x,n=this.y,r=this.z,i=e.elements;return this.x=i[0]*t+i[3]*n+i[6]*r,this.y=i[1]*t+i[4]*n+i[7]*r,this.z=i[2]*t+i[5]*n+i[8]*r,this},t.applyNormalMatrix=function(e){return this.applyMatrix3(e).normalize()},t.applyMatrix4=function(e){var t=this.x,n=this.y,r=this.z,i=e.elements,o=1/(i[3]*t+i[7]*n+i[11]*r+i[15]);return this.x=(i[0]*t+i[4]*n+i[8]*r+i[12])*o,this.y=(i[1]*t+i[5]*n+i[9]*r+i[13])*o,this.z=(i[2]*t+i[6]*n+i[10]*r+i[14])*o,this},t.applyQuaternion=function(e){var t=this.x,n=this.y,r=this.z,i=e.x,o=e.y,a=e.z,s=e.w,c=s*t+o*r-a*n,u=s*n+a*t-i*r,l=s*r+i*n-o*t,d=-i*t-o*n-a*r;return this.x=c*s+d*-i+u*-a-l*-o,this.y=u*s+d*-o+l*-i-c*-a,this.z=l*s+d*-a+c*-o-u*-i,this},t.project=function(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)},t.unproject=function(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)},t.transformDirection=function(e){var t=this.x,n=this.y,r=this.z,i=e.elements;return this.x=i[0]*t+i[4]*n+i[8]*r,this.y=i[1]*t+i[5]*n+i[9]*r,this.z=i[2]*t+i[6]*n+i[10]*r,this.normalize()},t.divide=function(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this},t.divideScalar=function(e){return this.multiplyScalar(1/e)},t.min=function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this},t.max=function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this},t.clamp=function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this},t.clampScalar=function(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this},t.clampLength=function(e,t){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))},t.floor=function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},t.ceil=function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},t.round=function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},t.roundToZero=function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},t.negate=function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},t.dot=function(e){return this.x*e.x+this.y*e.y+this.z*e.z},t.lengthSq=function(){return this.x*this.x+this.y*this.y+this.z*this.z},t.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},t.manhattanLength=function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},t.normalize=function(){return this.divideScalar(this.length()||1)},t.setLength=function(e){return this.normalize().multiplyScalar(e)},t.lerp=function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this},t.lerpVectors=function(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this},t.cross=function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(e,t)):this.crossVectors(this,e)},t.crossVectors=function(e,t){var n=e.x,r=e.y,i=e.z,o=t.x,a=t.y,s=t.z;return this.x=r*s-i*a,this.y=i*o-n*s,this.z=n*a-r*o,this},t.projectOnVector=function(e){var t=e.lengthSq();if(0===t)return this.set(0,0,0);var n=e.dot(this)/t;return this.copy(e).multiplyScalar(n)},t.projectOnPlane=function(e){return Pe.copy(this).projectOnVector(e),this.sub(Pe)},t.reflect=function(e){return this.sub(Pe.copy(e).multiplyScalar(2*this.dot(e)))},t.angleTo=function(e){var t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;var n=this.dot(e)/t;return Math.acos(ye(n,-1,1))},t.distanceTo=function(e){return Math.sqrt(this.distanceToSquared(e))},t.distanceToSquared=function(e){var t=this.x-e.x,n=this.y-e.y,r=this.z-e.z;return t*t+n*n+r*r},t.manhattanDistanceTo=function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)},t.setFromSpherical=function(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)},t.setFromSphericalCoords=function(e,t,n){var r=Math.sin(t)*e;return this.x=r*Math.sin(n),this.y=Math.cos(t)*e,this.z=r*Math.cos(n),this},t.setFromCylindrical=function(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)},t.setFromCylindricalCoords=function(e,t,n){return this.x=e*Math.sin(t),this.y=n,this.z=e*Math.cos(t),this},t.setFromMatrixPosition=function(e){var t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this},t.setFromMatrixScale=function(e){var t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=r,this},t.setFromMatrixColumn=function(e,t){return this.fromArray(e.elements,4*t)},t.setFromMatrix3Column=function(e,t){return this.fromArray(e.elements,3*t)},t.equals=function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z},t.fromArray=function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this.z=e[t+2],this},t.toArray=function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e},t.fromBufferAttribute=function(e,t,n){return void 0!==n&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this},t.random=function(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this},e}();De.prototype.isVector3=!0;var Pe=new De,Fe=new Ue,He=function(){function e(e,t){void 0===e&&(e=new De(1/0,1/0,1/0)),void 0===t&&(t=new De(-1/0,-1/0,-1/0)),this.min=e,this.max=t}var t=e.prototype;return t.set=function(e,t){return this.min.copy(e),this.max.copy(t),this},t.setFromArray=function(e){for(var t=1/0,n=1/0,r=1/0,i=-1/0,o=-1/0,a=-1/0,s=0,c=e.length;s<c;s+=3){var u=e[s],l=e[s+1],d=e[s+2];u<t&&(t=u),l<n&&(n=l),d<r&&(r=d),u>i&&(i=u),l>o&&(o=l),d>a&&(a=d)}return this.min.set(t,n,r),this.max.set(i,o,a),this},t.setFromBufferAttribute=function(e){for(var t=1/0,n=1/0,r=1/0,i=-1/0,o=-1/0,a=-1/0,s=0,c=e.count;s<c;s++){var u=e.getX(s),l=e.getY(s),d=e.getZ(s);u<t&&(t=u),l<n&&(n=l),d<r&&(r=d),u>i&&(i=u),l>o&&(o=l),d>a&&(a=d)}return this.min.set(t,n,r),this.max.set(i,o,a),this},t.setFromPoints=function(e){this.makeEmpty();for(var t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this},t.setFromCenterAndSize=function(e,t){var n=Ve.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this},t.setFromObject=function(e){return this.makeEmpty(),this.expandByObject(e)},t.clone=function(){return(new this.constructor).copy(this)},t.copy=function(e){return this.min.copy(e.min),this.max.copy(e.max),this},t.makeEmpty=function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},t.isEmpty=function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},t.getCenter=function(e){return void 0===e&&(console.warn("THREE.Box3: .getCenter() target is now required"),e=new De),this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)},t.getSize=function(e){return void 0===e&&(console.warn("THREE.Box3: .getSize() target is now required"),e=new De),this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)},t.expandByPoint=function(e){return this.min.min(e),this.max.max(e),this},t.expandByVector=function(e){return this.min.sub(e),this.max.add(e),this},t.expandByScalar=function(e){return this.min.addScalar(-e),this.max.addScalar(e),this},t.expandByObject=function(e){e.updateWorldMatrix(!1,!1);var t=e.geometry;void 0!==t&&(null===t.boundingBox&&t.computeBoundingBox(),Qe.copy(t.boundingBox),Qe.applyMatrix4(e.matrixWorld),this.union(Qe));for(var n=e.children,r=0,i=n.length;r<i;r++)this.expandByObject(n[r]);return this},t.containsPoint=function(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)},t.containsBox=function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z},t.getParameter=function(e,t){return void 0===t&&(console.warn("THREE.Box3: .getParameter() target is now required"),t=new De),t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))},t.intersectsBox=function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)},t.intersectsSphere=function(e){return this.clampPoint(e.center,Ve),Ve.distanceToSquared(e.center)<=e.radius*e.radius},t.intersectsPlane=function(e){var t,n;return e.normal.x>0?(t=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=-e.constant&&n>=-e.constant},t.intersectsTriangle=function(e){if(this.isEmpty())return!1;this.getCenter(Je),Ye.subVectors(this.max,Je),Ge.subVectors(e.a,Je),ze.subVectors(e.b,Je),Ke.subVectors(e.c,Je),qe.subVectors(ze,Ge),We.subVectors(Ke,ze),Xe.subVectors(Ge,Ke);var t=[0,-qe.z,qe.y,0,-We.z,We.y,0,-Xe.z,Xe.y,qe.z,0,-qe.x,We.z,0,-We.x,Xe.z,0,-Xe.x,-qe.y,qe.x,0,-We.y,We.x,0,-Xe.y,Xe.x,0];return!!et(t,Ge,ze,Ke,Ye)&&(!!et(t=[1,0,0,0,1,0,0,0,1],Ge,ze,Ke,Ye)&&(Ze.crossVectors(qe,We),et(t=[Ze.x,Ze.y,Ze.z],Ge,ze,Ke,Ye)))},t.clampPoint=function(e,t){return void 0===t&&(console.warn("THREE.Box3: .clampPoint() target is now required"),t=new De),t.copy(e).clamp(this.min,this.max)},t.distanceToPoint=function(e){return Ve.copy(e).clamp(this.min,this.max).sub(e).length()},t.getBoundingSphere=function(e){return void 0===e&&console.error("THREE.Box3: .getBoundingSphere() target is now required"),this.getCenter(e.center),e.radius=.5*this.getSize(Ve).length(),e},t.intersect=function(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this},t.union=function(e){return this.min.min(e.min),this.max.max(e.max),this},t.applyMatrix4=function(e){return this.isEmpty()||(je[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),je[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),je[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),je[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),je[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),je[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),je[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),je[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(je)),this},t.translate=function(e){return this.min.add(e),this.max.add(e),this},t.equals=function(e){return e.min.equals(this.min)&&e.max.equals(this.max)},e}();He.prototype.isBox3=!0;var je=[new De,new De,new De,new De,new De,new De,new De,new De],Ve=new De,Qe=new He,Ge=new De,ze=new De,Ke=new De,qe=new De,We=new De,Xe=new De,Je=new De,Ye=new De,Ze=new De,$e=new De;function et(e,t,n,r,i){for(var o=0,a=e.length-3;o<=a;o+=3){$e.fromArray(e,o);var s=i.x*Math.abs($e.x)+i.y*Math.abs($e.y)+i.z*Math.abs($e.z),c=t.dot($e),u=n.dot($e),l=r.dot($e);if(Math.max(-Math.max(c,u,l),Math.min(c,u,l))>s)return!1}return!0}var tt=new He,nt=new De,rt=new De,it=new De,ot=function(){function e(e,t){void 0===e&&(e=new De),void 0===t&&(t=-1),this.center=e,this.radius=t}var t=e.prototype;return t.set=function(e,t){return this.center.copy(e),this.radius=t,this},t.setFromPoints=function(e,t){var n=this.center;void 0!==t?n.copy(t):tt.setFromPoints(e).getCenter(n);for(var r=0,i=0,o=e.length;i<o;i++)r=Math.max(r,n.distanceToSquared(e[i]));return this.radius=Math.sqrt(r),this},t.copy=function(e){return this.center.copy(e.center),this.radius=e.radius,this},t.isEmpty=function(){return this.radius<0},t.makeEmpty=function(){return this.center.set(0,0,0),this.radius=-1,this},t.containsPoint=function(e){return e.distanceToSquared(this.center)<=this.radius*this.radius},t.distanceToPoint=function(e){return e.distanceTo(this.center)-this.radius},t.intersectsSphere=function(e){var t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t},t.intersectsBox=function(e){return e.intersectsSphere(this)},t.intersectsPlane=function(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius},t.clampPoint=function(e,t){var n=this.center.distanceToSquared(e);return void 0===t&&(console.warn("THREE.Sphere: .clampPoint() target is now required"),t=new De),t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t},t.getBoundingBox=function(e){return void 0===e&&(console.warn("THREE.Sphere: .getBoundingBox() target is now required"),e=new He),this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)},t.applyMatrix4=function(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this},t.translate=function(e){return this.center.add(e),this},t.expandByPoint=function(e){it.subVectors(e,this.center);var t=it.lengthSq();if(t>this.radius*this.radius){var n=Math.sqrt(t),r=.5*(n-this.radius);this.center.add(it.multiplyScalar(r/n)),this.radius+=r}return this},t.union=function(e){return rt.subVectors(e.center,this.center).normalize().multiplyScalar(e.radius),this.expandByPoint(nt.copy(e.center).add(rt)),this.expandByPoint(nt.copy(e.center).sub(rt)),this},t.equals=function(e){return e.center.equals(this.center)&&e.radius===this.radius},t.clone=function(){return(new this.constructor).copy(this)},e}(),at=new De,st=new De,ct=new De,ut=new De,lt=new De,dt=new De,ht=new De,ft=function(){function e(e,t){void 0===e&&(e=new De),void 0===t&&(t=new De(0,0,-1)),this.origin=e,this.direction=t}var t=e.prototype;return t.set=function(e,t){return this.origin.copy(e),this.direction.copy(t),this},t.copy=function(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this},t.at=function(e,t){return void 0===t&&(console.warn("THREE.Ray: .at() target is now required"),t=new De),t.copy(this.direction).multiplyScalar(e).add(this.origin)},t.lookAt=function(e){return this.direction.copy(e).sub(this.origin).normalize(),this},t.recast=function(e){return this.origin.copy(this.at(e,at)),this},t.closestPointToPoint=function(e,t){void 0===t&&(console.warn("THREE.Ray: .closestPointToPoint() target is now required"),t=new De),t.subVectors(e,this.origin);var n=t.dot(this.direction);return n<0?t.copy(this.origin):t.copy(this.direction).multiplyScalar(n).add(this.origin)},t.distanceToPoint=function(e){return Math.sqrt(this.distanceSqToPoint(e))},t.distanceSqToPoint=function(e){var t=at.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(at.copy(this.direction).multiplyScalar(t).add(this.origin),at.distanceToSquared(e))},t.distanceSqToSegment=function(e,t,n,r){st.copy(e).add(t).multiplyScalar(.5),ct.copy(t).sub(e).normalize(),ut.copy(this.origin).sub(st);var i,o,a,s,c=.5*e.distanceTo(t),u=-this.direction.dot(ct),l=ut.dot(this.direction),d=-ut.dot(ct),h=ut.lengthSq(),f=Math.abs(1-u*u);if(f>0)if(o=u*l-d,s=c*f,(i=u*d-l)>=0)if(o>=-s)if(o<=s){var p=1/f;a=(i*=p)*(i+u*(o*=p)+2*l)+o*(u*i+o+2*d)+h}else o=c,a=-(i=Math.max(0,-(u*o+l)))*i+o*(o+2*d)+h;else o=-c,a=-(i=Math.max(0,-(u*o+l)))*i+o*(o+2*d)+h;else o<=-s?a=-(i=Math.max(0,-(-u*c+l)))*i+(o=i>0?-c:Math.min(Math.max(-c,-d),c))*(o+2*d)+h:o<=s?(i=0,a=(o=Math.min(Math.max(-c,-d),c))*(o+2*d)+h):a=-(i=Math.max(0,-(u*c+l)))*i+(o=i>0?c:Math.min(Math.max(-c,-d),c))*(o+2*d)+h;else o=u>0?-c:c,a=-(i=Math.max(0,-(u*o+l)))*i+o*(o+2*d)+h;return n&&n.copy(this.direction).multiplyScalar(i).add(this.origin),r&&r.copy(ct).multiplyScalar(o).add(st),a},t.intersectSphere=function(e,t){at.subVectors(e.center,this.origin);var n=at.dot(this.direction),r=at.dot(at)-n*n,i=e.radius*e.radius;if(r>i)return null;var o=Math.sqrt(i-r),a=n-o,s=n+o;return a<0&&s<0?null:a<0?this.at(s,t):this.at(a,t)},t.intersectsSphere=function(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius},t.distanceToPlane=function(e){var t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;var n=-(this.origin.dot(e.normal)+e.constant)/t;return n>=0?n:null},t.intersectPlane=function(e,t){var n=this.distanceToPlane(e);return null===n?null:this.at(n,t)},t.intersectsPlane=function(e){var t=e.distanceToPoint(this.origin);return 0===t||e.normal.dot(this.direction)*t<0},t.intersectBox=function(e,t){var n,r,i,o,a,s,c=1/this.direction.x,u=1/this.direction.y,l=1/this.direction.z,d=this.origin;return c>=0?(n=(e.min.x-d.x)*c,r=(e.max.x-d.x)*c):(n=(e.max.x-d.x)*c,r=(e.min.x-d.x)*c),u>=0?(i=(e.min.y-d.y)*u,o=(e.max.y-d.y)*u):(i=(e.max.y-d.y)*u,o=(e.min.y-d.y)*u),n>o||i>r?null:((i>n||n!=n)&&(n=i),(o<r||r!=r)&&(r=o),l>=0?(a=(e.min.z-d.z)*l,s=(e.max.z-d.z)*l):(a=(e.max.z-d.z)*l,s=(e.min.z-d.z)*l),n>s||a>r?null:((a>n||n!=n)&&(n=a),(s<r||r!=r)&&(r=s),r<0?null:this.at(n>=0?n:r,t)))},t.intersectsBox=function(e){return null!==this.intersectBox(e,at)},t.intersectTriangle=function(e,t,n,r,i){lt.subVectors(t,e),dt.subVectors(n,e),ht.crossVectors(lt,dt);var o,a=this.direction.dot(ht);if(a>0){if(r)return null;o=1}else{if(!(a<0))return null;o=-1,a=-a}ut.subVectors(this.origin,e);var s=o*this.direction.dot(dt.crossVectors(ut,dt));if(s<0)return null;var c=o*this.direction.dot(lt.cross(ut));if(c<0)return null;if(s+c>a)return null;var u=-o*ut.dot(ht);return u<0?null:this.at(u/a,i)},t.applyMatrix4=function(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this},t.equals=function(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)},t.clone=function(){return(new this.constructor).copy(this)},e}(),pt=function(){function e(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}var t=e.prototype;return t.set=function(e,t,n,r,i,o,a,s,c,u,l,d,h,f,p,A){var g=this.elements;return g[0]=e,g[4]=t,g[8]=n,g[12]=r,g[1]=i,g[5]=o,g[9]=a,g[13]=s,g[2]=c,g[6]=u,g[10]=l,g[14]=d,g[3]=h,g[7]=f,g[11]=p,g[15]=A,this},t.identity=function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},t.clone=function(){return(new e).fromArray(this.elements)},t.copy=function(e){var t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],this},t.copyPosition=function(e){var t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this},t.setFromMatrix3=function(e){var t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this},t.extractBasis=function(e,t,n){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this},t.makeBasis=function(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this},t.extractRotation=function(e){var t=this.elements,n=e.elements,r=1/At.setFromMatrixColumn(e,0).length(),i=1/At.setFromMatrixColumn(e,1).length(),o=1/At.setFromMatrixColumn(e,2).length();return t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t[3]=0,t[4]=n[4]*i,t[5]=n[5]*i,t[6]=n[6]*i,t[7]=0,t[8]=n[8]*o,t[9]=n[9]*o,t[10]=n[10]*o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this},t.makeRotationFromEuler=function(e){e&&e.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var t=this.elements,n=e.x,r=e.y,i=e.z,o=Math.cos(n),a=Math.sin(n),s=Math.cos(r),c=Math.sin(r),u=Math.cos(i),l=Math.sin(i);if("XYZ"===e.order){var d=o*u,h=o*l,f=a*u,p=a*l;t[0]=s*u,t[4]=-s*l,t[8]=c,t[1]=h+f*c,t[5]=d-p*c,t[9]=-a*s,t[2]=p-d*c,t[6]=f+h*c,t[10]=o*s}else if("YXZ"===e.order){var A=s*u,g=s*l,v=c*u,m=c*l;t[0]=A+m*a,t[4]=v*a-g,t[8]=o*c,t[1]=o*l,t[5]=o*u,t[9]=-a,t[2]=g*a-v,t[6]=m+A*a,t[10]=o*s}else if("ZXY"===e.order){var y=s*u,b=s*l,E=c*u,_=c*l;t[0]=y-_*a,t[4]=-o*l,t[8]=E+b*a,t[1]=b+E*a,t[5]=o*u,t[9]=_-y*a,t[2]=-o*c,t[6]=a,t[10]=o*s}else if("ZYX"===e.order){var w=o*u,S=o*l,T=a*u,R=a*l;t[0]=s*u,t[4]=T*c-S,t[8]=w*c+R,t[1]=s*l,t[5]=R*c+w,t[9]=S*c-T,t[2]=-c,t[6]=a*s,t[10]=o*s}else if("YZX"===e.order){var C=o*s,I=o*c,x=a*s,O=a*c;t[0]=s*u,t[4]=O-C*l,t[8]=x*l+I,t[1]=l,t[5]=o*u,t[9]=-a*u,t[2]=-c*u,t[6]=I*l+x,t[10]=C-O*l}else if("XZY"===e.order){var N=o*s,B=o*c,M=a*s,L=a*c;t[0]=s*u,t[4]=-l,t[8]=c*u,t[1]=N*l+L,t[5]=o*u,t[9]=B*l-M,t[2]=M*l-B,t[6]=a*u,t[10]=L*l+N}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this},t.makeRotationFromQuaternion=function(e){return this.compose(vt,e,mt)},t.lookAt=function(e,t,n){var r=this.elements;return Et.subVectors(e,t),0===Et.lengthSq()&&(Et.z=1),Et.normalize(),yt.crossVectors(n,Et),0===yt.lengthSq()&&(1===Math.abs(n.z)?Et.x+=1e-4:Et.z+=1e-4,Et.normalize(),yt.crossVectors(n,Et)),yt.normalize(),bt.crossVectors(Et,yt),r[0]=yt.x,r[4]=bt.x,r[8]=Et.x,r[1]=yt.y,r[5]=bt.y,r[9]=Et.y,r[2]=yt.z,r[6]=bt.z,r[10]=Et.z,this},t.multiply=function(e,t){return void 0!==t?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(e,t)):this.multiplyMatrices(this,e)},t.premultiply=function(e){return this.multiplyMatrices(e,this)},t.multiplyMatrices=function(e,t){var n=e.elements,r=t.elements,i=this.elements,o=n[0],a=n[4],s=n[8],c=n[12],u=n[1],l=n[5],d=n[9],h=n[13],f=n[2],p=n[6],A=n[10],g=n[14],v=n[3],m=n[7],y=n[11],b=n[15],E=r[0],_=r[4],w=r[8],S=r[12],T=r[1],R=r[5],C=r[9],I=r[13],x=r[2],O=r[6],N=r[10],B=r[14],M=r[3],L=r[7],k=r[11],U=r[15];return i[0]=o*E+a*T+s*x+c*M,i[4]=o*_+a*R+s*O+c*L,i[8]=o*w+a*C+s*N+c*k,i[12]=o*S+a*I+s*B+c*U,i[1]=u*E+l*T+d*x+h*M,i[5]=u*_+l*R+d*O+h*L,i[9]=u*w+l*C+d*N+h*k,i[13]=u*S+l*I+d*B+h*U,i[2]=f*E+p*T+A*x+g*M,i[6]=f*_+p*R+A*O+g*L,i[10]=f*w+p*C+A*N+g*k,i[14]=f*S+p*I+A*B+g*U,i[3]=v*E+m*T+y*x+b*M,i[7]=v*_+m*R+y*O+b*L,i[11]=v*w+m*C+y*N+b*k,i[15]=v*S+m*I+y*B+b*U,this},t.multiplyScalar=function(e){var t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this},t.determinant=function(){var e=this.elements,t=e[0],n=e[4],r=e[8],i=e[12],o=e[1],a=e[5],s=e[9],c=e[13],u=e[2],l=e[6],d=e[10],h=e[14];return e[3]*(+i*s*l-r*c*l-i*a*d+n*c*d+r*a*h-n*s*h)+e[7]*(+t*s*h-t*c*d+i*o*d-r*o*h+r*c*u-i*s*u)+e[11]*(+t*c*l-t*a*h-i*o*l+n*o*h+i*a*u-n*c*u)+e[15]*(-r*a*u-t*s*l+t*a*d+r*o*l-n*o*d+n*s*u)},t.transpose=function(){var e,t=this.elements;return e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this},t.setPosition=function(e,t,n){var r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=n),this},t.invert=function(){var e=this.elements,t=e[0],n=e[1],r=e[2],i=e[3],o=e[4],a=e[5],s=e[6],c=e[7],u=e[8],l=e[9],d=e[10],h=e[11],f=e[12],p=e[13],A=e[14],g=e[15],v=l*A*c-p*d*c+p*s*h-a*A*h-l*s*g+a*d*g,m=f*d*c-u*A*c-f*s*h+o*A*h+u*s*g-o*d*g,y=u*p*c-f*l*c+f*a*h-o*p*h-u*a*g+o*l*g,b=f*l*s-u*p*s-f*a*d+o*p*d+u*a*A-o*l*A,E=t*v+n*m+r*y+i*b;if(0===E)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);var _=1/E;return e[0]=v*_,e[1]=(p*d*i-l*A*i-p*r*h+n*A*h+l*r*g-n*d*g)*_,e[2]=(a*A*i-p*s*i+p*r*c-n*A*c-a*r*g+n*s*g)*_,e[3]=(l*s*i-a*d*i-l*r*c+n*d*c+a*r*h-n*s*h)*_,e[4]=m*_,e[5]=(u*A*i-f*d*i+f*r*h-t*A*h-u*r*g+t*d*g)*_,e[6]=(f*s*i-o*A*i-f*r*c+t*A*c+o*r*g-t*s*g)*_,e[7]=(o*d*i-u*s*i+u*r*c-t*d*c-o*r*h+t*s*h)*_,e[8]=y*_,e[9]=(f*l*i-u*p*i-f*n*h+t*p*h+u*n*g-t*l*g)*_,e[10]=(o*p*i-f*a*i+f*n*c-t*p*c-o*n*g+t*a*g)*_,e[11]=(u*a*i-o*l*i-u*n*c+t*l*c+o*n*h-t*a*h)*_,e[12]=b*_,e[13]=(u*p*r-f*l*r+f*n*d-t*p*d-u*n*A+t*l*A)*_,e[14]=(f*a*r-o*p*r-f*n*s+t*p*s+o*n*A-t*a*A)*_,e[15]=(o*l*r-u*a*r+u*n*s-t*l*s-o*n*d+t*a*d)*_,this},t.scale=function(e){var t=this.elements,n=e.x,r=e.y,i=e.z;return t[0]*=n,t[4]*=r,t[8]*=i,t[1]*=n,t[5]*=r,t[9]*=i,t[2]*=n,t[6]*=r,t[10]*=i,t[3]*=n,t[7]*=r,t[11]*=i,this},t.getMaxScaleOnAxis=function(){var e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],r=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,n,r))},t.makeTranslation=function(e,t,n){return this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this},t.makeRotationX=function(e){var t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this},t.makeRotationY=function(e){var t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this},t.makeRotationZ=function(e){var t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this},t.makeRotationAxis=function(e,t){var n=Math.cos(t),r=Math.sin(t),i=1-n,o=e.x,a=e.y,s=e.z,c=i*o,u=i*a;return this.set(c*o+n,c*a-r*s,c*s+r*a,0,c*a+r*s,u*a+n,u*s-r*o,0,c*s-r*a,u*s+r*o,i*s*s+n,0,0,0,0,1),this},t.makeScale=function(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this},t.makeShear=function(e,t,n){return this.set(1,t,n,0,e,1,n,0,e,t,1,0,0,0,0,1),this},t.compose=function(e,t,n){var r=this.elements,i=t._x,o=t._y,a=t._z,s=t._w,c=i+i,u=o+o,l=a+a,d=i*c,h=i*u,f=i*l,p=o*u,A=o*l,g=a*l,v=s*c,m=s*u,y=s*l,b=n.x,E=n.y,_=n.z;return r[0]=(1-(p+g))*b,r[1]=(h+y)*b,r[2]=(f-m)*b,r[3]=0,r[4]=(h-y)*E,r[5]=(1-(d+g))*E,r[6]=(A+v)*E,r[7]=0,r[8]=(f+m)*_,r[9]=(A-v)*_,r[10]=(1-(d+p))*_,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this},t.decompose=function(e,t,n){var r=this.elements,i=At.set(r[0],r[1],r[2]).length(),o=At.set(r[4],r[5],r[6]).length(),a=At.set(r[8],r[9],r[10]).length();this.determinant()<0&&(i=-i),e.x=r[12],e.y=r[13],e.z=r[14],gt.copy(this);var s=1/i,c=1/o,u=1/a;return gt.elements[0]*=s,gt.elements[1]*=s,gt.elements[2]*=s,gt.elements[4]*=c,gt.elements[5]*=c,gt.elements[6]*=c,gt.elements[8]*=u,gt.elements[9]*=u,gt.elements[10]*=u,t.setFromRotationMatrix(gt),n.x=i,n.y=o,n.z=a,this},t.makePerspective=function(e,t,n,r,i,o){void 0===o&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");var a=this.elements,s=2*i/(t-e),c=2*i/(n-r),u=(t+e)/(t-e),l=(n+r)/(n-r),d=-(o+i)/(o-i),h=-2*o*i/(o-i);return a[0]=s,a[4]=0,a[8]=u,a[12]=0,a[1]=0,a[5]=c,a[9]=l,a[13]=0,a[2]=0,a[6]=0,a[10]=d,a[14]=h,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this},t.makeOrthographic=function(e,t,n,r,i,o){var a=this.elements,s=1/(t-e),c=1/(n-r),u=1/(o-i),l=(t+e)*s,d=(n+r)*c,h=(o+i)*u;return a[0]=2*s,a[4]=0,a[8]=0,a[12]=-l,a[1]=0,a[5]=2*c,a[9]=0,a[13]=-d,a[2]=0,a[6]=0,a[10]=-2*u,a[14]=-h,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this},t.equals=function(e){for(var t=this.elements,n=e.elements,r=0;r<16;r++)if(t[r]!==n[r])return!1;return!0},t.fromArray=function(e,t){void 0===t&&(t=0);for(var n=0;n<16;n++)this.elements[n]=e[n+t];return this},t.toArray=function(e,t){void 0===e&&(e=[]),void 0===t&&(t=0);var n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e},e}();pt.prototype.isMatrix4=!0;var At=new De,gt=new pt,vt=new De(0,0,0),mt=new De(1,1,1),yt=new De,bt=new De,Et=new De,_t=new pt,wt=new Ue,St=function(){function e(t,n,r,i){void 0===t&&(t=0),void 0===n&&(n=0),void 0===r&&(r=0),void 0===i&&(i=e.DefaultOrder),this._x=t,this._y=n,this._z=r,this._order=i}var t=e.prototype;return t.set=function(e,t,n,r){return this._x=e,this._y=t,this._z=n,this._order=r||this._order,this._onChangeCallback(),this},t.clone=function(){return new this.constructor(this._x,this._y,this._z,this._order)},t.copy=function(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this},t.setFromRotationMatrix=function(e,t,n){var r=e.elements,i=r[0],o=r[4],a=r[8],s=r[1],c=r[5],u=r[9],l=r[2],d=r[6],h=r[10];switch(t=t||this._order){case"XYZ":this._y=Math.asin(ye(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-u,h),this._z=Math.atan2(-o,i)):(this._x=Math.atan2(d,c),this._z=0);break;case"YXZ":this._x=Math.asin(-ye(u,-1,1)),Math.abs(u)<.9999999?(this._y=Math.atan2(a,h),this._z=Math.atan2(s,c)):(this._y=Math.atan2(-l,i),this._z=0);break;case"ZXY":this._x=Math.asin(ye(d,-1,1)),Math.abs(d)<.9999999?(this._y=Math.atan2(-l,h),this._z=Math.atan2(-o,c)):(this._y=0,this._z=Math.atan2(s,i));break;case"ZYX":this._y=Math.asin(-ye(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(d,h),this._z=Math.atan2(s,i)):(this._x=0,this._z=Math.atan2(-o,c));break;case"YZX":this._z=Math.asin(ye(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(-u,c),this._y=Math.atan2(-l,i)):(this._x=0,this._y=Math.atan2(a,h));break;case"XZY":this._z=Math.asin(-ye(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(d,c),this._y=Math.atan2(a,i)):(this._x=Math.atan2(-u,h),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,!1!==n&&this._onChangeCallback(),this},t.setFromQuaternion=function(e,t,n){return _t.makeRotationFromQuaternion(e),this.setFromRotationMatrix(_t,t,n)},t.setFromVector3=function(e,t){return this.set(e.x,e.y,e.z,t||this._order)},t.reorder=function(e){return wt.setFromEuler(this),this.setFromQuaternion(wt,e)},t.equals=function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order},t.fromArray=function(e){return this._x=e[0],this._y=e[1],this._z=e[2],void 0!==e[3]&&(this._order=e[3]),this._onChangeCallback(),this},t.toArray=function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e},t.toVector3=function(e){return e?e.set(this._x,this._y,this._z):new De(this._x,this._y,this._z)},t._onChange=function(e){return this._onChangeCallback=e,this},t._onChangeCallback=function(){},r(e,[{key:"x",get:function(){return this._x},set:function(e){this._x=e,this._onChangeCallback()}},{key:"y",get:function(){return this._y},set:function(e){this._y=e,this._onChangeCallback()}},{key:"z",get:function(){return this._z},set:function(e){this._z=e,this._onChangeCallback()}},{key:"order",get:function(){return this._order},set:function(e){this._order=e,this._onChangeCallback()}}]),e}();St.prototype.isEuler=!0,St.DefaultOrder="XYZ",St.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"];var Tt=function(){function e(){this.mask=1}var t=e.prototype;return t.set=function(e){this.mask=1<<e|0},t.enable=function(e){this.mask|=1<<e|0},t.enableAll=function(){this.mask=-1},t.toggle=function(e){this.mask^=1<<e|0},t.disable=function(e){this.mask&=~(1<<e|0)},t.disableAll=function(){this.mask=0},t.test=function(e){return 0!=(this.mask&e.mask)},e}(),Rt=0,Ct=new De,It=new Ue,xt=new pt,Ot=new De,Nt=new De,Bt=new De,Mt=new Ue,Lt=new De(1,0,0),kt=new De(0,1,0),Ut=new De(0,0,1),Dt={type:"added"},Pt={type:"removed"},Ft=function(e){function t(){var n;n=e.call(this)||this,Object.defineProperty(o(n),"id",{value:Rt++}),n.uuid=me(),n.name="",n.type="Object3D",n.parent=null,n.children=[],n.up=t.DefaultUp.clone();var r=new De,i=new St,a=new Ue,s=new De(1,1,1);return i._onChange((function(){a.setFromEuler(i,!1)})),a._onChange((function(){i.setFromQuaternion(a,void 0,!1)})),Object.defineProperties(o(n),{position:{configurable:!0,enumerable:!0,value:r},rotation:{configurable:!0,enumerable:!0,value:i},quaternion:{configurable:!0,enumerable:!0,value:a},scale:{configurable:!0,enumerable:!0,value:s},modelViewMatrix:{value:new pt},normalMatrix:{value:new Ie}}),n.matrix=new pt,n.matrixWorld=new pt,n.matrixAutoUpdate=t.DefaultMatrixAutoUpdate,n.matrixWorldNeedsUpdate=!1,n.layers=new Tt,n.visible=!0,n.castShadow=!1,n.receiveShadow=!1,n.frustumCulled=!0,n.renderOrder=0,n.animations=[],n.userData={},n}i(t,e);var n=t.prototype;return n.onBeforeRender=function(){},n.onAfterRender=function(){},n.applyMatrix4=function(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)},n.applyQuaternion=function(e){return this.quaternion.premultiply(e),this},n.setRotationFromAxisAngle=function(e,t){this.quaternion.setFromAxisAngle(e,t)},n.setRotationFromEuler=function(e){this.quaternion.setFromEuler(e,!0)},n.setRotationFromMatrix=function(e){this.quaternion.setFromRotationMatrix(e)},n.setRotationFromQuaternion=function(e){this.quaternion.copy(e)},n.rotateOnAxis=function(e,t){return It.setFromAxisAngle(e,t),this.quaternion.multiply(It),this},n.rotateOnWorldAxis=function(e,t){return It.setFromAxisAngle(e,t),this.quaternion.premultiply(It),this},n.rotateX=function(e){return this.rotateOnAxis(Lt,e)},n.rotateY=function(e){return this.rotateOnAxis(kt,e)},n.rotateZ=function(e){return this.rotateOnAxis(Ut,e)},n.translateOnAxis=function(e,t){return Ct.copy(e).applyQuaternion(this.quaternion),this.position.add(Ct.multiplyScalar(t)),this},n.translateX=function(e){return this.translateOnAxis(Lt,e)},n.translateY=function(e){return this.translateOnAxis(kt,e)},n.translateZ=function(e){return this.translateOnAxis(Ut,e)},n.localToWorld=function(e){return e.applyMatrix4(this.matrixWorld)},n.worldToLocal=function(e){return e.applyMatrix4(xt.copy(this.matrixWorld).invert())},n.lookAt=function(e,t,n){e.isVector3?Ot.copy(e):Ot.set(e,t,n);var r=this.parent;this.updateWorldMatrix(!0,!1),Nt.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?xt.lookAt(Nt,Ot,this.up):xt.lookAt(Ot,Nt,this.up),this.quaternion.setFromRotationMatrix(xt),r&&(xt.extractRotation(r.matrixWorld),It.setFromRotationMatrix(xt),this.quaternion.premultiply(It.invert()))},n.add=function(e){if(arguments.length>1){for(var t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(null!==e.parent&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(Dt)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)},n.remove=function(e){if(arguments.length>1){for(var t=0;t<arguments.length;t++)this.remove(arguments[t]);return this}var n=this.children.indexOf(e);return-1!==n&&(e.parent=null,this.children.splice(n,1),e.dispatchEvent(Pt)),this},n.clear=function(){for(var e=0;e<this.children.length;e++){var t=this.children[e];t.parent=null,t.dispatchEvent(Pt)}return this.children.length=0,this},n.attach=function(e){return this.updateWorldMatrix(!0,!1),xt.copy(this.matrixWorld).invert(),null!==e.parent&&(e.parent.updateWorldMatrix(!0,!1),xt.multiply(e.parent.matrixWorld)),e.applyMatrix4(xt),this.add(e),e.updateWorldMatrix(!1,!0),this},n.getObjectById=function(e){return this.getObjectByProperty("id",e)},n.getObjectByName=function(e){return this.getObjectByProperty("name",e)},n.getObjectByProperty=function(e,t){if(this[e]===t)return this;for(var n=0,r=this.children.length;n<r;n++){var i=this.children[n].getObjectByProperty(e,t);if(void 0!==i)return i}},n.getWorldPosition=function(e){return void 0===e&&(console.warn("THREE.Object3D: .getWorldPosition() target is now required"),e=new De),this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)},n.getWorldQuaternion=function(e){return void 0===e&&(console.warn("THREE.Object3D: .getWorldQuaternion() target is now required"),e=new Ue),this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Nt,e,Bt),e},n.getWorldScale=function(e){return void 0===e&&(console.warn("THREE.Object3D: .getWorldScale() target is now required"),e=new De),this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Nt,Mt,e),e},n.getWorldDirection=function(e){void 0===e&&(console.warn("THREE.Object3D: .getWorldDirection() target is now required"),e=new De),this.updateWorldMatrix(!0,!1);var t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()},n.raycast=function(){},n.traverse=function(e){e(this);for(var t=this.children,n=0,r=t.length;n<r;n++)t[n].traverse(e)},n.traverseVisible=function(e){if(!1!==this.visible){e(this);for(var t=this.children,n=0,r=t.length;n<r;n++)t[n].traverseVisible(e)}},n.traverseAncestors=function(e){var t=this.parent;null!==t&&(e(t),t.traverseAncestors(e))},n.updateMatrix=function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},n.updateMatrixWorld=function(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);for(var t=this.children,n=0,r=t.length;n<r;n++)t[n].updateMatrixWorld(e)},n.updateWorldMatrix=function(e,t){var n=this.parent;if(!0===e&&null!==n&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===t)for(var r=this.children,i=0,o=r.length;i<o;i++)r[i].updateWorldMatrix(!1,!0)},n.toJSON=function(e){var t=void 0===e||"string"==typeof e,n={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{}},n.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});var r={};function i(t,n){return void 0===t[n.uuid]&&(t[n.uuid]=n.toJSON(e)),n.uuid}if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),!0===this.castShadow&&(r.castShadow=!0),!0===this.receiveShadow&&(r.receiveShadow=!0),!1===this.visible&&(r.visible=!1),!1===this.frustumCulled&&(r.frustumCulled=!1),0!==this.renderOrder&&(r.renderOrder=this.renderOrder),"{}"!==JSON.stringify(this.userData)&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(r.instanceColor=this.instanceColor.toJSON())),this.isMesh||this.isLine||this.isPoints){r.geometry=i(e.geometries,this.geometry);var o=this.geometry.parameters;if(void 0!==o&&void 0!==o.shapes){var a=o.shapes;if(Array.isArray(a))for(var s=0,c=a.length;s<c;s++){var u=a[s];i(e.shapes,u)}else i(e.shapes,a)}}if(this.isSkinnedMesh&&(r.bindMode=this.bindMode,r.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(i(e.skeletons,this.skeleton),r.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){for(var l=[],d=0,h=this.material.length;d<h;d++)l.push(i(e.materials,this.material[d]));r.material=l}else r.material=i(e.materials,this.material);if(this.children.length>0){r.children=[];for(var f=0;f<this.children.length;f++)r.children.push(this.children[f].toJSON(e).object)}if(this.animations.length>0){r.animations=[];for(var p=0;p<this.animations.length;p++){var A=this.animations[p];r.animations.push(i(e.animations,A))}}if(t){var g=w(e.geometries),v=w(e.materials),m=w(e.textures),y=w(e.images),b=w(e.shapes),E=w(e.skeletons),_=w(e.animations);g.length>0&&(n.geometries=g),v.length>0&&(n.materials=v),m.length>0&&(n.textures=m),y.length>0&&(n.images=y),b.length>0&&(n.shapes=b),E.length>0&&(n.skeletons=E),_.length>0&&(n.animations=_)}return n.object=r,n;function w(e){var t=[];for(var n in e){var r=e[n];delete r.metadata,t.push(r)}return t}},n.clone=function(e){return(new this.constructor).copy(this,e)},n.copy=function(e,t){if(void 0===t&&(t=!0),this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),!0===t)for(var n=0;n<e.children.length;n++){var r=e.children[n];this.add(r.clone())}return this},t}(he);Ft.DefaultUp=new De(0,1,0),Ft.DefaultMatrixAutoUpdate=!0,Ft.prototype.isObject3D=!0;var Ht=new De,jt=new De,Vt=new Ie,Qt=function(){function e(e,t){void 0===e&&(e=new De(1,0,0)),void 0===t&&(t=0),this.normal=e,this.constant=t}var t=e.prototype;return t.set=function(e,t){return this.normal.copy(e),this.constant=t,this},t.setComponents=function(e,t,n,r){return this.normal.set(e,t,n),this.constant=r,this},t.setFromNormalAndCoplanarPoint=function(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this},t.setFromCoplanarPoints=function(e,t,n){var r=Ht.subVectors(n,t).cross(jt.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this},t.copy=function(e){return this.normal.copy(e.normal),this.constant=e.constant,this},t.normalize=function(){var e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this},t.negate=function(){return this.constant*=-1,this.normal.negate(),this},t.distanceToPoint=function(e){return this.normal.dot(e)+this.constant},t.distanceToSphere=function(e){return this.distanceToPoint(e.center)-e.radius},t.projectPoint=function(e,t){return void 0===t&&(console.warn("THREE.Plane: .projectPoint() target is now required"),t=new De),t.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)},t.intersectLine=function(e,t){void 0===t&&(console.warn("THREE.Plane: .intersectLine() target is now required"),t=new De);var n=e.delta(Ht),r=this.normal.dot(n);if(0===r)return 0===this.distanceToPoint(e.start)?t.copy(e.start):null;var i=-(e.start.dot(this.normal)+this.constant)/r;return i<0||i>1?null:t.copy(n).multiplyScalar(i).add(e.start)},t.intersectsLine=function(e){var t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&n>0||n<0&&t>0},t.intersectsBox=function(e){return e.intersectsPlane(this)},t.intersectsSphere=function(e){return e.intersectsPlane(this)},t.coplanarPoint=function(e){return void 0===e&&(console.warn("THREE.Plane: .coplanarPoint() target is now required"),e=new De),e.copy(this.normal).multiplyScalar(-this.constant)},t.applyMatrix4=function(e,t){var n=t||Vt.getNormalMatrix(e),r=this.coplanarPoint(Ht).applyMatrix4(e),i=this.normal.applyMatrix3(n).normalize();return this.constant=-r.dot(i),this},t.translate=function(e){return this.constant-=e.dot(this.normal),this},t.equals=function(e){return e.normal.equals(this.normal)&&e.constant===this.constant},t.clone=function(){return(new this.constructor).copy(this)},e}();Qt.prototype.isPlane=!0;var Gt=new De,zt=new De,Kt=new De,qt=new De,Wt=new De,Xt=new De,Jt=new De,Yt=new De,Zt=new De,$t=new De,en=function(){function e(e,t,n){void 0===e&&(e=new De),void 0===t&&(t=new De),void 0===n&&(n=new De),this.a=e,this.b=t,this.c=n}e.getNormal=function(e,t,n,r){void 0===r&&(console.warn("THREE.Triangle: .getNormal() target is now required"),r=new De),r.subVectors(n,t),Gt.subVectors(e,t),r.cross(Gt);var i=r.lengthSq();return i>0?r.multiplyScalar(1/Math.sqrt(i)):r.set(0,0,0)},e.getBarycoord=function(e,t,n,r,i){Gt.subVectors(r,t),zt.subVectors(n,t),Kt.subVectors(e,t);var o=Gt.dot(Gt),a=Gt.dot(zt),s=Gt.dot(Kt),c=zt.dot(zt),u=zt.dot(Kt),l=o*c-a*a;if(void 0===i&&(console.warn("THREE.Triangle: .getBarycoord() target is now required"),i=new De),0===l)return i.set(-2,-1,-1);var d=1/l,h=(c*s-a*u)*d,f=(o*u-a*s)*d;return i.set(1-h-f,f,h)},e.containsPoint=function(e,t,n,r){return this.getBarycoord(e,t,n,r,qt),qt.x>=0&&qt.y>=0&&qt.x+qt.y<=1},e.getUV=function(e,t,n,r,i,o,a,s){return this.getBarycoord(e,t,n,r,qt),s.set(0,0),s.addScaledVector(i,qt.x),s.addScaledVector(o,qt.y),s.addScaledVector(a,qt.z),s},e.isFrontFacing=function(e,t,n,r){return Gt.subVectors(n,t),zt.subVectors(e,t),Gt.cross(zt).dot(r)<0};var t=e.prototype;return t.set=function(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this},t.setFromPointsAndIndices=function(e,t,n,r){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[r]),this},t.clone=function(){return(new this.constructor).copy(this)},t.copy=function(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this},t.getArea=function(){return Gt.subVectors(this.c,this.b),zt.subVectors(this.a,this.b),.5*Gt.cross(zt).length()},t.getMidpoint=function(e){return void 0===e&&(console.warn("THREE.Triangle: .getMidpoint() target is now required"),e=new De),e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},t.getNormal=function(t){return e.getNormal(this.a,this.b,this.c,t)},t.getPlane=function(e){return void 0===e&&(console.warn("THREE.Triangle: .getPlane() target is now required"),e=new Qt),e.setFromCoplanarPoints(this.a,this.b,this.c)},t.getBarycoord=function(t,n){return e.getBarycoord(t,this.a,this.b,this.c,n)},t.getUV=function(t,n,r,i,o){return e.getUV(t,this.a,this.b,this.c,n,r,i,o)},t.containsPoint=function(t){return e.containsPoint(t,this.a,this.b,this.c)},t.isFrontFacing=function(t){return e.isFrontFacing(this.a,this.b,this.c,t)},t.intersectsBox=function(e){return e.intersectsTriangle(this)},t.closestPointToPoint=function(e,t){void 0===t&&(console.warn("THREE.Triangle: .closestPointToPoint() target is now required"),t=new De);var n,r,i=this.a,o=this.b,a=this.c;Wt.subVectors(o,i),Xt.subVectors(a,i),Yt.subVectors(e,i);var s=Wt.dot(Yt),c=Xt.dot(Yt);if(s<=0&&c<=0)return t.copy(i);Zt.subVectors(e,o);var u=Wt.dot(Zt),l=Xt.dot(Zt);if(u>=0&&l<=u)return t.copy(o);var d=s*l-u*c;if(d<=0&&s>=0&&u<=0)return n=s/(s-u),t.copy(i).addScaledVector(Wt,n);$t.subVectors(e,a);var h=Wt.dot($t),f=Xt.dot($t);if(f>=0&&h<=f)return t.copy(a);var p=h*c-s*f;if(p<=0&&c>=0&&f<=0)return r=c/(c-f),t.copy(i).addScaledVector(Xt,r);var A=u*f-h*l;if(A<=0&&l-u>=0&&h-f>=0)return Jt.subVectors(a,o),r=(l-u)/(l-u+(h-f)),t.copy(o).addScaledVector(Jt,r);var g=1/(A+p+d);return n=p*g,r=d*g,t.copy(i).addScaledVector(Wt,n).addScaledVector(Xt,r)},t.equals=function(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)},e}(),tn=0;function nn(){Object.defineProperty(this,"id",{value:tn++}),this.uuid=me(),this.name="",this.type="Material",this.fog=!0,this.blending=1,this.side=0,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=l,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=3,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=ce,this.stencilZFail=ce,this.stencilZPass=ce,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaTest=0,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0}nn.prototype=Object.assign(Object.create(he.prototype),{constructor:nn,isMaterial:!0,onBuild:function(){},onBeforeCompile:function(){},customProgramCacheKey:function(){return this.onBeforeCompile.toString()},setValues:function(e){if(void 0!==e)for(var t in e){var n=e[t];if(void 0!==n)if("shading"!==t){var r=this[t];void 0!==r?r&&r.isColor?r.set(n):r&&r.isVector3&&n&&n.isVector3?r.copy(n):this[t]=n:console.warn("THREE."+this.type+": '"+t+"' is not a property of this material.")}else console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===n;else console.warn("THREE.Material: '"+t+"' parameter is undefined.")}},toJSON:function(e){var t=void 0===e||"string"==typeof e;t&&(e={textures:{},images:{}});var n={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function r(e){var t=[];for(var n in e){var r=e[n];delete r.metadata,t.push(r)}return t}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),void 0!==this.roughness&&(n.roughness=this.roughness),void 0!==this.metalness&&(n.metalness=this.metalness),this.sheen&&this.sheen.isColor&&(n.sheen=this.sheen.getHex()),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),void 0!==this.shininess&&(n.shininess=this.shininess),void 0!==this.clearcoat&&(n.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,void 0!==this.combine&&(n.combine=this.combine)),void 0!==this.envMapIntensity&&(n.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(n.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.size&&(n.size=this.size),null!==this.shadowSide&&(n.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(n.sizeAttenuation=this.sizeAttenuation),1!==this.blending&&(n.blending=this.blending),0!==this.side&&(n.side=this.side),this.vertexColors&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),!0===this.transparent&&(n.transparent=this.transparent),n.depthFunc=this.depthFunc,n.depthTest=this.depthTest,n.depthWrite=this.depthWrite,n.colorWrite=this.colorWrite,n.stencilWrite=this.stencilWrite,n.stencilWriteMask=this.stencilWriteMask,n.stencilFunc=this.stencilFunc,n.stencilRef=this.stencilRef,n.stencilFuncMask=this.stencilFuncMask,n.stencilFail=this.stencilFail,n.stencilZFail=this.stencilZFail,n.stencilZPass=this.stencilZPass,this.rotation&&0!==this.rotation&&(n.rotation=this.rotation),!0===this.polygonOffset&&(n.polygonOffset=!0),0!==this.polygonOffsetFactor&&(n.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(n.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth&&1!==this.linewidth&&(n.linewidth=this.linewidth),void 0!==this.dashSize&&(n.dashSize=this.dashSize),void 0!==this.gapSize&&(n.gapSize=this.gapSize),void 0!==this.scale&&(n.scale=this.scale),!0===this.dithering&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),!0===this.alphaToCoverage&&(n.alphaToCoverage=this.alphaToCoverage),!0===this.premultipliedAlpha&&(n.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(n.wireframe=this.wireframe),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(n.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(n.wireframeLinejoin=this.wireframeLinejoin),!0===this.morphTargets&&(n.morphTargets=!0),!0===this.morphNormals&&(n.morphNormals=!0),!0===this.skinning&&(n.skinning=!0),!0===this.flatShading&&(n.flatShading=this.flatShading),!1===this.visible&&(n.visible=!1),!1===this.toneMapped&&(n.toneMapped=!1),"{}"!==JSON.stringify(this.userData)&&(n.userData=this.userData),t){var i=r(e.textures),o=r(e.images);i.length>0&&(n.textures=i),o.length>0&&(n.images=o)}return n},clone:function(){return(new this.constructor).copy(this)},copy:function(e){this.name=e.name,this.fog=e.fog,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;var t=e.clippingPlanes,n=null;if(null!==t){var r=t.length;n=new Array(r);for(var i=0;i!==r;++i)n[i]=t[i].clone()}return this.clippingPlanes=n,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Object.defineProperty(nn.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}});var rn={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},on={h:0,s:0,l:0},an={h:0,s:0,l:0};function sn(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+6*(t-e)*(2/3-n):e}function cn(e){return e<.04045?.0773993808*e:Math.pow(.9478672986*e+.0521327014,2.4)}function un(e){return e<.0031308?12.92*e:1.055*Math.pow(e,.41666)-.055}var ln=function(){function e(e,t,n){return void 0===t&&void 0===n?this.set(e):this.setRGB(e,t,n)}var t=e.prototype;return t.set=function(e){return e&&e.isColor?this.copy(e):"number"==typeof e?this.setHex(e):"string"==typeof e&&this.setStyle(e),this},t.setScalar=function(e){return this.r=e,this.g=e,this.b=e,this},t.setHex=function(e){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,this},t.setRGB=function(e,t,n){return this.r=e,this.g=t,this.b=n,this},t.setHSL=function(e,t,n){if(e=be(e,1),t=ye(t,0,1),n=ye(n,0,1),0===t)this.r=this.g=this.b=n;else{var r=n<=.5?n*(1+t):n+t-n*t,i=2*n-r;this.r=sn(i,r,e+1/3),this.g=sn(i,r,e),this.b=sn(i,r,e-1/3)}return this},t.setStyle=function(e){function t(t){void 0!==t&&parseFloat(t)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}var n;if(n=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(e)){var r,i=n[1],o=n[2];switch(i){case"rgb":case"rgba":if(r=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return this.r=Math.min(255,parseInt(r[1],10))/255,this.g=Math.min(255,parseInt(r[2],10))/255,this.b=Math.min(255,parseInt(r[3],10))/255,t(r[4]),this;if(r=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return this.r=Math.min(100,parseInt(r[1],10))/100,this.g=Math.min(100,parseInt(r[2],10))/100,this.b=Math.min(100,parseInt(r[3],10))/100,t(r[4]),this;break;case"hsl":case"hsla":if(r=/^\s*(\d*\.?\d+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o)){var a=parseFloat(r[1])/360,s=parseInt(r[2],10)/100,c=parseInt(r[3],10)/100;return t(r[4]),this.setHSL(a,s,c)}}}else if(n=/^\#([A-Fa-f\d]+)$/.exec(e)){var u=n[1],l=u.length;if(3===l)return this.r=parseInt(u.charAt(0)+u.charAt(0),16)/255,this.g=parseInt(u.charAt(1)+u.charAt(1),16)/255,this.b=parseInt(u.charAt(2)+u.charAt(2),16)/255,this;if(6===l)return this.r=parseInt(u.charAt(0)+u.charAt(1),16)/255,this.g=parseInt(u.charAt(2)+u.charAt(3),16)/255,this.b=parseInt(u.charAt(4)+u.charAt(5),16)/255,this}return e&&e.length>0?this.setColorName(e):this},t.setColorName=function(e){var t=rn[e.toLowerCase()];return void 0!==t?this.setHex(t):console.warn("THREE.Color: Unknown color "+e),this},t.clone=function(){return new this.constructor(this.r,this.g,this.b)},t.copy=function(e){return this.r=e.r,this.g=e.g,this.b=e.b,this},t.copyGammaToLinear=function(e,t){return void 0===t&&(t=2),this.r=Math.pow(e.r,t),this.g=Math.pow(e.g,t),this.b=Math.pow(e.b,t),this},t.copyLinearToGamma=function(e,t){void 0===t&&(t=2);var n=t>0?1/t:1;return this.r=Math.pow(e.r,n),this.g=Math.pow(e.g,n),this.b=Math.pow(e.b,n),this},t.convertGammaToLinear=function(e){return this.copyGammaToLinear(this,e),this},t.convertLinearToGamma=function(e){return this.copyLinearToGamma(this,e),this},t.copySRGBToLinear=function(e){return this.r=cn(e.r),this.g=cn(e.g),this.b=cn(e.b),this},t.copyLinearToSRGB=function(e){return this.r=un(e.r),this.g=un(e.g),this.b=un(e.b),this},t.convertSRGBToLinear=function(){return this.copySRGBToLinear(this),this},t.convertLinearToSRGB=function(){return this.copyLinearToSRGB(this),this},t.getHex=function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},t.getHexString=function(){return("000000"+this.getHex().toString(16)).slice(-6)},t.getHSL=function(e){void 0===e&&(console.warn("THREE.Color: .getHSL() target is now required"),e={h:0,s:0,l:0});var t,n,r=this.r,i=this.g,o=this.b,a=Math.max(r,i,o),s=Math.min(r,i,o),c=(s+a)/2;if(s===a)t=0,n=0;else{var u=a-s;switch(n=c<=.5?u/(a+s):u/(2-a-s),a){case r:t=(i-o)/u+(i<o?6:0);break;case i:t=(o-r)/u+2;break;case o:t=(r-i)/u+4}t/=6}return e.h=t,e.s=n,e.l=c,e},t.getStyle=function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},t.offsetHSL=function(e,t,n){return this.getHSL(on),on.h+=e,on.s+=t,on.l+=n,this.setHSL(on.h,on.s,on.l),this},t.add=function(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this},t.addColors=function(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this},t.addScalar=function(e){return this.r+=e,this.g+=e,this.b+=e,this},t.sub=function(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this},t.multiply=function(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this},t.multiplyScalar=function(e){return this.r*=e,this.g*=e,this.b*=e,this},t.lerp=function(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this},t.lerpColors=function(e,t,n){return this.r=e.r+(t.r-e.r)*n,this.g=e.g+(t.g-e.g)*n,this.b=e.b+(t.b-e.b)*n,this},t.lerpHSL=function(e,t){this.getHSL(on),e.getHSL(an);var n=Ee(on.h,an.h,t),r=Ee(on.s,an.s,t),i=Ee(on.l,an.l,t);return this.setHSL(n,r,i),this},t.equals=function(e){return e.r===this.r&&e.g===this.g&&e.b===this.b},t.fromArray=function(e,t){return void 0===t&&(t=0),this.r=e[t],this.g=e[t+1],this.b=e[t+2],this},t.toArray=function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e},t.fromBufferAttribute=function(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),!0===e.normalized&&(this.r/=255,this.g/=255,this.b/=255),this},t.toJSON=function(){return this.getHex()},e}();ln.NAMES=rn,ln.prototype.isColor=!0,ln.prototype.r=1,ln.prototype.g=1,ln.prototype.b=1;var dn=function(e){function t(t){var n;return(n=e.call(this)||this).type="MeshBasicMaterial",n.color=new ln(16777215),n.map=null,n.lightMap=null,n.lightMapIntensity=1,n.aoMap=null,n.aoMapIntensity=1,n.specularMap=null,n.alphaMap=null,n.envMap=null,n.combine=0,n.reflectivity=1,n.refractionRatio=.98,n.wireframe=!1,n.wireframeLinewidth=1,n.wireframeLinecap="round",n.wireframeLinejoin="round",n.skinning=!1,n.morphTargets=!1,n.setValues(t),n}return i(t,e),t.prototype.copy=function(t){return e.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this},t}(nn);dn.prototype.isMeshBasicMaterial=!0;var hn=new De,fn=new Re,pn=function(){function e(e,t,n){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=!0===n,this.usage=ue,this.updateRange={offset:0,count:-1},this.version=0,this.onUploadCallback=function(){}}var t=e.prototype;return t.setUsage=function(e){return this.usage=e,this},t.copy=function(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this},t.copyAt=function(e,t,n){e*=this.itemSize,n*=t.itemSize;for(var r=0,i=this.itemSize;r<i;r++)this.array[e+r]=t.array[n+r];return this},t.copyArray=function(e){return this.array.set(e),this},t.copyColorsArray=function(e){for(var t=this.array,n=0,r=0,i=e.length;r<i;r++){var o=e[r];void 0===o&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",r),o=new ln),t[n++]=o.r,t[n++]=o.g,t[n++]=o.b}return this},t.copyVector2sArray=function(e){for(var t=this.array,n=0,r=0,i=e.length;r<i;r++){var o=e[r];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",r),o=new Re),t[n++]=o.x,t[n++]=o.y}return this},t.copyVector3sArray=function(e){for(var t=this.array,n=0,r=0,i=e.length;r<i;r++){var o=e[r];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",r),o=new De),t[n++]=o.x,t[n++]=o.y,t[n++]=o.z}return this},t.copyVector4sArray=function(e){for(var t=this.array,n=0,r=0,i=e.length;r<i;r++){var o=e[r];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",r),o=new Me),t[n++]=o.x,t[n++]=o.y,t[n++]=o.z,t[n++]=o.w}return this},t.applyMatrix3=function(e){if(2===this.itemSize)for(var t=0,n=this.count;t<n;t++)fn.fromBufferAttribute(this,t),fn.applyMatrix3(e),this.setXY(t,fn.x,fn.y);else if(3===this.itemSize)for(var r=0,i=this.count;r<i;r++)hn.fromBufferAttribute(this,r),hn.applyMatrix3(e),this.setXYZ(r,hn.x,hn.y,hn.z);return this},t.applyMatrix4=function(e){for(var t=0,n=this.count;t<n;t++)hn.x=this.getX(t),hn.y=this.getY(t),hn.z=this.getZ(t),hn.applyMatrix4(e),this.setXYZ(t,hn.x,hn.y,hn.z);return this},t.applyNormalMatrix=function(e){for(var t=0,n=this.count;t<n;t++)hn.x=this.getX(t),hn.y=this.getY(t),hn.z=this.getZ(t),hn.applyNormalMatrix(e),this.setXYZ(t,hn.x,hn.y,hn.z);return this},t.transformDirection=function(e){for(var t=0,n=this.count;t<n;t++)hn.x=this.getX(t),hn.y=this.getY(t),hn.z=this.getZ(t),hn.transformDirection(e),this.setXYZ(t,hn.x,hn.y,hn.z);return this},t.set=function(e,t){return void 0===t&&(t=0),this.array.set(e,t),this},t.getX=function(e){return this.array[e*this.itemSize]},t.setX=function(e,t){return this.array[e*this.itemSize]=t,this},t.getY=function(e){return this.array[e*this.itemSize+1]},t.setY=function(e,t){return this.array[e*this.itemSize+1]=t,this},t.getZ=function(e){return this.array[e*this.itemSize+2]},t.setZ=function(e,t){return this.array[e*this.itemSize+2]=t,this},t.getW=function(e){return this.array[e*this.itemSize+3]},t.setW=function(e,t){return this.array[e*this.itemSize+3]=t,this},t.setXY=function(e,t,n){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this},t.setXYZ=function(e,t,n,r){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this},t.setXYZW=function(e,t,n,r,i){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this.array[e+3]=i,this},t.onUpload=function(e){return this.onUploadCallback=e,this},t.clone=function(){return new this.constructor(this.array,this.itemSize).copy(this)},t.toJSON=function(){var e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized};return""!==this.name&&(e.name=this.name),this.usage!==ue&&(e.usage=this.usage),0===this.updateRange.offset&&-1===this.updateRange.count||(e.updateRange=this.updateRange),e},r(e,[{key:"needsUpdate",set:function(e){!0===e&&this.version++}}]),e}();pn.prototype.isBufferAttribute=!0;var An=function(e){function t(t,n,r){return e.call(this,new Int8Array(t),n,r)||this}return i(t,e),t}(pn),gn=function(e){function t(t,n,r){return e.call(this,new Uint8Array(t),n,r)||this}return i(t,e),t}(pn),vn=function(e){function t(t,n,r){return e.call(this,new Uint8ClampedArray(t),n,r)||this}return i(t,e),t}(pn),mn=function(e){function t(t,n,r){return e.call(this,new Int16Array(t),n,r)||this}return i(t,e),t}(pn),yn=function(e){function t(t,n,r){return e.call(this,new Uint16Array(t),n,r)||this}return i(t,e),t}(pn),bn=function(e){function t(t,n,r){return e.call(this,new Int32Array(t),n,r)||this}return i(t,e),t}(pn),En=function(e){function t(t,n,r){return e.call(this,new Uint32Array(t),n,r)||this}return i(t,e),t}(pn),_n=function(e){function t(t,n,r){return e.call(this,new Uint16Array(t),n,r)||this}return i(t,e),t}(pn);_n.prototype.isFloat16BufferAttribute=!0;var wn=function(e){function t(t,n,r){return e.call(this,new Float32Array(t),n,r)||this}return i(t,e),t}(pn),Sn=function(e){function t(t,n,r){return e.call(this,new Float64Array(t),n,r)||this}return i(t,e),t}(pn);function Tn(e){if(0===e.length)return-1/0;for(var t=e[0],n=1,r=e.length;n<r;++n)e[n]>t&&(t=e[n]);return t}var Rn={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:Uint8ClampedArray,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};function Cn(e,t){return new Rn[e](t)}var In=0,xn=new pt,On=new Ft,Nn=new De,Bn=new He,Mn=new He,Ln=new De,kn=function(e){function t(){var t;return t=e.call(this)||this,Object.defineProperty(o(t),"id",{value:In++}),t.uuid=me(),t.name="",t.type="BufferGeometry",t.index=null,t.attributes={},t.morphAttributes={},t.morphTargetsRelative=!1,t.groups=[],t.boundingBox=null,t.boundingSphere=null,t.drawRange={start:0,count:1/0},t.userData={},t}i(t,e);var n=t.prototype;return n.getIndex=function(){return this.index},n.setIndex=function(e){return Array.isArray(e)?this.index=new(Tn(e)>65535?En:yn)(e,1):this.index=e,this},n.getAttribute=function(e){return this.attributes[e]},n.setAttribute=function(e,t){return this.attributes[e]=t,this},n.deleteAttribute=function(e){return delete this.attributes[e],this},n.hasAttribute=function(e){return void 0!==this.attributes[e]},n.addGroup=function(e,t,n){void 0===n&&(n=0),this.groups.push({start:e,count:t,materialIndex:n})},n.clearGroups=function(){this.groups=[]},n.setDrawRange=function(e,t){this.drawRange.start=e,this.drawRange.count=t},n.applyMatrix4=function(e){var t=this.attributes.position;void 0!==t&&(t.applyMatrix4(e),t.needsUpdate=!0);var n=this.attributes.normal;if(void 0!==n){var r=(new Ie).getNormalMatrix(e);n.applyNormalMatrix(r),n.needsUpdate=!0}var i=this.attributes.tangent;return void 0!==i&&(i.transformDirection(e),i.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},n.rotateX=function(e){return xn.makeRotationX(e),this.applyMatrix4(xn),this},n.rotateY=function(e){return xn.makeRotationY(e),this.applyMatrix4(xn),this},n.rotateZ=function(e){return xn.makeRotationZ(e),this.applyMatrix4(xn),this},n.translate=function(e,t,n){return xn.makeTranslation(e,t,n),this.applyMatrix4(xn),this},n.scale=function(e,t,n){return xn.makeScale(e,t,n),this.applyMatrix4(xn),this},n.lookAt=function(e){return On.lookAt(e),On.updateMatrix(),this.applyMatrix4(On.matrix),this},n.center=function(){return this.computeBoundingBox(),this.boundingBox.getCenter(Nn).negate(),this.translate(Nn.x,Nn.y,Nn.z),this},n.setFromPoints=function(e){for(var t=[],n=0,r=e.length;n<r;n++){var i=e[n];t.push(i.x,i.y,i.z||0)}return this.setAttribute("position",new wn(t,3)),this},n.computeBoundingBox=function(){null===this.boundingBox&&(this.boundingBox=new He);var e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingBox.set(new De(-1/0,-1/0,-1/0),new De(1/0,1/0,1/0));if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),t)for(var n=0,r=t.length;n<r;n++){var i=t[n];Bn.setFromBufferAttribute(i),this.morphTargetsRelative?(Ln.addVectors(this.boundingBox.min,Bn.min),this.boundingBox.expandByPoint(Ln),Ln.addVectors(this.boundingBox.max,Bn.max),this.boundingBox.expandByPoint(Ln)):(this.boundingBox.expandByPoint(Bn.min),this.boundingBox.expandByPoint(Bn.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},n.computeBoundingSphere=function(){null===this.boundingSphere&&(this.boundingSphere=new ot);var e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingSphere.set(new De,1/0);if(e){var n=this.boundingSphere.center;if(Bn.setFromBufferAttribute(e),t)for(var r=0,i=t.length;r<i;r++){var o=t[r];Mn.setFromBufferAttribute(o),this.morphTargetsRelative?(Ln.addVectors(Bn.min,Mn.min),Bn.expandByPoint(Ln),Ln.addVectors(Bn.max,Mn.max),Bn.expandByPoint(Ln)):(Bn.expandByPoint(Mn.min),Bn.expandByPoint(Mn.max))}Bn.getCenter(n);for(var a=0,s=0,c=e.count;s<c;s++)Ln.fromBufferAttribute(e,s),a=Math.max(a,n.distanceToSquared(Ln));if(t)for(var u=0,l=t.length;u<l;u++)for(var d=t[u],h=this.morphTargetsRelative,f=0,p=d.count;f<p;f++)Ln.fromBufferAttribute(d,f),h&&(Nn.fromBufferAttribute(e,f),Ln.add(Nn)),a=Math.max(a,n.distanceToSquared(Ln));this.boundingSphere.radius=Math.sqrt(a),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}},n.computeFaceNormals=function(){},n.computeTangents=function(){var e=this.index,t=this.attributes;if(null!==e&&void 0!==t.position&&void 0!==t.normal&&void 0!==t.uv){var n=e.array,r=t.position.array,i=t.normal.array,o=t.uv.array,a=r.length/3;void 0===t.tangent&&this.setAttribute("tangent",new pn(new Float32Array(4*a),4));for(var s=t.tangent.array,c=[],u=[],l=0;l<a;l++)c[l]=new De,u[l]=new De;var d=new De,h=new De,f=new De,p=new Re,A=new Re,g=new Re,v=new De,m=new De,y=this.groups;0===y.length&&(y=[{start:0,count:n.length}]);for(var b=0,E=y.length;b<E;++b)for(var _=y[b],w=_.start,S=w,T=w+_.count;S<T;S+=3)U(n[S+0],n[S+1],n[S+2]);for(var R=new De,C=new De,I=new De,x=new De,O=0,N=y.length;O<N;++O)for(var B=y[O],M=B.start,L=M,k=M+B.count;L<k;L+=3)D(n[L+0]),D(n[L+1]),D(n[L+2])}else console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");function U(e,t,n){d.fromArray(r,3*e),h.fromArray(r,3*t),f.fromArray(r,3*n),p.fromArray(o,2*e),A.fromArray(o,2*t),g.fromArray(o,2*n),h.sub(d),f.sub(d),A.sub(p),g.sub(p);var i=1/(A.x*g.y-g.x*A.y);isFinite(i)&&(v.copy(h).multiplyScalar(g.y).addScaledVector(f,-A.y).multiplyScalar(i),m.copy(f).multiplyScalar(A.x).addScaledVector(h,-g.x).multiplyScalar(i),c[e].add(v),c[t].add(v),c[n].add(v),u[e].add(m),u[t].add(m),u[n].add(m))}function D(e){I.fromArray(i,3*e),x.copy(I);var t=c[e];R.copy(t),R.sub(I.multiplyScalar(I.dot(t))).normalize(),C.crossVectors(x,t);var n=C.dot(u[e])<0?-1:1;s[4*e]=R.x,s[4*e+1]=R.y,s[4*e+2]=R.z,s[4*e+3]=n}},n.computeVertexNormals=function(){var e=this.index,t=this.getAttribute("position");if(void 0!==t){var n=this.getAttribute("normal");if(void 0===n)n=new pn(new Float32Array(3*t.count),3),this.setAttribute("normal",n);else for(var r=0,i=n.count;r<i;r++)n.setXYZ(r,0,0,0);var o=new De,a=new De,s=new De,c=new De,u=new De,l=new De,d=new De,h=new De;if(e)for(var f=0,p=e.count;f<p;f+=3){var A=e.getX(f+0),g=e.getX(f+1),v=e.getX(f+2);o.fromBufferAttribute(t,A),a.fromBufferAttribute(t,g),s.fromBufferAttribute(t,v),d.subVectors(s,a),h.subVectors(o,a),d.cross(h),c.fromBufferAttribute(n,A),u.fromBufferAttribute(n,g),l.fromBufferAttribute(n,v),c.add(d),u.add(d),l.add(d),n.setXYZ(A,c.x,c.y,c.z),n.setXYZ(g,u.x,u.y,u.z),n.setXYZ(v,l.x,l.y,l.z)}else for(var m=0,y=t.count;m<y;m+=3)o.fromBufferAttribute(t,m+0),a.fromBufferAttribute(t,m+1),s.fromBufferAttribute(t,m+2),d.subVectors(s,a),h.subVectors(o,a),d.cross(h),n.setXYZ(m+0,d.x,d.y,d.z),n.setXYZ(m+1,d.x,d.y,d.z),n.setXYZ(m+2,d.x,d.y,d.z);this.normalizeNormals(),n.needsUpdate=!0}},n.merge=function(e,t){if(e&&e.isBufferGeometry){void 0===t&&(t=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));var n=this.attributes;for(var r in n)if(void 0!==e.attributes[r])for(var i=n[r].array,o=e.attributes[r],a=o.array,s=o.itemSize*t,c=Math.min(a.length,i.length-s),u=0,l=s;u<c;u++,l++)i[l]=a[u];return this}console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",e)},n.normalizeNormals=function(){for(var e=this.attributes.normal,t=0,n=e.count;t<n;t++)Ln.fromBufferAttribute(e,t),Ln.normalize(),e.setXYZ(t,Ln.x,Ln.y,Ln.z)},n.toNonIndexed=function(){function e(e,t){for(var n=e.array,r=e.itemSize,i=e.normalized,o=new n.constructor(t.length*r),a=0,s=0,c=0,u=t.length;c<u;c++){a=t[c]*r;for(var l=0;l<r;l++)o[s++]=n[a++]}return new pn(o,r,i)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;var n=new t,r=this.index.array,i=this.attributes;for(var o in i){var a=e(i[o],r);n.setAttribute(o,a)}var s=this.morphAttributes;for(var c in s){for(var u=[],l=s[c],d=0,h=l.length;d<h;d++){var f=e(l[d],r);u.push(f)}n.morphAttributes[c]=u}n.morphTargetsRelative=this.morphTargetsRelative;for(var p=this.groups,A=0,g=p.length;A<g;A++){var v=p[A];n.addGroup(v.start,v.count,v.materialIndex)}return n},n.toJSON=function(){var e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){var t=this.parameters;for(var n in t)void 0!==t[n]&&(e[n]=t[n]);return e}e.data={attributes:{}};var r=this.index;null!==r&&(e.data.index={type:r.array.constructor.name,array:Array.prototype.slice.call(r.array)});var i=this.attributes;for(var o in i){var a=i[o];e.data.attributes[o]=a.toJSON(e.data)}var s={},c=!1;for(var u in this.morphAttributes){for(var l=this.morphAttributes[u],d=[],h=0,f=l.length;h<f;h++){var p=l[h];d.push(p.toJSON(e.data))}d.length>0&&(s[u]=d,c=!0)}c&&(e.data.morphAttributes=s,e.data.morphTargetsRelative=this.morphTargetsRelative);var A=this.groups;A.length>0&&(e.data.groups=JSON.parse(JSON.stringify(A)));var g=this.boundingSphere;return null!==g&&(e.data.boundingSphere={center:g.center.toArray(),radius:g.radius}),e},n.clone=function(){return(new t).copy(this)},n.copy=function(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;var t={};this.name=e.name;var n=e.index;null!==n&&this.setIndex(n.clone(t));var r=e.attributes;for(var i in r){var o=r[i];this.setAttribute(i,o.clone(t))}var a=e.morphAttributes;for(var s in a){for(var c=[],u=a[s],l=0,d=u.length;l<d;l++)c.push(u[l].clone(t));this.morphAttributes[s]=c}this.morphTargetsRelative=e.morphTargetsRelative;for(var h=e.groups,f=0,p=h.length;f<p;f++){var A=h[f];this.addGroup(A.start,A.count,A.materialIndex)}var g=e.boundingBox;null!==g&&(this.boundingBox=g.clone());var v=e.boundingSphere;return null!==v&&(this.boundingSphere=v.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this},n.dispose=function(){this.dispatchEvent({type:"dispose"})},t}(he);kn.prototype.isBufferGeometry=!0;var Un=new pt,Dn=new ft,Pn=new ot,Fn=new De,Hn=new De,jn=new De,Vn=new De,Qn=new De,Gn=new De,zn=new De,Kn=new De,qn=new De,Wn=new Re,Xn=new Re,Jn=new Re,Yn=new De,Zn=new De,$n=function(e){function t(t,n){var r;return void 0===t&&(t=new kn),void 0===n&&(n=new dn),(r=e.call(this)||this).type="Mesh",r.geometry=t,r.material=n,r.updateMorphTargets(),r}i(t,e);var n=t.prototype;return n.copy=function(t){return e.prototype.copy.call(this,t),void 0!==t.morphTargetInfluences&&(this.morphTargetInfluences=t.morphTargetInfluences.slice()),void 0!==t.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},t.morphTargetDictionary)),this.material=t.material,this.geometry=t.geometry,this},n.updateMorphTargets=function(){var e=this.geometry;if(e.isBufferGeometry){var t=e.morphAttributes,n=Object.keys(t);if(n.length>0){var r=t[n[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(var i=0,o=r.length;i<o;i++){var a=r[i].name||String(i);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=i}}}}else{var s=e.morphTargets;void 0!==s&&s.length>0&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}},n.raycast=function(e,t){var n,r=this.geometry,i=this.material,o=this.matrixWorld;if(void 0!==i&&(null===r.boundingSphere&&r.computeBoundingSphere(),Pn.copy(r.boundingSphere),Pn.applyMatrix4(o),!1!==e.ray.intersectsSphere(Pn)&&(Un.copy(o).invert(),Dn.copy(e.ray).applyMatrix4(Un),null===r.boundingBox||!1!==Dn.intersectsBox(r.boundingBox))))if(r.isBufferGeometry){var a=r.index,s=r.attributes.position,c=r.morphAttributes.position,u=r.morphTargetsRelative,l=r.attributes.uv,d=r.attributes.uv2,h=r.groups,f=r.drawRange;if(null!==a)if(Array.isArray(i))for(var p=0,A=h.length;p<A;p++)for(var g=h[p],v=i[g.materialIndex],m=Math.max(g.start,f.start),y=Math.min(g.start+g.count,f.start+f.count);m<y;m+=3){var b=a.getX(m),E=a.getX(m+1),_=a.getX(m+2);(n=er(this,v,e,Dn,s,c,u,l,d,b,E,_))&&(n.faceIndex=Math.floor(m/3),n.face.materialIndex=g.materialIndex,t.push(n))}else for(var w=Math.max(0,f.start),S=Math.min(a.count,f.start+f.count);w<S;w+=3){var T=a.getX(w),R=a.getX(w+1),C=a.getX(w+2);(n=er(this,i,e,Dn,s,c,u,l,d,T,R,C))&&(n.faceIndex=Math.floor(w/3),t.push(n))}else if(void 0!==s)if(Array.isArray(i))for(var I=0,x=h.length;I<x;I++)for(var O=h[I],N=i[O.materialIndex],B=Math.max(O.start,f.start),M=Math.min(O.start+O.count,f.start+f.count);B<M;B+=3){(n=er(this,N,e,Dn,s,c,u,l,d,B,B+1,B+2))&&(n.faceIndex=Math.floor(B/3),n.face.materialIndex=O.materialIndex,t.push(n))}else for(var L=Math.max(0,f.start),k=Math.min(s.count,f.start+f.count);L<k;L+=3){(n=er(this,i,e,Dn,s,c,u,l,d,L,L+1,L+2))&&(n.faceIndex=Math.floor(L/3),t.push(n))}}else r.isGeometry&&console.error("THREE.Mesh.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")},t}(Ft);function er(e,t,n,r,i,o,a,s,c,u,l,d){Fn.fromBufferAttribute(i,u),Hn.fromBufferAttribute(i,l),jn.fromBufferAttribute(i,d);var h=e.morphTargetInfluences;if(t.morphTargets&&o&&h){zn.set(0,0,0),Kn.set(0,0,0),qn.set(0,0,0);for(var f=0,p=o.length;f<p;f++){var A=h[f],g=o[f];0!==A&&(Vn.fromBufferAttribute(g,u),Qn.fromBufferAttribute(g,l),Gn.fromBufferAttribute(g,d),a?(zn.addScaledVector(Vn,A),Kn.addScaledVector(Qn,A),qn.addScaledVector(Gn,A)):(zn.addScaledVector(Vn.sub(Fn),A),Kn.addScaledVector(Qn.sub(Hn),A),qn.addScaledVector(Gn.sub(jn),A)))}Fn.add(zn),Hn.add(Kn),jn.add(qn)}e.isSkinnedMesh&&t.skinning&&(e.boneTransform(u,Fn),e.boneTransform(l,Hn),e.boneTransform(d,jn));var v=function(e,t,n,r,i,o,a,s){if(null===(1===t.side?r.intersectTriangle(a,o,i,!0,s):r.intersectTriangle(i,o,a,2!==t.side,s)))return null;Zn.copy(s),Zn.applyMatrix4(e.matrixWorld);var c=n.ray.origin.distanceTo(Zn);return c<n.near||c>n.far?null:{distance:c,point:Zn.clone(),object:e}}(e,t,n,r,Fn,Hn,jn,Yn);if(v){s&&(Wn.fromBufferAttribute(s,u),Xn.fromBufferAttribute(s,l),Jn.fromBufferAttribute(s,d),v.uv=en.getUV(Yn,Fn,Hn,jn,Wn,Xn,Jn,new Re)),c&&(Wn.fromBufferAttribute(c,u),Xn.fromBufferAttribute(c,l),Jn.fromBufferAttribute(c,d),v.uv2=en.getUV(Yn,Fn,Hn,jn,Wn,Xn,Jn,new Re));var m={a:u,b:l,c:d,normal:new De,materialIndex:0};en.getNormal(Fn,Hn,jn,m.normal),v.face=m}return v}$n.prototype.isMesh=!0;var tr=function(e){function t(t,n,r,i,a,s){var c;void 0===t&&(t=1),void 0===n&&(n=1),void 0===r&&(r=1),void 0===i&&(i=1),void 0===a&&(a=1),void 0===s&&(s=1),(c=e.call(this)||this).type="BoxGeometry",c.parameters={width:t,height:n,depth:r,widthSegments:i,heightSegments:a,depthSegments:s};var u=o(c);i=Math.floor(i),a=Math.floor(a),s=Math.floor(s);var l=[],d=[],h=[],f=[],p=0,A=0;function g(e,t,n,r,i,o,a,s,c,g,v){for(var m=o/c,y=a/g,b=o/2,E=a/2,_=s/2,w=c+1,S=g+1,T=0,R=0,C=new De,I=0;I<S;I++)for(var x=I*y-E,O=0;O<w;O++){var N=O*m-b;C[e]=N*r,C[t]=x*i,C[n]=_,d.push(C.x,C.y,C.z),C[e]=0,C[t]=0,C[n]=s>0?1:-1,h.push(C.x,C.y,C.z),f.push(O/c),f.push(1-I/g),T+=1}for(var B=0;B<g;B++)for(var M=0;M<c;M++){var L=p+M+w*B,k=p+M+w*(B+1),U=p+(M+1)+w*(B+1),D=p+(M+1)+w*B;l.push(L,k,D),l.push(k,U,D),R+=6}u.addGroup(A,R,v),A+=R,p+=T}return g("z","y","x",-1,-1,r,n,t,s,a,0),g("z","y","x",1,-1,r,n,-t,s,a,1),g("x","z","y",1,1,t,r,n,i,s,2),g("x","z","y",1,-1,t,r,-n,i,s,3),g("x","y","z",1,-1,t,n,r,i,a,4),g("x","y","z",-1,-1,t,n,-r,i,a,5),c.setIndex(l),c.setAttribute("position",new wn(d,3)),c.setAttribute("normal",new wn(h,3)),c.setAttribute("uv",new wn(f,2)),c}return i(t,e),t}(kn);function nr(e){var t={};for(var n in e)for(var r in t[n]={},e[n]){var i=e[n][r];i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture||i.isQuaternion)?t[n][r]=i.clone():Array.isArray(i)?t[n][r]=i.slice():t[n][r]=i}return t}function rr(e){for(var t={},n=0;n<e.length;n++){var r=nr(e[n]);for(var i in r)t[i]=r[i]}return t}var ir={clone:nr,merge:rr},or=function(e){function t(t){var n;return(n=e.call(this)||this).type="ShaderMaterial",n.defines={},n.uniforms={},n.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",n.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",n.linewidth=1,n.wireframe=!1,n.wireframeLinewidth=1,n.fog=!1,n.lights=!1,n.clipping=!1,n.skinning=!1,n.morphTargets=!1,n.morphNormals=!1,n.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},n.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},n.index0AttributeName=void 0,n.uniformsNeedUpdate=!1,n.glslVersion=null,void 0!==t&&(void 0!==t.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),n.setValues(t)),n}i(t,e);var n=t.prototype;return n.copy=function(t){return e.prototype.copy.call(this,t),this.fragmentShader=t.fragmentShader,this.vertexShader=t.vertexShader,this.uniforms=nr(t.uniforms),this.defines=Object.assign({},t.defines),this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.lights=t.lights,this.clipping=t.clipping,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.extensions=Object.assign({},t.extensions),this.glslVersion=t.glslVersion,this},n.toJSON=function(t){var n=e.prototype.toJSON.call(this,t);for(var r in n.glslVersion=this.glslVersion,n.uniforms={},this.uniforms){var i=this.uniforms[r].value;i&&i.isTexture?n.uniforms[r]={type:"t",value:i.toJSON(t).uuid}:i&&i.isColor?n.uniforms[r]={type:"c",value:i.getHex()}:i&&i.isVector2?n.uniforms[r]={type:"v2",value:i.toArray()}:i&&i.isVector3?n.uniforms[r]={type:"v3",value:i.toArray()}:i&&i.isVector4?n.uniforms[r]={type:"v4",value:i.toArray()}:i&&i.isMatrix3?n.uniforms[r]={type:"m3",value:i.toArray()}:i&&i.isMatrix4?n.uniforms[r]={type:"m4",value:i.toArray()}:n.uniforms[r]={value:i}}Object.keys(this.defines).length>0&&(n.defines=this.defines),n.vertexShader=this.vertexShader,n.fragmentShader=this.fragmentShader;var o={};for(var a in this.extensions)!0===this.extensions[a]&&(o[a]=!0);return Object.keys(o).length>0&&(n.extensions=o),n},t}(nn);or.prototype.isShaderMaterial=!0;var ar=function(e){function t(){var t;return(t=e.call(this)||this).type="Camera",t.matrixWorldInverse=new pt,t.projectionMatrix=new pt,t.projectionMatrixInverse=new pt,t}i(t,e);var n=t.prototype;return n.copy=function(t,n){return e.prototype.copy.call(this,t,n),this.matrixWorldInverse.copy(t.matrixWorldInverse),this.projectionMatrix.copy(t.projectionMatrix),this.projectionMatrixInverse.copy(t.projectionMatrixInverse),this},n.getWorldDirection=function(e){void 0===e&&(console.warn("THREE.Camera: .getWorldDirection() target is now required"),e=new De),this.updateWorldMatrix(!0,!1);var t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()},n.updateMatrixWorld=function(t){e.prototype.updateMatrixWorld.call(this,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()},n.updateWorldMatrix=function(t,n){e.prototype.updateWorldMatrix.call(this,t,n),this.matrixWorldInverse.copy(this.matrixWorld).invert()},n.clone=function(){return(new this.constructor).copy(this)},t}(Ft);ar.prototype.isCamera=!0;var sr=function(e){function t(t,n,r,i){var o;return void 0===t&&(t=50),void 0===n&&(n=1),void 0===r&&(r=.1),void 0===i&&(i=2e3),(o=e.call(this)||this).type="PerspectiveCamera",o.fov=t,o.zoom=1,o.near=r,o.far=i,o.focus=10,o.aspect=n,o.view=null,o.filmGauge=35,o.filmOffset=0,o.updateProjectionMatrix(),o}i(t,e);var n=t.prototype;return n.copy=function(t,n){return e.prototype.copy.call(this,t,n),this.fov=t.fov,this.zoom=t.zoom,this.near=t.near,this.far=t.far,this.focus=t.focus,this.aspect=t.aspect,this.view=null===t.view?null:Object.assign({},t.view),this.filmGauge=t.filmGauge,this.filmOffset=t.filmOffset,this},n.setFocalLength=function(e){var t=.5*this.getFilmHeight()/e;this.fov=2*ve*Math.atan(t),this.updateProjectionMatrix()},n.getFocalLength=function(){var e=Math.tan(.5*ge*this.fov);return.5*this.getFilmHeight()/e},n.getEffectiveFOV=function(){return 2*ve*Math.atan(Math.tan(.5*ge*this.fov)/this.zoom)},n.getFilmWidth=function(){return this.filmGauge*Math.min(this.aspect,1)},n.getFilmHeight=function(){return this.filmGauge/Math.max(this.aspect,1)},n.setViewOffset=function(e,t,n,r,i,o){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=o,this.updateProjectionMatrix()},n.clearViewOffset=function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},n.updateProjectionMatrix=function(){var e=this.near,t=e*Math.tan(.5*ge*this.fov)/this.zoom,n=2*t,r=this.aspect*n,i=-.5*r,o=this.view;if(null!==this.view&&this.view.enabled){var a=o.fullWidth,s=o.fullHeight;i+=o.offsetX*r/a,t-=o.offsetY*n/s,r*=o.width/a,n*=o.height/s}var c=this.filmOffset;0!==c&&(i+=e*c/this.getFilmWidth()),this.projectionMatrix.makePerspective(i,i+r,t,t-n,e,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()},n.toJSON=function(t){var n=e.prototype.toJSON.call(this,t);return n.object.fov=this.fov,n.object.zoom=this.zoom,n.object.near=this.near,n.object.far=this.far,n.object.focus=this.focus,n.object.aspect=this.aspect,null!==this.view&&(n.object.view=Object.assign({},this.view)),n.object.filmGauge=this.filmGauge,n.object.filmOffset=this.filmOffset,n},t}(ar);sr.prototype.isPerspectiveCamera=!0;var cr=90,ur=function(e){function t(t,n,r){var i;if((i=e.call(this)||this).type="CubeCamera",!0!==r.isWebGLCubeRenderTarget)return console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter."),o(i);i.renderTarget=r;var a=new sr(cr,1,t,n);a.layers=i.layers,a.up.set(0,-1,0),a.lookAt(new De(1,0,0)),i.add(a);var s=new sr(cr,1,t,n);s.layers=i.layers,s.up.set(0,-1,0),s.lookAt(new De(-1,0,0)),i.add(s);var c=new sr(cr,1,t,n);c.layers=i.layers,c.up.set(0,0,1),c.lookAt(new De(0,1,0)),i.add(c);var u=new sr(cr,1,t,n);u.layers=i.layers,u.up.set(0,0,-1),u.lookAt(new De(0,-1,0)),i.add(u);var l=new sr(cr,1,t,n);l.layers=i.layers,l.up.set(0,-1,0),l.lookAt(new De(0,0,1)),i.add(l);var d=new sr(cr,1,t,n);return d.layers=i.layers,d.up.set(0,-1,0),d.lookAt(new De(0,0,-1)),i.add(d),i}return i(t,e),t.prototype.update=function(e,t){null===this.parent&&this.updateMatrixWorld();var n=this.renderTarget,r=this.children,i=r[0],o=r[1],a=r[2],s=r[3],c=r[4],u=r[5],l=e.xr.enabled,d=e.getRenderTarget();e.xr.enabled=!1;var h=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,e.setRenderTarget(n,0),e.render(t,i),e.setRenderTarget(n,1),e.render(t,o),e.setRenderTarget(n,2),e.render(t,a),e.setRenderTarget(n,3),e.render(t,s),e.setRenderTarget(n,4),e.render(t,c),n.texture.generateMipmaps=h,e.setRenderTarget(n,5),e.render(t,u),e.setRenderTarget(d),e.xr.enabled=l},t}(Ft),lr=function(e){function t(t,n,r,i,o,a,s,c,u,l){var d;return t=void 0!==t?t:[],n=void 0!==n?n:h,s=void 0!==s?s:M,(d=e.call(this,t,n,r,i,o,a,s,c,u,l)||this)._needsFlipEnvMap=!0,d.flipY=!1,d}return i(t,e),r(t,[{key:"images",get:function(){return this.image},set:function(e){this.image=e}}]),t}(Ne);lr.prototype.isCubeTexture=!0;var dr=function(e){function t(t,n,r){var i;return Number.isInteger(n)&&(console.warn("THREE.WebGLCubeRenderTarget: constructor signature is now WebGLCubeRenderTarget( size, options )"),n=r),i=e.call(this,t,t,n)||this,n=n||{},i.texture=new lr(void 0,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.encoding),i.texture.generateMipmaps=void 0!==n.generateMipmaps&&n.generateMipmaps,i.texture.minFilter=void 0!==n.minFilter?n.minFilter:S,i.texture._needsFlipEnvMap=!1,i}i(t,e);var n=t.prototype;return n.fromEquirectangularTexture=function(e,t){this.texture.type=t.type,this.texture.format=L,this.texture.encoding=t.encoding,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;var n={tEquirect:{value:null}},r="\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",i="\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t",o=new tr(5,5,5),a=new or({name:"CubemapFromEquirect",uniforms:nr(n),vertexShader:r,fragmentShader:i,side:1,blending:0});a.uniforms.tEquirect.value=t;var s=new $n(o,a),c=t.minFilter;return t.minFilter===R&&(t.minFilter=S),new ur(1,10,this).update(e,s),t.minFilter=c,s.geometry.dispose(),s.material.dispose(),this},n.clear=function(e,t,n,r){for(var i=e.getRenderTarget(),o=0;o<6;o++)e.setRenderTarget(this,o),e.clear(t,n,r);e.setRenderTarget(i)},t}(Le);dr.prototype.isWebGLCubeRenderTarget=!0;var hr=function(e){function t(t,n,r,i,o,a,s,c,u,l,d,h){var f;return(f=e.call(this,null,a,s,c,u,l,i,o,d,h)||this).image={data:t||null,width:n||1,height:r||1},f.magFilter=void 0!==u?u:E,f.minFilter=void 0!==l?l:E,f.generateMipmaps=!1,f.flipY=!1,f.unpackAlignment=1,f.needsUpdate=!0,f}return i(t,e),t}(Ne);hr.prototype.isDataTexture=!0;var fr=new ot,pr=new De,Ar=function(){function e(e,t,n,r,i,o){void 0===e&&(e=new Qt),void 0===t&&(t=new Qt),void 0===n&&(n=new Qt),void 0===r&&(r=new Qt),void 0===i&&(i=new Qt),void 0===o&&(o=new Qt),this.planes=[e,t,n,r,i,o]}var t=e.prototype;return t.set=function(e,t,n,r,i,o){var a=this.planes;return a[0].copy(e),a[1].copy(t),a[2].copy(n),a[3].copy(r),a[4].copy(i),a[5].copy(o),this},t.copy=function(e){for(var t=this.planes,n=0;n<6;n++)t[n].copy(e.planes[n]);return this},t.setFromProjectionMatrix=function(e){var t=this.planes,n=e.elements,r=n[0],i=n[1],o=n[2],a=n[3],s=n[4],c=n[5],u=n[6],l=n[7],d=n[8],h=n[9],f=n[10],p=n[11],A=n[12],g=n[13],v=n[14],m=n[15];return t[0].setComponents(a-r,l-s,p-d,m-A).normalize(),t[1].setComponents(a+r,l+s,p+d,m+A).normalize(),t[2].setComponents(a+i,l+c,p+h,m+g).normalize(),t[3].setComponents(a-i,l-c,p-h,m-g).normalize(),t[4].setComponents(a-o,l-u,p-f,m-v).normalize(),t[5].setComponents(a+o,l+u,p+f,m+v).normalize(),this},t.intersectsObject=function(e){var t=e.geometry;return null===t.boundingSphere&&t.computeBoundingSphere(),fr.copy(t.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(fr)},t.intersectsSprite=function(e){return fr.center.set(0,0,0),fr.radius=.7071067811865476,fr.applyMatrix4(e.matrixWorld),this.intersectsSphere(fr)},t.intersectsSphere=function(e){for(var t=this.planes,n=e.center,r=-e.radius,i=0;i<6;i++){if(t[i].distanceToPoint(n)<r)return!1}return!0},t.intersectsBox=function(e){for(var t=this.planes,n=0;n<6;n++){var r=t[n];if(pr.x=r.normal.x>0?e.max.x:e.min.x,pr.y=r.normal.y>0?e.max.y:e.min.y,pr.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(pr)<0)return!1}return!0},t.containsPoint=function(e){for(var t=this.planes,n=0;n<6;n++)if(t[n].distanceToPoint(e)<0)return!1;return!0},t.clone=function(){return(new this.constructor).copy(this)},e}();function gr(){var e=null,t=!1,n=null,r=null;function i(t,o){n(t,o),r=e.requestAnimationFrame(i)}return{start:function(){!0!==t&&null!==n&&(r=e.requestAnimationFrame(i),t=!0)},stop:function(){e.cancelAnimationFrame(r),t=!1},setAnimationLoop:function(e){n=e},setContext:function(t){e=t}}}function vr(e,t){var n=t.isWebGL2,r=new WeakMap;return{get:function(e){return e.isInterleavedBufferAttribute&&(e=e.data),r.get(e)},remove:function(t){t.isInterleavedBufferAttribute&&(t=t.data);var n=r.get(t);n&&(e.deleteBuffer(n.buffer),r.delete(t))},update:function(t,i){if(t.isGLBufferAttribute){var o=r.get(t);(!o||o.version<t.version)&&r.set(t,{buffer:t.buffer,type:t.type,bytesPerElement:t.elementSize,version:t.version})}else{t.isInterleavedBufferAttribute&&(t=t.data);var a=r.get(t);void 0===a?r.set(t,function(t,r){var i=t.array,o=t.usage,a=e.createBuffer();e.bindBuffer(r,a),e.bufferData(r,i,o),t.onUploadCallback();var s=5126;return i instanceof Float32Array?s=5126:i instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):i instanceof Uint16Array?t.isFloat16BufferAttribute?n?s=5131:console.warn("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2."):s=5123:i instanceof Int16Array?s=5122:i instanceof Uint32Array?s=5125:i instanceof Int32Array?s=5124:i instanceof Int8Array?s=5120:i instanceof Uint8Array&&(s=5121),{buffer:a,type:s,bytesPerElement:i.BYTES_PER_ELEMENT,version:t.version}}(t,i)):a.version<t.version&&(!function(t,r,i){var o=r.array,a=r.updateRange;e.bindBuffer(i,t),-1===a.count?e.bufferSubData(i,0,o):(n?e.bufferSubData(i,a.offset*o.BYTES_PER_ELEMENT,o,a.offset,a.count):e.bufferSubData(i,a.offset*o.BYTES_PER_ELEMENT,o.subarray(a.offset,a.offset+a.count)),a.count=-1)}(a.buffer,t,i),a.version=t.version)}}}}var mr=function(e){function t(t,n,r,i){var o;void 0===t&&(t=1),void 0===n&&(n=1),void 0===r&&(r=1),void 0===i&&(i=1),(o=e.call(this)||this).type="PlaneGeometry",o.parameters={width:t,height:n,widthSegments:r,heightSegments:i};for(var a=t/2,s=n/2,c=Math.floor(r),u=Math.floor(i),l=c+1,d=u+1,h=t/c,f=n/u,p=[],A=[],g=[],v=[],m=0;m<d;m++)for(var y=m*f-s,b=0;b<l;b++){var E=b*h-a;A.push(E,-y,0),g.push(0,0,1),v.push(b/c),v.push(1-m/u)}for(var _=0;_<u;_++)for(var w=0;w<c;w++){var S=w+l*_,T=w+l*(_+1),R=w+1+l*(_+1),C=w+1+l*_;p.push(S,T,C),p.push(T,R,C)}return o.setIndex(p),o.setAttribute("position",new wn(A,3)),o.setAttribute("normal",new wn(g,3)),o.setAttribute("uv",new wn(v,2)),o}return i(t,e),t}(kn),yr={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef ALPHATEST\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"vec2 integrateSpecularBRDF( const in float dotNV, const in float roughness ) {\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\treturn vec2( -1.04, 1.04 ) * a004 + r.zw;\n}\nfloat punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\tif( cutoffDistance > 0.0 ) {\n\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t}\n\treturn distanceFalloff;\n#else\n\tif( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t}\n\treturn 1.0;\n#endif\n}\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\n}\nvec3 F_Schlick_RoughnessDependent( const in vec3 F0, const in float dotNV, const in float roughness ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotNV - 6.98316 ) * dotNV );\n\tvec3 Fr = max( vec3( 1.0 - roughness ), F0 ) - F0;\n\treturn Fr * fresnel + F0;\n}\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\tfloat gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\treturn 1.0 / ( gl * gv );\n}\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( incidentLight.direction + viewDir );\n\tfloat dotNL = saturate( dot( normal, incidentLight.direction ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( G * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nvec3 BRDF_Specular_GGX_Environment( const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\treturn specularColor * brdf.x + brdf.y;\n}\nvoid BRDF_Specular_Multiscattering_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tvec3 F = F_Schlick_RoughnessDependent( specularColor, dotNV, roughness );\n\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\tvec3 FssEss = F * brdf.x + brdf.y;\n\tfloat Ess = brdf.x + brdf.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\n}\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\n\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie(float roughness, float NoH) {\n\tfloat invAlpha = 1.0 / roughness;\n\tfloat cos2h = NoH * NoH;\n\tfloat sin2h = max(1.0 - cos2h, 0.0078125);\treturn (2.0 + invAlpha) * pow(sin2h, invAlpha * 0.5) / (2.0 * PI);\n}\nfloat V_Neubelt(float NoV, float NoL) {\n\treturn saturate(1.0 / (4.0 * (NoL + NoV - NoL * NoV)));\n}\nvec3 BRDF_Specular_Sheen( const in float roughness, const in vec3 L, const in GeometricContext geometry, vec3 specularColor ) {\n\tvec3 N = geometry.normal;\n\tvec3 V = geometry.viewDir;\n\tvec3 H = normalize( V + L );\n\tfloat dotNH = saturate( dot( N, H ) );\n\treturn specularColor * D_Charlie( roughness, dotNH ) * V_Neubelt( dot(N, V), dot(N, L) );\n}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement(a) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract(sin(sn) * c);\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat max3( vec3 v ) { return max( max( v.x, v.y ), v.z ); }\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\n\treturn - distance * planeNormal + point;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_maxMipLevel 8.0\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_maxTileSize 256.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\tfloat texelSize = 1.0 / ( 3.0 * cubeUV_maxTileSize );\n\t\tvec2 uv = getUV( direction, face ) * ( faceSize - 1.0 );\n\t\tvec2 f = fract( uv );\n\t\tuv += 0.5 - f;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tif ( mipInt < cubeUV_maxMipLevel ) {\n\t\t\tuv.y += 2.0 * cubeUV_maxTileSize;\n\t\t}\n\t\tuv.y += filterInt * 2.0 * cubeUV_minTileSize;\n\t\tuv.x += 3.0 * max( 0.0, cubeUV_maxTileSize - 2.0 * faceSize );\n\t\tuv *= texelSize;\n\t\tvec3 tl = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\t\tuv.x += texelSize;\n\t\tvec3 tr = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\t\tuv.y += texelSize;\n\t\tvec3 br = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\t\tuv.x -= texelSize;\n\t\tvec3 bl = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\t\tvec3 tm = mix( tl, tr, f.x );\n\t\tvec3 bm = mix( bl, br, f.x );\n\t\treturn mix( tm, bm, f.y );\n\t}\n\t#define r0 1.0\n\t#define v0 0.339\n\t#define m0 - 2.0\n\t#define r1 0.8\n\t#define v1 0.276\n\t#define m1 - 1.0\n\t#define r4 0.4\n\t#define v4 0.046\n\t#define m4 2.0\n\t#define r5 0.305\n\t#define v5 0.016\n\t#define m5 3.0\n\t#define r6 0.21\n\t#define v6 0.0038\n\t#define m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= r1 ) {\n\t\t\tmip = ( r0 - roughness ) * ( m1 - m0 ) / ( r0 - r1 ) + m0;\n\t\t} else if ( roughness >= r4 ) {\n\t\t\tmip = ( r1 - roughness ) * ( m4 - m1 ) / ( r1 - r4 ) + m1;\n\t\t} else if ( roughness >= r5 ) {\n\t\t\tmip = ( r4 - roughness ) * ( m5 - m4 ) / ( r4 - r5 ) + m4;\n\t\t} else if ( roughness >= r6 ) {\n\t\t\tmip = ( r5 - roughness ) * ( m6 - m5 ) / ( r5 - r6 ) + m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), m0, cubeUV_maxMipLevel );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:"\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n\tfloat maxComponent = max( max( value.r, value.g ), value.b );\n\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * value.a * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat M = clamp( maxRGB / maxRange, 0.0, 1.0 );\n\tM = ceil( M * 255.0 ) / 255.0;\n\treturn vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat D = max( maxRange / maxRGB, 1.0 );\n\tD = clamp( floor( D ) / 255.0, 0.0, 1.0 );\n\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value ) {\n\tvec3 Xp_Y_XYZp = cLogLuvM * value.rgb;\n\tXp_Y_XYZp = max( Xp_Y_XYZp, vec3( 1e-6, 1e-6, 1e-6 ) );\n\tvec4 vResult;\n\tvResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n\tfloat Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n\tvResult.w = fract( Le );\n\tvResult.z = ( Le - ( floor( vResult.w * 255.0 ) ) / 255.0 ) / 255.0;\n\treturn vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n\tfloat Le = value.z * 255.0 + value.w;\n\tvec3 Xp_Y_XYZp;\n\tXp_Y_XYZp.y = exp2( ( Le - 127.0 ) / 2.0 );\n\tXp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n\tXp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n\tvec3 vRGB = cLogLuvInverseM * Xp_Y_XYZp.rgb;\n\treturn vec4( max( vRGB, 0.0 ), 1.0 );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifndef ENVMAP_TYPE_CUBE_UV\n\t\tenvColor = envMapTexelToLinear( envColor );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\tuniform int maxMipLevel;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#if defined( USE_ENVMAP )\n\t#ifdef ENVMAP_MODE_REFRACTION\n\t\tuniform float refractionRatio;\n\t#endif\n\tvec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\n\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t#else\n\t\t\tvec4 envMapColor = vec4( 0.0 );\n\t\t#endif\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t}\n\tfloat getSpecularMIPLevel( const in float roughness, const in int maxMIPLevel ) {\n\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\n\t\tfloat sigma = PI * roughness * roughness / ( 1.0 + roughness );\n\t\tfloat desiredMIPLevel = maxMIPLevelScalar + log2( sigma );\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n\t}\n\tvec3 getLightProbeIndirectRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in int maxMIPLevel ) {\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( -viewDir, normal );\n\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( -viewDir, normal, refractionRatio );\n\t\t#endif\n\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\tfloat specularMIPLevel = getSpecularMIPLevel( roughness, maxMIPLevel );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t#endif\n\t\treturn envMapColor.rgb * envMapIntensity;\n\t}\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tfogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float fogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * fogDepth * fogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, fogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float fogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn texture2D( gradientMap, coord ).rgb;\n\t#else\n\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\treflectedLight.indirectDiffuse += PI * lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\nvIndirectFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n\tvIndirectBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\nvIndirectFront += getAmbientLightIrradiance( ambientLightColor );\nvIndirectFront += getLightProbeIrradiance( lightProbe, geometry );\n#ifdef DOUBLE_SIDED\n\tvIndirectBack += getAmbientLightIrradiance( ambientLightColor );\n\tvIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry );\n#endif\n#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in GeometricContext geometry ) {\n\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treturn irradiance;\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tdirectLight.color = directionalLight.color;\n\t\tdirectLight.direction = directionalLight.direction;\n\t\tdirectLight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tdirectLight.color = pointLight.color;\n\t\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\n\t\tdirectLight.visible = ( directLight.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tfloat angleCos = dot( directLight.direction, spotLight.direction );\n\t\tif ( angleCos > spotLight.coneCos ) {\n\t\t\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\t\tdirectLight.color = spotLight.color;\n\t\t\tdirectLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tdirectLight.visible = true;\n\t\t} else {\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tirradiance *= PI;\n\t\t#endif\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon\n#define Material_LightProbeLOD( material )\t(0)",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.specularRoughness = max( roughnessFactor, 0.0525 );material.specularRoughness += geometryRoughness;\nmaterial.specularRoughness = min( material.specularRoughness, 1.0 );\n#ifdef REFLECTIVITY\n\tmaterial.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );\n#endif\n#ifdef CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheen;\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat specularRoughness;\n\tvec3 specularColor;\n#ifdef CLEARCOAT\n\tfloat clearcoat;\n\tfloat clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tvec3 sheenColor;\n#endif\n};\n#define MAXIMUM_SPECULAR_COEFFICIENT 0.16\n#define DEFAULT_SPECULAR_COEFFICIENT 0.04\nfloat clearcoatDHRApprox( const in float roughness, const in float dotNL ) {\n\treturn DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.specularRoughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\t#ifdef CLEARCOAT\n\t\tfloat ccDotNL = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = ccDotNL * directLight.color;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tccIrradiance *= PI;\n\t\t#endif\n\t\tfloat clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );\n\t\treflectedLight.directSpecular += ccIrradiance * material.clearcoat * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );\n\t#else\n\t\tfloat clearcoatDHR = 0.0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\treflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_Sheen(\n\t\t\tmaterial.specularRoughness,\n\t\t\tdirectLight.direction,\n\t\t\tgeometry,\n\t\t\tmaterial.sheenColor\n\t\t);\n\t#else\n\t\treflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.normal, material.specularColor, material.specularRoughness);\n\t#endif\n\treflectedLight.directDiffuse += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef CLEARCOAT\n\t\tfloat ccDotNV = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular += clearcoatRadiance * material.clearcoat * BRDF_Specular_GGX_Environment( geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );\n\t\tfloat ccDotNL = ccDotNV;\n\t\tfloat clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );\n\t#else\n\t\tfloat clearcoatDHR = 0.0;\n\t#endif\n\tfloat clearcoatInv = 1.0 - clearcoatDHR;\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\tBRDF_Specular_Multiscattering_Environment( geometry, material.specularColor, material.specularRoughness, singleScattering, multiScattering );\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );\n\treflectedLight.indirectSpecular += clearcoatInv * radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef CLEARCOAT\n\tgeometry.clearcoatNormal = clearcoatNormal;\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\t\tvec3 lightMapIrradiance = lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getLightProbeIndirectIrradiance( geometry, maxMipLevel );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.normal, material.specularRoughness, maxMipLevel );\n\t#ifdef CLEARCOAT\n\t\tclearcoatRadiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness, maxMipLevel );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n#endif\n#ifdef USE_MAP\n\tvec4 mapTexel = texture2D( map, uv );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tuniform mat3 uvTransform;\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifndef USE_MORPHNORMALS\n\t\tuniform float morphTargetInfluences[ 8 ];\n\t#else\n\t\tuniform float morphTargetInfluences[ 4 ];\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t#ifndef USE_MORPHNORMALS\n\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t#endif\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\t#ifdef USE_TANGENT\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\ttangent = tangent * faceDirection;\n\t\t\tbitangent = bitangent * faceDirection;\n\t\t#endif\n\t\t#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tmat3 vTBN = mat3( tangent, bitangent, normal );\n\t\t#endif\n\t#endif\n#endif\nvec3 geometryNormal = normal;",normal_fragment_maps:"#ifdef OBJECTSPACE_NORMALMAP\n\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( TANGENTSPACE_NORMALMAP )\n\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\t#ifdef USE_TANGENT\n\t\tnormal = normalize( vTBN * mapN );\n\t#else\n\t\tnormal = perturbNormal2Arb( -vViewPosition, normal, mapN, faceDirection );\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef OBJECTSPACE_NORMALMAP\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {\n\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );\n\t\treturn normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef CLEARCOAT\n\tvec3 clearcoatNormal = geometryNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\t#ifdef USE_TANGENT\n\t\tclearcoatNormal = normalize( vTBN * clearcoatMapN );\n\t#else\n\t\tclearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );\n\t#endif\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ));\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w);\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn (( near + viewZ ) * far ) / (( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0\n\t\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\tvec4 shadowWorldPosition;\n\t#endif\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform highp sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmissionmap_fragment:"#ifdef USE_TRANSMISSIONMAP\n\ttotalTransmission *= texture2D( transmissionMap, vUv ).r;\n#endif",transmissionmap_pars_fragment:"#ifdef USE_TRANSMISSIONMAP\n\tuniform sampler2D transmissionMap;\n#endif",uv_pars_fragment:"#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#ifdef USE_UV\n\t#ifdef UVS_VERTEX_ONLY\n\t\tvec2 vUv;\n\t#else\n\t\tvarying vec2 vUv;\n\t#endif\n\tuniform mat3 uvTransform;\n#endif",uv_vertex:"#ifdef USE_UV\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n\tuniform mat3 uv2Transform;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_frag:"uniform sampler2D t2D;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",cube_frag:"#include <envmap_common_pars_fragment>\nuniform float opacity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\tvec3 vReflect = vWorldDirection;\n\t#include <envmap_fragment>\n\tgl_FragColor = envColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tvec4 texColor = texture2D( tEquirect, sampleUV );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\n\t\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\t\treflectedLight.indirectDiffuse += lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_ENVMAP\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;\n\t#else\n\t\treflectedLight.indirectDiffuse += vIndirectFront;\n\t#endif\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t\tmatcapColor = matcapTexelToLinear( matcapColor );\n\t#else\n\t\tvec4 matcapColor = vec4( 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#ifndef FLAT_SHADED\n\t\tvNormal = normalize( transformedNormal );\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define REFLECTIVITY\n\t#define CLEARCOAT\n\t#define TRANSMISSION\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef TRANSMISSION\n\tuniform float transmission;\n#endif\n#ifdef REFLECTIVITY\n\tuniform float reflectivity;\n#endif\n#ifdef CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheen;\n#endif\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <transmissionmap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#ifdef TRANSMISSION\n\t\tfloat totalTransmission = transmission;\n\t#endif\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <transmissionmap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#ifdef TRANSMISSION\n\t\tdiffuseColor.a *= mix( saturate( 1. - totalTransmission + linearToRelativeLuminance( reflectedLight.directSpecular + reflectedLight.indirectSpecular ) ), 1.0, metalness );\n\t#endif\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",normal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n}",normal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",shadow_vert:"#include <common>\n#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}"},br={common:{diffuse:{value:new ln(15658734)},opacity:{value:1},map:{value:null},uvTransform:{value:new Ie},uv2Transform:{value:new Ie},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new Re(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new ln(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new ln(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},uvTransform:{value:new Ie}},sprite:{diffuse:{value:new ln(15658734)},opacity:{value:1},center:{value:new Re(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},uvTransform:{value:new Ie}}},Er={basic:{uniforms:rr([br.common,br.specularmap,br.envmap,br.aomap,br.lightmap,br.fog]),vertexShader:yr.meshbasic_vert,fragmentShader:yr.meshbasic_frag},lambert:{uniforms:rr([br.common,br.specularmap,br.envmap,br.aomap,br.lightmap,br.emissivemap,br.fog,br.lights,{emissive:{value:new ln(0)}}]),vertexShader:yr.meshlambert_vert,fragmentShader:yr.meshlambert_frag},phong:{uniforms:rr([br.common,br.specularmap,br.envmap,br.aomap,br.lightmap,br.emissivemap,br.bumpmap,br.normalmap,br.displacementmap,br.fog,br.lights,{emissive:{value:new ln(0)},specular:{value:new ln(1118481)},shininess:{value:30}}]),vertexShader:yr.meshphong_vert,fragmentShader:yr.meshphong_frag},standard:{uniforms:rr([br.common,br.envmap,br.aomap,br.lightmap,br.emissivemap,br.bumpmap,br.normalmap,br.displacementmap,br.roughnessmap,br.metalnessmap,br.fog,br.lights,{emissive:{value:new ln(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:yr.meshphysical_vert,fragmentShader:yr.meshphysical_frag},toon:{uniforms:rr([br.common,br.aomap,br.lightmap,br.emissivemap,br.bumpmap,br.normalmap,br.displacementmap,br.gradientmap,br.fog,br.lights,{emissive:{value:new ln(0)}}]),vertexShader:yr.meshtoon_vert,fragmentShader:yr.meshtoon_frag},matcap:{uniforms:rr([br.common,br.bumpmap,br.normalmap,br.displacementmap,br.fog,{matcap:{value:null}}]),vertexShader:yr.meshmatcap_vert,fragmentShader:yr.meshmatcap_frag},points:{uniforms:rr([br.points,br.fog]),vertexShader:yr.points_vert,fragmentShader:yr.points_frag},dashed:{uniforms:rr([br.common,br.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:yr.linedashed_vert,fragmentShader:yr.linedashed_frag},depth:{uniforms:rr([br.common,br.displacementmap]),vertexShader:yr.depth_vert,fragmentShader:yr.depth_frag},normal:{uniforms:rr([br.common,br.bumpmap,br.normalmap,br.displacementmap,{opacity:{value:1}}]),vertexShader:yr.normal_vert,fragmentShader:yr.normal_frag},sprite:{uniforms:rr([br.sprite,br.fog]),vertexShader:yr.sprite_vert,fragmentShader:yr.sprite_frag},background:{uniforms:{uvTransform:{value:new Ie},t2D:{value:null}},vertexShader:yr.background_vert,fragmentShader:yr.background_frag},cube:{uniforms:rr([br.envmap,{opacity:{value:1}}]),vertexShader:yr.cube_vert,fragmentShader:yr.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:yr.equirect_vert,fragmentShader:yr.equirect_frag},distanceRGBA:{uniforms:rr([br.common,br.displacementmap,{referencePosition:{value:new De},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:yr.distanceRGBA_vert,fragmentShader:yr.distanceRGBA_frag},shadow:{uniforms:rr([br.lights,br.fog,{color:{value:new ln(0)},opacity:{value:1}}]),vertexShader:yr.shadow_vert,fragmentShader:yr.shadow_frag}};function _r(e,t,n,r,i){var o,a,s=new ln(0),c=0,u=null,l=0,d=null;function h(e,t){n.buffers.color.setClear(e.r,e.g,e.b,t,i)}return{getClearColor:function(){return s},setClearColor:function(e,t){void 0===t&&(t=1),s.set(e),h(s,c=t)},getClearAlpha:function(){return c},setClearAlpha:function(e){h(s,c=e)},render:function(n,i,f,p){var A=!0===i.isScene?i.background:null;A&&A.isTexture&&(A=t.get(A));var v=e.xr,m=v.getSession&&v.getSession();m&&"additive"===m.environmentBlendMode&&(A=null),null===A?h(s,c):A&&A.isColor&&(h(A,1),p=!0),(e.autoClear||p)&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),A&&(A.isCubeTexture||A.mapping===g)?(void 0===a&&((a=new $n(new tr(1,1,1),new or({name:"BackgroundCubeMaterial",uniforms:nr(Er.cube.uniforms),vertexShader:Er.cube.vertexShader,fragmentShader:Er.cube.fragmentShader,side:1,depthTest:!1,depthWrite:!1,fog:!1}))).geometry.deleteAttribute("normal"),a.geometry.deleteAttribute("uv"),a.onBeforeRender=function(e,t,n){this.matrixWorld.copyPosition(n.matrixWorld)},Object.defineProperty(a.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(a)),a.material.uniforms.envMap.value=A,a.material.uniforms.flipEnvMap.value=A.isCubeTexture&&A._needsFlipEnvMap?-1:1,u===A&&l===A.version&&d===e.toneMapping||(a.material.needsUpdate=!0,u=A,l=A.version,d=e.toneMapping),n.unshift(a,a.geometry,a.material,0,0,null)):A&&A.isTexture&&(void 0===o&&((o=new $n(new mr(2,2),new or({name:"BackgroundMaterial",uniforms:nr(Er.background.uniforms),vertexShader:Er.background.vertexShader,fragmentShader:Er.background.fragmentShader,side:0,depthTest:!1,depthWrite:!1,fog:!1}))).geometry.deleteAttribute("normal"),Object.defineProperty(o.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(o)),o.material.uniforms.t2D.value=A,!0===A.matrixAutoUpdate&&A.updateMatrix(),o.material.uniforms.uvTransform.value.copy(A.matrix),u===A&&l===A.version&&d===e.toneMapping||(o.material.needsUpdate=!0,u=A,l=A.version,d=e.toneMapping),n.unshift(o,o.geometry,o.material,0,0,null))}}}function wr(e,t,n,r){var i=e.getParameter(34921),o=r.isWebGL2?null:t.get("OES_vertex_array_object"),a=r.isWebGL2||null!==o,s={},c=h(null),u=c;function l(t){return r.isWebGL2?e.bindVertexArray(t):o.bindVertexArrayOES(t)}function d(t){return r.isWebGL2?e.deleteVertexArray(t):o.deleteVertexArrayOES(t)}function h(e){for(var t=[],n=[],r=[],o=0;o<i;o++)t[o]=0,n[o]=0,r[o]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:t,enabledAttributes:n,attributeDivisors:r,object:e,attributes:{},index:null}}function f(){for(var e=u.newAttributes,t=0,n=e.length;t<n;t++)e[t]=0}function p(e){A(e,0)}function A(n,i){var o=u.newAttributes,a=u.enabledAttributes,s=u.attributeDivisors;(o[n]=1,0===a[n]&&(e.enableVertexAttribArray(n),a[n]=1),s[n]!==i)&&((r.isWebGL2?e:t.get("ANGLE_instanced_arrays"))[r.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](n,i),s[n]=i)}function g(){for(var t=u.newAttributes,n=u.enabledAttributes,r=0,i=n.length;r<i;r++)n[r]!==t[r]&&(e.disableVertexAttribArray(r),n[r]=0)}function v(t,n,i,o,a,s){!0!==r.isWebGL2||5124!==i&&5125!==i?e.vertexAttribPointer(t,n,i,o,a,s):e.vertexAttribIPointer(t,n,i,a,s)}function m(){y(),u!==c&&l((u=c).object)}function y(){c.geometry=null,c.program=null,c.wireframe=!1}return{setup:function(i,c,d,m,y){var b=!1;if(a){var E=function(t,n,i){var a=!0===i.wireframe,c=s[t.id];void 0===c&&(c={},s[t.id]=c);var u=c[n.id];void 0===u&&(u={},c[n.id]=u);var l=u[a];void 0===l&&(l=h(r.isWebGL2?e.createVertexArray():o.createVertexArrayOES()),u[a]=l);return l}(m,d,c);u!==E&&l((u=E).object),(b=function(e,t){var n=u.attributes,r=e.attributes,i=0;for(var o in r){var a=n[o],s=r[o];if(void 0===a)return!0;if(a.attribute!==s)return!0;if(a.data!==s.data)return!0;i++}return u.attributesNum!==i||u.index!==t}(m,y))&&function(e,t){var n={},r=e.attributes,i=0;for(var o in r){var a=r[o],s={};s.attribute=a,a.data&&(s.data=a.data),n[o]=s,i++}u.attributes=n,u.attributesNum=i,u.index=t}(m,y)}else{var _=!0===c.wireframe;u.geometry===m.id&&u.program===d.id&&u.wireframe===_||(u.geometry=m.id,u.program=d.id,u.wireframe=_,b=!0)}!0===i.isInstancedMesh&&(b=!0),null!==y&&n.update(y,34963),b&&(!function(i,o,a,s){if(!1===r.isWebGL2&&(i.isInstancedMesh||s.isInstancedBufferGeometry)&&null===t.get("ANGLE_instanced_arrays"))return;f();var c=s.attributes,u=a.getAttributes(),l=o.defaultAttributeValues;for(var d in u){var h=u[d];if(h>=0){var m=c[d];if(void 0!==m){var y=m.normalized,b=m.itemSize,E=n.get(m);if(void 0===E)continue;var _=E.buffer,w=E.type,S=E.bytesPerElement;if(m.isInterleavedBufferAttribute){var T=m.data,R=T.stride,C=m.offset;T&&T.isInstancedInterleavedBuffer?(A(h,T.meshPerAttribute),void 0===s._maxInstanceCount&&(s._maxInstanceCount=T.meshPerAttribute*T.count)):p(h),e.bindBuffer(34962,_),v(h,b,w,y,R*S,C*S)}else m.isInstancedBufferAttribute?(A(h,m.meshPerAttribute),void 0===s._maxInstanceCount&&(s._maxInstanceCount=m.meshPerAttribute*m.count)):p(h),e.bindBuffer(34962,_),v(h,b,w,y,0,0)}else if("instanceMatrix"===d){var I=n.get(i.instanceMatrix);if(void 0===I)continue;var x=I.buffer,O=I.type;A(h+0,1),A(h+1,1),A(h+2,1),A(h+3,1),e.bindBuffer(34962,x),e.vertexAttribPointer(h+0,4,O,!1,64,0),e.vertexAttribPointer(h+1,4,O,!1,64,16),e.vertexAttribPointer(h+2,4,O,!1,64,32),e.vertexAttribPointer(h+3,4,O,!1,64,48)}else if("instanceColor"===d){var N=n.get(i.instanceColor);if(void 0===N)continue;var B=N.buffer,M=N.type;A(h,1),e.bindBuffer(34962,B),e.vertexAttribPointer(h,3,M,!1,12,0)}else if(void 0!==l){var L=l[d];if(void 0!==L)switch(L.length){case 2:e.vertexAttrib2fv(h,L);break;case 3:e.vertexAttrib3fv(h,L);break;case 4:e.vertexAttrib4fv(h,L);break;default:e.vertexAttrib1fv(h,L)}}}}g()}(i,c,d,m),null!==y&&e.bindBuffer(34963,n.get(y).buffer))},reset:m,resetDefaultState:y,dispose:function(){for(var e in m(),s){var t=s[e];for(var n in t){var r=t[n];for(var i in r)d(r[i].object),delete r[i];delete t[n]}delete s[e]}},releaseStatesOfGeometry:function(e){if(void 0!==s[e.id]){var t=s[e.id];for(var n in t){var r=t[n];for(var i in r)d(r[i].object),delete r[i];delete t[n]}delete s[e.id]}},releaseStatesOfProgram:function(e){for(var t in s){var n=s[t];if(void 0!==n[e.id]){var r=n[e.id];for(var i in r)d(r[i].object),delete r[i];delete n[e.id]}}},initAttributes:f,enableAttribute:p,disableUnusedAttributes:g}}function Sr(e,t,n,r){var i,o=r.isWebGL2;this.setMode=function(e){i=e},this.render=function(t,r){e.drawArrays(i,t,r),n.update(r,i,1)},this.renderInstances=function(r,a,s){if(0!==s){var c,u;if(o)c=e,u="drawArraysInstanced";else if(u="drawArraysInstancedANGLE",null===(c=t.get("ANGLE_instanced_arrays")))return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");c[u](i,r,a,s),n.update(a,i,s)}}}function Tr(e,t,n){var r;function i(t){if("highp"===t){if(e.getShaderPrecisionFormat(35633,36338).precision>0&&e.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";t="mediump"}return"mediump"===t&&e.getShaderPrecisionFormat(35633,36337).precision>0&&e.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}var o="undefined"!=typeof WebGL2RenderingContext&&e instanceof WebGL2RenderingContext||"undefined"!=typeof WebGL2ComputeRenderingContext&&e instanceof WebGL2ComputeRenderingContext,a=void 0!==n.precision?n.precision:"highp",s=i(a);s!==a&&(console.warn("THREE.WebGLRenderer:",a,"not supported, using",s,"instead."),a=s);var c=!0===n.logarithmicDepthBuffer,u=e.getParameter(34930),l=e.getParameter(35660),d=e.getParameter(3379),h=e.getParameter(34076),f=e.getParameter(34921),p=e.getParameter(36347),A=e.getParameter(36348),g=e.getParameter(36349),v=l>0,m=o||t.has("OES_texture_float");return{isWebGL2:o,getMaxAnisotropy:function(){if(void 0!==r)return r;if(!0===t.has("EXT_texture_filter_anisotropic")){var n=t.get("EXT_texture_filter_anisotropic");r=e.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else r=0;return r},getMaxPrecision:i,precision:a,logarithmicDepthBuffer:c,maxTextures:u,maxVertexTextures:l,maxTextureSize:d,maxCubemapSize:h,maxAttributes:f,maxVertexUniforms:p,maxVaryings:A,maxFragmentUniforms:g,vertexTextures:v,floatFragmentTextures:m,floatVertexTextures:v&&m,maxSamples:o?e.getParameter(36183):0}}function Rr(e){var t=this,n=null,r=0,i=!1,o=!1,a=new Qt,s=new Ie,c={value:null,needsUpdate:!1};function u(){c.value!==n&&(c.value=n,c.needsUpdate=r>0),t.numPlanes=r,t.numIntersection=0}function l(e,n,r,i){var o=null!==e?e.length:0,u=null;if(0!==o){if(u=c.value,!0!==i||null===u){var l=r+4*o,d=n.matrixWorldInverse;s.getNormalMatrix(d),(null===u||u.length<l)&&(u=new Float32Array(l));for(var h=0,f=r;h!==o;++h,f+=4)a.copy(e[h]).applyMatrix4(d,s),a.normal.toArray(u,f),u[f+3]=a.constant}c.value=u,c.needsUpdate=!0}return t.numPlanes=o,t.numIntersection=0,u}this.uniform=c,this.numPlanes=0,this.numIntersection=0,this.init=function(e,t,o){var a=0!==e.length||t||0!==r||i;return i=t,n=l(e,o,0),r=e.length,a},this.beginShadows=function(){o=!0,l(null)},this.endShadows=function(){o=!1,u()},this.setState=function(t,a,s){var d=t.clippingPlanes,h=t.clipIntersection,f=t.clipShadows,p=e.get(t);if(!i||null===d||0===d.length||o&&!f)o?l(null):u();else{var A=o?0:r,g=4*A,v=p.clippingState||null;c.value=v,v=l(d,a,g,s);for(var m=0;m!==g;++m)v[m]=n[m];p.clippingState=v,this.numIntersection=h?this.numPlanes:0,this.numPlanes+=A}}}function Cr(e){var t=new WeakMap;function n(e,t){return t===p?e.mapping=h:t===A&&(e.mapping=f),e}function r(e){var n=e.target;n.removeEventListener("dispose",r);var i=t.get(n);void 0!==i&&(t.delete(n),i.dispose())}return{get:function(i){if(i&&i.isTexture){var o=i.mapping;if(o===p||o===A){if(t.has(i))return n(t.get(i).texture,i.mapping);var a=i.image;if(a&&a.height>0){var s=e.getRenderTarget(),c=new dr(a.height/2);return c.fromEquirectangularTexture(e,i),t.set(i,c),e.setRenderTarget(s),i.addEventListener("dispose",r),n(c.texture,i.mapping)}return null}}return i},dispose:function(){t=new WeakMap}}}function Ir(e){var t={};function n(n){if(void 0!==t[n])return t[n];var r;switch(n){case"WEBGL_depth_texture":r=e.getExtension("WEBGL_depth_texture")||e.getExtension("MOZ_WEBGL_depth_texture")||e.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=e.getExtension("WEBGL_compressed_texture_s3tc")||e.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=e.getExtension(n)}return t[n]=r,r}return{has:function(e){return null!==n(e)},init:function(e){e.isWebGL2?n("EXT_color_buffer_float"):(n("WEBGL_depth_texture"),n("OES_texture_float"),n("OES_texture_half_float"),n("OES_texture_half_float_linear"),n("OES_standard_derivatives"),n("OES_element_index_uint"),n("OES_vertex_array_object"),n("ANGLE_instanced_arrays")),n("OES_texture_float_linear"),n("EXT_color_buffer_half_float")},get:function(e){var t=n(e);return null===t&&console.warn("THREE.WebGLRenderer: "+e+" extension not supported."),t}}}function xr(e,t,n,r){var i={},o=new WeakMap;function a(e){var s=e.target;for(var c in null!==s.index&&t.remove(s.index),s.attributes)t.remove(s.attributes[c]);s.removeEventListener("dispose",a),delete i[s.id];var u=o.get(s);u&&(t.remove(u),o.delete(s)),r.releaseStatesOfGeometry(s),!0===s.isInstancedBufferGeometry&&delete s._maxInstanceCount,n.memory.geometries--}function s(e){var n=[],r=e.index,i=e.attributes.position,a=0;if(null!==r){var s=r.array;a=r.version;for(var c=0,u=s.length;c<u;c+=3){var l=s[c+0],d=s[c+1],h=s[c+2];n.push(l,d,d,h,h,l)}}else{var f=i.array;a=i.version;for(var p=0,A=f.length/3-1;p<A;p+=3){var g=p+0,v=p+1,m=p+2;n.push(g,v,v,m,m,g)}}var y=new(Tn(n)>65535?En:yn)(n,1);y.version=a;var b=o.get(e);b&&t.remove(b),o.set(e,y)}return{get:function(e,t){return!0===i[t.id]||(t.addEventListener("dispose",a),i[t.id]=!0,n.memory.geometries++),t},update:function(e){var n=e.attributes;for(var r in n)t.update(n[r],34962);var i=e.morphAttributes;for(var o in i)for(var a=i[o],s=0,c=a.length;s<c;s++)t.update(a[s],34962)},getWireframeAttribute:function(e){var t=o.get(e);if(t){var n=e.index;null!==n&&t.version<n.version&&s(e)}else s(e);return o.get(e)}}}function Or(e,t,n,r){var i,o,a,s=r.isWebGL2;this.setMode=function(e){i=e},this.setIndex=function(e){o=e.type,a=e.bytesPerElement},this.render=function(t,r){e.drawElements(i,r,o,t*a),n.update(r,i,1)},this.renderInstances=function(r,c,u){if(0!==u){var l,d;if(s)l=e,d="drawElementsInstanced";else if(d="drawElementsInstancedANGLE",null===(l=t.get("ANGLE_instanced_arrays")))return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");l[d](i,c,o,r*a,u),n.update(c,i,u)}}}function Nr(e){var t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function(){t.frame++,t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function(e,n,r){switch(t.calls++,n){case 4:t.triangles+=r*(e/3);break;case 1:t.lines+=r*(e/2);break;case 3:t.lines+=r*(e-1);break;case 2:t.lines+=r*e;break;case 0:t.points+=r*e;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",n)}}}}function Br(e,t){return e[0]-t[0]}function Mr(e,t){return Math.abs(t[1])-Math.abs(e[1])}function Lr(e){for(var t={},n=new Float32Array(8),r=[],i=0;i<8;i++)r[i]=[i,0];return{update:function(i,o,a,s){var c=i.morphTargetInfluences,u=void 0===c?0:c.length,l=t[o.id];if(void 0===l){l=[];for(var d=0;d<u;d++)l[d]=[d,0];t[o.id]=l}for(var h=0;h<u;h++){var f=l[h];f[0]=h,f[1]=c[h]}l.sort(Mr);for(var p=0;p<8;p++)p<u&&l[p][1]?(r[p][0]=l[p][0],r[p][1]=l[p][1]):(r[p][0]=Number.MAX_SAFE_INTEGER,r[p][1]=0);r.sort(Br);for(var A=a.morphTargets&&o.morphAttributes.position,g=a.morphNormals&&o.morphAttributes.normal,v=0,m=0;m<8;m++){var y=r[m],b=y[0],E=y[1];b!==Number.MAX_SAFE_INTEGER&&E?(A&&o.getAttribute("morphTarget"+m)!==A[b]&&o.setAttribute("morphTarget"+m,A[b]),g&&o.getAttribute("morphNormal"+m)!==g[b]&&o.setAttribute("morphNormal"+m,g[b]),n[m]=E,v+=E):(A&&!0===o.hasAttribute("morphTarget"+m)&&o.deleteAttribute("morphTarget"+m),g&&!0===o.hasAttribute("morphNormal"+m)&&o.deleteAttribute("morphNormal"+m),n[m]=0)}var _=o.morphTargetsRelative?1:1-v;s.getUniforms().setValue(e,"morphTargetBaseInfluence",_),s.getUniforms().setValue(e,"morphTargetInfluences",n)}}}function kr(e,t,n,r){var i=new WeakMap;function o(e){var t=e.target;t.removeEventListener("dispose",o),n.remove(t.instanceMatrix),null!==t.instanceColor&&n.remove(t.instanceColor)}return{update:function(e){var a=r.render.frame,s=e.geometry,c=t.get(e,s);return i.get(c)!==a&&(t.update(c),i.set(c,a)),e.isInstancedMesh&&(!1===e.hasEventListener("dispose",o)&&e.addEventListener("dispose",o),n.update(e.instanceMatrix,34962),null!==e.instanceColor&&n.update(e.instanceColor,34962)),c},dispose:function(){i=new WeakMap}}}Er.physical={uniforms:rr([Er.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new Re(1,1)},clearcoatNormalMap:{value:null},sheen:{value:new ln(0)},transmission:{value:0},transmissionMap:{value:null}}]),vertexShader:yr.meshphysical_vert,fragmentShader:yr.meshphysical_frag};var Ur=function(e){function t(t,n,r,i){var o;return void 0===t&&(t=null),void 0===n&&(n=1),void 0===r&&(r=1),void 0===i&&(i=1),(o=e.call(this,null)||this).image={data:t,width:n,height:r,depth:i},o.magFilter=E,o.minFilter=E,o.wrapR=y,o.generateMipmaps=!1,o.flipY=!1,o.unpackAlignment=1,o.needsUpdate=!0,o}return i(t,e),t}(Ne);Ur.prototype.isDataTexture2DArray=!0;var Dr=function(e){function t(t,n,r,i){var o;return void 0===t&&(t=null),void 0===n&&(n=1),void 0===r&&(r=1),void 0===i&&(i=1),(o=e.call(this,null)||this).image={data:t,width:n,height:r,depth:i},o.magFilter=E,o.minFilter=E,o.wrapR=y,o.generateMipmaps=!1,o.flipY=!1,o.unpackAlignment=1,o.needsUpdate=!0,o}return i(t,e),t}(Ne);Dr.prototype.isDataTexture3D=!0;var Pr=new Ne,Fr=new Ur,Hr=new Dr,jr=new lr,Vr=[],Qr=[],Gr=new Float32Array(16),zr=new Float32Array(9),Kr=new Float32Array(4);function qr(e,t,n){var r=e[0];if(r<=0||r>0)return e;var i=t*n,o=Vr[i];if(void 0===o&&(o=new Float32Array(i),Vr[i]=o),0!==t){r.toArray(o,0);for(var a=1,s=0;a!==t;++a)s+=n,e[a].toArray(o,s)}return o}function Wr(e,t){if(e.length!==t.length)return!1;for(var n=0,r=e.length;n<r;n++)if(e[n]!==t[n])return!1;return!0}function Xr(e,t){for(var n=0,r=t.length;n<r;n++)e[n]=t[n]}function Jr(e,t){var n=Qr[t];void 0===n&&(n=new Int32Array(t),Qr[t]=n);for(var r=0;r!==t;++r)n[r]=e.allocateTextureUnit();return n}function Yr(e,t){var n=this.cache;n[0]!==t&&(e.uniform1f(this.addr,t),n[0]=t)}function Zr(e,t){var n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y||(e.uniform2f(this.addr,t.x,t.y),n[0]=t.x,n[1]=t.y);else{if(Wr(n,t))return;e.uniform2fv(this.addr,t),Xr(n,t)}}function $r(e,t){var n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z||(e.uniform3f(this.addr,t.x,t.y,t.z),n[0]=t.x,n[1]=t.y,n[2]=t.z);else if(void 0!==t.r)n[0]===t.r&&n[1]===t.g&&n[2]===t.b||(e.uniform3f(this.addr,t.r,t.g,t.b),n[0]=t.r,n[1]=t.g,n[2]=t.b);else{if(Wr(n,t))return;e.uniform3fv(this.addr,t),Xr(n,t)}}function ei(e,t){var n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z&&n[3]===t.w||(e.uniform4f(this.addr,t.x,t.y,t.z,t.w),n[0]=t.x,n[1]=t.y,n[2]=t.z,n[3]=t.w);else{if(Wr(n,t))return;e.uniform4fv(this.addr,t),Xr(n,t)}}function ti(e,t){var n=this.cache,r=t.elements;if(void 0===r){if(Wr(n,t))return;e.uniformMatrix2fv(this.addr,!1,t),Xr(n,t)}else{if(Wr(n,r))return;Kr.set(r),e.uniformMatrix2fv(this.addr,!1,Kr),Xr(n,r)}}function ni(e,t){var n=this.cache,r=t.elements;if(void 0===r){if(Wr(n,t))return;e.uniformMatrix3fv(this.addr,!1,t),Xr(n,t)}else{if(Wr(n,r))return;zr.set(r),e.uniformMatrix3fv(this.addr,!1,zr),Xr(n,r)}}function ri(e,t){var n=this.cache,r=t.elements;if(void 0===r){if(Wr(n,t))return;e.uniformMatrix4fv(this.addr,!1,t),Xr(n,t)}else{if(Wr(n,r))return;Gr.set(r),e.uniformMatrix4fv(this.addr,!1,Gr),Xr(n,r)}}function ii(e,t){var n=this.cache;n[0]!==t&&(e.uniform1i(this.addr,t),n[0]=t)}function oi(e,t){var n=this.cache;Wr(n,t)||(e.uniform2iv(this.addr,t),Xr(n,t))}function ai(e,t){var n=this.cache;Wr(n,t)||(e.uniform3iv(this.addr,t),Xr(n,t))}function si(e,t){var n=this.cache;Wr(n,t)||(e.uniform4iv(this.addr,t),Xr(n,t))}function ci(e,t){var n=this.cache;n[0]!==t&&(e.uniform1ui(this.addr,t),n[0]=t)}function ui(e,t){var n=this.cache;Wr(n,t)||(e.uniform2uiv(this.addr,t),Xr(n,t))}function li(e,t){var n=this.cache;Wr(n,t)||(e.uniform3uiv(this.addr,t),Xr(n,t))}function di(e,t){var n=this.cache;Wr(n,t)||(e.uniform4uiv(this.addr,t),Xr(n,t))}function hi(e,t,n){var r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.safeSetTexture2D(t||Pr,i)}function fi(e,t,n){var r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.setTexture3D(t||Hr,i)}function pi(e,t,n){var r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.safeSetTextureCube(t||jr,i)}function Ai(e,t,n){var r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.setTexture2DArray(t||Fr,i)}function gi(e,t){e.uniform1fv(this.addr,t)}function vi(e,t){var n=qr(t,this.size,2);e.uniform2fv(this.addr,n)}function mi(e,t){var n=qr(t,this.size,3);e.uniform3fv(this.addr,n)}function yi(e,t){var n=qr(t,this.size,4);e.uniform4fv(this.addr,n)}function bi(e,t){var n=qr(t,this.size,4);e.uniformMatrix2fv(this.addr,!1,n)}function Ei(e,t){var n=qr(t,this.size,9);e.uniformMatrix3fv(this.addr,!1,n)}function _i(e,t){var n=qr(t,this.size,16);e.uniformMatrix4fv(this.addr,!1,n)}function wi(e,t){e.uniform1iv(this.addr,t)}function Si(e,t){e.uniform2iv(this.addr,t)}function Ti(e,t){e.uniform3iv(this.addr,t)}function Ri(e,t){e.uniform4iv(this.addr,t)}function Ci(e,t){e.uniform1uiv(this.addr,t)}function Ii(e,t){e.uniform2uiv(this.addr,t)}function xi(e,t){e.uniform3uiv(this.addr,t)}function Oi(e,t){e.uniform4uiv(this.addr,t)}function Ni(e,t,n){var r=t.length,i=Jr(n,r);e.uniform1iv(this.addr,i);for(var o=0;o!==r;++o)n.safeSetTexture2D(t[o]||Pr,i[o])}function Bi(e,t,n){var r=t.length,i=Jr(n,r);e.uniform1iv(this.addr,i);for(var o=0;o!==r;++o)n.safeSetTextureCube(t[o]||jr,i[o])}function Mi(e,t,n){this.id=e,this.addr=n,this.cache=[],this.setValue=function(e){switch(e){case 5126:return Yr;case 35664:return Zr;case 35665:return $r;case 35666:return ei;case 35674:return ti;case 35675:return ni;case 35676:return ri;case 5124:case 35670:return ii;case 35667:case 35671:return oi;case 35668:case 35672:return ai;case 35669:case 35673:return si;case 5125:return ci;case 36294:return ui;case 36295:return li;case 36296:return di;case 35678:case 36198:case 36298:case 36306:case 35682:return hi;case 35679:case 36299:case 36307:return fi;case 35680:case 36300:case 36308:case 36293:return pi;case 36289:case 36303:case 36311:case 36292:return Ai}}(t.type)}function Li(e,t,n){this.id=e,this.addr=n,this.cache=[],this.size=t.size,this.setValue=function(e){switch(e){case 5126:return gi;case 35664:return vi;case 35665:return mi;case 35666:return yi;case 35674:return bi;case 35675:return Ei;case 35676:return _i;case 5124:case 35670:return wi;case 35667:case 35671:return Si;case 35668:case 35672:return Ti;case 35669:case 35673:return Ri;case 5125:return Ci;case 36294:return Ii;case 36295:return xi;case 36296:return Oi;case 35678:case 36198:case 36298:case 36306:case 35682:return Ni;case 35680:case 36300:case 36308:case 36293:return Bi}}(t.type)}function ki(e){this.id=e,this.seq=[],this.map={}}Li.prototype.updateCache=function(e){var t=this.cache;e instanceof Float32Array&&t.length!==e.length&&(this.cache=new Float32Array(e.length)),Xr(t,e)},ki.prototype.setValue=function(e,t,n){for(var r=this.seq,i=0,o=r.length;i!==o;++i){var a=r[i];a.setValue(e,t[a.id],n)}};var Ui=/(\w+)(\])?(\[|\.)?/g;function Di(e,t){e.seq.push(t),e.map[t.id]=t}function Pi(e,t,n){var r=e.name,i=r.length;for(Ui.lastIndex=0;;){var o=Ui.exec(r),a=Ui.lastIndex,s=o[1],c="]"===o[2],u=o[3];if(c&&(s|=0),void 0===u||"["===u&&a+2===i){Di(n,void 0===u?new Mi(s,e,t):new Li(s,e,t));break}var l=n.map[s];void 0===l&&Di(n,l=new ki(s)),n=l}}function Fi(e,t){this.seq=[],this.map={};for(var n=e.getProgramParameter(t,35718),r=0;r<n;++r){var i=e.getActiveUniform(t,r);Pi(i,e.getUniformLocation(t,i.name),this)}}function Hi(e,t,n){var r=e.createShader(t);return e.shaderSource(r,n),e.compileShader(r),r}Fi.prototype.setValue=function(e,t,n,r){var i=this.map[t];void 0!==i&&i.setValue(e,n,r)},Fi.prototype.setOptional=function(e,t,n){var r=t[n];void 0!==r&&this.setValue(e,n,r)},Fi.upload=function(e,t,n,r){for(var i=0,o=t.length;i!==o;++i){var a=t[i],s=n[a.id];!1!==s.needsUpdate&&a.setValue(e,s.value,r)}},Fi.seqWithValue=function(e,t){for(var n=[],r=0,i=e.length;r!==i;++r){var o=e[r];o.id in t&&n.push(o)}return n};var ji=0;function Vi(e){switch(e){case te:return["Linear","( value )"];case ne:return["sRGB","( value )"];case ie:return["RGBE","( value )"];case oe:return["RGBM","( value, 7.0 )"];case ae:return["RGBM","( value, 16.0 )"];case se:return["RGBD","( value, 256.0 )"];case re:return["Gamma","( value, float( GAMMA_FACTOR ) )"];case 3003:return["LogLuv","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",e),["Linear","( value )"]}}function Qi(e,t,n){var r=e.getShaderParameter(t,35713),i=e.getShaderInfoLog(t).trim();return r&&""===i?"":"THREE.WebGLShader: gl.getShaderInfoLog() "+n+"\n"+i+function(e){for(var t=e.split("\n"),n=0;n<t.length;n++)t[n]=n+1+": "+t[n];return t.join("\n")}(e.getShaderSource(t))}function Gi(e,t){var n=Vi(t);return"vec4 "+e+"( vec4 value ) { return "+n[0]+"ToLinear"+n[1]+"; }"}function zi(e,t){var n;switch(t){case 1:n="Linear";break;case 2:n="Reinhard";break;case 3:n="OptimizedCineon";break;case 4:n="ACESFilmic";break;case 5:n="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",t),n="Linear"}return"vec3 "+e+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}function Ki(e){return""!==e}function qi(e,t){return e.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,t.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,t.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,t.numPointLightShadows)}function Wi(e,t){return e.replace(/NUM_CLIPPING_PLANES/g,t.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,t.numClippingPlanes-t.numClipIntersection)}var Xi=/^[ \t]*#include +<([\w\d./]+)>/gm;function Ji(e){return e.replace(Xi,Yi)}function Yi(e,t){var n=yr[t];if(void 0===n)throw new Error("Can not resolve #include <"+t+">");return Ji(n)}var Zi=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,$i=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function eo(e){return e.replace($i,no).replace(Zi,to)}function to(e,t,n,r){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),no(e,t,n,r)}function no(e,t,n,r){for(var i="",o=parseInt(t);o<parseInt(n);o++)i+=r.replace(/\[\s*i\s*\]/g,"[ "+o+" ]").replace(/UNROLLED_LOOP_INDEX/g,o);return i}function ro(e){var t="precision "+e.precision+" float;\nprecision "+e.precision+" int;";return"highp"===e.precision?t+="\n#define HIGH_PRECISION":"mediump"===e.precision?t+="\n#define MEDIUM_PRECISION":"lowp"===e.precision&&(t+="\n#define LOW_PRECISION"),t}function io(e,t,n,r){var i,o,a,s,c,u=e.getContext(),l=n.defines,d=n.vertexShader,p=n.fragmentShader,A=function(e){var t="SHADOWMAP_TYPE_BASIC";return 1===e.shadowMapType?t="SHADOWMAP_TYPE_PCF":2===e.shadowMapType?t="SHADOWMAP_TYPE_PCF_SOFT":3===e.shadowMapType&&(t="SHADOWMAP_TYPE_VSM"),t}(n),m=function(e){var t="ENVMAP_TYPE_CUBE";if(e.envMap)switch(e.envMapMode){case h:case f:t="ENVMAP_TYPE_CUBE";break;case g:case v:t="ENVMAP_TYPE_CUBE_UV"}return t}(n),y=function(e){var t="ENVMAP_MODE_REFLECTION";if(e.envMap)switch(e.envMapMode){case f:case v:t="ENVMAP_MODE_REFRACTION"}return t}(n),b=function(e){var t="ENVMAP_BLENDING_NONE";if(e.envMap)switch(e.combine){case 0:t="ENVMAP_BLENDING_MULTIPLY";break;case 1:t="ENVMAP_BLENDING_MIX";break;case 2:t="ENVMAP_BLENDING_ADD"}return t}(n),E=e.gammaFactor>0?e.gammaFactor:1,_=n.isWebGL2?"":function(e){return[e.extensionDerivatives||e.envMapCubeUV||e.bumpMap||e.tangentSpaceNormalMap||e.clearcoatNormalMap||e.flatShading||"physical"===e.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(e.extensionFragDepth||e.logarithmicDepthBuffer)&&e.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",e.extensionDrawBuffers&&e.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(e.extensionShaderTextureLOD||e.envMap)&&e.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Ki).join("\n")}(n),w=function(e){var t=[];for(var n in e){var r=e[n];!1!==r&&t.push("#define "+n+" "+r)}return t.join("\n")}(l),S=u.createProgram(),T=n.glslVersion?"#version "+n.glslVersion+"\n":"";n.isRawShaderMaterial?((i=[w].filter(Ki).join("\n")).length>0&&(i+="\n"),(o=[_,w].filter(Ki).join("\n")).length>0&&(o+="\n")):(i=[ro(n),"#define SHADER_NAME "+n.shaderName,w,n.instancing?"#define USE_INSTANCING":"",n.instancingColor?"#define USE_INSTANCING_COLOR":"",n.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+E,"#define MAX_BONES "+n.maxBones,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+y:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMap&&n.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",n.normalMap&&n.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.displacementMap&&n.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUvs?"#define USE_UV":"",n.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",n.flatShading?"#define FLAT_SHADED":"",n.skinning?"#define USE_SKINNING":"",n.useVertexTexture?"#define BONE_TEXTURE":"",n.morphTargets?"#define USE_MORPHTARGETS":"",n.morphNormals&&!1===n.flatShading?"#define USE_MORPHNORMALS":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+A:"",n.sizeAttenuation?"#define USE_SIZEATTENUATION":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(Ki).join("\n"),o=[_,ro(n),"#define SHADER_NAME "+n.shaderName,w,n.alphaTest?"#define ALPHATEST "+n.alphaTest+(n.alphaTest%1?"":".0"):"","#define GAMMA_FACTOR "+E,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.matcap?"#define USE_MATCAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+m:"",n.envMap?"#define "+y:"",n.envMap?"#define "+b:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMap&&n.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",n.normalMap&&n.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.sheen?"#define USE_SHEEN":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors||n.instancingColor?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUvs?"#define USE_UV":"",n.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",n.gradientMap?"#define USE_GRADIENTMAP":"",n.flatShading?"#define FLAT_SHADED":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+A:"",n.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",n.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"",(n.extensionShaderTextureLOD||n.envMap)&&n.rendererExtensionShaderTextureLod?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",0!==n.toneMapping?"#define TONE_MAPPING":"",0!==n.toneMapping?yr.tonemapping_pars_fragment:"",0!==n.toneMapping?zi("toneMapping",n.toneMapping):"",n.dithering?"#define DITHERING":"",yr.encodings_pars_fragment,n.map?Gi("mapTexelToLinear",n.mapEncoding):"",n.matcap?Gi("matcapTexelToLinear",n.matcapEncoding):"",n.envMap?Gi("envMapTexelToLinear",n.envMapEncoding):"",n.emissiveMap?Gi("emissiveMapTexelToLinear",n.emissiveMapEncoding):"",n.lightMap?Gi("lightMapTexelToLinear",n.lightMapEncoding):"",(a="linearToOutputTexel",s=n.outputEncoding,c=Vi(s),"vec4 "+a+"( vec4 value ) { return LinearTo"+c[0]+c[1]+"; }"),n.depthPacking?"#define DEPTH_PACKING "+n.depthPacking:"","\n"].filter(Ki).join("\n")),d=Wi(d=qi(d=Ji(d),n),n),p=Wi(p=qi(p=Ji(p),n),n),d=eo(d),p=eo(p),n.isWebGL2&&!0!==n.isRawShaderMaterial&&(T="#version 300 es\n",i=["#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+i,o=["#define varying in",n.glslVersion===de?"":"out highp vec4 pc_fragColor;",n.glslVersion===de?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+o);var R,C,I=T+o+p,x=Hi(u,35633,T+i+d),O=Hi(u,35632,I);if(u.attachShader(S,x),u.attachShader(S,O),void 0!==n.index0AttributeName?u.bindAttribLocation(S,0,n.index0AttributeName):!0===n.morphTargets&&u.bindAttribLocation(S,0,"position"),u.linkProgram(S),e.debug.checkShaderErrors){var N=u.getProgramInfoLog(S).trim(),B=u.getShaderInfoLog(x).trim(),M=u.getShaderInfoLog(O).trim(),L=!0,k=!0;if(!1===u.getProgramParameter(S,35714)){L=!1;var U=Qi(u,x,"vertex"),D=Qi(u,O,"fragment");console.error("THREE.WebGLProgram: shader error: ",u.getError(),"35715",u.getProgramParameter(S,35715),"gl.getProgramInfoLog",N,U,D)}else""!==N?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",N):""!==B&&""!==M||(k=!1);k&&(this.diagnostics={runnable:L,programLog:N,vertexShader:{log:B,prefix:i},fragmentShader:{log:M,prefix:o}})}return u.deleteShader(x),u.deleteShader(O),this.getUniforms=function(){return void 0===R&&(R=new Fi(u,S)),R},this.getAttributes=function(){return void 0===C&&(C=function(e,t){for(var n={},r=e.getProgramParameter(t,35721),i=0;i<r;i++){var o=e.getActiveAttrib(t,i).name;n[o]=e.getAttribLocation(t,o)}return n}(u,S)),C},this.destroy=function(){r.releaseStatesOfProgram(this),u.deleteProgram(S),this.program=void 0},this.name=n.shaderName,this.id=ji++,this.cacheKey=t,this.usedTimes=1,this.program=S,this.vertexShader=x,this.fragmentShader=O,this}function oo(e,t,n,r,i,o){var a=[],s=r.isWebGL2,c=r.logarithmicDepthBuffer,u=r.floatVertexTextures,l=r.maxVertexUniforms,d=r.vertexTextures,h=r.precision,f={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"},p=["precision","isWebGL2","supportsVertexTextures","outputEncoding","instancing","instancingColor","map","mapEncoding","matcap","matcapEncoding","envMap","envMapMode","envMapEncoding","envMapCubeUV","lightMap","lightMapEncoding","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","objectSpaceNormalMap","tangentSpaceNormalMap","clearcoatMap","clearcoatRoughnessMap","clearcoatNormalMap","displacementMap","specularMap","roughnessMap","metalnessMap","gradientMap","alphaMap","combine","vertexColors","vertexAlphas","vertexTangents","vertexUvs","uvsVertexOnly","fog","useFog","fogExp2","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","numDirLightShadows","numPointLightShadows","numSpotLightShadows","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","alphaTest","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering","sheen","transmissionMap"];function A(e){var t;return e&&e.isTexture?t=e.encoding:e&&e.isWebGLRenderTarget?(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),t=e.texture.encoding):t=te,t}return{getParameters:function(i,a,p,m,y){var b,E,_=m.fog,w=i.isMeshStandardMaterial?m.environment:null,S=t.get(i.envMap||w),T=f[i.type],R=y.isSkinnedMesh?function(e){var t=e.skeleton.bones;if(u)return 1024;var n=l,r=Math.floor((n-20)/4),i=Math.min(r,t.length);return i<t.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+t.length+" bones. This GPU supports "+i+"."),0):i}(y):0;if(null!==i.precision&&(h=r.getMaxPrecision(i.precision))!==i.precision&&console.warn("THREE.WebGLProgram.getParameters:",i.precision,"not supported, using",h,"instead."),T){var C=Er[T];b=C.vertexShader,E=C.fragmentShader}else b=i.vertexShader,E=i.fragmentShader;var I=e.getRenderTarget();return{isWebGL2:s,shaderID:T,shaderName:i.type,vertexShader:b,fragmentShader:E,defines:i.defines,isRawShaderMaterial:!0===i.isRawShaderMaterial,glslVersion:i.glslVersion,precision:h,instancing:!0===y.isInstancedMesh,instancingColor:!0===y.isInstancedMesh&&null!==y.instanceColor,supportsVertexTextures:d,outputEncoding:null!==I?A(I.texture):e.outputEncoding,map:!!i.map,mapEncoding:A(i.map),matcap:!!i.matcap,matcapEncoding:A(i.matcap),envMap:!!S,envMapMode:S&&S.mapping,envMapEncoding:A(S),envMapCubeUV:!!S&&(S.mapping===g||S.mapping===v),lightMap:!!i.lightMap,lightMapEncoding:A(i.lightMap),aoMap:!!i.aoMap,emissiveMap:!!i.emissiveMap,emissiveMapEncoding:A(i.emissiveMap),bumpMap:!!i.bumpMap,normalMap:!!i.normalMap,objectSpaceNormalMap:1===i.normalMapType,tangentSpaceNormalMap:0===i.normalMapType,clearcoatMap:!!i.clearcoatMap,clearcoatRoughnessMap:!!i.clearcoatRoughnessMap,clearcoatNormalMap:!!i.clearcoatNormalMap,displacementMap:!!i.displacementMap,roughnessMap:!!i.roughnessMap,metalnessMap:!!i.metalnessMap,specularMap:!!i.specularMap,alphaMap:!!i.alphaMap,gradientMap:!!i.gradientMap,sheen:!!i.sheen,transmissionMap:!!i.transmissionMap,combine:i.combine,vertexTangents:i.normalMap&&i.vertexTangents,vertexColors:i.vertexColors,vertexAlphas:!0===i.vertexColors&&y.geometry&&y.geometry.attributes.color&&4===y.geometry.attributes.color.itemSize,vertexUvs:!!(i.map||i.bumpMap||i.normalMap||i.specularMap||i.alphaMap||i.emissiveMap||i.roughnessMap||i.metalnessMap||i.clearcoatMap||i.clearcoatRoughnessMap||i.clearcoatNormalMap||i.displacementMap||i.transmissionMap),uvsVertexOnly:!(i.map||i.bumpMap||i.normalMap||i.specularMap||i.alphaMap||i.emissiveMap||i.roughnessMap||i.metalnessMap||i.clearcoatNormalMap||i.transmissionMap||!i.displacementMap),fog:!!_,useFog:i.fog,fogExp2:_&&_.isFogExp2,flatShading:!!i.flatShading,sizeAttenuation:i.sizeAttenuation,logarithmicDepthBuffer:c,skinning:i.skinning&&R>0,maxBones:R,useVertexTexture:u,morphTargets:i.morphTargets,morphNormals:i.morphNormals,numDirLights:a.directional.length,numPointLights:a.point.length,numSpotLights:a.spot.length,numRectAreaLights:a.rectArea.length,numHemiLights:a.hemi.length,numDirLightShadows:a.directionalShadowMap.length,numPointLightShadows:a.pointShadowMap.length,numSpotLightShadows:a.spotShadowMap.length,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:i.dithering,shadowMapEnabled:e.shadowMap.enabled&&p.length>0,shadowMapType:e.shadowMap.type,toneMapping:i.toneMapped?e.toneMapping:0,physicallyCorrectLights:e.physicallyCorrectLights,premultipliedAlpha:i.premultipliedAlpha,alphaTest:i.alphaTest,doubleSided:2===i.side,flipSided:1===i.side,depthPacking:void 0!==i.depthPacking&&i.depthPacking,index0AttributeName:i.index0AttributeName,extensionDerivatives:i.extensions&&i.extensions.derivatives,extensionFragDepth:i.extensions&&i.extensions.fragDepth,extensionDrawBuffers:i.extensions&&i.extensions.drawBuffers,extensionShaderTextureLOD:i.extensions&&i.extensions.shaderTextureLOD,rendererExtensionFragDepth:s||n.has("EXT_frag_depth"),rendererExtensionDrawBuffers:s||n.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:s||n.has("EXT_shader_texture_lod"),customProgramCacheKey:i.customProgramCacheKey()}},getProgramCacheKey:function(t){var n=[];if(t.shaderID?n.push(t.shaderID):(n.push(t.fragmentShader),n.push(t.vertexShader)),void 0!==t.defines)for(var r in t.defines)n.push(r),n.push(t.defines[r]);if(!1===t.isRawShaderMaterial){for(var i=0;i<p.length;i++)n.push(t[p[i]]);n.push(e.outputEncoding),n.push(e.gammaFactor)}return n.push(t.customProgramCacheKey),n.join()},getUniforms:function(e){var t,n=f[e.type];if(n){var r=Er[n];t=ir.clone(r.uniforms)}else t=e.uniforms;return t},acquireProgram:function(t,n){for(var r,o=0,s=a.length;o<s;o++){var c=a[o];if(c.cacheKey===n){++(r=c).usedTimes;break}}return void 0===r&&(r=new io(e,n,t,i),a.push(r)),r},releaseProgram:function(e){if(0==--e.usedTimes){var t=a.indexOf(e);a[t]=a[a.length-1],a.pop(),e.destroy()}},programs:a}}function ao(){var e=new WeakMap;return{get:function(t){var n=e.get(t);return void 0===n&&(n={},e.set(t,n)),n},remove:function(t){e.delete(t)},update:function(t,n,r){e.get(t)[n]=r},dispose:function(){e=new WeakMap}}}function so(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.program!==t.program?e.program.id-t.program.id:e.material.id!==t.material.id?e.material.id-t.material.id:e.z!==t.z?e.z-t.z:e.id-t.id}function co(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:e.id-t.id}function uo(e){var t=[],n=0,r=[],i=[],o={id:-1};function a(r,i,a,s,c,u){var l=t[n],d=e.get(a);return void 0===l?(l={id:r.id,object:r,geometry:i,material:a,program:d.program||o,groupOrder:s,renderOrder:r.renderOrder,z:c,group:u},t[n]=l):(l.id=r.id,l.object=r,l.geometry=i,l.material=a,l.program=d.program||o,l.groupOrder=s,l.renderOrder=r.renderOrder,l.z=c,l.group=u),n++,l}return{opaque:r,transparent:i,init:function(){n=0,r.length=0,i.length=0},push:function(e,t,n,o,s,c){var u=a(e,t,n,o,s,c);(!0===n.transparent?i:r).push(u)},unshift:function(e,t,n,o,s,c){var u=a(e,t,n,o,s,c);(!0===n.transparent?i:r).unshift(u)},finish:function(){for(var e=n,r=t.length;e<r;e++){var i=t[e];if(null===i.id)break;i.id=null,i.object=null,i.geometry=null,i.material=null,i.program=null,i.group=null}},sort:function(e,t){r.length>1&&r.sort(e||so),i.length>1&&i.sort(t||co)}}}function lo(e){var t=new WeakMap;return{get:function(n,r){var i;return!1===t.has(n)?(i=new uo(e),t.set(n,[i])):r>=t.get(n).length?(i=new uo(e),t.get(n).push(i)):i=t.get(n)[r],i},dispose:function(){t=new WeakMap}}}function ho(){var e={};return{get:function(t){if(void 0!==e[t.id])return e[t.id];var n;switch(t.type){case"DirectionalLight":n={direction:new De,color:new ln};break;case"SpotLight":n={position:new De,direction:new De,color:new ln,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":n={position:new De,color:new ln,distance:0,decay:0};break;case"HemisphereLight":n={direction:new De,skyColor:new ln,groundColor:new ln};break;case"RectAreaLight":n={color:new ln,position:new De,halfWidth:new De,halfHeight:new De}}return e[t.id]=n,n}}}var fo=0;function po(e,t){return(t.castShadow?1:0)-(e.castShadow?1:0)}function Ao(e,t){for(var n,r=new ho,i=(n={},{get:function(e){if(void 0!==n[e.id])return n[e.id];var t;switch(e.type){case"DirectionalLight":case"SpotLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Re};break;case"PointLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Re,shadowCameraNear:1,shadowCameraFar:1e3}}return n[e.id]=t,t}}),o={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]},a=0;a<9;a++)o.probe.push(new De);var s=new De,c=new pt,u=new pt;return{setup:function(n){for(var a=0,s=0,c=0,u=0;u<9;u++)o.probe[u].set(0,0,0);var l=0,d=0,h=0,f=0,p=0,A=0,g=0,v=0;n.sort(po);for(var m=0,y=n.length;m<y;m++){var b=n[m],E=b.color,_=b.intensity,w=b.distance,S=b.shadow&&b.shadow.map?b.shadow.map.texture:null;if(b.isAmbientLight)a+=E.r*_,s+=E.g*_,c+=E.b*_;else if(b.isLightProbe)for(var T=0;T<9;T++)o.probe[T].addScaledVector(b.sh.coefficients[T],_);else if(b.isDirectionalLight){var R=r.get(b);if(R.color.copy(b.color).multiplyScalar(b.intensity),b.castShadow){var C=b.shadow,I=i.get(b);I.shadowBias=C.bias,I.shadowNormalBias=C.normalBias,I.shadowRadius=C.radius,I.shadowMapSize=C.mapSize,o.directionalShadow[l]=I,o.directionalShadowMap[l]=S,o.directionalShadowMatrix[l]=b.shadow.matrix,A++}o.directional[l]=R,l++}else if(b.isSpotLight){var x=r.get(b);if(x.position.setFromMatrixPosition(b.matrixWorld),x.color.copy(E).multiplyScalar(_),x.distance=w,x.coneCos=Math.cos(b.angle),x.penumbraCos=Math.cos(b.angle*(1-b.penumbra)),x.decay=b.decay,b.castShadow){var O=b.shadow,N=i.get(b);N.shadowBias=O.bias,N.shadowNormalBias=O.normalBias,N.shadowRadius=O.radius,N.shadowMapSize=O.mapSize,o.spotShadow[h]=N,o.spotShadowMap[h]=S,o.spotShadowMatrix[h]=b.shadow.matrix,v++}o.spot[h]=x,h++}else if(b.isRectAreaLight){var B=r.get(b);B.color.copy(E).multiplyScalar(_),B.halfWidth.set(.5*b.width,0,0),B.halfHeight.set(0,.5*b.height,0),o.rectArea[f]=B,f++}else if(b.isPointLight){var M=r.get(b);if(M.color.copy(b.color).multiplyScalar(b.intensity),M.distance=b.distance,M.decay=b.decay,b.castShadow){var L=b.shadow,k=i.get(b);k.shadowBias=L.bias,k.shadowNormalBias=L.normalBias,k.shadowRadius=L.radius,k.shadowMapSize=L.mapSize,k.shadowCameraNear=L.camera.near,k.shadowCameraFar=L.camera.far,o.pointShadow[d]=k,o.pointShadowMap[d]=S,o.pointShadowMatrix[d]=b.shadow.matrix,g++}o.point[d]=M,d++}else if(b.isHemisphereLight){var U=r.get(b);U.skyColor.copy(b.color).multiplyScalar(_),U.groundColor.copy(b.groundColor).multiplyScalar(_),o.hemi[p]=U,p++}}f>0&&(t.isWebGL2||!0===e.has("OES_texture_float_linear")?(o.rectAreaLTC1=br.LTC_FLOAT_1,o.rectAreaLTC2=br.LTC_FLOAT_2):!0===e.has("OES_texture_half_float_linear")?(o.rectAreaLTC1=br.LTC_HALF_1,o.rectAreaLTC2=br.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),o.ambient[0]=a,o.ambient[1]=s,o.ambient[2]=c;var D=o.hash;D.directionalLength===l&&D.pointLength===d&&D.spotLength===h&&D.rectAreaLength===f&&D.hemiLength===p&&D.numDirectionalShadows===A&&D.numPointShadows===g&&D.numSpotShadows===v||(o.directional.length=l,o.spot.length=h,o.rectArea.length=f,o.point.length=d,o.hemi.length=p,o.directionalShadow.length=A,o.directionalShadowMap.length=A,o.pointShadow.length=g,o.pointShadowMap.length=g,o.spotShadow.length=v,o.spotShadowMap.length=v,o.directionalShadowMatrix.length=A,o.pointShadowMatrix.length=g,o.spotShadowMatrix.length=v,D.directionalLength=l,D.pointLength=d,D.spotLength=h,D.rectAreaLength=f,D.hemiLength=p,D.numDirectionalShadows=A,D.numPointShadows=g,D.numSpotShadows=v,o.version=fo++)},setupView:function(e,t){for(var n=0,r=0,i=0,a=0,l=0,d=t.matrixWorldInverse,h=0,f=e.length;h<f;h++){var p=e[h];if(p.isDirectionalLight){var A=o.directional[n];A.direction.setFromMatrixPosition(p.matrixWorld),s.setFromMatrixPosition(p.target.matrixWorld),A.direction.sub(s),A.direction.transformDirection(d),n++}else if(p.isSpotLight){var g=o.spot[i];g.position.setFromMatrixPosition(p.matrixWorld),g.position.applyMatrix4(d),g.direction.setFromMatrixPosition(p.matrixWorld),s.setFromMatrixPosition(p.target.matrixWorld),g.direction.sub(s),g.direction.transformDirection(d),i++}else if(p.isRectAreaLight){var v=o.rectArea[a];v.position.setFromMatrixPosition(p.matrixWorld),v.position.applyMatrix4(d),u.identity(),c.copy(p.matrixWorld),c.premultiply(d),u.extractRotation(c),v.halfWidth.set(.5*p.width,0,0),v.halfHeight.set(0,.5*p.height,0),v.halfWidth.applyMatrix4(u),v.halfHeight.applyMatrix4(u),a++}else if(p.isPointLight){var m=o.point[r];m.position.setFromMatrixPosition(p.matrixWorld),m.position.applyMatrix4(d),r++}else if(p.isHemisphereLight){var y=o.hemi[l];y.direction.setFromMatrixPosition(p.matrixWorld),y.direction.transformDirection(d),y.direction.normalize(),l++}}},state:o}}function go(e,t){var n=new Ao(e,t),r=[],i=[];return{init:function(){r.length=0,i.length=0},state:{lightsArray:r,shadowsArray:i,lights:n},setupLights:function(){n.setup(r)},setupLightsView:function(e){n.setupView(r,e)},pushLight:function(e){r.push(e)},pushShadow:function(e){i.push(e)}}}function vo(e,t){var n=new WeakMap;return{get:function(r,i){var o;return void 0===i&&(i=0),!1===n.has(r)?(o=new go(e,t),n.set(r,[o])):i>=n.get(r).length?(o=new go(e,t),n.get(r).push(o)):o=n.get(r)[i],o},dispose:function(){n=new WeakMap}}}var mo=function(e){function t(t){var n;return(n=e.call(this)||this).type="MeshDepthMaterial",n.depthPacking=3200,n.skinning=!1,n.morphTargets=!1,n.map=null,n.alphaMap=null,n.displacementMap=null,n.displacementScale=1,n.displacementBias=0,n.wireframe=!1,n.wireframeLinewidth=1,n.fog=!1,n.setValues(t),n}return i(t,e),t.prototype.copy=function(t){return e.prototype.copy.call(this,t),this.depthPacking=t.depthPacking,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this},t}(nn);mo.prototype.isMeshDepthMaterial=!0;var yo=function(e){function t(t){var n;return(n=e.call(this)||this).type="MeshDistanceMaterial",n.referencePosition=new De,n.nearDistance=1,n.farDistance=1e3,n.skinning=!1,n.morphTargets=!1,n.map=null,n.alphaMap=null,n.displacementMap=null,n.displacementScale=1,n.displacementBias=0,n.fog=!1,n.setValues(t),n}return i(t,e),t.prototype.copy=function(t){return e.prototype.copy.call(this,t),this.referencePosition.copy(t.referencePosition),this.nearDistance=t.nearDistance,this.farDistance=t.farDistance,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this},t}(nn);yo.prototype.isMeshDistanceMaterial=!0;function bo(e,t,n){var r=new Ar,i=new Re,o=new Re,a=new Me,s=[],c=[],u={},l=n.maxTextureSize,d={0:1,1:0,2:2},h=new or({defines:{SAMPLE_RATE:2/8,HALF_SAMPLE_RATE:1/8},uniforms:{shadow_pass:{value:null},resolution:{value:new Re},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy ) / resolution ) );\n\tfor ( float i = -1.0; i < 1.0 ; i += SAMPLE_RATE) {\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( i, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, i ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean * HALF_SAMPLE_RATE;\n\tsquared_mean = squared_mean * HALF_SAMPLE_RATE;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),f=h.clone();f.defines.HORIZONTAL_PASS=1;var p=new kn;p.setAttribute("position",new pn(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));var A=new $n(p,h),g=this;function v(n,r){var i=t.update(A);h.uniforms.shadow_pass.value=n.map.texture,h.uniforms.resolution.value=n.mapSize,h.uniforms.radius.value=n.radius,e.setRenderTarget(n.mapPass),e.clear(),e.renderBufferDirect(r,null,i,h,A,null),f.uniforms.shadow_pass.value=n.mapPass.texture,f.uniforms.resolution.value=n.mapSize,f.uniforms.radius.value=n.radius,e.setRenderTarget(n.map),e.clear(),e.renderBufferDirect(r,null,i,f,A,null)}function m(e,t,n){var r=e<<0|t<<1|n<<2,i=s[r];return void 0===i&&(i=new mo({depthPacking:3201,morphTargets:e,skinning:t}),s[r]=i),i}function y(e,t,n){var r=e<<0|t<<1|n<<2,i=c[r];return void 0===i&&(i=new yo({morphTargets:e,skinning:t}),c[r]=i),i}function b(t,n,r,i,o,a,s){var c=null,l=m,h=t.customDepthMaterial;if(!0===i.isPointLight&&(l=y,h=t.customDistanceMaterial),void 0===h){var f=!1;!0===r.morphTargets&&(f=n.morphAttributes&&n.morphAttributes.position&&n.morphAttributes.position.length>0);var p=!1;!0===t.isSkinnedMesh&&(!0===r.skinning?p=!0:console.warn("THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:",t)),c=l(f,p,!0===t.isInstancedMesh)}else c=h;if(e.localClippingEnabled&&!0===r.clipShadows&&0!==r.clippingPlanes.length){var A=c.uuid,g=r.uuid,v=u[A];void 0===v&&(v={},u[A]=v);var b=v[g];void 0===b&&(b=c.clone(),v[g]=b),c=b}return c.visible=r.visible,c.wireframe=r.wireframe,c.side=3===s?null!==r.shadowSide?r.shadowSide:r.side:null!==r.shadowSide?r.shadowSide:d[r.side],c.clipShadows=r.clipShadows,c.clippingPlanes=r.clippingPlanes,c.clipIntersection=r.clipIntersection,c.wireframeLinewidth=r.wireframeLinewidth,c.linewidth=r.linewidth,!0===i.isPointLight&&!0===c.isMeshDistanceMaterial&&(c.referencePosition.setFromMatrixPosition(i.matrixWorld),c.nearDistance=o,c.farDistance=a),c}function _(n,i,o,a,s){if(!1!==n.visible){if(n.layers.test(i.layers)&&(n.isMesh||n.isLine||n.isPoints)&&(n.castShadow||n.receiveShadow&&3===s)&&(!n.frustumCulled||r.intersectsObject(n))){n.modelViewMatrix.multiplyMatrices(o.matrixWorldInverse,n.matrixWorld);var c=t.update(n),u=n.material;if(Array.isArray(u))for(var l=c.groups,d=0,h=l.length;d<h;d++){var f=l[d],p=u[f.materialIndex];if(p&&p.visible){var A=b(n,c,p,a,o.near,o.far,s);e.renderBufferDirect(o,null,c,A,n,f)}}else if(u.visible){var g=b(n,c,u,a,o.near,o.far,s);e.renderBufferDirect(o,null,c,g,n,null)}}for(var v=n.children,m=0,y=v.length;m<y;m++)_(v[m],i,o,a,s)}}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=1,this.render=function(t,n,s){if(!1!==g.enabled&&(!1!==g.autoUpdate||!1!==g.needsUpdate)&&0!==t.length){var c=e.getRenderTarget(),u=e.getActiveCubeFace(),d=e.getActiveMipmapLevel(),h=e.state;h.setBlending(0),h.buffers.color.setClear(1,1,1,1),h.buffers.depth.setTest(!0),h.setScissorTest(!1);for(var f=0,p=t.length;f<p;f++){var A=t[f],m=A.shadow;if(void 0!==m){if(!1!==m.autoUpdate||!1!==m.needsUpdate){i.copy(m.mapSize);var y=m.getFrameExtents();if(i.multiply(y),o.copy(m.mapSize),(i.x>l||i.y>l)&&(i.x>l&&(o.x=Math.floor(l/y.x),i.x=o.x*y.x,m.mapSize.x=o.x),i.y>l&&(o.y=Math.floor(l/y.y),i.y=o.y*y.y,m.mapSize.y=o.y)),null===m.map&&!m.isPointLightShadow&&3===this.type){var b={minFilter:S,magFilter:S,format:L};m.map=new Le(i.x,i.y,b),m.map.texture.name=A.name+".shadowMap",m.mapPass=new Le(i.x,i.y,b),m.camera.updateProjectionMatrix()}if(null===m.map){var w={minFilter:E,magFilter:E,format:L};m.map=new Le(i.x,i.y,w),m.map.texture.name=A.name+".shadowMap",m.camera.updateProjectionMatrix()}e.setRenderTarget(m.map),e.clear();for(var T=m.getViewportCount(),R=0;R<T;R++){var C=m.getViewport(R);a.set(o.x*C.x,o.y*C.y,o.x*C.z,o.y*C.w),h.viewport(a),m.updateMatrices(A,R),r=m.getFrustum(),_(n,s,m.camera,A,this.type)}m.isPointLightShadow||3!==this.type||v(m,s),m.needsUpdate=!1}}else console.warn("THREE.WebGLShadowMap:",A,"has no shadow.")}g.needsUpdate=!1,e.setRenderTarget(c,u,d)}}}function Eo(e,t,n){var r,i,o=n.isWebGL2;var a=new function(){var t=!1,n=new Me,r=null,i=new Me(0,0,0,0);return{setMask:function(n){r===n||t||(e.colorMask(n,n,n,n),r=n)},setLocked:function(e){t=e},setClear:function(t,r,o,a,s){!0===s&&(t*=a,r*=a,o*=a),n.set(t,r,o,a),!1===i.equals(n)&&(e.clearColor(t,r,o,a),i.copy(n))},reset:function(){t=!1,r=null,i.set(-1,0,0,0)}}},s=new function(){var t=!1,n=null,r=null,i=null;return{setTest:function(e){e?P(2929):F(2929)},setMask:function(r){n===r||t||(e.depthMask(r),n=r)},setFunc:function(t){if(r!==t){if(t)switch(t){case 0:e.depthFunc(512);break;case 1:e.depthFunc(519);break;case 2:e.depthFunc(513);break;case 3:e.depthFunc(515);break;case 4:e.depthFunc(514);break;case 5:e.depthFunc(518);break;case 6:e.depthFunc(516);break;case 7:e.depthFunc(517);break;default:e.depthFunc(515)}else e.depthFunc(515);r=t}},setLocked:function(e){t=e},setClear:function(t){i!==t&&(e.clearDepth(t),i=t)},reset:function(){t=!1,n=null,r=null,i=null}}},c=new function(){var t=!1,n=null,r=null,i=null,o=null,a=null,s=null,c=null,u=null;return{setTest:function(e){t||(e?P(2960):F(2960))},setMask:function(r){n===r||t||(e.stencilMask(r),n=r)},setFunc:function(t,n,a){r===t&&i===n&&o===a||(e.stencilFunc(t,n,a),r=t,i=n,o=a)},setOp:function(t,n,r){a===t&&s===n&&c===r||(e.stencilOp(t,n,r),a=t,s=n,c=r)},setLocked:function(e){t=e},setClear:function(t){u!==t&&(e.clearStencil(t),u=t)},reset:function(){t=!1,n=null,r=null,i=null,o=null,a=null,s=null,c=null,u=null}}},u={},d=null,h={},f=null,p=!1,A=null,g=null,v=null,m=null,y=null,b=null,E=null,_=!1,w=null,S=null,T=null,R=null,C=null,I=e.getParameter(35661),x=!1,O=0,N=e.getParameter(7938);-1!==N.indexOf("WebGL")?(O=parseFloat(/^WebGL (\d)/.exec(N)[1]),x=O>=1):-1!==N.indexOf("OpenGL ES")&&(O=parseFloat(/^OpenGL ES (\d)/.exec(N)[1]),x=O>=2);var B=null,M={},L=new Me(0,0,e.canvas.width,e.canvas.height),k=new Me(0,0,e.canvas.width,e.canvas.height);function U(t,n,r){var i=new Uint8Array(4),o=e.createTexture();e.bindTexture(t,o),e.texParameteri(t,10241,9728),e.texParameteri(t,10240,9728);for(var a=0;a<r;a++)e.texImage2D(n+a,0,6408,1,1,0,6408,5121,i);return o}var D={};function P(t){!0!==u[t]&&(e.enable(t),u[t]=!0)}function F(t){!1!==u[t]&&(e.disable(t),u[t]=!1)}D[3553]=U(3553,3553,1),D[34067]=U(34067,34069,6),a.setClear(0,0,0,1),s.setClear(1),c.setClear(0),P(2929),s.setFunc(3),G(!1),z(1),P(2884),Q(0);var H=((r={})[100]=32774,r[101]=32778,r[102]=32779,r);if(o)H[103]=32775,H[104]=32776;else{var j=t.get("EXT_blend_minmax");null!==j&&(H[103]=j.MIN_EXT,H[104]=j.MAX_EXT)}var V=((i={})[200]=0,i[201]=1,i[202]=768,i[204]=770,i[210]=776,i[208]=774,i[206]=772,i[203]=769,i[205]=771,i[209]=775,i[207]=773,i);function Q(t,n,r,i,o,a,s,c){if(0!==t){if(!1===p&&(P(3042),p=!0),5===t)o=o||n,a=a||r,s=s||i,n===g&&o===y||(e.blendEquationSeparate(H[n],H[o]),g=n,y=o),r===v&&i===m&&a===b&&s===E||(e.blendFuncSeparate(V[r],V[i],V[a],V[s]),v=r,m=i,b=a,E=s),A=t,_=null;else if(t!==A||c!==_){if(g===l&&y===l||(e.blendEquation(32774),g=l,y=l),c)switch(t){case 1:e.blendFuncSeparate(1,771,1,771);break;case 2:e.blendFunc(1,1);break;case 3:e.blendFuncSeparate(0,0,769,771);break;case 4:e.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",t)}else switch(t){case 1:e.blendFuncSeparate(770,771,1,771);break;case 2:e.blendFunc(770,1);break;case 3:e.blendFunc(0,769);break;case 4:e.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",t)}v=null,m=null,b=null,E=null,A=t,_=c}}else!0===p&&(F(3042),p=!1)}function G(t){w!==t&&(t?e.frontFace(2304):e.frontFace(2305),w=t)}function z(t){0!==t?(P(2884),t!==S&&(1===t?e.cullFace(1029):2===t?e.cullFace(1028):e.cullFace(1032))):F(2884),S=t}function K(t,n,r){t?(P(32823),R===n&&C===r||(e.polygonOffset(n,r),R=n,C=r)):F(32823)}function q(t){void 0===t&&(t=33984+I-1),B!==t&&(e.activeTexture(t),B=t)}return{buffers:{color:a,depth:s,stencil:c},enable:P,disable:F,bindFramebuffer:function(t,n){null===n&&null!==d&&(n=d),h[t]!==n&&(e.bindFramebuffer(t,n),h[t]=n,o&&(36009===t&&(h[36160]=n),36160===t&&(h[36009]=n)))},bindXRFramebuffer:function(t){t!==d&&(e.bindFramebuffer(36160,t),d=t)},useProgram:function(t){return f!==t&&(e.useProgram(t),f=t,!0)},setBlending:Q,setMaterial:function(e,t){2===e.side?F(2884):P(2884);var n=1===e.side;t&&(n=!n),G(n),1===e.blending&&!1===e.transparent?Q(0):Q(e.blending,e.blendEquation,e.blendSrc,e.blendDst,e.blendEquationAlpha,e.blendSrcAlpha,e.blendDstAlpha,e.premultipliedAlpha),s.setFunc(e.depthFunc),s.setTest(e.depthTest),s.setMask(e.depthWrite),a.setMask(e.colorWrite);var r=e.stencilWrite;c.setTest(r),r&&(c.setMask(e.stencilWriteMask),c.setFunc(e.stencilFunc,e.stencilRef,e.stencilFuncMask),c.setOp(e.stencilFail,e.stencilZFail,e.stencilZPass)),K(e.polygonOffset,e.polygonOffsetFactor,e.polygonOffsetUnits),!0===e.alphaToCoverage?P(32926):F(32926)},setFlipSided:G,setCullFace:z,setLineWidth:function(t){t!==T&&(x&&e.lineWidth(t),T=t)},setPolygonOffset:K,setScissorTest:function(e){e?P(3089):F(3089)},activeTexture:q,bindTexture:function(t,n){null===B&&q();var r=M[B];void 0===r&&(r={type:void 0,texture:void 0},M[B]=r),r.type===t&&r.texture===n||(e.bindTexture(t,n||D[t]),r.type=t,r.texture=n)},unbindTexture:function(){var t=M[B];void 0!==t&&void 0!==t.type&&(e.bindTexture(t.type,null),t.type=void 0,t.texture=void 0)},compressedTexImage2D:function(){try{e.compressedTexImage2D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texImage2D:function(){try{e.texImage2D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texImage3D:function(){try{e.texImage3D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},scissor:function(t){!1===L.equals(t)&&(e.scissor(t.x,t.y,t.z,t.w),L.copy(t))},viewport:function(t){!1===k.equals(t)&&(e.viewport(t.x,t.y,t.z,t.w),k.copy(t))},reset:function(){e.disable(3042),e.disable(2884),e.disable(2929),e.disable(32823),e.disable(3089),e.disable(2960),e.disable(32926),e.blendEquation(32774),e.blendFunc(1,0),e.blendFuncSeparate(1,0,1,0),e.colorMask(!0,!0,!0,!0),e.clearColor(0,0,0,0),e.depthMask(!0),e.depthFunc(513),e.clearDepth(1),e.stencilMask(4294967295),e.stencilFunc(519,0,4294967295),e.stencilOp(7680,7680,7680),e.clearStencil(0),e.cullFace(1029),e.frontFace(2305),e.polygonOffset(0,0),e.activeTexture(33984),e.bindFramebuffer(36160,null),!0===o&&(e.bindFramebuffer(36009,null),e.bindFramebuffer(36008,null)),e.useProgram(null),e.lineWidth(1),e.scissor(0,0,e.canvas.width,e.canvas.height),e.viewport(0,0,e.canvas.width,e.canvas.height),u={},B=null,M={},d=null,h={},f=null,p=!1,A=null,g=null,v=null,m=null,y=null,b=null,E=null,_=!1,w=null,S=null,T=null,R=null,C=null,L.set(0,0,e.canvas.width,e.canvas.height),k.set(0,0,e.canvas.width,e.canvas.height),a.reset(),s.reset(),c.reset()}}}function _o(e,t,n,r,i,o,a){var s,c,u,l=i.isWebGL2,d=i.maxTextures,h=i.maxCubemapSize,f=i.maxTextureSize,p=i.maxSamples,A=new WeakMap,g=!1;try{g="undefined"!=typeof OffscreenCanvas&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch(e){}function v(e,t){return g?new OffscreenCanvas(e,t):document.createElementNS("http://www.w3.org/1999/xhtml","canvas")}function m(e,t,n,r){var i=1;if((e.width>r||e.height>r)&&(i=r/Math.max(e.width,e.height)),i<1||!0===t){if("undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap){var o=t?Se:Math.floor,a=o(i*e.width),s=o(i*e.height);void 0===u&&(u=v(a,s));var c=n?v(a,s):u;return c.width=a,c.height=s,c.getContext("2d").drawImage(e,0,0,a,s),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+e.width+"x"+e.height+") to ("+a+"x"+s+")."),c}return"data"in e&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+e.width+"x"+e.height+")."),e}return e}function b(e){return _e(e.width)&&_e(e.height)}function T(e,t){return e.generateMipmaps&&t&&e.minFilter!==E&&e.minFilter!==S}function R(t,n,i,o){e.generateMipmap(t),r.get(n).__maxMipLevel=Math.log2(Math.max(i,o))}function C(n,r,i){if(!1===l)return r;if(null!==n){if(void 0!==e[n])return e[n];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+n+"'")}var o=r;return 6403===r&&(5126===i&&(o=33326),5131===i&&(o=33325),5121===i&&(o=33321)),6407===r&&(5126===i&&(o=34837),5131===i&&(o=34843),5121===i&&(o=32849)),6408===r&&(5126===i&&(o=34836),5131===i&&(o=34842),5121===i&&(o=32856)),33325!==o&&33326!==o&&34842!==o&&34836!==o||t.get("EXT_color_buffer_float"),o}function D(e){return e===E||e===_||e===w?9728:9729}function P(t){var n=t.target;n.removeEventListener("dispose",P),function(t){var n=r.get(t);if(void 0===n.__webglInit)return;e.deleteTexture(n.__webglTexture),r.remove(t)}(n),n.isVideoTexture&&A.delete(n),a.memory.textures--}function F(t){var n=t.target;n.removeEventListener("dispose",F),function(t){var n=t.texture,i=r.get(t),o=r.get(n);if(!t)return;void 0!==o.__webglTexture&&e.deleteTexture(o.__webglTexture);t.depthTexture&&t.depthTexture.dispose();if(t.isWebGLCubeRenderTarget)for(var a=0;a<6;a++)e.deleteFramebuffer(i.__webglFramebuffer[a]),i.__webglDepthbuffer&&e.deleteRenderbuffer(i.__webglDepthbuffer[a]);else e.deleteFramebuffer(i.__webglFramebuffer),i.__webglDepthbuffer&&e.deleteRenderbuffer(i.__webglDepthbuffer),i.__webglMultisampledFramebuffer&&e.deleteFramebuffer(i.__webglMultisampledFramebuffer),i.__webglColorRenderbuffer&&e.deleteRenderbuffer(i.__webglColorRenderbuffer),i.__webglDepthRenderbuffer&&e.deleteRenderbuffer(i.__webglDepthRenderbuffer);r.remove(n),r.remove(t)}(n),a.memory.textures--}var H=0;function j(e,t){var i=r.get(e);if(e.isVideoTexture&&function(e){var t=a.render.frame;A.get(e)!==t&&(A.set(e,t),e.update())}(e),e.version>0&&i.__version!==e.version){var o=e.image;if(void 0===o)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else{if(!1!==o.complete)return void q(i,e,t);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}n.activeTexture(33984+t),n.bindTexture(3553,i.__webglTexture)}function V(t,i){var a=r.get(t);t.version>0&&a.__version!==t.version?function(t,r,i){if(6!==r.image.length)return;K(t,r),n.activeTexture(33984+i),n.bindTexture(34067,t.__webglTexture),e.pixelStorei(37440,r.flipY),e.pixelStorei(37441,r.premultiplyAlpha),e.pixelStorei(3317,r.unpackAlignment),e.pixelStorei(37443,0);for(var a=r&&(r.isCompressedTexture||r.image[0].isCompressedTexture),s=r.image[0]&&r.image[0].isDataTexture,c=[],u=0;u<6;u++)c[u]=a||s?s?r.image[u].image:r.image[u]:m(r.image[u],!1,!0,h);var d,f=c[0],p=b(f)||l,A=o.convert(r.format),g=o.convert(r.type),v=C(r.internalFormat,A,g);if(z(34067,r,p),a){for(var y=0;y<6;y++){d=c[y].mipmaps;for(var E=0;E<d.length;E++){var _=d[E];r.format!==L&&r.format!==M?null!==A?n.compressedTexImage2D(34069+y,E,v,_.width,_.height,0,_.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):n.texImage2D(34069+y,E,v,_.width,_.height,0,A,g,_.data)}}t.__maxMipLevel=d.length-1}else{d=r.mipmaps;for(var w=0;w<6;w++)if(s){n.texImage2D(34069+w,0,v,c[w].width,c[w].height,0,A,g,c[w].data);for(var S=0;S<d.length;S++){var I=d[S].image[w].image;n.texImage2D(34069+w,S+1,v,I.width,I.height,0,A,g,I.data)}}else{n.texImage2D(34069+w,0,v,A,g,c[w]);for(var x=0;x<d.length;x++){var O=d[x];n.texImage2D(34069+w,x+1,v,A,g,O.image[w])}}t.__maxMipLevel=d.length}T(r,p)&&R(34067,r,f.width,f.height);t.__version=r.version,r.onUpdate&&r.onUpdate(r)}(a,t,i):(n.activeTexture(33984+i),n.bindTexture(34067,a.__webglTexture))}var Q=((s={})[1e3]=10497,s[1001]=33071,s[1002]=33648,s),G=((c={})[1003]=9728,c[1004]=9984,c[1005]=9986,c[1006]=9729,c[1007]=9985,c[1008]=9987,c);function z(n,o,a){if(a?(e.texParameteri(n,10242,Q[o.wrapS]),e.texParameteri(n,10243,Q[o.wrapT]),32879!==n&&35866!==n||e.texParameteri(n,32882,Q[o.wrapR]),e.texParameteri(n,10240,G[o.magFilter]),e.texParameteri(n,10241,G[o.minFilter])):(e.texParameteri(n,10242,33071),e.texParameteri(n,10243,33071),32879!==n&&35866!==n||e.texParameteri(n,32882,33071),o.wrapS===y&&o.wrapT===y||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),e.texParameteri(n,10240,D(o.magFilter)),e.texParameteri(n,10241,D(o.minFilter)),o.minFilter!==E&&o.minFilter!==S&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),!0===t.has("EXT_texture_filter_anisotropic")){var s=t.get("EXT_texture_filter_anisotropic");if(o.type===O&&!1===t.has("OES_texture_float_linear"))return;if(!1===l&&o.type===N&&!1===t.has("OES_texture_half_float_linear"))return;(o.anisotropy>1||r.get(o).__currentAnisotropy)&&(e.texParameterf(n,s.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(o.anisotropy,i.getMaxAnisotropy())),r.get(o).__currentAnisotropy=o.anisotropy)}}function K(t,n){void 0===t.__webglInit&&(t.__webglInit=!0,n.addEventListener("dispose",P),t.__webglTexture=e.createTexture(),a.memory.textures++)}function q(t,r,i){var a=3553;r.isDataTexture2DArray&&(a=35866),r.isDataTexture3D&&(a=32879),K(t,r),n.activeTexture(33984+i),n.bindTexture(a,t.__webglTexture),e.pixelStorei(37440,r.flipY),e.pixelStorei(37441,r.premultiplyAlpha),e.pixelStorei(3317,r.unpackAlignment),e.pixelStorei(37443,0);var s,c=function(e){return!l&&(e.wrapS!==y||e.wrapT!==y||e.minFilter!==E&&e.minFilter!==S)}(r)&&!1===b(r.image),u=m(r.image,c,!1,f),d=b(u)||l,h=o.convert(r.format),p=o.convert(r.type),A=C(r.internalFormat,h,p);z(a,r,d);var g=r.mipmaps;if(r.isDepthTexture)A=6402,l?A=r.type===O?36012:r.type===x?33190:r.type===B?35056:33189:r.type===O&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),r.format===k&&6402===A&&r.type!==I&&r.type!==x&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),r.type=I,p=o.convert(r.type)),r.format===U&&6402===A&&(A=34041,r.type!==B&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),r.type=B,p=o.convert(r.type))),n.texImage2D(3553,0,A,u.width,u.height,0,h,p,null);else if(r.isDataTexture)if(g.length>0&&d){for(var v=0,_=g.length;v<_;v++)s=g[v],n.texImage2D(3553,v,A,s.width,s.height,0,h,p,s.data);r.generateMipmaps=!1,t.__maxMipLevel=g.length-1}else n.texImage2D(3553,0,A,u.width,u.height,0,h,p,u.data),t.__maxMipLevel=0;else if(r.isCompressedTexture){for(var w=0,N=g.length;w<N;w++)s=g[w],r.format!==L&&r.format!==M?null!==h?n.compressedTexImage2D(3553,w,A,s.width,s.height,0,s.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):n.texImage2D(3553,w,A,s.width,s.height,0,h,p,s.data);t.__maxMipLevel=g.length-1}else if(r.isDataTexture2DArray)n.texImage3D(35866,0,A,u.width,u.height,u.depth,0,h,p,u.data),t.__maxMipLevel=0;else if(r.isDataTexture3D)n.texImage3D(32879,0,A,u.width,u.height,u.depth,0,h,p,u.data),t.__maxMipLevel=0;else if(g.length>0&&d){for(var D=0,P=g.length;D<P;D++)s=g[D],n.texImage2D(3553,D,A,h,p,s);r.generateMipmaps=!1,t.__maxMipLevel=g.length-1}else n.texImage2D(3553,0,A,h,p,u),t.__maxMipLevel=0;T(r,d)&&R(a,r,u.width,u.height),t.__version=r.version,r.onUpdate&&r.onUpdate(r)}function W(t,i,a,s){var c=i.texture,u=o.convert(c.format),l=o.convert(c.type),d=C(c.internalFormat,u,l);32879===s||35866===s?n.texImage3D(s,0,d,i.width,i.height,i.depth,0,u,l,null):n.texImage2D(s,0,d,i.width,i.height,0,u,l,null),n.bindFramebuffer(36160,t),e.framebufferTexture2D(36160,a,s,r.get(c).__webglTexture,0),n.bindFramebuffer(36160,null)}function X(t,n,r){if(e.bindRenderbuffer(36161,t),n.depthBuffer&&!n.stencilBuffer){var i=33189;if(r){var a=n.depthTexture;a&&a.isDepthTexture&&(a.type===O?i=36012:a.type===x&&(i=33190));var s=Y(n);e.renderbufferStorageMultisample(36161,s,i,n.width,n.height)}else e.renderbufferStorage(36161,i,n.width,n.height);e.framebufferRenderbuffer(36160,36096,36161,t)}else if(n.depthBuffer&&n.stencilBuffer){if(r){var c=Y(n);e.renderbufferStorageMultisample(36161,c,35056,n.width,n.height)}else e.renderbufferStorage(36161,34041,n.width,n.height);e.framebufferRenderbuffer(36160,33306,36161,t)}else{var u=n.texture,l=o.convert(u.format),d=o.convert(u.type),h=C(u.internalFormat,l,d);if(r){var f=Y(n);e.renderbufferStorageMultisample(36161,f,h,n.width,n.height)}else e.renderbufferStorage(36161,h,n.width,n.height)}e.bindRenderbuffer(36161,null)}function J(t){var i=r.get(t),o=!0===t.isWebGLCubeRenderTarget;if(t.depthTexture){if(o)throw new Error("target.depthTexture not supported in Cube render targets");!function(t,i){if(i&&i.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(n.bindFramebuffer(36160,t),!i.depthTexture||!i.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");r.get(i.depthTexture).__webglTexture&&i.depthTexture.image.width===i.width&&i.depthTexture.image.height===i.height||(i.depthTexture.image.width=i.width,i.depthTexture.image.height=i.height,i.depthTexture.needsUpdate=!0),j(i.depthTexture,0);var o=r.get(i.depthTexture).__webglTexture;if(i.depthTexture.format===k)e.framebufferTexture2D(36160,36096,3553,o,0);else{if(i.depthTexture.format!==U)throw new Error("Unknown depthTexture format");e.framebufferTexture2D(36160,33306,3553,o,0)}}(i.__webglFramebuffer,t)}else if(o){i.__webglDepthbuffer=[];for(var a=0;a<6;a++)n.bindFramebuffer(36160,i.__webglFramebuffer[a]),i.__webglDepthbuffer[a]=e.createRenderbuffer(),X(i.__webglDepthbuffer[a],t,!1)}else n.bindFramebuffer(36160,i.__webglFramebuffer),i.__webglDepthbuffer=e.createRenderbuffer(),X(i.__webglDepthbuffer,t,!1);n.bindFramebuffer(36160,null)}function Y(e){return l&&e.isWebGLMultisampleRenderTarget?Math.min(p,e.samples):0}var Z=!1,$=!1;this.allocateTextureUnit=function(){var e=H;return e>=d&&console.warn("THREE.WebGLTextures: Trying to use "+e+" texture units while this GPU supports only "+d),H+=1,e},this.resetTextureUnits=function(){H=0},this.setTexture2D=j,this.setTexture2DArray=function(e,t){var i=r.get(e);e.version>0&&i.__version!==e.version?q(i,e,t):(n.activeTexture(33984+t),n.bindTexture(35866,i.__webglTexture))},this.setTexture3D=function(e,t){var i=r.get(e);e.version>0&&i.__version!==e.version?q(i,e,t):(n.activeTexture(33984+t),n.bindTexture(32879,i.__webglTexture))},this.setTextureCube=V,this.setupRenderTarget=function(t){var i=t.texture,s=r.get(t),c=r.get(i);t.addEventListener("dispose",F),c.__webglTexture=e.createTexture(),c.__version=i.version,a.memory.textures++;var u=!0===t.isWebGLCubeRenderTarget,d=!0===t.isWebGLMultisampleRenderTarget,h=i.isDataTexture3D||i.isDataTexture2DArray,f=b(t)||l;if(!l||i.format!==M||i.type!==O&&i.type!==N||(i.format=L,console.warn("THREE.WebGLRenderer: Rendering to textures with RGB format is not supported. Using RGBA format instead.")),u){s.__webglFramebuffer=[];for(var p=0;p<6;p++)s.__webglFramebuffer[p]=e.createFramebuffer()}else if(s.__webglFramebuffer=e.createFramebuffer(),d)if(l){s.__webglMultisampledFramebuffer=e.createFramebuffer(),s.__webglColorRenderbuffer=e.createRenderbuffer(),e.bindRenderbuffer(36161,s.__webglColorRenderbuffer);var A=o.convert(i.format),g=o.convert(i.type),v=C(i.internalFormat,A,g),m=Y(t);e.renderbufferStorageMultisample(36161,m,v,t.width,t.height),n.bindFramebuffer(36160,s.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(36160,36064,36161,s.__webglColorRenderbuffer),e.bindRenderbuffer(36161,null),t.depthBuffer&&(s.__webglDepthRenderbuffer=e.createRenderbuffer(),X(s.__webglDepthRenderbuffer,t,!0)),n.bindFramebuffer(36160,null)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.");if(u){n.bindTexture(34067,c.__webglTexture),z(34067,i,f);for(var y=0;y<6;y++)W(s.__webglFramebuffer[y],t,36064,34069+y);T(i,f)&&R(34067,i,t.width,t.height),n.bindTexture(34067,null)}else{var E=3553;if(h)if(l)E=i.isDataTexture3D?32879:35866;else console.warn("THREE.DataTexture3D and THREE.DataTexture2DArray only supported with WebGL2.");n.bindTexture(E,c.__webglTexture),z(E,i,f),W(s.__webglFramebuffer,t,36064,E),T(i,f)&&R(3553,i,t.width,t.height),n.bindTexture(3553,null)}t.depthBuffer&&J(t)},this.updateRenderTargetMipmap=function(e){var t=e.texture;if(T(t,b(e)||l)){var i=e.isWebGLCubeRenderTarget?34067:3553,o=r.get(t).__webglTexture;n.bindTexture(i,o),R(i,t,e.width,e.height),n.bindTexture(i,null)}},this.updateMultisampleRenderTarget=function(t){if(t.isWebGLMultisampleRenderTarget)if(l){var i=t.width,o=t.height,a=16384;t.depthBuffer&&(a|=256),t.stencilBuffer&&(a|=1024);var s=r.get(t);n.bindFramebuffer(36008,s.__webglMultisampledFramebuffer),n.bindFramebuffer(36009,s.__webglFramebuffer),e.blitFramebuffer(0,0,i,o,0,0,i,o,a,9728),n.bindFramebuffer(36008,null),n.bindFramebuffer(36009,s.__webglMultisampledFramebuffer)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.")},this.safeSetTexture2D=function(e,t){e&&e.isWebGLRenderTarget&&(!1===Z&&(console.warn("THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."),Z=!0),e=e.texture),j(e,t)},this.safeSetTextureCube=function(e,t){e&&e.isWebGLCubeRenderTarget&&(!1===$&&(console.warn("THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."),$=!0),e=e.texture),V(e,t)}}function wo(e,t,n){var r=n.isWebGL2;return{convert:function(e){var n;if(e===C)return 5121;if(1017===e)return 32819;if(1018===e)return 32820;if(1019===e)return 33635;if(1010===e)return 5120;if(1011===e)return 5122;if(e===I)return 5123;if(1013===e)return 5124;if(e===x)return 5125;if(e===O)return 5126;if(e===N)return r?5131:null!==(n=t.get("OES_texture_half_float"))?n.HALF_FLOAT_OES:null;if(1021===e)return 6406;if(e===M)return 6407;if(e===L)return 6408;if(1024===e)return 6409;if(1025===e)return 6410;if(e===k)return 6402;if(e===U)return 34041;if(1028===e)return 6403;if(1029===e)return 36244;if(1030===e)return 33319;if(1031===e)return 33320;if(1032===e)return 36248;if(1033===e)return 36249;if(e===D||e===P||e===F||e===H){if(null===(n=t.get("WEBGL_compressed_texture_s3tc")))return null;if(e===D)return n.COMPRESSED_RGB_S3TC_DXT1_EXT;if(e===P)return n.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(e===F)return n.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(e===H)return n.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(e===j||e===V||e===Q||e===G){if(null===(n=t.get("WEBGL_compressed_texture_pvrtc")))return null;if(e===j)return n.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(e===V)return n.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(e===Q)return n.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(e===G)return n.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(36196===e)return null!==(n=t.get("WEBGL_compressed_texture_etc1"))?n.COMPRESSED_RGB_ETC1_WEBGL:null;if((e===z||e===K)&&null!==(n=t.get("WEBGL_compressed_texture_etc"))){if(e===z)return n.COMPRESSED_RGB8_ETC2;if(e===K)return n.COMPRESSED_RGBA8_ETC2_EAC}return 37808===e||37809===e||37810===e||37811===e||37812===e||37813===e||37814===e||37815===e||37816===e||37817===e||37818===e||37819===e||37820===e||37821===e||37840===e||37841===e||37842===e||37843===e||37844===e||37845===e||37846===e||37847===e||37848===e||37849===e||37850===e||37851===e||37852===e||37853===e?null!==(n=t.get("WEBGL_compressed_texture_astc"))?e:null:36492===e?null!==(n=t.get("EXT_texture_compression_bptc"))?e:null:e===B?r?34042:null!==(n=t.get("WEBGL_depth_texture"))?n.UNSIGNED_INT_24_8_WEBGL:null:void 0}}}var So=function(e){function t(t){var n;return void 0===t&&(t=[]),(n=e.call(this)||this).cameras=t,n}return i(t,e),t}(sr);So.prototype.isArrayCamera=!0;var To=function(e){function t(){var t;return(t=e.call(this)||this).type="Group",t}return i(t,e),t}(Ft);To.prototype.isGroup=!0;var Ro={type:"move"},Co=function(){function e(){this._targetRay=null,this._grip=null,this._hand=null}var t=e.prototype;return t.getHandSpace=function(){return null===this._hand&&(this._hand=new To,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand},t.getTargetRaySpace=function(){return null===this._targetRay&&(this._targetRay=new To,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new De,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new De),this._targetRay},t.getGripSpace=function(){return null===this._grip&&(this._grip=new To,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new De,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new De),this._grip},t.dispatchEvent=function(e){return null!==this._targetRay&&this._targetRay.dispatchEvent(e),null!==this._grip&&this._grip.dispatchEvent(e),null!==this._hand&&this._hand.dispatchEvent(e),this},t.disconnect=function(e){return this.dispatchEvent({type:"disconnected",data:e}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this},t.update=function(e,t,n){var r=null,i=null,o=null,a=this._targetRay,c=this._grip,u=this._hand;if(e&&"visible-blurred"!==t.session.visibilityState)if(null!==a&&null!==(r=t.getPose(e.targetRaySpace,n))&&(a.matrix.fromArray(r.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),r.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(r.linearVelocity)):a.hasLinearVelocity=!1,r.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(r.angularVelocity)):a.hasAngularVelocity=!1,this.dispatchEvent(Ro)),u&&e.hand){o=!0;for(var l,d=s(e.hand.values());!(l=d()).done;){var h=l.value,f=t.getJointPose(h,n);if(void 0===u.joints[h.jointName]){var p=new To;p.matrixAutoUpdate=!1,p.visible=!1,u.joints[h.jointName]=p,u.add(p)}var A=u.joints[h.jointName];null!==f&&(A.matrix.fromArray(f.transform.matrix),A.matrix.decompose(A.position,A.rotation,A.scale),A.jointRadius=f.radius),A.visible=null!==f}var g=u.joints["index-finger-tip"],v=u.joints["thumb-tip"],m=g.position.distanceTo(v.position);u.inputState.pinching&&m>.025?(u.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!u.inputState.pinching&&m<=.015&&(u.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else null!==c&&e.gripSpace&&null!==(i=t.getPose(e.gripSpace,n))&&(c.matrix.fromArray(i.transform.matrix),c.matrix.decompose(c.position,c.rotation,c.scale),i.linearVelocity?(c.hasLinearVelocity=!0,c.linearVelocity.copy(i.linearVelocity)):c.hasLinearVelocity=!1,i.angularVelocity?(c.hasAngularVelocity=!0,c.angularVelocity.copy(i.angularVelocity)):c.hasAngularVelocity=!1);return null!==a&&(a.visible=null!==r),null!==c&&(c.visible=null!==i),null!==u&&(u.visible=null!==o),this},e}(),Io=function(e){function n(n,r){var i,a=o(i=e.call(this)||this),s=n.state,c=null,u=1,l=null,d="local-floor",h=null,f=[],p=new Map,A=new sr;A.layers.enable(1),A.viewport=new Me;var g=new sr;g.layers.enable(2),g.viewport=new Me;var v=[A,g],m=new So;m.layers.enable(1),m.layers.enable(2);var y=null,b=null;function E(e){var t=p.get(e.inputSource);t&&t.dispatchEvent({type:e.type,data:e.inputSource})}function _(){p.forEach((function(e,t){e.disconnect(t)})),p.clear(),y=null,b=null,s.bindXRFramebuffer(null),n.setRenderTarget(n.getRenderTarget()),I.stop(),a.isPresenting=!1,a.dispatchEvent({type:"sessionend"})}function w(e){for(var t=c.inputSources,n=0;n<f.length;n++)p.set(t[n],f[n]);for(var r=0;r<e.removed.length;r++){var i=e.removed[r],o=p.get(i);o&&(o.dispatchEvent({type:"disconnected",data:i}),p.delete(i))}for(var a=0;a<e.added.length;a++){var s=e.added[a],u=p.get(s);u&&u.dispatchEvent({type:"connected",data:s})}}i.enabled=!1,i.isPresenting=!1,i.getController=function(e){var t=f[e];return void 0===t&&(t=new Co,f[e]=t),t.getTargetRaySpace()},i.getControllerGrip=function(e){var t=f[e];return void 0===t&&(t=new Co,f[e]=t),t.getGripSpace()},i.getHand=function(e){var t=f[e];return void 0===t&&(t=new Co,f[e]=t),t.getHandSpace()},i.setFramebufferScaleFactor=function(e){u=e,!0===a.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},i.setReferenceSpaceType=function(e){d=e,!0===a.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},i.getReferenceSpace=function(){return l},i.getSession=function(){return c},i.setSession=function(){var e,n=(e=regeneratorRuntime.mark((function e(t){var n,i,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===(c=t)){e.next=24;break}if(c.addEventListener("select",E),c.addEventListener("selectstart",E),c.addEventListener("selectend",E),c.addEventListener("squeeze",E),c.addEventListener("squeezestart",E),c.addEventListener("squeezeend",E),c.addEventListener("end",_),c.addEventListener("inputsourceschange",w),!0===(n=r.getContextAttributes()).xrCompatible){e.next=14;break}return e.next=14,r.makeXRCompatible();case 14:return i={antialias:n.antialias,alpha:n.alpha,depth:n.depth,stencil:n.stencil,framebufferScaleFactor:u},o=new XRWebGLLayer(c,r,i),c.updateRenderState({baseLayer:o}),e.next=19,c.requestReferenceSpace(d);case 19:l=e.sent,I.setContext(c),I.start(),a.isPresenting=!0,a.dispatchEvent({type:"sessionstart"});case 24:case"end":return e.stop()}}),e)})),function(){var n=this,r=arguments;return new Promise((function(i,o){var a=e.apply(n,r);function s(e){t(a,i,o,s,c,"next",e)}function c(e){t(a,i,o,s,c,"throw",e)}s(void 0)}))});return function(e){return n.apply(this,arguments)}}();var S=new De,T=new De;function R(e,t){null===t?e.matrixWorld.copy(e.matrix):e.matrixWorld.multiplyMatrices(t.matrixWorld,e.matrix),e.matrixWorldInverse.copy(e.matrixWorld).invert()}i.getCamera=function(e){m.near=g.near=A.near=e.near,m.far=g.far=A.far=e.far,y===m.near&&b===m.far||(c.updateRenderState({depthNear:m.near,depthFar:m.far}),y=m.near,b=m.far);var t=e.parent,n=m.cameras;R(m,t);for(var r=0;r<n.length;r++)R(n[r],t);e.matrixWorld.copy(m.matrixWorld),e.matrix.copy(m.matrix),e.matrix.decompose(e.position,e.quaternion,e.scale);for(var i=e.children,o=0,a=i.length;o<a;o++)i[o].updateMatrixWorld(!0);return 2===n.length?function(e,t,n){S.setFromMatrixPosition(t.matrixWorld),T.setFromMatrixPosition(n.matrixWorld);var r=S.distanceTo(T),i=t.projectionMatrix.elements,o=n.projectionMatrix.elements,a=i[14]/(i[10]-1),s=i[14]/(i[10]+1),c=(i[9]+1)/i[5],u=(i[9]-1)/i[5],l=(i[8]-1)/i[0],d=(o[8]+1)/o[0],h=a*l,f=a*d,p=r/(-l+d),A=p*-l;t.matrixWorld.decompose(e.position,e.quaternion,e.scale),e.translateX(A),e.translateZ(p),e.matrixWorld.compose(e.position,e.quaternion,e.scale),e.matrixWorldInverse.copy(e.matrixWorld).invert();var g=a+p,v=s+p,m=h-A,y=f+(r-A),b=c*s/v*g,E=u*s/v*g;e.projectionMatrix.makePerspective(m,y,b,E,g,v)}(m,A,g):m.projectionMatrix.copy(A.projectionMatrix),m};var C=null;var I=new gr;return I.setAnimationLoop((function(e,t){if(null!==(h=t.getViewerPose(l))){var n=h.views,r=c.renderState.baseLayer;s.bindXRFramebuffer(r.framebuffer);var i=!1;n.length!==m.cameras.length&&(m.cameras.length=0,i=!0);for(var o=0;o<n.length;o++){var a=n[o],u=r.getViewport(a),d=v[o];d.matrix.fromArray(a.transform.matrix),d.projectionMatrix.fromArray(a.projectionMatrix),d.viewport.set(u.x,u.y,u.width,u.height),0===o&&m.matrix.copy(d.matrix),!0===i&&m.cameras.push(d)}}for(var p=c.inputSources,A=0;A<f.length;A++){var g=f[A],y=p[A];g.update(y,t,l)}C&&C(e,t)})),i.setAnimationLoop=function(e){C=e},i.dispose=function(){},i}return i(n,e),n}(he);function xo(e){function t(t,n){t.opacity.value=n.opacity,n.color&&t.diffuse.value.copy(n.color),n.emissive&&t.emissive.value.copy(n.emissive).multiplyScalar(n.emissiveIntensity),n.map&&(t.map.value=n.map),n.alphaMap&&(t.alphaMap.value=n.alphaMap),n.specularMap&&(t.specularMap.value=n.specularMap);var r,i,o=e.get(n).envMap;if(o){t.envMap.value=o,t.flipEnvMap.value=o.isCubeTexture&&o._needsFlipEnvMap?-1:1,t.reflectivity.value=n.reflectivity,t.refractionRatio.value=n.refractionRatio;var a=e.get(o).__maxMipLevel;void 0!==a&&(t.maxMipLevel.value=a)}n.lightMap&&(t.lightMap.value=n.lightMap,t.lightMapIntensity.value=n.lightMapIntensity),n.aoMap&&(t.aoMap.value=n.aoMap,t.aoMapIntensity.value=n.aoMapIntensity),n.map?r=n.map:n.specularMap?r=n.specularMap:n.displacementMap?r=n.displacementMap:n.normalMap?r=n.normalMap:n.bumpMap?r=n.bumpMap:n.roughnessMap?r=n.roughnessMap:n.metalnessMap?r=n.metalnessMap:n.alphaMap?r=n.alphaMap:n.emissiveMap?r=n.emissiveMap:n.clearcoatMap?r=n.clearcoatMap:n.clearcoatNormalMap?r=n.clearcoatNormalMap:n.clearcoatRoughnessMap&&(r=n.clearcoatRoughnessMap),void 0!==r&&(r.isWebGLRenderTarget&&(r=r.texture),!0===r.matrixAutoUpdate&&r.updateMatrix(),t.uvTransform.value.copy(r.matrix)),n.aoMap?i=n.aoMap:n.lightMap&&(i=n.lightMap),void 0!==i&&(i.isWebGLRenderTarget&&(i=i.texture),!0===i.matrixAutoUpdate&&i.updateMatrix(),t.uv2Transform.value.copy(i.matrix))}function n(t,n){t.roughness.value=n.roughness,t.metalness.value=n.metalness,n.roughnessMap&&(t.roughnessMap.value=n.roughnessMap),n.metalnessMap&&(t.metalnessMap.value=n.metalnessMap),n.emissiveMap&&(t.emissiveMap.value=n.emissiveMap),n.bumpMap&&(t.bumpMap.value=n.bumpMap,t.bumpScale.value=n.bumpScale,1===n.side&&(t.bumpScale.value*=-1)),n.normalMap&&(t.normalMap.value=n.normalMap,t.normalScale.value.copy(n.normalScale),1===n.side&&t.normalScale.value.negate()),n.displacementMap&&(t.displacementMap.value=n.displacementMap,t.displacementScale.value=n.displacementScale,t.displacementBias.value=n.displacementBias),e.get(n).envMap&&(t.envMapIntensity.value=n.envMapIntensity)}return{refreshFogUniforms:function(e,t){e.fogColor.value.copy(t.color),t.isFog?(e.fogNear.value=t.near,e.fogFar.value=t.far):t.isFogExp2&&(e.fogDensity.value=t.density)},refreshMaterialUniforms:function(e,r,i,o){r.isMeshBasicMaterial?t(e,r):r.isMeshLambertMaterial?(t(e,r),function(e,t){t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap)}(e,r)):r.isMeshToonMaterial?(t(e,r),function(e,t){t.gradientMap&&(e.gradientMap.value=t.gradientMap);t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap);t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,1===t.side&&(e.bumpScale.value*=-1));t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),1===t.side&&e.normalScale.value.negate());t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(e,r)):r.isMeshPhongMaterial?(t(e,r),function(e,t){e.specular.value.copy(t.specular),e.shininess.value=Math.max(t.shininess,1e-4),t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap);t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,1===t.side&&(e.bumpScale.value*=-1));t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),1===t.side&&e.normalScale.value.negate());t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(e,r)):r.isMeshStandardMaterial?(t(e,r),r.isMeshPhysicalMaterial?function(e,t){n(e,t),e.reflectivity.value=t.reflectivity,e.clearcoat.value=t.clearcoat,e.clearcoatRoughness.value=t.clearcoatRoughness,t.sheen&&e.sheen.value.copy(t.sheen);t.clearcoatMap&&(e.clearcoatMap.value=t.clearcoatMap);t.clearcoatRoughnessMap&&(e.clearcoatRoughnessMap.value=t.clearcoatRoughnessMap);t.clearcoatNormalMap&&(e.clearcoatNormalScale.value.copy(t.clearcoatNormalScale),e.clearcoatNormalMap.value=t.clearcoatNormalMap,1===t.side&&e.clearcoatNormalScale.value.negate());e.transmission.value=t.transmission,t.transmissionMap&&(e.transmissionMap.value=t.transmissionMap)}(e,r):n(e,r)):r.isMeshMatcapMaterial?(t(e,r),function(e,t){t.matcap&&(e.matcap.value=t.matcap);t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,1===t.side&&(e.bumpScale.value*=-1));t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),1===t.side&&e.normalScale.value.negate());t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(e,r)):r.isMeshDepthMaterial?(t(e,r),function(e,t){t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(e,r)):r.isMeshDistanceMaterial?(t(e,r),function(e,t){t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias);e.referencePosition.value.copy(t.referencePosition),e.nearDistance.value=t.nearDistance,e.farDistance.value=t.farDistance}(e,r)):r.isMeshNormalMaterial?(t(e,r),function(e,t){t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,1===t.side&&(e.bumpScale.value*=-1));t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),1===t.side&&e.normalScale.value.negate());t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(e,r)):r.isLineBasicMaterial?(function(e,t){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity}(e,r),r.isLineDashedMaterial&&function(e,t){e.dashSize.value=t.dashSize,e.totalSize.value=t.dashSize+t.gapSize,e.scale.value=t.scale}(e,r)):r.isPointsMaterial?function(e,t,n,r){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.size.value=t.size*n,e.scale.value=.5*r,t.map&&(e.map.value=t.map);t.alphaMap&&(e.alphaMap.value=t.alphaMap);var i;t.map?i=t.map:t.alphaMap&&(i=t.alphaMap);void 0!==i&&(!0===i.matrixAutoUpdate&&i.updateMatrix(),e.uvTransform.value.copy(i.matrix))}(e,r,i,o):r.isSpriteMaterial?function(e,t){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.rotation.value=t.rotation,t.map&&(e.map.value=t.map);t.alphaMap&&(e.alphaMap.value=t.alphaMap);var n;t.map?n=t.map:t.alphaMap&&(n=t.alphaMap);void 0!==n&&(!0===n.matrixAutoUpdate&&n.updateMatrix(),e.uvTransform.value.copy(n.matrix))}(e,r):r.isShadowMaterial?(e.color.value.copy(r.color),e.opacity.value=r.opacity):r.isShaderMaterial&&(r.uniformsNeedUpdate=!1)}}}function Oo(e){var t,n=void 0!==(e=e||{}).canvas?e.canvas:((t=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")).style.display="block",t),r=void 0!==e.context?e.context:null,i=void 0!==e.alpha&&e.alpha,o=void 0===e.depth||e.depth,a=void 0===e.stencil||e.stencil,s=void 0!==e.antialias&&e.antialias,c=void 0===e.premultipliedAlpha||e.premultipliedAlpha,u=void 0!==e.preserveDrawingBuffer&&e.preserveDrawingBuffer,l=void 0!==e.powerPreference?e.powerPreference:"default",d=void 0!==e.failIfMajorPerformanceCaveat&&e.failIfMajorPerformanceCaveat,h=null,f=null,p=[],A=[];this.domElement=n,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.outputEncoding=te,this.physicallyCorrectLights=!1,this.toneMapping=0,this.toneMappingExposure=1;var g=this,v=!1,m=0,y=0,b=null,E=-1,_=null,w=new Me,S=new Me,T=null,R=n.width,I=n.height,x=1,B=null,M=null,k=new Me(0,0,R,I),U=new Me(0,0,R,I),D=!1,P=new Ar,F=!1,H=!1,j=new pt,V=new De,Q={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function G(){return null===b?x:1}var z,K,q,W,X,J,Y,Z,$,ee,ne,re,ie,oe,ae,se,ce,ue,le,de,he,fe,pe=r;function Ae(e,t){for(var r=0;r<e.length;r++){var i=e[r],o=n.getContext(i,t);if(null!==o)return o}return null}try{var ge={alpha:i,depth:o,stencil:a,antialias:s,premultipliedAlpha:c,preserveDrawingBuffer:u,powerPreference:l,failIfMajorPerformanceCaveat:d};if(n.addEventListener("webglcontextlost",be,!1),n.addEventListener("webglcontextrestored",Ee,!1),null===pe){var ve=["webgl2","webgl","experimental-webgl"];if(!0===g.isWebGL1Renderer&&ve.shift(),null===(pe=Ae(ve,ge)))throw Ae(ve)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}void 0===pe.getShaderPrecisionFormat&&(pe.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(e){throw console.error("THREE.WebGLRenderer: "+e.message),e}function me(){z=new Ir(pe),K=new Tr(pe,z,e),z.init(K),he=new wo(pe,z,K),q=new Eo(pe,z,K),W=new Nr(pe),X=new ao,J=new _o(pe,z,q,X,K,he,W),Y=new Cr(g),Z=new vr(pe,K),fe=new wr(pe,z,Z,K),$=new xr(pe,Z,W,fe),ee=new kr(pe,$,Z,W),ue=new Lr(pe),ae=new Rr(X),ne=new oo(g,Y,z,K,fe,ae),re=new xo(X),ie=new lo(X),oe=new vo(z,K),ce=new _r(g,Y,q,ee,c),se=new bo(g,ee,K),le=new Sr(pe,z,W,K),de=new Or(pe,z,W,K),W.programs=ne.programs,g.capabilities=K,g.extensions=z,g.properties=X,g.renderLists=ie,g.shadowMap=se,g.state=q,g.info=W}me();var ye=new Io(g,pe);function be(e){e.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),v=!0}function Ee(){console.log("THREE.WebGLRenderer: Context Restored."),v=!1;var e=W.autoReset,t=se.enabled,n=se.autoUpdate,r=se.needsUpdate,i=se.type;me(),W.autoReset=e,se.enabled=t,se.autoUpdate=n,se.needsUpdate=r,se.type=i}function _e(e){var t=e.target;t.removeEventListener("dispose",_e),function(e){(function(e){var t=X.get(e).programs;void 0!==t&&t.forEach((function(e){ne.releaseProgram(e)}))})(e),X.remove(e)}(t)}this.xr=ye,this.getContext=function(){return pe},this.getContextAttributes=function(){return pe.getContextAttributes()},this.forceContextLoss=function(){var e=z.get("WEBGL_lose_context");e&&e.loseContext()},this.forceContextRestore=function(){var e=z.get("WEBGL_lose_context");e&&e.restoreContext()},this.getPixelRatio=function(){return x},this.setPixelRatio=function(e){void 0!==e&&(x=e,this.setSize(R,I,!1))},this.getSize=function(e){return void 0===e&&(console.warn("WebGLRenderer: .getsize() now requires a Vector2 as an argument"),e=new Re),e.set(R,I)},this.setSize=function(e,t,r){ye.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(R=e,I=t,n.width=Math.floor(e*x),n.height=Math.floor(t*x),!1!==r&&(n.style.width=e+"px",n.style.height=t+"px"),this.setViewport(0,0,e,t))},this.getDrawingBufferSize=function(e){return void 0===e&&(console.warn("WebGLRenderer: .getdrawingBufferSize() now requires a Vector2 as an argument"),e=new Re),e.set(R*x,I*x).floor()},this.setDrawingBufferSize=function(e,t,r){R=e,I=t,x=r,n.width=Math.floor(e*r),n.height=Math.floor(t*r),this.setViewport(0,0,e,t)},this.getCurrentViewport=function(e){return void 0===e&&(console.warn("WebGLRenderer: .getCurrentViewport() now requires a Vector4 as an argument"),e=new Me),e.copy(w)},this.getViewport=function(e){return e.copy(k)},this.setViewport=function(e,t,n,r){e.isVector4?k.set(e.x,e.y,e.z,e.w):k.set(e,t,n,r),q.viewport(w.copy(k).multiplyScalar(x).floor())},this.getScissor=function(e){return e.copy(U)},this.setScissor=function(e,t,n,r){e.isVector4?U.set(e.x,e.y,e.z,e.w):U.set(e,t,n,r),q.scissor(S.copy(U).multiplyScalar(x).floor())},this.getScissorTest=function(){return D},this.setScissorTest=function(e){q.setScissorTest(D=e)},this.setOpaqueSort=function(e){B=e},this.setTransparentSort=function(e){M=e},this.getClearColor=function(e){return void 0===e&&(console.warn("WebGLRenderer: .getClearColor() now requires a Color as an argument"),e=new ln),e.copy(ce.getClearColor())},this.setClearColor=function(){ce.setClearColor.apply(ce,arguments)},this.getClearAlpha=function(){return ce.getClearAlpha()},this.setClearAlpha=function(){ce.setClearAlpha.apply(ce,arguments)},this.clear=function(e,t,n){var r=0;(void 0===e||e)&&(r|=16384),(void 0===t||t)&&(r|=256),(void 0===n||n)&&(r|=1024),pe.clear(r)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){n.removeEventListener("webglcontextlost",be,!1),n.removeEventListener("webglcontextrestored",Ee,!1),ie.dispose(),oe.dispose(),X.dispose(),Y.dispose(),ee.dispose(),fe.dispose(),ye.dispose(),ye.removeEventListener("sessionstart",Te),ye.removeEventListener("sessionend",Ce),Ie.stop()},this.renderBufferImmediate=function(e,t){fe.initAttributes();var n=X.get(e);e.hasPositions&&!n.position&&(n.position=pe.createBuffer()),e.hasNormals&&!n.normal&&(n.normal=pe.createBuffer()),e.hasUvs&&!n.uv&&(n.uv=pe.createBuffer()),e.hasColors&&!n.color&&(n.color=pe.createBuffer());var r=t.getAttributes();e.hasPositions&&(pe.bindBuffer(34962,n.position),pe.bufferData(34962,e.positionArray,35048),fe.enableAttribute(r.position),pe.vertexAttribPointer(r.position,3,5126,!1,0,0)),e.hasNormals&&(pe.bindBuffer(34962,n.normal),pe.bufferData(34962,e.normalArray,35048),fe.enableAttribute(r.normal),pe.vertexAttribPointer(r.normal,3,5126,!1,0,0)),e.hasUvs&&(pe.bindBuffer(34962,n.uv),pe.bufferData(34962,e.uvArray,35048),fe.enableAttribute(r.uv),pe.vertexAttribPointer(r.uv,2,5126,!1,0,0)),e.hasColors&&(pe.bindBuffer(34962,n.color),pe.bufferData(34962,e.colorArray,35048),fe.enableAttribute(r.color),pe.vertexAttribPointer(r.color,3,5126,!1,0,0)),fe.disableUnusedAttributes(),pe.drawArrays(4,0,e.count),e.count=0},this.renderBufferDirect=function(e,t,n,r,i,o){null===t&&(t=Q);var a=i.isMesh&&i.matrixWorld.determinant()<0,s=ke(e,t,r,i);q.setMaterial(r,a);var c=n.index,u=n.attributes.position;if(null===c){if(void 0===u||0===u.count)return}else if(0===c.count)return;var l,d=1;!0===r.wireframe&&(c=$.getWireframeAttribute(n),d=2),(r.morphTargets||r.morphNormals)&&ue.update(i,n,r,s),fe.setup(i,r,s,n,c);var h=le;null!==c&&(l=Z.get(c),(h=de).setIndex(l));var f=null!==c?c.count:u.count,p=n.drawRange.start*d,A=n.drawRange.count*d,g=null!==o?o.start*d:0,v=null!==o?o.count*d:1/0,m=Math.max(p,g),y=Math.min(f,p+A,g+v)-1,b=Math.max(0,y-m+1);if(0!==b){if(i.isMesh)!0===r.wireframe?(q.setLineWidth(r.wireframeLinewidth*G()),h.setMode(1)):h.setMode(4);else if(i.isLine){var E=r.linewidth;void 0===E&&(E=1),q.setLineWidth(E*G()),i.isLineSegments?h.setMode(1):i.isLineLoop?h.setMode(2):h.setMode(3)}else i.isPoints?h.setMode(0):i.isSprite&&h.setMode(4);if(i.isInstancedMesh)h.renderInstances(m,b,i.count);else if(n.isInstancedBufferGeometry){var _=Math.min(n.instanceCount,n._maxInstanceCount);h.renderInstances(m,b,_)}else h.render(m,b)}},this.compile=function(e,t){(f=oe.get(e)).init(),e.traverseVisible((function(e){e.isLight&&e.layers.test(t.layers)&&(f.pushLight(e),e.castShadow&&f.pushShadow(e))})),f.setupLights(),e.traverse((function(t){var n=t.material;if(n)if(Array.isArray(n))for(var r=0;r<n.length;r++){Be(n[r],e,t)}else Be(n,e,t)}))};var Se=null;function Te(){Ie.stop()}function Ce(){Ie.start()}var Ie=new gr;function xe(e,t,n,r){if(!1!==e.visible){if(e.layers.test(t.layers))if(e.isGroup)n=e.renderOrder;else if(e.isLOD)!0===e.autoUpdate&&e.update(t);else if(e.isLight)f.pushLight(e),e.castShadow&&f.pushShadow(e);else if(e.isSprite){if(!e.frustumCulled||P.intersectsSprite(e)){r&&V.setFromMatrixPosition(e.matrixWorld).applyMatrix4(j);var i=ee.update(e),o=e.material;o.visible&&h.push(e,i,o,n,V.z,null)}}else if(e.isImmediateRenderObject)r&&V.setFromMatrixPosition(e.matrixWorld).applyMatrix4(j),h.push(e,null,e.material,n,V.z,null);else if((e.isMesh||e.isLine||e.isPoints)&&(e.isSkinnedMesh&&e.skeleton.frame!==W.render.frame&&(e.skeleton.update(),e.skeleton.frame=W.render.frame),!e.frustumCulled||P.intersectsObject(e))){r&&V.setFromMatrixPosition(e.matrixWorld).applyMatrix4(j);var a=ee.update(e),s=e.material;if(Array.isArray(s))for(var c=a.groups,u=0,l=c.length;u<l;u++){var d=c[u],p=s[d.materialIndex];p&&p.visible&&h.push(e,a,p,n,V.z,d)}else s.visible&&h.push(e,a,s,n,V.z,null)}for(var A=e.children,g=0,v=A.length;g<v;g++)xe(A[g],t,n,r)}}function Oe(e,t,n){for(var r=!0===t.isScene?t.overrideMaterial:null,i=0,o=e.length;i<o;i++){var a=e[i],s=a.object,c=a.geometry,u=null===r?a.material:r,l=a.group;if(n.isArrayCamera)for(var d=n.cameras,h=0,p=d.length;h<p;h++){var A=d[h];s.layers.test(A.layers)&&(q.viewport(w.copy(A.viewport)),f.setupLightsView(A),Ne(s,t,A,c,u,l))}else Ne(s,t,n,c,u,l)}}function Ne(e,t,n,r,i,o){if(e.onBeforeRender(g,t,n,r,i,o),e.modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,e.matrixWorld),e.normalMatrix.getNormalMatrix(e.modelViewMatrix),e.isImmediateRenderObject){var a=ke(n,t,i,e);q.setMaterial(i),fe.reset(),function(e,t){e.render((function(e){g.renderBufferImmediate(e,t)}))}(e,a)}else g.renderBufferDirect(n,t,r,i,e,o);e.onAfterRender(g,t,n,r,i,o)}function Be(e,t,n){!0!==t.isScene&&(t=Q);var r=X.get(e),i=f.state.lights,o=f.state.shadowsArray,a=i.state.version,s=ne.getParameters(e,i.state,o,t,n),c=ne.getProgramCacheKey(s),u=r.programs;r.environment=e.isMeshStandardMaterial?t.environment:null,r.fog=t.fog,r.envMap=Y.get(e.envMap||r.environment),void 0===u&&(e.addEventListener("dispose",_e),u=new Map,r.programs=u);var l=u.get(c);if(void 0!==l){if(r.currentProgram===l&&r.lightsStateVersion===a)return Le(e,s),l}else s.uniforms=ne.getUniforms(e),e.onBuild(s,g),e.onBeforeCompile(s,g),l=ne.acquireProgram(s,c),u.set(c,l),r.uniforms=s.uniforms;var d=r.uniforms;(e.isShaderMaterial||e.isRawShaderMaterial)&&!0!==e.clipping||(d.clippingPlanes=ae.uniform),Le(e,s),r.needsLights=function(e){return e.isMeshLambertMaterial||e.isMeshToonMaterial||e.isMeshPhongMaterial||e.isMeshStandardMaterial||e.isShadowMaterial||e.isShaderMaterial&&!0===e.lights}(e),r.lightsStateVersion=a,r.needsLights&&(d.ambientLightColor.value=i.state.ambient,d.lightProbe.value=i.state.probe,d.directionalLights.value=i.state.directional,d.directionalLightShadows.value=i.state.directionalShadow,d.spotLights.value=i.state.spot,d.spotLightShadows.value=i.state.spotShadow,d.rectAreaLights.value=i.state.rectArea,d.ltc_1.value=i.state.rectAreaLTC1,d.ltc_2.value=i.state.rectAreaLTC2,d.pointLights.value=i.state.point,d.pointLightShadows.value=i.state.pointShadow,d.hemisphereLights.value=i.state.hemi,d.directionalShadowMap.value=i.state.directionalShadowMap,d.directionalShadowMatrix.value=i.state.directionalShadowMatrix,d.spotShadowMap.value=i.state.spotShadowMap,d.spotShadowMatrix.value=i.state.spotShadowMatrix,d.pointShadowMap.value=i.state.pointShadowMap,d.pointShadowMatrix.value=i.state.pointShadowMatrix);var h=l.getUniforms(),p=Fi.seqWithValue(h.seq,d);return r.currentProgram=l,r.uniformsList=p,l}function Le(e,t){var n=X.get(e);n.outputEncoding=t.outputEncoding,n.instancing=t.instancing,n.numClippingPlanes=t.numClippingPlanes,n.numIntersection=t.numClipIntersection,n.vertexAlphas=t.vertexAlphas}function ke(e,t,n,r){!0!==t.isScene&&(t=Q),J.resetTextureUnits();var i=t.fog,o=n.isMeshStandardMaterial?t.environment:null,a=null===b?g.outputEncoding:b.texture.encoding,s=Y.get(n.envMap||o),c=!0===n.vertexColors&&r.geometry&&r.geometry.attributes.color&&4===r.geometry.attributes.color.itemSize,u=X.get(n),l=f.state.lights;if(!0===F&&(!0===H||e!==_)){var d=e===_&&n.id===E;ae.setState(n,e,d)}var h=!1;n.version===u.__version?u.needsLights&&u.lightsStateVersion!==l.state.version||u.outputEncoding!==a||r.isInstancedMesh&&!1===u.instancing?h=!0:r.isInstancedMesh||!0!==u.instancing?u.envMap!==s||n.fog&&u.fog!==i?h=!0:void 0===u.numClippingPlanes||u.numClippingPlanes===ae.numPlanes&&u.numIntersection===ae.numIntersection?u.vertexAlphas!==c&&(h=!0):h=!0:h=!0:(h=!0,u.__version=n.version);var p=u.currentProgram;!0===h&&(p=Be(n,t,r));var A,v,m=!1,y=!1,w=!1,S=p.getUniforms(),T=u.uniforms;if(q.useProgram(p.program)&&(m=!0,y=!0,w=!0),n.id!==E&&(E=n.id,y=!0),m||_!==e){if(S.setValue(pe,"projectionMatrix",e.projectionMatrix),K.logarithmicDepthBuffer&&S.setValue(pe,"logDepthBufFC",2/(Math.log(e.far+1)/Math.LN2)),_!==e&&(_=e,y=!0,w=!0),n.isShaderMaterial||n.isMeshPhongMaterial||n.isMeshToonMaterial||n.isMeshStandardMaterial||n.envMap){var R=S.map.cameraPosition;void 0!==R&&R.setValue(pe,V.setFromMatrixPosition(e.matrixWorld))}(n.isMeshPhongMaterial||n.isMeshToonMaterial||n.isMeshLambertMaterial||n.isMeshBasicMaterial||n.isMeshStandardMaterial||n.isShaderMaterial)&&S.setValue(pe,"isOrthographic",!0===e.isOrthographicCamera),(n.isMeshPhongMaterial||n.isMeshToonMaterial||n.isMeshLambertMaterial||n.isMeshBasicMaterial||n.isMeshStandardMaterial||n.isShaderMaterial||n.isShadowMaterial||n.skinning)&&S.setValue(pe,"viewMatrix",e.matrixWorldInverse)}if(n.skinning){S.setOptional(pe,r,"bindMatrix"),S.setOptional(pe,r,"bindMatrixInverse");var C=r.skeleton;if(C){var N=C.bones;if(K.floatVertexTextures){if(null===C.boneTexture){var B=Math.sqrt(4*N.length);B=we(B),B=Math.max(B,4);var M=new Float32Array(B*B*4);M.set(C.boneMatrices);var k=new hr(M,B,B,L,O);C.boneMatrices=M,C.boneTexture=k,C.boneTextureSize=B}S.setValue(pe,"boneTexture",C.boneTexture,J),S.setValue(pe,"boneTextureSize",C.boneTextureSize)}else S.setOptional(pe,C,"boneMatrices")}}return(y||u.receiveShadow!==r.receiveShadow)&&(u.receiveShadow=r.receiveShadow,S.setValue(pe,"receiveShadow",r.receiveShadow)),y&&(S.setValue(pe,"toneMappingExposure",g.toneMappingExposure),u.needsLights&&(v=w,(A=T).ambientLightColor.needsUpdate=v,A.lightProbe.needsUpdate=v,A.directionalLights.needsUpdate=v,A.directionalLightShadows.needsUpdate=v,A.pointLights.needsUpdate=v,A.pointLightShadows.needsUpdate=v,A.spotLights.needsUpdate=v,A.spotLightShadows.needsUpdate=v,A.rectAreaLights.needsUpdate=v,A.hemisphereLights.needsUpdate=v),i&&n.fog&&re.refreshFogUniforms(T,i),re.refreshMaterialUniforms(T,n,x,I),Fi.upload(pe,u.uniformsList,T,J)),n.isShaderMaterial&&!0===n.uniformsNeedUpdate&&(Fi.upload(pe,u.uniformsList,T,J),n.uniformsNeedUpdate=!1),n.isSpriteMaterial&&S.setValue(pe,"center",r.center),S.setValue(pe,"modelViewMatrix",r.modelViewMatrix),S.setValue(pe,"normalMatrix",r.normalMatrix),S.setValue(pe,"modelMatrix",r.matrixWorld),p}Ie.setAnimationLoop((function(e){Se&&Se(e)})),"undefined"!=typeof window&&Ie.setContext(window),this.setAnimationLoop=function(e){Se=e,ye.setAnimationLoop(e),null===e?Ie.stop():Ie.start()},ye.addEventListener("sessionstart",Te),ye.addEventListener("sessionend",Ce),this.render=function(e,t){var n,r;if(void 0!==arguments[2]&&(console.warn("THREE.WebGLRenderer.render(): the renderTarget argument has been removed. Use .setRenderTarget() instead."),n=arguments[2]),void 0!==arguments[3]&&(console.warn("THREE.WebGLRenderer.render(): the forceClear argument has been removed. Use .clear() instead."),r=arguments[3]),void 0===t||!0===t.isCamera){if(!0!==v){!0===e.autoUpdate&&e.updateMatrixWorld(),null===t.parent&&t.updateMatrixWorld(),!0===ye.enabled&&!0===ye.isPresenting&&(t=ye.getCamera(t)),!0===e.isScene&&e.onBeforeRender(g,e,t,n||b),(f=oe.get(e,A.length)).init(),A.push(f),j.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),P.setFromProjectionMatrix(j),H=this.localClippingEnabled,F=ae.init(this.clippingPlanes,H,t),(h=ie.get(e,p.length)).init(),p.push(h),xe(e,t,0,g.sortObjects),h.finish(),!0===g.sortObjects&&h.sort(B,M),!0===F&&ae.beginShadows();var i=f.state.shadowsArray;se.render(i,e,t),f.setupLights(),f.setupLightsView(t),!0===F&&ae.endShadows(),!0===this.info.autoReset&&this.info.reset(),void 0!==n&&this.setRenderTarget(n),ce.render(h,e,t,r);var o=h.opaque,a=h.transparent;o.length>0&&Oe(o,e,t),a.length>0&&Oe(a,e,t),null!==b&&(J.updateRenderTargetMipmap(b),J.updateMultisampleRenderTarget(b)),!0===e.isScene&&e.onAfterRender(g,e,t),q.buffers.depth.setTest(!0),q.buffers.depth.setMask(!0),q.buffers.color.setMask(!0),q.setPolygonOffset(!1),fe.resetDefaultState(),E=-1,_=null,A.pop(),f=A.length>0?A[A.length-1]:null,p.pop(),h=p.length>0?p[p.length-1]:null}}else console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.getActiveCubeFace=function(){return m},this.getActiveMipmapLevel=function(){return y},this.getRenderTarget=function(){return b},this.setRenderTarget=function(e,t,n){void 0===t&&(t=0),void 0===n&&(n=0),b=e,m=t,y=n,e&&void 0===X.get(e).__webglFramebuffer&&J.setupRenderTarget(e);var r=null,i=!1,o=!1;if(e){var a=e.texture;(a.isDataTexture3D||a.isDataTexture2DArray)&&(o=!0);var s=X.get(e).__webglFramebuffer;e.isWebGLCubeRenderTarget?(r=s[t],i=!0):r=e.isWebGLMultisampleRenderTarget?X.get(e).__webglMultisampledFramebuffer:s,w.copy(e.viewport),S.copy(e.scissor),T=e.scissorTest}else w.copy(k).multiplyScalar(x).floor(),S.copy(U).multiplyScalar(x).floor(),T=D;if(q.bindFramebuffer(36160,r),q.viewport(w),q.scissor(S),q.setScissorTest(T),i){var c=X.get(e.texture);pe.framebufferTexture2D(36160,36064,34069+t,c.__webglTexture,n)}else if(o){var u=X.get(e.texture),l=t||0;pe.framebufferTextureLayer(36160,36064,u.__webglTexture,n||0,l)}},this.readRenderTargetPixels=function(e,t,n,r,i,o,a){if(e&&e.isWebGLRenderTarget){var s=X.get(e).__webglFramebuffer;if(e.isWebGLCubeRenderTarget&&void 0!==a&&(s=s[a]),s){q.bindFramebuffer(36160,s);try{var c=e.texture,u=c.format,l=c.type;if(u!==L&&he.convert(u)!==pe.getParameter(35739))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");var d=l===N&&(z.has("EXT_color_buffer_half_float")||K.isWebGL2&&z.has("EXT_color_buffer_float"));if(!(l===C||he.convert(l)===pe.getParameter(35738)||l===O&&(K.isWebGL2||z.has("OES_texture_float")||z.has("WEBGL_color_buffer_float"))||d))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");36053===pe.checkFramebufferStatus(36160)?t>=0&&t<=e.width-r&&n>=0&&n<=e.height-i&&pe.readPixels(t,n,r,i,he.convert(u),he.convert(l),o):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{var h=null!==b?X.get(b).__webglFramebuffer:null;q.bindFramebuffer(36160,h)}}}else console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.")},this.copyFramebufferToTexture=function(e,t,n){void 0===n&&(n=0);var r=Math.pow(2,-n),i=Math.floor(t.image.width*r),o=Math.floor(t.image.height*r),a=he.convert(t.format);J.setTexture2D(t,0),pe.copyTexImage2D(3553,n,a,e.x,e.y,i,o,0),q.unbindTexture()},this.copyTextureToTexture=function(e,t,n,r){void 0===r&&(r=0);var i=t.image.width,o=t.image.height,a=he.convert(n.format),s=he.convert(n.type);J.setTexture2D(n,0),pe.pixelStorei(37440,n.flipY),pe.pixelStorei(37441,n.premultiplyAlpha),pe.pixelStorei(3317,n.unpackAlignment),t.isDataTexture?pe.texSubImage2D(3553,r,e.x,e.y,i,o,a,s,t.image.data):t.isCompressedTexture?pe.compressedTexSubImage2D(3553,r,e.x,e.y,t.mipmaps[0].width,t.mipmaps[0].height,a,t.mipmaps[0].data):pe.texSubImage2D(3553,r,e.x,e.y,a,s,t.image),0===r&&n.generateMipmaps&&pe.generateMipmap(3553),q.unbindTexture()},this.copyTextureToTexture3D=function(e,t,n,r,i){if(void 0===i&&(i=0),g.isWebGL1Renderer)console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");else{var o,a=n.image,s=a.width,c=a.height,u=a.data,l=he.convert(r.format),d=he.convert(r.type);if(r.isDataTexture3D)J.setTexture3D(r,0),o=32879;else{if(!r.isDataTexture2DArray)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");J.setTexture2DArray(r,0),o=35866}pe.pixelStorei(37440,r.flipY),pe.pixelStorei(37441,r.premultiplyAlpha),pe.pixelStorei(3317,r.unpackAlignment);var h=pe.getParameter(3314),f=pe.getParameter(32878),p=pe.getParameter(3316),A=pe.getParameter(3315),v=pe.getParameter(32877);pe.pixelStorei(3314,s),pe.pixelStorei(32878,c),pe.pixelStorei(3316,e.min.x),pe.pixelStorei(3315,e.min.y),pe.pixelStorei(32877,e.min.z),pe.texSubImage3D(o,i,t.x,t.y,t.z,e.max.x-e.min.x+1,e.max.y-e.min.y+1,e.max.z-e.min.z+1,l,d,u),pe.pixelStorei(3314,h),pe.pixelStorei(32878,f),pe.pixelStorei(3316,p),pe.pixelStorei(3315,A),pe.pixelStorei(32877,v),0===i&&r.generateMipmaps&&pe.generateMipmap(o),q.unbindTexture()}},this.initTexture=function(e){J.setTexture2D(e,0),q.unbindTexture()},this.resetState=function(){m=0,y=0,b=null,q.reset(),fe.reset()},"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}var No=function(e){function t(){return e.apply(this,arguments)||this}return i(t,e),t}(Oo);No.prototype.isWebGL1Renderer=!0;var Bo=function(){function e(e,t){void 0===t&&(t=25e-5),this.name="",this.color=new ln(e),this.density=t}var t=e.prototype;return t.clone=function(){return new e(this.color,this.density)},t.toJSON=function(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}},e}();Bo.prototype.isFogExp2=!0;var Mo=function(){function e(e,t,n){void 0===t&&(t=1),void 0===n&&(n=1e3),this.name="",this.color=new ln(e),this.near=t,this.far=n}var t=e.prototype;return t.clone=function(){return new e(this.color,this.near,this.far)},t.toJSON=function(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}},e}();Mo.prototype.isFog=!0;var Lo=function(e){function t(){var t;return(t=e.call(this)||this).type="Scene",t.background=null,t.environment=null,t.fog=null,t.overrideMaterial=null,t.autoUpdate=!0,"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:o(t)})),t}i(t,e);var n=t.prototype;return n.copy=function(t,n){return e.prototype.copy.call(this,t,n),null!==t.background&&(this.background=t.background.clone()),null!==t.environment&&(this.environment=t.environment.clone()),null!==t.fog&&(this.fog=t.fog.clone()),null!==t.overrideMaterial&&(this.overrideMaterial=t.overrideMaterial.clone()),this.autoUpdate=t.autoUpdate,this.matrixAutoUpdate=t.matrixAutoUpdate,this},n.toJSON=function(t){var n=e.prototype.toJSON.call(this,t);return null!==this.background&&(n.object.background=this.background.toJSON(t)),null!==this.environment&&(n.object.environment=this.environment.toJSON(t)),null!==this.fog&&(n.object.fog=this.fog.toJSON()),n},t}(Ft);Lo.prototype.isScene=!0;var ko=function(){function e(e,t){this.array=e,this.stride=t,this.count=void 0!==e?e.length/t:0,this.usage=ue,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=me(),this.onUploadCallback=function(){}}var t=e.prototype;return t.setUsage=function(e){return this.usage=e,this},t.copy=function(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this},t.copyAt=function(e,t,n){e*=this.stride,n*=t.stride;for(var r=0,i=this.stride;r<i;r++)this.array[e+r]=t.array[n+r];return this},t.set=function(e,t){return void 0===t&&(t=0),this.array.set(e,t),this},t.clone=function(t){void 0===t.arrayBuffers&&(t.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=me()),void 0===t.arrayBuffers[this.array.buffer._uuid]&&(t.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);var n=new e(new this.array.constructor(t.arrayBuffers[this.array.buffer._uuid]),this.stride);return n.setUsage(this.usage),n},t.onUpload=function(e){return this.onUploadCallback=e,this},t.toJSON=function(e){return void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=me()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=Array.prototype.slice.call(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}},r(e,[{key:"needsUpdate",set:function(e){!0===e&&this.version++}}]),e}();ko.prototype.isInterleavedBuffer=!0;var Uo=new De,Do=function(){function e(e,t,n,r){this.name="",this.data=e,this.itemSize=t,this.offset=n,this.normalized=!0===r}var t=e.prototype;return t.applyMatrix4=function(e){for(var t=0,n=this.data.count;t<n;t++)Uo.x=this.getX(t),Uo.y=this.getY(t),Uo.z=this.getZ(t),Uo.applyMatrix4(e),this.setXYZ(t,Uo.x,Uo.y,Uo.z);return this},t.applyNormalMatrix=function(e){for(var t=0,n=this.count;t<n;t++)Uo.x=this.getX(t),Uo.y=this.getY(t),Uo.z=this.getZ(t),Uo.applyNormalMatrix(e),this.setXYZ(t,Uo.x,Uo.y,Uo.z);return this},t.transformDirection=function(e){for(var t=0,n=this.count;t<n;t++)Uo.x=this.getX(t),Uo.y=this.getY(t),Uo.z=this.getZ(t),Uo.transformDirection(e),this.setXYZ(t,Uo.x,Uo.y,Uo.z);return this},t.setX=function(e,t){return this.data.array[e*this.data.stride+this.offset]=t,this},t.setY=function(e,t){return this.data.array[e*this.data.stride+this.offset+1]=t,this},t.setZ=function(e,t){return this.data.array[e*this.data.stride+this.offset+2]=t,this},t.setW=function(e,t){return this.data.array[e*this.data.stride+this.offset+3]=t,this},t.getX=function(e){return this.data.array[e*this.data.stride+this.offset]},t.getY=function(e){return this.data.array[e*this.data.stride+this.offset+1]},t.getZ=function(e){return this.data.array[e*this.data.stride+this.offset+2]},t.getW=function(e){return this.data.array[e*this.data.stride+this.offset+3]},t.setXY=function(e,t,n){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=n,this},t.setXYZ=function(e,t,n,r){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this},t.setXYZW=function(e,t,n,r,i){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this.data.array[e+3]=i,this},t.clone=function(t){if(void 0===t){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interlaved buffer attribute will deinterleave buffer data.");for(var n=[],r=0;r<this.count;r++)for(var i=r*this.data.stride+this.offset,o=0;o<this.itemSize;o++)n.push(this.data.array[i+o]);return new pn(new this.array.constructor(n),this.itemSize,this.normalized)}return void 0===t.interleavedBuffers&&(t.interleavedBuffers={}),void 0===t.interleavedBuffers[this.data.uuid]&&(t.interleavedBuffers[this.data.uuid]=this.data.clone(t)),new e(t.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)},t.toJSON=function(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interlaved buffer attribute will deinterleave buffer data.");for(var t=[],n=0;n<this.count;n++)for(var r=n*this.data.stride+this.offset,i=0;i<this.itemSize;i++)t.push(this.data.array[r+i]);return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}},r(e,[{key:"count",get:function(){return this.data.count}},{key:"array",get:function(){return this.data.array}},{key:"needsUpdate",set:function(e){this.data.needsUpdate=e}}]),e}();Do.prototype.isInterleavedBufferAttribute=!0;var Po,Fo=function(e){function t(t){var n;return(n=e.call(this)||this).type="SpriteMaterial",n.color=new ln(16777215),n.map=null,n.alphaMap=null,n.rotation=0,n.sizeAttenuation=!0,n.transparent=!0,n.setValues(t),n}return i(t,e),t.prototype.copy=function(t){return e.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.alphaMap=t.alphaMap,this.rotation=t.rotation,this.sizeAttenuation=t.sizeAttenuation,this},t}(nn);Fo.prototype.isSpriteMaterial=!0;var Ho=new De,jo=new De,Vo=new De,Qo=new Re,Go=new Re,zo=new pt,Ko=new De,qo=new De,Wo=new De,Xo=new Re,Jo=new Re,Yo=new Re,Zo=function(e){function t(t){var n;if((n=e.call(this)||this).type="Sprite",void 0===Po){Po=new kn;var r=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),i=new ko(r,5);Po.setIndex([0,1,2,0,2,3]),Po.setAttribute("position",new Do(i,3,0,!1)),Po.setAttribute("uv",new Do(i,2,3,!1))}return n.geometry=Po,n.material=void 0!==t?t:new Fo,n.center=new Re(.5,.5),n}i(t,e);var n=t.prototype;return n.raycast=function(e,t){null===e.camera&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),jo.setFromMatrixScale(this.matrixWorld),zo.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),Vo.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&!1===this.material.sizeAttenuation&&jo.multiplyScalar(-Vo.z);var n,r,i=this.material.rotation;0!==i&&(r=Math.cos(i),n=Math.sin(i));var o=this.center;$o(Ko.set(-.5,-.5,0),Vo,o,jo,n,r),$o(qo.set(.5,-.5,0),Vo,o,jo,n,r),$o(Wo.set(.5,.5,0),Vo,o,jo,n,r),Xo.set(0,0),Jo.set(1,0),Yo.set(1,1);var a=e.ray.intersectTriangle(Ko,qo,Wo,!1,Ho);if(null!==a||($o(qo.set(-.5,.5,0),Vo,o,jo,n,r),Jo.set(0,1),null!==(a=e.ray.intersectTriangle(Ko,Wo,qo,!1,Ho)))){var s=e.ray.origin.distanceTo(Ho);s<e.near||s>e.far||t.push({distance:s,point:Ho.clone(),uv:en.getUV(Ho,Ko,qo,Wo,Xo,Jo,Yo,new Re),face:null,object:this})}},n.copy=function(t){return e.prototype.copy.call(this,t),void 0!==t.center&&this.center.copy(t.center),this.material=t.material,this},t}(Ft);function $o(e,t,n,r,i,o){Qo.subVectors(e,n).addScalar(.5).multiply(r),void 0!==i?(Go.x=o*Qo.x-i*Qo.y,Go.y=i*Qo.x+o*Qo.y):Go.copy(Qo),e.copy(t),e.x+=Go.x,e.y+=Go.y,e.applyMatrix4(zo)}Zo.prototype.isSprite=!0;var ea=new De,ta=new De,na=function(e){function t(){var t;return(t=e.call(this)||this)._currentLevel=0,t.type="LOD",Object.defineProperties(o(t),{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),t.autoUpdate=!0,t}i(t,e);var n=t.prototype;return n.copy=function(t){e.prototype.copy.call(this,t,!1);for(var n=t.levels,r=0,i=n.length;r<i;r++){var o=n[r];this.addLevel(o.object.clone(),o.distance)}return this.autoUpdate=t.autoUpdate,this},n.addLevel=function(e,t){void 0===t&&(t=0),t=Math.abs(t);var n,r=this.levels;for(n=0;n<r.length&&!(t<r[n].distance);n++);return r.splice(n,0,{distance:t,object:e}),this.add(e),this},n.getCurrentLevel=function(){return this._currentLevel},n.getObjectForDistance=function(e){var t=this.levels;if(t.length>0){var n,r;for(n=1,r=t.length;n<r&&!(e<t[n].distance);n++);return t[n-1].object}return null},n.raycast=function(e,t){if(this.levels.length>0){ea.setFromMatrixPosition(this.matrixWorld);var n=e.ray.origin.distanceTo(ea);this.getObjectForDistance(n).raycast(e,t)}},n.update=function(e){var t=this.levels;if(t.length>1){ea.setFromMatrixPosition(e.matrixWorld),ta.setFromMatrixPosition(this.matrixWorld);var n,r,i=ea.distanceTo(ta)/e.zoom;for(t[0].object.visible=!0,n=1,r=t.length;n<r&&i>=t[n].distance;n++)t[n-1].object.visible=!1,t[n].object.visible=!0;for(this._currentLevel=n-1;n<r;n++)t[n].object.visible=!1}},n.toJSON=function(t){var n=e.prototype.toJSON.call(this,t);!1===this.autoUpdate&&(n.object.autoUpdate=!1),n.object.levels=[];for(var r=this.levels,i=0,o=r.length;i<o;i++){var a=r[i];n.object.levels.push({object:a.object.uuid,distance:a.distance})}return n},t}(Ft),ra=new De,ia=new Me,oa=new Me,aa=new De,sa=new pt,ca=function(e){function t(t,n){var r;return(r=e.call(this,t,n)||this).type="SkinnedMesh",r.bindMode="attached",r.bindMatrix=new pt,r.bindMatrixInverse=new pt,r}i(t,e);var n=t.prototype;return n.copy=function(t){return e.prototype.copy.call(this,t),this.bindMode=t.bindMode,this.bindMatrix.copy(t.bindMatrix),this.bindMatrixInverse.copy(t.bindMatrixInverse),this.skeleton=t.skeleton,this},n.bind=function(e,t){this.skeleton=e,void 0===t&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()},n.pose=function(){this.skeleton.pose()},n.normalizeSkinWeights=function(){for(var e=new Me,t=this.geometry.attributes.skinWeight,n=0,r=t.count;n<r;n++){e.x=t.getX(n),e.y=t.getY(n),e.z=t.getZ(n),e.w=t.getW(n);var i=1/e.manhattanLength();i!==1/0?e.multiplyScalar(i):e.set(1,0,0,0),t.setXYZW(n,e.x,e.y,e.z,e.w)}},n.updateMatrixWorld=function(t){e.prototype.updateMatrixWorld.call(this,t),"attached"===this.bindMode?this.bindMatrixInverse.copy(this.matrixWorld).invert():"detached"===this.bindMode?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)},n.boneTransform=function(e,t){var n=this.skeleton,r=this.geometry;ia.fromBufferAttribute(r.attributes.skinIndex,e),oa.fromBufferAttribute(r.attributes.skinWeight,e),ra.fromBufferAttribute(r.attributes.position,e).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(var i=0;i<4;i++){var o=oa.getComponent(i);if(0!==o){var a=ia.getComponent(i);sa.multiplyMatrices(n.bones[a].matrixWorld,n.boneInverses[a]),t.addScaledVector(aa.copy(ra).applyMatrix4(sa),o)}}return t.applyMatrix4(this.bindMatrixInverse)},t}($n);ca.prototype.isSkinnedMesh=!0;var ua=function(e){function t(){var t;return(t=e.call(this)||this).type="Bone",t}return i(t,e),t}(Ft);ua.prototype.isBone=!0;var la=new pt,da=new pt,ha=function(){function e(e,t){void 0===e&&(e=[]),void 0===t&&(t=[]),this.uuid=me(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}var t=e.prototype;return t.init=function(){var e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(16*e.length),0===t.length)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(var n=0,r=this.bones.length;n<r;n++)this.boneInverses.push(new pt)}},t.calculateInverses=function(){this.boneInverses.length=0;for(var e=0,t=this.bones.length;e<t;e++){var n=new pt;this.bones[e]&&n.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(n)}},t.pose=function(){for(var e=0,t=this.bones.length;e<t;e++){var n=this.bones[e];n&&n.matrixWorld.copy(this.boneInverses[e]).invert()}for(var r=0,i=this.bones.length;r<i;r++){var o=this.bones[r];o&&(o.parent&&o.parent.isBone?(o.matrix.copy(o.parent.matrixWorld).invert(),o.matrix.multiply(o.matrixWorld)):o.matrix.copy(o.matrixWorld),o.matrix.decompose(o.position,o.quaternion,o.scale))}},t.update=function(){for(var e=this.bones,t=this.boneInverses,n=this.boneMatrices,r=this.boneTexture,i=0,o=e.length;i<o;i++){var a=e[i]?e[i].matrixWorld:da;la.multiplyMatrices(a,t[i]),la.toArray(n,16*i)}null!==r&&(r.needsUpdate=!0)},t.clone=function(){return new e(this.bones,this.boneInverses)},t.getBoneByName=function(e){for(var t=0,n=this.bones.length;t<n;t++){var r=this.bones[t];if(r.name===e)return r}},t.dispose=function(){null!==this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=null)},t.fromJSON=function(e,t){this.uuid=e.uuid;for(var n=0,r=e.bones.length;n<r;n++){var i=e.bones[n],o=t[i];void 0===o&&(console.warn("THREE.Skeleton: No bone found with UUID:",i),o=new ua),this.bones.push(o),this.boneInverses.push((new pt).fromArray(e.boneInverses[n]))}return this.init(),this},t.toJSON=function(){var e={metadata:{version:4.5,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;for(var t=this.bones,n=this.boneInverses,r=0,i=t.length;r<i;r++){var o=t[r];e.bones.push(o.uuid);var a=n[r];e.boneInverses.push(a.toArray())}return e},e}(),fa=new pt,pa=new pt,Aa=[],ga=new $n,va=function(e){function t(t,n,r){var i;return(i=e.call(this,t,n)||this).instanceMatrix=new pn(new Float32Array(16*r),16),i.instanceColor=null,i.count=r,i.frustumCulled=!1,i}i(t,e);var n=t.prototype;return n.copy=function(t){return e.prototype.copy.call(this,t),this.instanceMatrix.copy(t.instanceMatrix),null!==t.instanceColor&&(this.instanceColor=t.instanceColor.clone()),this.count=t.count,this},n.getColorAt=function(e,t){t.fromArray(this.instanceColor.array,3*e)},n.getMatrixAt=function(e,t){t.fromArray(this.instanceMatrix.array,16*e)},n.raycast=function(e,t){var n=this.matrixWorld,r=this.count;if(ga.geometry=this.geometry,ga.material=this.material,void 0!==ga.material)for(var i=0;i<r;i++){this.getMatrixAt(i,fa),pa.multiplyMatrices(n,fa),ga.matrixWorld=pa,ga.raycast(e,Aa);for(var o=0,a=Aa.length;o<a;o++){var s=Aa[o];s.instanceId=i,s.object=this,t.push(s)}Aa.length=0}},n.setColorAt=function(e,t){null===this.instanceColor&&(this.instanceColor=new pn(new Float32Array(3*this.count),3)),t.toArray(this.instanceColor.array,3*e)},n.setMatrixAt=function(e,t){t.toArray(this.instanceMatrix.array,16*e)},n.updateMorphTargets=function(){},n.dispose=function(){this.dispatchEvent({type:"dispose"})},t}($n);va.prototype.isInstancedMesh=!0;var ma=function(e){function t(t){var n;return(n=e.call(this)||this).type="LineBasicMaterial",n.color=new ln(16777215),n.linewidth=1,n.linecap="round",n.linejoin="round",n.morphTargets=!1,n.setValues(t),n}return i(t,e),t.prototype.copy=function(t){return e.prototype.copy.call(this,t),this.color.copy(t.color),this.linewidth=t.linewidth,this.linecap=t.linecap,this.linejoin=t.linejoin,this.morphTargets=t.morphTargets,this},t}(nn);ma.prototype.isLineBasicMaterial=!0;var ya=new De,ba=new De,Ea=new pt,_a=new ft,wa=new ot,Sa=function(e){function t(t,n){var r;return void 0===t&&(t=new kn),void 0===n&&(n=new ma),(r=e.call(this)||this).type="Line",r.geometry=t,r.material=n,r.updateMorphTargets(),r}i(t,e);var n=t.prototype;return n.copy=function(t){return e.prototype.copy.call(this,t),this.material=t.material,this.geometry=t.geometry,this},n.computeLineDistances=function(){var e=this.geometry;if(e.isBufferGeometry)if(null===e.index){for(var t=e.attributes.position,n=[0],r=1,i=t.count;r<i;r++)ya.fromBufferAttribute(t,r-1),ba.fromBufferAttribute(t,r),n[r]=n[r-1],n[r]+=ya.distanceTo(ba);e.setAttribute("lineDistance",new wn(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else e.isGeometry&&console.error("THREE.Line.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this},n.raycast=function(e,t){var n=this.geometry,r=this.matrixWorld,i=e.params.Line.threshold,o=n.drawRange;if(null===n.boundingSphere&&n.computeBoundingSphere(),wa.copy(n.boundingSphere),wa.applyMatrix4(r),wa.radius+=i,!1!==e.ray.intersectsSphere(wa)){Ea.copy(r).invert(),_a.copy(e.ray).applyMatrix4(Ea);var a=i/((this.scale.x+this.scale.y+this.scale.z)/3),s=a*a,c=new De,u=new De,l=new De,d=new De,h=this.isLineSegments?2:1;if(n.isBufferGeometry){var f=n.index,p=n.attributes.position;if(null!==f)for(var A=Math.max(0,o.start),g=Math.min(f.count,o.start+o.count)-1;A<g;A+=h){var v=f.getX(A),m=f.getX(A+1);if(c.fromBufferAttribute(p,v),u.fromBufferAttribute(p,m),!(_a.distanceSqToSegment(c,u,d,l)>s)){d.applyMatrix4(this.matrixWorld);var y=e.ray.origin.distanceTo(d);y<e.near||y>e.far||t.push({distance:y,point:l.clone().applyMatrix4(this.matrixWorld),index:A,face:null,faceIndex:null,object:this})}}else for(var b=Math.max(0,o.start),E=Math.min(p.count,o.start+o.count)-1;b<E;b+=h){if(c.fromBufferAttribute(p,b),u.fromBufferAttribute(p,b+1),!(_a.distanceSqToSegment(c,u,d,l)>s)){d.applyMatrix4(this.matrixWorld);var _=e.ray.origin.distanceTo(d);_<e.near||_>e.far||t.push({distance:_,point:l.clone().applyMatrix4(this.matrixWorld),index:b,face:null,faceIndex:null,object:this})}}}else n.isGeometry&&console.error("THREE.Line.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}},n.updateMorphTargets=function(){var e=this.geometry;if(e.isBufferGeometry){var t=e.morphAttributes,n=Object.keys(t);if(n.length>0){var r=t[n[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(var i=0,o=r.length;i<o;i++){var a=r[i].name||String(i);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=i}}}}else{var s=e.morphTargets;void 0!==s&&s.length>0&&console.error("THREE.Line.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}},t}(Ft);Sa.prototype.isLine=!0;var Ta=new De,Ra=new De,Ca=function(e){function t(t,n){var r;return(r=e.call(this,t,n)||this).type="LineSegments",r}return i(t,e),t.prototype.computeLineDistances=function(){var e=this.geometry;if(e.isBufferGeometry)if(null===e.index){for(var t=e.attributes.position,n=[],r=0,i=t.count;r<i;r+=2)Ta.fromBufferAttribute(t,r),Ra.fromBufferAttribute(t,r+1),n[r]=0===r?0:n[r-1],n[r+1]=n[r]+Ta.distanceTo(Ra);e.setAttribute("lineDistance",new wn(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else e.isGeometry&&console.error("THREE.LineSegments.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this},t}(Sa);Ca.prototype.isLineSegments=!0;var Ia=function(e){function t(t,n){var r;return(r=e.call(this,t,n)||this).type="LineLoop",r}return i(t,e),t}(Sa);Ia.prototype.isLineLoop=!0;var xa=function(e){function t(t){var n;return(n=e.call(this)||this).type="PointsMaterial",n.color=new ln(16777215),n.map=null,n.alphaMap=null,n.size=1,n.sizeAttenuation=!0,n.morphTargets=!1,n.setValues(t),n}return i(t,e),t.prototype.copy=function(t){return e.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.alphaMap=t.alphaMap,this.size=t.size,this.sizeAttenuation=t.sizeAttenuation,this.morphTargets=t.morphTargets,this},t}(nn);xa.prototype.isPointsMaterial=!0;var Oa=new pt,Na=new ft,Ba=new ot,Ma=new De,La=function(e){function t(t,n){var r;return void 0===t&&(t=new kn),void 0===n&&(n=new xa),(r=e.call(this)||this).type="Points",r.geometry=t,r.material=n,r.updateMorphTargets(),r}i(t,e);var n=t.prototype;return n.copy=function(t){return e.prototype.copy.call(this,t),this.material=t.material,this.geometry=t.geometry,this},n.raycast=function(e,t){var n=this.geometry,r=this.matrixWorld,i=e.params.Points.threshold,o=n.drawRange;if(null===n.boundingSphere&&n.computeBoundingSphere(),Ba.copy(n.boundingSphere),Ba.applyMatrix4(r),Ba.radius+=i,!1!==e.ray.intersectsSphere(Ba)){Oa.copy(r).invert(),Na.copy(e.ray).applyMatrix4(Oa);var a=i/((this.scale.x+this.scale.y+this.scale.z)/3),s=a*a;if(n.isBufferGeometry){var c=n.index,u=n.attributes.position;if(null!==c)for(var l=Math.max(0,o.start),d=Math.min(c.count,o.start+o.count);l<d;l++){var h=c.getX(l);Ma.fromBufferAttribute(u,h),ka(Ma,h,s,r,e,t,this)}else for(var f=Math.max(0,o.start),p=Math.min(u.count,o.start+o.count);f<p;f++)Ma.fromBufferAttribute(u,f),ka(Ma,f,s,r,e,t,this)}else console.error("THREE.Points.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}},n.updateMorphTargets=function(){var e=this.geometry;if(e.isBufferGeometry){var t=e.morphAttributes,n=Object.keys(t);if(n.length>0){var r=t[n[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(var i=0,o=r.length;i<o;i++){var a=r[i].name||String(i);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=i}}}}else{var s=e.morphTargets;void 0!==s&&s.length>0&&console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}},t}(Ft);function ka(e,t,n,r,i,o,a){var s=Na.distanceSqToPoint(e);if(s<n){var c=new De;Na.closestPointToPoint(e,c),c.applyMatrix4(r);var u=i.ray.origin.distanceTo(c);if(u<i.near||u>i.far)return;o.push({distance:u,distanceToRay:Math.sqrt(s),point:c,index:t,face:null,object:a})}}La.prototype.isPoints=!0;var Ua=function(e){function t(t,n,r,i,a,s,c,u,l){var d;(d=e.call(this,t,n,r,i,a,s,c,u,l)||this).format=void 0!==c?c:M,d.minFilter=void 0!==s?s:S,d.magFilter=void 0!==a?a:S,d.generateMipmaps=!1;var h=o(d);return"requestVideoFrameCallback"in t&&t.requestVideoFrameCallback((function e(){h.needsUpdate=!0,t.requestVideoFrameCallback(e)})),d}i(t,e);var n=t.prototype;return n.clone=function(){return new this.constructor(this.image).copy(this)},n.update=function(){var e=this.image;!1==="requestVideoFrameCallback"in e&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)},t}(Ne);Ua.prototype.isVideoTexture=!0;var Da=function(e){function t(t,n,r,i,o,a,s,c,u,l,d,h){var f;return(f=e.call(this,null,a,s,c,u,l,i,o,d,h)||this).image={width:n,height:r},f.mipmaps=t,f.flipY=!1,f.generateMipmaps=!1,f}return i(t,e),t}(Ne);Da.prototype.isCompressedTexture=!0;var Pa=function(e){function t(t,n,r,i,o,a,s,c,u){var l;return(l=e.call(this,t,n,r,i,o,a,s,c,u)||this).needsUpdate=!0,l}return i(t,e),t}(Ne);Pa.prototype.isCanvasTexture=!0;var Fa=function(e){function t(t,n,r,i,o,a,s,c,u,l){var d;if((l=void 0!==l?l:k)!==k&&l!==U)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");return void 0===r&&l===k&&(r=I),void 0===r&&l===U&&(r=B),(d=e.call(this,null,i,o,a,s,c,l,r,u)||this).image={width:t,height:n},d.magFilter=void 0!==s?s:E,d.minFilter=void 0!==c?c:E,d.flipY=!1,d.generateMipmaps=!1,d}return i(t,e),t}(Ne);Fa.prototype.isDepthTexture=!0;var Ha=function(e){function t(t,n,r,i){var o;void 0===t&&(t=1),void 0===n&&(n=8),void 0===r&&(r=0),void 0===i&&(i=2*Math.PI),(o=e.call(this)||this).type="CircleGeometry",o.parameters={radius:t,segments:n,thetaStart:r,thetaLength:i},n=Math.max(3,n);var a=[],s=[],c=[],u=[],l=new De,d=new Re;s.push(0,0,0),c.push(0,0,1),u.push(.5,.5);for(var h=0,f=3;h<=n;h++,f+=3){var p=r+h/n*i;l.x=t*Math.cos(p),l.y=t*Math.sin(p),s.push(l.x,l.y,l.z),c.push(0,0,1),d.x=(s[f]/t+1)/2,d.y=(s[f+1]/t+1)/2,u.push(d.x,d.y)}for(var A=1;A<=n;A++)a.push(A,A+1,0);return o.setIndex(a),o.setAttribute("position",new wn(s,3)),o.setAttribute("normal",new wn(c,3)),o.setAttribute("uv",new wn(u,2)),o}return i(t,e),t}(kn),ja=function(e){function t(t,n,r,i,a,s,c,u){var l;void 0===t&&(t=1),void 0===n&&(n=1),void 0===r&&(r=1),void 0===i&&(i=8),void 0===a&&(a=1),void 0===s&&(s=!1),void 0===c&&(c=0),void 0===u&&(u=2*Math.PI),(l=e.call(this)||this).type="CylinderGeometry",l.parameters={radiusTop:t,radiusBottom:n,height:r,radialSegments:i,heightSegments:a,openEnded:s,thetaStart:c,thetaLength:u};var d=o(l);i=Math.floor(i),a=Math.floor(a);var h=[],f=[],p=[],A=[],g=0,v=[],m=r/2,y=0;function b(e){for(var r=g,o=new Re,a=new De,s=0,l=!0===e?t:n,v=!0===e?1:-1,b=1;b<=i;b++)f.push(0,m*v,0),p.push(0,v,0),A.push(.5,.5),g++;for(var E=g,_=0;_<=i;_++){var w=_/i*u+c,S=Math.cos(w),T=Math.sin(w);a.x=l*T,a.y=m*v,a.z=l*S,f.push(a.x,a.y,a.z),p.push(0,v,0),o.x=.5*S+.5,o.y=.5*T*v+.5,A.push(o.x,o.y),g++}for(var R=0;R<i;R++){var C=r+R,I=E+R;!0===e?h.push(I,I+1,C):h.push(I+1,I,C),s+=3}d.addGroup(y,s,!0===e?1:2),y+=s}return function(){for(var e=new De,o=new De,s=0,l=(n-t)/r,b=0;b<=a;b++){for(var E=[],_=b/a,w=_*(n-t)+t,S=0;S<=i;S++){var T=S/i,R=T*u+c,C=Math.sin(R),I=Math.cos(R);o.x=w*C,o.y=-_*r+m,o.z=w*I,f.push(o.x,o.y,o.z),e.set(C,l,I).normalize(),p.push(e.x,e.y,e.z),A.push(T,1-_),E.push(g++)}v.push(E)}for(var x=0;x<i;x++)for(var O=0;O<a;O++){var N=v[O][x],B=v[O+1][x],M=v[O+1][x+1],L=v[O][x+1];h.push(N,B,L),h.push(B,M,L),s+=6}d.addGroup(y,s,0),y+=s}(),!1===s&&(t>0&&b(!0),n>0&&b(!1)),l.setIndex(h),l.setAttribute("position",new wn(f,3)),l.setAttribute("normal",new wn(p,3)),l.setAttribute("uv",new wn(A,2)),l}return i(t,e),t}(kn),Va=function(e){function t(t,n,r,i,o,a,s){var c;return void 0===t&&(t=1),void 0===n&&(n=1),void 0===r&&(r=8),void 0===i&&(i=1),void 0===o&&(o=!1),void 0===a&&(a=0),void 0===s&&(s=2*Math.PI),(c=e.call(this,0,t,n,r,i,o,a,s)||this).type="ConeGeometry",c.parameters={radius:t,height:n,radialSegments:r,heightSegments:i,openEnded:o,thetaStart:a,thetaLength:s},c}return i(t,e),t}(ja),Qa=function(e){function t(t,n,r,i){var o;void 0===r&&(r=1),void 0===i&&(i=0),(o=e.call(this)||this).type="PolyhedronGeometry",o.parameters={vertices:t,indices:n,radius:r,detail:i};var a=[],s=[];function c(e,t,n,r){for(var i=r+1,o=[],a=0;a<=i;a++){o[a]=[];for(var s=e.clone().lerp(n,a/i),c=t.clone().lerp(n,a/i),l=i-a,d=0;d<=l;d++)o[a][d]=0===d&&a===i?s:s.clone().lerp(c,d/l)}for(var h=0;h<i;h++)for(var f=0;f<2*(i-h)-1;f++){var p=Math.floor(f/2);f%2==0?(u(o[h][p+1]),u(o[h+1][p]),u(o[h][p])):(u(o[h][p+1]),u(o[h+1][p+1]),u(o[h+1][p]))}}function u(e){a.push(e.x,e.y,e.z)}function l(e,n){var r=3*e;n.x=t[r+0],n.y=t[r+1],n.z=t[r+2]}function d(e,t,n,r){r<0&&1===e.x&&(s[t]=e.x-1),0===n.x&&0===n.z&&(s[t]=r/2/Math.PI+.5)}function h(e){return Math.atan2(e.z,-e.x)}return function(e){for(var t=new De,r=new De,i=new De,o=0;o<n.length;o+=3)l(n[o+0],t),l(n[o+1],r),l(n[o+2],i),c(t,r,i,e)}(i),function(e){for(var t=new De,n=0;n<a.length;n+=3)t.x=a[n+0],t.y=a[n+1],t.z=a[n+2],t.normalize().multiplyScalar(e),a[n+0]=t.x,a[n+1]=t.y,a[n+2]=t.z}(r),function(){for(var e=new De,t=0;t<a.length;t+=3){e.x=a[t+0],e.y=a[t+1],e.z=a[t+2];var n=h(e)/2/Math.PI+.5,r=(i=e,Math.atan2(-i.y,Math.sqrt(i.x*i.x+i.z*i.z))/Math.PI+.5);s.push(n,1-r)}var i;(function(){for(var e=new De,t=new De,n=new De,r=new De,i=new Re,o=new Re,c=new Re,u=0,l=0;u<a.length;u+=9,l+=6){e.set(a[u+0],a[u+1],a[u+2]),t.set(a[u+3],a[u+4],a[u+5]),n.set(a[u+6],a[u+7],a[u+8]),i.set(s[l+0],s[l+1]),o.set(s[l+2],s[l+3]),c.set(s[l+4],s[l+5]),r.copy(e).add(t).add(n).divideScalar(3);var f=h(r);d(i,l+0,e,f),d(o,l+2,t,f),d(c,l+4,n,f)}})(),function(){for(var e=0;e<s.length;e+=6){var t=s[e+0],n=s[e+2],r=s[e+4],i=Math.max(t,n,r),o=Math.min(t,n,r);i>.9&&o<.1&&(t<.2&&(s[e+0]+=1),n<.2&&(s[e+2]+=1),r<.2&&(s[e+4]+=1))}}()}(),o.setAttribute("position",new wn(a,3)),o.setAttribute("normal",new wn(a.slice(),3)),o.setAttribute("uv",new wn(s,2)),0===i?o.computeVertexNormals():o.normalizeNormals(),o}return i(t,e),t}(kn),Ga=function(e){function t(t,n){var r;void 0===t&&(t=1),void 0===n&&(n=0);var i=(1+Math.sqrt(5))/2,o=1/i,a=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-o,-i,0,-o,i,0,o,-i,0,o,i,-o,-i,0,-o,i,0,o,-i,0,o,i,0,-i,0,-o,i,0,-o,-i,0,o,i,0,o];return(r=e.call(this,a,[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],t,n)||this).type="DodecahedronGeometry",r.parameters={radius:t,detail:n},r}return i(t,e),t}(Qa),za=new De,Ka=new De,qa=new De,Wa=new en,Xa=function(e){function t(t,n){var r;if((r=e.call(this)||this).type="EdgesGeometry",r.parameters={thresholdAngle:n},n=void 0!==n?n:1,!0===t.isGeometry)return console.error("THREE.EdgesGeometry no longer supports THREE.Geometry. Use THREE.BufferGeometry instead."),o(r);for(var i=Math.pow(10,4),a=Math.cos(ge*n),s=t.getIndex(),c=t.getAttribute("position"),u=s?s.count:c.count,l=[0,0,0],d=["a","b","c"],h=new Array(3),f={},p=[],A=0;A<u;A+=3){s?(l[0]=s.getX(A),l[1]=s.getX(A+1),l[2]=s.getX(A+2)):(l[0]=A,l[1]=A+1,l[2]=A+2);var g=Wa.a,v=Wa.b,m=Wa.c;if(g.fromBufferAttribute(c,l[0]),v.fromBufferAttribute(c,l[1]),m.fromBufferAttribute(c,l[2]),Wa.getNormal(qa),h[0]=Math.round(g.x*i)+","+Math.round(g.y*i)+","+Math.round(g.z*i),h[1]=Math.round(v.x*i)+","+Math.round(v.y*i)+","+Math.round(v.z*i),h[2]=Math.round(m.x*i)+","+Math.round(m.y*i)+","+Math.round(m.z*i),h[0]!==h[1]&&h[1]!==h[2]&&h[2]!==h[0])for(var y=0;y<3;y++){var b=(y+1)%3,E=h[y],_=h[b],w=Wa[d[y]],S=Wa[d[b]],T=E+"_"+_,R=_+"_"+E;R in f&&f[R]?(qa.dot(f[R].normal)<=a&&(p.push(w.x,w.y,w.z),p.push(S.x,S.y,S.z)),f[R]=null):T in f||(f[T]={index0:l[y],index1:l[b],normal:qa.clone()})}}for(var C in f)if(f[C]){var I=f[C],x=I.index0,O=I.index1;za.fromBufferAttribute(c,x),Ka.fromBufferAttribute(c,O),p.push(za.x,za.y,za.z),p.push(Ka.x,Ka.y,Ka.z)}return r.setAttribute("position",new wn(p,3)),r}return i(t,e),t}(kn),Ja=function(e,t,n){n=n||2;var r,i,o,a,s,c,u,l=t&&t.length,d=l?t[0]*n:e.length,h=Ya(e,0,d,n,!0),f=[];if(!h||h.next===h.prev)return f;if(l&&(h=function(e,t,n,r){var i,o,a,s=[];for(i=0,o=t.length;i<o;i++)(a=Ya(e,t[i]*r,i<o-1?t[i+1]*r:e.length,r,!1))===a.next&&(a.steiner=!0),s.push(cs(a));for(s.sort(is),i=0;i<s.length;i++)os(s[i],n),n=Za(n,n.next);return n}(e,t,h,n)),e.length>80*n){r=o=e[0],i=a=e[1];for(var p=n;p<d;p+=n)(s=e[p])<r&&(r=s),(c=e[p+1])<i&&(i=c),s>o&&(o=s),c>a&&(a=c);u=0!==(u=Math.max(o-r,a-i))?1/u:0}return $a(h,f,n,r,i,u),f};function Ya(e,t,n,r,i){var o,a;if(i===function(e,t,n,r){for(var i=0,o=t,a=n-r;o<n;o+=r)i+=(e[a]-e[o])*(e[o+1]+e[a+1]),a=o;return i}(e,t,n,r)>0)for(o=t;o<n;o+=r)a=ms(o,e[o],e[o+1],a);else for(o=n-r;o>=t;o-=r)a=ms(o,e[o],e[o+1],a);return a&&hs(a,a.next)&&(ys(a),a=a.next),a}function Za(e,t){if(!e)return e;t||(t=e);var n,r=e;do{if(n=!1,r.steiner||!hs(r,r.next)&&0!==ds(r.prev,r,r.next))r=r.next;else{if(ys(r),(r=t=r.prev)===r.next)break;n=!0}}while(n||r!==t);return t}function $a(e,t,n,r,i,o,a){if(e){!a&&o&&function(e,t,n,r){var i=e;do{null===i.z&&(i.z=ss(i.x,i.y,t,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==e);i.prevZ.nextZ=null,i.prevZ=null,function(e){var t,n,r,i,o,a,s,c,u=1;do{for(n=e,e=null,o=null,a=0;n;){for(a++,r=n,s=0,t=0;t<u&&(s++,r=r.nextZ);t++);for(c=u;s>0||c>0&&r;)0!==s&&(0===c||!r||n.z<=r.z)?(i=n,n=n.nextZ,s--):(i=r,r=r.nextZ,c--),o?o.nextZ=i:e=i,i.prevZ=o,o=i;n=r}o.nextZ=null,u*=2}while(a>1)}(i)}(e,r,i,o);for(var s,c,u=e;e.prev!==e.next;)if(s=e.prev,c=e.next,o?ts(e,r,i,o):es(e))t.push(s.i/n),t.push(e.i/n),t.push(c.i/n),ys(e),e=c.next,u=c.next;else if((e=c)===u){a?1===a?$a(e=ns(Za(e),t,n),t,n,r,i,o,2):2===a&&rs(e,t,n,r,i,o):$a(Za(e),t,n,r,i,o,1);break}}}function es(e){var t=e.prev,n=e,r=e.next;if(ds(t,n,r)>=0)return!1;for(var i=e.next.next;i!==e.prev;){if(us(t.x,t.y,n.x,n.y,r.x,r.y,i.x,i.y)&&ds(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function ts(e,t,n,r){var i=e.prev,o=e,a=e.next;if(ds(i,o,a)>=0)return!1;for(var s=i.x<o.x?i.x<a.x?i.x:a.x:o.x<a.x?o.x:a.x,c=i.y<o.y?i.y<a.y?i.y:a.y:o.y<a.y?o.y:a.y,u=i.x>o.x?i.x>a.x?i.x:a.x:o.x>a.x?o.x:a.x,l=i.y>o.y?i.y>a.y?i.y:a.y:o.y>a.y?o.y:a.y,d=ss(s,c,t,n,r),h=ss(u,l,t,n,r),f=e.prevZ,p=e.nextZ;f&&f.z>=d&&p&&p.z<=h;){if(f!==e.prev&&f!==e.next&&us(i.x,i.y,o.x,o.y,a.x,a.y,f.x,f.y)&&ds(f.prev,f,f.next)>=0)return!1;if(f=f.prevZ,p!==e.prev&&p!==e.next&&us(i.x,i.y,o.x,o.y,a.x,a.y,p.x,p.y)&&ds(p.prev,p,p.next)>=0)return!1;p=p.nextZ}for(;f&&f.z>=d;){if(f!==e.prev&&f!==e.next&&us(i.x,i.y,o.x,o.y,a.x,a.y,f.x,f.y)&&ds(f.prev,f,f.next)>=0)return!1;f=f.prevZ}for(;p&&p.z<=h;){if(p!==e.prev&&p!==e.next&&us(i.x,i.y,o.x,o.y,a.x,a.y,p.x,p.y)&&ds(p.prev,p,p.next)>=0)return!1;p=p.nextZ}return!0}function ns(e,t,n){var r=e;do{var i=r.prev,o=r.next.next;!hs(i,o)&&fs(i,r,r.next,o)&&gs(i,o)&&gs(o,i)&&(t.push(i.i/n),t.push(r.i/n),t.push(o.i/n),ys(r),ys(r.next),r=e=o),r=r.next}while(r!==e);return Za(r)}function rs(e,t,n,r,i,o){var a=e;do{for(var s=a.next.next;s!==a.prev;){if(a.i!==s.i&&ls(a,s)){var c=vs(a,s);return a=Za(a,a.next),c=Za(c,c.next),$a(a,t,n,r,i,o),void $a(c,t,n,r,i,o)}s=s.next}a=a.next}while(a!==e)}function is(e,t){return e.x-t.x}function os(e,t){if(t=function(e,t){var n,r=t,i=e.x,o=e.y,a=-1/0;do{if(o<=r.y&&o>=r.next.y&&r.next.y!==r.y){var s=r.x+(o-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(s<=i&&s>a){if(a=s,s===i){if(o===r.y)return r;if(o===r.next.y)return r.next}n=r.x<r.next.x?r:r.next}}r=r.next}while(r!==t);if(!n)return null;if(i===a)return n;var c,u=n,l=n.x,d=n.y,h=1/0;r=n;do{i>=r.x&&r.x>=l&&i!==r.x&&us(o<d?i:a,o,l,d,o<d?a:i,o,r.x,r.y)&&(c=Math.abs(o-r.y)/(i-r.x),gs(r,e)&&(c<h||c===h&&(r.x>n.x||r.x===n.x&&as(n,r)))&&(n=r,h=c)),r=r.next}while(r!==u);return n}(e,t)){var n=vs(t,e);Za(t,t.next),Za(n,n.next)}}function as(e,t){return ds(e.prev,e,t.prev)<0&&ds(t.next,e,e.next)<0}function ss(e,t,n,r,i){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-n)*i)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-r)*i)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function cs(e){var t=e,n=e;do{(t.x<n.x||t.x===n.x&&t.y<n.y)&&(n=t),t=t.next}while(t!==e);return n}function us(e,t,n,r,i,o,a,s){return(i-a)*(t-s)-(e-a)*(o-s)>=0&&(e-a)*(r-s)-(n-a)*(t-s)>=0&&(n-a)*(o-s)-(i-a)*(r-s)>=0}function ls(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){var n=e;do{if(n.i!==e.i&&n.next.i!==e.i&&n.i!==t.i&&n.next.i!==t.i&&fs(n,n.next,e,t))return!0;n=n.next}while(n!==e);return!1}(e,t)&&(gs(e,t)&&gs(t,e)&&function(e,t){var n=e,r=!1,i=(e.x+t.x)/2,o=(e.y+t.y)/2;do{n.y>o!=n.next.y>o&&n.next.y!==n.y&&i<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==e);return r}(e,t)&&(ds(e.prev,e,t.prev)||ds(e,t.prev,t))||hs(e,t)&&ds(e.prev,e,e.next)>0&&ds(t.prev,t,t.next)>0)}function ds(e,t,n){return(t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y)}function hs(e,t){return e.x===t.x&&e.y===t.y}function fs(e,t,n,r){var i=As(ds(e,t,n)),o=As(ds(e,t,r)),a=As(ds(n,r,e)),s=As(ds(n,r,t));return i!==o&&a!==s||(!(0!==i||!ps(e,n,t))||(!(0!==o||!ps(e,r,t))||(!(0!==a||!ps(n,e,r))||!(0!==s||!ps(n,t,r)))))}function ps(e,t,n){return t.x<=Math.max(e.x,n.x)&&t.x>=Math.min(e.x,n.x)&&t.y<=Math.max(e.y,n.y)&&t.y>=Math.min(e.y,n.y)}function As(e){return e>0?1:e<0?-1:0}function gs(e,t){return ds(e.prev,e,e.next)<0?ds(e,t,e.next)>=0&&ds(e,e.prev,t)>=0:ds(e,t,e.prev)<0||ds(e,e.next,t)<0}function vs(e,t){var n=new bs(e.i,e.x,e.y),r=new bs(t.i,t.x,t.y),i=e.next,o=t.prev;return e.next=t,t.prev=e,n.next=i,i.prev=n,r.next=n,n.prev=r,o.next=r,r.prev=o,r}function ms(e,t,n,r){var i=new bs(e,t,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function ys(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function bs(e,t,n){this.i=e,this.x=t,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}var Es=function(){function e(){}return e.area=function(e){for(var t=e.length,n=0,r=t-1,i=0;i<t;r=i++)n+=e[r].x*e[i].y-e[i].x*e[r].y;return.5*n},e.isClockWise=function(t){return e.area(t)<0},e.triangulateShape=function(e,t){var n=[],r=[],i=[];_s(e),ws(n,e);var o=e.length;t.forEach(_s);for(var a=0;a<t.length;a++)r.push(o),o+=t[a].length,ws(n,t[a]);for(var s=Ja(n,r),c=0;c<s.length;c+=3)i.push(s.slice(c,c+3));return i},e}();function _s(e){var t=e.length;t>2&&e[t-1].equals(e[0])&&e.pop()}function ws(e,t){for(var n=0;n<t.length;n++)e.push(t[n].x),e.push(t[n].y)}var Ss=function(e){function t(t,n){var r;(r=e.call(this)||this).type="ExtrudeGeometry",r.parameters={shapes:t,options:n},t=Array.isArray(t)?t:[t];for(var i=o(r),a=[],s=[],c=0,u=t.length;c<u;c++){l(t[c])}function l(e){var t=[],r=void 0!==n.curveSegments?n.curveSegments:12,o=void 0!==n.steps?n.steps:1,c=void 0!==n.depth?n.depth:100,u=void 0===n.bevelEnabled||n.bevelEnabled,l=void 0!==n.bevelThickness?n.bevelThickness:6,d=void 0!==n.bevelSize?n.bevelSize:l-2,h=void 0!==n.bevelOffset?n.bevelOffset:0,f=void 0!==n.bevelSegments?n.bevelSegments:3,p=n.extrudePath,A=void 0!==n.UVGenerator?n.UVGenerator:Ts;void 0!==n.amount&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),c=n.amount);var g,v,m,y,b,E=!1;p&&(g=p.getSpacedPoints(o),E=!0,u=!1,v=p.computeFrenetFrames(o,!1),m=new De,y=new De,b=new De),u||(f=0,l=0,d=0,h=0);var _=e.extractPoints(r),w=_.shape,S=_.holes;if(!Es.isClockWise(w)){w=w.reverse();for(var T=0,R=S.length;T<R;T++){var C=S[T];Es.isClockWise(C)&&(S[T]=C.reverse())}}for(var I=Es.triangulateShape(w,S),x=w,O=0,N=S.length;O<N;O++){var B=S[O];w=w.concat(B)}function M(e,t,n){return t||console.error("THREE.ExtrudeGeometry: vec does not exist"),t.clone().multiplyScalar(n).add(e)}var L=w.length,k=I.length;function U(e,t,n){var r,i,o,a=e.x-t.x,s=e.y-t.y,c=n.x-e.x,u=n.y-e.y,l=a*a+s*s,d=a*u-s*c;if(Math.abs(d)>Number.EPSILON){var h=Math.sqrt(l),f=Math.sqrt(c*c+u*u),p=t.x-s/h,A=t.y+a/h,g=((n.x-u/f-p)*u-(n.y+c/f-A)*c)/(a*u-s*c),v=(r=p+a*g-e.x)*r+(i=A+s*g-e.y)*i;if(v<=2)return new Re(r,i);o=Math.sqrt(v/2)}else{var m=!1;a>Number.EPSILON?c>Number.EPSILON&&(m=!0):a<-Number.EPSILON?c<-Number.EPSILON&&(m=!0):Math.sign(s)===Math.sign(u)&&(m=!0),m?(r=-s,i=a,o=Math.sqrt(l)):(r=a,i=s,o=Math.sqrt(l/2))}return new Re(r/o,i/o)}for(var D=[],P=0,F=x.length,H=F-1,j=P+1;P<F;P++,H++,j++)H===F&&(H=0),j===F&&(j=0),D[P]=U(x[P],x[H],x[j]);for(var V,Q=[],G=D.concat(),z=0,K=S.length;z<K;z++){var q=S[z];V=[];for(var W=0,X=q.length,J=X-1,Y=W+1;W<X;W++,J++,Y++)J===X&&(J=0),Y===X&&(Y=0),V[W]=U(q[W],q[J],q[Y]);Q.push(V),G=G.concat(V)}for(var Z=0;Z<f;Z++){for(var $=Z/f,ee=l*Math.cos($*Math.PI/2),te=d*Math.sin($*Math.PI/2)+h,ne=0,re=x.length;ne<re;ne++){var ie=M(x[ne],D[ne],te);Be(ie.x,ie.y,-ee)}for(var oe=0,ae=S.length;oe<ae;oe++){var se=S[oe];V=Q[oe];for(var ce=0,ue=se.length;ce<ue;ce++){var le=M(se[ce],V[ce],te);Be(le.x,le.y,-ee)}}}for(var de=d+h,he=0;he<L;he++){var fe=u?M(w[he],G[he],de):w[he];E?(y.copy(v.normals[0]).multiplyScalar(fe.x),m.copy(v.binormals[0]).multiplyScalar(fe.y),b.copy(g[0]).add(y).add(m),Be(b.x,b.y,b.z)):Be(fe.x,fe.y,0)}for(var pe=1;pe<=o;pe++)for(var Ae=0;Ae<L;Ae++){var ge=u?M(w[Ae],G[Ae],de):w[Ae];E?(y.copy(v.normals[pe]).multiplyScalar(ge.x),m.copy(v.binormals[pe]).multiplyScalar(ge.y),b.copy(g[pe]).add(y).add(m),Be(b.x,b.y,b.z)):Be(ge.x,ge.y,c/o*pe)}for(var ve=f-1;ve>=0;ve--){for(var me=ve/f,ye=l*Math.cos(me*Math.PI/2),be=d*Math.sin(me*Math.PI/2)+h,Ee=0,_e=x.length;Ee<_e;Ee++){var we=M(x[Ee],D[Ee],be);Be(we.x,we.y,c+ye)}for(var Se=0,Te=S.length;Se<Te;Se++){var Ce=S[Se];V=Q[Se];for(var Ie=0,xe=Ce.length;Ie<xe;Ie++){var Oe=M(Ce[Ie],V[Ie],be);E?Be(Oe.x,Oe.y+g[o-1].y,g[o-1].x+ye):Be(Oe.x,Oe.y,c+ye)}}}function Ne(e,t){for(var n=e.length;--n>=0;){var r=n,i=n-1;i<0&&(i=e.length-1);for(var a=0,s=o+2*f;a<s;a++){var c=L*a,u=L*(a+1);Le(t+r+c,t+i+c,t+i+u,t+r+u)}}}function Be(e,n,r){t.push(e),t.push(n),t.push(r)}function Me(e,t,n){ke(e),ke(t),ke(n);var r=a.length/3,o=A.generateTopUV(i,a,r-3,r-2,r-1);Ue(o[0]),Ue(o[1]),Ue(o[2])}function Le(e,t,n,r){ke(e),ke(t),ke(r),ke(t),ke(n),ke(r);var o=a.length/3,s=A.generateSideWallUV(i,a,o-6,o-3,o-2,o-1);Ue(s[0]),Ue(s[1]),Ue(s[3]),Ue(s[1]),Ue(s[2]),Ue(s[3])}function ke(e){a.push(t[3*e+0]),a.push(t[3*e+1]),a.push(t[3*e+2])}function Ue(e){s.push(e.x),s.push(e.y)}!function(){var e=a.length/3;if(u){for(var t=0,n=L*t,r=0;r<k;r++){var s=I[r];Me(s[2]+n,s[1]+n,s[0]+n)}n=L*(t=o+2*f);for(var c=0;c<k;c++){var l=I[c];Me(l[0]+n,l[1]+n,l[2]+n)}}else{for(var d=0;d<k;d++){var h=I[d];Me(h[2],h[1],h[0])}for(var p=0;p<k;p++){var A=I[p];Me(A[0]+L*o,A[1]+L*o,A[2]+L*o)}}i.addGroup(e,a.length/3-e,0)}(),function(){var e=a.length/3,t=0;Ne(x,t),t+=x.length;for(var n=0,r=S.length;n<r;n++){var o=S[n];Ne(o,t),t+=o.length}i.addGroup(e,a.length/3-e,1)}()}return r.setAttribute("position",new wn(a,3)),r.setAttribute("uv",new wn(s,2)),r.computeVertexNormals(),r}return i(t,e),t.prototype.toJSON=function(){var e=kn.prototype.toJSON.call(this);return function(e,t,n){if(n.shapes=[],Array.isArray(e))for(var r=0,i=e.length;r<i;r++){var o=e[r];n.shapes.push(o.uuid)}else n.shapes.push(e.uuid);void 0!==t.extrudePath&&(n.options.extrudePath=t.extrudePath.toJSON());return n}(this.parameters.shapes,this.parameters.options,e)},t}(kn),Ts={generateTopUV:function(e,t,n,r,i){var o=t[3*n],a=t[3*n+1],s=t[3*r],c=t[3*r+1],u=t[3*i],l=t[3*i+1];return[new Re(o,a),new Re(s,c),new Re(u,l)]},generateSideWallUV:function(e,t,n,r,i,o){var a=t[3*n],s=t[3*n+1],c=t[3*n+2],u=t[3*r],l=t[3*r+1],d=t[3*r+2],h=t[3*i],f=t[3*i+1],p=t[3*i+2],A=t[3*o],g=t[3*o+1],v=t[3*o+2];return Math.abs(s-l)<.01?[new Re(a,1-c),new Re(u,1-d),new Re(h,1-p),new Re(A,1-v)]:[new Re(s,1-c),new Re(l,1-d),new Re(f,1-p),new Re(g,1-v)]}};var Rs=function(e){function t(t,n){var r;void 0===t&&(t=1),void 0===n&&(n=0);var i=(1+Math.sqrt(5))/2,o=[-1,i,0,1,i,0,-1,-i,0,1,-i,0,0,-1,i,0,1,i,0,-1,-i,0,1,-i,i,0,-1,i,0,1,-i,0,-1,-i,0,1];return(r=e.call(this,o,[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],t,n)||this).type="IcosahedronGeometry",r.parameters={radius:t,detail:n},r}return i(t,e),t}(Qa),Cs=function(e){function t(t,n,r,i){var o;void 0===n&&(n=12),void 0===r&&(r=0),void 0===i&&(i=2*Math.PI),(o=e.call(this)||this).type="LatheGeometry",o.parameters={points:t,segments:n,phiStart:r,phiLength:i},n=Math.floor(n),i=ye(i,0,2*Math.PI);for(var a=[],s=[],c=[],u=1/n,l=new De,d=new Re,h=0;h<=n;h++)for(var f=r+h*u*i,p=Math.sin(f),A=Math.cos(f),g=0;g<=t.length-1;g++)l.x=t[g].x*p,l.y=t[g].y,l.z=t[g].x*A,s.push(l.x,l.y,l.z),d.x=h/n,d.y=g/(t.length-1),c.push(d.x,d.y);for(var v=0;v<n;v++)for(var m=0;m<t.length-1;m++){var y=m+v*t.length,b=y,E=y+t.length,_=y+t.length+1,w=y+1;a.push(b,E,w),a.push(E,_,w)}if(o.setIndex(a),o.setAttribute("position",new wn(s,3)),o.setAttribute("uv",new wn(c,2)),o.computeVertexNormals(),i===2*Math.PI)for(var S=o.attributes.normal.array,T=new De,R=new De,C=new De,I=n*t.length*3,x=0,O=0;x<t.length;x++,O+=3)T.x=S[O+0],T.y=S[O+1],T.z=S[O+2],R.x=S[I+O+0],R.y=S[I+O+1],R.z=S[I+O+2],C.addVectors(T,R).normalize(),S[O+0]=S[I+O+0]=C.x,S[O+1]=S[I+O+1]=C.y,S[O+2]=S[I+O+2]=C.z;return o}return i(t,e),t}(kn),Is=function(e){function t(t,n){var r;void 0===t&&(t=1),void 0===n&&(n=0);return(r=e.call(this,[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],t,n)||this).type="OctahedronGeometry",r.parameters={radius:t,detail:n},r}return i(t,e),t}(Qa),xs=function(e){function t(t,n,r){var i;(i=e.call(this)||this).type="ParametricGeometry",i.parameters={func:t,slices:n,stacks:r};var o=[],a=[],s=[],c=[],u=1e-5,l=new De,d=new De,h=new De,f=new De,p=new De;t.length<3&&console.error("THREE.ParametricGeometry: Function must now modify a Vector3 as third parameter.");for(var A=n+1,g=0;g<=r;g++)for(var v=g/r,m=0;m<=n;m++){var y=m/n;t(y,v,d),a.push(d.x,d.y,d.z),y-u>=0?(t(y-u,v,h),f.subVectors(d,h)):(t(y+u,v,h),f.subVectors(h,d)),v-u>=0?(t(y,v-u,h),p.subVectors(d,h)):(t(y,v+u,h),p.subVectors(h,d)),l.crossVectors(f,p).normalize(),s.push(l.x,l.y,l.z),c.push(y,v)}for(var b=0;b<r;b++)for(var E=0;E<n;E++){var _=b*A+E,w=b*A+E+1,S=(b+1)*A+E+1,T=(b+1)*A+E;o.push(_,w,T),o.push(w,S,T)}return i.setIndex(o),i.setAttribute("position",new wn(a,3)),i.setAttribute("normal",new wn(s,3)),i.setAttribute("uv",new wn(c,2)),i}return i(t,e),t}(kn),Os=function(e){function t(t,n,r,i,o,a){var s;void 0===t&&(t=.5),void 0===n&&(n=1),void 0===r&&(r=8),void 0===i&&(i=1),void 0===o&&(o=0),void 0===a&&(a=2*Math.PI),(s=e.call(this)||this).type="RingGeometry",s.parameters={innerRadius:t,outerRadius:n,thetaSegments:r,phiSegments:i,thetaStart:o,thetaLength:a},r=Math.max(3,r);for(var c=[],u=[],l=[],d=[],h=t,f=(n-t)/(i=Math.max(1,i)),p=new De,A=new Re,g=0;g<=i;g++){for(var v=0;v<=r;v++){var m=o+v/r*a;p.x=h*Math.cos(m),p.y=h*Math.sin(m),u.push(p.x,p.y,p.z),l.push(0,0,1),A.x=(p.x/n+1)/2,A.y=(p.y/n+1)/2,d.push(A.x,A.y)}h+=f}for(var y=0;y<i;y++)for(var b=y*(r+1),E=0;E<r;E++){var _=E+b,w=_,S=_+r+1,T=_+r+2,R=_+1;c.push(w,S,R),c.push(S,T,R)}return s.setIndex(c),s.setAttribute("position",new wn(u,3)),s.setAttribute("normal",new wn(l,3)),s.setAttribute("uv",new wn(d,2)),s}return i(t,e),t}(kn),Ns=function(e){function t(t,n){var r;void 0===n&&(n=12),(r=e.call(this)||this).type="ShapeGeometry",r.parameters={shapes:t,curveSegments:n};var i=[],o=[],a=[],s=[],c=0,u=0;if(!1===Array.isArray(t))d(t);else for(var l=0;l<t.length;l++)d(t[l]),r.addGroup(c,u,l),c+=u,u=0;function d(e){var t=o.length/3,r=e.extractPoints(n),c=r.shape,l=r.holes;!1===Es.isClockWise(c)&&(c=c.reverse());for(var d=0,h=l.length;d<h;d++){var f=l[d];!0===Es.isClockWise(f)&&(l[d]=f.reverse())}for(var p=Es.triangulateShape(c,l),A=0,g=l.length;A<g;A++){var v=l[A];c=c.concat(v)}for(var m=0,y=c.length;m<y;m++){var b=c[m];o.push(b.x,b.y,0),a.push(0,0,1),s.push(b.x,b.y)}for(var E=0,_=p.length;E<_;E++){var w=p[E],S=w[0]+t,T=w[1]+t,R=w[2]+t;i.push(S,T,R),u+=3}}return r.setIndex(i),r.setAttribute("position",new wn(o,3)),r.setAttribute("normal",new wn(a,3)),r.setAttribute("uv",new wn(s,2)),r}return i(t,e),t.prototype.toJSON=function(){var e=kn.prototype.toJSON.call(this);return function(e,t){if(t.shapes=[],Array.isArray(e))for(var n=0,r=e.length;n<r;n++){var i=e[n];t.shapes.push(i.uuid)}else t.shapes.push(e.uuid);return t}(this.parameters.shapes,e)},t}(kn);var Bs=function(e){function t(t,n,r,i,o,a,s){var c;void 0===t&&(t=1),void 0===n&&(n=8),void 0===r&&(r=6),void 0===i&&(i=0),void 0===o&&(o=2*Math.PI),void 0===a&&(a=0),void 0===s&&(s=Math.PI),(c=e.call(this)||this).type="SphereGeometry",c.parameters={radius:t,widthSegments:n,heightSegments:r,phiStart:i,phiLength:o,thetaStart:a,thetaLength:s},n=Math.max(3,Math.floor(n)),r=Math.max(2,Math.floor(r));for(var u=Math.min(a+s,Math.PI),l=0,d=[],h=new De,f=new De,p=[],A=[],g=[],v=[],m=0;m<=r;m++){var y=[],b=m/r,E=0;0==m&&0==a?E=.5/n:m==r&&u==Math.PI&&(E=-.5/n);for(var _=0;_<=n;_++){var w=_/n;h.x=-t*Math.cos(i+w*o)*Math.sin(a+b*s),h.y=t*Math.cos(a+b*s),h.z=t*Math.sin(i+w*o)*Math.sin(a+b*s),A.push(h.x,h.y,h.z),f.copy(h).normalize(),g.push(f.x,f.y,f.z),v.push(w+E,1-b),y.push(l++)}d.push(y)}for(var S=0;S<r;S++)for(var T=0;T<n;T++){var R=d[S][T+1],C=d[S][T],I=d[S+1][T],x=d[S+1][T+1];(0!==S||a>0)&&p.push(R,C,x),(S!==r-1||u<Math.PI)&&p.push(C,I,x)}return c.setIndex(p),c.setAttribute("position",new wn(A,3)),c.setAttribute("normal",new wn(g,3)),c.setAttribute("uv",new wn(v,2)),c}return i(t,e),t}(kn),Ms=function(e){function t(t,n){var r;void 0===t&&(t=1),void 0===n&&(n=0);return(r=e.call(this,[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],t,n)||this).type="TetrahedronGeometry",r.parameters={radius:t,detail:n},r}return i(t,e),t}(Qa),Ls=function(e){function t(t,n){var r;void 0===n&&(n={});var i=n.font;if(!i||!i.isFont)return console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),new kn||o(r);var a=i.generateShapes(t,n.size);return n.depth=void 0!==n.height?n.height:50,void 0===n.bevelThickness&&(n.bevelThickness=10),void 0===n.bevelSize&&(n.bevelSize=8),void 0===n.bevelEnabled&&(n.bevelEnabled=!1),(r=e.call(this,a,n)||this).type="TextGeometry",r}return i(t,e),t}(Ss),ks=function(e){function t(t,n,r,i,o){var a;void 0===t&&(t=1),void 0===n&&(n=.4),void 0===r&&(r=8),void 0===i&&(i=6),void 0===o&&(o=2*Math.PI),(a=e.call(this)||this).type="TorusGeometry",a.parameters={radius:t,tube:n,radialSegments:r,tubularSegments:i,arc:o},r=Math.floor(r),i=Math.floor(i);for(var s=[],c=[],u=[],l=[],d=new De,h=new De,f=new De,p=0;p<=r;p++)for(var A=0;A<=i;A++){var g=A/i*o,v=p/r*Math.PI*2;h.x=(t+n*Math.cos(v))*Math.cos(g),h.y=(t+n*Math.cos(v))*Math.sin(g),h.z=n*Math.sin(v),c.push(h.x,h.y,h.z),d.x=t*Math.cos(g),d.y=t*Math.sin(g),f.subVectors(h,d).normalize(),u.push(f.x,f.y,f.z),l.push(A/i),l.push(p/r)}for(var m=1;m<=r;m++)for(var y=1;y<=i;y++){var b=(i+1)*m+y-1,E=(i+1)*(m-1)+y-1,_=(i+1)*(m-1)+y,w=(i+1)*m+y;s.push(b,E,w),s.push(E,_,w)}return a.setIndex(s),a.setAttribute("position",new wn(c,3)),a.setAttribute("normal",new wn(u,3)),a.setAttribute("uv",new wn(l,2)),a}return i(t,e),t}(kn),Us=function(e){function t(t,n,r,i,o,a){var s;void 0===t&&(t=1),void 0===n&&(n=.4),void 0===r&&(r=64),void 0===i&&(i=8),void 0===o&&(o=2),void 0===a&&(a=3),(s=e.call(this)||this).type="TorusKnotGeometry",s.parameters={radius:t,tube:n,tubularSegments:r,radialSegments:i,p:o,q:a},r=Math.floor(r),i=Math.floor(i);for(var c=[],u=[],l=[],d=[],h=new De,f=new De,p=new De,A=new De,g=new De,v=new De,m=new De,y=0;y<=r;++y){var b=y/r*o*Math.PI*2;N(b,o,a,t,p),N(b+.01,o,a,t,A),v.subVectors(A,p),m.addVectors(A,p),g.crossVectors(v,m),m.crossVectors(g,v),g.normalize(),m.normalize();for(var E=0;E<=i;++E){var _=E/i*Math.PI*2,w=-n*Math.cos(_),S=n*Math.sin(_);h.x=p.x+(w*m.x+S*g.x),h.y=p.y+(w*m.y+S*g.y),h.z=p.z+(w*m.z+S*g.z),u.push(h.x,h.y,h.z),f.subVectors(h,p).normalize(),l.push(f.x,f.y,f.z),d.push(y/r),d.push(E/i)}}for(var T=1;T<=r;T++)for(var R=1;R<=i;R++){var C=(i+1)*(T-1)+(R-1),I=(i+1)*T+(R-1),x=(i+1)*T+R,O=(i+1)*(T-1)+R;c.push(C,I,O),c.push(I,x,O)}function N(e,t,n,r,i){var o=Math.cos(e),a=Math.sin(e),s=n/t*e,c=Math.cos(s);i.x=r*(2+c)*.5*o,i.y=r*(2+c)*a*.5,i.z=r*Math.sin(s)*.5}return s.setIndex(c),s.setAttribute("position",new wn(u,3)),s.setAttribute("normal",new wn(l,3)),s.setAttribute("uv",new wn(d,2)),s}return i(t,e),t}(kn),Ds=function(e){function t(t,n,r,i,o){var a;void 0===n&&(n=64),void 0===r&&(r=1),void 0===i&&(i=8),void 0===o&&(o=!1),(a=e.call(this)||this).type="TubeGeometry",a.parameters={path:t,tubularSegments:n,radius:r,radialSegments:i,closed:o};var s=t.computeFrenetFrames(n,o);a.tangents=s.tangents,a.normals=s.normals,a.binormals=s.binormals;var c=new De,u=new De,l=new Re,d=new De,h=[],f=[],p=[],A=[];function g(e){d=t.getPointAt(e/n,d);for(var o=s.normals[e],a=s.binormals[e],l=0;l<=i;l++){var p=l/i*Math.PI*2,A=Math.sin(p),g=-Math.cos(p);u.x=g*o.x+A*a.x,u.y=g*o.y+A*a.y,u.z=g*o.z+A*a.z,u.normalize(),f.push(u.x,u.y,u.z),c.x=d.x+r*u.x,c.y=d.y+r*u.y,c.z=d.z+r*u.z,h.push(c.x,c.y,c.z)}}return function(){for(var e=0;e<n;e++)g(e);g(!1===o?n:0),function(){for(var e=0;e<=n;e++)for(var t=0;t<=i;t++)l.x=e/n,l.y=t/i,p.push(l.x,l.y)}(),function(){for(var e=1;e<=n;e++)for(var t=1;t<=i;t++){var r=(i+1)*(e-1)+(t-1),o=(i+1)*e+(t-1),a=(i+1)*e+t,s=(i+1)*(e-1)+t;A.push(r,o,s),A.push(o,a,s)}}()}(),a.setIndex(A),a.setAttribute("position",new wn(h,3)),a.setAttribute("normal",new wn(f,3)),a.setAttribute("uv",new wn(p,2)),a}return i(t,e),t.prototype.toJSON=function(){var e=kn.prototype.toJSON.call(this);return e.path=this.parameters.path.toJSON(),e},t}(kn),Ps=function(e){function t(t){var n;if((n=e.call(this)||this).type="WireframeGeometry",!0===t.isGeometry)return console.error("THREE.WireframeGeometry no longer supports THREE.Geometry. Use THREE.BufferGeometry instead."),o(n);var r=[],i=[0,0],a={},s=new De;if(null!==t.index){var c=t.attributes.position,u=t.index,l=t.groups;0===l.length&&(l=[{start:0,count:u.count,materialIndex:0}]);for(var d=0,h=l.length;d<h;++d)for(var f=l[d],p=f.start,A=p,g=p+f.count;A<g;A+=3)for(var v=0;v<3;v++){var m=u.getX(A+v),y=u.getX(A+(v+1)%3);i[0]=Math.min(m,y),i[1]=Math.max(m,y);var b=i[0]+","+i[1];void 0===a[b]&&(a[b]={index1:i[0],index2:i[1]})}for(var E in a){var _=a[E];s.fromBufferAttribute(c,_.index1),r.push(s.x,s.y,s.z),s.fromBufferAttribute(c,_.index2),r.push(s.x,s.y,s.z)}}else for(var w=t.attributes.position,S=0,T=w.count/3;S<T;S++)for(var R=0;R<3;R++){var C=3*S+R;s.fromBufferAttribute(w,C),r.push(s.x,s.y,s.z);var I=3*S+(R+1)%3;s.fromBufferAttribute(w,I),r.push(s.x,s.y,s.z)}return n.setAttribute("position",new wn(r,3)),n}return i(t,e),t}(kn),Fs=Object.freeze({__proto__:null,BoxGeometry:tr,BoxBufferGeometry:tr,CircleGeometry:Ha,CircleBufferGeometry:Ha,ConeGeometry:Va,ConeBufferGeometry:Va,CylinderGeometry:ja,CylinderBufferGeometry:ja,DodecahedronGeometry:Ga,DodecahedronBufferGeometry:Ga,EdgesGeometry:Xa,ExtrudeGeometry:Ss,ExtrudeBufferGeometry:Ss,IcosahedronGeometry:Rs,IcosahedronBufferGeometry:Rs,LatheGeometry:Cs,LatheBufferGeometry:Cs,OctahedronGeometry:Is,OctahedronBufferGeometry:Is,ParametricGeometry:xs,ParametricBufferGeometry:xs,PlaneGeometry:mr,PlaneBufferGeometry:mr,PolyhedronGeometry:Qa,PolyhedronBufferGeometry:Qa,RingGeometry:Os,RingBufferGeometry:Os,ShapeGeometry:Ns,ShapeBufferGeometry:Ns,SphereGeometry:Bs,SphereBufferGeometry:Bs,TetrahedronGeometry:Ms,TetrahedronBufferGeometry:Ms,TextGeometry:Ls,TextBufferGeometry:Ls,TorusGeometry:ks,TorusBufferGeometry:ks,TorusKnotGeometry:Us,TorusKnotBufferGeometry:Us,TubeGeometry:Ds,TubeBufferGeometry:Ds,WireframeGeometry:Ps}),Hs=function(e){function t(t){var n;return(n=e.call(this)||this).type="ShadowMaterial",n.color=new ln(0),n.transparent=!0,n.setValues(t),n}return i(t,e),t.prototype.copy=function(t){return e.prototype.copy.call(this,t),this.color.copy(t.color),this},t}(nn);Hs.prototype.isShadowMaterial=!0;var js=function(e){function t(t){var n;return(n=e.call(this,t)||this).type="RawShaderMaterial",n}return i(t,e),t}(or);js.prototype.isRawShaderMaterial=!0;var Vs=function(e){function t(t){var n;return(n=e.call(this)||this).defines={STANDARD:""},n.type="MeshStandardMaterial",n.color=new ln(16777215),n.roughness=1,n.metalness=0,n.map=null,n.lightMap=null,n.lightMapIntensity=1,n.aoMap=null,n.aoMapIntensity=1,n.emissive=new ln(0),n.emissiveIntensity=1,n.emissiveMap=null,n.bumpMap=null,n.bumpScale=1,n.normalMap=null,n.normalMapType=0,n.normalScale=new Re(1,1),n.displacementMap=null,n.displacementScale=1,n.displacementBias=0,n.roughnessMap=null,n.metalnessMap=null,n.alphaMap=null,n.envMap=null,n.envMapIntensity=1,n.refractionRatio=.98,n.wireframe=!1,n.wireframeLinewidth=1,n.wireframeLinecap="round",n.wireframeLinejoin="round",n.skinning=!1,n.morphTargets=!1,n.morphNormals=!1,n.flatShading=!1,n.vertexTangents=!1,n.setValues(t),n}return i(t,e),t.prototype.copy=function(t){return e.prototype.copy.call(this,t),this.defines={STANDARD:""},this.color.copy(t.color),this.roughness=t.roughness,this.metalness=t.metalness,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.roughnessMap=t.roughnessMap,this.metalnessMap=t.metalnessMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.envMapIntensity=t.envMapIntensity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.flatShading=t.flatShading,this.vertexTangents=t.vertexTangents,this},t}(nn);Vs.prototype.isMeshStandardMaterial=!0;var Qs=function(e){function t(t){var n;return(n=e.call(this)||this).defines={STANDARD:"",PHYSICAL:""},n.type="MeshPhysicalMaterial",n.clearcoat=0,n.clearcoatMap=null,n.clearcoatRoughness=0,n.clearcoatRoughnessMap=null,n.clearcoatNormalScale=new Re(1,1),n.clearcoatNormalMap=null,n.reflectivity=.5,Object.defineProperty(o(n),"ior",{get:function(){return(1+.4*this.reflectivity)/(1-.4*this.reflectivity)},set:function(e){this.reflectivity=ye(2.5*(e-1)/(e+1),0,1)}}),n.sheen=null,n.transmission=0,n.transmissionMap=null,n.setValues(t),n}return i(t,e),t.prototype.copy=function(t){return e.prototype.copy.call(this,t),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=t.clearcoat,this.clearcoatMap=t.clearcoatMap,this.clearcoatRoughness=t.clearcoatRoughness,this.clearcoatRoughnessMap=t.clearcoatRoughnessMap,this.clearcoatNormalMap=t.clearcoatNormalMap,this.clearcoatNormalScale.copy(t.clearcoatNormalScale),this.reflectivity=t.reflectivity,t.sheen?this.sheen=(this.sheen||new ln).copy(t.sheen):this.sheen=null,this.transmission=t.transmission,this.transmissionMap=t.transmissionMap,this},t}(Vs);Qs.prototype.isMeshPhysicalMaterial=!0;var Gs=function(e){function t(t){var n;return(n=e.call(this)||this).type="MeshPhongMaterial",n.color=new ln(16777215),n.specular=new ln(1118481),n.shininess=30,n.map=null,n.lightMap=null,n.lightMapIntensity=1,n.aoMap=null,n.aoMapIntensity=1,n.emissive=new ln(0),n.emissiveIntensity=1,n.emissiveMap=null,n.bumpMap=null,n.bumpScale=1,n.normalMap=null,n.normalMapType=0,n.normalScale=new Re(1,1),n.displacementMap=null,n.displacementScale=1,n.displacementBias=0,n.specularMap=null,n.alphaMap=null,n.envMap=null,n.combine=0,n.reflectivity=1,n.refractionRatio=.98,n.wireframe=!1,n.wireframeLinewidth=1,n.wireframeLinecap="round",n.wireframeLinejoin="round",n.skinning=!1,n.morphTargets=!1,n.morphNormals=!1,n.flatShading=!1,n.setValues(t),n}return i(t,e),t.prototype.copy=function(t){return e.prototype.copy.call(this,t),this.color.copy(t.color),this.specular.copy(t.specular),this.shininess=t.shininess,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.flatShading=t.flatShading,this},t}(nn);Gs.prototype.isMeshPhongMaterial=!0;var zs=function(e){function t(t){var n;return(n=e.call(this)||this).defines={TOON:""},n.type="MeshToonMaterial",n.color=new ln(16777215),n.map=null,n.gradientMap=null,n.lightMap=null,n.lightMapIntensity=1,n.aoMap=null,n.aoMapIntensity=1,n.emissive=new ln(0),n.emissiveIntensity=1,n.emissiveMap=null,n.bumpMap=null,n.bumpScale=1,n.normalMap=null,n.normalMapType=0,n.normalScale=new Re(1,1),n.displacementMap=null,n.displacementScale=1,n.displacementBias=0,n.alphaMap=null,n.wireframe=!1,n.wireframeLinewidth=1,n.wireframeLinecap="round",n.wireframeLinejoin="round",n.skinning=!1,n.morphTargets=!1,n.morphNormals=!1,n.setValues(t),n}return i(t,e),t.prototype.copy=function(t){return e.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.gradientMap=t.gradientMap,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.alphaMap=t.alphaMap,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},t}(nn);zs.prototype.isMeshToonMaterial=!0;var Ks=function(e){function t(t){var n;return(n=e.call(this)||this).type="MeshNormalMaterial",n.bumpMap=null,n.bumpScale=1,n.normalMap=null,n.normalMapType=0,n.normalScale=new Re(1,1),n.displacementMap=null,n.displacementScale=1,n.displacementBias=0,n.wireframe=!1,n.wireframeLinewidth=1,n.fog=!1,n.skinning=!1,n.morphTargets=!1,n.morphNormals=!1,n.flatShading=!1,n.setValues(t),n}return i(t,e),t.prototype.copy=function(t){return e.prototype.copy.call(this,t),this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.flatShading=t.flatShading,this},t}(nn);Ks.prototype.isMeshNormalMaterial=!0;var qs=function(e){function t(t){var n;return(n=e.call(this)||this).type="MeshLambertMaterial",n.color=new ln(16777215),n.map=null,n.lightMap=null,n.lightMapIntensity=1,n.aoMap=null,n.aoMapIntensity=1,n.emissive=new ln(0),n.emissiveIntensity=1,n.emissiveMap=null,n.specularMap=null,n.alphaMap=null,n.envMap=null,n.combine=0,n.reflectivity=1,n.refractionRatio=.98,n.wireframe=!1,n.wireframeLinewidth=1,n.wireframeLinecap="round",n.wireframeLinejoin="round",n.skinning=!1,n.morphTargets=!1,n.morphNormals=!1,n.setValues(t),n}return i(t,e),t.prototype.copy=function(t){return e.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},t}(nn);qs.prototype.isMeshLambertMaterial=!0;var Ws=function(e){function t(t){var n;return(n=e.call(this)||this).defines={MATCAP:""},n.type="MeshMatcapMaterial",n.color=new ln(16777215),n.matcap=null,n.map=null,n.bumpMap=null,n.bumpScale=1,n.normalMap=null,n.normalMapType=0,n.normalScale=new Re(1,1),n.displacementMap=null,n.displacementScale=1,n.displacementBias=0,n.alphaMap=null,n.skinning=!1,n.morphTargets=!1,n.morphNormals=!1,n.flatShading=!1,n.setValues(t),n}return i(t,e),t.prototype.copy=function(t){return e.prototype.copy.call(this,t),this.defines={MATCAP:""},this.color.copy(t.color),this.matcap=t.matcap,this.map=t.map,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.alphaMap=t.alphaMap,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.flatShading=t.flatShading,this},t}(nn);Ws.prototype.isMeshMatcapMaterial=!0;var Xs=function(e){function t(t){var n;return(n=e.call(this)||this).type="LineDashedMaterial",n.scale=1,n.dashSize=3,n.gapSize=1,n.setValues(t),n}return i(t,e),t.prototype.copy=function(t){return e.prototype.copy.call(this,t),this.scale=t.scale,this.dashSize=t.dashSize,this.gapSize=t.gapSize,this},t}(ma);Xs.prototype.isLineDashedMaterial=!0;var Js=Object.freeze({__proto__:null,ShadowMaterial:Hs,SpriteMaterial:Fo,RawShaderMaterial:js,ShaderMaterial:or,PointsMaterial:xa,MeshPhysicalMaterial:Qs,MeshStandardMaterial:Vs,MeshPhongMaterial:Gs,MeshToonMaterial:zs,MeshNormalMaterial:Ks,MeshLambertMaterial:qs,MeshDepthMaterial:mo,MeshDistanceMaterial:yo,MeshBasicMaterial:dn,MeshMatcapMaterial:Ws,LineDashedMaterial:Xs,LineBasicMaterial:ma,Material:nn}),Ys={arraySlice:function(e,t,n){return Ys.isTypedArray(e)?new e.constructor(e.subarray(t,void 0!==n?n:e.length)):e.slice(t,n)},convertArray:function(e,t,n){return!e||!n&&e.constructor===t?e:"number"==typeof t.BYTES_PER_ELEMENT?new t(e):Array.prototype.slice.call(e)},isTypedArray:function(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)},getKeyframeOrder:function(e){for(var t=e.length,n=new Array(t),r=0;r!==t;++r)n[r]=r;return n.sort((function(t,n){return e[t]-e[n]})),n},sortedArray:function(e,t,n){for(var r=e.length,i=new e.constructor(r),o=0,a=0;a!==r;++o)for(var s=n[o]*t,c=0;c!==t;++c)i[a++]=e[s+c];return i},flattenJSON:function(e,t,n,r){for(var i=1,o=e[0];void 0!==o&&void 0===o[r];)o=e[i++];if(void 0!==o){var a=o[r];if(void 0!==a)if(Array.isArray(a))do{void 0!==(a=o[r])&&(t.push(o.time),n.push.apply(n,a)),o=e[i++]}while(void 0!==o);else if(void 0!==a.toArray)do{void 0!==(a=o[r])&&(t.push(o.time),a.toArray(n,n.length)),o=e[i++]}while(void 0!==o);else do{void 0!==(a=o[r])&&(t.push(o.time),n.push(a)),o=e[i++]}while(void 0!==o)}},subclip:function(e,t,n,r,i){void 0===i&&(i=30);var o=e.clone();o.name=t;for(var a=[],s=0;s<o.tracks.length;++s){for(var c=o.tracks[s],u=c.getValueSize(),l=[],d=[],h=0;h<c.times.length;++h){var f=c.times[h]*i;if(!(f<n||f>=r)){l.push(c.times[h]);for(var p=0;p<u;++p)d.push(c.values[h*u+p])}}0!==l.length&&(c.times=Ys.convertArray(l,c.times.constructor),c.values=Ys.convertArray(d,c.values.constructor),a.push(c))}o.tracks=a;for(var A=1/0,g=0;g<o.tracks.length;++g)A>o.tracks[g].times[0]&&(A=o.tracks[g].times[0]);for(var v=0;v<o.tracks.length;++v)o.tracks[v].shift(-1*A);return o.resetDuration(),o},makeClipAdditive:function(e,t,n,r){void 0===t&&(t=0),void 0===n&&(n=e),void 0===r&&(r=30),r<=0&&(r=30);for(var i=n.tracks.length,o=t/r,a=function(t){var r=n.tracks[t],i=r.ValueTypeName;if("bool"===i||"string"===i)return"continue";var a=e.tracks.find((function(e){return e.name===r.name&&e.ValueTypeName===i}));if(void 0===a)return"continue";var s=0,c=r.getValueSize();r.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(s=c/3);var u=0,l=a.getValueSize();a.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(u=l/3);var d=r.times.length-1,h=void 0;if(o<=r.times[0]){var f=s,p=c-s;h=Ys.arraySlice(r.values,f,p)}else if(o>=r.times[d]){var A=d*c+s,g=A+c-s;h=Ys.arraySlice(r.values,A,g)}else{var v=r.createInterpolant(),m=s,y=c-s;v.evaluate(o),h=Ys.arraySlice(v.resultBuffer,m,y)}"quaternion"===i&&(new Ue).fromArray(h).normalize().conjugate().toArray(h);for(var b=a.times.length,E=0;E<b;++E){var _=E*l+u;if("quaternion"===i)Ue.multiplyQuaternionsFlat(a.values,_,h,0,a.values,_);else for(var w=l-2*u,S=0;S<w;++S)a.values[_+S]-=h[S]}},s=0;s<i;++s)a(s);return e.blendMode=ee,e}},Zs=function(){function e(e,t,n,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==r?r:new t.constructor(n),this.sampleValues=t,this.valueSize=n,this.settings=null,this.DefaultSettings_={}}var t=e.prototype;return t.evaluate=function(e){var t=this.parameterPositions,n=this._cachedIndex,r=t[n],i=t[n-1];e:{t:{var o;n:{r:if(!(e<r)){for(var a=n+2;;){if(void 0===r){if(e<i)break r;return n=t.length,this._cachedIndex=n,this.afterEnd_(n-1,e,i)}if(n===a)break;if(i=r,e<(r=t[++n]))break t}o=t.length;break n}if(e>=i)break e;var s=t[1];e<s&&(n=2,i=s);for(var c=n-2;;){if(void 0===i)return this._cachedIndex=0,this.beforeStart_(0,e,r);if(n===c)break;if(r=i,e>=(i=t[--n-1]))break t}o=n,n=0}for(;n<o;){var u=n+o>>>1;e<t[u]?o=u:n=u+1}if(r=t[n],void 0===(i=t[n-1]))return this._cachedIndex=0,this.beforeStart_(0,e,r);if(void 0===r)return n=t.length,this._cachedIndex=n,this.afterEnd_(n-1,i,e)}this._cachedIndex=n,this.intervalChanged_(n,i,r)}return this.interpolate_(n,i,e,r)},t.getSettings_=function(){return this.settings||this.DefaultSettings_},t.copySampleValue_=function(e){for(var t=this.resultBuffer,n=this.sampleValues,r=this.valueSize,i=e*r,o=0;o!==r;++o)t[o]=n[i+o];return t},t.interpolate_=function(){throw new Error("call to abstract method")},t.intervalChanged_=function(){},e}();Zs.prototype.beforeStart_=Zs.prototype.copySampleValue_,Zs.prototype.afterEnd_=Zs.prototype.copySampleValue_;var $s=function(e){function t(t,n,r,i){var o;return(o=e.call(this,t,n,r,i)||this)._weightPrev=-0,o._offsetPrev=-0,o._weightNext=-0,o._offsetNext=-0,o.DefaultSettings_={endingStart:J,endingEnd:J},o}i(t,e);var n=t.prototype;return n.intervalChanged_=function(e,t,n){var r=this.parameterPositions,i=e-2,o=e+1,a=r[i],s=r[o];if(void 0===a)switch(this.getSettings_().endingStart){case Y:i=e,a=2*t-n;break;case Z:a=t+r[i=r.length-2]-r[i+1];break;default:i=e,a=n}if(void 0===s)switch(this.getSettings_().endingEnd){case Y:o=e,s=2*n-t;break;case Z:o=1,s=n+r[1]-r[0];break;default:o=e-1,s=t}var c=.5*(n-t),u=this.valueSize;this._weightPrev=c/(t-a),this._weightNext=c/(s-n),this._offsetPrev=i*u,this._offsetNext=o*u},n.interpolate_=function(e,t,n,r){for(var i=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=e*a,c=s-a,u=this._offsetPrev,l=this._offsetNext,d=this._weightPrev,h=this._weightNext,f=(n-t)/(r-t),p=f*f,A=p*f,g=-d*A+2*d*p-d*f,v=(1+d)*A+(-1.5-2*d)*p+(-.5+d)*f+1,m=(-1-h)*A+(1.5+h)*p+.5*f,y=h*A-h*p,b=0;b!==a;++b)i[b]=g*o[u+b]+v*o[c+b]+m*o[s+b]+y*o[l+b];return i},t}(Zs),ec=function(e){function t(t,n,r,i){return e.call(this,t,n,r,i)||this}return i(t,e),t.prototype.interpolate_=function(e,t,n,r){for(var i=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=e*a,c=s-a,u=(n-t)/(r-t),l=1-u,d=0;d!==a;++d)i[d]=o[c+d]*l+o[s+d]*u;return i},t}(Zs),tc=function(e){function t(t,n,r,i){return e.call(this,t,n,r,i)||this}return i(t,e),t.prototype.interpolate_=function(e){return this.copySampleValue_(e-1)},t}(Zs),nc=function(){function e(e,t,n,r){if(void 0===e)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===t||0===t.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=Ys.convertArray(t,this.TimeBufferType),this.values=Ys.convertArray(n,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}e.toJSON=function(e){var t,n=e.constructor;if(n.toJSON!==this.toJSON)t=n.toJSON(e);else{t={name:e.name,times:Ys.convertArray(e.times,Array),values:Ys.convertArray(e.values,Array)};var r=e.getInterpolation();r!==e.DefaultInterpolation&&(t.interpolation=r)}return t.type=e.ValueTypeName,t};var t=e.prototype;return t.InterpolantFactoryMethodDiscrete=function(e){return new tc(this.times,this.values,this.getValueSize(),e)},t.InterpolantFactoryMethodLinear=function(e){return new ec(this.times,this.values,this.getValueSize(),e)},t.InterpolantFactoryMethodSmooth=function(e){return new $s(this.times,this.values,this.getValueSize(),e)},t.setInterpolation=function(e){var t;switch(e){case q:t=this.InterpolantFactoryMethodDiscrete;break;case W:t=this.InterpolantFactoryMethodLinear;break;case X:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){var n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(n);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",n),this}return this.createInterpolant=t,this},t.getInterpolation=function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return q;case this.InterpolantFactoryMethodLinear:return W;case this.InterpolantFactoryMethodSmooth:return X}},t.getValueSize=function(){return this.values.length/this.times.length},t.shift=function(e){if(0!==e)for(var t=this.times,n=0,r=t.length;n!==r;++n)t[n]+=e;return this},t.scale=function(e){if(1!==e)for(var t=this.times,n=0,r=t.length;n!==r;++n)t[n]*=e;return this},t.trim=function(e,t){for(var n=this.times,r=n.length,i=0,o=r-1;i!==r&&n[i]<e;)++i;for(;-1!==o&&n[o]>t;)--o;if(++o,0!==i||o!==r){i>=o&&(i=(o=Math.max(o,1))-1);var a=this.getValueSize();this.times=Ys.arraySlice(n,i,o),this.values=Ys.arraySlice(this.values,i*a,o*a)}return this},t.validate=function(){var e=!0,t=this.getValueSize();t-Math.floor(t)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);var n=this.times,r=this.values,i=n.length;0===i&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);for(var o=null,a=0;a!==i;a++){var s=n[a];if("number"==typeof s&&isNaN(s)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,a,s),e=!1;break}if(null!==o&&o>s){console.error("THREE.KeyframeTrack: Out of order keys.",this,a,s,o),e=!1;break}o=s}if(void 0!==r&&Ys.isTypedArray(r))for(var c=0,u=r.length;c!==u;++c){var l=r[c];if(isNaN(l)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,c,l),e=!1;break}}return e},t.optimize=function(){for(var e=Ys.arraySlice(this.times),t=Ys.arraySlice(this.values),n=this.getValueSize(),r=this.getInterpolation()===X,i=e.length-1,o=1,a=1;a<i;++a){var s=!1,c=e[a];if(c!==e[a+1]&&(1!==a||c!==e[0]))if(r)s=!0;else for(var u=a*n,l=u-n,d=u+n,h=0;h!==n;++h){var f=t[u+h];if(f!==t[l+h]||f!==t[d+h]){s=!0;break}}if(s){if(a!==o){e[o]=e[a];for(var p=a*n,A=o*n,g=0;g!==n;++g)t[A+g]=t[p+g]}++o}}if(i>0){e[o]=e[i];for(var v=i*n,m=o*n,y=0;y!==n;++y)t[m+y]=t[v+y];++o}return o!==e.length?(this.times=Ys.arraySlice(e,0,o),this.values=Ys.arraySlice(t,0,o*n)):(this.times=e,this.values=t),this},t.clone=function(){var e=Ys.arraySlice(this.times,0),t=Ys.arraySlice(this.values,0),n=new(0,this.constructor)(this.name,e,t);return n.createInterpolant=this.createInterpolant,n},e}();nc.prototype.TimeBufferType=Float32Array,nc.prototype.ValueBufferType=Float32Array,nc.prototype.DefaultInterpolation=W;var rc=function(e){function t(){return e.apply(this,arguments)||this}return i(t,e),t}(nc);rc.prototype.ValueTypeName="bool",rc.prototype.ValueBufferType=Array,rc.prototype.DefaultInterpolation=q,rc.prototype.InterpolantFactoryMethodLinear=void 0,rc.prototype.InterpolantFactoryMethodSmooth=void 0;var ic=function(e){function t(){return e.apply(this,arguments)||this}return i(t,e),t}(nc);ic.prototype.ValueTypeName="color";var oc=function(e){function t(){return e.apply(this,arguments)||this}return i(t,e),t}(nc);oc.prototype.ValueTypeName="number";var ac=function(e){function t(t,n,r,i){return e.call(this,t,n,r,i)||this}return i(t,e),t.prototype.interpolate_=function(e,t,n,r){for(var i=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=(n-t)/(r-t),c=e*a,u=c+a;c!==u;c+=4)Ue.slerpFlat(i,0,o,c-a,o,c,s);return i},t}(Zs),sc=function(e){function t(){return e.apply(this,arguments)||this}return i(t,e),t.prototype.InterpolantFactoryMethodLinear=function(e){return new ac(this.times,this.values,this.getValueSize(),e)},t}(nc);sc.prototype.ValueTypeName="quaternion",sc.prototype.DefaultInterpolation=W,sc.prototype.InterpolantFactoryMethodSmooth=void 0;var cc=function(e){function t(){return e.apply(this,arguments)||this}return i(t,e),t}(nc);cc.prototype.ValueTypeName="string",cc.prototype.ValueBufferType=Array,cc.prototype.DefaultInterpolation=q,cc.prototype.InterpolantFactoryMethodLinear=void 0,cc.prototype.InterpolantFactoryMethodSmooth=void 0;var uc=function(e){function t(){return e.apply(this,arguments)||this}return i(t,e),t}(nc);uc.prototype.ValueTypeName="vector";var lc=function(){function e(e,t,n,r){void 0===t&&(t=-1),void 0===r&&(r=$),this.name=e,this.tracks=n,this.duration=t,this.blendMode=r,this.uuid=me(),this.duration<0&&this.resetDuration()}e.parse=function(e){for(var t=[],n=e.tracks,r=1/(e.fps||1),i=0,o=n.length;i!==o;++i)t.push(dc(n[i]).scale(r));var a=new this(e.name,e.duration,t,e.blendMode);return a.uuid=e.uuid,a},e.toJSON=function(e){for(var t=[],n=e.tracks,r={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode},i=0,o=n.length;i!==o;++i)t.push(nc.toJSON(n[i]));return r},e.CreateFromMorphTargetSequence=function(e,t,n,r){for(var i=t.length,o=[],a=0;a<i;a++){var s=[],c=[];s.push((a+i-1)%i,a,(a+1)%i),c.push(0,1,0);var u=Ys.getKeyframeOrder(s);s=Ys.sortedArray(s,1,u),c=Ys.sortedArray(c,1,u),r||0!==s[0]||(s.push(i),c.push(c[0])),o.push(new oc(".morphTargetInfluences["+t[a].name+"]",s,c).scale(1/n))}return new this(e,-1,o)},e.findByName=function(e,t){var n=e;if(!Array.isArray(e)){var r=e;n=r.geometry&&r.geometry.animations||r.animations}for(var i=0;i<n.length;i++)if(n[i].name===t)return n[i];return null},e.CreateClipsFromMorphTargetSequences=function(e,t,n){for(var r={},i=/^([\w-]*?)([\d]+)$/,o=0,a=e.length;o<a;o++){var s=e[o],c=s.name.match(i);if(c&&c.length>1){var u=c[1],l=r[u];l||(r[u]=l=[]),l.push(s)}}var d=[];for(var h in r)d.push(this.CreateFromMorphTargetSequence(h,r[h],t,n));return d},e.parseAnimation=function(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;for(var n=function(e,t,n,r,i){if(0!==n.length){var o=[],a=[];Ys.flattenJSON(n,o,a,r),0!==o.length&&i.push(new e(t,o,a))}},r=[],i=e.name||"default",o=e.fps||30,a=e.blendMode,s=e.length||-1,c=e.hierarchy||[],u=0;u<c.length;u++){var l=c[u].keys;if(l&&0!==l.length)if(l[0].morphTargets){var d={},h=void 0;for(h=0;h<l.length;h++)if(l[h].morphTargets)for(var f=0;f<l[h].morphTargets.length;f++)d[l[h].morphTargets[f]]=-1;for(var p in d){for(var A=[],g=[],v=0;v!==l[h].morphTargets.length;++v){var m=l[h];A.push(m.time),g.push(m.morphTarget===p?1:0)}r.push(new oc(".morphTargetInfluence["+p+"]",A,g))}s=d.length*(o||1)}else{var y=".bones["+t[u].name+"]";n(uc,y+".position",l,"pos",r),n(sc,y+".quaternion",l,"rot",r),n(uc,y+".scale",l,"scl",r)}}return 0===r.length?null:new this(i,s,r,a)};var t=e.prototype;return t.resetDuration=function(){for(var e=0,t=0,n=this.tracks.length;t!==n;++t){var r=this.tracks[t];e=Math.max(e,r.times[r.times.length-1])}return this.duration=e,this},t.trim=function(){for(var e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this},t.validate=function(){for(var e=!0,t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e},t.optimize=function(){for(var e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this},t.clone=function(){for(var e=[],t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)},t.toJSON=function(){return this.constructor.toJSON(this)},e}();function dc(e){if(void 0===e.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");var t=function(e){switch(e.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return oc;case"vector":case"vector2":case"vector3":case"vector4":return uc;case"color":return ic;case"quaternion":return sc;case"bool":case"boolean":return rc;case"string":return cc}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+e)}(e.type);if(void 0===e.times){var n=[],r=[];Ys.flattenJSON(e.keys,n,r,"value"),e.times=n,e.values=r}return void 0!==t.parse?t.parse(e):new t(e.name,e.times,e.values,e.interpolation)}var hc={enabled:!1,files:{},add:function(e,t){!1!==this.enabled&&(this.files[e]=t)},get:function(e){if(!1!==this.enabled)return this.files[e]},remove:function(e){delete this.files[e]},clear:function(){this.files={}}},fc=function(e,t,n){var r=this,i=!1,o=0,a=0,s=void 0,c=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=n,this.itemStart=function(e){a++,!1===i&&void 0!==r.onStart&&r.onStart(e,o,a),i=!0},this.itemEnd=function(e){o++,void 0!==r.onProgress&&r.onProgress(e,o,a),o===a&&(i=!1,void 0!==r.onLoad&&r.onLoad())},this.itemError=function(e){void 0!==r.onError&&r.onError(e)},this.resolveURL=function(e){return s?s(e):e},this.setURLModifier=function(e){return s=e,this},this.addHandler=function(e,t){return c.push(e,t),this},this.removeHandler=function(e){var t=c.indexOf(e);return-1!==t&&c.splice(t,2),this},this.getHandler=function(e){for(var t=0,n=c.length;t<n;t+=2){var r=c[t],i=c[t+1];if(r.global&&(r.lastIndex=0),r.test(e))return i}return null}},pc=new fc,Ac=function(){function e(e){this.manager=void 0!==e?e:pc,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}var t=e.prototype;return t.load=function(){},t.loadAsync=function(e,t){var n=this;return new Promise((function(r,i){n.load(e,r,t,i)}))},t.parse=function(){},t.setCrossOrigin=function(e){return this.crossOrigin=e,this},t.setWithCredentials=function(e){return this.withCredentials=e,this},t.setPath=function(e){return this.path=e,this},t.setResourcePath=function(e){return this.resourcePath=e,this},t.setRequestHeader=function(e){return this.requestHeader=e,this},e}(),gc={},vc=function(e){function t(t){return e.call(this,t)||this}i(t,e);var n=t.prototype;return n.load=function(e,t,n,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);var i=this,o=hc.get(e);if(void 0!==o)return i.manager.itemStart(e),setTimeout((function(){t&&t(o),i.manager.itemEnd(e)}),0),o;if(void 0===gc[e]){var a,s=e.match(/^data:(.*?)(;base64)?,(.*)$/);if(s){var c=s[1],u=!!s[2],l=s[3];l=decodeURIComponent(l),u&&(l=atob(l));try{var d,h=(this.responseType||"").toLowerCase();switch(h){case"arraybuffer":case"blob":for(var f=new Uint8Array(l.length),p=0;p<l.length;p++)f[p]=l.charCodeAt(p);d="blob"===h?new Blob([f.buffer],{type:c}):f.buffer;break;case"document":var A=new DOMParser;d=A.parseFromString(l,c);break;case"json":d=JSON.parse(l);break;default:d=l}setTimeout((function(){t&&t(d),i.manager.itemEnd(e)}),0)}catch(t){setTimeout((function(){r&&r(t),i.manager.itemError(e),i.manager.itemEnd(e)}),0)}}else{for(var g in gc[e]=[],gc[e].push({onLoad:t,onProgress:n,onError:r}),(a=new XMLHttpRequest).open("GET",e,!0),a.addEventListener("load",(function(t){var n=this.response,r=gc[e];if(delete gc[e],200===this.status||0===this.status){0===this.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),hc.add(e,n);for(var o=0,a=r.length;o<a;o++){var s=r[o];s.onLoad&&s.onLoad(n)}i.manager.itemEnd(e)}else{for(var c=0,u=r.length;c<u;c++){var l=r[c];l.onError&&l.onError(t)}i.manager.itemError(e),i.manager.itemEnd(e)}}),!1),a.addEventListener("progress",(function(t){for(var n=gc[e],r=0,i=n.length;r<i;r++){var o=n[r];o.onProgress&&o.onProgress(t)}}),!1),a.addEventListener("error",(function(t){var n=gc[e];delete gc[e];for(var r=0,o=n.length;r<o;r++){var a=n[r];a.onError&&a.onError(t)}i.manager.itemError(e),i.manager.itemEnd(e)}),!1),a.addEventListener("abort",(function(t){var n=gc[e];delete gc[e];for(var r=0,o=n.length;r<o;r++){var a=n[r];a.onError&&a.onError(t)}i.manager.itemError(e),i.manager.itemEnd(e)}),!1),void 0!==this.responseType&&(a.responseType=this.responseType),void 0!==this.withCredentials&&(a.withCredentials=this.withCredentials),a.overrideMimeType&&a.overrideMimeType(void 0!==this.mimeType?this.mimeType:"text/plain"),this.requestHeader)a.setRequestHeader(g,this.requestHeader[g]);a.send(null)}return i.manager.itemStart(e),a}gc[e].push({onLoad:t,onProgress:n,onError:r})},n.setResponseType=function(e){return this.responseType=e,this},n.setMimeType=function(e){return this.mimeType=e,this},t}(Ac),mc=function(e){function t(t){return e.call(this,t)||this}i(t,e);var n=t.prototype;return n.load=function(e,t,n,r){var i=this,o=new vc(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,(function(n){try{t(i.parse(JSON.parse(n)))}catch(t){r?r(t):console.error(t),i.manager.itemError(e)}}),n,r)},n.parse=function(e){for(var t=[],n=0;n<e.length;n++){var r=lc.parse(e[n]);t.push(r)}return t},t}(Ac),yc=function(e){function t(t){return e.call(this,t)||this}return i(t,e),t.prototype.load=function(e,t,n,r){var i=this,o=[],a=new Da,s=new vc(this.manager);s.setPath(this.path),s.setResponseType("arraybuffer"),s.setRequestHeader(this.requestHeader),s.setWithCredentials(i.withCredentials);var c=0;function u(u){s.load(e[u],(function(e){var n=i.parse(e,!0);o[u]={width:n.width,height:n.height,format:n.format,mipmaps:n.mipmaps},6===(c+=1)&&(1===n.mipmapCount&&(a.minFilter=S),a.image=o,a.format=n.format,a.needsUpdate=!0,t&&t(a))}),n,r)}if(Array.isArray(e))for(var l=0,d=e.length;l<d;++l)u(l);else s.load(e,(function(e){var n=i.parse(e,!0);if(n.isCubemap){for(var r=n.mipmaps.length/n.mipmapCount,s=0;s<r;s++){o[s]={mipmaps:[]};for(var c=0;c<n.mipmapCount;c++)o[s].mipmaps.push(n.mipmaps[s*n.mipmapCount+c]),o[s].format=n.format,o[s].width=n.width,o[s].height=n.height}a.image=o}else a.image.width=n.width,a.image.height=n.height,a.mipmaps=n.mipmaps;1===n.mipmapCount&&(a.minFilter=S),a.format=n.format,a.needsUpdate=!0,t&&t(a)}),n,r);return a},t}(Ac),bc=function(e){function t(t){return e.call(this,t)||this}return i(t,e),t.prototype.load=function(e,t,n,r){void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);var i=this,o=hc.get(e);if(void 0!==o)return i.manager.itemStart(e),setTimeout((function(){t&&t(o),i.manager.itemEnd(e)}),0),o;var a=document.createElementNS("http://www.w3.org/1999/xhtml","img");function s(){a.removeEventListener("load",s,!1),a.removeEventListener("error",c,!1),hc.add(e,this),t&&t(this),i.manager.itemEnd(e)}function c(t){a.removeEventListener("load",s,!1),a.removeEventListener("error",c,!1),r&&r(t),i.manager.itemError(e),i.manager.itemEnd(e)}return a.addEventListener("load",s,!1),a.addEventListener("error",c,!1),"data:"!==e.substr(0,5)&&void 0!==this.crossOrigin&&(a.crossOrigin=this.crossOrigin),i.manager.itemStart(e),a.src=e,a},t}(Ac),Ec=function(e){function t(t){return e.call(this,t)||this}return i(t,e),t.prototype.load=function(e,t,n,r){var i=new lr,o=new bc(this.manager);o.setCrossOrigin(this.crossOrigin),o.setPath(this.path);var a=0;function s(n){o.load(e[n],(function(e){i.images[n]=e,6===++a&&(i.needsUpdate=!0,t&&t(i))}),void 0,r)}for(var c=0;c<e.length;++c)s(c);return i},t}(Ac),_c=function(e){function t(t){return e.call(this,t)||this}return i(t,e),t.prototype.load=function(e,t,n,r){var i=this,o=new hr,a=new vc(this.manager);return a.setResponseType("arraybuffer"),a.setRequestHeader(this.requestHeader),a.setPath(this.path),a.setWithCredentials(i.withCredentials),a.load(e,(function(e){var n=i.parse(e);n&&(void 0!==n.image?o.image=n.image:void 0!==n.data&&(o.image.width=n.width,o.image.height=n.height,o.image.data=n.data),o.wrapS=void 0!==n.wrapS?n.wrapS:y,o.wrapT=void 0!==n.wrapT?n.wrapT:y,o.magFilter=void 0!==n.magFilter?n.magFilter:S,o.minFilter=void 0!==n.minFilter?n.minFilter:S,o.anisotropy=void 0!==n.anisotropy?n.anisotropy:1,void 0!==n.encoding&&(o.encoding=n.encoding),void 0!==n.flipY&&(o.flipY=n.flipY),void 0!==n.format&&(o.format=n.format),void 0!==n.type&&(o.type=n.type),void 0!==n.mipmaps&&(o.mipmaps=n.mipmaps,o.minFilter=R),1===n.mipmapCount&&(o.minFilter=S),void 0!==n.generateMipmaps&&(o.generateMipmaps=n.generateMipmaps),o.needsUpdate=!0,t&&t(o,n))}),n,r),o},t}(Ac),wc=function(e){function t(t){return e.call(this,t)||this}return i(t,e),t.prototype.load=function(e,t,n,r){var i=new Ne,o=new bc(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(e,(function(n){i.image=n;var r=e.search(/\.jpe?g($|\?)/i)>0||0===e.search(/^data\:image\/jpeg/);i.format=r?M:L,i.needsUpdate=!0,void 0!==t&&t(i)}),n,r),i},t}(Ac),Sc=function(){function e(){this.type="Curve",this.arcLengthDivisions=200}var t=e.prototype;return t.getPoint=function(){return console.warn("THREE.Curve: .getPoint() not implemented."),null},t.getPointAt=function(e,t){var n=this.getUtoTmapping(e);return this.getPoint(n,t)},t.getPoints=function(e){void 0===e&&(e=5);for(var t=[],n=0;n<=e;n++)t.push(this.getPoint(n/e));return t},t.getSpacedPoints=function(e){void 0===e&&(e=5);for(var t=[],n=0;n<=e;n++)t.push(this.getPointAt(n/e));return t},t.getLength=function(){var e=this.getLengths();return e[e.length-1]},t.getLengths=function(e){if(void 0===e&&(e=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var t,n=[],r=this.getPoint(0),i=0;n.push(0);for(var o=1;o<=e;o++)i+=(t=this.getPoint(o/e)).distanceTo(r),n.push(i),r=t;return this.cacheArcLengths=n,n},t.updateArcLengths=function(){this.needsUpdate=!0,this.getLengths()},t.getUtoTmapping=function(e,t){var n,r=this.getLengths(),i=0,o=r.length;n=t||e*r[o-1];for(var a,s=0,c=o-1;s<=c;)if((a=r[i=Math.floor(s+(c-s)/2)]-n)<0)s=i+1;else{if(!(a>0)){c=i;break}c=i-1}if(r[i=c]===n)return i/(o-1);var u=r[i];return(i+(n-u)/(r[i+1]-u))/(o-1)},t.getTangent=function(e,t){var n=1e-4,r=e-n,i=e+n;r<0&&(r=0),i>1&&(i=1);var o=this.getPoint(r),a=this.getPoint(i),s=t||(o.isVector2?new Re:new De);return s.copy(a).sub(o).normalize(),s},t.getTangentAt=function(e,t){var n=this.getUtoTmapping(e);return this.getTangent(n,t)},t.computeFrenetFrames=function(e,t){for(var n=new De,r=[],i=[],o=[],a=new De,s=new pt,c=0;c<=e;c++){var u=c/e;r[c]=this.getTangentAt(u,new De),r[c].normalize()}i[0]=new De,o[0]=new De;var l=Number.MAX_VALUE,d=Math.abs(r[0].x),h=Math.abs(r[0].y),f=Math.abs(r[0].z);d<=l&&(l=d,n.set(1,0,0)),h<=l&&(l=h,n.set(0,1,0)),f<=l&&n.set(0,0,1),a.crossVectors(r[0],n).normalize(),i[0].crossVectors(r[0],a),o[0].crossVectors(r[0],i[0]);for(var p=1;p<=e;p++){if(i[p]=i[p-1].clone(),o[p]=o[p-1].clone(),a.crossVectors(r[p-1],r[p]),a.length()>Number.EPSILON){a.normalize();var A=Math.acos(ye(r[p-1].dot(r[p]),-1,1));i[p].applyMatrix4(s.makeRotationAxis(a,A))}o[p].crossVectors(r[p],i[p])}if(!0===t){var g=Math.acos(ye(i[0].dot(i[e]),-1,1));g/=e,r[0].dot(a.crossVectors(i[0],i[e]))>0&&(g=-g);for(var v=1;v<=e;v++)i[v].applyMatrix4(s.makeRotationAxis(r[v],g*v)),o[v].crossVectors(r[v],i[v])}return{tangents:r,normals:i,binormals:o}},t.clone=function(){return(new this.constructor).copy(this)},t.copy=function(e){return this.arcLengthDivisions=e.arcLengthDivisions,this},t.toJSON=function(){var e={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e},t.fromJSON=function(e){return this.arcLengthDivisions=e.arcLengthDivisions,this},e}(),Tc=function(e){function t(t,n,r,i,o,a,s,c){var u;return void 0===t&&(t=0),void 0===n&&(n=0),void 0===r&&(r=1),void 0===i&&(i=1),void 0===o&&(o=0),void 0===a&&(a=2*Math.PI),void 0===s&&(s=!1),void 0===c&&(c=0),(u=e.call(this)||this).type="EllipseCurve",u.aX=t,u.aY=n,u.xRadius=r,u.yRadius=i,u.aStartAngle=o,u.aEndAngle=a,u.aClockwise=s,u.aRotation=c,u}i(t,e);var n=t.prototype;return n.getPoint=function(e,t){for(var n=t||new Re,r=2*Math.PI,i=this.aEndAngle-this.aStartAngle,o=Math.abs(i)<Number.EPSILON;i<0;)i+=r;for(;i>r;)i-=r;i<Number.EPSILON&&(i=o?0:r),!0!==this.aClockwise||o||(i===r?i=-r:i-=r);var a=this.aStartAngle+e*i,s=this.aX+this.xRadius*Math.cos(a),c=this.aY+this.yRadius*Math.sin(a);if(0!==this.aRotation){var u=Math.cos(this.aRotation),l=Math.sin(this.aRotation),d=s-this.aX,h=c-this.aY;s=d*u-h*l+this.aX,c=d*l+h*u+this.aY}return n.set(s,c)},n.copy=function(t){return e.prototype.copy.call(this,t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this},n.toJSON=function(){var t=e.prototype.toJSON.call(this);return t.aX=this.aX,t.aY=this.aY,t.xRadius=this.xRadius,t.yRadius=this.yRadius,t.aStartAngle=this.aStartAngle,t.aEndAngle=this.aEndAngle,t.aClockwise=this.aClockwise,t.aRotation=this.aRotation,t},n.fromJSON=function(t){return e.prototype.fromJSON.call(this,t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this},t}(Sc);Tc.prototype.isEllipseCurve=!0;var Rc=function(e){function t(t,n,r,i,o,a){var s;return(s=e.call(this,t,n,r,r,i,o,a)||this).type="ArcCurve",s}return i(t,e),t}(Tc);function Cc(){var e=0,t=0,n=0,r=0;function i(i,o,a,s){e=i,t=a,n=-3*i+3*o-2*a-s,r=2*i-2*o+a+s}return{initCatmullRom:function(e,t,n,r,o){i(t,n,o*(n-e),o*(r-t))},initNonuniformCatmullRom:function(e,t,n,r,o,a,s){var c=(t-e)/o-(n-e)/(o+a)+(n-t)/a,u=(n-t)/a-(r-t)/(a+s)+(r-n)/s;i(t,n,c*=a,u*=a)},calc:function(i){var o=i*i;return e+t*i+n*o+r*(o*i)}}}Rc.prototype.isArcCurve=!0;var Ic=new De,xc=new Cc,Oc=new Cc,Nc=new Cc,Bc=function(e){function t(t,n,r,i){var o;return void 0===t&&(t=[]),void 0===n&&(n=!1),void 0===r&&(r="centripetal"),void 0===i&&(i=.5),(o=e.call(this)||this).type="CatmullRomCurve3",o.points=t,o.closed=n,o.curveType=r,o.tension=i,o}i(t,e);var n=t.prototype;return n.getPoint=function(e,t){void 0===t&&(t=new De);var n,r,i=t,o=this.points,a=o.length,s=(a-(this.closed?0:1))*e,c=Math.floor(s),u=s-c;this.closed?c+=c>0?0:(Math.floor(Math.abs(c)/a)+1)*a:0===u&&c===a-1&&(c=a-2,u=1),this.closed||c>0?n=o[(c-1)%a]:(Ic.subVectors(o[0],o[1]).add(o[0]),n=Ic);var l=o[c%a],d=o[(c+1)%a];if(this.closed||c+2<a?r=o[(c+2)%a]:(Ic.subVectors(o[a-1],o[a-2]).add(o[a-1]),r=Ic),"centripetal"===this.curveType||"chordal"===this.curveType){var h="chordal"===this.curveType?.5:.25,f=Math.pow(n.distanceToSquared(l),h),p=Math.pow(l.distanceToSquared(d),h),A=Math.pow(d.distanceToSquared(r),h);p<1e-4&&(p=1),f<1e-4&&(f=p),A<1e-4&&(A=p),xc.initNonuniformCatmullRom(n.x,l.x,d.x,r.x,f,p,A),Oc.initNonuniformCatmullRom(n.y,l.y,d.y,r.y,f,p,A),Nc.initNonuniformCatmullRom(n.z,l.z,d.z,r.z,f,p,A)}else"catmullrom"===this.curveType&&(xc.initCatmullRom(n.x,l.x,d.x,r.x,this.tension),Oc.initCatmullRom(n.y,l.y,d.y,r.y,this.tension),Nc.initCatmullRom(n.z,l.z,d.z,r.z,this.tension));return i.set(xc.calc(u),Oc.calc(u),Nc.calc(u)),i},n.copy=function(t){e.prototype.copy.call(this,t),this.points=[];for(var n=0,r=t.points.length;n<r;n++){var i=t.points[n];this.points.push(i.clone())}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this},n.toJSON=function(){var t=e.prototype.toJSON.call(this);t.points=[];for(var n=0,r=this.points.length;n<r;n++){var i=this.points[n];t.points.push(i.toArray())}return t.closed=this.closed,t.curveType=this.curveType,t.tension=this.tension,t},n.fromJSON=function(t){e.prototype.fromJSON.call(this,t),this.points=[];for(var n=0,r=t.points.length;n<r;n++){var i=t.points[n];this.points.push((new De).fromArray(i))}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this},t}(Sc);function Mc(e,t,n,r,i){var o=.5*(r-t),a=.5*(i-n),s=e*e;return(2*n-2*r+o+a)*(e*s)+(-3*n+3*r-2*o-a)*s+o*e+n}function Lc(e,t,n,r){return function(e,t){var n=1-e;return n*n*t}(e,t)+function(e,t){return 2*(1-e)*e*t}(e,n)+function(e,t){return e*e*t}(e,r)}function kc(e,t,n,r,i){return function(e,t){var n=1-e;return n*n*n*t}(e,t)+function(e,t){var n=1-e;return 3*n*n*e*t}(e,n)+function(e,t){return 3*(1-e)*e*e*t}(e,r)+function(e,t){return e*e*e*t}(e,i)}Bc.prototype.isCatmullRomCurve3=!0;var Uc=function(e){function t(t,n,r,i){var o;return void 0===t&&(t=new Re),void 0===n&&(n=new Re),void 0===r&&(r=new Re),void 0===i&&(i=new Re),(o=e.call(this)||this).type="CubicBezierCurve",o.v0=t,o.v1=n,o.v2=r,o.v3=i,o}i(t,e);var n=t.prototype;return n.getPoint=function(e,t){void 0===t&&(t=new Re);var n=t,r=this.v0,i=this.v1,o=this.v2,a=this.v3;return n.set(kc(e,r.x,i.x,o.x,a.x),kc(e,r.y,i.y,o.y,a.y)),n},n.copy=function(t){return e.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this},n.toJSON=function(){var t=e.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t},n.fromJSON=function(t){return e.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this},t}(Sc);Uc.prototype.isCubicBezierCurve=!0;var Dc=function(e){function t(t,n,r,i){var o;return void 0===t&&(t=new De),void 0===n&&(n=new De),void 0===r&&(r=new De),void 0===i&&(i=new De),(o=e.call(this)||this).type="CubicBezierCurve3",o.v0=t,o.v1=n,o.v2=r,o.v3=i,o}i(t,e);var n=t.prototype;return n.getPoint=function(e,t){void 0===t&&(t=new De);var n=t,r=this.v0,i=this.v1,o=this.v2,a=this.v3;return n.set(kc(e,r.x,i.x,o.x,a.x),kc(e,r.y,i.y,o.y,a.y),kc(e,r.z,i.z,o.z,a.z)),n},n.copy=function(t){return e.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this},n.toJSON=function(){var t=e.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t},n.fromJSON=function(t){return e.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this},t}(Sc);Dc.prototype.isCubicBezierCurve3=!0;var Pc=function(e){function t(t,n){var r;return void 0===t&&(t=new Re),void 0===n&&(n=new Re),(r=e.call(this)||this).type="LineCurve",r.v1=t,r.v2=n,r}i(t,e);var n=t.prototype;return n.getPoint=function(e,t){void 0===t&&(t=new Re);var n=t;return 1===e?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n},n.getPointAt=function(e,t){return this.getPoint(e,t)},n.getTangent=function(e,t){var n=t||new Re;return n.copy(this.v2).sub(this.v1).normalize(),n},n.copy=function(t){return e.prototype.copy.call(this,t),this.v1.copy(t.v1),this.v2.copy(t.v2),this},n.toJSON=function(){var t=e.prototype.toJSON.call(this);return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},n.fromJSON=function(t){return e.prototype.fromJSON.call(this,t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},t}(Sc);Pc.prototype.isLineCurve=!0;var Fc=function(e){function t(t,n){var r;return void 0===t&&(t=new De),void 0===n&&(n=new De),(r=e.call(this)||this).type="LineCurve3",r.isLineCurve3=!0,r.v1=t,r.v2=n,r}i(t,e);var n=t.prototype;return n.getPoint=function(e,t){void 0===t&&(t=new De);var n=t;return 1===e?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n},n.getPointAt=function(e,t){return this.getPoint(e,t)},n.copy=function(t){return e.prototype.copy.call(this,t),this.v1.copy(t.v1),this.v2.copy(t.v2),this},n.toJSON=function(){var t=e.prototype.toJSON.call(this);return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},n.fromJSON=function(t){return e.prototype.fromJSON.call(this,t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},t}(Sc),Hc=function(e){function t(t,n,r){var i;return void 0===t&&(t=new Re),void 0===n&&(n=new Re),void 0===r&&(r=new Re),(i=e.call(this)||this).type="QuadraticBezierCurve",i.v0=t,i.v1=n,i.v2=r,i}i(t,e);var n=t.prototype;return n.getPoint=function(e,t){void 0===t&&(t=new Re);var n=t,r=this.v0,i=this.v1,o=this.v2;return n.set(Lc(e,r.x,i.x,o.x),Lc(e,r.y,i.y,o.y)),n},n.copy=function(t){return e.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this},n.toJSON=function(){var t=e.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},n.fromJSON=function(t){return e.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},t}(Sc);Hc.prototype.isQuadraticBezierCurve=!0;var jc=function(e){function t(t,n,r){var i;return void 0===t&&(t=new De),void 0===n&&(n=new De),void 0===r&&(r=new De),(i=e.call(this)||this).type="QuadraticBezierCurve3",i.v0=t,i.v1=n,i.v2=r,i}i(t,e);var n=t.prototype;return n.getPoint=function(e,t){void 0===t&&(t=new De);var n=t,r=this.v0,i=this.v1,o=this.v2;return n.set(Lc(e,r.x,i.x,o.x),Lc(e,r.y,i.y,o.y),Lc(e,r.z,i.z,o.z)),n},n.copy=function(t){return e.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this},n.toJSON=function(){var t=e.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},n.fromJSON=function(t){return e.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},t}(Sc);jc.prototype.isQuadraticBezierCurve3=!0;var Vc=function(e){function t(t){var n;return void 0===t&&(t=[]),(n=e.call(this)||this).type="SplineCurve",n.points=t,n}i(t,e);var n=t.prototype;return n.getPoint=function(e,t){void 0===t&&(t=new Re);var n=t,r=this.points,i=(r.length-1)*e,o=Math.floor(i),a=i-o,s=r[0===o?o:o-1],c=r[o],u=r[o>r.length-2?r.length-1:o+1],l=r[o>r.length-3?r.length-1:o+2];return n.set(Mc(a,s.x,c.x,u.x,l.x),Mc(a,s.y,c.y,u.y,l.y)),n},n.copy=function(t){e.prototype.copy.call(this,t),this.points=[];for(var n=0,r=t.points.length;n<r;n++){var i=t.points[n];this.points.push(i.clone())}return this},n.toJSON=function(){var t=e.prototype.toJSON.call(this);t.points=[];for(var n=0,r=this.points.length;n<r;n++){var i=this.points[n];t.points.push(i.toArray())}return t},n.fromJSON=function(t){e.prototype.fromJSON.call(this,t),this.points=[];for(var n=0,r=t.points.length;n<r;n++){var i=t.points[n];this.points.push((new Re).fromArray(i))}return this},t}(Sc);Vc.prototype.isSplineCurve=!0;var Qc=Object.freeze({__proto__:null,ArcCurve:Rc,CatmullRomCurve3:Bc,CubicBezierCurve:Uc,CubicBezierCurve3:Dc,EllipseCurve:Tc,LineCurve:Pc,LineCurve3:Fc,QuadraticBezierCurve:Hc,QuadraticBezierCurve3:jc,SplineCurve:Vc}),Gc=function(e){function t(){var t;return(t=e.call(this)||this).type="CurvePath",t.curves=[],t.autoClose=!1,t}i(t,e);var n=t.prototype;return n.add=function(e){this.curves.push(e)},n.closePath=function(){var e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);e.equals(t)||this.curves.push(new Pc(t,e))},n.getPoint=function(e){for(var t=e*this.getLength(),n=this.getCurveLengths(),r=0;r<n.length;){if(n[r]>=t){var i=n[r]-t,o=this.curves[r],a=o.getLength(),s=0===a?0:1-i/a;return o.getPointAt(s)}r++}return null},n.getLength=function(){var e=this.getCurveLengths();return e[e.length-1]},n.updateArcLengths=function(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()},n.getCurveLengths=function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var e=[],t=0,n=0,r=this.curves.length;n<r;n++)t+=this.curves[n].getLength(),e.push(t);return this.cacheLengths=e,e},n.getSpacedPoints=function(e){void 0===e&&(e=40);for(var t=[],n=0;n<=e;n++)t.push(this.getPoint(n/e));return this.autoClose&&t.push(t[0]),t},n.getPoints=function(e){void 0===e&&(e=12);for(var t,n=[],r=0,i=this.curves;r<i.length;r++)for(var o=i[r],a=o&&o.isEllipseCurve?2*e:o&&(o.isLineCurve||o.isLineCurve3)?1:o&&o.isSplineCurve?e*o.points.length:e,s=o.getPoints(a),c=0;c<s.length;c++){var u=s[c];t&&t.equals(u)||(n.push(u),t=u)}return this.autoClose&&n.length>1&&!n[n.length-1].equals(n[0])&&n.push(n[0]),n},n.copy=function(t){e.prototype.copy.call(this,t),this.curves=[];for(var n=0,r=t.curves.length;n<r;n++){var i=t.curves[n];this.curves.push(i.clone())}return this.autoClose=t.autoClose,this},n.toJSON=function(){var t=e.prototype.toJSON.call(this);t.autoClose=this.autoClose,t.curves=[];for(var n=0,r=this.curves.length;n<r;n++){var i=this.curves[n];t.curves.push(i.toJSON())}return t},n.fromJSON=function(t){e.prototype.fromJSON.call(this,t),this.autoClose=t.autoClose,this.curves=[];for(var n=0,r=t.curves.length;n<r;n++){var i=t.curves[n];this.curves.push((new Qc[i.type]).fromJSON(i))}return this},t}(Sc),zc=function(e){function t(t){var n;return(n=e.call(this)||this).type="Path",n.currentPoint=new Re,t&&n.setFromPoints(t),n}i(t,e);var n=t.prototype;return n.setFromPoints=function(e){this.moveTo(e[0].x,e[0].y);for(var t=1,n=e.length;t<n;t++)this.lineTo(e[t].x,e[t].y);return this},n.moveTo=function(e,t){return this.currentPoint.set(e,t),this},n.lineTo=function(e,t){var n=new Pc(this.currentPoint.clone(),new Re(e,t));return this.curves.push(n),this.currentPoint.set(e,t),this},n.quadraticCurveTo=function(e,t,n,r){var i=new Hc(this.currentPoint.clone(),new Re(e,t),new Re(n,r));return this.curves.push(i),this.currentPoint.set(n,r),this},n.bezierCurveTo=function(e,t,n,r,i,o){var a=new Uc(this.currentPoint.clone(),new Re(e,t),new Re(n,r),new Re(i,o));return this.curves.push(a),this.currentPoint.set(i,o),this},n.splineThru=function(e){var t=[this.currentPoint.clone()].concat(e),n=new Vc(t);return this.curves.push(n),this.currentPoint.copy(e[e.length-1]),this},n.arc=function(e,t,n,r,i,o){var a=this.currentPoint.x,s=this.currentPoint.y;return this.absarc(e+a,t+s,n,r,i,o),this},n.absarc=function(e,t,n,r,i,o){return this.absellipse(e,t,n,n,r,i,o),this},n.ellipse=function(e,t,n,r,i,o,a,s){var c=this.currentPoint.x,u=this.currentPoint.y;return this.absellipse(e+c,t+u,n,r,i,o,a,s),this},n.absellipse=function(e,t,n,r,i,o,a,s){var c=new Tc(e,t,n,r,i,o,a,s);if(this.curves.length>0){var u=c.getPoint(0);u.equals(this.currentPoint)||this.lineTo(u.x,u.y)}this.curves.push(c);var l=c.getPoint(1);return this.currentPoint.copy(l),this},n.copy=function(t){return e.prototype.copy.call(this,t),this.currentPoint.copy(t.currentPoint),this},n.toJSON=function(){var t=e.prototype.toJSON.call(this);return t.currentPoint=this.currentPoint.toArray(),t},n.fromJSON=function(t){return e.prototype.fromJSON.call(this,t),this.currentPoint.fromArray(t.currentPoint),this},t}(Gc),Kc=function(e){function t(t){var n;return(n=e.call(this,t)||this).uuid=me(),n.type="Shape",n.holes=[],n}i(t,e);var n=t.prototype;return n.getPointsHoles=function(e){for(var t=[],n=0,r=this.holes.length;n<r;n++)t[n]=this.holes[n].getPoints(e);return t},n.extractPoints=function(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}},n.copy=function(t){e.prototype.copy.call(this,t),this.holes=[];for(var n=0,r=t.holes.length;n<r;n++){var i=t.holes[n];this.holes.push(i.clone())}return this},n.toJSON=function(){var t=e.prototype.toJSON.call(this);t.uuid=this.uuid,t.holes=[];for(var n=0,r=this.holes.length;n<r;n++){var i=this.holes[n];t.holes.push(i.toJSON())}return t},n.fromJSON=function(t){e.prototype.fromJSON.call(this,t),this.uuid=t.uuid,this.holes=[];for(var n=0,r=t.holes.length;n<r;n++){var i=t.holes[n];this.holes.push((new zc).fromJSON(i))}return this},t}(zc),qc=function(e){function t(t,n){var r;return void 0===n&&(n=1),(r=e.call(this)||this).type="Light",r.color=new ln(t),r.intensity=n,r}i(t,e);var n=t.prototype;return n.dispose=function(){},n.copy=function(t){return e.prototype.copy.call(this,t),this.color.copy(t.color),this.intensity=t.intensity,this},n.toJSON=function(t){var n=e.prototype.toJSON.call(this,t);return n.object.color=this.color.getHex(),n.object.intensity=this.intensity,void 0!==this.groundColor&&(n.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(n.object.distance=this.distance),void 0!==this.angle&&(n.object.angle=this.angle),void 0!==this.decay&&(n.object.decay=this.decay),void 0!==this.penumbra&&(n.object.penumbra=this.penumbra),void 0!==this.shadow&&(n.object.shadow=this.shadow.toJSON()),n},t}(Ft);qc.prototype.isLight=!0;var Wc=function(e){function t(t,n,r){var i;return(i=e.call(this,t,r)||this).type="HemisphereLight",i.position.copy(Ft.DefaultUp),i.updateMatrix(),i.groundColor=new ln(n),i}return i(t,e),t.prototype.copy=function(e){return qc.prototype.copy.call(this,e),this.groundColor.copy(e.groundColor),this},t}(qc);Wc.prototype.isHemisphereLight=!0;var Xc=new pt,Jc=new De,Yc=new De,Zc=function(){function e(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.mapSize=new Re(512,512),this.map=null,this.mapPass=null,this.matrix=new pt,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Ar,this._frameExtents=new Re(1,1),this._viewportCount=1,this._viewports=[new Me(0,0,1,1)]}var t=e.prototype;return t.getViewportCount=function(){return this._viewportCount},t.getFrustum=function(){return this._frustum},t.updateMatrices=function(e){var t=this.camera,n=this.matrix;Jc.setFromMatrixPosition(e.matrixWorld),t.position.copy(Jc),Yc.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(Yc),t.updateMatrixWorld(),Xc.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(Xc),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(t.projectionMatrix),n.multiply(t.matrixWorldInverse)},t.getViewport=function(e){return this._viewports[e]},t.getFrameExtents=function(){return this._frameExtents},t.dispose=function(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()},t.copy=function(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this},t.clone=function(){return(new this.constructor).copy(this)},t.toJSON=function(){var e={};return 0!==this.bias&&(e.bias=this.bias),0!==this.normalBias&&(e.normalBias=this.normalBias),1!==this.radius&&(e.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e},e}(),$c=function(e){function t(){var t;return(t=e.call(this,new sr(50,1,.5,500))||this).focus=1,t}i(t,e);var n=t.prototype;return n.updateMatrices=function(t){var n=this.camera,r=2*ve*t.angle*this.focus,i=this.mapSize.width/this.mapSize.height,o=t.distance||n.far;r===n.fov&&i===n.aspect&&o===n.far||(n.fov=r,n.aspect=i,n.far=o,n.updateProjectionMatrix()),e.prototype.updateMatrices.call(this,t)},n.copy=function(t){return e.prototype.copy.call(this,t),this.focus=t.focus,this},t}(Zc);$c.prototype.isSpotLightShadow=!0;var eu=function(e){function t(t,n,r,i,o,a){var s;return void 0===r&&(r=0),void 0===i&&(i=Math.PI/3),void 0===o&&(o=0),void 0===a&&(a=1),(s=e.call(this,t,n)||this).type="SpotLight",s.position.copy(Ft.DefaultUp),s.updateMatrix(),s.target=new Ft,s.distance=r,s.angle=i,s.penumbra=o,s.decay=a,s.shadow=new $c,s}i(t,e);var n=t.prototype;return n.dispose=function(){this.shadow.dispose()},n.copy=function(t){return e.prototype.copy.call(this,t),this.distance=t.distance,this.angle=t.angle,this.penumbra=t.penumbra,this.decay=t.decay,this.target=t.target.clone(),this.shadow=t.shadow.clone(),this},r(t,[{key:"power",get:function(){return this.intensity*Math.PI},set:function(e){this.intensity=e/Math.PI}}]),t}(qc);eu.prototype.isSpotLight=!0;var tu=new pt,nu=new De,ru=new De,iu=function(e){function t(){var t;return(t=e.call(this,new sr(90,1,.5,500))||this)._frameExtents=new Re(4,2),t._viewportCount=6,t._viewports=[new Me(2,1,1,1),new Me(0,1,1,1),new Me(3,1,1,1),new Me(1,1,1,1),new Me(3,0,1,1),new Me(1,0,1,1)],t._cubeDirections=[new De(1,0,0),new De(-1,0,0),new De(0,0,1),new De(0,0,-1),new De(0,1,0),new De(0,-1,0)],t._cubeUps=[new De(0,1,0),new De(0,1,0),new De(0,1,0),new De(0,1,0),new De(0,0,1),new De(0,0,-1)],t}return i(t,e),t.prototype.updateMatrices=function(e,t){void 0===t&&(t=0);var n=this.camera,r=this.matrix,i=e.distance||n.far;i!==n.far&&(n.far=i,n.updateProjectionMatrix()),nu.setFromMatrixPosition(e.matrixWorld),n.position.copy(nu),ru.copy(n.position),ru.add(this._cubeDirections[t]),n.up.copy(this._cubeUps[t]),n.lookAt(ru),n.updateMatrixWorld(),r.makeTranslation(-nu.x,-nu.y,-nu.z),tu.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(tu)},t}(Zc);iu.prototype.isPointLightShadow=!0;var ou=function(e){function t(t,n,r,i){var o;return void 0===r&&(r=0),void 0===i&&(i=1),(o=e.call(this,t,n)||this).type="PointLight",o.distance=r,o.decay=i,o.shadow=new iu,o}i(t,e);var n=t.prototype;return n.dispose=function(){this.shadow.dispose()},n.copy=function(t){return e.prototype.copy.call(this,t),this.distance=t.distance,this.decay=t.decay,this.shadow=t.shadow.clone(),this},r(t,[{key:"power",get:function(){return 4*this.intensity*Math.PI},set:function(e){this.intensity=e/(4*Math.PI)}}]),t}(qc);ou.prototype.isPointLight=!0;var au=function(e){function t(t,n,r,i,o,a){var s;return void 0===t&&(t=-1),void 0===n&&(n=1),void 0===r&&(r=1),void 0===i&&(i=-1),void 0===o&&(o=.1),void 0===a&&(a=2e3),(s=e.call(this)||this).type="OrthographicCamera",s.zoom=1,s.view=null,s.left=t,s.right=n,s.top=r,s.bottom=i,s.near=o,s.far=a,s.updateProjectionMatrix(),s}i(t,e);var n=t.prototype;return n.copy=function(t,n){return e.prototype.copy.call(this,t,n),this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.near=t.near,this.far=t.far,this.zoom=t.zoom,this.view=null===t.view?null:Object.assign({},t.view),this},n.setViewOffset=function(e,t,n,r,i,o){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=o,this.updateProjectionMatrix()},n.clearViewOffset=function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},n.updateProjectionMatrix=function(){var e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,r=(this.top+this.bottom)/2,i=n-e,o=n+e,a=r+t,s=r-t;if(null!==this.view&&this.view.enabled){var c=(this.right-this.left)/this.view.fullWidth/this.zoom,u=(this.top-this.bottom)/this.view.fullHeight/this.zoom;o=(i+=c*this.view.offsetX)+c*this.view.width,s=(a-=u*this.view.offsetY)-u*this.view.height}this.projectionMatrix.makeOrthographic(i,o,a,s,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()},n.toJSON=function(t){var n=e.prototype.toJSON.call(this,t);return n.object.zoom=this.zoom,n.object.left=this.left,n.object.right=this.right,n.object.top=this.top,n.object.bottom=this.bottom,n.object.near=this.near,n.object.far=this.far,null!==this.view&&(n.object.view=Object.assign({},this.view)),n},t}(ar);au.prototype.isOrthographicCamera=!0;var su=function(e){function t(){return e.call(this,new au(-5,5,5,-5,.5,500))||this}return i(t,e),t}(Zc);su.prototype.isDirectionalLightShadow=!0;var cu=function(e){function t(t,n){var r;return(r=e.call(this,t,n)||this).type="DirectionalLight",r.position.copy(Ft.DefaultUp),r.updateMatrix(),r.target=new Ft,r.shadow=new su,r}i(t,e);var n=t.prototype;return n.dispose=function(){this.shadow.dispose()},n.copy=function(t){return e.prototype.copy.call(this,t),this.target=t.target.clone(),this.shadow=t.shadow.clone(),this},t}(qc);cu.prototype.isDirectionalLight=!0;var uu=function(e){function t(t,n){var r;return(r=e.call(this,t,n)||this).type="AmbientLight",r}return i(t,e),t}(qc);uu.prototype.isAmbientLight=!0;var lu=function(e){function t(t,n,r,i){var o;return void 0===r&&(r=10),void 0===i&&(i=10),(o=e.call(this,t,n)||this).type="RectAreaLight",o.width=r,o.height=i,o}i(t,e);var n=t.prototype;return n.copy=function(t){return e.prototype.copy.call(this,t),this.width=t.width,this.height=t.height,this},n.toJSON=function(t){var n=e.prototype.toJSON.call(this,t);return n.object.width=this.width,n.object.height=this.height,n},t}(qc);lu.prototype.isRectAreaLight=!0;var du=function(){function e(){this.coefficients=[];for(var e=0;e<9;e++)this.coefficients.push(new De)}var t=e.prototype;return t.set=function(e){for(var t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this},t.zero=function(){for(var e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this},t.getAt=function(e,t){var n=e.x,r=e.y,i=e.z,o=this.coefficients;return t.copy(o[0]).multiplyScalar(.282095),t.addScaledVector(o[1],.488603*r),t.addScaledVector(o[2],.488603*i),t.addScaledVector(o[3],.488603*n),t.addScaledVector(o[4],n*r*1.092548),t.addScaledVector(o[5],r*i*1.092548),t.addScaledVector(o[6],.315392*(3*i*i-1)),t.addScaledVector(o[7],n*i*1.092548),t.addScaledVector(o[8],.546274*(n*n-r*r)),t},t.getIrradianceAt=function(e,t){var n=e.x,r=e.y,i=e.z,o=this.coefficients;return t.copy(o[0]).multiplyScalar(.886227),t.addScaledVector(o[1],1.023328*r),t.addScaledVector(o[2],1.023328*i),t.addScaledVector(o[3],1.023328*n),t.addScaledVector(o[4],.858086*n*r),t.addScaledVector(o[5],.858086*r*i),t.addScaledVector(o[6],.743125*i*i-.247708),t.addScaledVector(o[7],.858086*n*i),t.addScaledVector(o[8],.429043*(n*n-r*r)),t},t.add=function(e){for(var t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this},t.addScaledSH=function(e,t){for(var n=0;n<9;n++)this.coefficients[n].addScaledVector(e.coefficients[n],t);return this},t.scale=function(e){for(var t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this},t.lerp=function(e,t){for(var n=0;n<9;n++)this.coefficients[n].lerp(e.coefficients[n],t);return this},t.equals=function(e){for(var t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0},t.copy=function(e){return this.set(e.coefficients)},t.clone=function(){return(new this.constructor).copy(this)},t.fromArray=function(e,t){void 0===t&&(t=0);for(var n=this.coefficients,r=0;r<9;r++)n[r].fromArray(e,t+3*r);return this},t.toArray=function(e,t){void 0===e&&(e=[]),void 0===t&&(t=0);for(var n=this.coefficients,r=0;r<9;r++)n[r].toArray(e,t+3*r);return e},e.getBasisAt=function(e,t){var n=e.x,r=e.y,i=e.z;t[0]=.282095,t[1]=.488603*r,t[2]=.488603*i,t[3]=.488603*n,t[4]=1.092548*n*r,t[5]=1.092548*r*i,t[6]=.315392*(3*i*i-1),t[7]=1.092548*n*i,t[8]=.546274*(n*n-r*r)},e}();du.prototype.isSphericalHarmonics3=!0;var hu=function(e){function t(t,n){var r;return void 0===t&&(t=new du),void 0===n&&(n=1),(r=e.call(this,void 0,n)||this).sh=t,r}i(t,e);var n=t.prototype;return n.copy=function(t){return e.prototype.copy.call(this,t),this.sh.copy(t.sh),this},n.fromJSON=function(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this},n.toJSON=function(t){var n=e.prototype.toJSON.call(this,t);return n.object.sh=this.sh.toArray(),n},t}(qc);hu.prototype.isLightProbe=!0;var fu=function(e){function t(t){var n;return(n=e.call(this,t)||this).textures={},n}i(t,e);var n=t.prototype;return n.load=function(e,t,n,r){var i=this,o=new vc(i.manager);o.setPath(i.path),o.setRequestHeader(i.requestHeader),o.setWithCredentials(i.withCredentials),o.load(e,(function(n){try{t(i.parse(JSON.parse(n)))}catch(t){r?r(t):console.error(t),i.manager.itemError(e)}}),n,r)},n.parse=function(e){var t=this.textures;function n(e){return void 0===t[e]&&console.warn("THREE.MaterialLoader: Undefined texture",e),t[e]}var r=new Js[e.type];if(void 0!==e.uuid&&(r.uuid=e.uuid),void 0!==e.name&&(r.name=e.name),void 0!==e.color&&void 0!==r.color&&r.color.setHex(e.color),void 0!==e.roughness&&(r.roughness=e.roughness),void 0!==e.metalness&&(r.metalness=e.metalness),void 0!==e.sheen&&(r.sheen=(new ln).setHex(e.sheen)),void 0!==e.emissive&&void 0!==r.emissive&&r.emissive.setHex(e.emissive),void 0!==e.specular&&void 0!==r.specular&&r.specular.setHex(e.specular),void 0!==e.shininess&&(r.shininess=e.shininess),void 0!==e.clearcoat&&(r.clearcoat=e.clearcoat),void 0!==e.clearcoatRoughness&&(r.clearcoatRoughness=e.clearcoatRoughness),void 0!==e.fog&&(r.fog=e.fog),void 0!==e.flatShading&&(r.flatShading=e.flatShading),void 0!==e.blending&&(r.blending=e.blending),void 0!==e.combine&&(r.combine=e.combine),void 0!==e.side&&(r.side=e.side),void 0!==e.shadowSide&&(r.shadowSide=e.shadowSide),void 0!==e.opacity&&(r.opacity=e.opacity),void 0!==e.transparent&&(r.transparent=e.transparent),void 0!==e.alphaTest&&(r.alphaTest=e.alphaTest),void 0!==e.depthTest&&(r.depthTest=e.depthTest),void 0!==e.depthWrite&&(r.depthWrite=e.depthWrite),void 0!==e.colorWrite&&(r.colorWrite=e.colorWrite),void 0!==e.stencilWrite&&(r.stencilWrite=e.stencilWrite),void 0!==e.stencilWriteMask&&(r.stencilWriteMask=e.stencilWriteMask),void 0!==e.stencilFunc&&(r.stencilFunc=e.stencilFunc),void 0!==e.stencilRef&&(r.stencilRef=e.stencilRef),void 0!==e.stencilFuncMask&&(r.stencilFuncMask=e.stencilFuncMask),void 0!==e.stencilFail&&(r.stencilFail=e.stencilFail),void 0!==e.stencilZFail&&(r.stencilZFail=e.stencilZFail),void 0!==e.stencilZPass&&(r.stencilZPass=e.stencilZPass),void 0!==e.wireframe&&(r.wireframe=e.wireframe),void 0!==e.wireframeLinewidth&&(r.wireframeLinewidth=e.wireframeLinewidth),void 0!==e.wireframeLinecap&&(r.wireframeLinecap=e.wireframeLinecap),void 0!==e.wireframeLinejoin&&(r.wireframeLinejoin=e.wireframeLinejoin),void 0!==e.rotation&&(r.rotation=e.rotation),1!==e.linewidth&&(r.linewidth=e.linewidth),void 0!==e.dashSize&&(r.dashSize=e.dashSize),void 0!==e.gapSize&&(r.gapSize=e.gapSize),void 0!==e.scale&&(r.scale=e.scale),void 0!==e.polygonOffset&&(r.polygonOffset=e.polygonOffset),void 0!==e.polygonOffsetFactor&&(r.polygonOffsetFactor=e.polygonOffsetFactor),void 0!==e.polygonOffsetUnits&&(r.polygonOffsetUnits=e.polygonOffsetUnits),void 0!==e.skinning&&(r.skinning=e.skinning),void 0!==e.morphTargets&&(r.morphTargets=e.morphTargets),void 0!==e.morphNormals&&(r.morphNormals=e.morphNormals),void 0!==e.dithering&&(r.dithering=e.dithering),void 0!==e.alphaToCoverage&&(r.alphaToCoverage=e.alphaToCoverage),void 0!==e.premultipliedAlpha&&(r.premultipliedAlpha=e.premultipliedAlpha),void 0!==e.vertexTangents&&(r.vertexTangents=e.vertexTangents),void 0!==e.visible&&(r.visible=e.visible),void 0!==e.toneMapped&&(r.toneMapped=e.toneMapped),void 0!==e.userData&&(r.userData=e.userData),void 0!==e.vertexColors&&("number"==typeof e.vertexColors?r.vertexColors=e.vertexColors>0:r.vertexColors=e.vertexColors),void 0!==e.uniforms)for(var i in e.uniforms){var o=e.uniforms[i];switch(r.uniforms[i]={},o.type){case"t":r.uniforms[i].value=n(o.value);break;case"c":r.uniforms[i].value=(new ln).setHex(o.value);break;case"v2":r.uniforms[i].value=(new Re).fromArray(o.value);break;case"v3":r.uniforms[i].value=(new De).fromArray(o.value);break;case"v4":r.uniforms[i].value=(new Me).fromArray(o.value);break;case"m3":r.uniforms[i].value=(new Ie).fromArray(o.value);break;case"m4":r.uniforms[i].value=(new pt).fromArray(o.value);break;default:r.uniforms[i].value=o.value}}if(void 0!==e.defines&&(r.defines=e.defines),void 0!==e.vertexShader&&(r.vertexShader=e.vertexShader),void 0!==e.fragmentShader&&(r.fragmentShader=e.fragmentShader),void 0!==e.extensions)for(var a in e.extensions)r.extensions[a]=e.extensions[a];if(void 0!==e.shading&&(r.flatShading=1===e.shading),void 0!==e.size&&(r.size=e.size),void 0!==e.sizeAttenuation&&(r.sizeAttenuation=e.sizeAttenuation),void 0!==e.map&&(r.map=n(e.map)),void 0!==e.matcap&&(r.matcap=n(e.matcap)),void 0!==e.alphaMap&&(r.alphaMap=n(e.alphaMap)),void 0!==e.bumpMap&&(r.bumpMap=n(e.bumpMap)),void 0!==e.bumpScale&&(r.bumpScale=e.bumpScale),void 0!==e.normalMap&&(r.normalMap=n(e.normalMap)),void 0!==e.normalMapType&&(r.normalMapType=e.normalMapType),void 0!==e.normalScale){var s=e.normalScale;!1===Array.isArray(s)&&(s=[s,s]),r.normalScale=(new Re).fromArray(s)}return void 0!==e.displacementMap&&(r.displacementMap=n(e.displacementMap)),void 0!==e.displacementScale&&(r.displacementScale=e.displacementScale),void 0!==e.displacementBias&&(r.displacementBias=e.displacementBias),void 0!==e.roughnessMap&&(r.roughnessMap=n(e.roughnessMap)),void 0!==e.metalnessMap&&(r.metalnessMap=n(e.metalnessMap)),void 0!==e.emissiveMap&&(r.emissiveMap=n(e.emissiveMap)),void 0!==e.emissiveIntensity&&(r.emissiveIntensity=e.emissiveIntensity),void 0!==e.specularMap&&(r.specularMap=n(e.specularMap)),void 0!==e.envMap&&(r.envMap=n(e.envMap)),void 0!==e.envMapIntensity&&(r.envMapIntensity=e.envMapIntensity),void 0!==e.reflectivity&&(r.reflectivity=e.reflectivity),void 0!==e.refractionRatio&&(r.refractionRatio=e.refractionRatio),void 0!==e.lightMap&&(r.lightMap=n(e.lightMap)),void 0!==e.lightMapIntensity&&(r.lightMapIntensity=e.lightMapIntensity),void 0!==e.aoMap&&(r.aoMap=n(e.aoMap)),void 0!==e.aoMapIntensity&&(r.aoMapIntensity=e.aoMapIntensity),void 0!==e.gradientMap&&(r.gradientMap=n(e.gradientMap)),void 0!==e.clearcoatMap&&(r.clearcoatMap=n(e.clearcoatMap)),void 0!==e.clearcoatRoughnessMap&&(r.clearcoatRoughnessMap=n(e.clearcoatRoughnessMap)),void 0!==e.clearcoatNormalMap&&(r.clearcoatNormalMap=n(e.clearcoatNormalMap)),void 0!==e.clearcoatNormalScale&&(r.clearcoatNormalScale=(new Re).fromArray(e.clearcoatNormalScale)),void 0!==e.transmission&&(r.transmission=e.transmission),void 0!==e.transmissionMap&&(r.transmissionMap=n(e.transmissionMap)),r},n.setTextures=function(e){return this.textures=e,this},t}(Ac),pu=function(){function e(){}return e.decodeText=function(e){if("undefined"!=typeof TextDecoder)return(new TextDecoder).decode(e);for(var t="",n=0,r=e.length;n<r;n++)t+=String.fromCharCode(e[n]);try{return decodeURIComponent(escape(t))}catch(e){return t}},e.extractUrlBase=function(e){var t=e.lastIndexOf("/");return-1===t?"./":e.substr(0,t+1)},e}(),Au=function(e){function t(){var t;return(t=e.call(this)||this).type="InstancedBufferGeometry",t.instanceCount=1/0,t}i(t,e);var n=t.prototype;return n.copy=function(t){return e.prototype.copy.call(this,t),this.instanceCount=t.instanceCount,this},n.clone=function(){return(new this.constructor).copy(this)},n.toJSON=function(){var t=e.prototype.toJSON.call(this,this);return t.instanceCount=this.instanceCount,t.isInstancedBufferGeometry=!0,t},t}(kn);Au.prototype.isInstancedBufferGeometry=!0;var gu=function(e){function t(t,n,r,i){var o;return"number"==typeof r&&(i=r,r=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),(o=e.call(this,t,n,r)||this).meshPerAttribute=i||1,o}i(t,e);var n=t.prototype;return n.copy=function(t){return e.prototype.copy.call(this,t),this.meshPerAttribute=t.meshPerAttribute,this},n.toJSON=function(){var t=e.prototype.toJSON.call(this);return t.meshPerAttribute=this.meshPerAttribute,t.isInstancedBufferAttribute=!0,t},t}(pn);gu.prototype.isInstancedBufferAttribute=!0;var vu=function(e){function t(t){return e.call(this,t)||this}i(t,e);var n=t.prototype;return n.load=function(e,t,n,r){var i=this,o=new vc(i.manager);o.setPath(i.path),o.setRequestHeader(i.requestHeader),o.setWithCredentials(i.withCredentials),o.load(e,(function(n){try{t(i.parse(JSON.parse(n)))}catch(t){r?r(t):console.error(t),i.manager.itemError(e)}}),n,r)},n.parse=function(e){var t={},n={};function r(e,r){if(void 0!==t[r])return t[r];var i=e.interleavedBuffers[r],o=function(e,t){if(void 0!==n[t])return n[t];var r=e.arrayBuffers[t],i=new Uint32Array(r).buffer;return n[t]=i,i}(e,i.buffer),a=Cn(i.type,o),s=new ko(a,i.stride);return s.uuid=i.uuid,t[r]=s,s}var i=e.isInstancedBufferGeometry?new Au:new kn,o=e.data.index;if(void 0!==o){var a=Cn(o.type,o.array);i.setIndex(new pn(a,1))}var s=e.data.attributes;for(var c in s){var u=s[c],l=void 0;if(u.isInterleavedBufferAttribute){var d=r(e.data,u.data);l=new Do(d,u.itemSize,u.offset,u.normalized)}else{var h=Cn(u.type,u.array);l=new(u.isInstancedBufferAttribute?gu:pn)(h,u.itemSize,u.normalized)}void 0!==u.name&&(l.name=u.name),void 0!==u.usage&&l.setUsage(u.usage),void 0!==u.updateRange&&(l.updateRange.offset=u.updateRange.offset,l.updateRange.count=u.updateRange.count),i.setAttribute(c,l)}var f=e.data.morphAttributes;if(f)for(var p in f){for(var A=f[p],g=[],v=0,m=A.length;v<m;v++){var y=A[v],b=void 0;if(y.isInterleavedBufferAttribute){var E=r(e.data,y.data);b=new Do(E,y.itemSize,y.offset,y.normalized)}else{var _=Cn(y.type,y.array);b=new pn(_,y.itemSize,y.normalized)}void 0!==y.name&&(b.name=y.name),g.push(b)}i.morphAttributes[p]=g}e.data.morphTargetsRelative&&(i.morphTargetsRelative=!0);var w=e.data.groups||e.data.drawcalls||e.data.offsets;if(void 0!==w)for(var S=0,T=w.length;S!==T;++S){var R=w[S];i.addGroup(R.start,R.count,R.materialIndex)}var C=e.data.boundingSphere;if(void 0!==C){var I=new De;void 0!==C.center&&I.fromArray(C.center),i.boundingSphere=new ot(I,C.radius)}return e.name&&(i.name=e.name),e.userData&&(i.userData=e.userData),i},t}(Ac),mu=function(e){function t(t){return e.call(this,t)||this}i(t,e);var n=t.prototype;return n.load=function(e,t,n,r){var i=this,o=""===this.path?pu.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||o;var a=new vc(this.manager);a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,(function(n){var o=null;try{o=JSON.parse(n)}catch(t){return void 0!==r&&r(t),void console.error("THREE:ObjectLoader: Can't parse "+e+".",t.message)}var a=o.metadata;void 0!==a&&void 0!==a.type&&"geometry"!==a.type.toLowerCase()?i.parse(o,t):console.error("THREE.ObjectLoader: Can't load "+e)}),n,r)},n.parse=function(e,t){var n=this.parseAnimations(e.animations),r=this.parseShapes(e.shapes),i=this.parseGeometries(e.geometries,r),o=this.parseImages(e.images,(function(){void 0!==t&&t(c)})),a=this.parseTextures(e.textures,o),s=this.parseMaterials(e.materials,a),c=this.parseObject(e.object,i,s,n),u=this.parseSkeletons(e.skeletons,c);if(this.bindSkeletons(c,u),void 0!==t){var l=!1;for(var d in o)if(o[d]instanceof HTMLImageElement){l=!0;break}!1===l&&t(c)}return c},n.parseShapes=function(e){var t={};if(void 0!==e)for(var n=0,r=e.length;n<r;n++){var i=(new Kc).fromJSON(e[n]);t[i.uuid]=i}return t},n.parseSkeletons=function(e,t){var n={},r={};if(t.traverse((function(e){e.isBone&&(r[e.uuid]=e)})),void 0!==e)for(var i=0,o=e.length;i<o;i++){var a=(new ha).fromJSON(e[i],r);n[a.uuid]=a}return n},n.parseGeometries=function(e,t){var n,r={};if(void 0!==e)for(var i=new vu,o=0,a=e.length;o<a;o++){var s=void 0,c=e[o];switch(c.type){case"PlaneGeometry":case"PlaneBufferGeometry":s=new Fs[c.type](c.width,c.height,c.widthSegments,c.heightSegments);break;case"BoxGeometry":case"BoxBufferGeometry":s=new Fs[c.type](c.width,c.height,c.depth,c.widthSegments,c.heightSegments,c.depthSegments);break;case"CircleGeometry":case"CircleBufferGeometry":s=new Fs[c.type](c.radius,c.segments,c.thetaStart,c.thetaLength);break;case"CylinderGeometry":case"CylinderBufferGeometry":s=new Fs[c.type](c.radiusTop,c.radiusBottom,c.height,c.radialSegments,c.heightSegments,c.openEnded,c.thetaStart,c.thetaLength);break;case"ConeGeometry":case"ConeBufferGeometry":s=new Fs[c.type](c.radius,c.height,c.radialSegments,c.heightSegments,c.openEnded,c.thetaStart,c.thetaLength);break;case"SphereGeometry":case"SphereBufferGeometry":s=new Fs[c.type](c.radius,c.widthSegments,c.heightSegments,c.phiStart,c.phiLength,c.thetaStart,c.thetaLength);break;case"DodecahedronGeometry":case"DodecahedronBufferGeometry":case"IcosahedronGeometry":case"IcosahedronBufferGeometry":case"OctahedronGeometry":case"OctahedronBufferGeometry":case"TetrahedronGeometry":case"TetrahedronBufferGeometry":s=new Fs[c.type](c.radius,c.detail);break;case"RingGeometry":case"RingBufferGeometry":s=new Fs[c.type](c.innerRadius,c.outerRadius,c.thetaSegments,c.phiSegments,c.thetaStart,c.thetaLength);break;case"TorusGeometry":case"TorusBufferGeometry":s=new Fs[c.type](c.radius,c.tube,c.radialSegments,c.tubularSegments,c.arc);break;case"TorusKnotGeometry":case"TorusKnotBufferGeometry":s=new Fs[c.type](c.radius,c.tube,c.tubularSegments,c.radialSegments,c.p,c.q);break;case"TubeGeometry":case"TubeBufferGeometry":s=new Fs[c.type]((new Qc[c.path.type]).fromJSON(c.path),c.tubularSegments,c.radius,c.radialSegments,c.closed);break;case"LatheGeometry":case"LatheBufferGeometry":s=new Fs[c.type](c.points,c.segments,c.phiStart,c.phiLength);break;case"PolyhedronGeometry":case"PolyhedronBufferGeometry":s=new Fs[c.type](c.vertices,c.indices,c.radius,c.details);break;case"ShapeGeometry":case"ShapeBufferGeometry":n=[];for(var u=0,l=c.shapes.length;u<l;u++){var d=t[c.shapes[u]];n.push(d)}s=new Fs[c.type](n,c.curveSegments);break;case"ExtrudeGeometry":case"ExtrudeBufferGeometry":n=[];for(var h=0,f=c.shapes.length;h<f;h++){var p=t[c.shapes[h]];n.push(p)}var A=c.options.extrudePath;void 0!==A&&(c.options.extrudePath=(new Qc[A.type]).fromJSON(A)),s=new Fs[c.type](n,c.options);break;case"BufferGeometry":case"InstancedBufferGeometry":s=i.parse(c);break;case"Geometry":console.error('THREE.ObjectLoader: Loading "Geometry" is not supported anymore.');break;default:console.warn('THREE.ObjectLoader: Unsupported geometry type "'+c.type+'"');continue}s.uuid=c.uuid,void 0!==c.name&&(s.name=c.name),!0===s.isBufferGeometry&&void 0!==c.userData&&(s.userData=c.userData),r[c.uuid]=s}return r},n.parseMaterials=function(e,t){var n={},r={};if(void 0!==e){var i=new fu;i.setTextures(t);for(var o=0,a=e.length;o<a;o++){var s=e[o];if("MultiMaterial"===s.type){for(var c=[],u=0;u<s.materials.length;u++){var l=s.materials[u];void 0===n[l.uuid]&&(n[l.uuid]=i.parse(l)),c.push(n[l.uuid])}r[s.uuid]=c}else void 0===n[s.uuid]&&(n[s.uuid]=i.parse(s)),r[s.uuid]=n[s.uuid]}}return r},n.parseAnimations=function(e){var t={};if(void 0!==e)for(var n=0;n<e.length;n++){var r=e[n],i=lc.parse(r);t[i.uuid]=i}return t},n.parseImages=function(e,t){var n,r=this,i={};function o(e){if("string"==typeof e){var t=e;return function(e){return r.manager.itemStart(e),n.load(e,(function(){r.manager.itemEnd(e)}),void 0,(function(){r.manager.itemError(e),r.manager.itemEnd(e)}))}(/^(\/\/)|([a-z]+:(\/\/)?)/i.test(t)?t:r.resourcePath+t)}return e.data?{data:Cn(e.type,e.data),width:e.width,height:e.height}:null}if(void 0!==e&&e.length>0){var a=new fc(t);(n=new bc(a)).setCrossOrigin(this.crossOrigin);for(var s=0,c=e.length;s<c;s++){var u=e[s],l=u.url;if(Array.isArray(l)){i[u.uuid]=[];for(var d=0,h=l.length;d<h;d++){var f=o(l[d]);null!==f&&(f instanceof HTMLImageElement?i[u.uuid].push(f):i[u.uuid].push(new hr(f.data,f.width,f.height)))}}else{var p=o(u.url);null!==p&&(i[u.uuid]=p)}}}return i},n.parseTextures=function(e,t){function n(e,t){return"number"==typeof e?e:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",e),t[e])}var r={};if(void 0!==e)for(var i=0,o=e.length;i<o;i++){var a=e[i];void 0===a.image&&console.warn('THREE.ObjectLoader: No "image" specified for',a.uuid),void 0===t[a.image]&&console.warn("THREE.ObjectLoader: Undefined image",a.image);var s=void 0,c=t[a.image];Array.isArray(c)?(s=new lr(c),6===c.length&&(s.needsUpdate=!0)):(s=c&&c.data?new hr(c.data,c.width,c.height):new Ne(c),c&&(s.needsUpdate=!0)),s.uuid=a.uuid,void 0!==a.name&&(s.name=a.name),void 0!==a.mapping&&(s.mapping=n(a.mapping,yu)),void 0!==a.offset&&s.offset.fromArray(a.offset),void 0!==a.repeat&&s.repeat.fromArray(a.repeat),void 0!==a.center&&s.center.fromArray(a.center),void 0!==a.rotation&&(s.rotation=a.rotation),void 0!==a.wrap&&(s.wrapS=n(a.wrap[0],bu),s.wrapT=n(a.wrap[1],bu)),void 0!==a.format&&(s.format=a.format),void 0!==a.type&&(s.type=a.type),void 0!==a.encoding&&(s.encoding=a.encoding),void 0!==a.minFilter&&(s.minFilter=n(a.minFilter,Eu)),void 0!==a.magFilter&&(s.magFilter=n(a.magFilter,Eu)),void 0!==a.anisotropy&&(s.anisotropy=a.anisotropy),void 0!==a.flipY&&(s.flipY=a.flipY),void 0!==a.premultiplyAlpha&&(s.premultiplyAlpha=a.premultiplyAlpha),void 0!==a.unpackAlignment&&(s.unpackAlignment=a.unpackAlignment),r[a.uuid]=s}return r},n.parseObject=function(e,t,n,r){var i,o,a;function s(e){return void 0===t[e]&&console.warn("THREE.ObjectLoader: Undefined geometry",e),t[e]}function c(e){if(void 0!==e){if(Array.isArray(e)){for(var t=[],r=0,i=e.length;r<i;r++){var o=e[r];void 0===n[o]&&console.warn("THREE.ObjectLoader: Undefined material",o),t.push(n[o])}return t}return void 0===n[e]&&console.warn("THREE.ObjectLoader: Undefined material",e),n[e]}}switch(e.type){case"Scene":i=new Lo,void 0!==e.background&&Number.isInteger(e.background)&&(i.background=new ln(e.background)),void 0!==e.fog&&("Fog"===e.fog.type?i.fog=new Mo(e.fog.color,e.fog.near,e.fog.far):"FogExp2"===e.fog.type&&(i.fog=new Bo(e.fog.color,e.fog.density)));break;case"PerspectiveCamera":i=new sr(e.fov,e.aspect,e.near,e.far),void 0!==e.focus&&(i.focus=e.focus),void 0!==e.zoom&&(i.zoom=e.zoom),void 0!==e.filmGauge&&(i.filmGauge=e.filmGauge),void 0!==e.filmOffset&&(i.filmOffset=e.filmOffset),void 0!==e.view&&(i.view=Object.assign({},e.view));break;case"OrthographicCamera":i=new au(e.left,e.right,e.top,e.bottom,e.near,e.far),void 0!==e.zoom&&(i.zoom=e.zoom),void 0!==e.view&&(i.view=Object.assign({},e.view));break;case"AmbientLight":i=new uu(e.color,e.intensity);break;case"DirectionalLight":i=new cu(e.color,e.intensity);break;case"PointLight":i=new ou(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":i=new lu(e.color,e.intensity,e.width,e.height);break;case"SpotLight":i=new eu(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":i=new Wc(e.color,e.groundColor,e.intensity);break;case"LightProbe":i=(new hu).fromJSON(e);break;case"SkinnedMesh":o=s(e.geometry),a=c(e.material),i=new ca(o,a),void 0!==e.bindMode&&(i.bindMode=e.bindMode),void 0!==e.bindMatrix&&i.bindMatrix.fromArray(e.bindMatrix),void 0!==e.skeleton&&(i.skeleton=e.skeleton);break;case"Mesh":o=s(e.geometry),a=c(e.material),i=new $n(o,a);break;case"InstancedMesh":o=s(e.geometry),a=c(e.material);var u=e.count,l=e.instanceMatrix,d=e.instanceColor;(i=new va(o,a,u)).instanceMatrix=new pn(new Float32Array(l.array),16),void 0!==d&&(i.instanceColor=new pn(new Float32Array(d.array),d.itemSize));break;case"LOD":i=new na;break;case"Line":i=new Sa(s(e.geometry),c(e.material));break;case"LineLoop":i=new Ia(s(e.geometry),c(e.material));break;case"LineSegments":i=new Ca(s(e.geometry),c(e.material));break;case"PointCloud":case"Points":i=new La(s(e.geometry),c(e.material));break;case"Sprite":i=new Zo(c(e.material));break;case"Group":i=new To;break;case"Bone":i=new ua;break;default:i=new Ft}if(i.uuid=e.uuid,void 0!==e.name&&(i.name=e.name),void 0!==e.matrix?(i.matrix.fromArray(e.matrix),void 0!==e.matrixAutoUpdate&&(i.matrixAutoUpdate=e.matrixAutoUpdate),i.matrixAutoUpdate&&i.matrix.decompose(i.position,i.quaternion,i.scale)):(void 0!==e.position&&i.position.fromArray(e.position),void 0!==e.rotation&&i.rotation.fromArray(e.rotation),void 0!==e.quaternion&&i.quaternion.fromArray(e.quaternion),void 0!==e.scale&&i.scale.fromArray(e.scale)),void 0!==e.castShadow&&(i.castShadow=e.castShadow),void 0!==e.receiveShadow&&(i.receiveShadow=e.receiveShadow),e.shadow&&(void 0!==e.shadow.bias&&(i.shadow.bias=e.shadow.bias),void 0!==e.shadow.normalBias&&(i.shadow.normalBias=e.shadow.normalBias),void 0!==e.shadow.radius&&(i.shadow.radius=e.shadow.radius),void 0!==e.shadow.mapSize&&i.shadow.mapSize.fromArray(e.shadow.mapSize),void 0!==e.shadow.camera&&(i.shadow.camera=this.parseObject(e.shadow.camera))),void 0!==e.visible&&(i.visible=e.visible),void 0!==e.frustumCulled&&(i.frustumCulled=e.frustumCulled),void 0!==e.renderOrder&&(i.renderOrder=e.renderOrder),void 0!==e.userData&&(i.userData=e.userData),void 0!==e.layers&&(i.layers.mask=e.layers),void 0!==e.children)for(var h=e.children,f=0;f<h.length;f++)i.add(this.parseObject(h[f],t,n,r));if(void 0!==e.animations)for(var p=e.animations,A=0;A<p.length;A++){var g=p[A];i.animations.push(r[g])}if("LOD"===e.type){void 0!==e.autoUpdate&&(i.autoUpdate=e.autoUpdate);for(var v=e.levels,m=0;m<v.length;m++){var y=v[m],b=i.getObjectByProperty("uuid",y.object);void 0!==b&&i.addLevel(b,y.distance)}}return i},n.bindSkeletons=function(e,t){0!==Object.keys(t).length&&e.traverse((function(e){if(!0===e.isSkinnedMesh&&void 0!==e.skeleton){var n=t[e.skeleton];void 0===n?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",e.skeleton):e.bind(n,e.bindMatrix)}}))},n.setTexturePath=function(e){return console.warn("THREE.ObjectLoader: .setTexturePath() has been renamed to .setResourcePath()."),this.setResourcePath(e)},t}(Ac),yu={UVMapping:d,CubeReflectionMapping:h,CubeRefractionMapping:f,EquirectangularReflectionMapping:p,EquirectangularRefractionMapping:A,CubeUVReflectionMapping:g,CubeUVRefractionMapping:v},bu={RepeatWrapping:m,ClampToEdgeWrapping:y,MirroredRepeatWrapping:b},Eu={NearestFilter:E,NearestMipmapNearestFilter:_,NearestMipmapLinearFilter:w,LinearFilter:S,LinearMipmapNearestFilter:T,LinearMipmapLinearFilter:R},_u=function(e){function t(t){var n;return n=e.call(this,t)||this,"undefined"==typeof createImageBitmap&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),"undefined"==typeof fetch&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),n.options={premultiplyAlpha:"none"},n}i(t,e);var n=t.prototype;return n.setOptions=function(e){return this.options=e,this},n.load=function(e,t,n,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);var i=this,o=hc.get(e);if(void 0!==o)return i.manager.itemStart(e),setTimeout((function(){t&&t(o),i.manager.itemEnd(e)}),0),o;var a={};a.credentials="anonymous"===this.crossOrigin?"same-origin":"include",a.headers=this.requestHeader,fetch(e,a).then((function(e){return e.blob()})).then((function(e){return createImageBitmap(e,Object.assign(i.options,{colorSpaceConversion:"none"}))})).then((function(n){hc.add(e,n),t&&t(n),i.manager.itemEnd(e)})).catch((function(t){r&&r(t),i.manager.itemError(e),i.manager.itemEnd(e)})),i.manager.itemStart(e)},t}(Ac);_u.prototype.isImageBitmapLoader=!0;var wu=function(){function e(){this.type="ShapePath",this.color=new ln,this.subPaths=[],this.currentPath=null}var t=e.prototype;return t.moveTo=function(e,t){return this.currentPath=new zc,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this},t.lineTo=function(e,t){return this.currentPath.lineTo(e,t),this},t.quadraticCurveTo=function(e,t,n,r){return this.currentPath.quadraticCurveTo(e,t,n,r),this},t.bezierCurveTo=function(e,t,n,r,i,o){return this.currentPath.bezierCurveTo(e,t,n,r,i,o),this},t.splineThru=function(e){return this.currentPath.splineThru(e),this},t.toShapes=function(e,t){function n(e){for(var t=[],n=0,r=e.length;n<r;n++){var i=e[n],o=new Kc;o.curves=i.curves,t.push(o)}return t}function r(e,t){for(var n=t.length,r=!1,i=n-1,o=0;o<n;i=o++){var a=t[i],s=t[o],c=s.x-a.x,u=s.y-a.y;if(Math.abs(u)>Number.EPSILON){if(u<0&&(a=t[o],c=-c,s=t[i],u=-u),e.y<a.y||e.y>s.y)continue;if(e.y===a.y){if(e.x===a.x)return!0}else{var l=u*(e.x-a.x)-c*(e.y-a.y);if(0===l)return!0;if(l<0)continue;r=!r}}else{if(e.y!==a.y)continue;if(s.x<=e.x&&e.x<=a.x||a.x<=e.x&&e.x<=s.x)return!0}}return r}var i,o,a,s=Es.isClockWise,c=this.subPaths;if(0===c.length)return[];if(!0===t)return n(c);var u=[];if(1===c.length)return o=c[0],(a=new Kc).curves=o.curves,u.push(a),u;var l=!s(c[0].getPoints());l=e?!l:l;var d,h,f=[],p=[],A=[],g=0;p[g]=void 0,A[g]=[];for(var v=0,m=c.length;v<m;v++)i=s(d=(o=c[v]).getPoints()),(i=e?!i:i)?(!l&&p[g]&&g++,p[g]={s:new Kc,p:d},p[g].s.curves=o.curves,l&&g++,A[g]=[]):A[g].push({h:o,p:d[0]});if(!p[0])return n(c);if(p.length>1){for(var y=!1,b=[],E=0,_=p.length;E<_;E++)f[E]=[];for(var w=0,S=p.length;w<S;w++)for(var T=A[w],R=0;R<T.length;R++){for(var C=T[R],I=!0,x=0;x<p.length;x++)r(C.p,p[x].p)&&(w!==x&&b.push({froms:w,tos:x,hole:R}),I?(I=!1,f[x].push(C)):y=!0);I&&f[w].push(C)}b.length>0&&(y||(A=f))}for(var O=0,N=p.length;O<N;O++){a=p[O].s,u.push(a);for(var B=0,M=(h=A[O]).length;B<M;B++)a.holes.push(h[B].h)}return u},e}(),Su=function(){function e(e){this.type="Font",this.data=e}return e.prototype.generateShapes=function(e,t){void 0===t&&(t=100);for(var n=[],r=function(e,t,n){for(var r=Array.from(e),i=t/n.resolution,o=(n.boundingBox.yMax-n.boundingBox.yMin+n.underlineThickness)*i,a=[],s=0,c=0,u=0;u<r.length;u++){var l=r[u];if("\n"===l)s=0,c-=o;else{var d=Tu(l,i,s,c,n);s+=d.offsetX,a.push(d.path)}}return a}(e,t,this.data),i=0,o=r.length;i<o;i++)Array.prototype.push.apply(n,r[i].toShapes());return n},e}();function Tu(e,t,n,r,i){var o=i.glyphs[e]||i.glyphs["?"];if(o){var a,s,c,u,l,d,h,f,p=new wu;if(o.o)for(var A=o._cachedOutline||(o._cachedOutline=o.o.split(" ")),g=0,v=A.length;g<v;){switch(A[g++]){case"m":a=A[g++]*t+n,s=A[g++]*t+r,p.moveTo(a,s);break;case"l":a=A[g++]*t+n,s=A[g++]*t+r,p.lineTo(a,s);break;case"q":c=A[g++]*t+n,u=A[g++]*t+r,l=A[g++]*t+n,d=A[g++]*t+r,p.quadraticCurveTo(l,d,c,u);break;case"b":c=A[g++]*t+n,u=A[g++]*t+r,l=A[g++]*t+n,d=A[g++]*t+r,h=A[g++]*t+n,f=A[g++]*t+r,p.bezierCurveTo(l,d,h,f,c,u)}}return{offsetX:o.ha*t,path:p}}console.error('THREE.Font: character "'+e+'" does not exists in font family '+i.familyName+".")}Su.prototype.isFont=!0;var Ru,Cu=function(e){function t(t){return e.call(this,t)||this}i(t,e);var n=t.prototype;return n.load=function(e,t,n,r){var i=this,o=new vc(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(i.withCredentials),o.load(e,(function(e){var n;try{n=JSON.parse(e)}catch(t){console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),n=JSON.parse(e.substring(65,e.length-2))}var r=i.parse(n);t&&t(r)}),n,r)},n.parse=function(e){return new Su(e)},t}(Ac),Iu={getContext:function(){return void 0===Ru&&(Ru=new(window.AudioContext||window.webkitAudioContext)),Ru},setContext:function(e){Ru=e}},xu=function(e){function t(t){return e.call(this,t)||this}return i(t,e),t.prototype.load=function(e,t,n,r){var i=this,o=new vc(this.manager);o.setResponseType("arraybuffer"),o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,(function(n){try{var o=n.slice(0);Iu.getContext().decodeAudioData(o,(function(e){t(e)}))}catch(t){r?r(t):console.error(t),i.manager.itemError(e)}}),n,r)},t}(Ac),Ou=function(e){function t(t,n,r){var i;void 0===r&&(r=1),i=e.call(this,void 0,r)||this;var o=(new ln).set(t),a=(new ln).set(n),s=new De(o.r,o.g,o.b),c=new De(a.r,a.g,a.b),u=Math.sqrt(Math.PI),l=u*Math.sqrt(.75);return i.sh.coefficients[0].copy(s).add(c).multiplyScalar(u),i.sh.coefficients[1].copy(s).sub(c).multiplyScalar(l),i}return i(t,e),t}(hu);Ou.prototype.isHemisphereLightProbe=!0;var Nu=function(e){function t(t,n){var r;void 0===n&&(n=1),r=e.call(this,void 0,n)||this;var i=(new ln).set(t);return r.sh.coefficients[0].set(i.r,i.g,i.b).multiplyScalar(2*Math.sqrt(Math.PI)),r}return i(t,e),t}(hu);Nu.prototype.isAmbientLightProbe=!0;var Bu=new pt,Mu=new pt,Lu=function(){function e(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new sr,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new sr,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}return e.prototype.update=function(e){var t=this._cache;if(t.focus!==e.focus||t.fov!==e.fov||t.aspect!==e.aspect*this.aspect||t.near!==e.near||t.far!==e.far||t.zoom!==e.zoom||t.eyeSep!==this.eyeSep){t.focus=e.focus,t.fov=e.fov,t.aspect=e.aspect*this.aspect,t.near=e.near,t.far=e.far,t.zoom=e.zoom,t.eyeSep=this.eyeSep;var n,r,i=e.projectionMatrix.clone(),o=t.eyeSep/2,a=o*t.near/t.focus,s=t.near*Math.tan(ge*t.fov*.5)/t.zoom;Mu.elements[12]=-o,Bu.elements[12]=o,n=-s*t.aspect+a,r=s*t.aspect+a,i.elements[0]=2*t.near/(r-n),i.elements[8]=(r+n)/(r-n),this.cameraL.projectionMatrix.copy(i),n=-s*t.aspect-a,r=s*t.aspect-a,i.elements[0]=2*t.near/(r-n),i.elements[8]=(r+n)/(r-n),this.cameraR.projectionMatrix.copy(i)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(Mu),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(Bu)},e}(),ku=function(){function e(e){void 0===e&&(e=!0),this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}var t=e.prototype;return t.start=function(){this.startTime=Uu(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0},t.stop=function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1},t.getElapsedTime=function(){return this.getDelta(),this.elapsedTime},t.getDelta=function(){var e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var t=Uu();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e},e}();function Uu(){return("undefined"==typeof performance?Date:performance).now()}var Du=new De,Pu=new Ue,Fu=new De,Hu=new De,ju=function(e){function t(){var t;return(t=e.call(this)||this).type="AudioListener",t.context=Iu.getContext(),t.gain=t.context.createGain(),t.gain.connect(t.context.destination),t.filter=null,t.timeDelta=0,t._clock=new ku,t}i(t,e);var n=t.prototype;return n.getInput=function(){return this.gain},n.removeFilter=function(){return null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this},n.getFilter=function(){return this.filter},n.setFilter=function(e){return null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this},n.getMasterVolume=function(){return this.gain.gain.value},n.setMasterVolume=function(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this},n.updateMatrixWorld=function(t){e.prototype.updateMatrixWorld.call(this,t);var n=this.context.listener,r=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(Du,Pu,Fu),Hu.set(0,0,-1).applyQuaternion(Pu),n.positionX){var i=this.context.currentTime+this.timeDelta;n.positionX.linearRampToValueAtTime(Du.x,i),n.positionY.linearRampToValueAtTime(Du.y,i),n.positionZ.linearRampToValueAtTime(Du.z,i),n.forwardX.linearRampToValueAtTime(Hu.x,i),n.forwardY.linearRampToValueAtTime(Hu.y,i),n.forwardZ.linearRampToValueAtTime(Hu.z,i),n.upX.linearRampToValueAtTime(r.x,i),n.upY.linearRampToValueAtTime(r.y,i),n.upZ.linearRampToValueAtTime(r.z,i)}else n.setPosition(Du.x,Du.y,Du.z),n.setOrientation(Hu.x,Hu.y,Hu.z,r.x,r.y,r.z)},t}(Ft),Vu=function(e){function t(t){var n;return(n=e.call(this)||this).type="Audio",n.listener=t,n.context=t.context,n.gain=n.context.createGain(),n.gain.connect(t.getInput()),n.autoplay=!1,n.buffer=null,n.detune=0,n.loop=!1,n.loopStart=0,n.loopEnd=0,n.offset=0,n.duration=void 0,n.playbackRate=1,n.isPlaying=!1,n.hasPlaybackControl=!0,n.source=null,n.sourceType="empty",n._startedAt=0,n._progress=0,n._connected=!1,n.filters=[],n}i(t,e);var n=t.prototype;return n.getOutput=function(){return this.gain},n.setNodeSource=function(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this},n.setMediaElementSource=function(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this},n.setMediaStreamSource=function(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this},n.setBuffer=function(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this},n.play=function(e){if(void 0===e&&(e=0),!0!==this.isPlaying){if(!1!==this.hasPlaybackControl){this._startedAt=this.context.currentTime+e;var t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.onended=this.onEnded.bind(this),t.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}console.warn("THREE.Audio: this Audio has no playback control.")}else console.warn("THREE.Audio: Audio is already playing.")},n.pause=function(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,!0===this.loop&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")},n.stop=function(){if(!1!==this.hasPlaybackControl)return this._progress=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")},n.connect=function(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(var e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this},n.disconnect=function(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(var e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this},n.getFilters=function(){return this.filters},n.setFilters=function(e){return e||(e=[]),!0===this._connected?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this},n.setDetune=function(e){if(this.detune=e,void 0!==this.source.detune)return!0===this.isPlaying&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this},n.getDetune=function(){return this.detune},n.getFilter=function(){return this.getFilters()[0]},n.setFilter=function(e){return this.setFilters(e?[e]:[])},n.setPlaybackRate=function(e){if(!1!==this.hasPlaybackControl)return this.playbackRate=e,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this;console.warn("THREE.Audio: this Audio has no playback control.")},n.getPlaybackRate=function(){return this.playbackRate},n.onEnded=function(){this.isPlaying=!1},n.getLoop=function(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop},n.setLoop=function(e){if(!1!==this.hasPlaybackControl)return this.loop=e,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")},n.setLoopStart=function(e){return this.loopStart=e,this},n.setLoopEnd=function(e){return this.loopEnd=e,this},n.getVolume=function(){return this.gain.gain.value},n.setVolume=function(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this},t}(Ft),Qu=new De,Gu=new Ue,zu=new De,Ku=new De,qu=function(e){function t(t){var n;return(n=e.call(this,t)||this).panner=n.context.createPanner(),n.panner.panningModel="HRTF",n.panner.connect(n.gain),n}i(t,e);var n=t.prototype;return n.getOutput=function(){return this.panner},n.getRefDistance=function(){return this.panner.refDistance},n.setRefDistance=function(e){return this.panner.refDistance=e,this},n.getRolloffFactor=function(){return this.panner.rolloffFactor},n.setRolloffFactor=function(e){return this.panner.rolloffFactor=e,this},n.getDistanceModel=function(){return this.panner.distanceModel},n.setDistanceModel=function(e){return this.panner.distanceModel=e,this},n.getMaxDistance=function(){return this.panner.maxDistance},n.setMaxDistance=function(e){return this.panner.maxDistance=e,this},n.setDirectionalCone=function(e,t,n){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=t,this.panner.coneOuterGain=n,this},n.updateMatrixWorld=function(t){if(e.prototype.updateMatrixWorld.call(this,t),!0!==this.hasPlaybackControl||!1!==this.isPlaying){this.matrixWorld.decompose(Qu,Gu,zu),Ku.set(0,0,1).applyQuaternion(Gu);var n=this.panner;if(n.positionX){var r=this.context.currentTime+this.listener.timeDelta;n.positionX.linearRampToValueAtTime(Qu.x,r),n.positionY.linearRampToValueAtTime(Qu.y,r),n.positionZ.linearRampToValueAtTime(Qu.z,r),n.orientationX.linearRampToValueAtTime(Ku.x,r),n.orientationY.linearRampToValueAtTime(Ku.y,r),n.orientationZ.linearRampToValueAtTime(Ku.z,r)}else n.setPosition(Qu.x,Qu.y,Qu.z),n.setOrientation(Ku.x,Ku.y,Ku.z)}},t}(Vu),Wu=function(){function e(e,t){void 0===t&&(t=2048),this.analyser=e.context.createAnalyser(),this.analyser.fftSize=t,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}var t=e.prototype;return t.getFrequencyData=function(){return this.analyser.getByteFrequencyData(this.data),this.data},t.getAverageFrequency=function(){for(var e=0,t=this.getFrequencyData(),n=0;n<t.length;n++)e+=t[n];return e/t.length},e}(),Xu=function(){function e(e,t,n){var r,i,o;switch(this.binding=e,this.valueSize=n,t){case"quaternion":r=this._slerp,i=this._slerpAdditive,o=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(6*n),this._workIndex=5;break;case"string":case"bool":r=this._select,i=this._select,o=this._setAdditiveIdentityOther,this.buffer=new Array(5*n);break;default:r=this._lerp,i=this._lerpAdditive,o=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*n)}this._mixBufferRegion=r,this._mixBufferRegionAdditive=i,this._setIdentity=o,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}var t=e.prototype;return t.accumulate=function(e,t){var n=this.buffer,r=this.valueSize,i=e*r+r,o=this.cumulativeWeight;if(0===o){for(var a=0;a!==r;++a)n[i+a]=n[a];o=t}else{var s=t/(o+=t);this._mixBufferRegion(n,i,0,s,r)}this.cumulativeWeight=o},t.accumulateAdditive=function(e){var t=this.buffer,n=this.valueSize,r=n*this._addIndex;0===this.cumulativeWeightAdditive&&this._setIdentity(),this._mixBufferRegionAdditive(t,r,0,e,n),this.cumulativeWeightAdditive+=e},t.apply=function(e){var t=this.valueSize,n=this.buffer,r=e*t+t,i=this.cumulativeWeight,o=this.cumulativeWeightAdditive,a=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,i<1){var s=t*this._origIndex;this._mixBufferRegion(n,r,s,1-i,t)}o>0&&this._mixBufferRegionAdditive(n,r,this._addIndex*t,1,t);for(var c=t,u=t+t;c!==u;++c)if(n[c]!==n[c+t]){a.setValue(n,r);break}},t.saveOriginalState=function(){var e=this.binding,t=this.buffer,n=this.valueSize,r=n*this._origIndex;e.getValue(t,r);for(var i=n,o=r;i!==o;++i)t[i]=t[r+i%n];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0},t.restoreOriginalState=function(){var e=3*this.valueSize;this.binding.setValue(this.buffer,e)},t._setAdditiveIdentityNumeric=function(){for(var e=this._addIndex*this.valueSize,t=e+this.valueSize,n=e;n<t;n++)this.buffer[n]=0},t._setAdditiveIdentityQuaternion=function(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1},t._setAdditiveIdentityOther=function(){for(var e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize,n=0;n<this.valueSize;n++)this.buffer[t+n]=this.buffer[e+n]},t._select=function(e,t,n,r,i){if(r>=.5)for(var o=0;o!==i;++o)e[t+o]=e[n+o]},t._slerp=function(e,t,n,r){Ue.slerpFlat(e,t,e,t,e,n,r)},t._slerpAdditive=function(e,t,n,r,i){var o=this._workIndex*i;Ue.multiplyQuaternionsFlat(e,o,e,t,e,n),Ue.slerpFlat(e,t,e,t,e,o,r)},t._lerp=function(e,t,n,r,i){for(var o=1-r,a=0;a!==i;++a){var s=t+a;e[s]=e[s]*o+e[n+a]*r}},t._lerpAdditive=function(e,t,n,r,i){for(var o=0;o!==i;++o){var a=t+o;e[a]=e[a]+e[n+o]*r}},e}(),Ju="\\[\\]\\.:\\/",Yu=new RegExp("[\\[\\]\\.:\\/]","g"),Zu="[^\\[\\]\\.:\\/]",$u="[^"+Ju.replace("\\.","")+"]",el=/((?:WC+[\/:])*)/.source.replace("WC",Zu),tl=/(WCOD+)?/.source.replace("WCOD",$u),nl=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",Zu),rl=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",Zu),il=new RegExp("^"+el+tl+nl+rl+"$"),ol=["material","materials","bones"],al=function(){function e(e,t,n){var r=n||sl.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,r)}var t=e.prototype;return t.getValue=function(e,t){this.bind();var n=this._targetGroup.nCachedObjects_,r=this._bindings[n];void 0!==r&&r.getValue(e,t)},t.setValue=function(e,t){for(var n=this._bindings,r=this._targetGroup.nCachedObjects_,i=n.length;r!==i;++r)n[r].setValue(e,t)},t.bind=function(){for(var e=this._bindings,t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].bind()},t.unbind=function(){for(var e=this._bindings,t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].unbind()},e}(),sl=function(){function e(t,n,r){this.path=n,this.parsedPath=r||e.parseTrackName(n),this.node=e.findNode(t,this.parsedPath.nodeName)||t,this.rootNode=t,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}e.create=function(t,n,r){return t&&t.isAnimationObjectGroup?new e.Composite(t,n,r):new e(t,n,r)},e.sanitizeNodeName=function(e){return e.replace(/\s/g,"_").replace(Yu,"")},e.parseTrackName=function(e){var t=il.exec(e);if(!t)throw new Error("PropertyBinding: Cannot parse trackName: "+e);var n={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},r=n.nodeName&&n.nodeName.lastIndexOf(".");if(void 0!==r&&-1!==r){var i=n.nodeName.substring(r+1);-1!==ol.indexOf(i)&&(n.nodeName=n.nodeName.substring(0,r),n.objectName=i)}if(null===n.propertyName||0===n.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return n},e.findNode=function(e,t){if(!t||""===t||"."===t||-1===t||t===e.name||t===e.uuid)return e;if(e.skeleton){var n=e.skeleton.getBoneByName(t);if(void 0!==n)return n}if(e.children){var r=function e(n){for(var r=0;r<n.length;r++){var i=n[r];if(i.name===t||i.uuid===t)return i;var o=e(i.children);if(o)return o}return null}(e.children);if(r)return r}return null};var t=e.prototype;return t._getValue_unavailable=function(){},t._setValue_unavailable=function(){},t._getValue_direct=function(e,t){e[t]=this.node[this.propertyName]},t._getValue_array=function(e,t){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)e[t++]=n[r]},t._getValue_arrayElement=function(e,t){e[t]=this.resolvedProperty[this.propertyIndex]},t._getValue_toArray=function(e,t){this.resolvedProperty.toArray(e,t)},t._setValue_direct=function(e,t){this.targetObject[this.propertyName]=e[t]},t._setValue_direct_setNeedsUpdate=function(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0},t._setValue_direct_setMatrixWorldNeedsUpdate=function(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0},t._setValue_array=function(e,t){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)n[r]=e[t++]},t._setValue_array_setNeedsUpdate=function(e,t){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)n[r]=e[t++];this.targetObject.needsUpdate=!0},t._setValue_array_setMatrixWorldNeedsUpdate=function(e,t){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)n[r]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0},t._setValue_arrayElement=function(e,t){this.resolvedProperty[this.propertyIndex]=e[t]},t._setValue_arrayElement_setNeedsUpdate=function(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0},t._setValue_arrayElement_setMatrixWorldNeedsUpdate=function(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0},t._setValue_fromArray=function(e,t){this.resolvedProperty.fromArray(e,t)},t._setValue_fromArray_setNeedsUpdate=function(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0},t._setValue_fromArray_setMatrixWorldNeedsUpdate=function(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0},t._getValue_unbound=function(e,t){this.bind(),this.getValue(e,t)},t._setValue_unbound=function(e,t){this.bind(),this.setValue(e,t)},t.bind=function(){var t=this.node,n=this.parsedPath,r=n.objectName,i=n.propertyName,o=n.propertyIndex;if(t||(t=e.findNode(this.rootNode,n.nodeName)||this.rootNode,this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,t){if(r){var a=n.objectIndex;switch(r){case"materials":if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);t=t.skeleton.bones;for(var s=0;s<t.length;s++)if(t[s].name===a){a=s;break}break;default:if(void 0===t[r])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);t=t[r]}if(void 0!==a){if(void 0===t[a])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);t=t[a]}}var c=t[i];if(void 0!==c){var u=this.Versioning.None;this.targetObject=t,void 0!==t.needsUpdate?u=this.Versioning.NeedsUpdate:void 0!==t.matrixWorldNeedsUpdate&&(u=this.Versioning.MatrixWorldNeedsUpdate);var l=this.BindingType.Direct;if(void 0!==o){if("morphTargetInfluences"===i){if(!t.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!t.geometry.isBufferGeometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences on THREE.Geometry. Use THREE.BufferGeometry instead.",this);if(!t.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==t.morphTargetDictionary[o]&&(o=t.morphTargetDictionary[o])}l=this.BindingType.ArrayElement,this.resolvedProperty=c,this.propertyIndex=o}else void 0!==c.fromArray&&void 0!==c.toArray?(l=this.BindingType.HasFromToArray,this.resolvedProperty=c):Array.isArray(c)?(l=this.BindingType.EntireArray,this.resolvedProperty=c):this.propertyName=i;this.getValue=this.GetterByBindingType[l],this.setValue=this.SetterByBindingTypeAndVersioning[l][u]}else{var d=n.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+d+"."+i+" but it wasn't found.",t)}}else console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.")},t.unbind=function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound},e}();sl.Composite=al,sl.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},sl.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},sl.prototype.GetterByBindingType=[sl.prototype._getValue_direct,sl.prototype._getValue_array,sl.prototype._getValue_arrayElement,sl.prototype._getValue_toArray],sl.prototype.SetterByBindingTypeAndVersioning=[[sl.prototype._setValue_direct,sl.prototype._setValue_direct_setNeedsUpdate,sl.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[sl.prototype._setValue_array,sl.prototype._setValue_array_setNeedsUpdate,sl.prototype._setValue_array_setMatrixWorldNeedsUpdate],[sl.prototype._setValue_arrayElement,sl.prototype._setValue_arrayElement_setNeedsUpdate,sl.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[sl.prototype._setValue_fromArray,sl.prototype._setValue_fromArray_setNeedsUpdate,sl.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];var cl=function(){function e(){this.uuid=me(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;var e={};this._indicesByUUID=e;for(var t=0,n=arguments.length;t!==n;++t)e[arguments[t].uuid]=t;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};var r=this;this.stats={objects:{get total(){return r._objects.length},get inUse(){return this.total-r.nCachedObjects_}},get bindingsPerObject(){return r._bindings.length}}}var t=e.prototype;return t.add=function(){for(var e=this._objects,t=this._indicesByUUID,n=this._paths,r=this._parsedPaths,i=this._bindings,o=i.length,a=void 0,s=e.length,c=this.nCachedObjects_,u=0,l=arguments.length;u!==l;++u){var d=arguments[u],h=d.uuid,f=t[h];if(void 0===f){f=s++,t[h]=f,e.push(d);for(var p=0,A=o;p!==A;++p)i[p].push(new sl(d,n[p],r[p]))}else if(f<c){a=e[f];var g=--c,v=e[g];t[v.uuid]=f,e[f]=v,t[h]=g,e[g]=d;for(var m=0,y=o;m!==y;++m){var b=i[m],E=b[g],_=b[f];b[f]=E,void 0===_&&(_=new sl(d,n[m],r[m])),b[g]=_}}else e[f]!==a&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=c},t.remove=function(){for(var e=this._objects,t=this._indicesByUUID,n=this._bindings,r=n.length,i=this.nCachedObjects_,o=0,a=arguments.length;o!==a;++o){var s=arguments[o],c=s.uuid,u=t[c];if(void 0!==u&&u>=i){var l=i++,d=e[l];t[d.uuid]=u,e[u]=d,t[c]=l,e[l]=s;for(var h=0,f=r;h!==f;++h){var p=n[h],A=p[l],g=p[u];p[u]=A,p[l]=g}}}this.nCachedObjects_=i},t.uncache=function(){for(var e=this._objects,t=this._indicesByUUID,n=this._bindings,r=n.length,i=this.nCachedObjects_,o=e.length,a=0,s=arguments.length;a!==s;++a){var c=arguments[a],u=c.uuid,l=t[u];if(void 0!==l)if(delete t[u],l<i){var d=--i,h=e[d],f=--o,p=e[f];t[h.uuid]=l,e[l]=h,t[p.uuid]=d,e[d]=p,e.pop();for(var A=0,g=r;A!==g;++A){var v=n[A],m=v[d],y=v[f];v[l]=m,v[d]=y,v.pop()}}else{var b=--o,E=e[b];b>0&&(t[E.uuid]=l),e[l]=E,e.pop();for(var _=0,w=r;_!==w;++_){var S=n[_];S[l]=S[b],S.pop()}}}this.nCachedObjects_=i},t.subscribe_=function(e,t){var n=this._bindingsIndicesByPath,r=n[e],i=this._bindings;if(void 0!==r)return i[r];var o=this._paths,a=this._parsedPaths,s=this._objects,c=s.length,u=this.nCachedObjects_,l=new Array(c);r=i.length,n[e]=r,o.push(e),a.push(t),i.push(l);for(var d=u,h=s.length;d!==h;++d){var f=s[d];l[d]=new sl(f,e,t)}return l},t.unsubscribe_=function(e){var t=this._bindingsIndicesByPath,n=t[e];if(void 0!==n){var r=this._paths,i=this._parsedPaths,o=this._bindings,a=o.length-1,s=o[a];t[e[a]]=n,o[n]=s,o.pop(),i[n]=i[a],i.pop(),r[n]=r[a],r.pop()}},e}();cl.prototype.isAnimationObjectGroup=!0;var ul=function(){function e(e,t,n,r){void 0===n&&(n=null),void 0===r&&(r=t.blendMode),this._mixer=e,this._clip=t,this._localRoot=n,this.blendMode=r;for(var i=t.tracks,o=i.length,a=new Array(o),s={endingStart:J,endingEnd:J},c=0;c!==o;++c){var u=i[c].createInterpolant(null);a[c]=u,u.settings=s}this._interpolantSettings=s,this._interpolants=a,this._propertyBindings=new Array(o),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=2201,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}var t=e.prototype;return t.play=function(){return this._mixer._activateAction(this),this},t.stop=function(){return this._mixer._deactivateAction(this),this.reset()},t.reset=function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()},t.isRunning=function(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)},t.isScheduled=function(){return this._mixer._isActiveAction(this)},t.startAt=function(e){return this._startTime=e,this},t.setLoop=function(e,t){return this.loop=e,this.repetitions=t,this},t.setEffectiveWeight=function(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()},t.getEffectiveWeight=function(){return this._effectiveWeight},t.fadeIn=function(e){return this._scheduleFading(e,0,1)},t.fadeOut=function(e){return this._scheduleFading(e,1,0)},t.crossFadeFrom=function(e,t,n){if(e.fadeOut(t),this.fadeIn(t),n){var r=this._clip.duration,i=e._clip.duration,o=i/r,a=r/i;e.warp(1,o,t),this.warp(a,1,t)}return this},t.crossFadeTo=function(e,t,n){return e.crossFadeFrom(this,t,n)},t.stopFading=function(){var e=this._weightInterpolant;return null!==e&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this},t.setEffectiveTimeScale=function(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()},t.getEffectiveTimeScale=function(){return this._effectiveTimeScale},t.setDuration=function(e){return this.timeScale=this._clip.duration/e,this.stopWarping()},t.syncWith=function(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()},t.halt=function(e){return this.warp(this._effectiveTimeScale,0,e)},t.warp=function(e,t,n){var r=this._mixer,i=r.time,o=this.timeScale,a=this._timeScaleInterpolant;null===a&&(a=r._lendControlInterpolant(),this._timeScaleInterpolant=a);var s=a.parameterPositions,c=a.sampleValues;return s[0]=i,s[1]=i+n,c[0]=e/o,c[1]=t/o,this},t.stopWarping=function(){var e=this._timeScaleInterpolant;return null!==e&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this},t.getMixer=function(){return this._mixer},t.getClip=function(){return this._clip},t.getRoot=function(){return this._localRoot||this._mixer._root},t._update=function(e,t,n,r){if(this.enabled){var i=this._startTime;if(null!==i){var o=(e-i)*n;if(o<0||0===n)return;this._startTime=null,t=n*o}t*=this._updateTimeScale(e);var a=this._updateTime(t),s=this._updateWeight(e);if(s>0){var c=this._interpolants,u=this._propertyBindings;switch(this.blendMode){case ee:for(var l=0,d=c.length;l!==d;++l)c[l].evaluate(a),u[l].accumulateAdditive(s);break;case $:default:for(var h=0,f=c.length;h!==f;++h)c[h].evaluate(a),u[h].accumulate(r,s)}}}else this._updateWeight(e)},t._updateWeight=function(e){var t=0;if(this.enabled){t=this.weight;var n=this._weightInterpolant;if(null!==n){var r=n.evaluate(e)[0];t*=r,e>n.parameterPositions[1]&&(this.stopFading(),0===r&&(this.enabled=!1))}}return this._effectiveWeight=t,t},t._updateTimeScale=function(e){var t=0;if(!this.paused){t=this.timeScale;var n=this._timeScaleInterpolant;if(null!==n)t*=n.evaluate(e)[0],e>n.parameterPositions[1]&&(this.stopWarping(),0===t?this.paused=!0:this.timeScale=t)}return this._effectiveTimeScale=t,t},t._updateTime=function(e){var t=this._clip.duration,n=this.loop,r=this.time+e,i=this._loopCount,o=2202===n;if(0===e)return-1===i?r:o&&1==(1&i)?t-r:r;if(2200===n){-1===i&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(r>=t)r=t;else{if(!(r<0)){this.time=r;break e}r=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(-1===i&&(e>=0?(i=0,this._setEndings(!0,0===this.repetitions,o)):this._setEndings(0===this.repetitions,!0,o)),r>=t||r<0){var a=Math.floor(r/t);r-=t*a,i+=Math.abs(a);var s=this.repetitions-i;if(s<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,r=e>0?t:0,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(1===s){var c=e<0;this._setEndings(c,!c,o)}else this._setEndings(!1,!1,o);this._loopCount=i,this.time=r,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:a})}}else this.time=r;if(o&&1==(1&i))return t-r}return r},t._setEndings=function(e,t,n){var r=this._interpolantSettings;n?(r.endingStart=Y,r.endingEnd=Y):(r.endingStart=e?this.zeroSlopeAtStart?Y:J:Z,r.endingEnd=t?this.zeroSlopeAtEnd?Y:J:Z)},t._scheduleFading=function(e,t,n){var r=this._mixer,i=r.time,o=this._weightInterpolant;null===o&&(o=r._lendControlInterpolant(),this._weightInterpolant=o);var a=o.parameterPositions,s=o.sampleValues;return a[0]=i,s[0]=t,a[1]=i+e,s[1]=n,this},e}(),ll=function(e){function t(t){var n;return(n=e.call(this)||this)._root=t,n._initMemoryManager(),n._accuIndex=0,n.time=0,n.timeScale=1,n}i(t,e);var n=t.prototype;return n._bindAction=function(e,t){var n=e._localRoot||this._root,r=e._clip.tracks,i=r.length,o=e._propertyBindings,a=e._interpolants,s=n.uuid,c=this._bindingsByRootAndName,u=c[s];void 0===u&&(u={},c[s]=u);for(var l=0;l!==i;++l){var d=r[l],h=d.name,f=u[h];if(void 0!==f)o[l]=f;else{if(void 0!==(f=o[l])){null===f._cacheIndex&&(++f.referenceCount,this._addInactiveBinding(f,s,h));continue}var p=t&&t._propertyBindings[l].binding.parsedPath;++(f=new Xu(sl.create(n,h,p),d.ValueTypeName,d.getValueSize())).referenceCount,this._addInactiveBinding(f,s,h),o[l]=f}a[l].resultBuffer=f.buffer}},n._activateAction=function(e){if(!this._isActiveAction(e)){if(null===e._cacheIndex){var t=(e._localRoot||this._root).uuid,n=e._clip.uuid,r=this._actionsByClip[n];this._bindAction(e,r&&r.knownActions[0]),this._addInactiveAction(e,n,t)}for(var i=e._propertyBindings,o=0,a=i.length;o!==a;++o){var s=i[o];0==s.useCount++&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(e)}},n._deactivateAction=function(e){if(this._isActiveAction(e)){for(var t=e._propertyBindings,n=0,r=t.length;n!==r;++n){var i=t[n];0==--i.useCount&&(i.restoreOriginalState(),this._takeBackBinding(i))}this._takeBackAction(e)}},n._initMemoryManager=function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;var e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}},n._isActiveAction=function(e){var t=e._cacheIndex;return null!==t&&t<this._nActiveActions},n._addInactiveAction=function(e,t,n){var r=this._actions,i=this._actionsByClip,o=i[t];if(void 0===o)o={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,i[t]=o;else{var a=o.knownActions;e._byClipCacheIndex=a.length,a.push(e)}e._cacheIndex=r.length,r.push(e),o.actionByRoot[n]=e},n._removeInactiveAction=function(e){var t=this._actions,n=t[t.length-1],r=e._cacheIndex;n._cacheIndex=r,t[r]=n,t.pop(),e._cacheIndex=null;var i=e._clip.uuid,o=this._actionsByClip,a=o[i],s=a.knownActions,c=s[s.length-1],u=e._byClipCacheIndex;c._byClipCacheIndex=u,s[u]=c,s.pop(),e._byClipCacheIndex=null,delete a.actionByRoot[(e._localRoot||this._root).uuid],0===s.length&&delete o[i],this._removeInactiveBindingsForAction(e)},n._removeInactiveBindingsForAction=function(e){for(var t=e._propertyBindings,n=0,r=t.length;n!==r;++n){var i=t[n];0==--i.referenceCount&&this._removeInactiveBinding(i)}},n._lendAction=function(e){var t=this._actions,n=e._cacheIndex,r=this._nActiveActions++,i=t[r];e._cacheIndex=r,t[r]=e,i._cacheIndex=n,t[n]=i},n._takeBackAction=function(e){var t=this._actions,n=e._cacheIndex,r=--this._nActiveActions,i=t[r];e._cacheIndex=r,t[r]=e,i._cacheIndex=n,t[n]=i},n._addInactiveBinding=function(e,t,n){var r=this._bindingsByRootAndName,i=this._bindings,o=r[t];void 0===o&&(o={},r[t]=o),o[n]=e,e._cacheIndex=i.length,i.push(e)},n._removeInactiveBinding=function(e){var t=this._bindings,n=e.binding,r=n.rootNode.uuid,i=n.path,o=this._bindingsByRootAndName,a=o[r],s=t[t.length-1],c=e._cacheIndex;s._cacheIndex=c,t[c]=s,t.pop(),delete a[i],0===Object.keys(a).length&&delete o[r]},n._lendBinding=function(e){var t=this._bindings,n=e._cacheIndex,r=this._nActiveBindings++,i=t[r];e._cacheIndex=r,t[r]=e,i._cacheIndex=n,t[n]=i},n._takeBackBinding=function(e){var t=this._bindings,n=e._cacheIndex,r=--this._nActiveBindings,i=t[r];e._cacheIndex=r,t[r]=e,i._cacheIndex=n,t[n]=i},n._lendControlInterpolant=function(){var e=this._controlInterpolants,t=this._nActiveControlInterpolants++,n=e[t];return void 0===n&&((n=new ec(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer)).__cacheIndex=t,e[t]=n),n},n._takeBackControlInterpolant=function(e){var t=this._controlInterpolants,n=e.__cacheIndex,r=--this._nActiveControlInterpolants,i=t[r];e.__cacheIndex=r,t[r]=e,i.__cacheIndex=n,t[n]=i},n.clipAction=function(e,t,n){var r=t||this._root,i=r.uuid,o="string"==typeof e?lc.findByName(r,e):e,a=null!==o?o.uuid:e,s=this._actionsByClip[a],c=null;if(void 0===n&&(n=null!==o?o.blendMode:$),void 0!==s){var u=s.actionByRoot[i];if(void 0!==u&&u.blendMode===n)return u;c=s.knownActions[0],null===o&&(o=c._clip)}if(null===o)return null;var l=new ul(this,o,t,n);return this._bindAction(l,c),this._addInactiveAction(l,a,i),l},n.existingAction=function(e,t){var n=t||this._root,r=n.uuid,i="string"==typeof e?lc.findByName(n,e):e,o=i?i.uuid:e,a=this._actionsByClip[o];return void 0!==a&&a.actionByRoot[r]||null},n.stopAllAction=function(){for(var e=this._actions,t=this._nActiveActions-1;t>=0;--t)e[t].stop();return this},n.update=function(e){e*=this.timeScale;for(var t=this._actions,n=this._nActiveActions,r=this.time+=e,i=Math.sign(e),o=this._accuIndex^=1,a=0;a!==n;++a){t[a]._update(r,e,i,o)}for(var s=this._bindings,c=this._nActiveBindings,u=0;u!==c;++u)s[u].apply(o);return this},n.setTime=function(e){this.time=0;for(var t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)},n.getRoot=function(){return this._root},n.uncacheClip=function(e){var t=this._actions,n=e.uuid,r=this._actionsByClip,i=r[n];if(void 0!==i){for(var o=i.knownActions,a=0,s=o.length;a!==s;++a){var c=o[a];this._deactivateAction(c);var u=c._cacheIndex,l=t[t.length-1];c._cacheIndex=null,c._byClipCacheIndex=null,l._cacheIndex=u,t[u]=l,t.pop(),this._removeInactiveBindingsForAction(c)}delete r[n]}},n.uncacheRoot=function(e){var t=e.uuid,n=this._actionsByClip;for(var r in n){var i=n[r].actionByRoot[t];void 0!==i&&(this._deactivateAction(i),this._removeInactiveAction(i))}var o=this._bindingsByRootAndName[t];if(void 0!==o)for(var a in o){var s=o[a];s.restoreOriginalState(),this._removeInactiveBinding(s)}},n.uncacheAction=function(e,t){var n=this.existingAction(e,t);null!==n&&(this._deactivateAction(n),this._removeInactiveAction(n))},t}(he);ll.prototype._controlInterpolantsResultBuffer=new Float32Array(1);var dl=function(){function e(e){"string"==typeof e&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),e=arguments[1]),this.value=e}return e.prototype.clone=function(){return new e(void 0===this.value.clone?this.value:this.value.clone())},e}(),hl=function(e){function t(t,n,r){var i;return void 0===r&&(r=1),(i=e.call(this,t,n)||this).meshPerAttribute=r||1,i}i(t,e);var n=t.prototype;return n.copy=function(t){return e.prototype.copy.call(this,t),this.meshPerAttribute=t.meshPerAttribute,this},n.clone=function(t){var n=e.prototype.clone.call(this,t);return n.meshPerAttribute=this.meshPerAttribute,n},n.toJSON=function(t){var n=e.prototype.toJSON.call(this,t);return n.isInstancedInterleavedBuffer=!0,n.meshPerAttribute=this.meshPerAttribute,n},t}(ko);hl.prototype.isInstancedInterleavedBuffer=!0;var fl=function(){function e(e,t,n,r,i){this.buffer=e,this.type=t,this.itemSize=n,this.elementSize=r,this.count=i,this.version=0}var t=e.prototype;return t.setBuffer=function(e){return this.buffer=e,this},t.setType=function(e,t){return this.type=e,this.elementSize=t,this},t.setItemSize=function(e){return this.itemSize=e,this},t.setCount=function(e){return this.count=e,this},r(e,[{key:"needsUpdate",set:function(e){!0===e&&this.version++}}]),e}();fl.prototype.isGLBufferAttribute=!0;var pl=function(){function e(e,t,n,r){void 0===n&&(n=0),void 0===r&&(r=1/0),this.ray=new ft(e,t),this.near=n,this.far=r,this.camera=null,this.layers=new Tt,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}var t=e.prototype;return t.set=function(e,t){this.ray.set(e,t)},t.setFromCamera=function(e,t){t&&t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t&&t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)},t.intersectObject=function(e,t,n){return void 0===t&&(t=!1),void 0===n&&(n=[]),gl(e,this,n,t),n.sort(Al),n},t.intersectObjects=function(e,t,n){void 0===t&&(t=!1),void 0===n&&(n=[]);for(var r=0,i=e.length;r<i;r++)gl(e[r],this,n,t);return n.sort(Al),n},e}();function Al(e,t){return e.distance-t.distance}function gl(e,t,n,r){if(e.layers.test(t.layers)&&e.raycast(t,n),!0===r)for(var i=e.children,o=0,a=i.length;o<a;o++)gl(i[o],t,n,!0)}var vl=function(){function e(e,t,n){return void 0===e&&(e=1),void 0===t&&(t=0),void 0===n&&(n=0),this.radius=e,this.phi=t,this.theta=n,this}var t=e.prototype;return t.set=function(e,t,n){return this.radius=e,this.phi=t,this.theta=n,this},t.copy=function(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this},t.makeSafe=function(){var e=1e-6;return this.phi=Math.max(e,Math.min(Math.PI-e,this.phi)),this},t.setFromVector3=function(e){return this.setFromCartesianCoords(e.x,e.y,e.z)},t.setFromCartesianCoords=function(e,t,n){return this.radius=Math.sqrt(e*e+t*t+n*n),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,n),this.phi=Math.acos(ye(t/this.radius,-1,1))),this},t.clone=function(){return(new this.constructor).copy(this)},e}(),ml=function(){function e(e,t,n){return void 0===e&&(e=1),void 0===t&&(t=0),void 0===n&&(n=0),this.radius=e,this.theta=t,this.y=n,this}var t=e.prototype;return t.set=function(e,t,n){return this.radius=e,this.theta=t,this.y=n,this},t.copy=function(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this},t.setFromVector3=function(e){return this.setFromCartesianCoords(e.x,e.y,e.z)},t.setFromCartesianCoords=function(e,t,n){return this.radius=Math.sqrt(e*e+n*n),this.theta=Math.atan2(e,n),this.y=t,this},t.clone=function(){return(new this.constructor).copy(this)},e}(),yl=new Re,bl=function(){function e(e,t){void 0===e&&(e=new Re(1/0,1/0)),void 0===t&&(t=new Re(-1/0,-1/0)),this.min=e,this.max=t}var t=e.prototype;return t.set=function(e,t){return this.min.copy(e),this.max.copy(t),this},t.setFromPoints=function(e){this.makeEmpty();for(var t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this},t.setFromCenterAndSize=function(e,t){var n=yl.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this},t.clone=function(){return(new this.constructor).copy(this)},t.copy=function(e){return this.min.copy(e.min),this.max.copy(e.max),this},t.makeEmpty=function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this},t.isEmpty=function(){return this.max.x<this.min.x||this.max.y<this.min.y},t.getCenter=function(e){return void 0===e&&(console.warn("THREE.Box2: .getCenter() target is now required"),e=new Re),this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)},t.getSize=function(e){return void 0===e&&(console.warn("THREE.Box2: .getSize() target is now required"),e=new Re),this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)},t.expandByPoint=function(e){return this.min.min(e),this.max.max(e),this},t.expandByVector=function(e){return this.min.sub(e),this.max.add(e),this},t.expandByScalar=function(e){return this.min.addScalar(-e),this.max.addScalar(e),this},t.containsPoint=function(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)},t.containsBox=function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y},t.getParameter=function(e,t){return void 0===t&&(console.warn("THREE.Box2: .getParameter() target is now required"),t=new Re),t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))},t.intersectsBox=function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)},t.clampPoint=function(e,t){return void 0===t&&(console.warn("THREE.Box2: .clampPoint() target is now required"),t=new Re),t.copy(e).clamp(this.min,this.max)},t.distanceToPoint=function(e){return yl.copy(e).clamp(this.min,this.max).sub(e).length()},t.intersect=function(e){return this.min.max(e.min),this.max.min(e.max),this},t.union=function(e){return this.min.min(e.min),this.max.max(e.max),this},t.translate=function(e){return this.min.add(e),this.max.add(e),this},t.equals=function(e){return e.min.equals(this.min)&&e.max.equals(this.max)},e}();bl.prototype.isBox2=!0;var El=new De,_l=new De,wl=function(){function e(e,t){void 0===e&&(e=new De),void 0===t&&(t=new De),this.start=e,this.end=t}var t=e.prototype;return t.set=function(e,t){return this.start.copy(e),this.end.copy(t),this},t.copy=function(e){return this.start.copy(e.start),this.end.copy(e.end),this},t.getCenter=function(e){return void 0===e&&(console.warn("THREE.Line3: .getCenter() target is now required"),e=new De),e.addVectors(this.start,this.end).multiplyScalar(.5)},t.delta=function(e){return void 0===e&&(console.warn("THREE.Line3: .delta() target is now required"),e=new De),e.subVectors(this.end,this.start)},t.distanceSq=function(){return this.start.distanceToSquared(this.end)},t.distance=function(){return this.start.distanceTo(this.end)},t.at=function(e,t){return void 0===t&&(console.warn("THREE.Line3: .at() target is now required"),t=new De),this.delta(t).multiplyScalar(e).add(this.start)},t.closestPointToPointParameter=function(e,t){El.subVectors(e,this.start),_l.subVectors(this.end,this.start);var n=_l.dot(_l),r=_l.dot(El)/n;return t&&(r=ye(r,0,1)),r},t.closestPointToPoint=function(e,t,n){var r=this.closestPointToPointParameter(e,t);return void 0===n&&(console.warn("THREE.Line3: .closestPointToPoint() target is now required"),n=new De),this.delta(n).multiplyScalar(r).add(this.start)},t.applyMatrix4=function(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this},t.equals=function(e){return e.start.equals(this.start)&&e.end.equals(this.end)},t.clone=function(){return(new this.constructor).copy(this)},e}(),Sl=function(e){function t(t){var n;return(n=e.call(this)||this).material=t,n.render=function(){},n.hasPositions=!1,n.hasNormals=!1,n.hasColors=!1,n.hasUvs=!1,n.positionArray=null,n.normalArray=null,n.colorArray=null,n.uvArray=null,n.count=0,n}return i(t,e),t}(Ft);Sl.prototype.isImmediateRenderObject=!0;var Tl=new De,Rl=function(e){function t(t,n){var r;(r=e.call(this)||this).light=t,r.light.updateMatrixWorld(),r.matrix=t.matrixWorld,r.matrixAutoUpdate=!1,r.color=n;for(var i=new kn,o=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1],a=0,s=1;a<32;a++,s++){var c=a/32*Math.PI*2,u=s/32*Math.PI*2;o.push(Math.cos(c),Math.sin(c),1,Math.cos(u),Math.sin(u),1)}i.setAttribute("position",new wn(o,3));var l=new ma({fog:!1,toneMapped:!1});return r.cone=new Ca(i,l),r.add(r.cone),r.update(),r}i(t,e);var n=t.prototype;return n.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()},n.update=function(){this.light.updateMatrixWorld();var e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),Tl.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(Tl),void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)},t}(Ft),Cl=new De,Il=new pt,xl=new pt,Ol=function(e){function t(t){for(var n,r=Nl(t),i=new kn,o=[],a=[],s=new ln(0,0,1),c=new ln(0,1,0),u=0;u<r.length;u++){var l=r[u];l.parent&&l.parent.isBone&&(o.push(0,0,0),o.push(0,0,0),a.push(s.r,s.g,s.b),a.push(c.r,c.g,c.b))}i.setAttribute("position",new wn(o,3)),i.setAttribute("color",new wn(a,3));var d=new ma({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});return(n=e.call(this,i,d)||this).type="SkeletonHelper",n.isSkeletonHelper=!0,n.root=t,n.bones=r,n.matrix=t.matrixWorld,n.matrixAutoUpdate=!1,n}return i(t,e),t.prototype.updateMatrixWorld=function(t){var n=this.bones,r=this.geometry,i=r.getAttribute("position");xl.copy(this.root.matrixWorld).invert();for(var o=0,a=0;o<n.length;o++){var s=n[o];s.parent&&s.parent.isBone&&(Il.multiplyMatrices(xl,s.matrixWorld),Cl.setFromMatrixPosition(Il),i.setXYZ(a,Cl.x,Cl.y,Cl.z),Il.multiplyMatrices(xl,s.parent.matrixWorld),Cl.setFromMatrixPosition(Il),i.setXYZ(a+1,Cl.x,Cl.y,Cl.z),a+=2)}r.getAttribute("position").needsUpdate=!0,e.prototype.updateMatrixWorld.call(this,t)},t}(Ca);function Nl(e){var t=[];e&&e.isBone&&t.push(e);for(var n=0;n<e.children.length;n++)t.push.apply(t,Nl(e.children[n]));return t}var Bl=function(e){function t(t,n,r){var i,o=new Bs(n,4,2),a=new dn({wireframe:!0,fog:!1,toneMapped:!1});return(i=e.call(this,o,a)||this).light=t,i.light.updateMatrixWorld(),i.color=r,i.type="PointLightHelper",i.matrix=i.light.matrixWorld,i.matrixAutoUpdate=!1,i.update(),i}i(t,e);var n=t.prototype;return n.dispose=function(){this.geometry.dispose(),this.material.dispose()},n.update=function(){void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)},t}($n),Ml=new De,Ll=new ln,kl=new ln,Ul=function(e){function t(t,n,r){var i;(i=e.call(this)||this).light=t,i.light.updateMatrixWorld(),i.matrix=t.matrixWorld,i.matrixAutoUpdate=!1,i.color=r;var o=new Is(n);o.rotateY(.5*Math.PI),i.material=new dn({wireframe:!0,fog:!1,toneMapped:!1}),void 0===i.color&&(i.material.vertexColors=!0);var a=o.getAttribute("position"),s=new Float32Array(3*a.count);return o.setAttribute("color",new pn(s,3)),i.add(new $n(o,i.material)),i.update(),i}i(t,e);var n=t.prototype;return n.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},n.update=function(){var e=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{var t=e.geometry.getAttribute("color");Ll.copy(this.light.color),kl.copy(this.light.groundColor);for(var n=0,r=t.count;n<r;n++){var i=n<r/2?Ll:kl;t.setXYZ(n,i.r,i.g,i.b)}t.needsUpdate=!0}e.lookAt(Ml.setFromMatrixPosition(this.light.matrixWorld).negate())},t}(Ft),Dl=function(e){function t(t,n,r,i){var o;void 0===t&&(t=10),void 0===n&&(n=10),void 0===r&&(r=4473924),void 0===i&&(i=8947848),r=new ln(r),i=new ln(i);for(var a=n/2,s=t/n,c=t/2,u=[],l=[],d=0,h=0,f=-c;d<=n;d++,f+=s){u.push(-c,0,f,c,0,f),u.push(f,0,-c,f,0,c);var p=d===a?r:i;p.toArray(l,h),h+=3,p.toArray(l,h),h+=3,p.toArray(l,h),h+=3,p.toArray(l,h),h+=3}var A=new kn;A.setAttribute("position",new wn(u,3)),A.setAttribute("color",new wn(l,3));var g=new ma({vertexColors:!0,toneMapped:!1});return(o=e.call(this,A,g)||this).type="GridHelper",o}return i(t,e),t}(Ca),Pl=function(e){function t(t,n,r,i,o,a){var s;void 0===t&&(t=10),void 0===n&&(n=16),void 0===r&&(r=8),void 0===i&&(i=64),void 0===o&&(o=4473924),void 0===a&&(a=8947848),o=new ln(o),a=new ln(a);for(var c=[],u=[],l=0;l<=n;l++){var d=l/n*(2*Math.PI),h=Math.sin(d)*t,f=Math.cos(d)*t;c.push(0,0,0),c.push(h,0,f);var p=1&l?o:a;u.push(p.r,p.g,p.b),u.push(p.r,p.g,p.b)}for(var A=0;A<=r;A++)for(var g=1&A?o:a,v=t-t/r*A,m=0;m<i;m++){var y=m/i*(2*Math.PI),b=Math.sin(y)*v,E=Math.cos(y)*v;c.push(b,0,E),u.push(g.r,g.g,g.b),y=(m+1)/i*(2*Math.PI),b=Math.sin(y)*v,E=Math.cos(y)*v,c.push(b,0,E),u.push(g.r,g.g,g.b)}var _=new kn;_.setAttribute("position",new wn(c,3)),_.setAttribute("color",new wn(u,3));var w=new ma({vertexColors:!0,toneMapped:!1});return(s=e.call(this,_,w)||this).type="PolarGridHelper",s}return i(t,e),t}(Ca),Fl=new De,Hl=new De,jl=new De,Vl=function(e){function t(t,n,r){var i;(i=e.call(this)||this).light=t,i.light.updateMatrixWorld(),i.matrix=t.matrixWorld,i.matrixAutoUpdate=!1,i.color=r,void 0===n&&(n=1);var o=new kn;o.setAttribute("position",new wn([-n,n,0,n,n,0,n,-n,0,-n,-n,0,-n,n,0],3));var a=new ma({fog:!1,toneMapped:!1});return i.lightPlane=new Sa(o,a),i.add(i.lightPlane),(o=new kn).setAttribute("position",new wn([0,0,0,0,0,1],3)),i.targetLine=new Sa(o,a),i.add(i.targetLine),i.update(),i}i(t,e);var n=t.prototype;return n.dispose=function(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()},n.update=function(){Fl.setFromMatrixPosition(this.light.matrixWorld),Hl.setFromMatrixPosition(this.light.target.matrixWorld),jl.subVectors(Hl,Fl),this.lightPlane.lookAt(Hl),void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(Hl),this.targetLine.scale.z=jl.length()},t}(Ft),Ql=new De,Gl=new ar,zl=function(e){function t(t){var n,r=new kn,i=new ma({color:16777215,vertexColors:!0,toneMapped:!1}),o=[],a=[],s={},c=new ln(16755200),u=new ln(16711680),l=new ln(43775),d=new ln(16777215),h=new ln(3355443);function f(e,t,n){p(e,n),p(t,n)}function p(e,t){o.push(0,0,0),a.push(t.r,t.g,t.b),void 0===s[e]&&(s[e]=[]),s[e].push(o.length/3-1)}return f("n1","n2",c),f("n2","n4",c),f("n4","n3",c),f("n3","n1",c),f("f1","f2",c),f("f2","f4",c),f("f4","f3",c),f("f3","f1",c),f("n1","f1",c),f("n2","f2",c),f("n3","f3",c),f("n4","f4",c),f("p","n1",u),f("p","n2",u),f("p","n3",u),f("p","n4",u),f("u1","u2",l),f("u2","u3",l),f("u3","u1",l),f("c","t",d),f("p","c",h),f("cn1","cn2",h),f("cn3","cn4",h),f("cf1","cf2",h),f("cf3","cf4",h),r.setAttribute("position",new wn(o,3)),r.setAttribute("color",new wn(a,3)),(n=e.call(this,r,i)||this).type="CameraHelper",n.camera=t,n.camera.updateProjectionMatrix&&n.camera.updateProjectionMatrix(),n.matrix=t.matrixWorld,n.matrixAutoUpdate=!1,n.pointMap=s,n.update(),n}i(t,e);var n=t.prototype;return n.update=function(){var e=this.geometry,t=this.pointMap;Gl.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),Kl("c",t,e,Gl,0,0,-1),Kl("t",t,e,Gl,0,0,1),Kl("n1",t,e,Gl,-1,-1,-1),Kl("n2",t,e,Gl,1,-1,-1),Kl("n3",t,e,Gl,-1,1,-1),Kl("n4",t,e,Gl,1,1,-1),Kl("f1",t,e,Gl,-1,-1,1),Kl("f2",t,e,Gl,1,-1,1),Kl("f3",t,e,Gl,-1,1,1),Kl("f4",t,e,Gl,1,1,1),Kl("u1",t,e,Gl,.7,1.1,-1),Kl("u2",t,e,Gl,-.7,1.1,-1),Kl("u3",t,e,Gl,0,2,-1),Kl("cf1",t,e,Gl,-1,0,1),Kl("cf2",t,e,Gl,1,0,1),Kl("cf3",t,e,Gl,0,-1,1),Kl("cf4",t,e,Gl,0,1,1),Kl("cn1",t,e,Gl,-1,0,-1),Kl("cn2",t,e,Gl,1,0,-1),Kl("cn3",t,e,Gl,0,-1,-1),Kl("cn4",t,e,Gl,0,1,-1),e.getAttribute("position").needsUpdate=!0},n.dispose=function(){this.geometry.dispose(),this.material.dispose()},t}(Ca);function Kl(e,t,n,r,i,o,a){Ql.set(i,o,a).unproject(r);var s=t[e];if(void 0!==s)for(var c=n.getAttribute("position"),u=0,l=s.length;u<l;u++)c.setXYZ(s[u],Ql.x,Ql.y,Ql.z)}var ql,Wl,Xl=new He,Jl=function(e){function t(t,n){var r;void 0===n&&(n=16776960);var i=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),o=new Float32Array(24),a=new kn;return a.setIndex(new pn(i,1)),a.setAttribute("position",new pn(o,3)),(r=e.call(this,a,new ma({color:n,toneMapped:!1}))||this).object=t,r.type="BoxHelper",r.matrixAutoUpdate=!1,r.update(),r}i(t,e);var n=t.prototype;return n.update=function(e){if(void 0!==e&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),void 0!==this.object&&Xl.setFromObject(this.object),!Xl.isEmpty()){var t=Xl.min,n=Xl.max,r=this.geometry.attributes.position,i=r.array;i[0]=n.x,i[1]=n.y,i[2]=n.z,i[3]=t.x,i[4]=n.y,i[5]=n.z,i[6]=t.x,i[7]=t.y,i[8]=n.z,i[9]=n.x,i[10]=t.y,i[11]=n.z,i[12]=n.x,i[13]=n.y,i[14]=t.z,i[15]=t.x,i[16]=n.y,i[17]=t.z,i[18]=t.x,i[19]=t.y,i[20]=t.z,i[21]=n.x,i[22]=t.y,i[23]=t.z,r.needsUpdate=!0,this.geometry.computeBoundingSphere()}},n.setFromObject=function(e){return this.object=e,this.update(),this},n.copy=function(e){return Ca.prototype.copy.call(this,e),this.object=e.object,this},t}(Ca),Yl=function(e){function t(t,n){var r;void 0===n&&(n=16776960);var i=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),o=new kn;return o.setIndex(new pn(i,1)),o.setAttribute("position",new wn([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),(r=e.call(this,o,new ma({color:n,toneMapped:!1}))||this).box=t,r.type="Box3Helper",r.geometry.computeBoundingSphere(),r}return i(t,e),t.prototype.updateMatrixWorld=function(t){var n=this.box;n.isEmpty()||(n.getCenter(this.position),n.getSize(this.scale),this.scale.multiplyScalar(.5),e.prototype.updateMatrixWorld.call(this,t))},t}(Ca),Zl=function(e){function t(t,n,r){var i;void 0===n&&(n=1),void 0===r&&(r=16776960);var o=r,a=new kn;a.setAttribute("position",new wn([1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],3)),a.computeBoundingSphere(),(i=e.call(this,a,new ma({color:o,toneMapped:!1}))||this).type="PlaneHelper",i.plane=t,i.size=n;var s=new kn;return s.setAttribute("position",new wn([1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],3)),s.computeBoundingSphere(),i.add(new $n(s,new dn({color:o,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1}))),i}return i(t,e),t.prototype.updateMatrixWorld=function(t){var n=-this.plane.constant;Math.abs(n)<1e-8&&(n=1e-8),this.scale.set(.5*this.size,.5*this.size,n),this.children[0].material.side=n<0?1:0,this.lookAt(this.plane.normal),e.prototype.updateMatrixWorld.call(this,t)},t}(Sa),$l=new De,ed=function(e){function t(t,n,r,i,o,a){var s;return void 0===t&&(t=new De(0,0,1)),void 0===n&&(n=new De(0,0,0)),void 0===r&&(r=1),void 0===i&&(i=16776960),void 0===o&&(o=.2*r),void 0===a&&(a=.2*o),(s=e.call(this)||this).type="ArrowHelper",void 0===ql&&((ql=new kn).setAttribute("position",new wn([0,0,0,0,1,0],3)),(Wl=new ja(0,.5,1,5,1)).translate(0,-.5,0)),s.position.copy(n),s.line=new Sa(ql,new ma({color:i,toneMapped:!1})),s.line.matrixAutoUpdate=!1,s.add(s.line),s.cone=new $n(Wl,new dn({color:i,toneMapped:!1})),s.cone.matrixAutoUpdate=!1,s.add(s.cone),s.setDirection(t),s.setLength(r,o,a),s}i(t,e);var n=t.prototype;return n.setDirection=function(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{$l.set(e.z,0,-e.x).normalize();var t=Math.acos(e.y);this.quaternion.setFromAxisAngle($l,t)}},n.setLength=function(e,t,n){void 0===t&&(t=.2*e),void 0===n&&(n=.2*t),this.line.scale.set(1,Math.max(1e-4,e-t),1),this.line.updateMatrix(),this.cone.scale.set(n,t,n),this.cone.position.y=e,this.cone.updateMatrix()},n.setColor=function(e){this.line.material.color.set(e),this.cone.material.color.set(e)},n.copy=function(t){return e.prototype.copy.call(this,t,!1),this.line.copy(t.line),this.cone.copy(t.cone),this},t}(Ft),td=function(e){function t(t){var n;void 0===t&&(t=1);var r=[0,0,0,t,0,0,0,0,0,0,t,0,0,0,0,0,0,t],i=new kn;i.setAttribute("position",new wn(r,3)),i.setAttribute("color",new wn([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3));var o=new ma({vertexColors:!0,toneMapped:!1});return(n=e.call(this,i,o)||this).type="AxesHelper",n}return i(t,e),t.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()},t}(Ca),nd=new Float32Array(1),rd=new Int32Array(nd.buffer),id=function(){function e(){}return e.toHalfFloat=function(e){nd[0]=e;var t=rd[0],n=t>>16&32768,r=t>>12&2047,i=t>>23&255;return i<103?n:i>142?(n|=31744,n|=(255==i?0:1)&&8388607&t):i<113?n|=((r|=2048)>>114-i)+(r>>113-i&1):(n|=i-112<<10|r>>1,n+=1&r)},e}(),od=Math.pow(2,8),ad=[.125,.215,.35,.446,.526,.582],sd=5+ad.length,cd=20,ud=((c={})[3e3]=0,c[3001]=1,c[3002]=2,c[3004]=3,c[3005]=4,c[3006]=5,c[3007]=6,c),ld=new dn({side:1,depthWrite:!1,depthTest:!1}),dd=new $n(new tr,ld),hd=new au,fd=Td(),pd=fd._lodPlanes,Ad=fd._sizeLods,gd=fd._sigmas,vd=new ln,md=null,yd=(1+Math.sqrt(5))/2,bd=1/yd,Ed=[new De(1,1,1),new De(-1,1,1),new De(1,1,-1),new De(-1,1,-1),new De(0,yd,bd),new De(0,yd,-bd),new De(bd,0,yd),new De(-bd,0,yd),new De(yd,bd,0),new De(-yd,bd,0)];function _d(e){var t=Math.max(e.r,e.g,e.b),n=Math.min(Math.max(Math.ceil(Math.log2(t)),-128),127);return e.multiplyScalar(Math.pow(2,-n)),(n+128)/255}var wd=function(){function e(e){var t,n,r;this._renderer=e,this._pingPongRenderTarget=null,this._blurMaterial=(t=cd,n=new Float32Array(t),r=new De(0,1,0),new js({name:"SphericalGaussianBlur",defines:{n:t},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:n},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r},inputEncoding:{value:ud[3e3]},outputEncoding:{value:ud[3e3]}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute vec3 position;\n\t\tattribute vec2 uv;\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t\n\n\t\tuniform int inputEncoding;\n\t\tuniform int outputEncoding;\n\n\t\t#include <encodings_pars_fragment>\n\n\t\tvec4 inputTexelToLinear( vec4 value ) {\n\n\t\t\tif ( inputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( inputEncoding == 1 ) {\n\n\t\t\t\treturn sRGBToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 2 ) {\n\n\t\t\t\treturn RGBEToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 3 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 7.0 );\n\n\t\t\t} else if ( inputEncoding == 4 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 16.0 );\n\n\t\t\t} else if ( inputEncoding == 5 ) {\n\n\t\t\t\treturn RGBDToLinear( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn GammaToLinear( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 linearToOutputTexel( vec4 value ) {\n\n\t\t\tif ( outputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( outputEncoding == 1 ) {\n\n\t\t\t\treturn LinearTosRGB( value );\n\n\t\t\t} else if ( outputEncoding == 2 ) {\n\n\t\t\t\treturn LinearToRGBE( value );\n\n\t\t\t} else if ( outputEncoding == 3 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 7.0 );\n\n\t\t\t} else if ( outputEncoding == 4 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 16.0 );\n\n\t\t\t} else if ( outputEncoding == 5 ) {\n\n\t\t\t\treturn LinearToRGBD( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn LinearToGamma( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 envMapTexelToLinear( vec4 color ) {\n\n\t\t\treturn inputTexelToLinear( color );\n\n\t\t}\n\t\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t\tgl_FragColor = linearToOutputTexel( gl_FragColor );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})),this._equirectShader=null,this._cubemapShader=null,this._compileMaterial(this._blurMaterial)}var t=e.prototype;return t.fromScene=function(e,t,n,r){void 0===t&&(t=0),void 0===n&&(n=.1),void 0===r&&(r=100),md=this._renderer.getRenderTarget();var i=this._allocateTargets();return this._sceneToCubeUV(e,n,r,i),t>0&&this._blur(i,0,0,t),this._applyPMREM(i),this._cleanup(i),i},t.fromEquirectangular=function(e){return this._fromTexture(e)},t.fromCubemap=function(e){return this._fromTexture(e)},t.compileCubemapShader=function(){null===this._cubemapShader&&(this._cubemapShader=xd(),this._compileMaterial(this._cubemapShader))},t.compileEquirectangularShader=function(){null===this._equirectShader&&(this._equirectShader=Id(),this._compileMaterial(this._equirectShader))},t.dispose=function(){this._blurMaterial.dispose(),null!==this._cubemapShader&&this._cubemapShader.dispose(),null!==this._equirectShader&&this._equirectShader.dispose();for(var e=0;e<pd.length;e++)pd[e].dispose()},t._cleanup=function(e){this._pingPongRenderTarget.dispose(),this._renderer.setRenderTarget(md),e.scissorTest=!1,Cd(e,0,0,e.width,e.height)},t._fromTexture=function(e){md=this._renderer.getRenderTarget();var t=this._allocateTargets(e);return this._textureToCubeUV(e,t),this._applyPMREM(t),this._cleanup(t),t},t._allocateTargets=function(e){var t={magFilter:E,minFilter:E,generateMipmaps:!1,type:C,format:1023,encoding:Sd(e)?e.encoding:ie,depthBuffer:!1},n=Rd(t);return n.depthBuffer=!e,this._pingPongRenderTarget=Rd(t),n},t._compileMaterial=function(e){var t=new $n(pd[0],e);this._renderer.compile(t,hd)},t._sceneToCubeUV=function(e,t,n,r){var i=new sr(90,1,t,n),o=[1,-1,1,1,1,1],a=[1,1,1,-1,-1,-1],s=this._renderer,c=s.autoClear,u=s.outputEncoding,l=s.toneMapping;s.getClearColor(vd),s.toneMapping=0,s.outputEncoding=te,s.autoClear=!1;var d=!1,h=e.background;if(h){if(h.isColor){ld.color.copy(h).convertSRGBToLinear(),e.background=null;var f=_d(ld.color);ld.opacity=f,d=!0}}else{ld.color.copy(vd).convertSRGBToLinear();var p=_d(ld.color);ld.opacity=p,d=!0}for(var A=0;A<6;A++){var g=A%3;0==g?(i.up.set(0,o[A],0),i.lookAt(a[A],0,0)):1==g?(i.up.set(0,0,o[A]),i.lookAt(0,a[A],0)):(i.up.set(0,o[A],0),i.lookAt(0,0,a[A])),Cd(r,g*od,A>2?od:0,od,od),s.setRenderTarget(r),d&&s.render(dd,i),s.render(e,i)}s.toneMapping=l,s.outputEncoding=u,s.autoClear=c},t._textureToCubeUV=function(e,t){var n=this._renderer;e.isCubeTexture?null==this._cubemapShader&&(this._cubemapShader=xd()):null==this._equirectShader&&(this._equirectShader=Id());var r=e.isCubeTexture?this._cubemapShader:this._equirectShader,i=new $n(pd[0],r),o=r.uniforms;o.envMap.value=e,e.isCubeTexture||o.texelSize.value.set(1/e.image.width,1/e.image.height),o.inputEncoding.value=ud[e.encoding],o.outputEncoding.value=ud[t.texture.encoding],Cd(t,0,0,3*od,2*od),n.setRenderTarget(t),n.render(i,hd)},t._applyPMREM=function(e){var t=this._renderer,n=t.autoClear;t.autoClear=!1;for(var r=1;r<sd;r++){var i=Math.sqrt(gd[r]*gd[r]-gd[r-1]*gd[r-1]),o=Ed[(r-1)%Ed.length];this._blur(e,r-1,r,i,o)}t.autoClear=n},t._blur=function(e,t,n,r,i){var o=this._pingPongRenderTarget;this._halfBlur(e,o,t,n,r,"latitudinal",i),this._halfBlur(o,e,n,n,r,"longitudinal",i)},t._halfBlur=function(e,t,n,r,i,o,a){var s=this._renderer,c=this._blurMaterial;"latitudinal"!==o&&"longitudinal"!==o&&console.error("blur direction must be either latitudinal or longitudinal!");var u=new $n(pd[r],c),l=c.uniforms,d=Ad[n]-1,h=isFinite(i)?Math.PI/(2*d):2*Math.PI/39,f=i/h,p=isFinite(i)?1+Math.floor(3*f):cd;p>cd&&console.warn("sigmaRadians, "+i+", is too large and will clip, as it requested "+p+" samples when the maximum is set to "+cd);for(var A=[],g=0,v=0;v<cd;++v){var m=v/f,y=Math.exp(-m*m/2);A.push(y),0==v?g+=y:v<p&&(g+=2*y)}for(var b=0;b<A.length;b++)A[b]=A[b]/g;l.envMap.value=e.texture,l.samples.value=p,l.weights.value=A,l.latitudinal.value="latitudinal"===o,a&&(l.poleAxis.value=a),l.dTheta.value=h,l.mipInt.value=8-n,l.inputEncoding.value=ud[e.texture.encoding],l.outputEncoding.value=ud[e.texture.encoding];var E=Ad[r];Cd(t,3*Math.max(0,od-2*E),(0===r?0:2*od)+2*E*(r>4?r-8+4:0),3*E,2*E),s.setRenderTarget(t),s.render(u,hd)},e}();function Sd(e){return void 0!==e&&e.type===C&&(e.encoding===te||e.encoding===ne||e.encoding===re)}function Td(){for(var e=[],t=[],n=[],r=8,i=0;i<sd;i++){var o=Math.pow(2,r);t.push(o);var a=1/o;i>4?a=ad[i-8+4-1]:0==i&&(a=0),n.push(a);for(var s=1/(o-1),c=-s/2,u=1+s/2,l=[c,c,u,c,u,u,c,c,u,u,c,u],d=new Float32Array(108),h=new Float32Array(72),f=new Float32Array(36),p=0;p<6;p++){var A=p%3*2/3-1,g=p>2?0:-1,v=[A,g,0,A+2/3,g,0,A+2/3,g+1,0,A,g,0,A+2/3,g+1,0,A,g+1,0];d.set(v,18*p),h.set(l,12*p);var m=[p,p,p,p,p,p];f.set(m,6*p)}var y=new kn;y.setAttribute("position",new pn(d,3)),y.setAttribute("uv",new pn(h,2)),y.setAttribute("faceIndex",new pn(f,1)),e.push(y),r>4&&r--}return{_lodPlanes:e,_sizeLods:t,_sigmas:n}}function Rd(e){var t=new Le(3*od,3*od,e);return t.texture.mapping=g,t.texture.name="PMREM.cubeUv",t.scissorTest=!0,t}function Cd(e,t,n,r,i){e.viewport.set(t,n,r,i),e.scissor.set(t,n,r,i)}function Id(){var e=new Re(1,1);return new js({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null},texelSize:{value:e},inputEncoding:{value:ud[3e3]},outputEncoding:{value:ud[3e3]}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute vec3 position;\n\t\tattribute vec2 uv;\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform vec2 texelSize;\n\n\t\t\t\n\n\t\tuniform int inputEncoding;\n\t\tuniform int outputEncoding;\n\n\t\t#include <encodings_pars_fragment>\n\n\t\tvec4 inputTexelToLinear( vec4 value ) {\n\n\t\t\tif ( inputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( inputEncoding == 1 ) {\n\n\t\t\t\treturn sRGBToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 2 ) {\n\n\t\t\t\treturn RGBEToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 3 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 7.0 );\n\n\t\t\t} else if ( inputEncoding == 4 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 16.0 );\n\n\t\t\t} else if ( inputEncoding == 5 ) {\n\n\t\t\t\treturn RGBDToLinear( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn GammaToLinear( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 linearToOutputTexel( vec4 value ) {\n\n\t\t\tif ( outputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( outputEncoding == 1 ) {\n\n\t\t\t\treturn LinearTosRGB( value );\n\n\t\t\t} else if ( outputEncoding == 2 ) {\n\n\t\t\t\treturn LinearToRGBE( value );\n\n\t\t\t} else if ( outputEncoding == 3 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 7.0 );\n\n\t\t\t} else if ( outputEncoding == 4 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 16.0 );\n\n\t\t\t} else if ( outputEncoding == 5 ) {\n\n\t\t\t\treturn LinearToRGBD( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn LinearToGamma( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 envMapTexelToLinear( vec4 color ) {\n\n\t\t\treturn inputTexelToLinear( color );\n\n\t\t}\n\t\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tvec2 f = fract( uv / texelSize - 0.5 );\n\t\t\t\tuv -= f * texelSize;\n\t\t\t\tvec3 tl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\t\t\t\tuv.x += texelSize.x;\n\t\t\t\tvec3 tr = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\t\t\t\tuv.y += texelSize.y;\n\t\t\t\tvec3 br = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\t\t\t\tuv.x -= texelSize.x;\n\t\t\t\tvec3 bl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\n\t\t\t\tvec3 tm = mix( tl, tr, f.x );\n\t\t\t\tvec3 bm = mix( bl, br, f.x );\n\t\t\t\tgl_FragColor.rgb = mix( tm, bm, f.y );\n\n\t\t\t\tgl_FragColor = linearToOutputTexel( gl_FragColor );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function xd(){return new js({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},inputEncoding:{value:ud[3e3]},outputEncoding:{value:ud[3e3]}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute vec3 position;\n\t\tattribute vec2 uv;\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\t\n\n\t\tuniform int inputEncoding;\n\t\tuniform int outputEncoding;\n\n\t\t#include <encodings_pars_fragment>\n\n\t\tvec4 inputTexelToLinear( vec4 value ) {\n\n\t\t\tif ( inputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( inputEncoding == 1 ) {\n\n\t\t\t\treturn sRGBToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 2 ) {\n\n\t\t\t\treturn RGBEToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 3 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 7.0 );\n\n\t\t\t} else if ( inputEncoding == 4 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 16.0 );\n\n\t\t\t} else if ( inputEncoding == 5 ) {\n\n\t\t\t\treturn RGBDToLinear( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn GammaToLinear( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 linearToOutputTexel( vec4 value ) {\n\n\t\t\tif ( outputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( outputEncoding == 1 ) {\n\n\t\t\t\treturn LinearTosRGB( value );\n\n\t\t\t} else if ( outputEncoding == 2 ) {\n\n\t\t\t\treturn LinearToRGBE( value );\n\n\t\t\t} else if ( outputEncoding == 3 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 7.0 );\n\n\t\t\t} else if ( outputEncoding == 4 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 16.0 );\n\n\t\t\t} else if ( outputEncoding == 5 ) {\n\n\t\t\t\treturn LinearToRGBD( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn LinearToGamma( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 envMapTexelToLinear( vec4 color ) {\n\n\t\t\treturn inputTexelToLinear( color );\n\n\t\t}\n\t\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb = envMapTexelToLinear( textureCube( envMap, vec3( - vOutputDirection.x, vOutputDirection.yz ) ) ).rgb;\n\t\t\t\tgl_FragColor = linearToOutputTexel( gl_FragColor );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}Sc.create=function(e,t){return console.log("THREE.Curve.create() has been deprecated"),e.prototype=Object.create(Sc.prototype),e.prototype.constructor=e,e.prototype.getPoint=t,e},zc.prototype.fromPoints=function(e){return console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(e)},Dl.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},Ol.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},Ac.prototype.extractUrlBase=function(e){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),pu.extractUrlBase(e)},Ac.Handlers={add:function(){console.error("THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.")},get:function(){console.error("THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.")}},bl.prototype.center=function(e){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(e)},bl.prototype.empty=function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},bl.prototype.isIntersectionBox=function(e){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},bl.prototype.size=function(e){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(e)},He.prototype.center=function(e){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(e)},He.prototype.empty=function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},He.prototype.isIntersectionBox=function(e){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},He.prototype.isIntersectionSphere=function(e){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(e)},He.prototype.size=function(e){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(e)},ot.prototype.empty=function(){return console.warn("THREE.Sphere: .empty() has been renamed to .isEmpty()."),this.isEmpty()},Ar.prototype.setFromMatrix=function(e){return console.warn("THREE.Frustum: .setFromMatrix() has been renamed to .setFromProjectionMatrix()."),this.setFromProjectionMatrix(e)},wl.prototype.center=function(e){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(e)},Ie.prototype.flattenToArrayOffset=function(e,t){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(e,t)},Ie.prototype.multiplyVector3=function(e){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),e.applyMatrix3(this)},Ie.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},Ie.prototype.applyToBufferAttribute=function(e){return console.warn("THREE.Matrix3: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix3( matrix ) instead."),e.applyMatrix3(this)},Ie.prototype.applyToVector3Array=function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")},Ie.prototype.getInverse=function(e){return console.warn("THREE.Matrix3: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(e).invert()},pt.prototype.extractPosition=function(e){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(e)},pt.prototype.flattenToArrayOffset=function(e,t){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(e,t)},pt.prototype.getPosition=function(){return console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),(new De).setFromMatrixColumn(this,3)},pt.prototype.setRotationFromQuaternion=function(e){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(e)},pt.prototype.multiplyToArray=function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},pt.prototype.multiplyVector3=function(e){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},pt.prototype.multiplyVector4=function(e){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},pt.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},pt.prototype.rotateAxis=function(e){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),e.transformDirection(this)},pt.prototype.crossVector=function(e){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},pt.prototype.translate=function(){console.error("THREE.Matrix4: .translate() has been removed.")},pt.prototype.rotateX=function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},pt.prototype.rotateY=function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},pt.prototype.rotateZ=function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},pt.prototype.rotateByAxis=function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},pt.prototype.applyToBufferAttribute=function(e){return console.warn("THREE.Matrix4: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},pt.prototype.applyToVector3Array=function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},pt.prototype.makeFrustum=function(e,t,n,r,i,o){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(e,t,r,n,i,o)},pt.prototype.getInverse=function(e){return console.warn("THREE.Matrix4: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(e).invert()},Qt.prototype.isIntersectionLine=function(e){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(e)},Ue.prototype.multiplyVector3=function(e){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),e.applyQuaternion(this)},Ue.prototype.inverse=function(){return console.warn("THREE.Quaternion: .inverse() has been renamed to invert()."),this.invert()},ft.prototype.isIntersectionBox=function(e){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},ft.prototype.isIntersectionPlane=function(e){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(e)},ft.prototype.isIntersectionSphere=function(e){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(e)},en.prototype.area=function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},en.prototype.barycoordFromPoint=function(e,t){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(e,t)},en.prototype.midpoint=function(e){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(e)},en.prototypenormal=function(e){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(e)},en.prototype.plane=function(e){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(e)},en.barycoordFromPoint=function(e,t,n,r,i){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),en.getBarycoord(e,t,n,r,i)},en.normal=function(e,t,n,r){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),en.getNormal(e,t,n,r)},Kc.prototype.extractAllPoints=function(e){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(e)},Kc.prototype.extrude=function(e){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new Ss(this,e)},Kc.prototype.makeGeometry=function(e){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new Ns(this,e)},Re.prototype.fromAttribute=function(e,t,n){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,n)},Re.prototype.distanceToManhattan=function(e){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(e)},Re.prototype.lengthManhattan=function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},De.prototype.setEulerFromRotationMatrix=function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},De.prototype.setEulerFromQuaternion=function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},De.prototype.getPositionFromMatrix=function(e){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(e)},De.prototype.getScaleFromMatrix=function(e){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(e)},De.prototype.getColumnFromMatrix=function(e,t){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(t,e)},De.prototype.applyProjection=function(e){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(e)},De.prototype.fromAttribute=function(e,t,n){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,n)},De.prototype.distanceToManhattan=function(e){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(e)},De.prototype.lengthManhattan=function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},Me.prototype.fromAttribute=function(e,t,n){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,n)},Me.prototype.lengthManhattan=function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},Ft.prototype.getChildByName=function(e){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(e)},Ft.prototype.renderDepth=function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},Ft.prototype.translate=function(e,t){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(t,e)},Ft.prototype.getWorldRotation=function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")},Ft.prototype.applyMatrix=function(e){return console.warn("THREE.Object3D: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(e)},Object.defineProperties(Ft.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(e){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=e}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),$n.prototype.setDrawMode=function(){console.error("THREE.Mesh: .setDrawMode() has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")},Object.defineProperties($n.prototype,{drawMode:{get:function(){return console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode."),0},set:function(){console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}}),ca.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")},sr.prototype.setLens=function(e,t){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),void 0!==t&&(this.filmGauge=t),this.setFocalLength(e)},Object.defineProperties(qc.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(e){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=e}},shadowCameraLeft:{set:function(e){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=e}},shadowCameraRight:{set:function(e){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=e}},shadowCameraTop:{set:function(e){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=e}},shadowCameraBottom:{set:function(e){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=e}},shadowCameraNear:{set:function(e){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=e}},shadowCameraFar:{set:function(e){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=e}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(e){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=e}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(e){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=e}},shadowMapHeight:{set:function(e){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=e}}}),Object.defineProperties(pn.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},dynamic:{get:function(){return console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.usage===le},set:function(){console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.setUsage(le)}}}),pn.prototype.setDynamic=function(e){return console.warn("THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===e?le:ue),this},pn.prototype.copyIndicesArray=function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")},pn.prototype.setArray=function(){console.error("THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")},kn.prototype.addIndex=function(e){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(e)},kn.prototype.addAttribute=function(e,t){return console.warn("THREE.BufferGeometry: .addAttribute() has been renamed to .setAttribute()."),t&&t.isBufferAttribute||t&&t.isInterleavedBufferAttribute?"index"===e?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(t),this):this.setAttribute(e,t):(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.setAttribute(e,new pn(arguments[1],arguments[2])))},kn.prototype.addDrawCall=function(e,t,n){void 0!==n&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(e,t)},kn.prototype.clearDrawCalls=function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},kn.prototype.computeOffsets=function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")},kn.prototype.removeAttribute=function(e){return console.warn("THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute()."),this.deleteAttribute(e)},kn.prototype.applyMatrix=function(e){return console.warn("THREE.BufferGeometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(e)},Object.defineProperties(kn.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),ko.prototype.setDynamic=function(e){return console.warn("THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===e?le:ue),this},ko.prototype.setArray=function(){console.error("THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")},Ss.prototype.getArrays=function(){console.error("THREE.ExtrudeGeometry: .getArrays() has been removed.")},Ss.prototype.addShapeList=function(){console.error("THREE.ExtrudeGeometry: .addShapeList() has been removed.")},Ss.prototype.addShape=function(){console.error("THREE.ExtrudeGeometry: .addShape() has been removed.")},Lo.prototype.dispose=function(){console.error("THREE.Scene: .dispose() has been removed.")},dl.prototype.onUpdate=function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this},Object.defineProperties(nn.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new ln}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(e){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===e}},stencilMask:{get:function(){return console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask},set:function(e){console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask=e}}}),Object.defineProperties(or.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(e){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=e}}}),Oo.prototype.clearTarget=function(e,t,n,r){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(e),this.clear(t,n,r)},Oo.prototype.animate=function(e){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(e)},Oo.prototype.getCurrentRenderTarget=function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},Oo.prototype.getMaxAnisotropy=function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},Oo.prototype.getPrecision=function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},Oo.prototype.resetGLState=function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},Oo.prototype.supportsFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},Oo.prototype.supportsHalfFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},Oo.prototype.supportsStandardDerivatives=function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},Oo.prototype.supportsCompressedTextureS3TC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},Oo.prototype.supportsCompressedTexturePVRTC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},Oo.prototype.supportsBlendMinMax=function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},Oo.prototype.supportsVertexTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},Oo.prototype.supportsInstancedArrays=function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},Oo.prototype.enableScissorTest=function(e){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(e)},Oo.prototype.initMaterial=function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},Oo.prototype.addPrePlugin=function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},Oo.prototype.addPostPlugin=function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},Oo.prototype.updateShadowMap=function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},Oo.prototype.setFaceCulling=function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")},Oo.prototype.allocTextureUnit=function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")},Oo.prototype.setTexture=function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")},Oo.prototype.setTexture2D=function(){console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.")},Oo.prototype.setTextureCube=function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")},Oo.prototype.getActiveMipMapLevel=function(){return console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel()."),this.getActiveMipmapLevel()},Object.defineProperties(Oo.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=e}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=e}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}},context:{get:function(){return console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead."),this.getContext()}},vr:{get:function(){return console.warn("THREE.WebGLRenderer: .vr has been renamed to .xr"),this.xr}},gammaInput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead."),!1},set:function(){console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.")}},gammaOutput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),!1},set:function(e){console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),this.outputEncoding=!0===e?ne:te}},toneMappingWhitePoint:{get:function(){return console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed."),1},set:function(){console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed.")}}}),Object.defineProperties(bo.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(Le.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=e}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=e}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=e}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=e}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(e){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=e}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(e){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=e}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(e){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=e}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(e){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=e}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(e){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=e}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(e){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=e}}}),Vu.prototype.load=function(e){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");var t=this;return(new xu).load(e,(function(e){t.setBuffer(e)})),this},Wu.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()},ur.prototype.updateCubeMap=function(e,t){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(e,t)},ur.prototype.clear=function(e,t,n,r){return console.warn("THREE.CubeCamera: .clear() is now .renderTarget.clear()."),this.renderTarget.clear(e,t,n,r)},xe.crossOrigin=void 0,xe.loadTexture=function(e,t,n,r){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");var i=new wc;i.setCrossOrigin(this.crossOrigin);var o=i.load(e,n,void 0,r);return t&&(o.mapping=t),o},xe.loadTextureCube=function(e,t,n,r){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");var i=new Ec;i.setCrossOrigin(this.crossOrigin);var o=i.load(e,n,void 0,r);return t&&(o.mapping=t),o},xe.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},xe.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")};var Od={createMultiMaterialObject:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")},detach:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")},attach:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")}};"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:u}})),"undefined"!=typeof window&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=u),e.ACESFilmicToneMapping=4,e.AddEquation=l,e.AddOperation=2,e.AdditiveAnimationBlendMode=ee,e.AdditiveBlending=2,e.AlphaFormat=1021,e.AlwaysDepth=1,e.AlwaysStencilFunc=519,e.AmbientLight=uu,e.AmbientLightProbe=Nu,e.AnimationClip=lc,e.AnimationLoader=mc,e.AnimationMixer=ll,e.AnimationObjectGroup=cl,e.AnimationUtils=Ys,e.ArcCurve=Rc,e.ArrayCamera=So,e.ArrowHelper=ed,e.Audio=Vu,e.AudioAnalyser=Wu,e.AudioContext=Iu,e.AudioListener=ju,e.AudioLoader=xu,e.AxesHelper=td,e.AxisHelper=function(e){return console.warn("THREE.AxisHelper has been renamed to THREE.AxesHelper."),new td(e)},e.BackSide=1,e.BasicDepthPacking=3200,e.BasicShadowMap=0,e.BinaryTextureLoader=function(e){return console.warn("THREE.BinaryTextureLoader has been renamed to THREE.DataTextureLoader."),new _c(e)},e.Bone=ua,e.BooleanKeyframeTrack=rc,e.BoundingBoxHelper=function(e,t){return console.warn("THREE.BoundingBoxHelper has been deprecated. Creating a THREE.BoxHelper instead."),new Jl(e,t)},e.Box2=bl,e.Box3=He,e.Box3Helper=Yl,e.BoxBufferGeometry=tr,e.BoxGeometry=tr,e.BoxHelper=Jl,e.BufferAttribute=pn,e.BufferGeometry=kn,e.BufferGeometryLoader=vu,e.ByteType=1010,e.Cache=hc,e.Camera=ar,e.CameraHelper=zl,e.CanvasRenderer=function(){console.error("THREE.CanvasRenderer has been removed")},e.CanvasTexture=Pa,e.CatmullRomCurve3=Bc,e.CineonToneMapping=3,e.CircleBufferGeometry=Ha,e.CircleGeometry=Ha,e.ClampToEdgeWrapping=y,e.Clock=ku,e.Color=ln,e.ColorKeyframeTrack=ic,e.CompressedTexture=Da,e.CompressedTextureLoader=yc,e.ConeBufferGeometry=Va,e.ConeGeometry=Va,e.CubeCamera=ur,e.CubeReflectionMapping=h,e.CubeRefractionMapping=f,e.CubeTexture=lr,e.CubeTextureLoader=Ec,e.CubeUVReflectionMapping=g,e.CubeUVRefractionMapping=v,e.CubicBezierCurve=Uc,e.CubicBezierCurve3=Dc,e.CubicInterpolant=$s,e.CullFaceBack=1,e.CullFaceFront=2,e.CullFaceFrontBack=3,e.CullFaceNone=0,e.Curve=Sc,e.CurvePath=Gc,e.CustomBlending=5,e.CustomToneMapping=5,e.CylinderBufferGeometry=ja,e.CylinderGeometry=ja,e.Cylindrical=ml,e.DataTexture=hr,e.DataTexture2DArray=Ur,e.DataTexture3D=Dr,e.DataTextureLoader=_c,e.DataUtils=id,e.DecrementStencilOp=7683,e.DecrementWrapStencilOp=34056,e.DefaultLoadingManager=pc,e.DepthFormat=k,e.DepthStencilFormat=U,e.DepthTexture=Fa,e.DirectionalLight=cu,e.DirectionalLightHelper=Vl,e.DiscreteInterpolant=tc,e.DodecahedronBufferGeometry=Ga,e.DodecahedronGeometry=Ga,e.DoubleSide=2,e.DstAlphaFactor=206,e.DstColorFactor=208,e.DynamicBufferAttribute=function(e,t){return console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setUsage( THREE.DynamicDrawUsage ) instead."),new pn(e,t).setUsage(le)},e.DynamicCopyUsage=35050,e.DynamicDrawUsage=le,e.DynamicReadUsage=35049,e.EdgesGeometry=Xa,e.EdgesHelper=function(e,t){return console.warn("THREE.EdgesHelper has been removed. Use THREE.EdgesGeometry instead."),new Ca(new Xa(e.geometry),new ma({color:void 0!==t?t:16777215}))},e.EllipseCurve=Tc,e.EqualDepth=4,e.EqualStencilFunc=514,e.EquirectangularReflectionMapping=p,e.EquirectangularRefractionMapping=A,e.Euler=St,e.EventDispatcher=he,e.ExtrudeBufferGeometry=Ss,e.ExtrudeGeometry=Ss,e.FaceColors=1,e.FileLoader=vc,e.FlatShading=1,e.Float16BufferAttribute=_n,e.Float32Attribute=function(e,t){return console.warn("THREE.Float32Attribute has been removed. Use new THREE.Float32BufferAttribute() instead."),new wn(e,t)},e.Float32BufferAttribute=wn,e.Float64Attribute=function(e,t){return console.warn("THREE.Float64Attribute has been removed. Use new THREE.Float64BufferAttribute() instead."),new Sn(e,t)},e.Float64BufferAttribute=Sn,e.FloatType=O,e.Fog=Mo,e.FogExp2=Bo,e.Font=Su,e.FontLoader=Cu,e.FrontSide=0,e.Frustum=Ar,e.GLBufferAttribute=fl,e.GLSL1="100",e.GLSL3=de,e.GammaEncoding=re,e.GreaterDepth=6,e.GreaterEqualDepth=5,e.GreaterEqualStencilFunc=518,e.GreaterStencilFunc=516,e.GridHelper=Dl,e.Group=To,e.HalfFloatType=N,e.HemisphereLight=Wc,e.HemisphereLightHelper=Ul,e.HemisphereLightProbe=Ou,e.IcosahedronBufferGeometry=Rs,e.IcosahedronGeometry=Rs,e.ImageBitmapLoader=_u,e.ImageLoader=bc,e.ImageUtils=xe,e.ImmediateRenderObject=Sl,e.IncrementStencilOp=7682,e.IncrementWrapStencilOp=34055,e.InstancedBufferAttribute=gu,e.InstancedBufferGeometry=Au,e.InstancedInterleavedBuffer=hl,e.InstancedMesh=va,e.Int16Attribute=function(e,t){return console.warn("THREE.Int16Attribute has been removed. Use new THREE.Int16BufferAttribute() instead."),new mn(e,t)},e.Int16BufferAttribute=mn,e.Int32Attribute=function(e,t){return console.warn("THREE.Int32Attribute has been removed. Use new THREE.Int32BufferAttribute() instead."),new bn(e,t)},e.Int32BufferAttribute=bn,e.Int8Attribute=function(e,t){return console.warn("THREE.Int8Attribute has been removed. Use new THREE.Int8BufferAttribute() instead."),new An(e,t)},e.Int8BufferAttribute=An,e.IntType=1013,e.InterleavedBuffer=ko,e.InterleavedBufferAttribute=Do,e.Interpolant=Zs,e.InterpolateDiscrete=q,e.InterpolateLinear=W,e.InterpolateSmooth=X,e.InvertStencilOp=5386,e.JSONLoader=function(){console.error("THREE.JSONLoader has been removed.")},e.KeepStencilOp=ce,e.KeyframeTrack=nc,e.LOD=na,e.LatheBufferGeometry=Cs,e.LatheGeometry=Cs,e.Layers=Tt,e.LensFlare=function(){console.error("THREE.LensFlare has been moved to /examples/jsm/objects/Lensflare.js")},e.LessDepth=2,e.LessEqualDepth=3,e.LessEqualStencilFunc=515,e.LessStencilFunc=513,e.Light=qc,e.LightProbe=hu,e.Line=Sa,e.Line3=wl,e.LineBasicMaterial=ma,e.LineCurve=Pc,e.LineCurve3=Fc,e.LineDashedMaterial=Xs,e.LineLoop=Ia,e.LinePieces=1,e.LineSegments=Ca,e.LineStrip=0,e.LinearEncoding=te,e.LinearFilter=S,e.LinearInterpolant=ec,e.LinearMipMapLinearFilter=1008,e.LinearMipMapNearestFilter=1007,e.LinearMipmapLinearFilter=R,e.LinearMipmapNearestFilter=T,e.LinearToneMapping=1,e.Loader=Ac,e.LoaderUtils=pu,e.LoadingManager=fc,e.LogLuvEncoding=3003,e.LoopOnce=2200,e.LoopPingPong=2202,e.LoopRepeat=2201,e.LuminanceAlphaFormat=1025,e.LuminanceFormat=1024,e.MOUSE={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},e.Material=nn,e.MaterialLoader=fu,e.Math=Te,e.MathUtils=Te,e.Matrix3=Ie,e.Matrix4=pt,e.MaxEquation=104,e.Mesh=$n,e.MeshBasicMaterial=dn,e.MeshDepthMaterial=mo,e.MeshDistanceMaterial=yo,e.MeshFaceMaterial=function(e){return console.warn("THREE.MeshFaceMaterial has been removed. Use an Array instead."),e},e.MeshLambertMaterial=qs,e.MeshMatcapMaterial=Ws,e.MeshNormalMaterial=Ks,e.MeshPhongMaterial=Gs,e.MeshPhysicalMaterial=Qs,e.MeshStandardMaterial=Vs,e.MeshToonMaterial=zs,e.MinEquation=103,e.MirroredRepeatWrapping=b,e.MixOperation=1,e.MultiMaterial=function(e){return void 0===e&&(e=[]),console.warn("THREE.MultiMaterial has been removed. Use an Array instead."),e.isMultiMaterial=!0,e.materials=e,e.clone=function(){return e.slice()},e},e.MultiplyBlending=4,e.MultiplyOperation=0,e.NearestFilter=E,e.NearestMipMapLinearFilter=1005,e.NearestMipMapNearestFilter=1004,e.NearestMipmapLinearFilter=w,e.NearestMipmapNearestFilter=_,e.NeverDepth=0,e.NeverStencilFunc=512,e.NoBlending=0,e.NoColors=0,e.NoToneMapping=0,e.NormalAnimationBlendMode=$,e.NormalBlending=1,e.NotEqualDepth=7,e.NotEqualStencilFunc=517,e.NumberKeyframeTrack=oc,e.Object3D=Ft,e.ObjectLoader=mu,e.ObjectSpaceNormalMap=1,e.OctahedronBufferGeometry=Is,e.OctahedronGeometry=Is,e.OneFactor=201,e.OneMinusDstAlphaFactor=207,e.OneMinusDstColorFactor=209,e.OneMinusSrcAlphaFactor=205,e.OneMinusSrcColorFactor=203,e.OrthographicCamera=au,e.PCFShadowMap=1,e.PCFSoftShadowMap=2,e.PMREMGenerator=wd,e.ParametricBufferGeometry=xs,e.ParametricGeometry=xs,e.Particle=function(e){return console.warn("THREE.Particle has been renamed to THREE.Sprite."),new Zo(e)},e.ParticleBasicMaterial=function(e){return console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial."),new xa(e)},e.ParticleSystem=function(e,t){return console.warn("THREE.ParticleSystem has been renamed to THREE.Points."),new La(e,t)},e.ParticleSystemMaterial=function(e){return console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial."),new xa(e)},e.Path=zc,e.PerspectiveCamera=sr,e.Plane=Qt,e.PlaneBufferGeometry=mr,e.PlaneGeometry=mr,e.PlaneHelper=Zl,e.PointCloud=function(e,t){return console.warn("THREE.PointCloud has been renamed to THREE.Points."),new La(e,t)},e.PointCloudMaterial=function(e){return console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial."),new xa(e)},e.PointLight=ou,e.PointLightHelper=Bl,e.Points=La,e.PointsMaterial=xa,e.PolarGridHelper=Pl,e.PolyhedronBufferGeometry=Qa,e.PolyhedronGeometry=Qa,e.PositionalAudio=qu,e.PropertyBinding=sl,e.PropertyMixer=Xu,e.QuadraticBezierCurve=Hc,e.QuadraticBezierCurve3=jc,e.Quaternion=Ue,e.QuaternionKeyframeTrack=sc,e.QuaternionLinearInterpolant=ac,e.REVISION=u,e.RGBADepthPacking=3201,e.RGBAFormat=L,e.RGBAIntegerFormat=1033,e.RGBA_ASTC_10x10_Format=37819,e.RGBA_ASTC_10x5_Format=37816,e.RGBA_ASTC_10x6_Format=37817,e.RGBA_ASTC_10x8_Format=37818,e.RGBA_ASTC_12x10_Format=37820,e.RGBA_ASTC_12x12_Format=37821,e.RGBA_ASTC_4x4_Format=37808,e.RGBA_ASTC_5x4_Format=37809,e.RGBA_ASTC_5x5_Format=37810,e.RGBA_ASTC_6x5_Format=37811,e.RGBA_ASTC_6x6_Format=37812,e.RGBA_ASTC_8x5_Format=37813,e.RGBA_ASTC_8x6_Format=37814,e.RGBA_ASTC_8x8_Format=37815,e.RGBA_BPTC_Format=36492,e.RGBA_ETC2_EAC_Format=K,e.RGBA_PVRTC_2BPPV1_Format=G,e.RGBA_PVRTC_4BPPV1_Format=Q,e.RGBA_S3TC_DXT1_Format=P,e.RGBA_S3TC_DXT3_Format=F,e.RGBA_S3TC_DXT5_Format=H,e.RGBDEncoding=se,e.RGBEEncoding=ie,e.RGBEFormat=1023,e.RGBFormat=M,e.RGBIntegerFormat=1032,e.RGBM16Encoding=ae,e.RGBM7Encoding=oe,e.RGB_ETC1_Format=36196,e.RGB_ETC2_Format=z,e.RGB_PVRTC_2BPPV1_Format=V,e.RGB_PVRTC_4BPPV1_Format=j,e.RGB_S3TC_DXT1_Format=D,e.RGFormat=1030,e.RGIntegerFormat=1031,e.RawShaderMaterial=js,e.Ray=ft,e.Raycaster=pl,e.RectAreaLight=lu,e.RedFormat=1028,e.RedIntegerFormat=1029,e.ReinhardToneMapping=2,e.RepeatWrapping=m,e.ReplaceStencilOp=7681,e.ReverseSubtractEquation=102,e.RingBufferGeometry=Os,e.RingGeometry=Os,e.SRGB8_ALPHA8_ASTC_10x10_Format=37851,e.SRGB8_ALPHA8_ASTC_10x5_Format=37848,e.SRGB8_ALPHA8_ASTC_10x6_Format=37849,e.SRGB8_ALPHA8_ASTC_10x8_Format=37850,e.SRGB8_ALPHA8_ASTC_12x10_Format=37852,e.SRGB8_ALPHA8_ASTC_12x12_Format=37853,e.SRGB8_ALPHA8_ASTC_4x4_Format=37840,e.SRGB8_ALPHA8_ASTC_5x4_Format=37841,e.SRGB8_ALPHA8_ASTC_5x5_Format=37842,e.SRGB8_ALPHA8_ASTC_6x5_Format=37843,e.SRGB8_ALPHA8_ASTC_6x6_Format=37844,e.SRGB8_ALPHA8_ASTC_8x5_Format=37845,e.SRGB8_ALPHA8_ASTC_8x6_Format=37846,e.SRGB8_ALPHA8_ASTC_8x8_Format=37847,e.Scene=Lo,e.SceneUtils=Od,e.ShaderChunk=yr,e.ShaderLib=Er,e.ShaderMaterial=or,e.ShadowMaterial=Hs,e.Shape=Kc,e.ShapeBufferGeometry=Ns,e.ShapeGeometry=Ns,e.ShapePath=wu,e.ShapeUtils=Es,e.ShortType=1011,e.Skeleton=ha,e.SkeletonHelper=Ol,e.SkinnedMesh=ca,e.SmoothShading=2,e.Sphere=ot,e.SphereBufferGeometry=Bs,e.SphereGeometry=Bs,e.Spherical=vl,e.SphericalHarmonics3=du,e.SplineCurve=Vc,e.SpotLight=eu,e.SpotLightHelper=Rl,e.Sprite=Zo,e.SpriteMaterial=Fo,e.SrcAlphaFactor=204,e.SrcAlphaSaturateFactor=210,e.SrcColorFactor=202,e.StaticCopyUsage=35046,e.StaticDrawUsage=ue,e.StaticReadUsage=35045,e.StereoCamera=Lu,e.StreamCopyUsage=35042,e.StreamDrawUsage=35040,e.StreamReadUsage=35041,e.StringKeyframeTrack=cc,e.SubtractEquation=101,e.SubtractiveBlending=3,e.TOUCH={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},e.TangentSpaceNormalMap=0,e.TetrahedronBufferGeometry=Ms,e.TetrahedronGeometry=Ms,e.TextBufferGeometry=Ls,e.TextGeometry=Ls,e.Texture=Ne,e.TextureLoader=wc,e.TorusBufferGeometry=ks,e.TorusGeometry=ks,e.TorusKnotBufferGeometry=Us,e.TorusKnotGeometry=Us,e.Triangle=en,e.TriangleFanDrawMode=2,e.TriangleStripDrawMode=1,e.TrianglesDrawMode=0,e.TubeBufferGeometry=Ds,e.TubeGeometry=Ds,e.UVMapping=d,e.Uint16Attribute=function(e,t){return console.warn("THREE.Uint16Attribute has been removed. Use new THREE.Uint16BufferAttribute() instead."),new yn(e,t)},e.Uint16BufferAttribute=yn,e.Uint32Attribute=function(e,t){return console.warn("THREE.Uint32Attribute has been removed. Use new THREE.Uint32BufferAttribute() instead."),new En(e,t)},e.Uint32BufferAttribute=En,e.Uint8Attribute=function(e,t){return console.warn("THREE.Uint8Attribute has been removed. Use new THREE.Uint8BufferAttribute() instead."),new gn(e,t)},e.Uint8BufferAttribute=gn,e.Uint8ClampedAttribute=function(e,t){return console.warn("THREE.Uint8ClampedAttribute has been removed. Use new THREE.Uint8ClampedBufferAttribute() instead."),new vn(e,t)},e.Uint8ClampedBufferAttribute=vn,e.Uniform=dl,e.UniformsLib=br,e.UniformsUtils=ir,e.UnsignedByteType=C,e.UnsignedInt248Type=B,e.UnsignedIntType=x,e.UnsignedShort4444Type=1017,e.UnsignedShort5551Type=1018,e.UnsignedShort565Type=1019,e.UnsignedShortType=I,e.VSMShadowMap=3,e.Vector2=Re,e.Vector3=De,e.Vector4=Me,e.VectorKeyframeTrack=uc,e.Vertex=function(e,t,n){return console.warn("THREE.Vertex has been removed. Use THREE.Vector3 instead."),new De(e,t,n)},e.VertexColors=2,e.VideoTexture=Ua,e.WebGL1Renderer=No,e.WebGLCubeRenderTarget=dr,e.WebGLMultisampleRenderTarget=ke,e.WebGLRenderTarget=Le,e.WebGLRenderTargetCube=function(e,t,n){return console.warn("THREE.WebGLRenderTargetCube( width, height, options ) is now WebGLCubeRenderTarget( size, options )."),new dr(e,n)},e.WebGLRenderer=Oo,e.WebGLUtils=wo,e.WireframeGeometry=Ps,e.WireframeHelper=function(e,t){return console.warn("THREE.WireframeHelper has been removed. Use THREE.WireframeGeometry instead."),new Ca(new Ps(e.geometry),new ma({color:void 0!==t?t:16777215}))},e.WrapAroundEnding=Z,e.XHRLoader=function(e){return console.warn("THREE.XHRLoader has been renamed to THREE.FileLoader."),new vc(e)},e.ZeroCurvatureEnding=J,e.ZeroFactor=200,e.ZeroSlopeEnding=Y,e.ZeroStencilOp=0,e.sRGBEncoding=ne,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=vendors.min.js.map